(function(){'use strict';const exports=Object.create(null);function require(p){return p.split(".").reduce(function re(o,i){return o[i];},exports);}

!function(e,t){e.bs=e.bs||{},e.bs.net=e.bs.net||{},e.bs.player=e.bs.player||{},e.bs.player.composer=e.bs.player.composer||{},e.bs.player.core=e.bs.player.core||{},e.bs.player.core.events=e.bs.player.core.events||{},e.bs.player.core.manager=e.bs.player.core.manager||{},e.bs.player.core.model=e.bs.player.core.model||{},e.bs.player.core.plugin=e.bs.player.core.plugin||{},e.bs.player.core.plugin.chromecast=e.bs.player.core.plugin.chromecast||{},e.bs.player.core.vtt=e.bs.player.core.vtt||{},e.bs.ui=e.bs.ui||{},e.bs.util=e.bs.util||{},e.haxe=e.haxe||{},e.haxe.http=e.haxe.http||{},e.haxe.io=e.haxe.io||{},e.haxe.crypto=e.haxe.crypto||{},e.haxe.ds=e.haxe.ds||{},e.haxe.ds._List=e.haxe.ds._List||{},e.haxe.ds._StringMap=e.haxe.ds._StringMap||{},e.haxe.iterators=e.haxe.iterators||{};var s,n=function(){return Dt.__string_rec(this,"")},r=r||{};class l{constructor(e,t){this.r=new RegExp(e,t.split("u").join(""));}match(e){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(e),this.r.s=e,null!=this.r.m}matched(e){if(null!=this.r.m&&e>=0&&e<this.r.m.length)return this.r.m[e];throw at.thrown("EReg::matched")}split(e){return e.replace(this.r,"#__delim__#").split("#__delim__#")}}l.__name__="EReg",Object.assign(l.prototype,{__class__:l,r:null});class i{static dateStr(e){let t=e.getMonth()+1,s=e.getDate(),n=e.getHours(),r=e.getMinutes(),l=e.getSeconds();return e.getFullYear()+"-"+(t<10?"0"+t:""+t)+"-"+(s<10?"0"+s:""+s)+" "+(n<10?"0"+n:""+n)+":"+(r<10?"0"+r:""+r)+":"+(l<10?"0"+l:""+l)}static strDate(e){switch(e.length){case 8:let t=e.split(":"),s=new Date;return s.setTime(0),s.setUTCHours(t[0]),s.setUTCMinutes(t[1]),s.setUTCSeconds(t[2]),s;case 10:let n=e.split("-");return new Date(n[0],n[1]-1,n[2],0,0,0);case 19:let r=e.split(" "),l=r[0].split("-"),i=r[1].split(":");return new Date(l[0],l[1]-1,l[2],i[0],i[1],i[2]);default:throw at.thrown("Invalid date format : "+e)}}static cca(e,t){let s=e.charCodeAt(t);if(s==s)return s}static substr(e,t,s){if(null==s)s=e.length;else if(s<0){if(0!=t)return "";s=e.length+s;}return e.substr(t,s)}static indexOf(e,t,s){let n=e.length;for(s<0&&(s+=n)<0&&(s=0);s<n;){if(e[s]===t)return s;++s;}return -1}static lastIndexOf(e,t,s){let n=e.length;for(s>=n?s=n-1:s<0&&(s+=n);s>=0;){if(e[s]===t)return s;--s;}return -1}static remove(e,t){let s=e.indexOf(t);return -1!=s&&(e.splice(s,1),!0)}static iter(e){return {cur:0,arr:e,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}}static keyValueIter(e){return new At(e)}static now(){return Date.now()}}e.haxe.HxOverrides=i,i.__name__="HxOverrides";class a{static array(e){let t=[],s=Nt(e);for(;s.hasNext();)t.push(s.next());return t}static list(e){let t=new yt,s=Nt(e);for(;s.hasNext();)t.add(s.next());return t}static map(e,t){let s=[],n=Nt(e);for(;n.hasNext();)s.push(t(n.next()));return s}static mapi(e,t){let s=0,n=[],r=Nt(e);for(;r.hasNext();)n.push(t(s++,r.next()));return n}static flatten(e){let t=[],s=Nt(e);for(;s.hasNext();){let e=Nt(s.next());for(;e.hasNext();)t.push(e.next());}return t}static flatMap(e,t){let s=[],n=Nt(e);for(;n.hasNext();)s.push(t(n.next()));let r=[],l=Nt(s);for(;l.hasNext();){let e=Nt(l.next());for(;e.hasNext();)r.push(e.next());}return r}static has(e,t){let s=Nt(e);for(;s.hasNext();)if(s.next()==t)return !0;return !1}static exists(e,t){let s=Nt(e);for(;s.hasNext();)if(t(s.next()))return !0;return !1}static foreach(e,t){let s=Nt(e);for(;s.hasNext();)if(!t(s.next()))return !1;return !0}static iter(e,t){let s=Nt(e);for(;s.hasNext();)t(s.next());}static filter(e,t){let s=[],n=Nt(e);for(;n.hasNext();){let e=n.next();t(e)&&s.push(e);}return s}static fold(e,t,s){let n=Nt(e);for(;n.hasNext();)s=t(n.next(),s);return s}static foldi(e,t,s){let n=0,r=Nt(e);for(;r.hasNext();)s=t(r.next(),s,n),++n;return s}static count(e,t){let s=0;if(null==t){let t=Nt(e);for(;t.hasNext();)t.next(),++s;}else {let n=Nt(e);for(;n.hasNext();)t(n.next())&&++s;}return s}static empty(e){return !Nt(e).hasNext()}static indexOf(e,t){let s=0,n=Nt(e);for(;n.hasNext();){if(t==n.next())return s;++s;}return -1}static find(e,t){let s=Nt(e);for(;s.hasNext();){let e=s.next();if(t(e))return e}return null}static findIndex(e,t){let s=0,n=Nt(e);for(;n.hasNext();){if(t(n.next()))return s;++s;}return -1}static concat(e,t){let s=[],n=Nt(e);for(;n.hasNext();)s.push(n.next());let r=Nt(t);for(;r.hasNext();)s.push(r.next());return s}}e.haxe.Lambda=a,a.__name__="Lambda",Math.__name__="Math";class o{static hasField(e,t){return Object.prototype.hasOwnProperty.call(e,t)}static field(e,t){try{return e[t]}catch(e){return null}}static setField(e,t,s){e[t]=s;}static getProperty(e,t){let s;if(null==e)return null;{let n;return e.__properties__?(s=e.__properties__["get_"+t],n=s):n=!1,n?e[s]():e[t]}}static setProperty(e,t,s){let n,r;e.__properties__?(n=e.__properties__["set_"+t],r=n):r=!1,r?e[n](s):e[t]=s;}static callMethod(e,t,s){return t.apply(e,s)}static fields(e){let t=[];if(null!=e){let n=Object.prototype.hasOwnProperty;for(var s in e)"__id__"!=s&&"hx__closures__"!=s&&n.call(e,s)&&t.push(s);}return t}static isFunction(e){return "function"==typeof e&&!(e.__name__||e.__ename__)}static compare(e,t){return e==t?0:e>t?1:-1}static compareMethods(e,t){return e==t}static isObject(e){if(null==e)return !1;let t=typeof e;return "string"==t||"object"==t&&null==e.__enum__||"function"==t&&null!=(e.__name__||e.__ename__)}static isEnumValue(e){return null!=e&&null!=e.__enum__}static deleteField(e,t){return !!Object.prototype.hasOwnProperty.call(e,t)&&(delete e[t],!0)}static copy(e){if(null==e)return null;let t={},s=0,n=o.fields(e);for(;s<n.length;){let r=n[s];++s,t[r]=o.field(e,r);}return t}static makeVarArgs(e){return function(){let t=arguments,s=Array.prototype.slice.call(t);return e(s)}}}e.haxe.Reflect=o,o.__name__="Reflect";class u{static string(e){return Dt.__string_rec(e,"")}static parseInt(e){let t=parseInt(e);return isNaN(t)?null:t}static random(e){return e<=0?0:Math.floor(Math.random()*e)}}u.__name__="Std";class c{constructor(){this.b="";}get_length(){return this.b.length}add(e){this.b+=u.string(e);}addChar(e){this.b+=String.fromCodePoint(e);}addSub(e,t,s){this.b+=null==s?i.substr(e,t,null):i.substr(e,t,s);}toString(){return this.b}}e.haxe.StringBuf=c,c.__name__="StringBuf",Object.assign(c.prototype,{__class__:c,b:null,__properties__:{get_length:"get_length"}});class _{}_.__name__="haxe.SysTools";class h{static urlEncode(e){return encodeURIComponent(e)}static urlDecode(e){return decodeURIComponent(e.split("+").join(" "))}static htmlEscape(e,t){let s="",n=0,r=e;for(;n<r.length;){let e=r,l=n++,i=e.charCodeAt(l);i>=55296&&i<=56319&&(i=i-55232<<10|1023&e.charCodeAt(l+1));i>=65536&&++n;let a=i;switch(a){case 34:s+=t?"&quot;":String.fromCodePoint(a);break;case 38:s+="&amp;";break;case 39:s+=t?"&#039;":String.fromCodePoint(a);break;case 60:s+="&lt;";break;case 62:s+="&gt;";break;default:s+=String.fromCodePoint(a);}}return s}static htmlUnescape(e){return e.split("&gt;").join(">").split("&lt;").join("<").split("&quot;").join('"').split("&#039;").join("'").split("&amp;").join("&")}static contains(e,t){return e.includes(t)}static startsWith(e,t){return e.startsWith(t)}static endsWith(e,t){return e.endsWith(t)}static isSpace(e,t){let s=i.cca(e,t);return s>8&&s<14||32==s}static ltrim(e){let t=e.length,s=0;for(;s<t&&h.isSpace(e,s);)++s;return s>0?i.substr(e,s,t-s):e}static rtrim(e){let t=e.length,s=0;for(;s<t&&h.isSpace(e,t-s-1);)++s;return s>0?i.substr(e,0,t-s):e}static trim(e){return h.ltrim(h.rtrim(e))}static lpad(e,t,s){if(t.length<=0)return e;let n="";for(s-=e.length;n.length<s;)n+=null==t?"null":""+t;return n+=null==e?"null":""+e,n}static rpad(e,t,s){if(t.length<=0)return e;let n="";for(n=null==e?"null":""+e;n.length<s;)n+=null==t?"null":""+t;return n}static replace(e,t,s){return e.split(t).join(s)}static hex(e,t){let s="";do{s="0123456789ABCDEF".charAt(15&e)+s,e>>>=4;}while(e>0);if(null!=t)for(;s.length<t;)s="0"+s;return s}static fastCodeAt(e,t){return e.charCodeAt(t)}static unsafeCodeAt(e,t){return e.charCodeAt(t)}static iterator(e){return new Lt(e)}static keyValueIterator(e){return new Ft(e)}static isEof(e){return e!=e}static quoteUnixArg(e){return ""==e?"''":new l("[^a-zA-Z0-9_@%+=:,./-]","").match(e)?"'"+h.replace(e,"'","'\"'\"'")+"'":e}static quoteWinArg(e,t){let s=e;if(!new l('^(/)?[^ \t/\\\\"]+$',"").match(s)){let e="",t=-1!=s.indexOf(" ")||-1!=s.indexOf("\t")||""==s||s.indexOf("/")>0;t&&(e+='"');let n=new c,r=0,l=s.length;for(;r<l;){let t=i.cca(s,r++);if(null==t){let s=t;n.b.length>0&&(e+=u.string(n.b),n=new c),e+=String.fromCodePoint(s);}else switch(t){case 34:let s=n.b;e+=u.string(s),e+=u.string(s),n=new c,e+='\\"';break;case 92:n.b+="\\";break;default:let r=t;n.b.length>0&&(e+=u.string(n.b),n=new c),e+=String.fromCodePoint(r);}}e+=u.string(n.b),t&&(e+=u.string(n.b),e+='"'),s=e;}if(t){let e="",t=0,n=s.length;for(;t<n;){let n=i.cca(s,t++);_.winMetaCharacters.indexOf(n)>=0&&(e+=String.fromCodePoint(94)),e+=String.fromCodePoint(n);}return e}return s}static utf16CodePointAt(e,t){let s=e.charCodeAt(t);return s>=55296&&s<=56319&&(s=s-55232<<10|1023&e.charCodeAt(t+1)),s}}e.haxe.StringTools=h,h.__name__="StringTools";class p{static createInstance(e,t){return new(Function.prototype.bind.apply(e,[null].concat(t)))}static getInstanceFields(e){let t=[];for(;null!=e;){let s=0,n=Object.getOwnPropertyNames(e.prototype);for(;s<n.length;){let e=n[s];switch(++s,e){case"__class__":case"__properties__":case"constructor":break;default:-1==t.indexOf(e)&&t.push(e);}}e=e.__super__;}return t}}p.__name__="Type";class d{static error(e){console.error(e);}}d.__name__="bs.Console";class m{constructor(e){m._hx_skip_constructor||this._hx_constructor(e);}_hx_constructor(e){this.url=e,this.headers=[],this.params=[],this.emptyOnData=Ut(this,this.onData);}setHeader(e,t){let s=0,n=this.headers.length;for(;s<n;){let n=s++;if(this.headers[n].name==e)return void(this.headers[n]={name:e,value:t})}this.headers.push({name:e,value:t});}addHeader(e,t){this.headers.push({name:e,value:t});}setParameter(e,t){let s=0,n=this.params.length;for(;s<n;){let n=s++;if(this.params[n].name==e)return void(this.params[n]={name:e,value:t})}this.params.push({name:e,value:t});}addParameter(e,t){this.params.push({name:e,value:t});}setPostData(e){this.postData=e,this.postBytes=null;}setPostBytes(e){this.postBytes=e,this.postData=null;}request(e){throw new Ot(null,null,{fileName:"haxe/http/HttpBase.hx",lineNumber:186,className:"haxe.http.HttpBase",methodName:"request"})}onData(e){}onBytes(e){}onError(e){}onStatus(e){}hasOnData(){return Ut(this,this.onData)!=this.emptyOnData}success(e){this.responseBytes=e,this.responseAsString=null,this.hasOnData()&&this.onData(this.get_responseData()),this.onBytes(this.responseBytes);}get_responseData(){return null==this.responseAsString&&null!=this.responseBytes&&(this.responseAsString=this.responseBytes.getString(0,this.responseBytes.length,pt.UTF8)),this.responseAsString}}e.haxe.http.HttpBase=m,m.__name__="haxe.http.HttpBase",Object.assign(m.prototype,{__class__:m,url:null,responseBytes:null,responseAsString:null,postData:null,postBytes:null,headers:null,params:null,emptyOnData:null,__properties__:{get_responseData:"get_responseData"}});class g extends m{constructor(e){m._hx_skip_constructor=!0,super(),m._hx_skip_constructor=!1,this._hx_constructor(e);}_hx_constructor(e){this.async=!0,this.withCredentials=!1,super._hx_constructor(e);}cancel(){null!=this.req&&(this.req.abort(),this.req=null);}request(e){this.responseAsString=null,this.responseBytes=null,this.responseHeaders=null;let s=this.req=Tt.createXMLHttpRequest(),n=this,r=function(e){if(4!=s.readyState)return;let r;try{r=s.status;}catch(e){r=null;}if(0==r&&Tt.get_supported()&&null!=t.location){let e=t.location.protocol.toLowerCase();new l("^(?:about|app|app-storage|.+-extension|file|res|widget):$","").match(e)&&(r=null!=s.response?200:404);}if(null==r&&(r=null),null!=r&&n.onStatus(r),null!=r&&r>=200&&r<400){n.req=null;let e=s.getAllResponseHeaders().split("\r\n"),t=[],r=0,l=e;for(;r<l.length;){let e=l[r];++r,""!=e&&t.push(e);}e=t,n.responseHeaders=new wt;let i=0;for(;i<e.length;){let t=e[i++].split(": "),s=t.shift(),r=1==t.length?t[0]:t.join(": ");r=h.ltrim(h.rtrim(r)),n.responseHeaders.h[s]=r;}n.success(ht.ofData(s.response));}else if(null==r||0==r&&null==s.response)n.req=null,n.onError("Failed to connect or resolve host");else if(null==r){n.req=null;let e=null!=s.response?ht.ofData(s.response):null;n.responseBytes=e,n.onError("Http Error #"+s.status);}else switch(r){case 12007:n.req=null,n.onError("Unknown host");break;case 12029:n.req=null,n.onError("Failed to connect to host");break;default:n.req=null;let e=null!=s.response?ht.ofData(s.response):null;n.responseBytes=e,n.onError("Http Error #"+s.status);}};this.async&&(s.onreadystatechange=r);let i=this.postData,o=this.postBytes,c=null==i?null==o?null:new Blob([o.b.bufferValue]):null==o?i:null;if(null!=c)e=!0;else {let e=0,t=this.params;for(;e<t.length;){let s=t[e];++e,c=null==c?"":(null==c?"null":u.string(c))+"&";let n=s.name,r=(null==c?"null":u.string(c))+encodeURIComponent(n)+"=",l=s.value;c=r+encodeURIComponent(l);}}try{e?s.open("POST",this.url,this.async):null!=c?(s.open("GET",this.url+(this.url.split("?").length<=1?"?":"&")+(null==c?"null":u.string(c)),this.async),c=null):s.open("GET",this.url,this.async),s.responseType="arraybuffer";}catch(i){let e=at.caught(i).unwrap();return this.req=null,void this.onError(e.toString())}s.withCredentials=this.withCredentials,!a.exists(this.headers,(function(e){return "Content-Type"==e.name}))&&e&&null==this.postData&&s.setRequestHeader("Content-Type","application/x-www-form-urlencoded");let _=0,p=this.headers;for(;_<p.length;){let e=p[_];++_,s.setRequestHeader(e.name,e.value);}s.send(c),this.async||r();}static requestUrl(e){let t=new g(e);t.async=!1;let s=null;return t.onData=function(e){s=e;},t.onError=function(e){throw at.thrown(e)},t.request(!1),s}}e.haxe.http.HttpJs=g,g.__name__="haxe.http.HttpJs",g.__super__=m,Object.assign(g.prototype,{__class__:g,async:null,withCredentials:null,responseHeaders:null,req:null});class y extends g{constructor(e){super(e);}registerEvents(e){let t=this;e.onreadystatechange=function(){if(4!=e.readyState)return;let s;try{s=e.status;}catch(e){s=null;}if(null==s&&(s=null),null!=s&&t.onStatus(s),null!=s&&s>=200&&s<400)t.onData(e.response);else if(null==s)t.onError("Failed to connect or resolve host");else switch(s){case 0:t.onError("Unable to make request (may be blocked due to cross-domain permissions)");break;case 12007:t.onError("Unknown host");break;case 12029:t.onError("Failed to connect to host");break;default:t.onError("Http Error #"+e.status);}};}customRequest(e,t,s,n){let r=new XMLHttpRequest;this.registerEvents(r);let l="",i=0,a=this.params;for(;i<a.length;){let e=a[i];++i,0!=l.length&&(l=u.string(l)+"&");let t=o.field(e,"name");null==t&&(t=o.field(e,"param"));let s=encodeURIComponent(t),n=e.value,r=encodeURIComponent(n);l=u.string(l)+(s+"=")+r;}try{"GET"==n&&null!=l&&""!=l?(r.open(n,this.url+(this.url.split("?").length<=1?"?":"&")+u.string(l),!0),l=""):r.open(n,this.url,!0);}catch(i){let e=at.caught(i).unwrap();return void this.onError(e.toString())}let c=0,_=this.headers;for(;c<_.length;){let e=_[c];++c;let t=o.field(e,"header");null==t&&(t=o.field(e,"name")),r.setRequestHeader(t,e.value);}r.send(l);}}e.bs.net.Http=y,y.__name__="bs.net.Http",y.__super__=g,Object.assign(y.prototype,{__class__:y});class b{constructor(){this.pluginsVideo=[],this.plugins=[],this.data=exports.configuration;}createPlayer(e,t,s,n){if(null==e&&(e="PLAYER"),this.readPlugins(e),this.player=new E,this.player.uid=e,this.player.plugins=this.plugins,this.player.pluginsVideo=this.pluginsVideo,null!=n){let e=0,t=this.plugins;for(;e<t.length;)t[e++].videoElementsManager=n;}return this.player.initialize(this.getParent(t),this.getData(s)),this.player}readPlugins(e){this.resolvePlugins(e,exports.bs.player.plugin);this.plugins.sort((function(e,t){return e.initPriority-t.initPriority}));}resolvePlugins(e,t){if(0==o.isObject(t))return;let s=t.__name__;if(null!=s){let n,r=p.createInstance(t,[]),l=t;if(0==o.isObject(l))n=!1;else {let e=Object.prototype.hasOwnProperty.call(l,"__plugfaces__")?o.field(l,"__plugfaces__"):null;n=null!=e&&e.indexOf("IVideoPlayer")>-1;}if(n)return void this.pluginsVideo.push(r);let i,a=t;if(0==o.isObject(a))i=!1;else {let e=Object.prototype.hasOwnProperty.call(a,"__plugfaces__")?o.field(a,"__plugfaces__"):null;i=null!=e&&e.indexOf("IPlugin")>-1;}if(i)return r.className=s,r.uid=r.context=e,void this.plugins.push(r)}else {let s=0,n=o.fields(t);for(;s<n.length;)this.resolvePlugins(e,o.field(t,n[s++]));}}getData(e){return null!=e?e:this.data}getParent(e){return null!=e?e:this.parent}}b.__name__="bs.player.composer.Composer",Object.assign(b.prototype,{__class__:b,data:null,parent:null,plugins:null,pluginsVideo:null,player:null});class f{__keepFieldsFix(){return p.getInstanceFields(f)}static getScreenSize(){if(f.isWindowExisting()){let e=window.screen;return {width:0|(e.width>e.height?e.width:e.height),height:0|(e.height<e.width?e.height:e.width)}}return {width:null,height:null}}static isMobile(){return f.mobile}static isSmartTV(){return f.smartTV}static isWebView(){return !!f.isWindowExisting()&&null!=window.bradmaxSetFullscreen}static isWebOsApp(){return !(!f.isWindowExisting()||!f.isSmartTV())&&null!=window.webOS}static getUserAgent(){return f.isWindowExisting()?window.navigator.userAgent:null}static getUserAgentData(){return f.isWindowExisting()&&navigator&&navigator.userAgentData&&navigator.userAgentData.getHighEntropyValues?navigator.userAgentData:null}static getBrowserName(){return f.browserName}static isBrowserOnline(){return !f.isWindowExisting()||window.navigator.onLine}static isMediaSourceExtensionSupported(){if(f.isWindowExisting()){let e=window;return Object.prototype.hasOwnProperty.call(e,"MediaSource")}return !1}static isWindowExisting(){return "undefined"!=typeof window&&null!=window}static baseUrl(){let e=t.location;return null!=e&&f.baseUrlCacheLastFullUrl!=e.href&&(f.baseUrlCacheLastFullUrl=e.href,f.baseUrlCacheLastBaseUrl=f.baseUrlCacheLastFullUrl.split(e.hash).join("")),f.baseUrlCacheLastBaseUrl}static log(e){null==f.traceLog&&(f.traceLog="<h5>trace:</h5>"),f.traceLog+="<p>"+e+"</p>",f.printLog(),null==f.traceTrg&&f.isWindowExisting()&&window.addEventListener("load",f.printLog);}static printLog(){null==f.traceTrg&&(f.traceTrg=window.document.getElementById("trace")),null!=f.traceTrg&&(f.traceTrg.innerHTML=f.traceLog);}static highlightHtmlNode(e){if(!f.isWindowExisting())return;let t,s=window.document.body;if(Object.prototype.hasOwnProperty.call(s,"createTextRange"))t=s.createTextRange(),t.moveToElementText(e),t.select();else if(e instanceof Node){let s=window.getSelection();t=window.document.createRange(),t.selectNodeContents(e),s.removeAllRanges(),s.addRange(t);}}static focusElement(e,t){if(null!=e)try{e.focus(t);}catch(t){e.focus();}}static copyToClipboard(e){if(!f.isWindowExisting())return !1;let t=window.document.createElement("input");t.style.fontSize="12pt",t.style.border="0",t.style.padding="0",t.style.margin="0",t.style.position="absolute","rtl"==window.document.documentElement.getAttribute("dir")?t.style.right="-9999px":t.style.left="-9999px";let s,n=f.isWindowExisting()?window.pageYOffset:0;null==n&&(n=window.document.documentElement.scrollTop),f.isWindowExisting()&&t.addEventListener("focus",(function(e){window.scrollTo(0,n);})),t.style.top=n+"px",t.setAttribute("readonly",""),t.value=e,window.document.body.appendChild(t),f.focusElement(t,{preventScroll:!0}),t.setSelectionRange(0,t.value.length);try{s=window.document.execCommand("copy");}catch(e){s=!1;}return t.blur(),window.document.body.removeChild(t),s}static findThisJsScriptAbsolutePath(e){if(!f.isWindowExisting())return null;let t=null;if(t=window.document.currentScript,null!=t)return t.src;let s=window.document.getElementsByTagName("script");return null==s||0==s.length?null:(t=f.findScriptBySrc(s,e),null==t&&e.endsWith("_")&&(t=f.findScriptBySrc(s,i.substr(e,0,-1))),null!=t?t.src:null)}static findScriptBySrc(e,t){let s=null,n=0;for(;n<e.length;){let r=e[n];if(++n,s=r.getAttribute("src"),null!=s&&(s=s.split("/").pop(),s=s.split(".min.js").join(""),s=s.split(".js.min").join(""),s=s.split(".js").join(""),s==t))return r}return null}static disableHtmlSelection(){f.isWindowExisting()&&(f.disableHtmlSelectionFunction=function(e){return e.preventDefault(),!1},window.document.addEventListener("selectstart",f.disableHtmlSelectionFunction));}static enableHtmlSelection(){f.isWindowExisting()&&null!=f.disableHtmlSelectionFunction&&(window.document.removeEventListener("selectstart",f.disableHtmlSelectionFunction),f.disableHtmlSelectionFunction=null);}static isWebGLAvailable(){if(f.isWebView()||!f.isWindowExisting())return !1;try{let e=window,t=Object.prototype.hasOwnProperty.call(e,"WebGLRenderingContext"),s=window.document.createElement("canvas");if(!t)return t;let n=null!=s.getContext("webgl")||null!=s.getContext("experimental-webgl");return !!t&&n}catch(e){return !1}}static isWebGL2Available(){if(f.isWebView()||!f.isWindowExisting())return !1;try{let e=window,t=Object.prototype.hasOwnProperty.call(e,"WebGL2RenderingContext"),s=window.document.createElement("canvas");if(!t)return t;let n=null!=s.getContext("webgl2");return !!t&&n}catch(e){return !1}}static getOrientation(){if(f.isWindowExisting()&&null!=window.screen.orientation)return window.screen.orientation.angle;let e;if(f.isWindowExisting()){let t=window.orientation;e="number"==typeof t&&(0|t)===t;}else e=!1;return e?window.orientation:0}static isDeviceOrientationSupported(){if(f.isWindowExisting()){let e=window;return Object.prototype.hasOwnProperty.call(e,"DeviceOrientationEvent")}return !1}static connectDeviceOrientation(e,t){f.isDeviceOrientationSupported()&&(null!=DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((function(t){"granted"==t&&window.addEventListener("deviceorientation",e,!1);})).catch(d.error):window.addEventListener("deviceorientation",e,!1));}static disconnectDeviceOrientation(e){f.isDeviceOrientationSupported()&&window.removeEventListener("deviceorientation",e);}static isVrSupported(){let e=t.navigator;if(null==e)return Promise.resolve(!1);let s=e.xr;return null==s?Promise.resolve(!1):s.isSessionSupported("immersive-vr")}static requestVrSession(){let e=t.navigator;if(null==e)return Promise.resolve(null);let s=e.xr;return null==s?Promise.resolve(null):s.requestSession("immersive-vr",{optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]})}static getTizenVersion(){let e=null,t=f.getUserAgent();if(null==t)return null;let s=t.indexOf("Tizen ");return s>-1&&(e=parseFloat(t.substring(s+6))),e}}e.bs.util.BrowserTools=f,f.__name__="bs.util.BrowserTools",Object.assign(f.prototype,{__class__:f});class x{constructor(){this.videoElementsWaitQueue=[],this.videoElementsInUse=[],this.pendingVideoElementsForLaterAutoplay=0,this.isDrmReuseEnabled=!0,this.gestureRequiredForAutoplay=!0,this.waitQueueMaxSize=10,this.maxEmptyElementsForAutoplay=2;}countVideoElementsWaitQueue(){return this.videoElementsWaitQueue.length}countVideoElementsInUse(){return this.videoElementsInUse.length}getLastCallForCollectClickForLaterAutoplay(){return this.lastCallForCollectClickForLaterAutoplay}countHtmlVideoElementsForLaterAutoplay(e){null==e&&(e=!1);let t=0,s=0,n=this.videoElementsWaitQueue;for(;s<n.length;){let r=n[s];++s;let l=r.readyForAutoplay;e&&(l=l&&null==r.contextMediaSource),l&&++t;}return t}createVideoElement(){let e=this.createVideoElementInstance();return e.controls=!1,e.setAttribute("src",exports.mp4),f.isiOS&&(e.setAttribute("playsinline",""),e.setAttribute("webkit-playsinline","")),e}createVideoElementInstance(){return null!=this.videoElementFactoryCallback?this.videoElementFactoryCallback():tt.createVideoElement()}isSingleVideoTagPlay(){return !(!f.isiOS&&"Safari"!=f.browserName)||f.isSamsungSmartTVTizen}collectClickForLaterAutoplay(e,t){if(null==e&&(e=!1),this.lastCallForCollectClickForLaterAutoplay=new Date,!(this.countHtmlVideoElementsForLaterAutoplay(!0)+this.pendingVideoElementsForLaterAutoplay>=this.maxEmptyElementsForAutoplay)){for(null==t&&(t=this.isSingleVideoTagPlay()?1:2);this.countHtmlVideoElementsForLaterAutoplay(!0)+this.pendingVideoElementsForLaterAutoplay<t;)this.prepareEmptyVideoElementForAutoplay(e);this.removeUnusedExceedingElements();}}prepareEmptyVideoElementForAutoplay(e){let t=this.createVideoElement(),s=new Ze(t);s.preparingForAutoplay=!0,this.videoElementsWaitQueue.unshift(s);let n=t.play(),r=this;null==n||e?(t.pause(),s.preparingForAutoplay=!1,s.readyForAutoplay=!0):(this.pendingVideoElementsForLaterAutoplay+=1,n.then((function(){t.pause(),s.preparingForAutoplay=!1,s.readyForAutoplay=!0,r.pendingVideoElementsForLaterAutoplay-=1;let e=0,n=s.listenersWaitingForVideoElementForAutoplay;for(;e<n.length;)n[e++]();})));}getTagInfoReadyForAutoplay(e){if(null!=e){let t=0,s=this.videoElementsWaitQueue;for(;t<s.length;){let n=s[t];if(++t,n.readyForAutoplay&&n.hasSameContextMediaSource(e))return n}}if(!this.gestureRequiredForAutoplay&&this.isDrmReuseEnabled)return null;let t=0,s=this.videoElementsWaitQueue;for(;t<s.length;){let e=s[t];if(++t,e.readyForAutoplay)return e}return null}findVideoElementInfoByElement(e){let t=0,s=this.videoElementsWaitQueue;for(;t<s.length;){let n=s[t];if(++t,n.element==e)return n}let n=0,r=this.videoElementsInUse;for(;n<r.length;){let t=r[n];if(++n,t.element==e)return t}return null}findVideoElementInfoInUseByElement(e){let t=0,s=this.videoElementsInUse;for(;t<s.length;){let n=s[t];if(++t,n.element==e)return n}return null}hasPendingVideoElementsForLaterAutoplay(){return this.pendingVideoElementsForLaterAutoplay>0}hasHtmlVideoReadyForAutoplay(){return this.countHtmlVideoElementsForLaterAutoplay()>0}getVideoElementReadyForAutoplayOrCreate(e,t){let s=null,n=this.getTagInfoReadyForAutoplay(t);if(null!=n){if(n.setupForPlayback(t,this.isDrmReuseEnabled),n.usedByPlayer=e,s=n.element,this.isDrmReuseEnabled){n.isDrmSessionReused=!0;let e=n.get_drmSessionData();null!=e&&(e.isDrmSessionReused=!0);let t=s.play();null!=t?t.then((function(){s.pause(),n.preparingForAutoplay=!1,n.readyForAutoplay=!0;})):s.pause();}i.remove(this.videoElementsWaitQueue,n),this.videoElementsInUse.push(n);}if(null==s){s=tt.createVideoElement(),n=new Ze(s),n.setupForPlayback(t,this.isDrmReuseEnabled),n.usedByPlayer=e;let r=null;r=function(e){s.paused||(n.readyForAutoplay=!0,s.removeEventListener("timeupdate",r));},s.addEventListener("timeupdate",r),this.videoElementsInUse.push(n);}return this.setDefaultPoster(s),n.isDrmSessionReused||(this.isSafariMacOsOrIos()?s.removeAttribute("src"):s.setAttribute("src","")),s.muted&&(s.muted=!1),s}releaseVideoElement(e){let t=this.findVideoElementInfoInUseByElement(e);null!=t&&(i.remove(this.videoElementsInUse,t),t.usedByPlayer=null,this.canVideoElementBeReused(t.element)?(null!=t.contextMediaSource?this.videoElementsWaitQueue.push(t):this.videoElementsWaitQueue.unshift(t),null!=e&&null!=e.parentElement&&null!=e.load&&e.parentElement.removeChild(e)):null!=e&&null!=e.parentElement&&null!=e.load&&(e.setAttribute("src",""),e.load(),e.parentElement.removeChild(e))),this.removeUnusedExceedingElements();}removeUnusedExceedingElements(){let e=this.isDrmReuseEnabled?this.waitQueueMaxSize:this.maxEmptyElementsForAutoplay;if(this.videoElementsWaitQueue.length>e){let t=this.videoElementsWaitQueue.splice(0,this.videoElementsWaitQueue.length-e),s=0;for(;s<t.length;){let e=t[s];++s,e.cleanVideoElementAndDrmSession(),o.deleteField(e.element,"_bp");}}this.videoElementsInUse.length>this.waitQueueMaxSize&&console.warn("VideoElementsManager.Warning: Too many video elements in use. Possible memory leak.");}canVideoElementBeReused(e){let t=null!=e&&(null==e.textTracks||0==e.textTracks.length);return !!this.isSafariMacOsOrIos()||t}isSafariMacOsOrIos(){return "Safari"==f.browserName&&!f.isSamsungSmartTVTizen}setDefaultPoster(e){f.isAndroid&&null!=e&&(e.poster="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=");}}x.__name__="bs.player.web.VideoElementsManager",Object.assign(x.prototype,{__class__:x,videoElementsWaitQueue:null,videoElementsInUse:null,pendingVideoElementsForLaterAutoplay:null,lastCallForCollectClickForLaterAutoplay:null,isDrmReuseEnabled:null,waitQueueMaxSize:null,maxEmptyElementsForAutoplay:null,gestureRequiredForAutoplay:null,videoElementFactoryCallback:null});class w{constructor(){w.videoElementsManager.isDrmReuseEnabled=!1,f.isSamsungSmartTVTizen&&(w.videoElementsManager.gestureRequiredForAutoplay=!1),this.runDetectScripts();}runDetectScripts(){w.expose.player.list=Ut(this,this.listPlayers),w.expose.player.create=Ut(this,this.createPlayerInElement),w.expose.player.destroy=Ut(this,this.destroyPlayer),w.expose.player.close=Ut(this,this.closePlayer),w.expose.player.getById=Ut(this,this.getPlayerById),w.expose.player.getVersion=Ut(this,this.getVersion),w.expose.player.collectClickForLaterAutoplay=w.collectClickForLaterAutoplay,this.detectScript(),this.detectScriptAttributes();}getVersion(){return "v2.15.38"}getPlayerById(e){return w.players.h[e]}destroyPlayer(e){this.closePlayer(e);let t=window.document.getElementById(e.uid);null!=t&&t.parentNode.removeChild(t);let s=window.document.getElementById("player_con_"+e.uid.split("_")[1]);null!=s&&null!=s.remove&&s.remove();}closePlayer(e){if(null==e)return;let t=e.uid,s=w.players;Object.prototype.hasOwnProperty.call(s.h,t)&&delete s.h[t],e.destroy(!0);let n=window.document.getElementById("player_con_"+e.uid.split("_")[1]);null!=n&&Dt.__cast(n.parentNode,HTMLDivElement).removeAttribute("data-bradmax-player-pid");}checkIfPlayerExistInElement(e){return !!e.hasAttribute("data-bradmax-player-pid")}getPlayerByElement(e){return e.hasAttribute("data-bradmax-player-pid")?w.players.h["player_"+e.getAttribute("data-bradmax-player-pid")]:null}createPlayerInElement(e,t,s){return this.checkIfPlayerExistInElement(e)&&this.closePlayer(this.getPlayerByElement(e)),"string"==typeof t&&null==(t=st.decode(t))?(console.error("PLAYER VARIABLE DATA INVALID"),null):this.createPlayer(e,t,null,"inside",s)}setPlayerContainerStyles(e,t){e.setAttribute("id","player_con_"+t),e.style.display="block",e.style.position="relative",e.style.width="100%",e.style.height="100%",e.style.background="#000000",e.style.overflow="hidden";}setPlayerElementStyles(e,t){e.setAttribute("id",t),e.setAttribute("class","bsplayer"),e.style.display="block",e.style.position="relative",e.style.width="100%",e.style.height="100%",e.style.background="#000000",e.style.overflow="hidden";}createPlayer(e,t,s,n,r){if(null==n&&(n="before"),null==s){let e,t=24,n=lt.UID_CHARS.length,r="",l=0;for(;l<t;){let t;switch(e="xxxx-xxxx-xxxx-xxxx-xxxx".charAt(l++),e){case"-":case"_":t=e;break;default:t=lt.UID_CHARS.charAt(u.random(n));}r+=t;}s=r;}let l,i="player_"+s;if(this.setPID(e,s),null!=e.querySelector(".bsplayer")){l=e.querySelector(".bsplayer");let t=e.querySelector(".bsplayer").parentNode;this.setPlayerContainerStyles(t,s),this.setPlayerElementStyles(l,i);}else {let t=window.document.createElement("div");switch(this.setPlayerContainerStyles(t,s),n){case"before":e.parentElement.insertBefore(t,e);break;case"inside":e.appendChild(t);}l=window.document.createElement("div"),this.setPlayerElementStyles(l,i),t.appendChild(l);}return this.appendPlayer(this.useHTML5(l,t,i,r))}appendPlayer(e){if(w.players.h[e.uid]=e,window.hasOwnProperty("_ba_createPlayer")){let t=window._ba_createPlayer;if("function"==typeof t)try{t(e);}catch(e){}}return e}listPlayers(){let e=[],t=w.players.h,s=Object.keys(t),n=s.length,r=0;for(;r<n;)e.push(t[s[r++]]);return e}detectScriptAttributes(){let e=window.document.getElementsByTagName("script"),t=[],s=0;for(;s<e.length;)t.push(e[s++]);let n=function(e){let t=null!=e.innerText?h.trim(e.innerText):null;return !(null==t||!t.startsWith("{"))&&t.endsWith("}")},r=0;for(;r<t.length;){let e=t[r];if(++r,((l=e).hasAttribute("data-bs-variables")||n(l))&&l.hasAttribute("data-bs-parent-id")&&!l.hasAttribute("data-bradmax-player-pid")){let t={},r=null,l=e.getAttribute("data-bs-parent-id");try{if(r=window.document.getElementById(l),e.hasAttribute("data-bs-variables")&&(t=st.decode(e.getAttribute("data-bs-variables"))),(null==t||0==o.fields(t).length)&&null!=e.innerText&&n(e))try{t=JSON.parse(e.innerText);}catch(s){let e=at.caught(s).unwrap();return console.error("INNER TEXT VARIABLE INVALID DATA"),void console.error(e)}if(null==t)return void console.error("INLINE VARIABLE DATA INVALID")}catch(s){let e=at.caught(s).unwrap();return console.error("VARIABLE DATA INVALID"),void console.error(e)}if(null==r)return void console.error("ELEMENT ID NOT FOUND: "+l);this.createPlayer(r,t,null,"inside");}}var l;}detectScript(){let e=window.document.getElementsByTagName("script"),t=0;for(;t<e.length;){let s=e[t];if(++t,this.isEmptyPlayerScript(s)){let e={};try{e=JSON.parse(s.textContent);}catch(t){return void console.error("JSON DATA INVALID")}this.createPlayer(s,e);}}}isEmptyPlayerScript(e){return !(!e.hasAttribute("data-bigsoda-player")||e.hasAttribute("data-bradmax-player-pid"))}useHTML5(e,t,s,n){let r=o.field(o.field(w.expose,"player"),"composers"),l=o.fields(r);return p.createInstance(o.field(r,null==n?l[0]:n),[]).createPlayer(s,e,t,w.videoElementsManager)}setPID(e,t){return e.hasAttribute("data-bradmax-player-pid")||e.setAttribute("data-bradmax-player-pid",t),e.getAttribute("data-bradmax-player-pid")}__keepFieldsFix(){return p.getInstanceFields(w)}static main(){null==w.expose.player.embeder&&(w.expose.player.embeder={},null==o.field(w.expose.player.embeder,"modular_v2.15.38")&&(w.expose.player.embeder["modular_v2.15.38"]=new w));}static collectClickForLaterAutoplay(){w.videoElementsManager.collectClickForLaterAutoplay();}static getLastCallForCollectClickForLaterAutoplay(){return w.videoElementsManager.getLastCallForCollectClickForLaterAutoplay()}}e.bs.player.composer.Embeder=w,w.__name__="bs.player.composer.Embeder",Object.assign(w.prototype,{__class__:w});class E{constructor(){this.modules={},this.pluginsVideo=[],this.plugins=[],this.eventHub=M.getInstance();}destroy(e){if(null==e&&(e=!1),!e)return void window.bradmax.player.destroy(this);try{H.destroyMonitor(this.uid);}catch(t){let e=at.caught(t).unwrap();console.error({msg:"Exception catched during destroying monitor.",exception:e});}let t=0,s=this.plugins;for(;t<s.length;){let e=s[t];++t;try{e.destroy();}catch(t){let s=at.caught(t).unwrap();console.error({msg:"Exception catched during destroying plugin.",plugin:e,exception:s});}}for(;this.plugins.length>0;)this.plugins.pop();}activatePlugins(){let e=0,t=this.plugins;for(;e<t.length;){let s=t[e];++e;try{s.context=s.uid=this.uid,s.set_player(this),this.eventHub.registerPlugin(s),s.set_parentDisplay(this.parent),s.set_variables(this.data),this.modules[s.getPluginName()]=s,"JavascriptApi"==s.getPluginName()&&(this.api=s);}catch(e){this.handlePluginSetupException(at.caught(e).unwrap(),s,"registerPlugin");}}let s=0,n=this.plugins;for(;s<n.length;){let t=n[s];++s;try{t.create();}catch(e){this.handlePluginSetupException(at.caught(e).unwrap(),t,"create");}}let r=0,l=this.plugins;for(;r<l.length;){let t=l[r];++r;try{t.activate();}catch(e){this.handlePluginSetupException(at.caught(e).unwrap(),t,"activate");}}let i=0,a=this.plugins;for(;i<a.length;){let t=a[i];++i;try{t.postActivate();}catch(e){this.handlePluginSetupException(at.caught(e).unwrap(),t,"postActivate");}}}handlePluginSetupException(e,t,s){if(t.isCriticalForPlayback())throw new at("Cannot create player. Critical error occurred during player creation.\nException catched during plugin step: "+s+" . Plugin ["+t.className+"] critical for further playback.\nException:"+this.expceptionToString(e));{let n="Exception catched during plugin step: "+s+" . Non-critical plugin ["+t.className+"] - continuing playback. Err:"+this.expceptionToString(e);console.error(n);}}expceptionToString(e){let t="";return null!=e&&(null!=o.field(e,"message")?(t=u.string(o.field(e,"message"))+"\n",null!=o.field(e,"stack")&&(t+="Stack:\n"+u.string(o.field(e,"stack")))):t=u.string(e)),t}initialize(e,t){this.parent=e,this.data=nt.merge(exports.variables,t),H.getMonitor(this.uid),this.activatePlugins();}__keepFieldsFix(){return p.getInstanceFields(E)}}e.bs.player.core.Player=E,E.__name__="bs.player.core.Player",Object.assign(E.prototype,{__class__:E,uid:null,configuration:null,plugins:null,pluginsVideo:null,modules:null,api:null,parentDisplay:null,parent:null,data:null,eventHub:null});class v{constructor(e){this.className="bs.player.core.events.BaseEvent",this.type=e;}dispatch(e){M.getInstance().dispatch(e,S.__name__,this.type,this);}__keepFieldsFix(){return p.getInstanceFields(v)}}e.bs.player.core.events.BaseEvent=v,v.__name__="bs.player.core.events.BaseEvent",Object.assign(v.prototype,{__class__:v,className:null,type:null,data:null});class S extends v{constructor(e){super(e),this.className=S.__name__;}dispatch(e){M.getInstance().dispatch(e,S.__name__,this.type,this);}static addOnce(e,t,s){M.getInstance().addOnce(e,S.__name__,t,s);}static add(e,t,s){M.getInstance().add(e,S.__name__,t,s);}static remove(e,t,s){M.getInstance().remove(e,S.__name__,t,s);}static disable(e,t){M.getInstance().disable(e,S.__name__,t);}static enable(e,t){M.getInstance().enable(e,S.__name__,t);}}e.bs.player.core.events.AdEvent=S,S.__name__="bs.player.core.events.AdEvent",S.__super__=v,Object.assign(S.prototype,{__class__:S});class I extends v{constructor(e){super(e),this.className=I.__name__;}dispatch(e){M.getInstance().dispatch(e,I.__name__,this.type,this);}static addOnce(e,t,s){M.getInstance().addOnce(e,I.__name__,t,s);}static add(e,t,s){M.getInstance().add(e,I.__name__,t,s);}static remove(e,t,s){M.getInstance().remove(e,I.__name__,t,s);}static disable(e,t){M.getInstance().disable(e,I.__name__,t);}static enable(e,t){M.getInstance().enable(e,I.__name__,t);}}e.bs.player.core.events.ChromecastEvent=I,I.__name__="bs.player.core.events.ChromecastEvent",I.__super__=v,Object.assign(I.prototype,{__class__:I});class O extends v{constructor(e){super(e),this.className=O.__name__;}dispatch(e){M.getInstance().dispatch(e,O.__name__,this.type,this);}static add(e,t,s){M.getInstance().add(e,O.__name__,t,s);}static addOnce(e,t,s){M.getInstance().addOnce(e,O.__name__,t,s);}static remove(e,t,s){M.getInstance().remove(e,O.__name__,t,s);}static disable(e,t){M.getInstance().disable(e,O.__name__,t);}static enable(e,t){M.getInstance().enable(e,O.__name__,t);}static filter(e){}}e.bs.player.core.events.ControlEvent=O,O.__name__="bs.player.core.events.ControlEvent",O.__super__=v,Object.assign(O.prototype,{__class__:O});class C extends v{constructor(e){super(e),this.className=C.__name__;}dispatch(e){M.getInstance().dispatch(e,C.__name__,this.type,this);}static addOnce(e,t,s){M.getInstance().addOnce(e,C.__name__,t,s);}static add(e,t,s){M.getInstance().add(e,C.__name__,t,s);}static remove(e,t,s){M.getInstance().remove(e,C.__name__,t,s);}static disable(e,t){M.getInstance().disable(e,C.__name__,t);}static enable(e,t){M.getInstance().enable(e,C.__name__,t);}static filter(e){}static dispachAudioDataEvent(e,t){let s=new C("audioData");s.data=t,s.dispatch(e);}static dispachSubtitleDataEvent(e,t){let s=new C("subtitleData");s.data=t,s.dispatch(e);}static dispachVideoTrackDataEvent(e,t){let s=new C("videoTrackData");s.data=t,s.dispatch(e);}}e.bs.player.core.events.DataProviderEvent=C,C.__name__="bs.player.core.events.DataProviderEvent",C.__super__=v,Object.assign(C.prototype,{__class__:C});class P{constructor(){}__keepFieldsFix(){return p.getInstanceFields(P)}}e.bs.player.core.events.DataProviderEventScte35Tag=P,P.__name__="bs.player.core.events.DataProviderEventScte35Tag",Object.assign(P.prototype,{__class__:P,presentationTime:null,duration:null,messageData:null});class A extends v{constructor(e){super(e),this.className=A.__name__;}dispatch(e){M.getInstance().dispatch(e,A.__name__,this.type,this);}static addOnce(e,t,s){M.getInstance().addOnce(e,A.__name__,t,s);}static add(e,t,s){M.getInstance().add(e,A.__name__,t,s);}static remove(e,t,s){M.getInstance().remove(e,A.__name__,t,s);}static disable(e,t){M.getInstance().disable(e,A.__name__,t);}static enable(e,t){M.getInstance().enable(e,A.__name__,t);}}e.bs.player.core.events.DisplayEvent=A,A.__name__="bs.player.core.events.DisplayEvent",A.__super__=v,Object.assign(A.prototype,{__class__:A});class k extends v{constructor(e){super(e),this.className=k.__name__;}dispatch(e){M.getInstance().dispatch(e,k.__name__,this.type,this);}static addOnce(e,t,s){M.getInstance().addOnce(e,k.__name__,t,s);}static add(e,t,s){M.getInstance().add(e,k.__name__,t,s);}static remove(e,t,s){M.getInstance().remove(e,k.__name__,t,s);}static disable(e,t){M.getInstance().disable(e,k.__name__,t);}static enable(e,t){M.getInstance().enable(e,k.__name__,t);}}e.bs.player.core.events.EditEvent=k,k.__name__="bs.player.core.events.EditEvent",k.__super__=v,Object.assign(k.prototype,{__class__:k});class L extends v{constructor(e){super(e),this.className=L.__name__;}dispatch(e){M.getInstance().dispatch(e,L.__name__,this.type,this);}static add(e,t,s){M.getInstance().add(e,L.__name__,t,s);}static disable(e,t){M.getInstance().disable(e,L.__name__,t);}static enable(e,t){M.getInstance().enable(e,L.__name__,t);}static filter(e){}}e.bs.player.core.events.ErrorEvent=L,L.__name__="bs.player.core.events.ErrorEvent",L.__super__=v,Object.assign(L.prototype,{__class__:L,message:null});class F{constructor(){}setPlatformEvent(e){this.platformEvent=e;}stopPropagation(){null!=this.platformEvent.stopPropagation?(this.platformEvent.stopPropagation(),this.platformEvent.preventDefault()):this.platformEvent.cancelBubble=!0;}__keepFieldsFix(){return p.getInstanceFields(F)}static get_FULLSCREEN_CHANGE(){return F.fullscreenEventName}}e.bs.player.core.events.NativeEvent=F,F.__name__="bs.player.core.events.NativeEvent",F.__properties__={get_FULLSCREEN_CHANGE:"get_FULLSCREEN_CHANGE"},Object.assign(F.prototype,{__class__:F,currentTarget:null,target:null,type:null,mouseX:null,mouseY:null,wheelDelta:null,platformEvent:null});class D extends v{constructor(e){super(e),this.className=D.__name__;}}e.bs.player.core.events.PlayerCommandEvent=D,D.__name__="bs.player.core.events.PlayerCommandEvent",D.__super__=v,Object.assign(D.prototype,{__class__:D});class T extends v{constructor(e){super(e),this.className=T.__name__;}dispatch(e){M.getInstance().dispatch(e,T.__name__,this.type,this);}static add(e,t,s){M.getInstance().add(e,T.__name__,t,s);}static remove(e,t,s){M.getInstance().remove(e,T.__name__,t,s);}static disable(e,t){M.getInstance().disable(e,T.__name__,t);}static enable(e,t){M.getInstance().enable(e,T.__name__,t);}static filter(e){}}e.bs.player.core.events.ResizeEvent=T,T.__name__="bs.player.core.events.ResizeEvent",T.__super__=v,Object.assign(T.prototype,{__class__:T});class N extends v{constructor(e){super(e),this.className=N.__name__;}dispatch(e){M.getInstance().dispatch(e,N.__name__,this.type,this);}static add(e,t,s){M.getInstance().add(e,N.__name__,t,s);}static addOnce(e,t,s){M.getInstance().addOnce(e,N.__name__,t,s);}static remove(e,t,s){M.getInstance().remove(e,N.__name__,t,s);}static disable(e,t){M.getInstance().disable(e,N.__name__,t);}static enable(e,t){M.getInstance().enable(e,N.__name__,t);}static filter(e){}}e.bs.player.core.events.SphericalVideoEvent=N,N.__name__="bs.player.core.events.SphericalVideoEvent",N.__super__=v,Object.assign(N.prototype,{__class__:N});class U extends v{constructor(e){super(e),this.className=U.__name__;}dispatch(e){M.getInstance().dispatch(e,U.__name__,this.type,this);}static add(e,t,s){M.getInstance().add(e,U.__name__,t,s);}static remove(e,t,s){M.getInstance().remove(e,U.__name__,t,s);}static disable(e,t){M.getInstance().disable(e,U.__name__,t);}static enable(e,t){M.getInstance().enable(e,U.__name__,t);}static filter(e){}}e.bs.player.core.events.SubtitleEvent=U,U.__name__="bs.player.core.events.SubtitleEvent",U.__super__=v,Object.assign(U.prototype,{__class__:U});class j extends v{constructor(e){super(e),this.className=j.__name__;}dispatch(e){M.getInstance().dispatch(e,j.__name__,this.type,this);}static addOnce(e,t,s){M.getInstance().addOnce(e,j.__name__,t,s);}static add(e,t,s){M.getInstance().add(e,j.__name__,t,s);}static remove(e,t,s){M.getInstance().remove(e,j.__name__,t,s);}static disable(e,t){M.getInstance().disable(e,j.__name__,t);}static enable(e,t){M.getInstance().enable(e,j.__name__,t);}}e.bs.player.core.events.VideoEvent=j,j.__name__="bs.player.core.events.VideoEvent",j.__super__=v,Object.assign(j.prototype,{__class__:j});class M{constructor(){null==M.instance&&(this.plugins=[]);}registerPlugin(e){this.plugins.push(e),e.set_eventHub(this);}dispatch(e,t,s,n){let r=e+" | "+t+" | "+s;if(!this.isEnabled(r))return;let l=!1,i=0,a=this.plugins;for(;i<a.length;){let t=a[i];++i,t.context==e&&0==t.eventFilter(n)&&(l=!0);}if(!l){if(Object.prototype.hasOwnProperty.call(M.listenersMap.h,r)){let e=0,t=M.listenersMap.h[r];for(;e<t.length;)t[e++](n);}if(Object.prototype.hasOwnProperty.call(M.onceListenersMap.h,r)){let l=0,i=M.onceListenersMap.h[r];for(;l<i.length;)i[l++](n);let a=0,o=M.onceListenersMap.h[r];for(;a<o.length;)this.remove(e,t,s,o[a++]);}}}addOnce(e,t,s,n){let r,l=e+" | "+t+" | "+s;if(Object.prototype.hasOwnProperty.call(M.onceListenersMap.h,l))r=M.onceListenersMap.h[l];else {let e=[];M.onceListenersMap.h[l]=e,r=M.onceListenersMap.h[l];}let i=0;for(;i<r.length;)if(r[i++]==n)return !1;return r.push(n),!0}add(e,t,s,n){let r,l=e+" | "+t+" | "+s;if(Object.prototype.hasOwnProperty.call(M.listenersMap.h,l))r=M.listenersMap.h[l];else {let e=[];M.listenersMap.h[l]=e,r=M.listenersMap.h[l];}let i=0;for(;i<r.length;)if(r[i++]==n)return;r.push(n);}remove(e,t,s,n){let r=e+" | "+t+" | "+s;this.removeListenerFromMap(r,n,M.listenersMap),this.removeListenerFromMap(r,n,M.onceListenersMap);}isEnabled(e){let t=M.disabledListenersMap.h[e];return null==t||0==t}disable(e,t,s){let n=e+" | "+t+" | "+s,r=M.disabledListenersMap.h[n];M.disabledListenersMap.h[n]=null==r?1:r+1;}enable(e,t,s){let n=e+" | "+t+" | "+s,r=M.disabledListenersMap.h[n];if(null!=r&&r>0)if(--r,r<=0){let e=M.disabledListenersMap;Object.prototype.hasOwnProperty.call(e.h,n)&&delete e.h[n];}else M.disabledListenersMap.h[n]=r;}removeListenerFromMap(e,t,s){let n=[];if(Object.prototype.hasOwnProperty.call(s.h,e)&&(n=s.h[e]),n.length>0){let r=0;for(;r<n.length;)if(n[r++]==t){let r=n.slice();return i.remove(r,t),void(s.h[e]=r)}}}__keepFieldsFix(){return p.getInstanceFields(M)}static getInstance(){return M.instance}}e.bs.player.core.manager.EventHub=M,M.__name__="bs.player.core.manager.EventHub",Object.assign(M.prototype,{__class__:M,plugins:null});class B{constructor(e,t,s,n,r){this.langCodeLong=t,this.langCodeShort=e,this.englishName=s,this.nativeName=n,this.relatedLangCodes=r;}__keepFieldsFix(){return p.getInstanceFields(B)}}e.bs.player.core.manager.LangInfo=B,B.__name__="bs.player.core.manager.LangInfo",Object.assign(B.prototype,{__class__:B,langCodeShort:null,langCodeLong:null,englishName:null,nativeName:null,relatedLangCodes:null});class V{constructor(){if(null!=V.instance)return;let e=[];e.push(new B("no","nor",this.toUtf8("Norwegian"),this.toUtf8("Norsk"),["nb","nn"])),e.push(new B("nb","nob",this.toUtf8("Norwegian%20Bokm%C3%A5l"),this.toUtf8("Norsk"),["no","nn"])),e.push(new B("nn","nno",this.toUtf8("Norwegian%20Nynorsk"),this.toUtf8("Norsk%20nynorsk"),["no","nb"])),e.push(new B("da","dan",this.toUtf8("Danish"),this.toUtf8("dansk"),["dk"])),e.push(new B("sv","swe",this.toUtf8("Swedish"),this.toUtf8("svenska"),["se"])),e.push(new B("be","bel",this.toUtf8("Belarusian"),this.toUtf8("%D0%91%D0%B5%D0%BB%D0%B0%D1%80%D1%83%D1%81%D0%BA%D0%B0%D1%8F"))),e.push(new B("bs","bos",this.toUtf8("Bosnian"),this.toUtf8("bosanski%20jezik"))),e.push(new B("bg","bul",this.toUtf8("Bulgarian"),this.toUtf8("%D0%B1%D1%8A%D0%BB%D0%B3%D0%B0%D1%80%D1%81%D0%BA%D0%B8%20%D0%B5%D0%B7%D0%B8%D0%BA"))),e.push(new B("ca","cat",this.toUtf8("Catalan"),this.toUtf8("Catal%C3%A0"))),e.push(new B("hr","hrv",this.toUtf8("Croatian"),this.toUtf8("hrvatski"))),e.push(new B("cz","ces",this.toUtf8("Czech"),this.toUtf8("%C4%8Cesky"))),e.push(new B("nl","nld",this.toUtf8("Dutch"),this.toUtf8("Nederlands"),["dut"])),e.push(new B("en","eng",this.toUtf8("English"),this.toUtf8("English"))),e.push(new B("eo","epo",this.toUtf8("Esperanto"),this.toUtf8("Esperanto"))),e.push(new B("et","est",this.toUtf8("Estonian"),this.toUtf8("eesti"))),e.push(new B("es","spa",this.toUtf8("Spanish"),this.toUtf8("Espa%C3%B1ol"))),e.push(new B("fo","fao",this.toUtf8("Faroese"),this.toUtf8("f%C3%B8royskt"))),e.push(new B("fi","fin",this.toUtf8("Finnish"),this.toUtf8("suomi"))),e.push(new B("fr","fra",this.toUtf8("French"),this.toUtf8("fran%C3%A7ais"),["fre"])),e.push(new B("gl","glg",this.toUtf8("Galician"),this.toUtf8("Galego"))),e.push(new B("de","deu",this.toUtf8("German"),this.toUtf8("Deutsch"),["ger"])),e.push(new B("el","ell",this.toUtf8("Greek"),this.toUtf8("%CE%95%CE%BB%CE%BB%CE%B7%CE%BD%CE%B9%CE%BA%CE%AC"),["gre"])),e.push(new B("hu","hun",this.toUtf8("Hungarian"),this.toUtf8("Magyar"))),e.push(new B("ia","ina",this.toUtf8("Interlingua"),this.toUtf8("Interlingua"))),e.push(new B("it","ita",this.toUtf8("Italian"),this.toUtf8("Italiano"))),e.push(new B("ga","gle",this.toUtf8("Irish"),this.toUtf8("Gaeilge"))),e.push(new B("lb","ltz",this.toUtf8("Luxembourgish"),this.toUtf8("L%C3%ABtzebuergesch"))),e.push(new B("lt","lit",this.toUtf8("Lithuanian"),this.toUtf8("lietuvi%C5%B3"))),e.push(new B("lv","lav",this.toUtf8("Latvian"),this.toUtf8("latvi%C5%B3"))),e.push(new B("pl","pol",this.toUtf8("Polish"),this.toUtf8("polski"))),e.push(new B("pt","por",this.toUtf8("Portuguese"),this.toUtf8("Portugu%C3%AAs"))),e.push(new B("rm","roh",this.toUtf8("Romansh"),this.toUtf8("rumantsch%20grischun"))),e.push(new B("ro","ron",this.toUtf8("Romanian"),this.toUtf8("rom%C3%A2n%C4%83"),["rum"])),e.push(new B("ru","rus",this.toUtf8("Russian"),this.toUtf8("%D1%80%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9%20%D1%8F%D0%B7%D1%8B%D0%BA"))),e.push(new B("sk","slk",this.toUtf8("Slovak"),this.toUtf8("Sloven%C4%8Dina"),["slo"])),e.push(new B("sr","srp",this.toUtf8("Serbian"),this.toUtf8("%D0%A1%D1%80%D0%BF%D1%81%D0%BA%D0%B8"))),e.push(new B("sl","slv",this.toUtf8("Slovene"),this.toUtf8("Sloven%C5%A1%C4%8Dina"))),e.push(new B("tr","tur",this.toUtf8("Turkish"),this.toUtf8("T%C3%BCrk%C3%A7e"))),e.push(new B("uk","ukr",this.toUtf8("Ukrainian"),this.toUtf8("%D1%83%D0%BA%D1%80%D0%B0%D1%97%D0%BD%D1%81%D1%8C%D0%BA%D0%B0"))),e.push(new B("zk","chi",this.toUtf8("Chinese"),this.toUtf8("%E4%B8%AD%E6%96%87"),["zho","zh"])),e.push(new B("ms","may",this.toUtf8("Malay"),this.toUtf8("Bahasa Melayu"),["msa"])),e.push(new B("ar","ara",this.toUtf8("Arabic"),this.toUtf8("%D8%A7%D9%8E%D9%84%D9%92%D8%B9%D9%8E%D8%B1%D9%8E%D8%A8%D9%90%D9%8A%D9%8E%D9%91%D8%A9%D9%8F"),["arb"])),e.push(new B("cdo_","cdo",this.toUtf8("Min Dong Chinese"),this.toUtf8("Min Dong Chinese"))),e.push(new B("cjy_","cjy",this.toUtf8("Jinyu Chinese"),this.toUtf8("Jinyu Chinese"))),e.push(new B("cmn_","cmn",this.toUtf8("Mandarin Chinese"),this.toUtf8("Mandarin Chinese"))),e.push(new B("cpx_","cpx",this.toUtf8("Pu-Xian Chinese"),this.toUtf8("Pu-Xian Chinese"))),e.push(new B("czh_","czh",this.toUtf8("Huizhou Chinese"),this.toUtf8("Huizhou Chinese"))),e.push(new B("czo_","czo",this.toUtf8("Min Zhong Chinese"),this.toUtf8("Min Zhong Chinese"))),e.push(new B("gan_","gan",this.toUtf8("Gan Chinese"),this.toUtf8("Gan Chinese"))),e.push(new B("hak_","hak",this.toUtf8("Hakka Chinese"),this.toUtf8("Hakka Chinese"))),e.push(new B("hsn_","hsn",this.toUtf8("Xiang Chinese"),this.toUtf8("Xiang Chinese"))),e.push(new B("lzh_","lzh",this.toUtf8("Literary Chinese"),this.toUtf8("Literary Chinese"))),e.push(new B("mnp_","mnp",this.toUtf8("Min Bei Chinese"),this.toUtf8("Min Bei Chinese"))),e.push(new B("nan_","nan",this.toUtf8("Min Nan Chinese"),this.toUtf8("Min Nan Chinese"))),e.push(new B("wuu_","wuu",this.toUtf8("Wu Chinese"),this.toUtf8("Wu Chinese"))),e.push(new B("yue_","yue",this.toUtf8("Yue Chinese"),this.toUtf8("Yue Chinese"))),e.push(new B("cnp_","cnp",this.toUtf8("Northern Ping Chinese"),this.toUtf8("Northern Ping Chinese"))),e.push(new B("csp_","csp",this.toUtf8("Southern Ping Chinese"),this.toUtf8("Southern Ping Chinese"))),e.push(new B("mul_","mul",this.toUtf8("Multiple languages"),this.toUtf8("Multiple languages"))),e.push(new B("mis_","mis",this.toUtf8("No code for language"),this.toUtf8("No code for language"))),e.push(new B("und_","und",this.toUtf8("Undefined"),this.toUtf8("Undefined"))),this.setLangInfoList(e);}toUtf8(e){let t=null;return t=decodeURIComponent(e),t}setLangInfoList(e){this.langInfoList=e,this.langInfoByLangShortCode=new wt,this.langInfoByLangLongCode=new wt,this.langInfoByRelatedCode=new wt;let t=0,s=this.langInfoList;for(;t<s.length;){let e=s[t];++t,this.langInfoByLangShortCode.h[e.langCodeShort]=e,this.langInfoByLangLongCode.h[e.langCodeLong]=e;}let n=0,r=this.langInfoList;for(;n<r.length;){let e=r[n];if(++n,null!=e.relatedLangCodes){let t=0,s=e.relatedLangCodes;for(;t<s.length;)this.langInfoByRelatedCode.h[s[t++]]=e;}}}getLangInfoList(){return this.langInfoList}__keepFieldsFix(){return p.getInstanceFields(V)}static getInstance(){return V.instance}static getLanguageNativeNameByCode(e){try{e=e.toLowerCase();let t=V.getInstance();return Object.prototype.hasOwnProperty.call(t.langInfoByLangShortCode.h,e)?t.langInfoByLangShortCode.h[e].nativeName:Object.prototype.hasOwnProperty.call(t.langInfoByLangLongCode.h,e)?t.langInfoByLangLongCode.h[e].nativeName:Object.prototype.hasOwnProperty.call(t.langInfoByRelatedCode.h,e)?t.langInfoByRelatedCode.h[e].nativeName:null}catch(e){return ut.trace(at.caught(e).unwrap(),{fileName:"player/src/bs/player/core/manager/I18NHelper.hx",lineNumber:164,className:"bs.player.core.manager.I18NHelper",methodName:"getLanguageNativeNameByCode"}),null}}static getLanguageInfoByCode(e){try{e=e.toLowerCase();let t=V.getInstance();return Object.prototype.hasOwnProperty.call(t.langInfoByLangShortCode.h,e)?t.langInfoByLangShortCode.h[e]:Object.prototype.hasOwnProperty.call(t.langInfoByLangLongCode.h,e)?t.langInfoByLangLongCode.h[e]:Object.prototype.hasOwnProperty.call(t.langInfoByRelatedCode.h,e)?t.langInfoByRelatedCode.h[e]:null}catch(e){return ut.trace(at.caught(e).unwrap(),{fileName:"player/src/bs/player/core/manager/I18NHelper.hx",lineNumber:185,className:"bs.player.core.manager.I18NHelper",methodName:"getLanguageInfoByCode"}),null}}static findBestFittingLangCodeForSelected(e,t){e=e.toLowerCase();let s=V.getLanguageInfoByCode(e);if(null==s)return -1!=t.indexOf(e)?e:null;let n=[],r=0;for(;r<t.length;)n.push(V.getLanguageInfoByCode(t[r++]));let l=[];if(l.push(s),null!=s.relatedLangCodes){let e=0,t=s.relatedLangCodes;for(;e<t.length;){let s=V.getLanguageInfoByCode(t[e++]);null!=s&&l.push(s);}}let i=0;for(;i<l.length;){let e=l[i++],s=0,r=n.length;for(;s<r;){let r=s++,l=n[r];if(null!=l&&e.langCodeShort==l.langCodeShort)return t[r]}}return null}static normalizeLanguageNameFormat(e){return null==e?null:i.substr(e,0,1).toUpperCase()+i.substr(e,1,e.length)}static preselectSubtitlesSet(e,t){if("string"!=typeof e)return;if(null==e||null==t||0==t.length||"off"==e)return;let s=[],n=0;for(;n<t.length;)s.push(t[n++].languageCode);let r=V.findBestFittingLangCodeForSelected(e,s),l=0;for(;l<t.length;){let e=t[l];++l,r==e.languageCode&&(e.preselected=!0);}}}e.bs.player.core.manager.I18NHelper=V,V.__name__="bs.player.core.manager.I18NHelper",Object.assign(V.prototype,{__class__:V,langInfoList:null,langInfoByLangShortCode:null,langInfoByLangLongCode:null,langInfoByRelatedCode:null});class R{constructor(e){this.context=e,this.state="init";}init(){j.add(this.context,"bufferingStart",Ut(this,this.onVideoBuffering)),j.add(this.context,"complete",Ut(this,this.onVideoComplete)),j.add(this.context,"mediaError",Ut(this,this.onVideoError)),j.add(this.context,"playing",Ut(this,this.onVideoPlaying)),j.add(this.context,"paused",Ut(this,this.onVideoPaused)),j.add(this.context,"seekingStart",Ut(this,this.onVideoSeeking)),j.add(this.context,"seekingEnd",Ut(this,this.onVideoSeekingEnd)),S.add(this.context,"adPlaying",Ut(this,this.onVideoPlaying)),S.add(this.context,"adPaused",Ut(this,this.onVideoPaused)),S.add(this.context,"seekingStart",Ut(this,this.onVideoSeeking)),S.add(this.context,"seekingEnd",Ut(this,this.onVideoSeekingEnd)),C.add(this.context,"mediaMetadataData",Ut(this,this.onMetadataData)),C.add(this.context,"mediaAfterPlaybackStartMetadata",Ut(this,this.onAfterPlaybackStartMetadataData));}destroy(){j.remove(this.context,"bufferingStart",Ut(this,this.onVideoBuffering)),j.remove(this.context,"complete",Ut(this,this.onVideoComplete)),j.remove(this.context,"mediaError",Ut(this,this.onVideoError)),j.remove(this.context,"playing",Ut(this,this.onVideoPlaying)),j.remove(this.context,"paused",Ut(this,this.onVideoPaused)),j.remove(this.context,"seekingStart",Ut(this,this.onVideoSeeking)),j.remove(this.context,"seekingEnd",Ut(this,this.onVideoSeekingEnd)),S.remove(this.context,"adPlaying",Ut(this,this.onVideoPlaying)),S.remove(this.context,"adPaused",Ut(this,this.onVideoPaused)),S.remove(this.context,"seekingStart",Ut(this,this.onVideoSeeking)),S.remove(this.context,"seekingEnd",Ut(this,this.onVideoSeekingEnd)),C.remove(this.context,"mediaMetadataData",Ut(this,this.onMetadataData)),C.remove(this.context,"mediaAfterPlaybackStartMetadata",Ut(this,this.onAfterPlaybackStartMetadataData));}onVideoPlaying(e){this.state="playing";}onVideoComplete(e){this.state="complete";}onVideoPaused(e){this.state="paused";}onVideoBuffering(e){this.state="buffering";}onVideoError(e){this.state="error";}onVideoSeeking(e){this.state="seeking";}onVideoSeekingEnd(e){this.state="playing",null!=e&&null!=e.data&&null!=e.data.media&&(e.data.media.mediaPlaybackInfo.isPlaying||(this.state="paused"));}onMetadataData(e){this.state="init",this.currentMedia=null!=e?e.data:null;}onAfterPlaybackStartMetadataData(e){this.currentMedia=null!=e?e.data:null;}__keepFieldsFix(){return p.getInstanceFields(R)}}e.bs.player.core.manager.PlaybackStateMonitor=R,R.__name__="bs.player.core.manager.PlaybackStateMonitor",Object.assign(R.prototype,{__class__:R,context:null,state:null,currentMedia:null});class H{__keepFieldsFix(){return p.getInstanceFields(H)}static getMonitor(e){if(!Object.prototype.hasOwnProperty.call(H.monitors.h,e)){let t=new R(e);H.monitors.h[e]=t,t.init();}return H.monitors.h[e]}static destroyMonitor(e){if(Object.prototype.hasOwnProperty.call(H.monitors.h,e)){H.monitors.h[e].destroy();let t=H.monitors;Object.prototype.hasOwnProperty.call(t.h,e)&&delete t.h[e];}}}e.bs.player.core.manager.PlaybackStateRegister=H,H.__name__="bs.player.core.manager.PlaybackStateRegister",Object.assign(H.prototype,{__class__:H});class W{constructor(){W._hx_skip_constructor||this._hx_constructor();}_hx_constructor(){this.customParams=new wt;}__keepFieldsFix(){return p.getInstanceFields(W)}}e.bs.player.core.model.ModelObject=W,W.__name__="bs.player.core.model.ModelObject",Object.assign(W.prototype,{__class__:W,id:null,customParams:null});class q extends W{constructor(){super();}}e.bs.player.core.model.LiveStreamInfo=q,q.__name__="bs.player.core.model.LiveStreamInfo",q.__super__=W,Object.assign(q.prototype,{__class__:q,channelInfo:null,episodeInfo:null,seasonInfo:null,seriesInfo:null,liveProgramInfo:null});class z extends W{constructor(){super();}}e.bs.player.core.model.LiveChannelInfo=z,z.__name__="bs.player.core.model.LiveChannelInfo",z.__super__=W,Object.assign(z.prototype,{__class__:z,name:null});class G extends W{constructor(){super(),this.mediaDetails=new re,this.mediaUserSettings=new le,this.mediaSettings=new ie,this.mediaPlaybackInfo=new ae,this.progress=new Ie,this.drmCustomLicenseServerHandler=null,this.failedPlaybackPlayers=new wt,this.spherical=!1,this.contentMeta=new wt;}getLimitOfRestartsOnError(){let e=this.drmCustomLicenseServerHandler;if(null!=(null!=e?e.getLastError():null))return G.DEFAULT_MAX_RESTARTS_ON_DRM_LICENSE_ISSUE;let t=this.customParams;return (null!=t?t.h.maxRestartsNumOnPlaybackError:null)>=0?this.customParams.h.maxRestartsNumOnPlaybackError:this.getDefaultStreamRestartsOnError()}getDefaultStreamRestartsOnError(){return 3}hasFallbackSources(){return !(null!=this.source&&this.source.length>0&&null!=this.source[0]&&this.source[0].hasDaiFallbackToOrigin&&null!=this.mediaPlaybackInfo&&!this.mediaPlaybackInfo.isInStreamAdvertisementPlaying)&&(null!=this.source&&this.source.length>1||null!=this.sourceFallbacks&&this.sourceFallbacks.length>0&&this.sourceFallbacks[0].length>0)}useFallbackSources(){this.hasFallbackSources()&&(null!=this.source&&this.source.length>1?this.source=this.source.slice(1):(this.source=this.sourceFallbacks[0],this.sourceFallbacks=this.sourceFallbacks.slice(1)));}copyFieldsTo(e){let t=p.getInstanceFields(G),s=0;for(;s<t.length;){let n=t[s];++s;let r=o.field(this,n);o.isFunction(r)||(e[n]=r);}}}e.bs.player.core.model.Media=G,G.__name__="bs.player.core.model.Media",G.__super__=W,Object.assign(G.prototype,{__class__:G,title:null,duration:null,source:null,sourceFallbacks:null,subtitlesSets:null,audioSets:null,splashImages:null,posterImages:null,mediaDetails:null,mediaUserSettings:null,mediaSettings:null,mediaPlaybackInfo:null,mediaLandingPage:null,mediaPlaylist:null,drmCustomLicenseServerHandler:null,progress:null,failedPlaybackPlayers:null,spherical:null,contentMeta:null});class X extends G{constructor(){super();}getDefaultStreamRestartsOnError(){return 5}}e.bs.player.core.model.Live=X,X.__name__="bs.player.core.model.Live",X.__super__=G,Object.assign(X.prototype,{__class__:X,dvrWindowLength:null,dvrWindowLiveEdge:null,lowLatencyMode:null,liveStreamInfo:null});class Q extends G{constructor(){super();}}e.bs.player.core.model.Catchup=Q,Q.__name__="bs.player.core.model.Catchup",Q.__super__=G,Object.assign(Q.prototype,{__class__:Q,liveStreamInfo:null});class Y extends X{constructor(){super();}}e.bs.player.core.model.LiveStream=Y,Y.__name__="bs.player.core.model.LiveStream",Y.__super__=X,Object.assign(Y.prototype,{__class__:Y,streamEnd:null,streamEndThankYouImageUrl:null,streamWaitingForTransmissionImageUrl:null});class J extends X{constructor(){super();}findProgramForDate(e){if(null==this.programs)return null;null==e&&(e=new Date);let t=e.getTime(),s=0,n=this.programs;for(;s<n.length;){let e=n[s];if(++s,e.eventStart.getTime()<=t&&t<e.eventEnd.getTime())return e}return null}}e.bs.player.core.model.LiveChannel=J,J.__name__="bs.player.core.model.LiveChannel",J.__super__=X,Object.assign(J.prototype,{__class__:J,name:null,logoImages:null,programs:null});class K extends X{constructor(){super();}}e.bs.player.core.model.LiveProgramStream=K,K.__name__="bs.player.core.model.LiveProgramStream",K.__super__=X,Object.assign(K.prototype,{__class__:K});class Z extends W{constructor(){super();}}e.bs.player.core.model.LiveProgram=Z,Z.__name__="bs.player.core.model.LiveProgram",Z.__super__=W,Object.assign(Z.prototype,{__class__:Z,title:null,descriptionLong:null,descriptionShort:null,eventStart:null,eventEnd:null});class $ extends W{constructor(){super(),this.authParams=new wt;}}e.bs.player.core.model.User=$,$.__name__="bs.player.core.model.User",$.__super__=W,Object.assign($.prototype,{__class__:$,name:null,language:null,domain:null,authParams:null});class ee{constructor(){this.currentPos=-1,this.items=[];}hasNext(){return this.currentPos+1<this.items.length}next(){return this.currentPos<this.items.length&&this.currentPos++,0<=this.currentPos&&this.currentPos<this.items.length?this.items[this.currentPos]:null}reset(){this.currentPos=-1;}shift(){this.reset(),this.items.shift();}get_length(){return null!=this.items?this.items.length:0}__keepFieldsFix(){return p.getInstanceFields(ee)}static clone(e){if(null==e)return null;let t=new ee,s=e.items,n=new Array(s.length),r=0,l=s.length;for(;r<l;){let e=r++;n[e]=s[e];}return t.items=n,t.currentPos=e.currentPos+0|0,t}}e.bs.player.core.model.MediaPlaylist=ee,ee.__name__="bs.player.core.model.MediaPlaylist",Object.assign(ee.prototype,{__class__:ee,items:null,currentPos:null,length:null,__properties__:{get_length:"get_length"}});class te extends W{constructor(){W._hx_skip_constructor=!0,super(),W._hx_skip_constructor=!1,this._hx_constructor();}_hx_constructor(){this.isTokenised=!1,this.hasDaiFallbackToOrigin=!1,super._hx_constructor();}isValid(e){let t=new l("exp=([0-9]+)","g");if(t.match(this.url)){let s=u.parseInt(t.matched(1));return null==e&&(e=(new Date).getTime()/1e3),e<s}return null!=this.url}}e.bs.player.core.model.MediaSource=te,te.__name__="bs.player.core.model.MediaSource",te.__super__=W,Object.assign(te.prototype,{__class__:te,url:null,contentType:null,width:null,height:null,bitrate:null,drm:null,spherical:null,hasDaiFallbackToOrigin:null,isTokenised:null});class se extends W{constructor(){super();}}e.bs.player.core.model.Drm=se,se.__name__="bs.player.core.model.Drm",se.__super__=W,Object.assign(se.prototype,{__class__:se,provider:null,selectedDrmSystem:null,playready:null,widevine:null,fairplay:null});class ne extends W{constructor(){super();}}e.bs.player.core.model.DrmData=ne,ne.__name__="bs.player.core.model.DrmData",ne.__super__=W,Object.assign(ne.prototype,{__class__:ne,laUrl:null,customData:null,certUrl:null,audioRobustness:null,videoRobustness:null});class re{constructor(){}__keepFieldsFix(){return p.getInstanceFields(re)}}e.bs.player.core.model.MediaDetails=re,re.__name__="bs.player.core.model.MediaDetails",Object.assign(re.prototype,{__class__:re,tags:null,genres:null,descriptionLong:null,descriptionShort:null,year:null,mediaCast:null,directors:null,customParams:null});class le{constructor(){}__keepFieldsFix(){return p.getInstanceFields(le)}}e.bs.player.core.model.MediaUserSettings=le,le.__name__="bs.player.core.model.MediaUserSettings",Object.assign(le.prototype,{__class__:le,wasWatched:null,isFavorite:null,resumePostion:null,hasWatchingFinished:null});class ie{constructor(){this.hasConcurrencyControl=!1,this.customParams=new wt;}__keepFieldsFix(){return p.getInstanceFields(ie)}}e.bs.player.core.model.MediaSettings=ie,ie.__name__="bs.player.core.model.MediaSettings",Object.assign(ie.prototype,{__class__:ie,hasConcurrencyControl:null,customParams:null});class ae{constructor(){this.currentTime=null,this.currentTotalBitrateKpbs=null,this.playbackRate=null,this.isPlaying=!1,this.isInStreamAdvertisementPlaying=!1,this.customParams=new wt;}__keepFieldsFix(){return p.getInstanceFields(ae)}}e.bs.player.core.model.MediaPlaybackInfo=ae,ae.__name__="bs.player.core.model.MediaPlaybackInfo",Object.assign(ae.prototype,{__class__:ae,currentTime:null,currentTotalBitrateKpbs:null,playbackRate:null,isPlaying:null,isInStreamAdvertisementPlaying:null,customParams:null});class oe extends W{constructor(){super();}}e.bs.player.core.model.Playlist=oe,oe.__name__="bs.player.core.model.Playlist",oe.__super__=W,Object.assign(oe.prototype,{__class__:oe,mediaList:null});class ue extends W{constructor(){W._hx_skip_constructor=!0,super(),W._hx_skip_constructor=!1,this._hx_constructor();}_hx_constructor(){this.kind=null,super._hx_constructor();}}e.bs.player.core.model.SubtitlesSet=ue,ue.__name__="bs.player.core.model.SubtitlesSet",ue.__super__=W,Object.assign(ue.prototype,{__class__:ue,languageCode:null,name:null,subtitleEntries:null,url:null,preselected:null,kind:null,i18n:null});class ce{constructor(){this.showTime=0,this.hideTime=0,this.customParams=new wt,this.texts=[];}__keepFieldsFix(){return p.getInstanceFields(ce)}}e.bs.player.core.model.SubtitleEntry=ce,ce.__name__="bs.player.core.model.SubtitleEntry",Object.assign(ce.prototype,{__class__:ce,showTime:null,hideTime:null,texts:null,customParams:null});class _e{constructor(){}__keepFieldsFix(){return p.getInstanceFields(_e)}}e.bs.player.core.model.SubtitleEntryText=_e,_e.__name__="bs.player.core.model.SubtitleEntryText",Object.assign(_e.prototype,{__class__:_e,styles:null,text:null});class he extends W{constructor(){W._hx_skip_constructor=!0,super(),W._hx_skip_constructor=!1,this._hx_constructor();}_hx_constructor(){this.kind=null,this.isDefault=!1,super._hx_constructor();}}e.bs.player.core.model.AudioSet=he,he.__name__="bs.player.core.model.AudioSet",he.__super__=W,Object.assign(he.prototype,{__class__:he,languageCode:null,name:null,isDefault:null,preselected:null,kind:null,i18n:null});class pe extends W{constructor(){W._hx_skip_constructor=!0,super(),W._hx_skip_constructor=!1,this._hx_constructor();}_hx_constructor(){this.kind=null,super._hx_constructor();}}e.bs.player.core.model.VideoSet=pe,pe.__name__="bs.player.core.model.VideoSet",pe.__super__=W,Object.assign(pe.prototype,{__class__:pe,languageCode:null,name:null,preselected:null,kind:null,i18n:null});class de extends W{constructor(){super();}}e.bs.player.core.model.Image=de,de.__name__="bs.player.core.model.Image",de.__super__=W,Object.assign(de.prototype,{__class__:de,url:null,width:null,height:null});class me extends W{constructor(){super();}}e.bs.player.core.model.Genre=me,me.__name__="bs.player.core.model.Genre",me.__super__=W,Object.assign(me.prototype,{__class__:me,name:null});class ge{constructor(){this.currentOrderNumber=1,this.totalNumber=1,this.durationPlayed=0,this.customParams=new wt;}__keepFieldsFix(){return p.getInstanceFields(ge)}}e.bs.player.core.model.AdMedia=ge,ge.__name__="bs.player.core.model.AdMedia",Object.assign(ge.prototype,{__class__:ge,media:null,mediaClickTargetUrl:null,currentOrderNumber:null,totalNumber:null,durationPlayed:null,durationTotal:null,adId:null,customParams:null,ui:null,adStartTime:null});class ye extends W{constructor(e){super(),this.disabled=e,this.playButton=!e,this.muteButton=!e,this.showAdLabel=!e,this.showAdTime=!e,this.showAdCounter=!e,this.showSkipButton=!e;}}e.bs.player.core.model.AdMediaUi=ye,ye.__name__="bs.player.core.model.AdMediaUi",ye.__super__=W,Object.assign(ye.prototype,{__class__:ye,disabled:null,playButton:null,muteButton:null,showAdLabel:null,showAdCounter:null,showAdTime:null,showSkipButton:null});class be{constructor(e,t,s,n){this.offset=e,this.duration=t,this.position=s,this.adsCount=n;}__keepFieldsFix(){return p.getInstanceFields(be)}}e.bs.player.core.model.AdInStreamBreakInfo=be,be.__name__="bs.player.core.model.AdInStreamBreakInfo",Object.assign(be.prototype,{__class__:be,offset:null,duration:null,position:null,adsCount:null});class fe{constructor(e,t){this.label=e,this.data=t;}__keepFieldsFix(){return p.getInstanceFields(fe)}}e.bs.player.core.model.VideoQualityEventData=fe,fe.__name__="bs.player.core.model.VideoQualityEventData",Object.assign(fe.prototype,{__class__:fe,label:null,data:null,bitrateKbps:null,width:null,height:null});class xe{constructor(e,t,s,n){null==n&&(n="top"),null==s&&(s="left"),this.x=e,this.width=t,this.xPos=s,this.yPos=n;}__keepFieldsFix(){return p.getInstanceFields(xe)}}e.bs.player.core.model.BrandImageLoadedEventData=xe,xe.__name__="bs.player.core.model.BrandImageLoadedEventData",Object.assign(xe.prototype,{__class__:xe,x:null,width:null,yPos:null,xPos:null});class we{}we.__name__="bs.player.core.model.DrmCustomLicenseServerHandler",we.__isInterface__=!0,Object.assign(we.prototype,{__class__:we,getLastError:null});class Ee{__keepFieldsFix(){return p.getInstanceFields(Ee)}}e.bs.player.core.model.MediaProgressSegment=Ee,Ee.__name__="bs.player.core.model.MediaProgressSegment",Object.assign(Ee.prototype,{__class__:Ee,duration:null,label:null});class ve{__keepFieldsFix(){return p.getInstanceFields(ve)}}e.bs.player.core.model.MediaProgressMarker=ve,ve.__name__="bs.player.core.model.MediaProgressMarker",Object.assign(ve.prototype,{__class__:ve,time:null,label:null});class Se{__keepFieldsFix(){return p.getInstanceFields(Se)}}e.bs.player.core.model.MediaProgressThumbnails=Se,Se.__name__="bs.player.core.model.MediaProgressThumbnails",Object.assign(Se.prototype,{__class__:Se,url:null,imageBaseUrl:null});class Ie{constructor(){this.segments=null,this.segmentsUrl=null,this.markers=null,this.markersUrl=null,this.thumbnails=null;}__keepFieldsFix(){return p.getInstanceFields(Ie)}}e.bs.player.core.model.MediaProgress=Ie,Ie.__name__="bs.player.core.model.MediaProgress",Object.assign(Ie.prototype,{__class__:Ie,segmentsUrl:null,segments:null,markersUrl:null,markers:null,thumbnails:null});class Oe{constructor(e,t){null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t;}__keepFieldsFix(){return p.getInstanceFields(Oe)}}e.bs.player.core.model.Point=Oe,Oe.__name__="bs.player.core.model.Point",Object.assign(Oe.prototype,{__class__:Oe,x:null,y:null});class Ce extends G{constructor(){super();}}e.bs.player.core.model.Episode=Ce,Ce.__name__="bs.player.core.model.Episode",Ce.__super__=G,Object.assign(Ce.prototype,{__class__:Ce,episodeNumber:null,season:null});class Pe extends W{constructor(){super();}}e.bs.player.core.model.EpisodeInfo=Pe,Pe.__name__="bs.player.core.model.EpisodeInfo",Pe.__super__=W,Object.assign(Pe.prototype,{__class__:Pe,episodeNumber:null,title:null});class Ae extends W{constructor(){super();}}e.bs.player.core.model.Season=Ae,Ae.__name__="bs.player.core.model.Season",Ae.__super__=W,Object.assign(Ae.prototype,{__class__:Ae,title:null,descriptionShort:null,descriptionLong:null,images:null,seasonNumber:null,serie:null,episodes:null});class ke extends W{constructor(){super();}}e.bs.player.core.model.Serie=ke,ke.__name__="bs.player.core.model.Serie",ke.__super__=W,Object.assign(ke.prototype,{__class__:ke,title:null,descriptionShort:null,descriptionLong:null,images:null,seasons:null});class Le{__keepFieldsFix(){return p.getInstanceFields(Le)}}e.bs.player.core.model.SocialShareData=Le,Le.__name__="bs.player.core.model.SocialShareData",Object.assign(Le.prototype,{__class__:Le,url:null,title:null});class Fe{constructor(e,t,s,n,r){this.y=0,this.x=0,this.url=e,this.width=t,this.height=s,this.x=null!=n?n:this.x,this.y=null!=r?r:this.y;}__keepFieldsFix(){return p.getInstanceFields(Fe)}}e.bs.player.core.model.Thumbnail=Fe,Fe.__name__="bs.player.core.model.Thumbnail",Object.assign(Fe.prototype,{__class__:Fe,url:null,width:null,height:null,x:null,y:null});class De{constructor(e){null==e&&(e=5),this.pluginName="";let t=Dt.getClass(this);this.pluginName=t.__name__.split(".").pop(),this.initPriority=e;let s=this.pluginName,n=exports.configuration;this.pluginConfig=null!=n&&Object.prototype.hasOwnProperty.call(n,s)?o.field(n,s):Object.create(null);}create(){}destroy(){}activate(){}postActivate(){}deactivate(){}eventFilter(e){return !0}registerPlugin(e){}getPluginVersion(){return "v2.15.38"}getPluginName(){return this.pluginName}get_player(){return this.player}set_player(e){return this.player=e}get_variables(){return this.variables}set_variables(e){return this.variables=e}get_eventHub(){return this.eventHub}set_eventHub(e){return this.eventHub=e}get_parentDisplay(){return this.parentDisplay}set_parentDisplay(e){return this.parentDisplay=e}get_display(){return this.display}isCriticalForPlayback(){return !0}}De.__name__="bs.player.core.plugin.PluginBase",Object.assign(De.prototype,{__class__:De,uid:null,context:null,className:null,videoElementsManager:null,pluginName:null,initPriority:null,pluginConfig:null,variables:null,eventHub:null,parentDisplay:null,display:null,player:null,__properties__:{set_player:"set_player",get_player:"get_player",get_display:"get_display",set_parentDisplay:"set_parentDisplay",get_parentDisplay:"get_parentDisplay",set_eventHub:"set_eventHub",get_eventHub:"get_eventHub",set_variables:"set_variables",get_variables:"get_variables"}});class Te{__keepFieldsFix(){return p.getInstanceFields(Te)}static readPluginConfig(e){let t,s=Dt.getClass(e);if(0==o.isObject(s))t=!1;else {let e=Object.prototype.hasOwnProperty.call(s,"__plugfaces__")?o.field(s,"__plugfaces__"):null;t=null!=e&&e.indexOf("IVideoPlayer")>-1;}if(0==t)return Object.create(null);let n=s.__name__.split(".").pop(),r=exports.configuration;return null!=r&&Object.prototype.hasOwnProperty.call(r,n)?o.field(r,n):Object.create(null)}}e.bs.player.core.plugin.VideoPlayerUtil=Te,Te.__name__="bs.player.core.plugin.VideoPlayerUtil",Object.assign(Te.prototype,{__class__:Te});class Ne{constructor(e,t,s){this.remotePlayerController=null,this.remotePlayer=null,this.context=null,this.applicationId=null,this.context=e,this.onApiLoadListener=t,this.applicationId=s,null==this.applicationId&&(this.applicationId="53001214"),this.isConnected=!1,null==Ne.instances&&(Ne.instances=[]),Ne.instances.push(this),Ne.libLoaded||(Ne.libLoaded=!0,this.checkScriptLoad(),this.loadScript()),O.add(e,"chromecast",Ut(this,this.onChromecast)),Ne._isAvailable&&(this.onCastApiInitialization(),null!=t&&ct.delay(t,0));}get_isAvailable(){return Ne._isAvailable}onChromecast(e){this.getChromeCast().requestSession(),this.createSession();}connect(){if(!this.isConnected){this.isConnected=!0;let e=new I("connected");e.data={session:this.castSession,sender:this},e.dispatch(this.context),new j("videoCastingStart").dispatch(this.context);}}disconnect(){if(this.isConnected){this.isConnected=!1,this.castSession=null;let e=new I("disconnected");e.data={},e.dispatch(this.context),new j("videoCastingEnd").dispatch(this.context),this.getCast().framework.CastContext.getInstance().endCurrentSession(!0);}}createSession(){null==this.castSession&&this.monitorSessionCreation();}monitorSessionCreation(){null==this.castSession&&(this.castSession=this.getCast().framework.CastContext.getInstance().getCurrentSession()),null!=this.castSession?(this.connect(),this.monitorSessionTimer=new ct(1e3),this.monitorSessionTimer.run=Ut(this,this.monitorSession)):this.monitorSessionCreationTimer=ct.delay(Ut(this,this.monitorSessionCreation),500);}monitorSession(){null!=this.castSession&&"SESSION_ENDED"!=this.castSession.getSessionState()||(null!=this.monitorSessionTimer&&this.monitorSessionTimer.stop(),this.disconnect());}newRemotePlayerController(e){return new window.cast.framework.RemotePlayerController(e)}newRemotePlayer(){return new window.cast.framework.RemotePlayer}newLoadRequest(e){return new window.chrome.cast.media.LoadRequest(e)}newMediaInfo(e,t){return new window.chrome.cast.media.MediaInfo(e,t)}newGenericMediaMetadata(){return new window.chrome.cast.media.GenericMediaMetadata}newImage(e){return new window.chrome.cast.Image(e)}castMediaImage(e){let t,s,n=this.newImage(e.url);if(null!=e.width){let s=e.width;t=!isNaN(s);}else t=!1;if(t&&(n.width=e.width),null!=e.height){let t=e.height;s=!isNaN(t);}else s=!1;return s&&(n.height=e.height),n}onCastApiInitialization(){null!=this.getCast().framework?this.getCast().framework.CastContext.getInstance().setOptions({receiverApplicationId:this.applicationId,autoJoinPolicy:this.getChromeCast().AutoJoinPolicy.ORIGIN_SCOPED}):console.warn("Cannot start Chromecast. Try restart browser and Chromecast device.");}getChromeCast(){return window.chrome.cast}getChrome(){return window.chrome}getCast(){return window.cast}checkScriptLoad(){window.__onGCastApiAvailable=Ne.initializeCastApi;}loadScript(){var e=document.getElementsByTagName("head")[0],t=document.createElement("script");t.type="text/javascript",t.src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1",e.appendChild(t);}destroy(){if(this.disconnect(),null!=Ne.instances){let e=Ne.instances.indexOf(this);e>=0&&Ne.instances.splice(e,1);}}__keepFieldsFix(){return p.getInstanceFields(Ne)}static initializeCastApi(e){if(Ne._isAvailable=e,e){let e=Ne.instances[0];null==e||null==e.getCast()||null==e.getChromeCast()?Ne._isAvailable=!1:e.onCastApiInitialization();}let t=0,s=Ne.instances;for(;t<s.length;){let e=s[t];++t,null!=e.onApiLoadListener&&e.onApiLoadListener();}}}e.bs.player.core.plugin.chromecast.ChromecastSender=Ne,Ne.__name__="bs.player.core.plugin.chromecast.ChromecastSender",Object.assign(Ne.prototype,{__class__:Ne,applicationId:null,context:null,remotePlayer:null,remotePlayerController:null,castSession:null,onApiLoadListener:null,monitorSessionTimer:null,monitorSessionCreationTimer:null,isConnected:null,isAvailable:null,__properties__:{get_isAvailable:"get_isAvailable"}});class je{constructor(e,t,s,n,r,l,i,a){null==l&&(l=!1),this.progressPercent=e,this.progressLeft=t,this.progressRight=s,this.progress=n,this.width=r,this.isLast=l,this.label=i,this.duration=a;}__keepFieldsFix(){return p.getInstanceFields(je)}}e.bs.player.core.vtt.ProgressSegmentData=je,je.__name__="bs.player.core.vtt.ProgressSegmentData",Object.assign(je.prototype,{__class__:je,progressPercent:null,progressLeft:null,progressRight:null,progress:null,width:null,label:null,duration:null,isLast:null});class Me{constructor(e,t,s){this.left=e,this.progress=t,this.label=s;}__keepFieldsFix(){return p.getInstanceFields(Me)}}e.bs.player.core.vtt.ProgressMarkerData=Me,Me.__name__="bs.player.core.vtt.ProgressMarkerData",Object.assign(Me.prototype,{__class__:Me,left:null,progress:null,label:null});class Be{constructor(){this.showTime=0,this.hideTime=0;}__keepFieldsFix(){return p.getInstanceFields(Be)}}e.bs.player.core.vtt.ProgressThumbnailEntry=Be,Be.__name__="bs.player.core.vtt.ProgressThumbnailEntry",Object.assign(Be.prototype,{__class__:Be,id:null,showTime:null,hideTime:null,source:null});class Ve{constructor(){}__keepFieldsFix(){return p.getInstanceFields(Ve)}}e.bs.player.core.vtt.ProgressThumbnailSize=Ve,Ve.__name__="bs.player.core.vtt.ProgressThumbnailSize",Object.assign(Ve.prototype,{__class__:Ve,w:null,h:null});class Re extends Ve{constructor(){super();}}e.bs.player.core.vtt.ProgressThumbnailItem=Re,Re.__name__="bs.player.core.vtt.ProgressThumbnailItem",Re.__super__=Ve,Object.assign(Re.prototype,{__class__:Re,imageId:null,url:null,x:null,y:null});class He extends Re{constructor(){super();}}e.bs.player.core.vtt.ProgressThumbnailSource=He,He.__name__="bs.player.core.vtt.ProgressThumbnailSource",He.__super__=Re,Object.assign(He.prototype,{__class__:He,id:null});class We extends Re{constructor(e,t,s,n){super(),this.imageId=e,this.url=t,this.x=NaN,this.y=NaN,this.w=s,this.h=n,this.renderWidth=s,this.renderHeight=n;}}e.bs.player.core.vtt.ProgressThumbnailImage=We,We.__name__="bs.player.core.vtt.ProgressThumbnailImage",We.__super__=Re,Object.assign(We.prototype,{__class__:We,renderWidth:null,renderHeight:null});class qe{constructor(){this.showTime=0;}__keepFieldsFix(){return p.getInstanceFields(qe)}}e.bs.player.core.vtt.VttMarkersParserEntry=qe,qe.__name__="bs.player.core.vtt.VttMarkersParserEntry",Object.assign(qe.prototype,{__class__:qe,id:null,showTime:null,text:null});class ze{constructor(){ze._hx_skip_constructor||this._hx_constructor();}_hx_constructor(){this.lineNumber=0,this.TIMESTAMP_SEPARATOR=" --\x3e ",this.WHITESPACE_REGEX=new l("[ \t\r\n]+","g"),this.END_LINE_REGEX=new l("(\r\n)|(\n)","g");}readLine(){let e=this.lines[this.lineNumber];return this.lineNumber++,null!=e&&0==this.lineNumber?h.replace(e,"\ufeff",""):e}isFileEnd(){return this.lineNumber>=this.lines.length}isEmptyStr(e){return null==e||""==e}skipEmptyLines(){let e=this.readLine();for(;this.isEmptyStr(e)&&!this.isFileEnd();)e=this.readLine();this.isFileEnd()||this.lineNumber--;}parseTimestamp(e){let t=e.split("."),s=t[0].split(":"),n=t[1],r=s.pop(),l=s.pop(),i=s.pop(),a=0;return a=0+3600*(null==i?0:u.parseInt(i)),a+=60*(null==l?0:u.parseInt(l)),a+=null==r?0:u.parseInt(r),a+=(null==n?0:u.parseInt(n))/1e3,a}parseHeader(e){if(-1==(e=h.trim(e)).indexOf("WEBVTT"))throw at.thrown(new Xe("Error in line: "+this.lineNumber+". WEBVTT text expected in first line."));return e}__keepFieldsFix(){return p.getInstanceFields(ze)}}e.bs.player.core.vtt.VttParser=ze,ze.__name__="bs.player.core.vtt.VttParser",Object.assign(ze.prototype,{__class__:ze,END_LINE_REGEX:null,WHITESPACE_REGEX:null,TIMESTAMP_SEPARATOR:null,lineNumber:null,lines:null});class Ge extends ze{constructor(){super(),this.lineNumber=0,this.lines=null;}parse(e){this.lines=this.END_LINE_REGEX.split(e),this.lineNumber=0,this.skipEmptyLines(),this.parseHeader(this.readLine()),this.skipEmptyLines();let t=[];for(;!this.isFileEnd();)t.push(this.parseEntry()),this.skipEmptyLines();return t}parseEntry(){let e=new qe,t=this.readLine();if(this.isEmptyStr(t))throw at.thrown(new Xe("Error in line: "+this.lineNumber+". Cannot parse entry."));t=t.replace(this.WHITESPACE_REGEX.r," "),-1==t.indexOf(this.TIMESTAMP_SEPARATOR)&&(e.id=t,t=this.readLine());let s=t.split(this.TIMESTAMP_SEPARATOR);if(2!=s.length)throw at.thrown(new Xe("Error in line: "+this.lineNumber+". Cannot parse time for entry."));return e.showTime=this.parseTimestamp(s[0]),t=this.readLine(),e.text=this.parseText(t),e}parseText(e){if(this.isEmptyStr(e))throw at.thrown(new Xe("Error in line: "+this.lineNumber+". Cannot parse source for entry."));return e}}e.bs.player.core.vtt.VttMarkersParser=Ge,Ge.__name__="bs.player.core.vtt.VttMarkersParser",Ge.__super__=ze,Object.assign(Ge.prototype,{__class__:Ge});class Xe{constructor(e){this.message=e;}}Xe.__name__="bs.player.core.vtt.VttParserError",Object.assign(Xe.prototype,{__class__:Xe,message:null});class Qe{constructor(){this.showTime=0,this.duration=0;}__keepFieldsFix(){return p.getInstanceFields(Qe)}}e.bs.player.core.vtt.VttSegmentsParserEntry=Qe,Qe.__name__="bs.player.core.vtt.VttSegmentsParserEntry",Object.assign(Qe.prototype,{__class__:Qe,id:null,showTime:null,hideTime:null,duration:null,text:null});class Ye extends ze{constructor(){super(),this.lineNumber=0,this.lines=null;}parse(e){this.lines=this.END_LINE_REGEX.split(e),this.lineNumber=0,this.skipEmptyLines(),this.parseHeader(this.readLine()),this.skipEmptyLines();let t=[];for(;!this.isFileEnd();)t.push(this.parseEntry()),this.skipEmptyLines();return t}parseEntry(){let e=new Qe,t=this.readLine();if(this.isEmptyStr(t))throw at.thrown(new Xe("Error in line: "+this.lineNumber+". Cannot parse entry."));t=t.replace(this.WHITESPACE_REGEX.r," "),-1==t.indexOf(this.TIMESTAMP_SEPARATOR)&&(e.id=t,t=this.readLine());let s=t.split(this.TIMESTAMP_SEPARATOR);if(2!=s.length)throw at.thrown(new Xe("Error in line: "+this.lineNumber+". Cannot parse time for entry."));e.showTime=this.parseTimestamp(s[0]);let n=this.parseTimestamp(s[1]);return e.hideTime=n,e.duration=n-e.showTime,t=this.readLine(),e.text=this.parseText(t),e}parseText(e){if(this.isEmptyStr(e))throw at.thrown(new Xe("Error in line: "+this.lineNumber+". Cannot parse source for entry."));return e}}e.bs.player.core.vtt.VttSegmentsParser=Ye,Ye.__name__="bs.player.core.vtt.VttSegmentsParser",Ye.__super__=ze,Object.assign(Ye.prototype,{__class__:Ye});class Je{constructor(){this.entries=[],this.images=[];}__keepFieldsFix(){return p.getInstanceFields(Je)}}e.bs.player.core.vtt.VttThumbnailsParserOutput=Je,Je.__name__="bs.player.core.vtt.VttThumbnailsParserOutput",Object.assign(Je.prototype,{__class__:Je,entries:null,images:null});class Ke extends ze{constructor(e){ze._hx_skip_constructor=!0,super(),ze._hx_skip_constructor=!1,this._hx_constructor(e);}_hx_constructor(e){this.baseUrl="",this.sourceCounter=0,super._hx_constructor(),this.baseUrl=e,this.sourceCounter=0,this.lineNumber=0,this.lines=null;}parse(e){this.sourceCounter=0,this.lines=this.END_LINE_REGEX.split(e),this.lineNumber=0,this.skipEmptyLines(),this.parseHeader(this.readLine()),this.skipEmptyLines();let t=new Je;for(;!this.isFileEnd();)t.entries.push(this.parseEntry()),this.skipEmptyLines();let s=[],n=[],r=0,l=0,i=t.entries;for(;l<i.length;){let e=i[l];++l,s.indexOf(e.source.url)<0&&(s.push(e.source.url),n.push(new We(++r,e.source.url,e.source.w,e.source.h))),e.source.imageId=r;}return t.images=n,t}parseEntry(){let e=new Be,t=this.readLine();if(this.isEmptyStr(t))throw at.thrown(new Xe("Error in line: "+this.lineNumber+". Cannot parse entry."));t=t.replace(this.WHITESPACE_REGEX.r," "),-1==t.indexOf(this.TIMESTAMP_SEPARATOR)&&(e.id=t,t=this.readLine());let s=t.split(this.TIMESTAMP_SEPARATOR);if(2!=s.length)throw at.thrown(new Xe("Error in line: "+this.lineNumber+". Cannot parse time for entry. (2)"));return e.showTime=this.parseTimestamp(s[0]),e.hideTime=this.parseTimestamp(s[1]),t=this.readLine(),e.source=this.parseSource(t),e}parseSource(e){if(this.isEmptyStr(e))throw at.thrown(new Xe("Error in line: "+this.lineNumber+". Cannot parse source for entry (1)"));let t=new l("#","i").split(e),s=new He;if(s.id=this.sourceCounter++,s.url=this.baseUrl+"/"+t[0],t.length<2||null==t[1])return s;let n=new l("=","i").split(t[1]);if(n.length<2||null==n[0]||null==n[1])return s;let r=n[0],i=n[1].split(",");if(i.length<1)return s;let a=r.indexOf("x");s.x=a<0||i.length<a||null==i[a]?0:u.parseInt(i[a]);let o=r.indexOf("y");s.y=o<0||i.length<o||null==i[o]?0:u.parseInt(i[o]);let c=r.indexOf("w");s.w=c<0||i.length<c||null==i[c]?0:u.parseInt(i[c]);let _=r.indexOf("h");return s.h=_<0||i.length<_||null==i[_]?0:u.parseInt(i[_]),s}}e.bs.player.core.vtt.VttThumbnailsParser=Ke,Ke.__name__="bs.player.core.vtt.VttThumbnailsParser",Ke.__super__=ze,Object.assign(Ke.prototype,{__class__:Ke,sourceCounter:null,baseUrl:null});class Ze{constructor(e){this.id=Ze.nextId++,this.readyForAutoplay=!1,this.preparingForAutoplay=!1,this.element=e,this.listenersWaitingForVideoElementForAutoplay=[],this.isDrmSessionReused=!1;}get_drmSessionData(){let e=this.element;return null!=e?e._bp:null}hasSameContextMediaSource(e){return null!=e&&null!=this.contextMediaSource&&(null!=e.id&&null!=this.contextMediaSource.id&&""!=e.id&&""!=this.contextMediaSource.id?e.id==this.contextMediaSource.id:e.url==this.contextMediaSource.url)}cleanVideoElementAndDrmSession(){let e=this.element;null!=e._bp&&null!=e._bp.keySession&&(e._bp.keySession.close(),e.setMediaKeys(null),e.setAttribute("src",""),o.deleteField(e,"_bp")),this.isDrmSessionReused=!1;}setupForPlayback(e,t){if(null==t&&(t=!1),this.hasSameContextMediaSource(e))return;let s=this.element;this.cleanVideoElementAndDrmSession(),t?s._bp={mediaSource:null,buffersByType:null,sourceUrl:null,keysReady:!1,mediaKeys:null,keySystem:null,keySession:null,keySessionToken:null,contextMediaSource:e,isDrmSessionReused:!1,videoElementInfo:this}:o.deleteField(s,"_bp"),this.contextMediaSource=e;}}Ze.__name__="bs.player.web.VideoElementInfo",Object.assign(Ze.prototype,{__class__:Ze,id:null,element:null,drmSessionData:null,readyForAutoplay:null,preparingForAutoplay:null,isDrmSessionReused:null,usedByPlayer:null,listenersWaitingForVideoElementForAutoplay:null,contextMediaSource:null,__properties__:{get_drmSessionData:"get_drmSessionData"}});class $e{}$e.__name__="bs.ui.backend.model.IUiBackend",$e.__isInterface__=!0,Object.assign($e.prototype,{__class__:$e,hasCustomElement:null,createElement:null,createVideoElement:null,getElementById:null,addEngineEventListener:null,removeEngineEventListener:null,addRootEventListener:null,removeRootEventListener:null,isRootVisible:null});class et{constructor(){this.root=Dt.__cast(window.document,HTMLDocument),this.engine=Dt.__cast(window,Window);}hasCustomElement(e){let t=this.engine.customElements;return null!=(null!=t?t.get(e):null)}createElement(e){return Dt.__cast(this.root.createElement(e),HTMLElement)}createVideoElement(){return Dt.__cast(this.root.createElement("video"),HTMLVideoElement)}getElementById(e){return Dt.__cast(this.root.getElementById(e),HTMLElement)}addEngineEventListener(e,t,s){this.engine.addEventListener(e,t,s);}removeEngineEventListener(e,t){this.engine.removeEventListener(e,t);}addRootEventListener(e,t,s){this.root.addEventListener(e,t,s);}removeRootEventListener(e,t){this.root.removeEventListener(e,t);}isRootVisible(){return "visible"==this.root.visibilityState}}et.__name__="bs.ui.backend.platform.js.UiBackendJs",et.__interfaces__=[$e],Object.assign(et.prototype,{__class__:et,engine:null,root:null});class tt{__keepFieldsFix(){return p.getInstanceFields(tt)}static hasCustomElement(e){return tt.backend.hasCustomElement(e)}static createElement(e){return tt.backend.createElement(e)}static createVideoElement(){return tt.backend.createVideoElement()}static getElementById(e){return tt.backend.getElementById(e)}static addEngineEventListener(e,t,s){tt.backend.addEngineEventListener(e,t,s);}static removeEngineEventListener(e,t){tt.backend.removeEngineEventListener(e,t);}static addRootEventListener(e,t,s){tt.backend.addRootEventListener(e,t,s);}static removeRootEventListener(e,t){tt.backend.removeRootEventListener(e,t);}static isRootVisible(){return tt.backend.isRootVisible()}}e.bs.ui.Ui=tt,tt.__name__="bs.ui.Ui",Object.assign(tt.prototype,{__class__:tt});class st{static decode(e){let t=null;if(null==e)return t;try{t=JSON.parse(decodeURIComponent(e.split("+").join(" ")));}catch(s){try{let s=dt.decode(e).toString();try{t=JSON.parse(s);}catch(e){}}catch(e){}}return t}}st.__name__="bs.util.ConfigParser";class nt{constructor(){}__keepFieldsFix(){return p.getInstanceFields(nt)}static merge(e,t){return nt._merge(nt.copy(e),nt.copy(t))}static _merge(e,t){if(null==t)return e;if(null!=t&&("string"==typeof t||"number"==typeof t&&(0|t)===t||"number"==typeof t||"boolean"==typeof t))return t;if(t instanceof Array){if(null==e)return e;let s=t,n=0;for(;n<s.length;)e.push(s[n++]);return e}let s=o.fields(t),n=0;for(;n<s.length;){let r=s[n];++n;let l=o.field(t,r);if(null==l){e[r]=null;continue}null==l||"string"!=typeof l&&("number"!=typeof l||(0|l)!==l)&&"number"!=typeof l&&"boolean"!=typeof l?l instanceof Array?(Object.prototype.hasOwnProperty.call(e,r)||(e[r]=[]),nt._merge(o.field(e,r),l)):(Object.prototype.hasOwnProperty.call(e,r)||(e[r]={}),nt._merge(o.field(e,r),l)):e[r]=l;}return e}static set(e,t,s){e[t]=s;}static get(e,t){return o.field(e,t)}static has(e,t){return Object.prototype.hasOwnProperty.call(e,t)}static fields(e){return o.fields(e)}static copy(e){if(null==e)return null;if(null!=e&&("string"==typeof e||"number"==typeof e&&(0|e)===e||"number"==typeof e||"boolean"==typeof e))return e;if(e instanceof Array){let t=[],s=e,n=0,r=s.length;for(;n<r;)t.push(nt.copy(s[n++]));return t}let t={},s=o.fields(e),n=0;for(;n<s.length;){let r=s[n];++n,t[r]=nt.copy(o.field(e,r));}return t}static isArray(e){return e instanceof Array}static isPrimitive(e){return null==e?null:"string"==typeof e||"number"==typeof e&&(0|e)===e||"number"==typeof e||"boolean"==typeof e}}e.bs.util.ObjectTools=nt,nt.__name__="bs.util.ObjectTools",Object.assign(nt.prototype,{__class__:nt});class rt{__keepFieldsFix(){return p.getInstanceFields(rt)}static getTextWidth(e,t){let s=0;return null==rt.canvasCtx&&(rt.canvasCtx=Dt.__cast(window.document.createElement("canvas"),HTMLCanvasElement).getContext("2d")),rt.canvasCtx.font=t,s=rt.canvasCtx.measureText(e).width,s}static formatTime(e,t){if(null==t&&(t=!1),isNaN(e))return "";if(e<0)return "live";let s=e%60|0,n=e/60%60|0,r=e/3600%24|0;return (1==t&&r<10?"0"+r:r+"")+":"+(n<10?"0"+n:n+"")+":"+(s<10?"0"+s:s+"")}static formatTimeMinutes(e){if(e<0)return "live";let t=e%60|0,s=e/60|0;return (s<10?"0"+s:s+"")+":"+(t<10?"0"+t:t+"")}static formatDateTime(e,t){if(null==t&&(t=0),null==e)return "";if(isNaN(e.getTime()))return "";let s=new Date(e.getFullYear(),e.getMonth(),e.getDay(),e.getHours(),e.getMinutes(),e.getSeconds()+t),n=s.getSeconds(),r=s.getMinutes();return s.getHours()+":"+(r<10?"0"+r:r+"")+":"+(n<10?"0"+n:n+"")}static initTranslations(){rt.translations=new wt;let e=exports.i18n,t=0,s=o.fields(e);for(;t<s.length;){let n=s[t];++t,rt.translations.h[n]=new wt;let r=o.field(e,n),l=rt.translations.h[n],i=0,a=o.fields(r);for(;i<a.length;){let e=a[i];++i;let t=rt.decodeUtf8(o.field(r,e));l.h[e]=t;}}}static decodeUtf8(e){try{return decodeURIComponent(escape(e))}catch(t){return e}}static translate(e,t,s){null==t&&(t=rt.locale),null==rt.translations&&rt.initTranslations();try{return Object.prototype.hasOwnProperty.call(rt.translations.h,t)||(t="en"),rt.translations.h[t].h[e]}catch(e){return null}}static capilizeFirstLetter(e){return null==e?null:i.substr(e,0,1).toUpperCase()+i.substr(e,1,e.length)}static toFixedString(e,t){if(isNaN(e))return "NaN";let s=Math.pow(10,t),n=Math.round(e*s)/s,r=null==n?"null":""+n,l=r.indexOf("."),i=-1!=l,a=t-(i?r.length-l-1:0);if(a<=0)return r;let o=h.lpad("","0",a);return i?""+r+o:r+"."+o}}e.bs.util.TextTools=rt,rt.__name__="bs.util.TextTools",Object.assign(rt.prototype,{__class__:rt});class lt{__keepFieldsFix(){return p.getInstanceFields(lt)}static random(e){null==e&&(e="xxxx-xxxx-xxxx-xxxx-xxxx");let t,s=e.length,n=lt.UID_CHARS.length,r="",l=0;for(;l<s;){let s;switch(t=e.charAt(l++),t){case"-":case"_":s=t;break;default:s=lt.UID_CHARS.charAt(u.random(n));}r+=s;}return r}static uuidv4(){let e=0,t="",s=null,n=0;for(;n<36;)e=u.random(16),s="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".charAt(n++),t+="x"==s?h.hex(e):"y"==s?h.hex(3&e|8):s;return t}}e.bs.util.UUID=lt,lt.__name__="bs.util.UUID",Object.assign(lt.prototype,{__class__:lt});class it{}it.__name__="haxe.IMap",it.__isInterface__=!0,Object.assign(it.prototype,{__class__:it,get:null,keys:null});class at extends Error{constructor(e,t,s){super(e),this.message=e,this.__previousException=t,this.__nativeException=null!=s?s:this;}unwrap(){return this.__nativeException}toString(){return this.get_message()}get_message(){return this.message}get_native(){return this.__nativeException}static caught(e){return e instanceof at?e:e instanceof Error?new at(e.message,null,e):new _t(e,null,e)}static thrown(e){if(e instanceof at)return e.get_native();if(e instanceof Error)return e;return new _t(e)}}at.__name__="haxe.Exception",at.__super__=Error,Object.assign(at.prototype,{__class__:at,__skipStack:null,__nativeException:null,__previousException:null,__properties__:{get_native:"get_native",get_message:"get_message"}});class ot{constructor(e,t){this.high=e,this.low=t;}}ot.__name__="haxe._Int64.___Int64",Object.assign(ot.prototype,{__class__:ot,high:null,low:null});class ut{static formatOutput(e,t){let s=u.string(e);if(null==t)return s;let n=t.fileName+":"+t.lineNumber;if(null!=t.customParams){let e=0,n=t.customParams;for(;e<n.length;)s+=", "+u.string(n[e++]);}return n+": "+s}static trace(e,t){let s=ut.formatOutput(e,t);"undefined"!=typeof console&&null!=console.log&&console.log(s);}}ut.__name__="haxe.Log";class ct{constructor(e){let t=this;this.id=setInterval((function(){t.run();}),e);}stop(){null!=this.id&&(clearInterval(this.id),this.id=null);}run(){}static delay(e,t){let s=new ct(t);return s.run=function(){s.stop(),e();},s}static measure(e,t){let s=i.now()/1e3,n=e();return ut.trace(i.now()/1e3-s+"s",t),n}static stamp(){return i.now()/1e3}}e.haxe.Timer=ct,ct.__name__="haxe.Timer",Object.assign(ct.prototype,{__class__:ct,id:null});class _t extends at{constructor(e,t,s){super(String(e),t,s),this.value=e;}unwrap(){return this.value}}_t.__name__="haxe.ValueException",_t.__super__=at,Object.assign(_t.prototype,{__class__:_t,value:null});class ht{constructor(e){this.length=e.byteLength,this.b=new Uint8Array(e),this.b.bufferValue=e,e.hxBytes=this,e.bytes=this.b;}get(e){return this.b[e]}set(e,t){this.b[e]=t;}blit(e,t,s,n){if(e<0||s<0||n<0||e+n>this.length||s+n>t.length)throw at.thrown(Ct.OutsideBounds);0==s&&n==t.b.byteLength?this.b.set(t.b,e):this.b.set(t.b.subarray(s,s+n),e);}fill(e,t,s){let n=0;for(;n<t;)++n,this.b[e++]=s;}sub(e,t){if(e<0||t<0||e+t>this.length)throw at.thrown(Ct.OutsideBounds);return new ht(this.b.buffer.slice(e+this.b.byteOffset,e+this.b.byteOffset+t))}compare(e){let t=this.b,s=e.b,n=0,r=this.length<e.length?this.length:e.length;for(;n<r;){let e=n++;if(t[e]!=s[e])return t[e]-s[e]}return this.length-e.length}initData(){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength));}getDouble(e){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat64(e,!0)}getFloat(e){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat32(e,!0)}setDouble(e,t){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setFloat64(e,t,!0);}setFloat(e,t){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setFloat32(e,t,!0);}getUInt16(e){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getUint16(e,!0)}setUInt16(e,t){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setUint16(e,t,!0);}getInt32(e){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getInt32(e,!0)}setInt32(e,t){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setInt32(e,t,!0);}getInt64(e){return new ot(this.getInt32(e+4),this.getInt32(e))}setInt64(e,t){this.setInt32(e,t.low),this.setInt32(e+4,t.high);}getString(e,t,s){if(e<0||t<0||e+t>this.length)throw at.thrown(Ct.OutsideBounds);null==s&&(s=pt.UTF8);let n="",r=this.b,l=e,i=e+t;switch(s._hx_index){case 0:for(;l<i;){let e=r[l++];if(e<128){if(0==e)break;n+=String.fromCodePoint(e);}else if(e<224){let t=(63&e)<<6|127&r[l++];n+=String.fromCodePoint(t);}else if(e<240){let t=(31&e)<<12|(127&r[l++])<<6|127&r[l++];n+=String.fromCodePoint(t);}else {let t=(15&e)<<18|(127&r[l++])<<12|(127&r[l++])<<6|127&r[l++];n+=String.fromCodePoint(t);}}break;case 1:for(;l<i;){let e=r[l++]|r[l++]<<8;n+=String.fromCodePoint(e);}}return n}readString(e,t){return this.getString(e,t)}toString(){return this.getString(0,this.length)}toHex(){let e="",t=[],s="0123456789abcdef",n=0;for(;n<16;)t.push(i.cca(s,n++));let r=0,l=this.length;for(;r<l;){let s=this.b[r++];e+=String.fromCodePoint(t[s>>4]),e+=String.fromCodePoint(t[15&s]);}return e}getData(){return this.b.bufferValue}static alloc(e){return new ht(new ArrayBuffer(e))}static ofString(e,t){if(t==pt.RawNative){let t=new Uint8Array(e.length<<1),s=0,n=e.length;for(;s<n;){let n=s++,r=e.charCodeAt(n);t[n<<1]=255&r,t[n<<1|1]=r>>8;}return new ht(t.buffer)}let s=[],n=0;for(;n<e.length;){let t=e.charCodeAt(n++);55296<=t&&t<=56319&&(t=t-55232<<10|1023&e.charCodeAt(n++)),t<=127?s.push(t):t<=2047?(s.push(192|t>>6),s.push(128|63&t)):t<=65535?(s.push(224|t>>12),s.push(128|t>>6&63),s.push(128|63&t)):(s.push(240|t>>18),s.push(128|t>>12&63),s.push(128|t>>6&63),s.push(128|63&t));}return new ht(new Uint8Array(s).buffer)}static ofData(e){let t=e.hxBytes;return null!=t?t:new ht(e)}static ofHex(e){if(1&e.length)throw at.thrown("Not a hex string (odd number of digits)");let t=[],s=0,n=e.length>>1;for(;s<n;){let n=e.charCodeAt(2*s),r=e.charCodeAt(2*s+1);n=(15&n)+9*((64&n)>>6),r=(15&r)+9*((64&r)>>6),t.push(255&(n<<4|r)),++s;}return new ht(new Uint8Array(t).buffer)}static fastGet(e,t){return e.bytes[t]}}e.haxe.io.Bytes=ht,ht.__name__="haxe.io.Bytes",Object.assign(ht.prototype,{__class__:ht,length:null,b:null,data:null});var pt=r["haxe.io.Encoding"]={__ename__:!0,__constructs__:null,UTF8:{_hx_name:"UTF8",_hx_index:0,__enum__:"haxe.io.Encoding",toString:n},RawNative:{_hx_name:"RawNative",_hx_index:1,__enum__:"haxe.io.Encoding",toString:n}};pt.__constructs__=[pt.UTF8,pt.RawNative];class dt{static encode(e,t){null==t&&(t=!0);let s=new mt(dt.BYTES).encodeBytes(e).toString();if(t)switch(e.length%3){case 1:s+="==";break;case 2:s+="=";}return s}static decode(e,t){if(null==t&&(t=!0),t)for(;61==i.cca(e,e.length-1);)e=i.substr(e,0,-1);return new mt(dt.BYTES).decodeBytes(ht.ofString(e))}static urlEncode(e,t){null==t&&(t=!1);let s=new mt(dt.URL_BYTES).encodeBytes(e).toString();if(t)switch(e.length%3){case 1:s+="==";break;case 2:s+="=";}return s}static urlDecode(e,t){if(null==t&&(t=!1),t)for(;61==i.cca(e,e.length-1);)e=i.substr(e,0,-1);return new mt(dt.URL_BYTES).decodeBytes(ht.ofString(e))}}e.haxe.crypto.Base64=dt,dt.__name__="haxe.crypto.Base64";class mt{constructor(e){let t=e.length,s=1;for(;t>1<<s;)++s;if(s>8||t!=1<<s)throw at.thrown("BaseCode : base length must be a power of two.");this.base=e,this.nbits=s;}encodeBytes(e){let t=this.nbits,s=this.base,n=8*e.length/t|0,r=new ht(new ArrayBuffer(n+(8*e.length%t==0?0:1))),l=0,i=0,a=(1<<t)-1,o=0,u=0;for(;u<n;){for(;i<t;)i+=8,l<<=8,l|=e.b[o++];i-=t,r.b[u++]=s.b[l>>i&a];}return i>0&&(r.b[u++]=s.b[l<<t-i&a]),r}initTable(){let e=[],t=0;for(;t<256;)e[t++]=-1;let s=0,n=this.base.length;for(;s<n;){let t=s++;e[this.base.b[t]]=t;}this.tbl=e;}decodeBytes(e){let t=this.nbits;null==this.tbl&&this.initTable();let s=this.tbl,n=e.length*t>>3,r=new ht(new ArrayBuffer(n)),l=0,i=0,a=0,o=0;for(;o<n;){for(;i<8;){i+=t,l<<=t;let n=s[e.b[a++]];if(-1==n)throw at.thrown("BaseCode : invalid encoded char");l|=n;}i-=8,r.b[o++]=l>>i&255;}return r}encodeString(e){return this.encodeBytes(ht.ofString(e)).toString()}decodeString(e){return this.decodeBytes(ht.ofString(e)).toString()}static encode(e,t){return new mt(ht.ofString(t)).encodeString(e)}static decode(e,t){return new mt(ht.ofString(t)).decodeString(e)}}e.haxe.crypto.BaseCode=mt,mt.__name__="haxe.crypto.BaseCode",Object.assign(mt.prototype,{__class__:mt,base:null,nbits:null,tbl:null});class gt{constructor(){this.h={};}set(e,t){this.h[e]=t;}get(e){return this.h[e]}exists(e){return this.h.hasOwnProperty(e)}remove(e){return !!this.h.hasOwnProperty(e)&&(delete this.h[e],!0)}keys(){let e=[];for(var t in this.h)this.h.hasOwnProperty(t)&&e.push(+t);return new Pt(e)}iterator(){return {ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){let e=this.it.next();return this.ref[e]}}}keyValueIterator(){return new kt(this)}copy(){let e=new gt,t=this.keys();for(;t.hasNext();){let s=t.next();e.h[s]=this.h[s];}return e}toString(){let e="";e="[";let t=this.keys();for(;t.hasNext();){let s=t.next();e+=null==s?"null":""+s,e+=" => ",e+=u.string(u.string(this.h[s])),t.hasNext()&&(e+=", ");}return e+="]",e}clear(){this.h={};}}e.haxe.ds.IntMap=gt,gt.__name__="haxe.ds.IntMap",gt.__interfaces__=[it],Object.assign(gt.prototype,{__class__:gt,h:null});class yt{constructor(){this.length=0;}add(e){let t=new bt(e,null);null==this.h?this.h=t:this.q.next=t,this.q=t,this.length++;}push(e){let t=new bt(e,this.h);this.h=t,null==this.q&&(this.q=t),this.length++;}first(){return null==this.h?null:this.h.item}last(){return null==this.q?null:this.q.item}pop(){if(null==this.h)return null;let e=this.h.item;return this.h=this.h.next,null==this.h&&(this.q=null),this.length--,e}isEmpty(){return null==this.h}clear(){this.h=null,this.q=null,this.length=0;}remove(e){let t=null,s=this.h;for(;null!=s;){if(s.item==e)return null==t?this.h=s.next:t.next=s.next,this.q==s&&(this.q=t),this.length--,!0;t=s,s=s.next;}return !1}iterator(){return new ft(this.h)}keyValueIterator(){return new xt(this.h)}toString(){let e="",t=!0,s=this.h;for(e="{";null!=s;)t?t=!1:e+=", ",e+=u.string(u.string(s.item)),s=s.next;return e+="}",e}join(e){let t="",s=!0,n=this.h;for(;null!=n;)s?s=!1:t+=null==e?"null":""+e,t+=u.string(n.item),n=n.next;return t}filter(e){let t=new yt,s=this.h;for(;null!=s;){let n=s.item;s=s.next,e(n)&&t.add(n);}return t}map(e){let t=new yt,s=this.h;for(;null!=s;){let n=s.item;s=s.next,t.add(e(n));}return t}}e.haxe.ds.List=yt,yt.__name__="haxe.ds.List",Object.assign(yt.prototype,{__class__:yt,h:null,q:null,length:null});class bt{constructor(e,t){this.item=e,this.next=t;}}e.haxe.ds._List.ListNode=bt,bt.__name__="haxe.ds._List.ListNode",Object.assign(bt.prototype,{__class__:bt,item:null,next:null});class ft{constructor(e){this.head=e;}hasNext(){return null!=this.head}next(){let e=this.head.item;return this.head=this.head.next,e}}e.haxe.ds._List.ListIterator=ft,ft.__name__="haxe.ds._List.ListIterator",Object.assign(ft.prototype,{__class__:ft,head:null});class xt{constructor(e){this.head=e,this.idx=0;}hasNext(){return null!=this.head}next(){let e=this.head.item;return this.head=this.head.next,{value:e,key:this.idx++}}}e.haxe.ds._List.ListKeyValueIterator=xt,xt.__name__="haxe.ds._List.ListKeyValueIterator",Object.assign(xt.prototype,{__class__:xt,idx:null,head:null});class wt{constructor(){this.h=Object.create(null);}exists(e){return Object.prototype.hasOwnProperty.call(this.h,e)}get(e){return this.h[e]}set(e,t){this.h[e]=t;}remove(e){return !!Object.prototype.hasOwnProperty.call(this.h,e)&&(delete this.h[e],!0)}keys(){return new Et(this.h)}iterator(){return new vt(this.h)}keyValueIterator(){return new St(this.h)}copy(){return wt.createCopy(this.h)}clear(){this.h=Object.create(null);}toString(){return wt.stringify(this.h)}static createCopy(e){let t=new wt;for(var s in e)t.h[s]=e[s];return t}static stringify(e){let t="[",s=!0;for(var n in e)s?s=!1:t+=",",t+=n+" => "+u.string(e[n]);return t+"]"}}e.haxe.ds.StringMap=wt,wt.__name__="haxe.ds.StringMap",wt.__interfaces__=[it],Object.assign(wt.prototype,{__class__:wt,h:null});class Et{constructor(e){this.h=e,this.keys=Object.keys(e),this.length=this.keys.length,this.current=0;}hasNext(){return this.current<this.length}next(){return this.keys[this.current++]}}e.haxe.ds._StringMap.StringMapKeyIterator=Et,Et.__name__="haxe.ds._StringMap.StringMapKeyIterator",Object.assign(Et.prototype,{__class__:Et,h:null,keys:null,length:null,current:null});class vt{constructor(e){this.h=e,this.keys=Object.keys(e),this.length=this.keys.length,this.current=0;}hasNext(){return this.current<this.length}next(){return this.h[this.keys[this.current++]]}}e.haxe.ds._StringMap.StringMapValueIterator=vt,vt.__name__="haxe.ds._StringMap.StringMapValueIterator",Object.assign(vt.prototype,{__class__:vt,h:null,keys:null,length:null,current:null});class St{constructor(e){this.h=e,this.keys=Object.keys(e),this.length=this.keys.length,this.current=0;}hasNext(){return this.current<this.length}next(){let e=this.keys[this.current++];return {key:e,value:this.h[e]}}}e.haxe.ds._StringMap.StringMapKeyValueIterator=St,St.__name__="haxe.ds._StringMap.StringMapKeyValueIterator",Object.assign(St.prototype,{__class__:St,h:null,keys:null,length:null,current:null});class It extends at{constructor(e,t,s){super(e,t),this.posInfos=null==s?{fileName:"(unknown)",lineNumber:0,className:"(unknown)",methodName:"(unknown)"}:s;}toString(){return super.toString()+" in "+this.posInfos.className+"."+this.posInfos.methodName+" at "+this.posInfos.fileName+":"+this.posInfos.lineNumber}}It.__name__="haxe.exceptions.PosException",It.__super__=at,Object.assign(It.prototype,{__class__:It,posInfos:null});class Ot extends It{constructor(e,t,s){null==e&&(e="Not implemented"),super(e,t,s);}}Ot.__name__="haxe.exceptions.NotImplementedException",Ot.__super__=It,Object.assign(Ot.prototype,{__class__:Ot});var Ct=r["haxe.io.Error"]={__ename__:!0,__constructs__:null,Blocked:{_hx_name:"Blocked",_hx_index:0,__enum__:"haxe.io.Error",toString:n},Overflow:{_hx_name:"Overflow",_hx_index:1,__enum__:"haxe.io.Error",toString:n},OutsideBounds:{_hx_name:"OutsideBounds",_hx_index:2,__enum__:"haxe.io.Error",toString:n},Custom:(s=function(e){return {_hx_index:3,e,__enum__:"haxe.io.Error",toString:n}},s._hx_name="Custom",s.__params__=["e"],s)};Ct.__constructs__=[Ct.Blocked,Ct.Overflow,Ct.OutsideBounds,Ct.Custom];class Pt{constructor(e){this.current=0,this.array=e;}hasNext(){return this.current<this.array.length}next(){return this.array[this.current++]}}e.haxe.iterators.ArrayIterator=Pt,Pt.__name__="haxe.iterators.ArrayIterator",Object.assign(Pt.prototype,{__class__:Pt,array:null,current:null});class At{constructor(e){this.array=e;}}At.__name__="haxe.iterators.ArrayKeyValueIterator",Object.assign(At.prototype,{__class__:At,array:null});class kt{constructor(e){this.map=e,this.keys=e.keys();}hasNext(){return this.keys.hasNext()}next(){let e=this.keys.next();return {value:this.map.get(e),key:e}}}kt.__name__="haxe.iterators.MapKeyValueIterator",Object.assign(kt.prototype,{__class__:kt,map:null,keys:null});class Lt{constructor(e){this.s=e;}}Lt.__name__="haxe.iterators.StringIterator",Object.assign(Lt.prototype,{__class__:Lt,s:null});class Ft{constructor(e){this.s=e;}}Ft.__name__="haxe.iterators.StringKeyValueIterator",Object.assign(Ft.prototype,{__class__:Ft,s:null});class Dt{static getClass(e){if(null==e)return null;if(e instanceof Array)return Array;{let t=e.__class__;if(null!=t)return t;let s=Dt.__nativeClassName(e);return null!=s?Dt.__resolveNativeClass(s):null}}static __string_rec(e,t){if(null==e)return "null";if(t.length>=5)return "<...>";let s=typeof e;switch("function"==s&&(e.__name__||e.__ename__)&&(s="object"),s){case"function":return "<function>";case"object":if(e.__enum__){let s=r[e.__enum__].__constructs__[e._hx_index],n=s._hx_name;return s.__params__?(t+="\t",n+"("+function(){let n=[];{let r=0,l=s.__params__;for(;r<l.length;){let s=l[r];r+=1,n.push(Dt.__string_rec(e[s],t));}}return n}().join(",")+")"):n}if(e instanceof Array){let s="[";t+="\t";let n=0,r=e.length;for(;n<r;){let r=n++;s+=(r>0?",":"")+Dt.__string_rec(e[r],t);}return s+="]",s}let s;try{s=e.toString;}catch(e){return "???"}if(null!=s&&s!=Object.toString&&"function"==typeof s){let t=e.toString();if("[object Object]"!=t)return t}let n="{\n";t+="\t";let l=null!=e.hasOwnProperty,i=null;for(i in e)l&&!e.hasOwnProperty(i)||"prototype"!=i&&"__class__"!=i&&"__super__"!=i&&"__interfaces__"!=i&&"__properties__"!=i&&(2!=n.length&&(n+=", \n"),n+=t+i+" : "+Dt.__string_rec(e[i],t));return n+="\n"+(t=t.substring(1))+"}",n;case"string":return e;default:return String(e)}}static __interfLoop(e,t){for(;;){if(null==e)return !1;if(e==t)return !0;let s=e.__interfaces__;if(null!=s&&(null==e.__super__||e.__super__.__interfaces__!=s)){let e=0,n=s.length;for(;e<n;){let n=s[e++];if(n==t||Dt.__interfLoop(n,t))return !0}}e=e.__super__;}}static __instanceof(e,t){if(null==t)return !1;switch(t){case Array:return e instanceof Array;case Vt:return "boolean"==typeof e;case Mt:return null!=e;case Bt:return "number"==typeof e;case jt:return "number"==typeof e&&(0|e)===e;case String:return "string"==typeof e;default:if(null==e)return !1;if("function"==typeof t){if(Dt.__downcastCheck(e,t))return !0}else if("object"==typeof t&&Dt.__isNativeObj(t)&&e instanceof t)return !0;return t==Rt&&null!=e.__name__||(t==Ht&&null!=e.__ename__||null!=e.__enum__&&r[e.__enum__]==t)}}static __downcastCheck(e,t){return e instanceof t||!!t.__isInterface__&&Dt.__interfLoop(Dt.getClass(e),t)}static __cast(e,t){if(null==e||Dt.__instanceof(e,t))return e;throw at.thrown("Cannot cast "+u.string(e)+" to "+u.string(t))}static __nativeClassName(e){let t=Dt.__toStr.call(e).slice(8,-1);return "Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t}static __isNativeObj(e){return null!=Dt.__nativeClassName(e)}static __resolveNativeClass(e){return t[e]}}Dt.__name__="js.Boot";class Tt{static get_supported(){return "undefined"!=typeof window&&void 0!==window.location&&"string"==typeof window.location.protocol}static createXMLHttpRequest(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)return new ActiveXObject("Microsoft.XMLHTTP");throw at.thrown("Unable to create XMLHttpRequest object.")}}function Nt(e){return e instanceof Array?new Pt(e):e.iterator()}function Ut(e,s){return null==s?null:(null==s.__id__&&(s.__id__=t.$haxeUID++),null==e.hx__closures__?e.hx__closures__={}:n=e.hx__closures__[s.__id__],null==n&&(n=s.bind(e),e.hx__closures__[s.__id__]=n),n);var n;}Tt.__name__="js.Browser",Tt.__properties__={get_supported:"get_supported"},t.$haxeUID|=0,"undefined"!=typeof performance&&"function"==typeof performance.now&&(i.now=performance.now.bind(performance)),null==String.fromCodePoint&&(String.fromCodePoint=function(e){return e<65536?String.fromCharCode(e):String.fromCharCode(55232+(e>>10))+String.fromCharCode(56320+(1023&e))}),Object.defineProperty(String.prototype,"__class__",{value:String,enumerable:!1,writable:!0}),String.__name__="String",Array.__name__="Array",Date.prototype.__class__=Date,Date.__name__="Date";var jt={},Mt={},Bt=Number,Vt=Boolean,Rt={},Ht={};{let e,t=f.isWindowExisting()?window.navigator:{appVersion:"",userAgent:"",appName:"",maxTouchPoints:0,platform:""},s=t.appVersion,n=t.userAgent,r=t.appName,i=parseFloat(s)+"";f.majorVersion=parseFloat(s);let a=n.indexOf("OPR/");if(-1!=a)r="Opera",i=n.substring(a+4);else if(a=n.indexOf("Opera"),-1!=a)r="Opera",i=n.substring(a+6),a=n.indexOf("Version"),-1!=a&&(i=n.substring(a+8));else if(a=n.indexOf("Edge"),-1!=a){let e;r="Edge",i=n.substring(a+5),window.MediaKeys?(a=n.indexOf("Chrome"),e=-1!=a):e=!1,e?(r="EdgeChromium",i=n.substring(a+7)):"reversed"in document.createElement("ol")&&(r="EdgeChromium",i="80");}else if(a=n.indexOf("Edg/"),-1!=a)r="EdgeChromium",i=n.substring(a+4);else if(a=n.indexOf("MSIE"),-1!=a)r="Microsoft Internet Explorer",i=n.substring(a+5);else {let s;-1!=n.indexOf("Trident/")?(a=n.indexOf("rv:"),s=-1!=a):s=!1,s?(r="Microsoft Internet Explorer",i=n.substring(a+3)):(a=n.indexOf("Chrome"),-1!=a?(r="Chrome",i=n.substring(a+7)):(a=n.indexOf("Safari"),-1!=a?(r="Safari",i=n.substring(a+7),a=n.indexOf("Version"),-1!=a&&(i=n.substring(a+8))):(a=n.indexOf("Firefox"),-1!=a?(r="Firefox",i=n.substring(a+8)):(e=n.lastIndexOf(" ")+1,a=n.lastIndexOf("/"),e<a&&(r=n.substring(e,a),i=n.substring(a+1),r.toLowerCase()==r.toUpperCase()&&(r=t.appName))))));}let o=i.indexOf(";");if(-1!=o&&(i=i.substring(0,o)),o=i.indexOf(" "),-1!=o)i=i.substring(0,o);else if("Netscape"==r){let e=new l("Trident.*rv:([0-9]{1,}[\\.0-9]{0,})","");e.match(n);try{e.matched(0),i=e.matched(1),r="Microsoft Internet Explorer";}catch(e){}}f.majorVersion=u.parseInt(""+i);let c=f.majorVersion;isNaN(c)&&(i=""+parseFloat(s),f.majorVersion=u.parseInt(s)),f.browserName=r;let _=t.userAgent;_=_.toLowerCase(),f.isAndroid=_.indexOf("android")>-1,f.isBlackBerry=_.indexOf("blackberry")>-1,f.isiPhone=_.indexOf("iphone")>-1,f.isiPad=_.indexOf("ipad")>-1,f.isiPod=_.indexOf("ipod")>-1,f.isOperaMini=_.indexOf("opera mini")>-1,f.isIeMobile=_.indexOf("iemobile")>-1,f.isWindowsPhone=_.indexOf("windows phone")>-1,f.isEdge="Edge"==f.browserName;let h=t.maxTouchPoints&&t.maxTouchPoints>2&&-1!=(t.platform+"").indexOf("MacIntel");if(f.isiOS=f.isiPhone||f.isiPad||f.isiPod||h,f.mobile=f.isAndroid||f.isBlackBerry||f.isiOS||f.isOperaMini||f.isIeMobile,_.indexOf("smart-tv")>-1||_.indexOf("smarttv")>-1){f.smartTV=!0;let e=_.indexOf("samsungbrowser")>-1,t=_.indexOf("tizen")>-1;f.isSamsungSmartTVTizen=t&&!e;}else f.smartTV=!1,f.isSamsungSmartTVTizen=!1;let p=f.getUserAgentData();null!=p&&(f.mobile=p.mobile,null!=p.brands&&p.brands.length>0&&null!=p.brands[0]&&null!=p.brands[0].version&&(f.majorVersion=u.parseInt(""+p.brands[0].version))),0==f.mobile&&0==f.smartTV&&(f.isMacOS=null!=p?-1!=p.platform.toLowerCase().indexOf("macos"):-1!=t.platform.toLowerCase().indexOf("mac"));}{w.expose=o.field(window,"bradmax"),null==w.expose&&(window.bradmax=Object.create(null),w.expose=o.field(window,"bradmax"));let e=["bigsoda"],t=0;for(;t<e.length;){let s=e[t];++t,window[s]=w.expose;}0==Object.prototype.hasOwnProperty.call(w.expose,"player")&&(w.expose.player=Object.create(null));let s=o.field(w.expose,"player");0==Object.prototype.hasOwnProperty.call(s,"plugin")&&(s.plugin=Object.create(null)),0==Object.prototype.hasOwnProperty.call(s,"create")&&(s.create=Object.create(null)),0==Object.prototype.hasOwnProperty.call(s,"destroy")&&(s.destroy=Object.create(null)),0==Object.prototype.hasOwnProperty.call(s,"list")&&(s.list=Object.create(null)),0==Object.prototype.hasOwnProperty.call(s,"getById")&&(s.getById=Object.create(null)),0==Object.prototype.hasOwnProperty.call(s,"embeders")&&(s.embeders=Object.create(null)),0==Object.prototype.hasOwnProperty.call(s,"composers")&&(s.composers=Object.create(null));Object.prototype.hasOwnProperty.call(s,"embeder");let n="modular_v2.15.38";w.sourcePath=f.findThisJsScriptAbsolutePath(n);let r=o.field(s,"embeders");null==o.field(r,n)&&(r[n]=w);let l=o.field(s,"composers");null==o.field(l,n)&&(l[n]=b);}{let e=window.document;F.fullscreenEventName="fullscreenchange","Safari"==f.browserName&&null!=e.webkitIsFullScreen?F.fullscreenEventName="webkitfullscreenchange":"Firefox"==f.browserName&&null!=e.mozFullScreen&&f.majorVersion<64?F.fullscreenEventName="mozfullscreenchange":null!=e.msFullscreenEnabled&&(F.fullscreenEventName="MSFullscreenChange");}Dt.__toStr={}.toString,_.winMetaCharacters=[32,40,41,37,33,94,34,60,62,38,124,10,13,44,59],h.winMetaCharacters=_.winMetaCharacters,h.MIN_SURROGATE_CODE_POINT=65536,m._hx_skip_constructor=!1,x.MAX_ELEMENTS_FOR_LATER_AUTOPLAY=2,x.DEFAULT_WAIT_QUEUE_MAX_SIZE=10,w.NAMESPACE="bradmax",w.ATTRIBUTE_PID="data-bradmax-player-pid",w.PLAYER_ATTRIBUTE_PARENT_ID="data-bs-parent-id",w.PLAYER_ATTRIBUTE_VARIABLES="data-bs-variables",w.players=new wt,w.wrappers=[],w.videoElementsManager=new x,M.instance=new M,M.listenersMap=new wt,M.onceListenersMap=new wt,M.disabledListenersMap=new wt,V.instance=new V,H.monitors=new wt,W._hx_skip_constructor=!1,G.DEFAULT_MAX_RESTARTS_ON_DRM_LICENSE_ISSUE=1,Ne.DEFAULT_BRADMAX_SKIN_APP_ID="53001214",Ne.libLoaded=!1,Ne._isAvailable=!1,ze._hx_skip_constructor=!1,Ze.nextId=1,tt.backend=new et,rt.locale="en",lt.UID_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",dt.CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",dt.BYTES=ht.ofString(dt.CHARS),dt.URL_CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",dt.URL_BYTES=ht.ofString(dt.URL_CHARS);}(exports,window);
!function(t,e){t.bs=t.bs||{},t.bs.player=t.bs.player||{},t.bs.player.plugin=t.bs.player.plugin||{},t.bs.player.plugin.skin=t.bs.player.plugin.skin||{};var s,i=function(){return Ut.__string_rec(this,"")},n=n||{};class a{constructor(t,e){this.r=new RegExp(t,e.split("u").join(""));}match(t){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(t),this.r.s=t,null!=this.r.m}matched(t){if(null!=this.r.m&&t>=0&&t<this.r.m.length)return this.r.m[t];throw Nt.thrown("EReg::matched")}matchedPos(){if(null==this.r.m)throw Nt.thrown("No string matched");return {pos:this.r.m.index,len:this.r.m[0].length}}matchSub(t,e,s){if(null==s&&(s=-1),this.r.global){this.r.lastIndex=e,this.r.m=this.r.exec(s<0?t:l.substr(t,0,e+s));let i=null!=this.r.m;return i&&(this.r.s=t),i}{let i=this.match(s<0?l.substr(t,e,null):l.substr(t,e,s));return i&&(this.r.s=t,this.r.m.index+=e),i}}split(t){return t.replace(this.r,"#__delim__#").split("#__delim__#")}map(t,e){let s=0,i="";do{if(s>=t.length)break;if(!this.matchSub(t,s)){i+=h.string(l.substr(t,s,null));break}let n=this.matchedPos();i+=h.string(l.substr(t,s,n.pos-s)),i+=h.string(e(this)),0==n.len?(i+=h.string(l.substr(t,n.pos,1)),s=n.pos+1):s=n.pos+n.len;}while(this.r.global);return !this.r.global&&s>0&&s<t.length&&(i+=h.string(l.substr(t,s,null))),i}}a.__name__="EReg",Object.assign(a.prototype,{__class__:a});var l=require("haxe.HxOverrides"),r=require("haxe.Lambda");Math.__name__="Math";var o=require("haxe.Reflect");class h{static string(t){return Ut.__string_rec(t,"")}static parseInt(t){let e=parseInt(t);return isNaN(e)?null:e}}h.__name__="Std";var u=require("haxe.StringTools"),c=require("bs.net.Http"),d=require("bs.player.core.events.AdEvent"),p=require("bs.player.core.events.ControlEvent"),m=require("bs.player.core.events.DataProviderEvent"),f=require("bs.player.core.events.DisplayEvent"),g=require("bs.util.BrowserTools"),v=require("bs.player.core.events.NativeEvent"),b=require("bs.player.core.events.ResizeEvent"),_=require("bs.player.core.events.SphericalVideoEvent"),y=require("bs.player.core.events.VideoEvent");class k{}k.__name__="bs.player.core.interfaces.IBradmaxThumbnailsService",k.__isInterface__=!0,Object.assign(k.prototype,{__class__:k});var w=require("bs.player.core.manager.PlaybackStateRegister"),x=require("bs.player.core.model.Live"),S=require("bs.player.core.model.LiveStream"),E=require("bs.player.core.model.MediaPlaylist"),P=require("bs.player.core.model.Image"),C=require("bs.player.core.model.AdMediaUi"),O=require("bs.player.core.model.Point"),T=require("bs.player.core.model.Episode");class A{constructor(t){A._hx_skip_constructor||this._hx_constructor(t);}_hx_constructor(t){null==t&&(t=5),this.pluginName="";let e=Ut.getClass(this);this.pluginName=e.__name__.split(".").pop(),this.initPriority=t;let s=this.pluginName,i=exports.configuration;this.pluginConfig=null!=i&&Object.prototype.hasOwnProperty.call(i,s)?o.field(i,s):Object.create(null);}create(){}destroy(){}activate(){}postActivate(){}deactivate(){}eventFilter(t){return !0}registerPlugin(t){}getPluginVersion(){return "v2.15.38"}getPluginName(){return this.pluginName}get_player(){return this.player}set_player(t){return this.player=t}get_variables(){return this.variables}set_variables(t){return this.variables=t}get_eventHub(){return this.eventHub}set_eventHub(t){return this.eventHub=t}get_parentDisplay(){return this.parentDisplay}set_parentDisplay(t){return this.parentDisplay=t}get_display(){return this.display}isCriticalForPlayback(){return !0}}A.__name__="bs.player.core.plugin.PluginBase",Object.assign(A.prototype,{__class__:A});var M=require("bs.player.core.vtt.VttMarkersParserEntry"),I=require("bs.player.core.vtt.VttMarkersParser"),D=require("bs.player.core.vtt.VttSegmentsParserEntry"),L=require("bs.player.core.vtt.VttSegmentsParser"),N=require("bs.player.core.vtt.VttThumbnailsParser");class F extends A{constructor(){A._hx_skip_constructor=!0,super(),A._hx_skip_constructor=!1,this._hx_constructor();}_hx_constructor(){this.fontsLoaded=!1,this.sourcesLoaded=!1,this.ready=!1,this.layoutAvailable=!1,this.activated=!1,this._css={adPlaying:"ad-playing",adsUiDisabled:"ad-ui-disabled",adGoogleImaPlaying:"g-ima-playing"};let t={current:{time:0,text:It.formatTime(0)},duration:{time:0,text:It.formatTime(0)},status:{inited:!1,playing:!1,paused:!1,buffering:!1,seeking:!1,complete:!1,live:!1,dvr:!1,seekable:!0},playPause:null,seekEnd:null,replay:null},e=isNaN(1)||!isFinite(1)?"0%":Math.max(0,Math.min(100,100))+"%",s={name:"progress",time:0,text:It.formatTime(0),width:"0",has:{thumb:!1,segments:!1,segment:!1,markers:!1,marker:!1,texts:!1},popup:{active:!1,time:0,text:It.formatTime(0),position:"0",width:"0",bounds:{offset:"0px",ctrl:null},ctrl:null},ctrl:null,seekBackward:null,seekForward:null},i={width:NaN,height:NaN,current:"xxs",gt:{xxs:!0,xs:!1,sm:!1,md:!1,lg:!1,xl:!1,xxl:!1},lt:{xxs:!1,xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0}},n=g.isMobile(),a=g.isSmartTV(),l={browserName:g.browserName.toLowerCase(),desktop:0==n&&0==a,mobile:n,ios:1==g.isiOS,tv:a,tizen:g.isSamsungSmartTVTizen,webview:g.isWebView(),css:null};this.state={name:"",prefix:"",title:null,video:t,volume:{name:"volume",mute:!1,value:1,prc:e,text:"100",active:!1,ctrl:null,toggle:null},progress:s,playlist:{hasNext:!1,currentPos:-1,items:null,playItem:null},brand:null,splash:{show:{start:!1,actions:!1,state:!1,buttons:!1,end:!1},can:{backward:!1,forward:!1},start:{type:"image"},actions:{seek:{offset:0,animate:!1,countBackward:null,countForward:null,backward:null,forward:null,reset:null},btns:{animate:!1,enabled:!1,countBackward:null,countForward:null,seekBackward:null,seekForward:null},click:null,reset:null},state:{type:"standard"},end:{type:"standard",playNext:null}},spinner:null,popup:{active:null,toggle:null,open:null,close:null},menu:{count:0,audio:{name:"audio",hasItems:!1,activate:null},casting:null,fullscreen:null,pictureInPicture:null,quality:{name:"quality",hasItems:!1,activate:null,value:null},subtitles:{name:"subtitles",hasItems:!1,activate:null},vr:null,playbackRate:{name:"playback-rate",hasItems:!1,items:null,activate:null},videoTracks:{name:"video",hasItems:!1,activate:null}},contextmenu:{show:!1,ctrl:null},ad:null,hide:{css:"show",reset:null,active:!1,starts:null},size:i,device:l,message:null,icon:{type:"css",skinIcoPrefix:"",airplay:{id:"bmp-ico-airplay"},alert:{id:"bmp-ico-alert"},subtitles:{id:"bmp-ico-subtitles"},pip:{id:"bmp-ico-pip"},chromecast:{id:"bmp-ico-chromecast"},copy:{id:"bmp-ico-copy"},playNext:{id:"bmp-ico-play-next"},maximize:{id:"bmp-ico-maximize"},minimize:{id:"bmp-ico-minimize"},menu:{id:"bmp-ico-menu"},audio:{id:"bmp-ico-audio"},pause:{id:"bmp-ico-pause"},play:{id:"bmp-ico-play"},replay:{id:"bmp-ico-replay"},quality:{id:"bmp-ico-quality"},volume:{id:"bmp-ico-volume"},volume1:{id:"bmp-ico-volume-1"},volume2:{id:"bmp-ico-volume-2"},volumeX:{id:"bmp-ico-volume-x"},close:{id:"bmp-ico-close"},left:{id:"bmp-ico-left"},right:{id:"bmp-ico-right"},up:{id:"bmp-ico-up"},down:{id:"bmp-ico-down"},center:{id:"bmp-ico-center"},vr:{id:"bmp-ico-vr"},gyroscope:{id:"bmp-ico-gyroscope"},zoom:{plus:{id:"bmp-ico-zoom-plus"},minus:{id:"bmp-ico-zoom-minus"},reset:{id:"bmp-ico-zoom-reset"}},playbackRate:{id:"bmp-ico-playback-rate"},videoTracks:{id:"bmp-ico-video-tracks"}},camera:null,timeCss:Tt.formatCss,img:{srcset:Ct.stateToAttribute,sizes:Ct.stateToSizesAttribute}},this.litOptions={},this.lit=new V,super._hx_constructor(0);}formatEncapsulation(t){return "[data-"+this.get_prefix()+"-name="+t+"]"}create(){super.create();let t=At.copy(this.pluginConfig),e=this;this.readResources(t,(function(s){e.parseResources(t,s),e.state.name=e.get_name(),e.state.prefix=e.get_prefix(),e.litOptions.host=e.state,e.attachFonts(),e.attachCssVars(),e.fetchSources(),null!=e.icon&&e.icon.updateTypesState(e.skinIcoPrefix,null!=e.get_icons()&&null!=e.get_icons().svg?"svg":"css");})),this.start(t);}destroy(){this.ready=!1,this.sourcesLoaded=!1,this.fontsLoaded=!1,this.activated=!1,this.layoutAvailable=!1,null!=this.size&&this.size.destroy(),null!=this.device&&this.device.destroy(),null!=this.ad&&this.ad.destroy(),null!=this.video&&this.video.destroy(),null!=this.splash&&this.splash.destroy(),null!=this.progress&&this.progress.destroy(),null!=this.volume&&this.volume.destroy(),null!=this.brand&&this.brand.destroy(),null!=this.title&&this.title.destroy(),null!=this.playlist&&this.playlist.destroy(),null!=this.menu&&this.menu.destroy(),null!=this.message&&this.message.destroy(),null!=this.hide&&this.hide.destroy(),null!=this.icon&&this.icon.destroy(),null!=this.camera&&this.camera.destroy(),null!=this.contextmenu&&this.contextmenu.destroy(),null!=this.spinner&&this.spinner.destroy(),null!=this.popup&&this.popup.destroy(),null!=this.nav&&this.nav.destroy();}activate(){this.activated=!0;}postActivate(){null!=this.size&&this.size.postActivate(),null!=this.device&&this.device.postActivate(),null!=this.ad&&this.ad.postActivate(),null!=this.video&&this.video.postActivate(),null!=this.splash&&this.splash.postActivate(),null!=this.progress&&this.progress.postActivate(),null!=this.volume&&this.volume.postActivate(),null!=this.brand&&this.brand.postActivate(),null!=this.title&&this.title.postActivate(),null!=this.playlist&&this.playlist.postActivate(),null!=this.menu&&this.menu.postActivate(),null!=this.message&&this.message.postActivate(),null!=this.hide&&this.hide.postActivate(),null!=this.icon&&this.icon.postActivate(),null!=this.camera&&this.camera.postActivate(),null!=this.contextmenu&&this.contextmenu.postActivate(),null!=this.spinner&&this.spinner.postActivate(),null!=this.popup&&this.popup.postActivate(),null!=this.nav&&(this.nav.postActivate(),this.get_player().api.nav=this.nav.get_api());}deactivate(){this.activated=!1;}getLayout(t){return null==t&&(t=!1),t?this.get_parsedLayout():this.get_layout()}redrawLayout(t){this.set_layout(t),this.set_parsedLayout(t),this.layoutAvailable=null!=this.get_parsedLayout()&&this.get_parsedLayout().length>0,this.render();}init(){this.state.name=this.get_name(),this.state.prefix=this.get_prefix(),this.litOptions.host=this.state;}readResources(t,e){let s=this.get_variables(),i=null;Object.prototype.hasOwnProperty.call(s,"skin")&&(i=o.field(s,"skin"));let n=i,a=null;null!=n&&Object.prototype.hasOwnProperty.call(n,"theme")&&(a=o.field(n,"theme")),null!=t&&Object.prototype.hasOwnProperty.call(t,"theme")&&(a=o.field(t,"theme"));let l=this;if(null!=a&&"string"==typeof a){let t=0==a.indexOf("http");if(0==t&&0==["gorilla","disco","zebra","mole","techno","jazz","snake"].includes(a)){let t={plugin:this.pluginName,error:'Invalid theme name: "'+a+'"'};return void console.error(t)}let s=new c(t?this.versionUrl(a):this.versionUrl("https://bradm.ax/player/VERSION/theme/THEME.json".split("THEME").join(a)));s.onError=$t(this,this.reportError);let i=function(t){let s=null;try{s=JSON.parse(t);}catch(t){let e=Nt.caught(t),s={plugin:l.pluginName,error:e};console.error(s);}e(At.merge(s,n));};s.onData=i,s.request(!1);}else e(n);}parseResources(t,e){null!=e&&null!=t&&Object.prototype.hasOwnProperty.call(e,"icon")&&Object.prototype.hasOwnProperty.call(t,"icon")&&(Object.prototype.hasOwnProperty.call(e.icon,"svg")&&Object.prototype.hasOwnProperty.call(t.icon,"font")&&o.deleteField(t.icon,"font"),Object.prototype.hasOwnProperty.call(e.icon,"font")&&Object.prototype.hasOwnProperty.call(t.icon,"svg")&&o.deleteField(t.icon,"svg"));let s=At.merge(t,e),i=Object.prototype.hasOwnProperty.call(s,"prefix")?o.field(s,"prefix"):null;if(null!=i&&"string"==typeof i){let t=u.trim(i);if(""!=t){let e=t;e=(""+t).toLowerCase().split(" ").join(""),e=new a("[^a-zA-Z0-9_-]","g").split(e).join(""),e=new a("^[0-9]*","g").split(e).join(""),this.set_prefix(e);}}let n=Object.prototype.hasOwnProperty.call(s,"css")?o.field(s,"css"):null;if(null!=n){if(null!=n.adPlaying&&"string"==typeof n.adPlaying){let t=u.trim(n.adPlaying);if(""!=t){let e=t;e=(""+t).toLowerCase().split(" ").join(""),e=new a("[^a-zA-Z0-9_-]","g").split(e).join(""),e=new a("^[0-9]*","g").split(e).join(""),this.get_css().adPlaying=e;}}if(null!=n.adsUiDisabled&&"string"==typeof n.adsUiDisabled){let t=u.trim(n.adsUiDisabled);if(""!=t){let e=t;e=(""+t).toLowerCase().split(" ").join(""),e=new a("[^a-zA-Z0-9_-]","g").split(e).join(""),e=new a("^[0-9]*","g").split(e).join(""),this.get_css().adsUiDisabled=e;}}if(null!=n.adGoogleImaPlaying&&"string"==typeof n.adGoogleImaPlaying){let t=u.trim(n.adGoogleImaPlaying);if(""!=t){let e=t;e=(""+t).toLowerCase().split(" ").join(""),e=new a("[^a-zA-Z0-9_-]","g").split(e).join(""),e=new a("^[0-9]*","g").split(e).join(""),this.get_css().adGoogleImaPlaying=e;}}}let l=Object.prototype.hasOwnProperty.call(s,"name")?o.field(s,"name"):null;if(null!=l&&"string"==typeof l){let t=u.trim(l);if(""!=t){let e=t;e=(""+t).toLowerCase().split(" ").join(""),e=new a("[^a-zA-Z0-9_-]","g").split(e).join(""),e=new a("^[0-9]*","g").split(e).join(""),this.set_name(e);}}let r=Object.prototype.hasOwnProperty.call(s,"color")?o.field(s,"color"):null;null!=r&&"string"==typeof r&&this.set_color(u.trim(r));let h=Object.prototype.hasOwnProperty.call(s,"font")?o.field(s,"font"):null;null!=h&&this.set_font(h);let c=Object.prototype.hasOwnProperty.call(s,"icon")?o.field(s,"icon"):null;if(null!=c&&this.set_icons(c),this.set_styles([]),null!=s&&Object.prototype.hasOwnProperty.call(s,"styles")){let t=o.field(s,"styles");if("string"==typeof t)this.get_styles().push(t);else if(t instanceof Array){let e=t,s=0;for(;s<e.length;){let t=e[s++];this.get_styles().push(t);}}}let d=Object.prototype.hasOwnProperty.call(s,"layout")?o.field(s,"layout"):"";null!=d&&"string"==typeof d&&this.set_layout(u.trim(d));let p=Object.prototype.hasOwnProperty.call(s,"spinner")?o.field(s,"spinner"):null;if(null!=p){let t=Object.prototype.hasOwnProperty.call(p,"html")?o.field(p,"html"):null;if("string"==typeof t){let e=Mt.decodeBase64(t);null!=e&&this.set_spinnerTemplate(this.lit.template(e,"html")({}));}let e=Object.prototype.hasOwnProperty.call(p,"svg")?o.field(p,"svg"):null;if("string"==typeof e){let t=Mt.decodeBase64(e);null!=t&&this.set_spinnerTemplate(this.lit.template(t,"svg")({}));}}this.skinCssSelector="[id="+this.uid+"_skin][data-"+this.get_prefix()+"-name="+this.get_name()+"]",this.skinIcoPrefix=this.uid+"_skin_ico_";}updateResources(){this.attachFonts(),this.attachCssVars(),this.fetchSources();}start(t){this.skinElement=window.document.createElement("div"),this.skinElement.id=this.uid+"_skin",this.skinElement.style.display="none",this.get_parentDisplay().appendChild(this.skinElement);let e=this;if(this.size=new ut(this.context,this.get_variables(),(function(t,s){e.sizeVarChange(t,(function(){e.stateChange({size:t},s);}));}),(function(t){let s={plugin:e.pluginName,error:t};console.error(s);}),this.get_prefix(),this.skinElement),this.device=new K(this.context,this.get_variables(),(function(t,s){e.stateChange({device:t},s);}),(function(t){let s={plugin:e.pluginName,error:t};console.error(s);}),this.get_prefix(),this.skinElement),this.ad=new j(this.context,this.get_variables(),(function(t,s){e.stateChange({ad:t},s);}),(function(t){let s={plugin:e.pluginName,error:t};console.error(s);}),this.get_css(),this.skinElement),this.video=new vt(this.context,this.get_variables(),(function(t,s){e.stateChange({video:t},s);}),(function(t){let s={plugin:e.pluginName,error:t};console.error(s);}),this.get_prefix(),this.skinElement),this.splash=new dt(this.context,this.get_variables(),(function(t,s){e.stateChange({splash:t},s);}),(function(t){let s={plugin:e.pluginName,error:t};console.error(s);})),this.progress=new rt(this.context,this.get_variables(),(function(t,s){e.stateChange({progress:t},s);}),(function(t){let s={plugin:e.pluginName,error:t};console.error(s);}),this.skinElement,t,this.get_player().plugins),this.brand=new z(this.context,this.get_variables(),(function(t,s){e.stateChange({brand:t},s);}),(function(t){let s={plugin:e.pluginName,error:t};console.error(s);})),this.title=new gt(this.context,this.get_variables(),(function(t,s){e.stateChange({title:t},s);}),(function(t){let s={plugin:e.pluginName,error:t};console.error(s);})),this.playlist=new at(this.context,this.get_variables(),(function(t,s){e.stateChange({playlist:t},s);}),(function(t){let s={plugin:e.pluginName,error:t};console.error(s);})),this.menu=new tt(this.context,this.get_variables(),(function(t,s){e.stateChange({menu:t},s);}),(function(t){let s={plugin:e.pluginName,error:t};console.error(s);}),this.get_prefix(),this.get_parentDisplay(),this.get_player().plugins),this.message=new et(this.context,this.get_variables(),(function(t,s){e.stateChange({message:t},s);}),(function(t){let s={plugin:e.pluginName,error:t};console.error(s);})),this.icon=new J(this.context,this.get_variables(),(function(t,s){e.stateChange({icon:t},s);}),(function(t){let s={plugin:e.pluginName,error:t};console.error(s);})),this.hide=new Z(this.context,this.get_variables(),(function(t,s){e.stateChange({hide:t},s);}),(function(t){let s={plugin:e.pluginName,error:t};console.error(s);}),this.get_prefix(),this.get_parentDisplay()),this.popup=new lt(this.context,this.get_variables(),(function(t,s){e.stateChange({popup:t},s);}),(function(t){let s={plugin:e.pluginName,error:t};console.error(s);})),0==g.isSmartTV()){this.volume=new _t(this.context,this.get_variables(),(function(t,s){e.stateChange({volume:t},s);}),(function(t){let s={plugin:e.pluginName,error:t};console.error(s);}),this.skinElement),this.camera=new U(this.context,this.get_variables(),(function(t,s){e.stateChange({camera:t},s);}),(function(t){let s={plugin:e.pluginName,error:t};console.error(s);}),this.skinElement),this.contextmenu=new $(this.context,this.get_variables(),(function(t,s){e.stateChange({contextmenu:t},s);}),(function(t){let s={plugin:e.pluginName,error:t};console.error(s);}),this.get_prefix(),this.skinElement,this.get_playerVersion());let t=function(t){return e.lit.template(e.lit.parseLayout(t))};this.contextmenu.renderTemplate=t;let s=function(t,s){return e.lit.render(s,t,e.litOptions)};this.contextmenu.renderHtml=s;}else this.nav=new st(this.context,this.get_variables(),(function(t,s){e.stateChange({nav:t},s);}),(function(t){let s={plugin:e.pluginName,error:t};console.error(s);}),this.get_prefix(),this.skinElement);if(null!=this.get_spinnerTemplate()){this.spinner=new ct(this.context,this.get_variables(),(function(t,s){e.stateChange({spinner:t},s);}),(function(t){let s={plugin:e.pluginName,error:t};console.error(s);}));let t=function(t){try{return e.lit.render(e.get_spinnerTemplate(),t,e.litOptions)}catch(t){let s=Nt.caught(t),i={plugin:e.pluginName,error:s};return console.error(i),null}};this.spinner.renderHtml=t;}null!=this.icon&&this.icon.updateTypesState(this.skinIcoPrefix,null!=this.get_icons()&&null!=this.get_icons().svg?"svg":"css");}updateIconTypes(){null!=this.icon&&this.icon.updateTypesState(this.skinIcoPrefix,null!=this.get_icons()&&null!=this.get_icons().svg?"svg":"css");}isNotEmpty(t){return null!=t&&"string"==typeof t&&u.trim(t).length>0}versionUrl(t){let e=u.trim(t);return (""+decodeURIComponent(e.split("+").join(" "))).split("VERSION").join(this.get_playerVersion())}attachFonts(){let t=[];if(null!=this.get_font()&&t.push(this.get_font()),null!=this.get_icons()&&null!=this.get_icons().font&&t.push(this.get_icons().font),0==t.length)return;let e="",s=0;for(;s<t.length;){let i,n=t[s];if(++s,1==n.fetch&&null!=n.id){let t=n.src;i=null!=t&&"string"==typeof t&&u.trim(t).length>0;}else i=!1;i&&(e+='<link id="'+n.id+'" href="'+this.versionUrl(n.src)+'" rel="stylesheet" crossorigin @load="${ctx._LOADED_}" >');}if(""==e)return void(this.fontsLoaded=!0);let i=window.document.createElement("head"),n=0,a=this;this.lit.render(this.lit.template(e)({_LOADED_:function(){n-=1,a.fontsLoaded=0==n,a.fontsLoaded&&a.runInited();}}),i,this.litOptions),n=kt.injectAssets(window.document.head,this.get_prefix(),i),this.fontsLoaded=0==n;}attachCssVars(){let t=[],e=this,s=function(s,i,n){let a=[];if(null!=n.family&&n.family instanceof Array&&a.push("--"+e.get_prefix()+"-"+s+"-family: "+n.family.join(", ")+";"),null!=n.size&&a.push("--"+e.get_prefix()+"-"+s+"-size: "+n.size+";"),null!=n.code){let t=0,i=o.fields(n.code);for(;t<i.length;){let l=i[t];++t,a.push("--"+e.get_prefix()+"-"+s+"-code-"+l+': "\\'+h.string(o.field(n.code,l))+'";');}}let l=[];if(null!=n.variation){let t=0,e=o.fields(n.variation);for(;t<e.length;){let s=e[t];++t,l.push('"'+s+'" '+h.string(o.field(n.variation,s)));}}let r=l.length>0?"font-variation-settings: "+l.join(", ")+";":"";t.push(i+"{"+r+a.join("")+"}");};if(null!=this.get_font()&&s("font",""+this.skinCssSelector,this.get_font()),null!=this.get_icons()&&(null!=this.get_icons().font&&s("icon",this.skinCssSelector+" ."+this.get_prefix()+"-ico",this.get_icons().font),null!=this.get_icons().svg&&function(s,i,n){let a=[];null!=n.size&&a.push("--"+e.get_prefix()+"-"+s+"-size: "+n.size+";"),a.length>0&&t.push(i+"{"+a.join("")+"}");}("icon",this.skinCssSelector+" ."+this.get_prefix()+"-ico",this.get_icons().svg)),0!=t.length){if(null==this.fontVarsElement){let t=this.uid+"_skin_font";this.fontVarsElement=window.document.querySelector(t),null==this.fontVarsElement&&(this.fontVarsElement=window.document.createElement("style"),this.fontVarsElement.id=t,null!=this.skinElement?this.get_parentDisplay().insertBefore(this.fontVarsElement,this.skinElement):this.get_parentDisplay().appendChild(this.fontVarsElement));}this.fontVarsElement.innerText="",this.fontVarsElement.insertAdjacentHTML("beforeend",t.join("\n"));}}fetchSources(){let t,e=Object.create(null),s=this,i=function(){let t=e,i=Object.keys(t),n=i.length,a=0;for(;a<n;)if(0==t[i[a++]].loaded)return;s.sourcesLoaded=!0,s.sourcesLoaded&&s.runInited();},n=function(t){Object.prototype.hasOwnProperty.call(e,t)&&(e[t].loaded=!0),i();},a=this.get_layout();if(null!=a&&"string"==typeof a&&u.trim(a).length>0)if(this.get_layout().endsWith(".html")){let t="layout",i=new c(this.versionUrl(this.get_layout()));i.onError=$t(this,this.reportError),i.onData=function(e){s.redrawLayout(e),n(t);},e[t]={loaded:!1,req:i};}else {let t=Mt.decodeBase64(this.get_layout());null!=t&&(this.redrawLayout(t),i());}else {let t={plugin:this.pluginName,error:"missing layout url"};console.error(t);}if(null!=this.get_icons()&&null!=this.get_icons().svg){let e=this.get_icons().svg.iconset;t=null!=e&&"string"==typeof e&&u.trim(e).length>0;}else t=!1;if(t){let t=this.get_icons().svg.id,a=this.get_icons().svg.iconset;if(a.endsWith(".svg")){if(!Object.prototype.hasOwnProperty.call(e,""+t)){let i=new c(this.versionUrl(a));i.onError=$t(this,this.reportError),i.onData=function(e){s.renderSvgset(s.uid+"_"+t+"_skin_iconset",e),n(t);},e[""+t]={loaded:!1,req:i};}}else {let e=Mt.decodeBase64(a);null!=e&&(this.renderSvgset(this.uid+"_"+t+"_skin_iconset",e),i());}}let l,r,o="style",h=this.get_styles(),d=0;for(;d<h.length;){let t=h[d],i=d++;if(null!=t&&"string"==typeof t&&u.trim(t).length>0){let a=function(t){let e=window.document.head,a=s.get_prefix(),l=s.get_name(),r="[data-"+s.get_prefix()+"-name="+l+"]";kt.appendStyle(e,a,null!=r&&t.includes(":host")?t.split(":host").join(r):t),n(o+"["+i+"]");};if(t.endsWith(".css")){let s=new c(this.versionUrl(t));s.onError=$t(this,this.reportError),s.onData=a,e[o+"["+i+"]"]={loaded:!1,req:s};}else {let e=Mt.decodeBase64(t);null!=e&&a(e);}}}if(null!=this.get_font()&&0==this.get_font().fetch){let t=this.get_font().src;l=null!=t&&"string"==typeof t&&u.trim(t).length>0;}else l=!1;if(l){let t=Mt.decodeBase64(this.get_font().src);null!=t&&(kt.appendStyle(window.document.head,this.get_prefix()+"-font",t),i());}if(null!=this.get_icons()&&null!=this.get_icons().font&&0==this.get_icons().font.fetch){let t=this.get_icons().font.src;r=null!=t&&"string"==typeof t&&u.trim(t).length>0;}else r=!1;if(r){let t=Mt.decodeBase64(this.get_icons().font.src);null!=t&&(kt.appendStyle(window.document.head,this.get_prefix()+"-icons-font",t),i());}let p=e,m=Object.keys(p),f=m.length,g=0;for(;g<f;)p[m[g++]].req.request(!1);}renderSvgset(t,e){let s=window.document.createElement("div");this.lit.render(this.lit.template(e,"svg")({}),s,this.litOptions);let i,n=s.querySelectorAll("symbol"),a=0;for(;a<n.length;)i=n[a++],i.id=""+this.skinIcoPrefix+i.id;let l=window.document.querySelector(t);null!=l&&null!=l.parentNode&&l.parentNode.removeChild(l),l=s.querySelector("svg"),l.id=t,l.style.display="none",null!=this.skinElement?this.get_parentDisplay().insertBefore(l,this.skinElement):this.get_parentDisplay().appendChild(l);}reportError(t){let e={plugin:this.pluginName,error:t};console.error(e);}runInited(){null!=this.initedTimer&&this.initedTimer.stop(),this.initedTimer=Ft.delay($t(this,this.inited),200);}inited(){0!=this.sourcesLoaded&&0!=this.fontsLoaded&&(this.ready=this.sourcesLoaded&&this.fontsLoaded,0!=this.ready&&null!=this.skinElement&&(this.skinElement.classList.add(this.get_prefix()+"-ready"),this.skinElement.style.display="block",this.skinElement.classList.add(this.get_prefix()),1!=this.state.device.tizen?this.skinElement.classList.add(this.get_prefix()+"-can-blur"):this.skinElement.classList.add(this.get_prefix()+"-cant-blur"),this.skinElement.setAttribute("data-"+this.get_prefix()+"-name",this.get_name())));}sizeVarChange(t,e){let s=this.skinCssSelector+" { --"+this.get_prefix()+"-width: "+t.width+"px; --"+this.get_prefix()+"-height: "+t.height+"px; }";if(null==this.sizeVarsElement){let t=this.uid+"_skin_size";this.sizeVarsElement=window.document.querySelector(t),null==this.sizeVarsElement&&(this.sizeVarsElement=window.document.createElement("style"),this.sizeVarsElement.id=t,null!=this.skinElement?this.get_parentDisplay().insertBefore(this.sizeVarsElement,this.skinElement):this.get_parentDisplay().appendChild(this.sizeVarsElement));}this.sizeVarsElement.innerText="",this.sizeVarsElement.insertAdjacentHTML("beforeend",s),null!=e&&o.isFunction(e)&&e();}stateChange(t,e){if(null!=t){let e=0,s=o.fields(t);for(;e<s.length;){let i=s[e];++e,this.state[i]=o.field(t,i);}}this.render(e);}render(t){0!=this.activated&&0!=this.layoutAvailable&&(this.lit.render(this.skinTemplate(this.state),this.skinElement,this.litOptions),null!=t&&o.isFunction(t)&&t(this.skinElement));}get_prefix(){return this._prefix}set_prefix(t){return this._prefix=t,this.state.prefix=t,this.skinCssSelector="[id="+this.uid+"_skin][data-"+t+"-name="+this.get_name()+"]",null!=this.hide&&this.hide.set_prefix(t),null!=this.contextmenu&&this.contextmenu.set_prefix(t),null!=this.menu&&this.menu.set_prefix(t),null!=this.size&&this.size.set_prefix(t),null!=this.device&&this.device.set_prefix(t),null!=this.video&&this.video.set_prefix(t),this._prefix}get_css(){return this._css}set_css(t){return this._css=t,this._css}get_name(){return this._name}set_name(t){return this._name=t,this.state.name=t,this.skinCssSelector="[id="+this.uid+"_skin][data-"+this.get_prefix()+"-name="+t+"]",this._name}get_playerVersion(){return "v2.15.38"}get_color(){return this._color}set_color(t){if(this._color=t,null==this.colorVarsElement){let t=this.uid+"_skin_colors";this.colorVarsElement=window.document.querySelector(t),null==this.colorVarsElement&&(this.colorVarsElement=window.document.createElement("style"),this.colorVarsElement.id=t,null!=this.skinElement?this.get_parentDisplay().insertBefore(this.colorVarsElement,this.skinElement):this.get_parentDisplay().appendChild(this.colorVarsElement));}this.colorVarsElement.innerText="";let e="string"==typeof t&&""!=t?this.skinCssSelector+" { --"+this.get_prefix()+"-main-color: "+t+"; }":"";return ""!=e&&this.colorVarsElement.insertAdjacentHTML("beforeend",e),this._color}get_font(){return this._font}set_font(t){return this._font=t,this._font}get_icons(){return this._icons}set_icons(t){return this._icons=t,this._icons}get_styles(){return this._styles}set_styles(t){return this._styles=t,this._styles}get_layout(){return this._layout}set_layout(t){return this._layout=t,this._layout}get_parsedLayout(){return this._parsedLayout}set_parsedLayout(t){return this._parsedLayout=this.lit.parseLayout(t),this.skinTemplate=this.lit.template(this._parsedLayout),this._parsedLayout}get_spinnerTemplate(){return this._spinnerTemplate}set_spinnerTemplate(t){return this._spinnerTemplate=t,this._spinnerTemplate}}t.bs.player.plugin.skin.HtmlSkin=F,F.__name__="bs.player.plugin.skin.HtmlSkin",F.__super__=A,Object.assign(F.prototype,{__class__:F});class V{constructor(){this.api=V.native();}render(t,e,s){return this.api.render(t,e,s)}template(t,e){return this.api.template(t,e)}parseLayout(t){return Ot.cleanup(t),t=this.litIf(t),t=this.litFor(t)}litFor(t){if(t.indexOf("<for")<0)return t;let e=[],s=[],i=t.length,n=0;for(;n<=i;){let a=t.indexOf("<for",n);if(-1<a){e.push(t.substring(n,a)),n=a+4,a=n;let l=1;for(;0<l&&n<i;){let e=t.charAt(n),s=t.charAt(n+1),i=t.charAt(n+2),a=t.charAt(n+3),r=t.charAt(n+4);l+="<"==e&&"f"==s&&"o"==i&&"r"==a&&" "==r?1:"<"==e&&"/"==s&&"f"==i&&"o"==a&&"r"==r&&">"==t.charAt(n+5)?-1:0,++n;}s.push(this.formatLitFor(t.substring(a-4,n-1))),n+=5;}else e.push(t.substring(n)),n=i+1;}return Ot.merge(e,s)}formatLitFor(t){let e=new a("(<for[^>][\\s\\S]*?items=\\W\\$\\{{1})([\\s\\S]+?)(\\}[\\s\\S]*?>)","");if(t=Ot.escapeCustomAttributes(t,[e]),0==e.match(t))return t;let s=Ot.readCustomAttribute(e.matched(2));return "${"+s+" && "+s+".length > 0 ? "+s+".map((item, index) => html`"+this.litFor(Ot.removeCustomTag(t,e))+"`) : nothing}"}litIf(t){if(t.indexOf("<if")<0)return t;let e=[],s=[],i=t.length,n=0;for(;n<=i;){let a=t.indexOf("<if",n);if(-1<a){e.push(t.substring(n,a)),n=a+3,a=n;let l=1;for(;0<l&&n<i;){let e=t.charAt(n),s=t.charAt(n+1),i=t.charAt(n+2),a=t.charAt(n+3);l+="<"==e&&"i"==s&&"f"==i&&" "==a?1:"<"==e&&"/"==s&&"i"==i&&"f"==a&&">"==t.charAt(n+4)?-1:0,++n;}s.push(this._formatLitIf(t.substring(a-3,n-1))),n+=4;}else e.push(t.substring(n)),n=i+1;}return Ot.merge(e,s)}_formatLitIf(t){let e=new a("(<if[^>][\\s\\S]*?cond=\\W\\$\\{{1})([\\s\\S]+?)(\\}[\\s\\S]*?>)","");return t=Ot.escapeCustomAttributes(t,[e]),0==e.match(t)?t:"${"+Ot.readCustomAttribute(e.matched(2))+" ? html`"+this.litIf(Ot.removeCustomTag(t,e))+"` : nothing}"}static native(){return exports.lit}}V.__name__="bs.player.plugin.skin.lib.LitHtml",Object.assign(V.prototype,{__class__:V});class B{constructor(t,e,s,i){B._hx_skip_constructor||this._hx_constructor(t,e,s,i);}_hx_constructor(t,e,s,i){this.state=null,this.context=null,this.context=t,this.reportError=i,this.refreshCallback=s;}reportError(t){}refreshCallback(t,e){}postActivate(){}destroy(){}}B.__name__="bs.player.plugin.skin.model.core.BaseModel",Object.assign(B.prototype,{__class__:B});class j extends B{constructor(t,e,s,i,n,a){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i,n,a);}_hx_constructor(t,e,s,i,n,a){this.ui=new C(!1),this.isAdSkinVisible=!1,this.adWasClicked=!1,this.adOnClickUrlShowTime=null,this.isGoogleIma=!1,this.isBuffering=!1,this.isMuted=!1,this.isPaused=!1,this.total=0,this.current=0,this.progress=0,this.linkUrl=null,this.duration=null,this.time=null,this.skinElement=null,this.keepSkin=!1,super._hx_constructor(t,e,s,i),this.css=n,this.skinElement=a,this.parseVars(e),this.state=null,1!=this.keepSkin&&(d.add(t,"adEnableControls",$t(this,this.onHide)),d.add(t,"adDisableControls",$t(this,this.onShow)),d.add(t,"adBarShow",$t(this,this.onAdBarShow)),d.add(t,"adBarHide",$t(this,this.onAdBarHide)),d.add(t,"adInStreamClipPlaying",$t(this,this.onAdInStreamStart)),d.add(t,"adBufferingStart",$t(this,this.onAdBufferingStart)),d.add(t,"adBufferingEnd",$t(this,this.onAdBufferingEnd)),m.add(t,"adMetadataData",$t(this,this.onAdStart)),m.add(t,"thirdPartyAdMetadataData",$t(this,this.onAdStart)),p.addOnce(t,"skinMute",$t(this,this.onFirstMute)),p.addOnce(t,"skinUnmute",$t(this,this.onFirstUnmute)));}destroy(){super.destroy(),d.remove(this.context,"adEnableControls",$t(this,this.onHide)),d.remove(this.context,"adDisableControls",$t(this,this.onShow)),d.remove(this.context,"adBarShow",$t(this,this.onAdBarShow)),d.remove(this.context,"adBarHide",$t(this,this.onAdBarHide)),d.remove(this.context,"adInStreamClipPlaying",$t(this,this.onAdInStreamStart)),d.remove(this.context,"adBufferingStart",$t(this,this.onAdBufferingStart)),d.remove(this.context,"adBufferingEnd",$t(this,this.onAdBufferingEnd)),m.remove(this.context,"adMetadataData",$t(this,this.onAdStart)),m.remove(this.context,"thirdPartyAdMetadataData",$t(this,this.onAdStart)),this.isAdSkinVisible=!1;}parseVars(t){Object.prototype.hasOwnProperty.call(t,"keepSkinOnAd")&&(this.keepSkin=1==o.field(t,"keepSkinOnAd"));}resetState(t){this.linkUrl=null,this.time=null,this.duration=null,this.progress=0,this.current=0,this.total=0,this.isPaused=!1,this.isBuffering=!1,this.ui=new C(!1),this.isGoogleIma=!1,this.adOnClickUrlShowTime=null,this.adWasClicked=!1,this.state=null,t&&this.refreshCallback(this.state);}createState(t){if(this.ui.disabled)return void this.resetState(t);let e=this,s=It.translate("advertisement_bar_title"),i=this.progress;this.state={label:s,time:this.time,duration:this.duration,progress:{value:this.progress,prc:isNaN(i)||!isFinite(i)?"0%":Math.max(0,Math.min(100,100*i))+"%"},status:{paused:this.isPaused,muted:this.isMuted,buffering:this.isBuffering},link:{url:null!=this.linkUrl?this.linkUrl:null,target:"_blank"},ui:this.ui,skip:null,counter:this.current==this.total&&this.current<=1?null:{current:this.current,total:this.total,text:this.current+"/"+this.total},play:function(t){e.playClick(t);},mute:function(t){e.muteClick(t);},click:function(t){e.adClick(t);}},t&&this.refreshCallback(this.state);}updateSkinContainerCss(){this.isAdSkinVisible?(this.skinElement.classList.contains(this.css.adPlaying)||this.skinElement.classList.add(this.css.adPlaying),this.ui.disabled?this.skinElement.classList.contains(this.css.adsUiDisabled)||this.skinElement.classList.add(this.css.adsUiDisabled):this.skinElement.classList.contains(this.css.adsUiDisabled)&&this.skinElement.classList.remove(this.css.adsUiDisabled),this.isGoogleIma?this.skinElement.classList.contains(this.css.adGoogleImaPlaying)||this.skinElement.classList.add(this.css.adGoogleImaPlaying):this.skinElement.classList.contains(this.css.adGoogleImaPlaying)&&this.skinElement.classList.remove(this.css.adGoogleImaPlaying)):(this.skinElement.classList.contains(this.css.adPlaying)&&this.skinElement.classList.remove(this.css.adPlaying),this.skinElement.classList.contains(this.css.adsUiDisabled)&&this.skinElement.classList.remove(this.css.adsUiDisabled),this.skinElement.classList.contains(this.css.adGoogleImaPlaying)&&this.skinElement.classList.remove(this.css.adGoogleImaPlaying));}onAdInStreamStart(t){this.parseAdMedia(t.data);}onAdStart(t){this.parseAdMedia(t.data);}onAdBufferingStart(t){this.isBuffering=!0,null!=this.state&&(this.state.status.buffering=this.isBuffering,this.refreshCallback(this.state));}onAdBufferingEnd(t){this.isBuffering=!1,null!=this.state&&(this.state.status.buffering=this.isBuffering,this.refreshCallback(this.state));}parseAdMedia(t){if(this.resetState(!1),null!=t){if(this.isGoogleIma=Object.prototype.hasOwnProperty.call(t.customParams.h,"isGoogleIma")&&Ut.__cast(t.customParams.h.isGoogleIma,Kt),null!=t.durationTotal&&null!=t.durationPlayed){let e=t.durationTotal-t.durationPlayed;this.time={time:e,text:It.formatTime(e)};}if(null!=t.durationTotal){let e=t.durationTotal;this.duration={time:e,text:It.formatTime(e)};}this.isGoogleIma||(this.linkUrl=t.mediaClickTargetUrl),null!=t.ui&&(this.ui=t.ui),this.isAdSkinVisible&&this.updateSkinContainerCss(),null!=this.time?(this.current=t.currentOrderNumber,this.total=t.totalNumber,this.createState(!0),this.adOnClickUrlShowTime=new Date):this.resetState(!0);}else this.resetState(!0);}onHide(t){this.adWasClicked=!1,this.isAdSkinVisible=!1,this.updateSkinContainerCss(),d.remove(this.context,"adGroupCurrentTimeChange",$t(this,this.afterShowOnTimeChange)),d.remove(this.context,"adGroupCurrentIndexChange",$t(this,this.afterShowOnIndexChange)),d.remove(this.context,"adSkipButtonShow",$t(this,this.afterShowOnShowCloseBtn)),d.remove(this.context,"adSkipButtonHide",$t(this,this.afterShowOnHideCloseBtn)),d.remove(this.context,"adAdHide",$t(this,this.afterShowOnShowCloseBtn)),d.remove(this.context,"adPlaying",$t(this,this.afterShowOnAdPlayResume)),d.remove(this.context,"adPaused",$t(this,this.afterShowOnAdPause)),this.resetState(!0);}onShow(t){this.adWasClicked=!1,this.isAdSkinVisible=!0,this.updateSkinContainerCss(),this.adOnClickUrlShowTime=new Date,d.add(this.context,"adGroupCurrentTimeChange",$t(this,this.afterShowOnTimeChange)),d.add(this.context,"adSkipButtonShow",$t(this,this.afterShowOnShowCloseBtn)),d.add(this.context,"adSkipButtonHide",$t(this,this.afterShowOnHideCloseBtn)),d.add(this.context,"adAdHide",$t(this,this.afterShowOnShowCloseBtn)),d.add(this.context,"adPlaying",$t(this,this.afterShowOnAdPlayResume)),d.add(this.context,"adPaused",$t(this,this.afterShowOnAdPause));}afterShowOnIndexChange(t){null!=this.state&&null!=t&&null!=t.data&&null!=t.data.currentOrderNumber&&null!=t.data.totalNumber&&(this.current=t.data.currentOrderNumber,this.total=t.data.totalNumber,this.state.counter=this.current==this.total&&this.current<=1?null:{current:this.current,total:this.total,text:this.current+"/"+this.total},this.refreshCallback(this.state));}afterShowOnTimeChange(t){if(null==this.state)return;let e,s;if(null!=t.data&&null!=t.data.duration&&null!=t.data.currentTime){let e=t.data.duration;s=isNaN(e);}else s=!0;if(s)e=!0;else {let s=t.data.currentTime;e=isNaN(s);}if(e)return;let i=t.data.duration-t.data.currentTime;this.state.time={time:i,text:It.formatTime(i)};let n=t.data.duration;this.duration={time:n,text:It.formatTime(n)},this.progress=t.data.currentTime/t.data.duration;let a=this.progress,l=this.progress,r=isNaN(l)||!isFinite(l);this.state.progress={value:a,prc:r?"0%":Math.max(0,Math.min(100,100*l))+"%"},this.refreshCallback(this.state);}afterShowOnShowCloseBtn(t){if(null==this.state)return;let e=this,s=It.translate("advertisement_skip_label");this.state.skip={label:s,click:function(t){e.closeClick(t);}},this.refreshCallback(this.state);}afterShowOnHideCloseBtn(t){null!=this.state&&(this.state.skip=null,this.refreshCallback(this.state));}afterShowOnAdPlayResume(t){this.isPaused=!1,null!=this.state&&(this.state.status.paused=this.isPaused,this.refreshCallback(this.state));}afterShowOnAdPause(t){this.isPaused=!0,null!=this.state&&(this.state.status.paused=this.isPaused,this.refreshCallback(this.state));}onAdBarShow(t){this.ui.disabled=!1,this.skinElement.classList.contains(this.css.adsUiDisabled)&&this.skinElement.classList.remove(this.css.adsUiDisabled),this.createState(!0);}onAdBarHide(t){this.ui.disabled=!0,this.skinElement.classList.contains(this.css.adsUiDisabled)||this.skinElement.classList.add(this.css.adsUiDisabled),this.resetState(!0);}onFirstMute(t){this.isMuted=!0,null!=this.state&&(this.state.status.muted=this.isMuted,this.refreshCallback(this.state)),p.remove(this.context,"skinUnmute",$t(this,this.onFirstUnmute)),p.remove(this.context,"skinMute",$t(this,this.onFirstMute));}onFirstUnmute(t){this.isMuted=!1,null!=this.state&&(this.state.status.muted=this.isMuted,this.refreshCallback(this.state)),p.remove(this.context,"skinUnmute",$t(this,this.onFirstUnmute)),p.remove(this.context,"skinMute",$t(this,this.onFirstMute));}playClick(t){null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()),this.isGoogleIma?new p("thirdPartySkinAdPlayPause").dispatch(this.context):new d(this.isPaused?"adPlay":"adPause").dispatch(this.context);}muteClick(t){null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()),p.remove(this.context,"skinUnmute",$t(this,this.onFirstUnmute)),p.remove(this.context,"skinMute",$t(this,this.onFirstMute)),new p(this.isMuted?"skinUnmute":"skinMute").dispatch(this.context),this.isMuted=!this.isMuted,null!=this.state&&(this.state.status.muted=this.isMuted,this.refreshCallback(this.state));}closeClick(t){null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()),new d("adSkipClick").dispatch(this.context);}adClick(t){if(this.isGoogleIma)return void(null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()));let e=0;if(null!=this.adOnClickUrlShowTime&&(e=(new Date).getTime()-this.adOnClickUrlShowTime.getTime()),e<=500)return;this.isPaused&&!this.adWasClicked?null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()):this.adWasClicked?(null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()),this.linkUrl=null,this.refreshCallback(this.state)):this.adWasClicked=!0;let s=new d("adAdClick");s.data={url:this.linkUrl},s.dispatch(this.context);}}j.__name__="bs.player.plugin.skin.model.ads.AdModel",j.__super__=B,Object.assign(j.prototype,{__class__:j});class R extends B{constructor(t,e,s,i){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i);}_hx_constructor(t,e,s,i){this.audioSets=[],super._hx_constructor(t,e,s,i),this.languageCode=Mt.audio(e),this.state={name:"audio",hasItems:!1,activate:null},0!=St.audioSelectionVisible(e)&&(this.state.activate=$t(this,this.activate),m.add(t,"audioData",$t(this,this.onAudioData)),m.add(t,"mediaMetadataData",$t(this,this.cleanupState)),this.refreshCallback(this.state));}destroy(){super.destroy(),m.remove(this.context,"audioData",$t(this,this.onAudioData)),m.remove(this.context,"mediaMetadataData",$t(this,this.cleanupState));}onAudioData(t){this.audioSets=t.data;let e,s=this.audioSets;if(null!=s){let t=$t(this,this.formatStateItemFromAudioSet),i=new Array(s.length),n=0,a=s.length;for(;n<a;){let e=n++;i[e]=t(s[e]);}e=i;}else e=null;let i=null!=e?Et.ensureSingleActiveListItem(e):null;this.state.items=i;let n=this.state.items;this.state.hasItems=(null!=n?n.length:null)>0;let a=this.findActiveAudioSet(this.audioSets);if(this.dispatchSelectAudioEvent(a),null!=a){let t=a.languageCode,e=!1,s=null;if(s=Ht.getSessionStorage(),e=null!=s,e)try{if(null==t){let t=null;t=Ht.getSessionStorage(),t.removeItem("_brplayer_aud_lang");}else {let e=null;e=Ht.getSessionStorage(),e.setItem("_brplayer_aud_lang",h.string(t));}}catch(t){console.warn("Error occured durring writing audio language into session storage.");}}this.refreshCallback(this.state);}formatStateItemFromAudioSet(t){let e=this.isAudioSetActive(t),s=t.name;return {active:e,label:It.capilizeFirstLetter(null!=s?s:t.languageCode),data:t.languageCode}}isAudioSetActive(t){return !!t.preselected||this.languageCode==t.languageCode}findActiveAudioSet(t){if(null!=t){let e=$t(this,this.isAudioSetActive),s=[],i=0;for(;i<t.length;){let n=t[i];++i,e(n)&&s.push(n);}return s.shift()}return null}dispatchSelectAudioEvent(t){if(null==t)return;let e=new p("selectAudio");e.data=t,e.dispatch(this.context);}cleanupState(t){this.audioSets=[],o.deleteField(this.state,"items"),this.refreshCallback(this.state);}selectActiveItemByIndex(t){let e=0,s=this.state.items.length;for(;e<s;){let s=e++;this.state.items[s].active=s==t;}}activate(t){if(!Object.prototype.hasOwnProperty.call(this.state,"items"))return;null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault());let e=h.parseInt(Ut.__cast(t.target,HTMLElement).getAttribute("data-item-index"));if(isNaN(e))return;this.selectActiveItemByIndex(e);let s=this.audioSets[e];if(this.dispatchSelectAudioEvent(s),null!=s){let t=s.languageCode,e=!1,i=null;if(i=Ht.getSessionStorage(),e=null!=i,e)try{if(null==t){let t=null;t=Ht.getSessionStorage(),t.removeItem("_brplayer_aud_lang");}else {let e=null;e=Ht.getSessionStorage(),e.setItem("_brplayer_aud_lang",h.string(t));}}catch(t){console.warn("Error occured durring writing audio language into session storage.");}}this.refreshCallback(this.state);}}R.__name__="bs.player.plugin.skin.model.audio.AudioModel",R.__super__=B,Object.assign(R.prototype,{__class__:R});class z extends B{constructor(t,e,s,i){super(t,e,s,i),this.parseVars(e);}destroy(){super.destroy();}parseVars(t){let e=null;Object.prototype.hasOwnProperty.call(t,"logoFile")&&(e=o.field(t,"logoFile"));let s,i,n=e;if(null==n||""==n)return;if(Object.prototype.hasOwnProperty.call(t,"logoAutohide"))switch(o.field(t,"logoAutohide")){case 0:case"false":case!1:s=!1;break;default:s=!0;}else s=!0;if(Object.prototype.hasOwnProperty.call(t,"logoVisibleDuringAdPlayback"))switch(o.field(t,"logoVisibleDuringAdPlayback")){case 1:case"true":case!0:i=!0;break;default:i=!1;}else i=!1;let a=null;Object.prototype.hasOwnProperty.call(t,"logoText")&&(a=o.field(t,"logoText"));let l=a,r=null;Object.prototype.hasOwnProperty.call(t,"logoLink")&&(r=o.field(t,"logoLink"));let h,u=r;if(Object.prototype.hasOwnProperty.call(t,"logoLinkTarget"))switch(o.field(t,"logoLinkTarget")){case"_blank":default:h="_blank";break;case"_parent":h="_parent";break;case"_self":h="_self";break;case"_top":h="_top";}else h=null;let c,d,p={url:u,target:h};if(Object.prototype.hasOwnProperty.call(t,"logoXPosition"))switch(o.field(t,"logoXPosition")){case"left":default:c="left";break;case"right":c="right";}else c="left";if(Object.prototype.hasOwnProperty.call(t,"logoYPosition"))if("bottom"===o.field(t,"logoYPosition"))d="bottom";else d="top";else d="top";let m={hide:s,adsVisibility:i,logo:n,text:l,link:p,position:{x:c,y:d,top:!0,left:!0,right:!1,bottom:!1}};m.position.top="top"==m.position.y,m.position.right="right"==m.position.x,m.position.left="left"==m.position.x,m.position.bottom="bottom"==m.position.y,this.state=m,this.refreshCallback(this.state);}}z.__name__="bs.player.plugin.skin.model.brand.BrandModel",z.__super__=B,Object.assign(z.prototype,{__class__:z});class W extends B{constructor(t,e,s,i){B._hx_skip_constructor?super():(B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i));}_hx_constructor(t,e,s,i){this.isDvrWallTimeMode=!1,this.isDvr=!1,this.isLiveStream=!1,this.isMediaSpherical=!1,this.isSeekable=!0,this.duration=0,super._hx_constructor(t,e,s,i);let n,a=null;if(Object.prototype.hasOwnProperty.call(e,"dvrMinLenForSeekbar")&&(a=parseFloat(o.field(e,"dvrMinLenForSeekbar")),isNaN(a)&&(a=null)),this.minLenForSeeking=a,null==this.minLenForSeeking&&(this.minLenForSeeking=300),Object.prototype.hasOwnProperty.call(e,"isDvrWallTimeMode"))switch(o.field(e,"isDvrWallTimeMode")){case 1:case"true":case!0:n=!0;break;default:n=!1;}else n=!1;this.isDvrWallTimeMode=n,this.monitor=w.getMonitor(t),m.add(t,"mediaMetadataData",$t(this,this.onMetadataData)),m.add(t,"mediaAfterPlaybackStartMetadata",$t(this,this.onAfterPlaybackStartMetadataData));}get_maxDuration(){return this.duration>0?this.duration-(this.isDvr?0:1):0}destroy(){super.destroy(),w.destroyMonitor(this.context),m.remove(this.context,"mediaMetadataData",$t(this,this.onMetadataData)),m.remove(this.context,"mediaAfterPlaybackStartMetadata",$t(this,this.onAfterPlaybackStartMetadataData));}updateState(t){}onMetadataData(t){let e=this.monitor.currentMedia;e instanceof T?(this.isDvr=!1,this.isLiveStream=!1):e instanceof x?(this.isDvr=!0,this.isLiveStream=e instanceof S):(this.isDvr=!1,this.isLiveStream=!1),this.updateDurationOnEvent(t,!1),this.isMediaSpherical=e.spherical,this.updateState();}onAfterPlaybackStartMetadataData(t){t.data instanceof x&&!this.isDvr&&(this.isDvr=!0),t.data instanceof x||!this.isDvr||(this.isDvr=!1),this.updateDurationOnEvent(t,!1),this.isMediaSpherical=t.data.spherical,this.updateState();}isSeekingPossible(){return !(this.duration<=0||this.isDvr&&this.duration<this.minLenForSeeking)}updateDurationOnEvent(t,e){null==e&&(e=!0);let s=Object.prototype.hasOwnProperty.call(t.data,"duration")?t.data.duration:NaN;!isNaN(s)&&isFinite(s)&&this.duration!=s&&(this.duration=s,this.isSeekable=this.isSeekingPossible(),1==e&&this.updateState());}}W.__name__="bs.player.plugin.skin.model.core.MediaBaseModel",W.__super__=B,Object.assign(W.prototype,{__class__:W});class q extends W{constructor(t,e,s,i){B._hx_skip_constructor?super():(B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i));}_hx_constructor(t,e,s,i){this.current={position:0,playback:0,time:0},this.isLive=!1,this.inSyncTimeWindow=20,this.hasPlaybackStarted=!1,this.isComplete=!1,this.isSeeking=!1,this.isBuffering=!1,this.isPaused=!1,this.isPlaying=!1,this.isInited=!1,super._hx_constructor(t,e,s,i),y.add(t,"videoMediaElementInit",$t(this,this.onVideoMediaElementInit)),y.add(t,"ready",$t(this,this.onReady)),y.add(t,"playing",$t(this,this.onPlaying)),y.add(t,"paused",$t(this,this.onPaused)),y.add(t,"stopped",$t(this,this.onStopped)),y.add(t,"durationChange",$t(this,this.onDurationChange)),y.add(t,"currentTimeChange",$t(this,this.onCurrentTimeChange)),y.add(t,"complete",$t(this,this.onComplete)),y.add(t,"bufferingStart",$t(this,this.onBufferingStart)),y.add(t,"bufferingEnd",$t(this,this.onBufferingEnd)),y.add(t,"seekingStart",$t(this,this.onSeekingStart)),y.add(t,"seekingEnd",$t(this,this.onSeekingEnd));let n=null;if(Object.prototype.hasOwnProperty.call(e,"inSyncTimeWindow")&&(n=parseFloat(o.field(e,"inSyncTimeWindow")),isNaN(n)&&(n=null)),n>0){let t=null;Object.prototype.hasOwnProperty.call(e,"inSyncTimeWindow")&&(t=parseFloat(o.field(e,"inSyncTimeWindow")),isNaN(t)&&(t=null)),this.inSyncTimeWindow=t;}}getInSyncTimeWindowWithHisteresis(){return this.isLive?2*this.inSyncTimeWindow:this.inSyncTimeWindow}destroy(){super.destroy(),y.remove(this.context,"videoMediaElementInit",$t(this,this.onVideoMediaElementInit)),y.remove(this.context,"ready",$t(this,this.onReady)),y.remove(this.context,"playing",$t(this,this.onPlaying)),y.remove(this.context,"paused",$t(this,this.onPaused)),y.remove(this.context,"stopped",$t(this,this.onStopped)),y.remove(this.context,"durationChange",$t(this,this.onDurationChange)),y.remove(this.context,"currentTimeChange",$t(this,this.onCurrentTimeChange)),y.remove(this.context,"complete",$t(this,this.onComplete)),y.remove(this.context,"bufferingStart",$t(this,this.onBufferingStart)),y.remove(this.context,"bufferingEnd",$t(this,this.onBufferingEnd)),y.remove(this.context,"seekingStart",$t(this,this.onSeekingStart)),y.remove(this.context,"seekingEnd",$t(this,this.onSeekingEnd));}updateState(t){super.updateState(t),this.checkInSynchTimeForLive(),this.isComplete="complete"==this.monitor.state||!this.isDvr&&this.current.time>0&&this.duration>0&&this.current.time>=this.get_maxDuration(),this.isPlaying=this.isComplete||this.isDvr||null==t?"playing"==this.monitor.state:t,this.isPaused=!this.isPlaying&&!this.isComplete&&"paused"==this.monitor.state,this.isBuffering=!this.isPlaying&&!this.isComplete&&"buffering"==this.monitor.state,this.isSeeking=!this.isPlaying&&!this.isComplete&&"seeking"==this.monitor.state,this.isDvr?this.isSeekingPossible()?this.isLive=this.current.position/this.duration>=.99||this.current.position+this.getInSyncTimeWindowWithHisteresis()>=this.duration:this.isLive=!0:this.isLive=!1;}onVideoMediaElementInit(t){this.isInited=!0,this.updateState();}onReady(t){this.updateState();}onDurationChange(t){this.updateDurationOnEvent(t);}onCurrentTimeChange(t){this.updateCurrentTimeFromEvent(t),this.updateDurationOnEvent(t,!1),this.updateState(!0);}updateCurrentTimeFromEvent(t){null!=t&&null!=t.data&&(t.data.currentTime>=0&&(this.current.position=Math.max(0,t.data.currentTime),this.current.playback=0,this.current.time=this.current.position),null!=t.data.media&&null!=t.data.media.mediaPlaybackInfo&&t.data.media.mediaPlaybackInfo.currentTime>0&&(this.current.playback=t.data.media.mediaPlaybackInfo.currentTime,this.current.time=this.current.playback)),this.current.time>0&&(this.hasPlaybackStarted=!0),this.checkInSynchTimeForLive();}checkInSynchTimeForLive(){if(this.isDvr&&this.current.position+this.getInSyncTimeWindowWithHisteresis()>=this.duration){let t=this.duration-this.current.position;this.current.position=this.duration,this.current.time+=t;}}onPlaying(t){this.updateDurationOnEvent(t);}onPaused(t){this.updateState();}onStopped(t){this.updateState();}onComplete(t){this.updateState();}onBufferingStart(t){this.updateState();}onBufferingEnd(t){this.updateDurationOnEvent(t);}onSeekingStart(t){this.updateCurrentTimeFromEvent(t),this.updateState();}onSeekingEnd(t){this.updateState();}}q.__name__="bs.player.plugin.skin.model.core.PlaybackBaseModel",q.__super__=W,Object.assign(q.prototype,{__class__:q});class U extends q{constructor(t,e,s,i,n){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i,n);}_hx_constructor(t,e,s,i,n){let a=[],l=0;for(;l<3;)++l,a.push(0);this.eventTsRegistry=a,this.isDeviceControlActive=!1,this.isDeviceControlSupported=!1,this.isRendererInitialized=!1,this.wasUserMovingPointer=!1,this.isUserInteracting=!1,this.sphericalElement=null,this.skinElement=null,super._hx_constructor(t,e,s,i),this.skinElement=n,this.state=null,_.add(t,"rendererInitialized",$t(this,this.onRendererInitialized)),_.add(t,"deviceControlSupport",$t(this,this.onDeviceControlSupport)),this.refreshCallback(this.state);}destroy(){super.destroy(),_.remove(this.context,"rendererInitialized",$t(this,this.onRendererInitialized)),_.remove(this.context,"deviceControlSupport",$t(this,this.onDeviceControlSupport));}updateState(t){super.updateState(t);let e=this;this.state=this.isMediaSpherical&&this.isRendererInitialized?{move:{active:!this.isDeviceControlActive,up:function(t){null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault());let s=new _("move");s.data="U",s.dispatch(e.context);},down:function(t){null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault());let s=new _("move");s.data="D",s.dispatch(e.context);},left:function(t){null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault());let s=new _("move");s.data="L",s.dispatch(e.context);},right:function(t){null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault());let s=new _("move");s.data="R",s.dispatch(e.context);},center:function(t){null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault());let s=new _("move");s.data="C",s.dispatch(e.context);}},zoom:{active:!this.isDeviceControlActive,plus:function(t){null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault());let s=new _("zoom");s.data="P",s.dispatch(e.context);},minus:function(t){null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault());let s=new _("zoom");s.data="M",s.dispatch(e.context);},reset:function(t){null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault());let s=new _("zoom");s.data="R",s.dispatch(e.context);}},device:{supported:this.isDeviceControlSupported,active:this.isDeviceControlActive,click:$t(this,this.clickDeviceControl)},ctrl:$t(this,this.ctrl)}:null,this.refreshCallback(this.state);}ctrl(t){null!=t&&0!=this.isMediaSpherical?(this.sphericalElement=t,this.cachedTouchAction=this.sphericalElement.style.touchAction,this.sphericalElement.style.touchAction="none",this.sphericalElement.addEventListener("touchstart",$t(this,this.handleSphericalEvent),wt.get_passiveOptions()),this.sphericalElement.addEventListener("touchmove",$t(this,this.handleSphericalEvent),wt.get_passiveOptions()),this.sphericalElement.addEventListener("touchend",$t(this,this.handleSphericalEvent),wt.get_passiveOptions()),this.sphericalElement.addEventListener("mousedown",$t(this,this.handleSphericalEvent),wt.get_passiveOptions()),this.sphericalElement.addEventListener("mousemove",$t(this,this.handleSphericalEvent),wt.get_passiveOptions()),this.sphericalElement.addEventListener("mouseup",$t(this,this.handleSphericalEvent),wt.get_passiveOptions()),this.sphericalElement.addEventListener("wheel",$t(this,this.handleSphericalEvent)),this.sphericalElement.addEventListener("click",$t(this,this.handleSphericalEvent))):null!=this.sphericalElement&&(null!=this.cachedTouchAction&&(this.sphericalElement.style.touchAction=this.cachedTouchAction),this.cachedTouchAction=null,this.sphericalElement.removeEventListener("touchstart",$t(this,this.handleSphericalEvent)),this.sphericalElement.removeEventListener("touchmove",$t(this,this.handleSphericalEvent)),this.sphericalElement.removeEventListener("touchend",$t(this,this.handleSphericalEvent)),this.sphericalElement.removeEventListener("mousedown",$t(this,this.handleSphericalEvent)),this.sphericalElement.removeEventListener("mousemove",$t(this,this.handleSphericalEvent)),this.sphericalElement.removeEventListener("mouseup",$t(this,this.handleSphericalEvent)),this.sphericalElement.removeEventListener("wheel",$t(this,this.handleSphericalEvent)),this.sphericalElement.removeEventListener("click",$t(this,this.handleSphericalEvent)),this.sphericalElement=null);}handleSphericalEvent(t){if(null!=t&&0!=this.isMediaSpherical)switch(t.type){case"blur":case"mouseleave":case"mouseup":case"touchend":if(!this.isUserInteracting)return;if(this.eventAlreadyTriggered(2,t))return;g.enableHtmlSelection();let e=this.skinElement,s=$t(this,this.handleSphericalEvent);g.enableHtmlSelection(),window.document.removeEventListener("mouseup",s),window.document.removeEventListener("mousemove",s),window.document.removeEventListener("mouseleave",s),window.document.removeEventListener("blur",s),e.removeEventListener("mouseup",s),e.removeEventListener("mousemove",s),e.removeEventListener("blur",s),g.isMobile()&&(window.document.removeEventListener("touchend",s),e.removeEventListener("touchend",s)),new _("up").dispatch(this.context),this.isUserInteracting=!1;break;case"click":this.wasUserMovingPointer&&null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()),this.wasUserMovingPointer=!1;break;case"mousedown":case"touchstart":if(this.isUserInteracting)return;if(this.eventAlreadyTriggered(0,t))return;g.disableHtmlSelection();let i=this.skinElement,n=$t(this,this.handleSphericalEvent);g.disableHtmlSelection(),window.document.addEventListener("mouseup",n,wt.get_passiveOptions()),window.document.addEventListener("mousemove",n,wt.get_passiveOptions()),window.document.addEventListener("mouseleave",n,wt.get_passiveOptions()),window.document.addEventListener("blur",n,wt.get_passiveOptions()),i.addEventListener("mouseup",n,wt.get_passiveOptions()),i.addEventListener("mousemove",n,wt.get_passiveOptions()),i.addEventListener("blur",n,wt.get_passiveOptions()),g.isMobile()&&(window.document.addEventListener("touchend",n,wt.get_passiveOptions()),i.addEventListener("touchend",n,wt.get_passiveOptions()));let a=new _("down"),l=0;t instanceof MouseEvent&&(l=Ut.__cast(t,MouseEvent).clientX);let r=window;if(Object.prototype.hasOwnProperty.call(r,"TouchEvent")&&t instanceof TouchEvent){let e=t;if(e.touches.length>0){l=e.touches.item(0).clientX;}}let o=0;t instanceof MouseEvent&&(o=Ut.__cast(t,MouseEvent).clientY);let h=window;if(Object.prototype.hasOwnProperty.call(h,"TouchEvent")&&t instanceof TouchEvent){let e=t;if(e.touches.length>0){o=e.touches.item(0).clientY;}}a.data=new O(l,o),a.dispatch(this.context),this.wasUserMovingPointer=!1,this.isUserInteracting=!0;break;case"mousemove":case"touchmove":if(!this.isUserInteracting)return;if(this.eventAlreadyTriggered(1,t))return;let u=new _("drag"),c=0;t instanceof MouseEvent&&(c=Ut.__cast(t,MouseEvent).clientX);let d=window;if(Object.prototype.hasOwnProperty.call(d,"TouchEvent")&&t instanceof TouchEvent){let e=t;if(e.touches.length>0){c=e.touches.item(0).clientX;}}let p=0;t instanceof MouseEvent&&(p=Ut.__cast(t,MouseEvent).clientY);let m=window;if(Object.prototype.hasOwnProperty.call(m,"TouchEvent")&&t instanceof TouchEvent){let e=t;if(e.touches.length>0){p=e.touches.item(0).clientY;}}u.data=new O(c,p),u.dispatch(this.context),this.wasUserMovingPointer=!0;break;case"wheel":if(t instanceof WheelEvent){this.isInited&&(this.isPlaying||this.isPaused)&&null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault());let e=new _("zoom");e.data=t.deltaY,e.dispatch(this.context);}break;default:return}}eventAlreadyTriggered(t,e){let s=e.timeStamp;if(null==s&&(s=(new Date).getTime()),this.eventTsRegistry[t]==s)return !0;let i=0,n=this.eventTsRegistry.length;for(;i<n;){let e=i++;this.eventTsRegistry[e]=t==e?s:0;}return !1}clickDeviceControl(t){if(!this.isMediaSpherical||null==this.state)return;this.isDeviceControlActive=!this.isDeviceControlActive;let e=this.isDeviceControlActive;null!=this.state&&(null!=this.state.device&&(this.state.device.active=e),null!=this.state.move&&(this.state.move.active=this.state.zoom.active=!e)),this.refreshCallback(this.state);let s=new _("deviceControlActive");s.data=e,s.dispatch(this.context);}onRendererInitialized(t){this.isRendererInitialized!=t.data&&(this.isRendererInitialized=t.data);}onDeviceControlSupport(t){if(this.isDeviceControlSupported==t.data)return;this.isDeviceControlSupported=t.data,this.isDeviceControlActive=this.isDeviceControlSupported,null!=this.state&&null!=this.state.device&&(this.state.device.supported=this.isDeviceControlSupported);let e=this.isDeviceControlActive;null!=this.state&&(null!=this.state.device&&(this.state.device.active=e),null!=this.state.move&&(this.state.move.active=this.state.zoom.active=!e)),this.refreshCallback(this.state);let s=new _("deviceControlActive");s.data=e,s.dispatch(this.context);}}U.__name__="bs.player.plugin.skin.model.camera.CameraModel",U.__super__=q,Object.assign(U.prototype,{__class__:U});class H extends B{constructor(t,e,s,i){super(t,e,s,i);let n,a=Mt.syncWithHideUIElements(e,"videoCastButton","videoCastEnabled");if(Object.prototype.hasOwnProperty.call(a,"videoCastEnabled"))switch(o.field(a,"videoCastEnabled")){case 0:case"false":case!1:n=!1;break;default:n=!0;}else n=!0;this.enabled=n,this.state=null,this.enabled&&(p.add(t,"airplayAvailable",$t(this,this.onAirPlayAvailable)),p.add(t,"chromecastAvailable",$t(this,this.onChromecastAvailable)),y.add(t,"videoCastingStart",$t(this,this.onCastingStart)),y.add(t,"videoCastingEnd",$t(this,this.onCastingEnd))),this.refreshCallback(this.state);}destroy(){super.destroy(),this.enabled&&(p.remove(this.context,"airplayAvailable",$t(this,this.onAirPlayAvailable)),p.remove(this.context,"chromecastAvailable",$t(this,this.onChromecastAvailable)),y.remove(this.context,"videoCastingStart",$t(this,this.onCastingStart)),y.remove(this.context,"videoCastingEnd",$t(this,this.onCastingEnd)));}dispatchAirPlay(){new p("airplay").dispatch(this.context);}onAirPlayAvailable(t){this.airPlayAvailable=null!=t&&1==t.data,0!=this.enabled&&(0!=this.airPlayAvailable?(null==this.state&&(this.state={}),this.state.airplay={active:!1,click:$t(this,this.dispatchAirPlay)},this.refreshCallback(this.state)):null!=this.state&&Object.prototype.hasOwnProperty.call(this.state,"airplay")&&(o.deleteField(this.state,"airplay"),this.refreshCallback(this.state)));}dispatchChromecast(){new p("chromecast").dispatch(this.context);}onChromecastAvailable(t){this.chromecastPlayAvailable=null!=t&&1==t.data,0!=this.enabled&&(0!=this.chromecastPlayAvailable?(null==this.state&&(this.state={}),this.state.chromecast={active:!1,click:$t(this,this.dispatchChromecast)},this.refreshCallback(this.state)):null!=this.state&&Object.prototype.hasOwnProperty.call(this.state,"chromecast")&&(o.deleteField(this.state,"chromecast"),this.refreshCallback(this.state)));}onCastingStart(t){0!=this.enabled&&(null!=this.state.airplay&&(this.state.airplay.active=!0),null!=this.state.chromecast&&(this.state.chromecast.active=!0),this.refreshCallback(this.state));}onCastingEnd(t){0!=this.enabled&&(null!=this.state.airplay&&(this.state.airplay.active=!1),null!=this.state.chromecast&&(this.state.chromecast.active=!1),this.refreshCallback(this.state));}}H.__name__="bs.player.plugin.skin.model.casting.CastModel",H.__super__=B,Object.assign(H.prototype,{__class__:H});class $ extends B{constructor(t,e,s,i,n,a,l){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i,n,a,l);}_hx_constructor(t,e,s,i,n,a,l){this.contextmenuElement=null,this.skinElement=null,this.pos=new O(0,0),super._hx_constructor(t,e,s,i),this.skinElement=a;let r=this;this.templateCtx={prefix:n,version:l,clickViewPlayerInformation:function(t){null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()),r.hide(),null!=r.info&&r.info.open();},items:[]},this.info=new Q(t,e,n,l);this.info.renderTemplate=function(t){return r.renderTemplate(t)};let h;if(this.info.renderHtml=function(t,e){r.renderHtml(t,e);},b.add(t,"resize",$t(this,this.onResize)),Object.prototype.hasOwnProperty.call(e,"contextMenuDisabled"))switch(o.field(e,"contextMenuDisabled")){case 1:case"true":case!0:h=!0;break;default:h=!1;}else h=!1;1!=h&&(this.state={show:!1,ctrl:null},this.state.ctrl=$t(this,this.ctrl),this.skinElement.addEventListener("contextmenu",$t(this,this.onContextMenu)),this.refreshCallback(this.state),p.add(t,"playerInfoShow",$t(this,this.onPlayerInfoShow)),p.add(t,"playerInfoHide",$t(this,this.onPlayerInfoHide)));}set_prefix(t){return null!=this.templateCtx&&(this.templateCtx.prefix=t),null!=this.info&&this.info.set_prefix(t),t}renderTemplate(t){return null}renderHtml(t,e){}destroy(){super.destroy(),null!=this.skinElement&&this.skinElement.removeEventListener("contextmenu",$t(this,this.onContextMenu)),this.disconnectGlobalListeners(),b.remove(this.context,"resize",$t(this,this.onResize)),p.remove(this.context,"playerInfoShow",$t(this,this.onPlayerInfoShow)),p.remove(this.context,"playerInfoHide",$t(this,this.onPlayerInfoHide)),null!=this.info&&this.info.destroy();}ctrl(t){if(null==t)return this.disconnectGlobalListeners(),void(this.contextmenuElement=null);this.contextmenuElement=t,window.requestAnimationFrame($t(this,this.updatePosition)),null==this.template&&(this.template=this.renderTemplate('<ul class="${css(\'contextmenu-items\')}">\n\t\x3c!-- items --\x3e\n\t<if cond="${!!ctx.items && ctx.items.length > 0}">\n\t\t<for items="${ctx.items}">\n\t\t\t<li class="${css(\'contextmenu-item\')}">\n\t\t\t\t\x3c!-- button --\x3e\n\t\t\t\t<if cond="${!!item.click}">\n\t\t\t\t\t<button @click="${item.click}" type="button" class="${css(\'contextmenu-button\')}">\n\t\t\t\t\t\t<if cond="${!!item.html}">${asHtml(item.html)}</if>\n\t\t\t\t\t</button>\n\t\t\t\t</if>\n\t\t\t\t\x3c!-- link --\x3e\n\t\t\t\t<if cond="${!!item.link}">\n\t\t\t\t\t<a href="${item.link}" target="_blank" class="${css(\'contextmenu-link\')}">\n\t\t\t\t\t\t<if cond="${!!item.html}">${asHtml(item.html)}</if>\n\t\t\t\t\t</a>\n\t\t\t\t</if>\n\t\t\t\t\x3c!-- else --\x3e\n\t\t\t\t<if cond="${!item.click && !item.link}">\n\t\t\t\t\t<if cond="${!!item.html}">${asHtml(item.html)}</if>\n\t\t\t\t</if>\n\t\t\t</li>\n\t\t</for>\n\t</if>\n\t\x3c!-- info --\x3e\n\t<li class="${css(\'contextmenu-item\')}">\n\t\t<button @click="${ctx.clickViewPlayerInformation}" type="button" class="${css(\'contextmenu-button\')}">\n\t\t\t<span class="${css(\'txt-shdw\')}" style="align-items: center;">\n\t\t\t\t<svg width="16" height="16" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t<path fill="currentColor" d="M1216 1344v128q0 26-19 45t-45 19h-512q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h64v-384h-64q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h384q26 0 45 19t19 45v576h64q26 0 45 19t19 45zm-128-1152v192q0 26-19 45t-45 19h-256q-26 0-45-19t-19-45v-192q0-26 19-45t45-19h256q26 0 45 19t19 45z" />\n\t\t\t\t</svg>\n\t\t\t\t&nbsp;View player information\n\t\t\t</span>\n\t\t</button>\n\t</li>\n\t\x3c!-- powered by --\x3e\n\t<li class="${css(\'contextmenu-item\')}">\n\t\t<a href="https://bradmax.com" target="_blank" class="${css(\'contextmenu-link\')}">\n\t\t\t<small style="flex-direction:column;">\n\t\t\t\t<small class="${css(\'txt-shdw\')}" style="font-size: 9px;line-height: 10px;">powered by</small>\n\t\t\t\t<span style="align-items: center;">\n\t\t\t\t\t<svg width="22px" height="14px" viewBox="0 0 24 24">\n\t\t\t\t\t\t<path d="M5,1l0,21.721l15.739,-10.948l-15.648,-10.773l-0.091,0Z" style="fill:#fad600;fill-rule:nonzero;" />\n\t\t\t\t\t</svg>\n\t\t\t\t\t<span style="flex-direction:column;">\n\t\t\t\t\t\t<strong class="${css(\'txt-shdw\')}" style="font-size: 12px;line-height: 14px;">Bradmax Media Player</strong>\n\t\t\t\t\t\t<small class="${css(\'txt-shdw\')}" style="font-size: 9px;line-height: 9px;">${ctx.version}</small>\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t</small>\n\t\t</a>\n\t</li>\n</ul>\n')),this.renderHtml(this.contextmenuElement,this.template(this.templateCtx)),this.connectGlobalListeners();}onResize(t){this.updatePosition(),null!=this.info&&this.info.resize(t);}onPlayerInfoShow(t){null!=this.info&&this.info.open();}onPlayerInfoHide(t){null!=this.info&&this.info.close();}onContextMenu(t){null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()),this.storePosition(t),this.show();}storePosition(t){this.pos.x=t.pageX,this.pos.y=t.pageY;}updatePosition(){if(null==this.contextmenuElement)return;let t=this.contextmenuElement.offsetWidth+4,e=this.contextmenuElement.offsetHeight+4,s=null;s=this.skinElement.getBoundingClientRect();let i=s,n=window.document.documentElement.scrollLeft,a=window.document.documentElement.scrollTop,l=this.pos.x-(i.x+n),r=this.pos.y-(i.y+a);i.width-l<t?this.contextmenuElement.style.left=i.width-t+"px":this.contextmenuElement.style.left=l+"px",i.height-r<e?this.contextmenuElement.style.top=i.height-e+"px":this.contextmenuElement.style.top=r+"px";}show(){1!=this.state.show?(this.state.show=!0,this.refreshCallback(this.state)):this.updatePosition();}hide(){0!=this.state.show&&(this.state.show=!1,this.refreshCallback(this.state));}connectGlobalListeners(){window.document.addEventListener("click",$t(this,this.onDocumentClick)),window.addEventListener("keyup",$t(this,this.onWindowKeyUp));}disconnectGlobalListeners(){window.document.removeEventListener("click",$t(this,this.onDocumentClick)),window.removeEventListener("keyup",$t(this,this.onWindowKeyUp));}onDocumentClick(t){this.hide();}onWindowKeyUp(t){27==t.keyCode&&this.hide();}}$.__name__="bs.player.plugin.skin.model.contextmenu.ContextMenuModel",$.__super__=B,Object.assign($.prototype,{__class__:$});class G{constructor(t,e){G._hx_skip_constructor||this._hx_constructor(t,e);}_hx_constructor(t,e){this.barWidth=null,this.canvas=null,this.canvas2d=null,this.index=0,this.colors=null,this.datum=null,this.width=300,this.height=11,this.colors=t,null!=e&&(this.datum=e),this.barWidth=Math.round(this.width/150);}destroy(){this.index=0,this.canvas2d=null,this.canvas=null;}ctrl(t){if(null==t)return void this.destroy();this.canvas2d=t.getContext("2d");let e=Math.round(150*this.barWidth);if(t.width=e,t.style.width=e+"px",null==this.canvas2d)return;let s=1<window.devicePixelRatio?2:1;t.height=this.height*s,t.style.height=this.height+"px",this.canvas2d.scale(1,s);}render(t){if(null==this.canvas2d)return;let e=0,s=0,i=0,n=0,a=this.datum.length,l=0;for(;l<a;){let a=(l+=2)-2;if(a==this.datum.length-1)break;if(!("number"==typeof this.datum[a+1]==0||"number"==typeof t==0||parseFloat(""+h.string(this.datum[a+1]))<parseFloat(""+h.string(t)))){if(e=parseFloat(""+h.string(t)),s=parseFloat(""+h.string(this.datum[a])),i=parseFloat(""+h.string(this.datum[a+1])),n=Math.min(1,(e-s)/(i-s)),isNaN(n))break;this.canvas2d.fillStyle=""+this.colors[a],this.canvas2d.fillRect(this.index*this.barWidth,0,this.barWidth,this.height),this.canvas2d.fillStyle=""+this.colors[a+1],this.canvas2d.fillRect(this.index*this.barWidth,this.height*(1-n),this.barWidth,this.height),this.index=(this.index+1)%150;break}}this.canvas2d.clearRect(this.index*this.barWidth,0,this.barWidth,this.height);}}G.__name__="bs.player.plugin.skin.model.contextmenu.info.PlayerInfoChart",Object.assign(G.prototype,{__class__:G});class X extends G{constructor(t){G._hx_skip_constructor=!0,super(),G._hx_skip_constructor=!1,this._hx_constructor(t);}_hx_constructor(t){this.offset=0,this.duration=0,super._hx_constructor(t);}ctrl(t){super.ctrl(t),null!=this.canvas2d&&(this.canvas2d.fillStyle=""+this.colors[0],this.canvas2d.strokeStyle=""+this.colors[1]);}render(t){if(null==this.canvas2d)return;let e,s,i;t.duration!=this.duration&&(this.offset=this.width/t.duration,this.duration=t.duration),this.canvas2d.clearRect(0,0,this.width,this.height);let n=0,a=t.buffered.length;for(;n<a;){let a=n++;e=t.buffered.start(a)*this.offset,s=t.buffered.end(a)*this.offset,i=s-e,this.canvas2d.fillRect(e,0,i,this.height),this.canvas2d.rect(e,0,i,this.height),this.canvas2d.stroke();}}}X.__name__="bs.player.plugin.skin.model.contextmenu.info.PlayerInfoBufferChart",X.__super__=G,Object.assign(X.prototype,{__class__:X});class Q{constructor(t,e,s,i){this.lastDecodedByteCount=0,this.lastDecodedFrames=0,this.lastDecodedFrameTime=0,this.framesPerSecond=0,this.networkActivityBytes=0,this.playerHeight=0,this.playerWidth=0,this.videoElement=null,this.hasNetworkActivitySamples=!1,this.networkActivitySamples=new qt,this.bandwidthSteps=[0,18750,37500,81250,128e3,256e3,512e3,1024e3,2048e3,4096e3,8192e3,16384e3,32768e3,65536e3,131072e3],this.bandwidthColors=["#000000","#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#2ca02c","#3288bd","#1f77b4","#124588","#9467bd","#8c564b","#ffffff"].slice(0),this.timeOrigin=window.performance.timeOrigin,this.templateCtx={prefix:null,size:{h:0,w:0},version:null,panels:[{title:"Video",id:"video",list:[{defaultValue:0,id:"creationTime",label:"creation time",value:null},{defaultValue:"not available",id:"videoSize",unit:"px",label:"video size",value:null},{defaultValue:"not available",id:"videoFrames",label:"frames",value:null},{chart:null,defaultValue:null,id:"framesPerSecond",unit:"fps",label:"frames per seconds",value:null},{chart:null,defaultValue:null,id:"currentTotalBitrateKpbs",unit:"Kpbs",label:"current total bitrate",value:null},{chart:null,defaultValue:null,id:"networkActivityBytes",unit:"KB",label:"network activity",value:null},{chart:null,defaultValue:0,id:"bufferLength",unit:"s",label:"buffer length",value:null},{chart:null,defaultValue:0,id:"buffer",label:"buffer:",value:null}]},{title:"Media",id:"media",list:[{defaultValue:null,id:"id",label:"id",value:null},{defaultValue:"not available",id:"title",label:"title",value:null},{defaultValue:"not available",id:"duration",unit:"s",label:"duration",value:null},{defaultValue:!1,id:"hasConcurrencyControl",label:"concurrency control",value:null},{defaultValue:!1,id:"isDvr",label:"dvr",value:null},{defaultValue:!1,id:"isLiveStream",label:"live",value:null},{defaultValue:!1,id:"spherical",label:"spherical",value:null},{defaultValue:null,id:"source",label:"source count",value:null},{defaultValue:null,id:"sourceFallbacks",label:"source fallbacks count",value:null},{defaultValue:null,id:"subtitlesSets",label:"subtitles sets count",value:null},{defaultValue:null,id:"audioSets",label:"audio sets count",value:null},{defaultValue:null,id:"splashImages",label:"splash images count",value:null},{defaultValue:null,id:"posterImages",label:"poster images count",value:null},{defaultValue:null,id:"mediaPlaylist",label:"playlist items count",value:null},{defaultValue:null,id:"mediaLandingPage",label:"landing page",value:null}]},{title:"Player",id:"player",list:[{defaultValue:"not available",id:"version",label:"Bradmax Media Player",value:null},{defaultValue:"not available",id:"playerSize",unit:"px",label:"player size",value:null}]},{title:"Configuration",id:"config",list:[{defaultValue:!1,id:"autoplay",label:"autoplay",value:null},{defaultValue:!1,id:"mute",label:"mute",value:null},{defaultValue:null,id:"volume",label:"volume",value:null},{defaultValue:null,id:"startTime",label:"startTime",value:null},{defaultValue:null,id:"qualitySelectionEnabled",label:"quality selection enabled",value:null},{defaultValue:null,id:"qualityLabelType",label:"qualityLabelType",value:null},{defaultValue:null,id:"qualityInitialBandwidthKbs",label:"quality initial bandwidth",value:null},{defaultValue:!0,id:"showSkinOnInit",label:"show skin on init",value:null},{defaultValue:null,id:"endSplash",label:"end splash",value:null},{defaultValue:null,id:"subtitles",label:"subtitles",value:null},{defaultValue:null,id:"audio",label:"audio",value:null},{defaultValue:null,id:"locale",label:"locale",value:null},{defaultValue:null,id:"dvrWindowStartTime",label:"dvr window start time",value:null},{defaultValue:null,id:"dvrWindowEndTime",label:"dvr window end time",value:null},{defaultValue:null,id:"dvrMinLenForSeekbar",label:"dvr minimum length for seekbar",value:null},{defaultValue:!1,id:"isDvrWallTimeMode",label:"dvr wall time",value:null},{defaultValue:!1,id:"iosInlineVideo",label:"ios inline video",value:null},{defaultValue:!1,id:"gdprAgreeRequired",label:"gdpr agree required",value:null},{defaultValue:!1,id:"gdprAgreeForCookie",label:"gdpr agree for cookie",value:null},{defaultValue:null,id:"logoFile",label:"logo",value:null},{defaultValue:null,id:"logoLink",label:"logo link",value:null},{defaultValue:null,id:"logoPosition",label:"logo position",value:null},{defaultValue:null,id:"logoAutohide",label:"logo autohide",value:null},{defaultValue:null,id:"logoVisibleDuringAdPlayback",label:"logo visible during ad playback",value:null},{defaultValue:null,id:"skinColor",label:"skin color",value:null},{defaultValue:!1,id:"fullscreenEnabled",label:"fullscreen enabled",value:null},{defaultValue:!1,id:"pictureInPictureButtonVisible",label:"picture in picture skin button visibility",value:null},{defaultValue:!1,id:"videoCastEnabled",label:"video casting enabled",value:null}]},{title:"Device",id:"device",list:[{defaultValue:"not available",id:"useragent",label:"user agent",value:null},{defaultValue:"not available",id:"screenSize",unit:"px",label:"screen size",value:null},{defaultValue:!1,id:"isMobile",label:"mobile",value:null},{defaultValue:!1,id:"isSmartTV",label:"smart TV",value:null},{defaultValue:"not available",id:"browserName",label:"browser name",value:null},{defaultValue:!1,id:"isBrowserOnline",label:"online",value:null},{defaultValue:!1,id:"isWebGLAvailable",label:"WebGL",value:null},{defaultValue:!1,id:"isWebGL2Available",label:"WebGL2",value:null},{defaultValue:!1,id:"isDeviceOrientationSupported",label:"device orientation",value:null},{defaultValue:"not available",id:"orientation",unit:"",label:"orientation",value:null}]}]},this.context=t,null!=s&&this.set_prefix(s),this.templateCtx.version=i,this.initCtx(e),m.add(t,"mediaMetadataData",$t(this,this.onDataProviderEvent)),m.add(t,"movieData",$t(this,this.onDataProviderEvent)),y.add(t,"videoMediaElementInit",$t(this,this.onVideoElementEvent)),y.add(t,"networkActivityUrl",$t(this,this.onVideoNetworkActivity));}renderTemplate(t){return null}renderHtml(t,e){}set_prefix(t){return null!=this.templateCtx&&(this.templateCtx.prefix=t),t}destroy(){m.remove(this.context,"mediaMetadataData",$t(this,this.onDataProviderEvent)),m.remove(this.context,"movieData",$t(this,this.onDataProviderEvent)),y.remove(this.context,"videoMediaElementInit",$t(this,this.onVideoElementEvent)),y.remove(this.context,"networkActivityUrl",$t(this,this.onVideoNetworkActivity)),this.destroyCharts();}open(){let t=new f("showMessage");t.data={type:"normal",title:"Player information",text:'<div id="'+this.context+'-info-view" style="flex-direction: column;"></div>',onAfterShow:$t(this,this.afterShow),close:!0,onAfterClose:$t(this,this.afterClose),style:{window:{minWidth:"380px",width:"380px",maxWidth:"380px",backgroundColor:"#000",pointerEvents:"all"},overlay:{height:"90%",background:"none",backdropFilter:"none",pointerEvents:"none"}}},t.dispatch(this.context);}close(){new f("closeMessage").dispatch(this.context);}resize(t){this.playerWidth=t.data.width,this.playerHeight=t.data.height;let e=0,s=this.templateCtx.panels;for(;e<s.length;){let t=s[e];++e,"player"==t.id&&this.updatePlayerCtx(t.list);}}afterShow(){let t=window.document.getElementById(this.context+"-info-view");m.add(this.context,"mediaMetadataData",$t(this,this.onNewDataProviderEvent)),m.add(this.context,"mediaAfterPlaybackStartMetadata",$t(this,this.onDataProviderEvent)),y.add(this.context,"currentTimeChange",$t(this,this.onVideoEvent)),null!=t&&(this.templateCtx.size.w=t.clientWidth,this.templateCtx.size.h=t.clientHeight),null==this.template&&(this.template=this.renderTemplate("${ctx.panels.map((panel, panelIndex) => html`\n<div class=\"${css('message-info-con')}\">\n\t<h4 class=\"${css('message-info-title')}\">${panel.title}:</h4>\n\t<div class=\"${css('message-info-list')}\">\n\t\t${panel.list.map((item, itemIndex) => item.value != item.defaultValue\n\t\t? html`\n\t\t<div class=\"${css('message-info-item')}\">\n\t\t\t<small class=\"${css('message-info-item-label')}\">${item.label}</small>\n\t\t\t<small class=\"${css('message-info-item-value')}\">\n\t\t\t\t${item.value != null ? html`<strong>${item.value}</strong>${item.unit ? html`<small class=\"${css('message-info-item-unit')}\">&nbsp;${item.unit}</small>` : nothing}` : html`<i>${item.defaultValue}</i>`}\n\t\t\t</small>\n\t\t</div>${item.chart ? html`<canvas ${ctrl(item.chart)} class=\"${css('message-info-item-chart')}\"></canvas>` : nothing}`\n\t\t: nothing\n\t\t)}\n\t</div>\n</div>`)}\n"));let e=this,s=function(){e.countNetworkActivityBytes(),e.updateCtx(),e.renderHtml(t,e.template(e.templateCtx));};null==this.renderTimer&&(this.renderTimer=new Ft(250)),this.renderTimer.run=s,s();}afterClose(){m.remove(this.context,"mediaMetadataData",$t(this,this.onNewDataProviderEvent)),m.remove(this.context,"mediaAfterPlaybackStartMetadata",$t(this,this.onDataProviderEvent)),y.remove(this.context,"currentTimeChange",$t(this,this.onVideoEvent)),null!=this.renderTimer&&this.renderTimer.stop(),this.renderTimer=null;}onVideoElementEvent(t){this.videoElement=t.data;}onVideoEvent(t){null!=t&&null!=t.data&&null!=t.data.media&&(this.media=t.data.media);}onVideoNetworkActivity(t){this.hasNetworkActivitySamples=!0,this.networkActivitySamples.h[t.data.url]=t.data.loaded;}onNewDataProviderEvent(t){this.networkActivitySamples.h=Object.create(null),null!=t&&null!=t.data&&(this.media=t.data);}onDataProviderEvent(t){null!=t&&null!=t.data&&(this.media=t.data);}initCtx(t){let e=0,s=this.templateCtx.panels;for(;e<s.length;){let i=s[e];switch(++e,i.id){case"config":this.updateConfigCtx(i.list,t);break;case"device":this.updateDeviceCtx(i.list);break;case"player":this.updatePlayerCtx(i.list);break;default:continue}}}updateCtx(){let t=0,e=this.templateCtx.panels;for(;t<e.length;){let s=e[t];switch(++t,s.id){case"media":this.updateMediaCtx(s.list,this.media);break;case"video":this.updateVideoCtx(s.list,this.media);break;default:continue}}}updatePlayerCtx(t){let e=0;for(;e<t.length;){let s=t[e];switch(++e,s.id){case"playerSize":s.value=this.playerWidth+" x "+this.playerHeight;break;case"version":s.value=this.templateCtx.version;break;default:continue}}this.resolvePlugins(t,exports.bs.player.plugin);}updateConfigCtx(t,e){let s=null;Object.prototype.hasOwnProperty.call(e,"logoFile")&&(s=o.field(e,"logoFile"));let i=null!=s,n=0;for(;n<t.length;){let s=t[n];switch(++n,s.id){case"audio":s.value=Mt.audio(e);break;case"autoplay":let t;if(Object.prototype.hasOwnProperty.call(e,"autoplay"))switch(o.field(e,"autoplay")){case 1:case"true":case!0:t=!0;break;default:t=!1;}else t=!1;s.value=t;break;case"dvrMinLenForSeekbar":let n=null;Object.prototype.hasOwnProperty.call(e,"dvrMinLenForSeekbar")&&(n=parseFloat(o.field(e,"dvrMinLenForSeekbar")),isNaN(n)&&(n=null)),s.value=n;break;case"dvrWindowEndTime":let a=null;Object.prototype.hasOwnProperty.call(e,"dvrWindowEndTime")&&(a=parseFloat(o.field(e,"dvrWindowEndTime")),isNaN(a)&&(a=null)),s.value=a;break;case"dvrWindowStartTime":let l=null;Object.prototype.hasOwnProperty.call(e,"dvrWindowStartTime")&&(l=parseFloat(o.field(e,"dvrWindowStartTime")),isNaN(l)&&(l=null)),s.value=l;break;case"endSplash":let r=null;Object.prototype.hasOwnProperty.call(e,"endSplash")&&(r=o.field(e,"endSplash")),s.value=r;break;case"fullscreenEnabled":s.value=Mt.fullscreenEnabled(e);break;case"gdprAgreeForCookie":let h;if(Object.prototype.hasOwnProperty.call(e,"gdprAgreeForCookie"))switch(o.field(e,"gdprAgreeForCookie")){case 1:case"true":case!0:h=!0;break;default:h=!1;}else h=!1;s.value=h;break;case"gdprAgreeRequired":let u;if(Object.prototype.hasOwnProperty.call(e,"gdprAgreeRequired"))switch(o.field(e,"gdprAgreeRequired")){case 1:case"true":case!0:u=!0;break;default:u=!1;}else u=!1;s.value=u;break;case"iosInlineVideo":let c;if(Object.prototype.hasOwnProperty.call(e,"iosInlineVideo"))switch(o.field(e,"iosInlineVideo")){case 1:case"true":case!0:c=!0;break;default:c=!1;}else c=!1;s.value=c;break;case"isDvrWallTimeMode":let d;if(Object.prototype.hasOwnProperty.call(e,"isDvrWallTimeMode"))switch(o.field(e,"isDvrWallTimeMode")){case 1:case"true":case!0:d=!0;break;default:d=!1;}else d=!1;s.value=d;break;case"locale":s.value=Object.prototype.hasOwnProperty.call(e,"locale")?o.field(e,"locale"):null;break;case"logoAutohide":if(i){let t;if(Object.prototype.hasOwnProperty.call(e,"logoAutohide"))switch(o.field(e,"logoAutohide")){case 0:case"false":case!1:t=!1;break;default:t=!0;}else t=!0;s.value=t;}break;case"logoFile":if(i){let t=null;Object.prototype.hasOwnProperty.call(e,"logoFile")&&(t=o.field(e,"logoFile")),s.value=t;}break;case"logoLink":if(i){let t=null;Object.prototype.hasOwnProperty.call(e,"logoLink")&&(t=o.field(e,"logoLink")),s.value=t;}break;case"logoPosition":if(i){let t;if(Object.prototype.hasOwnProperty.call(e,"logoXPosition"))switch(o.field(e,"logoXPosition")){case"left":default:t="left";break;case"right":t="right";}else t="left";let i,n=t+" / ";if(Object.prototype.hasOwnProperty.call(e,"logoYPosition"))if("bottom"===o.field(e,"logoYPosition"))i="bottom";else i="top";else i="top";s.value=n+i;}break;case"logoVisibleDuringAdPlayback":if(i){let t;if(Object.prototype.hasOwnProperty.call(e,"logoVisibleDuringAdPlayback"))switch(o.field(e,"logoVisibleDuringAdPlayback")){case 1:case"true":case!0:t=!0;break;default:t=!1;}else t=!1;s.value=t;}break;case"mute":s.value=Mt.mute(e);break;case"pictureInPictureButtonVisible":if(Object.prototype.hasOwnProperty.call(e,"pictureInPictureEnabled"))switch(o.field(e,"pictureInPictureEnabled")){case 0:case"false":case!1:e.pictureInPictureButtonVisible=!1;break;default:e.pictureInPictureButtonVisible=!0;}let p,m=Mt.syncWithHideUIElements(e,"pictureInPicture","pictureInPictureButtonVisible");if(Object.prototype.hasOwnProperty.call(m,"pictureInPictureButtonVisible"))switch(o.field(m,"pictureInPictureButtonVisible")){case 0:case"false":case!1:p=!1;break;default:p=!0;}else p=!0;s.value=p;break;case"qualityInitialBandwidthKbs":let f=null;Object.prototype.hasOwnProperty.call(e,"qualityInitialBandwidthKbs")&&(f=parseFloat(o.field(e,"qualityInitialBandwidthKbs")),isNaN(f)&&(f=null)),s.value=f;break;case"qualityLabelType":s.value=Object.prototype.hasOwnProperty.call(e,"qualityLabelType")?o.field(e,"qualityLabelType"):null;break;case"qualitySelectionEnabled":let g,v=Mt.syncWithHideUIElements(e,"qualitySelection","qualitySelectionEnabled");if(Object.prototype.hasOwnProperty.call(v,"qualitySelectionEnabled"))switch(o.field(v,"qualitySelectionEnabled")){case 0:case"false":case!1:g=!1;break;default:g=!0;}else g=!0;s.value=g;break;case"showSkinOnInit":let b;if(Object.prototype.hasOwnProperty.call(e,"showSkinOnInit"))switch(o.field(e,"showSkinOnInit")){case 0:case"false":case!1:b=!1;break;default:b=!0;}else b=!0;s.value=b;break;case"skinColor":s.value=Object.prototype.hasOwnProperty.call(e,"skinColor")?o.field(e,"skinColor"):null;break;case"startTime":let _=null;Object.prototype.hasOwnProperty.call(e,"startTime")&&(_=parseFloat(o.field(e,"startTime")),isNaN(_)&&(_=null)),s.value=_;break;case"subtitles":s.value=Mt.subtitles(e);break;case"videoCastEnabled":let y,k=Mt.syncWithHideUIElements(e,"videoCastButton","videoCastEnabled");if(Object.prototype.hasOwnProperty.call(k,"videoCastEnabled"))switch(o.field(k,"videoCastEnabled")){case 0:case"false":case!1:y=!1;break;default:y=!0;}else y=!0;s.value=y;break;case"volume":s.value=Mt.volume(e);break;default:continue}}}updateDeviceCtx(t){let e=0;for(;e<t.length;){let s=t[e];switch(++e,s.id){case"browserName":s.value=g.browserName;break;case"isBrowserOnline":s.value=g.isBrowserOnline();break;case"isDeviceOrientationSupported":s.value=g.isDeviceOrientationSupported();break;case"isMobile":s.value=g.isMobile();break;case"isSmartTV":s.value=g.isSmartTV();break;case"isWebGL2Available":s.value=g.isWebGL2Available();break;case"isWebGLAvailable":s.value=g.isWebGLAvailable();break;case"orientation":s.value=g.getOrientation();break;case"screenSize":let t=g.getScreenSize();s.value=t.width+" x "+t.height;break;case"useragent":s.value=g.getUserAgent();break;default:continue}}}updateMediaCtx(t,e){let s=!1,i=!1;e instanceof T?(s=!1,i=!1):e instanceof x?(s=!0,i=e instanceof S):(s=!1,i=!1);let n=0;for(;n<t.length;){let a=t[n];switch(++n,a.id){case"audioSets":null!=e.audioSets&&e.audioSets.length>0&&(a.value=e.audioSets.length);break;case"duration":a.value=e.duration;break;case"hasConcurrencyControl":a.value=e.mediaSettings.hasConcurrencyControl;break;case"id":a.value=e.id;break;case"isDvr":a.value=s;break;case"isLiveStream":a.value=i;break;case"mediaLandingPage":null!=e.mediaLandingPage&&(a.value=e.mediaLandingPage);break;case"mediaPlaylist":null!=e.mediaPlaylist&&e.mediaPlaylist.get_length()>0&&(a.value=e.mediaPlaylist.get_length());break;case"posterImages":null!=e.posterImages&&e.posterImages.length>0&&(a.value=e.posterImages.length);break;case"source":null!=e.source&&e.source.length>0&&(a.value=e.source.length);break;case"sourceFallbacks":null!=e.sourceFallbacks&&e.sourceFallbacks.length>0&&(a.value=e.sourceFallbacks.length);break;case"spherical":a.value=e.spherical;break;case"splashImages":null!=e.splashImages&&e.splashImages.length>0&&(a.value=e.splashImages.length);break;case"subtitlesSets":null!=e.subtitlesSets&&e.subtitlesSets.length>0&&(a.value=e.subtitlesSets.length);break;case"title":a.value=e.title;break;default:continue}}}updateVideoCtx(t,e){if(null==this.videoElement)return;let i=this.videoElement.getVideoPlaybackQuality(),n=e.mediaPlaybackInfo.currentTime,a=this.videoElement.buffered,r=this.getBufferLength(a,n);null!=i&&(e.mediaPlaybackInfo.isPlaying?this.countFps(i.totalVideoFrames):this.framesPerSecond=0);let o=0;for(;o<t.length;){let h=t[o];switch(++o,h.id){case"buffer":h.value=a.length,null==h.chart&&(null==this.bufferChart&&(this.bufferChart=new X(["#2ca02c","#e6f598"].slice(0))),h.chart=$t(s=this.bufferChart,s.ctrl)),this.bufferChart.render({duration:e.duration,buffered:a});break;case"bufferLength":h.value=0==r?"0":r.toFixed(2),null==h.chart&&(null==this.bufferLengthChart&&(this.bufferLengthChart=new G(["#000000","#fdae61","#e6f598","#66c2a5","#3288bd","#ffffff"].slice(0),[0,15,30,60,90,120].slice(0))),h.chart=$t(s=this.bufferLengthChart,s.ctrl)),this.bufferLengthChart.render(r);break;case"creationTime":null!=i&&(h.value=l.dateStr(new Date(this.timeOrigin+i.creationTime)));break;case"currentTime":h.value=n;break;case"currentTotalBitrateKpbs":let t=e.mediaPlaybackInfo.currentTotalBitrateKpbs;null==t&&(t=this.tryToCountBitrate()),h.value=t,null==h.chart&&(null==this.currentTotalBitrateKpbsChart&&(this.currentTotalBitrateKpbsChart=new G(this.bandwidthColors,this.bandwidthSteps.slice(0))),h.chart=$t(s=this.currentTotalBitrateKpbsChart,s.ctrl)),this.currentTotalBitrateKpbsChart.render(1e3*t);break;case"framesPerSecond":h.value=this.framesPerSecond,null==h.chart&&(null==this.framesPerSecondChart&&(this.framesPerSecondChart=new G(["#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5"].slice(0),[0,12,18,24,32,48,60].slice(0))),h.chart=$t(s=this.framesPerSecondChart,s.ctrl)),this.framesPerSecondChart.render(this.framesPerSecond);break;case"networkActivityBytes":if(0==this.hasNetworkActivitySamples)continue;if(h.value=Math.round(this.networkActivityBytes/1e3),null==h.chart){if(null==this.networkActivityChart){let t=this.bandwidthColors,e=this.bandwidthSteps,s=new Array(e.length),i=0,n=e.length;for(;i<n;){let t=i++;s[t]=e[t]/4;}this.networkActivityChart=new G(t,s.slice(0));}h.chart=$t(s=this.networkActivityChart,s.ctrl);}this.networkActivityChart.render(8*this.networkActivityBytes/1e3);break;case"videoFrames":null!=i&&(h.value=i.droppedVideoFrames+" dropped of "+i.totalVideoFrames);break;case"videoSize":h.value=this.videoElement.videoWidth+" x "+this.videoElement.videoHeight;break;default:continue}}}destroyCharts(){null!=this.currentTotalBitrateKpbsChart&&this.currentTotalBitrateKpbsChart.destroy(),null!=this.bufferLengthChart&&this.bufferLengthChart.destroy(),null!=this.networkActivityChart&&this.networkActivityChart.destroy(),null!=this.framesPerSecondChart&&this.framesPerSecondChart.destroy(),null!=this.bufferChart&&this.bufferChart.destroy();}getBufferLength(t,e){let s=0,i=t.length;for(;s<i;){let i=s++,n=t.start(i),a=t.end(i);if(n<=e&&e<a)return a-e}return 0}countNetworkActivityBytes(){this.networkActivityBytes=0;let t=this.networkActivitySamples.h,e=Object.keys(t),s=e.length,i=0;for(;i<s;)this.networkActivityBytes+=t[e[i++]];this.networkActivitySamples.h=Object.create(null);}countFps(t){let e=t-this.lastDecodedFrames;if(0!=e){let s=window.performance.now();this.framesPerSecond=Math.round(e/(s-this.lastDecodedFrameTime)*1e3),this.lastDecodedFrames=t,this.lastDecodedFrameTime=s;}}tryToCountBitrate(){if("webkitVideoDecodedByteCount"in this.videoElement){let t=parseFloat(this.videoElement.webkitVideoDecodedByteCount),e=(t-this.lastDecodedByteCount)/1e3*8;return this.lastDecodedByteCount=t,Math.round(e)}return null}resolvePlugins(t,e){if(0==o.isObject(e))return;let s=e.__name__;if(null!=s){let i,n,a=s.split(".").pop(),l=e;if(0==o.isObject(l))n=!1;else {let t=Object.prototype.hasOwnProperty.call(l,"__plugfaces__")?o.field(l,"__plugfaces__"):null;n=null!=t&&t.indexOf("IVideoPlayer")>-1;}if(n)i=!0;else {let t=e;if(0==o.isObject(t))i=!1;else {let e=Object.prototype.hasOwnProperty.call(t,"__plugfaces__")?o.field(t,"__plugfaces__"):null;i=null!=e&&e.indexOf("IPlugin")>-1;}}if(i){let e=[],i=0,n=t;for(;i<n.length;){let t=n[i];++i,t.id==s&&e.push(t);}return void(0==e.length&&t.push({id:s,label:""+a,value:"active"}))}}else {let s=0,i=o.fields(e);for(;s<i.length;)this.resolvePlugins(t,o.field(e,i[s++]));}}}Q.__name__="bs.player.plugin.skin.model.contextmenu.info.PlayerInfoMessage",Object.assign(Q.prototype,{__class__:Q});class K extends B{constructor(t,e,s,i,n,a){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i,n,a);}_hx_constructor(t,e,s,i,n,a){this.cssPrefix=null,super._hx_constructor(t,e,s,i);let l=g.isMobile(),r=g.isSmartTV();this.state={browserName:g.browserName.toLowerCase(),desktop:0==l&&0==r,mobile:l,ios:1==g.isiOS,tv:r,tizen:g.isSamsungSmartTVTizen,webview:g.isWebView(),css:null},this.element=a,this.set_prefix(n);}set_prefix(t){if(this.cssPrefix=t,null!=this.element&&null!=this.cssPrefix&&""!=this.cssPrefix){let t=this.toStringArray();this.state.css=t.join(" ");let e=0;for(;e<t.length;)this.element.classList.add(t[e++]);this.refreshCallback(this.state);}return this.cssPrefix}toStringArray(){let t=[this.cssPrefix+"-"+this.state.browserName],e=0,s=o.fields(this.state);for(;e<s.length;){let i=s[e];++e;let n=o.field(this.state,i);"boolean"==typeof n&&1==n&&t.push(this.cssPrefix+"-"+i);}return t}}K.__name__="bs.player.plugin.skin.model.device.DeviceModel",K.__super__=B,Object.assign(K.prototype,{__class__:K});class Y extends B{constructor(t,e,s,i,n){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i,n);}_hx_constructor(t,e,s,i,n){let a;if(this.active=!1,super._hx_constructor(t,e,s,i),this.element=n,this.enabled=Mt.fullscreenEnabled(e),Object.prototype.hasOwnProperty.call(e,"fullscreenOrientationLock"))switch(o.field(e,"fullscreenOrientationLock")){case"any":a="any";break;case"landscape":a="landscape";break;case"landscape-primary":a="landscape-primary";break;case"landscape-secondary":a="landscape-secondary";break;case"natural":a="natural";break;case"portrait":a="portrait";break;case"portrait-primary":a="portrait-primary";break;case"portrait-secondary":a="portrait-secondary";break;default:a=null;}else a=null;this.fullscreenOrientationLock=a,this.enabled&&(g.isiOS?(y.add(t,"videoMediaElementInit",$t(this,this.oniOSVideoMediaElementInit)),y.add(t,"playing",$t(this,this.oniOSPlaying)),y.add(t,"complete",$t(this,this.oniOSComplete))):this.enabled&&this.activate());}destroy(){this.enabled&&(this.deactivate(),g.isiOS&&(y.remove(this.context,"videoMediaElementInit",$t(this,this.oniOSVideoMediaElementInit)),y.remove(this.context,"playing",$t(this,this.oniOSPlaying)),y.remove(this.context,"complete",$t(this,this.oniOSComplete)))),super.destroy();}activate(){0!=this.enabled&&1!=this.active&&(this.active=!0,this.state={active:xt.isFullscreen(this.videoElement),toggle:$t(this,this.toggle)},p.add(this.context,"fullscreen",$t(this,this.onFullscreen)),this.refreshCallback(this.state));}deactivate(){0!=this.active&&(this.active=!1,this.state=null,p.remove(this.context,"fullscreen",$t(this,this.onFullscreen)),this.refreshCallback(this.state));}toggle(t){0!=this.enabled&&(null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()),xt.toggle(this.element,this.videoElement,$t(this,this.toggled)),new p("fullscreen").dispatch(this.context));}toggled(t){if(0==this.enabled)return;let e=xt.isFullscreen(this.videoElement);null!=this.fullscreenOrientationLock&&(e?Pt.lock(this.fullscreenOrientationLock):Pt.unlock()),this.state.active!=e&&(this.state.active=e,this.refreshCallback(this.state));}onFullscreen(t){0!=this.enabled&&(this.state.active=!this.state.active,this.refreshCallback(this.state));}oniOSVideoMediaElementInit(t){null!=t&&null!=t.data&&this.videoElement!=t.data&&(this.videoElement=t.data,o.isFunction($t(s=this.videoElement,s.webkitSupportsPresentationMode))&&o.isFunction($t(s=this.videoElement,s.webkitSetPresentationMode))&&(this.videoElement.removeEventListener("webkitpresentationmodechanged",$t(this,this.oniOSWebkitPresentationModeChanged)),this.videoElement.addEventListener("webkitpresentationmodechanged",$t(this,this.oniOSWebkitPresentationModeChanged))));}oniOSWebkitPresentationModeChanged(t){0!=this.enabled&&(this.state.active=null!=this.videoElement&&"fullscreen"==this.videoElement.webkitPresentationMode,this.refreshCallback(this.state));}oniOSPlaying(t){0!=this.enabled&&y.add(this.context,"currentTimeChange",$t(this,this.oniOSCurrentTimeChange));}oniOSCurrentTimeChange(t){null!=t&&null!=t.data&&null!=t.data.media&&null!=t.data.media.mediaPlaybackInfo&&0!=t.data.media.mediaPlaybackInfo.isPlaying&&(this.enabled=1==this.videoElement.webkitSupportsFullscreen,this.enabled?this.activate():this.deactivate(),y.remove(this.context,"currentTimeChange",$t(this,this.oniOSCurrentTimeChange)));}oniOSComplete(t){0!=this.enabled&&this.deactivate();}}Y.__name__="bs.player.plugin.skin.model.fullscreen.FullscreenModel",Y.__super__=B,Object.assign(Y.prototype,{__class__:Y});class Z extends B{constructor(t,e,s,i,n,a){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i,n,a);}_hx_constructor(t,e,s,i,n,a){let l;if(this.pauseSelector=null,this.isPlaying=!1,this.showSkinOnInit=!0,this.skinElement=null,super._hx_constructor(t,e,s,i),this.skinElement=a,null!=n&&this.set_prefix(n),Object.prototype.hasOwnProperty.call(e,"showSkinOnInit"))switch(o.field(e,"showSkinOnInit")){case 0:case"false":case!1:l=!1;break;default:l=!0;}else l=!0;this.showSkinOnInit=l,this.state={css:"show",reset:null,active:!1,starts:null},this.state.reset=$t(this,this.handleReset),this.state.starts=$t(this,this.handleAnimStarts),m.add(t,"mediaMetadataData",$t(this,this.onMetadata)),f.add(t,"animateShow",$t(this,this.onShow)),y.add(t,"playing",$t(this,this.onPlaying)),y.add(t,"paused",$t(this,this.onStopped)),y.add(t,"complete",$t(this,this.onStopped)),g.isMobile()?this.skinElement.addEventListener("touchmove",$t(this,this.onMove),wt.get_passiveOptions()):this.skinElement.addEventListener("mousemove",$t(this,this.onMove),wt.get_passiveOptions()),this.refreshCss("show");}set_prefix(t){return this.pauseSelector="."+t+"-hide-pause-on-over",t}destroy(){super.destroy(),g.isMobile()?this.skinElement.removeEventListener("touchmove",$t(this,this.onMove)):this.skinElement.removeEventListener("mousemove",$t(this,this.onMove)),m.remove(this.context,"mediaMetadataData",$t(this,this.onMetadata)),f.remove(this.context,"animateShow",$t(this,this.onShow)),y.remove(this.context,"playing",$t(this,this.onPlaying)),y.remove(this.context,"paused",$t(this,this.onStopped)),y.remove(this.context,"complete",$t(this,this.onStopped));}refreshCss(t){this.state.css=t,this.refreshCallback(this.state);}handleReset(t){this.isPlaying&&this.startAutohide();}handleAnimStarts(t){this.state.active="show"!=this.state.css,this.refreshCallback(this.state);}onMove(t){if(!this.isPlaying)return;null!=t.target.closest(this.pauseSelector)?(this.refreshCss("show"),this.stopAutohide()):this.startAutohide();}onMetadata(t){this.isPlaying=!1,this.refreshCss("show"),this.stopAutohide(),this.showSkinOnInit||this.refreshCss("hide-force");}onStopped(t){this.isPlaying=!1,this.refreshCss("show"),this.stopAutohide();}onPlaying(t){this.isPlaying=!0,this.refreshCss("hide"),this.stopAutohide();}onShow(t){this.startAutohide();}startAutohide(){if(this.refreshCss("show"),this.stopAutohide(),!this.isPlaying)return;let t=this;this.animTimer=Ft.delay((function(){t.isPlaying&&(t.refreshCss("hide"),t.stopAutohide());}),100);}stopAutohide(){let t=this.animTimer;null!=t&&t.stop(),this.animTimer=null,this.state.active=!1,this.refreshCallback(this.state);}}Z.__name__="bs.player.plugin.skin.model.hide.AutohideModel",Z.__super__=B,Object.assign(Z.prototype,{__class__:Z});class J extends B{constructor(t,e,s,i){super(t,e,s,i),this.state={type:"css",skinIcoPrefix:"",airplay:{id:"bmp-ico-airplay"},alert:{id:"bmp-ico-alert"},subtitles:{id:"bmp-ico-subtitles"},pip:{id:"bmp-ico-pip"},chromecast:{id:"bmp-ico-chromecast"},copy:{id:"bmp-ico-copy"},playNext:{id:"bmp-ico-play-next"},maximize:{id:"bmp-ico-maximize"},minimize:{id:"bmp-ico-minimize"},menu:{id:"bmp-ico-menu"},audio:{id:"bmp-ico-audio"},pause:{id:"bmp-ico-pause"},play:{id:"bmp-ico-play"},replay:{id:"bmp-ico-replay"},quality:{id:"bmp-ico-quality"},volume:{id:"bmp-ico-volume"},volume1:{id:"bmp-ico-volume-1"},volume2:{id:"bmp-ico-volume-2"},volumeX:{id:"bmp-ico-volume-x"},close:{id:"bmp-ico-close"},left:{id:"bmp-ico-left"},right:{id:"bmp-ico-right"},up:{id:"bmp-ico-up"},down:{id:"bmp-ico-down"},center:{id:"bmp-ico-center"},vr:{id:"bmp-ico-vr"},gyroscope:{id:"bmp-ico-gyroscope"},zoom:{plus:{id:"bmp-ico-zoom-plus"},minus:{id:"bmp-ico-zoom-minus"},reset:{id:"bmp-ico-zoom-reset"}},playbackRate:{id:"bmp-ico-playback-rate"},videoTracks:{id:"bmp-ico-video-tracks"}};}updateTypesState(t,e){this.state.skinIcoPrefix=t,this.state.type=e,this.refreshCallback(this.state);}}J.__name__="bs.player.plugin.skin.model.icon.IconModel",J.__super__=B,Object.assign(J.prototype,{__class__:J});class tt extends B{constructor(t,e,s,i,n,a,l){super(t,e,s,i),this.state={count:0,audio:{name:"audio",hasItems:!1,activate:null},casting:null,fullscreen:null,pictureInPicture:null,quality:{name:"quality",hasItems:!1,activate:null,value:null},subtitles:{name:"subtitles",hasItems:!1,activate:null},vr:null,playbackRate:{name:"playback-rate",hasItems:!1,items:null,activate:null},videoTracks:{name:"video",hasItems:!1,activate:null}};let r=this;this.audio=new R(t,e,(function(t,e){r.menuStateChange({audio:t},e);}),(function(t){r.reportError(t);})),this.casting=new H(t,e,(function(t,e){r.menuStateChange({casting:t},e);}),(function(t){r.reportError(t);})),this.fullscreen=new Y(t,e,(function(t,e){r.menuStateChange({fullscreen:t},e);}),(function(t){r.reportError(t);}),a),this.pip=new it(t,e,(function(t,e){r.menuStateChange({pictureInPicture:t},e);}),(function(t){r.reportError(t);})),this.quality=new ot(t,e,(function(t,e){r.menuStateChange({quality:t},e);}),(function(t){r.reportError(t);})),this.subtitles=new ft(t,e,(function(t,e){r.menuStateChange({subtitles:t},e);}),(function(t){r.reportError(t);})),this.vr=new yt(t,e,(function(t,e){r.menuStateChange({vr:t},e);}),(function(t){r.reportError(t);})),this.playbackRate=new nt(t,e,(function(t,e){r.menuStateChange({playbackRate:t},e);}),(function(t){r.reportError(t);})),this.videoTracks=new bt(t,e,(function(t,e){r.menuStateChange({videoTracks:t},e);}),(function(t){r.reportError(t);})),this.quanteec=new ht(t,e,(function(t,e){r.menuStateChange({quanteec:t},e);}),(function(t){r.reportError(t);}),n,a,l);}set_prefix(t){return null!=this.quanteec&&(this.quanteec.prefix=t),t}menuStateChange(t,e){if(null!=t){let e=0,s=o.fields(t);for(;e<s.length;){let i=s[e];++e,this.state[i]=o.field(t,i);}}let s=0;this.state.quality.hasItems&&(s=1),this.state.subtitles.hasItems&&++s,this.state.audio.hasItems&&++s,null!=this.state.casting&&++s,null!=this.state.pictureInPicture&&++s,null!=this.state.fullscreen&&++s,null!=this.state.vr&&++s,this.state.playbackRate.hasItems&&++s,null!=this.state.videoTracks.hasItems&&++s,null!=this.state.quanteec&&++s,this.state.count=s,this.refreshCallback(this.state);}postActivate(){super.postActivate();let t=this.audio;null!=t&&t.postActivate();let e=this.casting;null!=e&&e.postActivate();let s=this.fullscreen;null!=s&&s.postActivate();let i=this.pip;null!=i&&i.postActivate();let n=this.quality;null!=n&&n.postActivate();let a=this.subtitles;null!=a&&a.postActivate();let l=this.vr;null!=l&&l.postActivate();let r=this.videoTracks;null!=r&&r.destroy();let o=this.quanteec;null!=o&&o.postActivate();}destroy(){let t=this.audio;null!=t&&t.destroy();let e=this.casting;null!=e&&e.destroy();let s=this.fullscreen;null!=s&&s.destroy();let i=this.pip;null!=i&&i.destroy();let n=this.quality;null!=n&&n.destroy();let a=this.subtitles;null!=a&&a.destroy();let l=this.vr;null!=l&&l.destroy();let r=this.videoTracks;null!=r&&r.destroy();let o=this.quanteec;null!=o&&o.destroy();}}tt.__name__="bs.player.plugin.skin.model.menu.MenuModel",tt.__super__=B,Object.assign(tt.prototype,{__class__:tt});class et extends B{constructor(t,e,s,i){super(t,e,s,i),this.state=null,f.add(t,"showMessage",$t(this,this.onOpenEvent)),f.add(t,"closeMessage",$t(this,this.onCloseEvent)),this.refreshCallback(this.state);}destroy(){super.destroy(),f.remove(this.context,"showMessage",$t(this,this.onOpenEvent)),f.remove(this.context,"closeMessage",$t(this,this.onCloseEvent));}close(){new f("closeMessage").dispatch(this.context);}onOpenEvent(t){if(this.state=null,null!=t&&null!=t.data){if(Object.prototype.hasOwnProperty.call(t.data,"type")&&""!=t.data.type)switch(null==this.state&&(this.state={type:{alert:!1,code:!1,normal:!1,text:"normal"}}),t.data.type){case"alert":this.state.type.alert=!0,this.state.type.text="alert";break;case"code":this.state.type.code=!0,this.state.type.text="code";break;case"normal":this.state.type.normal=!0,this.state.type.text="normal";break;default:this.state.type=null;}null!=this.state.type?(this.state.name="message",Object.prototype.hasOwnProperty.call(t.data,"title")&&""!=t.data.title&&(this.state.title={html:t.data.title}),Object.prototype.hasOwnProperty.call(t.data,"text")&&""!=t.data.text&&(this.state.content={html:t.data.text}),Object.prototype.hasOwnProperty.call(t.data,"textDetails")&&""!=t.data.textDetails&&(null==this.state.content&&(this.state.content={}),this.state.content.text=t.data.textDetails),Object.prototype.hasOwnProperty.call(t.data,"userSingleActionButtonText")&&""!=t.data.userSingleActionButtonText&&Object.prototype.hasOwnProperty.call(t.data,"onUserSingleAction")&&o.isFunction(t.data.onUserSingleAction)&&(this.state.action={icon:this.state.type.code?"copy":null,text:t.data.userSingleActionButtonText,click:t.data.onUserSingleAction}),Object.prototype.hasOwnProperty.call(t.data,"close")&&0==t.data.close?this.state.close=null:this.state.close={click:$t(this,this.close)},null!=t.data.onAfterShow&&o.isFunction(t.data.onAfterShow)&&(this.onAfterShow=t.data.onAfterShow),null!=t.data.onAfterClose&&o.isFunction(t.data.onAfterClose)&&(this.onAfterClose=t.data.onAfterClose),Object.prototype.hasOwnProperty.call(t.data,"style")&&(this.state.style=o.field(t.data,"style")),this.refreshCallback(this.state,$t(this,this.afterOpenStateRefresh))):this.refreshCallback(this.state);}else this.refreshCallback(this.state);}afterOpenStateRefresh(t){null!=this.onAfterShow&&this.onAfterShow(),this.onAfterShow=null;}onCloseEvent(t){this.state=null,this.refreshCallback(this.state,$t(this,this.afterCloseStateRefresh));}afterCloseStateRefresh(t){null!=this.onAfterClose&&this.onAfterClose(),this.onAfterClose=null;}}et.__name__="bs.player.plugin.skin.model.message.MessageModel",et.__super__=B,Object.assign(et.prototype,{__class__:et});class st extends B{constructor(t,e,s,i,n,a){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i,n,a);}_hx_constructor(t,e,s,i,n,a){this.updateRectDelay=null,this.focusBeforeEndSplash=null,this.endSplashVisible=!1,this.focusBeforeWindow=null,this.activeWindow=null,this.activePopupButton=null,this.started=!1,super._hx_constructor(t,e,s,i),this.prefix=n,this.skinElement=a,this.state={active:null,setActive:null,ctrl:null,endSplashCtrl:null,windowCtrl:null},this.state.setActive=$t(this,this.setActive),this.state.ctrl=$t(this,this.ctrl),this.state.endSplashCtrl=$t(this,this.endSplashCtrl),this.state.windowCtrl=$t(this,this.windowCtrl),this.refreshCallback(this.state);}get_api(){return {start:$t(this,this.start),stop:$t(this,this.stop),left:$t(this,this.left),right:$t(this,this.right),up:$t(this,this.up),down:$t(this,this.down),ok:$t(this,this.ok)}}destroy(){super.destroy(),this.started=!1,this.activeNavElement=null,this.activePopupButton=null,this.activeWindow=null,this.focusBeforeWindow=null,this.endSplashVisible=!1,this.focusBeforeEndSplash=null,null!=this.updateRectDelay&&this.updateRectDelay.stop(),this.updateRectDelay=null;}setActive(t){this.state.active!=t&&(this.state.active=t,this.refreshCallback(this.state));}ctrl(t){null!=t&&null!=this.state.active&&t.dataset.navName==this.state.active&&(this.activeNavElement=t);}endSplashCtrl(t){if(null==t)return this.endSplashVisible=!1,void(null!=this.focusBeforeEndSplash&&(this.state.active=""+this.focusBeforeEndSplash,this.focusBeforeEndSplash=null,this.refreshCallback(this.state)));0==this.endSplashVisible&&(this.endSplashVisible=!0);}windowCtrl(t){if(null==t)return void(null!=this.focusBeforeWindow&&this.state.active!=this.focusBeforeWindow&&(this.state.active=""+this.focusBeforeWindow,this.focusBeforeWindow=null,this.activeWindow=null,this.refreshCallback(this.state)));let e=t.dataset.navFocuson;null!=e&&this.state.active!=e&&this.activeWindow!=t&&(this.activeWindow=t,this.focusBeforeWindow=""+this.state.active,this.state.active=e);}exit(t){}start(t){1!=this.started&&(this.emitShowSkin(),null==t&&(t={}),null!=t.onExit&&(this.exit=t.onExit),null==t.startElement&&(t.startElement="play"),this.state.active=t.startElement,this.ctrl(this.skinElement.querySelector("[data-nav-name="+this.state.active+"]")),this.refreshCallback(this.state),this.started=!0);}stop(){this.activeNavElement=null,this.activePopupButton=null,this.state.active=null,0!=this.started&&(this.refreshCallback(this.state),this.started=!1);}left(t){null!=this.activeNavElement?(null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()),this.emitShowSkin(),this.findNext("left")&&this.exit("left")):console.warn("BRADMAX PLAYER NOTICE:\n[nav left]: No element marked as "+this.state.active);}right(t){null!=this.activeNavElement?(null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()),this.emitShowSkin(),this.findNext("right")&&this.exit("right")):console.warn("BRADMAX PLAYER NOTICE:\n[nav right]: No element marked as "+this.state.active);}up(t){null!=this.activeNavElement?(null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()),this.emitShowSkin(),this.findNext("up")&&this.exit("up")):console.warn("BRADMAX PLAYER NOTICE:\n[nav up]: No element marked as "+this.state.active);}down(t){null!=this.activeNavElement?(null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()),this.emitShowSkin(),this.findNext("down")&&this.exit("down")):console.warn("BRADMAX PLAYER NOTICE:\n[nav down]: No element marked as "+this.state.active);}ok(t){if(null==this.activeNavElement)return void console.warn("BRADMAX PLAYER NOTICE:\n[nav ok]: No element marked as "+this.state.active);switch(null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()),this.emitShowSkin(),o.field(this.activeNavElement.dataset,"navOk")){case"click":return void this.emitClickEvent();case"emit":return void this.emitNavEvent("ok");default:return}}findNext(t){if(null==this.activeNavElement)return console.warn("BRADMAX PLAYER NOTICE:\n[nav next]: No element marked as "+this.state.active),!1;let e=o.field(this.activeNavElement.dataset,"nav"+It.capilizeFirstLetter(t));if("emit"==e)return this.emitNavEvent(t),!1;null!=this.activePopupButton&&this.activeNavElement.dataset.navName.indexOf("option")>-1&&"next"==e&&(this.activeNavElement=this.activePopupButton,this.state.active=this.activePopupButton.dataset.navName);let s=(null!=this.activeWindow?this.activeWindow:null!=this.activePopupButton&&null!=this.activeNavElement&&this.activePopupButton!=this.activeNavElement?this.activePopupButton.parentElement:this.skinElement).querySelectorAll("[data-nav-name]"),i=null,n=1/0,a=null,l=1/0,r=null;r=this.activeNavElement.getBoundingClientRect();let h,u=r;if(null==u)return !1;if(null!=u)switch(t){case"down":h=new O(u.left+Math.floor(u.width/2),u.top+u.height);break;case"left":h=new O(u.left,u.top+Math.floor(u.height/2));break;case"right":h=new O(u.left+u.width,u.top+Math.floor(u.height/2));break;case"up":h=new O(u.left+Math.floor(u.width/2),u.top);}else h=new O(0,0);let c=0;for(;c<s.length;){let e=s[c++];if(e==this.activeNavElement)continue;let r=null;r=e.getBoundingClientRect();let o,u=r;if(null==u)continue;switch(t){case"down":o=new O(u.left+Math.floor(u.width/2),u.top);break;case"left":o=new O(u.left+u.width,u.top+Math.floor(u.height/2));break;case"right":o=new O(u.left,u.top+Math.floor(u.height/2));break;case"up":o=new O(u.left+Math.floor(u.width/2),u.top+u.height);}switch(t){case"down":if(h.y>o.y+1)continue;break;case"left":if(h.x<o.x-1)continue;break;case"right":if(h.x>o.x+1)continue;break;case"up":if(h.y<o.y-1)continue}let d=Math.pow(h.x-o.x,2),p=Math.pow(h.y-o.y,2),m=Math.sqrt(d+p);switch(t){case"down":case"up":m<n&&(n=m,i=e);break;case"left":case"right":0==p?d<n&&(n=d,i=e):m<l&&(l=m,a=e);}}if(null==i&&"emit"==o.field(this.activeNavElement.dataset,"navNo"+It.capilizeFirstLetter(t)))return this.emitNavEvent(t),!1;if(null==i&&null!=a&&(i=a),null==i)return null==this.activeNavElement||this.activeNavElement.dataset.navName.indexOf("option")>-1!=1;let d=i.dataset.navName;return this.activeNavElement=i,this.endSplashVisible&&d.indexOf("splash-end")>-1&&this.state.active.indexOf("splash-end")<0&&(this.focusBeforeEndSplash=""+this.state.active),this.state.active=d,this.activeNavElement.dataset.navName.indexOf("option")>-1==0&&(this.activePopupButton=null),this.activeNavElement.dataset.navName.indexOf("popup")>-1&&(this.activePopupButton=this.activeNavElement),this.refreshCallback(this.state),!1}emitNavEvent(t){null!=this.activeNavElement&&this.activeNavElement.dispatchEvent(new CustomEvent("nav"+t,{bubbles:!0,cancelable:!0}));}emitClickEvent(){null!=this.activeNavElement&&this.activeNavElement.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}));}emitShowSkin(){new f("animateShow").dispatch(this.context);}}st.__name__="bs.player.plugin.skin.model.nav.LRUDNavigationModel",st.__super__=B,Object.assign(st.prototype,{__class__:st});class it extends B{constructor(t,e,s,i){if(super(t,e,s,i),Object.prototype.hasOwnProperty.call(e,"pictureInPictureEnabled"))switch(o.field(e,"pictureInPictureEnabled")){case 0:case"false":case!1:e.pictureInPictureButtonVisible=!1;break;default:e.pictureInPictureButtonVisible=!0;}let n,a=Mt.syncWithHideUIElements(e,"pictureInPicture","pictureInPictureButtonVisible");if(Object.prototype.hasOwnProperty.call(a,"pictureInPictureButtonVisible"))switch(o.field(a,"pictureInPictureButtonVisible")){case 0:case"false":case!1:n=!1;break;default:n=!0;}else n=!0;this.enabled=n,this.state=null,this.enabled&&(p.add(t,"pipAvailable",$t(this,this.onPipAvailable)),p.add(t,"pipEntered",$t(this,this.onPipEntered)),p.add(t,"pipLeft",$t(this,this.onPipLeft))),this.refreshCallback(this.state);}destroy(){super.destroy(),this.enabled&&(p.remove(this.context,"pipAvailable",$t(this,this.onPipAvailable)),p.remove(this.context,"pipEntered",$t(this,this.onPipEntered)),p.remove(this.context,"pipLeft",$t(this,this.onPipLeft)));}onPipAvailable(t){this.isPipAvailable=null!=t&&1==t.data,0!=this.enabled&&(this.isPipAvailable?this.state={active:!1,click:$t(this,this.dispatchPipToggle)}:this.state=null,this.refreshCallback(this.state));}onPipEntered(t){0!=this.enabled&&(this.state.active=!0,this.refreshCallback(this.state));}onPipLeft(t){0!=this.enabled&&(this.state.active=!1,this.refreshCallback(this.state));}dispatchPipToggle(t){new p("pipToggle").dispatch(this.context);}}it.__name__="bs.player.plugin.skin.model.pip.PictureInPictureModel",it.__super__=B,Object.assign(it.prototype,{__class__:it});class nt extends B{constructor(t,e,s,i){super(t,e,s,i);let n,a=Mt.syncWithHideUIElements(e,"playbackRateSelection","playbackRateEnabled");if(Object.prototype.hasOwnProperty.call(a,"playbackRateEnabled"))switch(o.field(a,"playbackRateEnabled")){case 1:case"true":case!0:n=!0;break;default:n=!1;}else n=!1;this.enabled=n;let l=[.25,.5,.75,1,1.25,1.5,1.75,2],r=null;Object.prototype.hasOwnProperty.call(e,"playbackRate")&&(r=parseFloat(o.field(e,"playbackRate")),isNaN(r)&&(r=null));let h=r;null==h||isNaN(h)||-1!=l.indexOf(h)||(l=l.concat([h]),l.sort((function(t,e){return t>e?1:-1})));let u=[],c=0;for(;c<l.length;){let t=l[c];++c,u.push({active:1==t,label:1==t?"Normal":""+t,data:""+t});}this.ITEMS=u,this.state={name:"playback-rate",hasItems:!1,items:null,activate:null},this.enabled&&(this.state.hasItems=!0,this.state.items=this.ITEMS,this.state.activate=$t(this,this.activate)),this.enabled&&(y.add(t,"playbackRate",$t(this,this.onPlaybackRate)),y.add(t,"videoCastingStart",$t(this,this.onCastingStart)),y.add(t,"videoCastingEnd",$t(this,this.onCastingEnd))),this.refreshCallback(this.state);}get_activeRate(){if(null!=this.state&&null!=this.state.items){let t=0,e=this.state.items;for(;t<e.length;){let s=e[t];if(++t,s.active)return parseFloat(s.data)}}return 0}destroy(){super.destroy(),this.enabled&&(y.remove(this.context,"playbackRate",$t(this,this.onPlaybackRate)),y.remove(this.context,"videoCastingStart",$t(this,this.onCastingStart)),y.remove(this.context,"videoCastingEnd",$t(this,this.onCastingEnd)));}onPlaybackRate(t){if(0==t.data)return;if(this.get_activeRate()==t.data||null==this.state.items)return;let e=0,s=this.state.items.length;for(;e<s;){let s=e++,i=t.data,n=parseFloat(this.state.items[s].data);this.state.items[s].active=i==n;}this.refreshCallback(this.state);}onCastingStart(t){let e=this.ITEMS,s=[],i=0;for(;i<e.length;){let t=e[i];++i,parseFloat(t.data)>=.5&&s.push(t);}this.state.items=s,this.refreshCallback(this.state);}onCastingEnd(t){this.state.items=this.ITEMS,this.refreshCallback(this.state);}dispatch(t){let e=this.state.items[t];if(null==e)return;let s=parseFloat(this.state.items[this.state.items.length-1].data),i=Math.max(0,Math.min(s,parseFloat(e.data))),n=new p("setVideoPlaybackRate");n.data=i,n.dispatch(this.context);}activate(t){if(!Object.prototype.hasOwnProperty.call(this.state,"items"))return;null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault());let e=h.parseInt(Ut.__cast(t.target,HTMLElement).getAttribute("data-item-index"));isNaN(e)||(this.dispatch(e),this.refreshCallback(this.state));}}nt.__name__="bs.player.plugin.skin.model.playbackRate.PlaybackRateModel",nt.__super__=B,Object.assign(nt.prototype,{__class__:nt});class at extends B{constructor(t,e,s,i){super(t,e,s,i),this.state={hasNext:!1,currentPos:-1,items:null,playItem:null},this.state.playItem=$t(this,this.playItem),m.add(t,"mediaMetadataData",$t(this,this.onMetadataData)),m.add(t,"mediaPlaylistData",$t(this,this.onPlaylistData)),this.refreshCallback(this.state);}destroy(){super.destroy(),m.remove(this.context,"mediaMetadataData",$t(this,this.onMetadataData)),m.remove(this.context,"mediaPlaylistData",$t(this,this.onPlaylistData));}onMetadataData(t){this.state={hasNext:!1,currentPos:-1,items:null,playItem:null},this.state.playItem=$t(this,this.playItem),this.mediaPlaylist=null,this.refreshCallback(this.state);}onPlaylistData(t){if(null==t||null==t.data)return this.state={hasNext:!1,currentPos:-1,items:null,playItem:null},this.state.playItem=$t(this,this.playItem),void(this.mediaPlaylist=null);this.mediaPlaylist=E.clone(t.data);let e=null!=this.mediaPlaylist&&this.mediaPlaylist.hasNext();if(this.state.hasNext=e,this.state.currentPos=null!=this.mediaPlaylist?this.mediaPlaylist.currentPos:0,this.state.items=[],null!=this.mediaPlaylist){let t=0,e=this.mediaPlaylist.items;for(;t<e.length;){let s=e[t];++t;let i={},n=this.cleanupCustomParams(o.field(s,"title"));null!=n&&this.copyParams(i,"title",n);let a=this.cleanupCustomParams(o.field(s,"duration"));null!=a&&this.copyParams(i,"duration",a);let l=this.cleanupCustomParams(o.field(s,"splashImages"));null!=l&&this.copyParams(i,"splashImages",l),this.state.items.push(i);}}this.refreshCallback(this.state);}copyParams(t,e,s){if("duration"==e)t[e]={time:s,text:It.formatTime(parseFloat(""+h.string(s)))};else if("splashImages"==e){let e=s;null!=e&&e instanceof Array&&e.length>0&&(t.image=Ct.imageToState(e));}else t[e]=s;}cleanupCustomParams(t){if(null==t||"string"==typeof t||"number"==typeof t)return t;if(t instanceof Array){let e=t,s=[],i=0;for(;i<e.length;)s.push(this.cleanupCustomParams(e[i++]));return s}if(o.isObject(t)){let e=o.copy(t);return Object.prototype.hasOwnProperty.call(e,"customParams")&&o.deleteField(e,"customParams"),e}return t}playItem(t){if(null==this.mediaPlaylist)return;let e=this.mediaPlaylist.items[t];this.mediaPlaylist.currentPos=t,at.play(this.context,e,this.mediaPlaylist);}static play(t,e,s){if(null==e)return;let i=new m("mediaMetadataData");i.data=e,i.dispatch(t);let n=new m("mediaPlaylistData");n.data=s,n.dispatch(t);let a=new m("movieData");a.data=e,a.dispatch(t);let l=new m("audioData");null!=e.audioSets?l.data=e.audioSets:l.data=[],l.dispatch(t);let r=new m("subtitleData");null!=e.subtitlesSets?r.data=e.subtitlesSets:r.data=[],r.dispatch(t),new p("skinPlay").dispatch(t);}}at.__name__="bs.player.plugin.skin.model.playlist.PlaylistModel",at.__super__=B,Object.assign(at.prototype,{__class__:at});class lt extends B{constructor(t,e,s,i){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i);}_hx_constructor(t,e,s,i){this.active=null,super._hx_constructor(t,e,s,i),this.state={active:null,toggle:null,open:null,close:null},this.state.toggle=$t(this,this.toggle),this.state.open=$t(this,this.open),this.state.close=$t(this,this.close),this.refreshCallback(this.state);}toggle(t){let e=this;return function(s){e.state.active=e.state.active==t?null:t,e.refreshCallback(e.state);}}open(t){let e=this;return function(s){e.state.active!=t&&(e.state.active=t,e.refreshCallback(e.state));}}close(t){null!=this.state.active&&(this.state.active=null,this.refreshCallback(this.state));}}lt.__name__="bs.player.plugin.skin.model.popup.PopupModel",lt.__super__=B,Object.assign(lt.prototype,{__class__:lt});class rt extends q{constructor(t,e,s,i,n,a,l){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i,n,a,l);}_hx_constructor(t,e,s,i,n,a,l){let r=[],o=0;for(;o<3;)++o,r.push(0);this.eventTsRegistry=r,this.maxThumbSize=null,this.hidePopupDelay=null,this.dispatchSeekDelay=null,this.seekedPosition=null,this.seekPositionBy=null,this.popupResizeObserver=null,this.popupRect=null,this.popupElement=null,this.boundsRect=null,this.boundsElement=null,this.handleRect=null,this.handleMoveX=null,this.handleMoveTime=null,this.handleMoveFromTime=null,this.handleElement=null,this.thumbService=null,this.plugins=null,this.skinRect=null,this.skinElement=null,this.segments=null,this.markers=null,this.thumbnails=null,this.isTrackDown=!1,super._hx_constructor(t,e,s,i),this.skinElement=n,this.plugins=l,this.maxThumbSize=this.getMaxThumbnailsSize(a);let h=null;h=this.skinElement.getBoundingClientRect(),this.skinRect=h,this.state={name:"progress",time:0,text:It.formatTime(0),width:"0",has:{thumb:!1,segments:!1,segment:!1,markers:!1,marker:!1,texts:!1},popup:{active:!1,time:0,text:It.formatTime(0),position:"0",width:"0",bounds:{offset:"0px",ctrl:null},ctrl:null},ctrl:null,seekBackward:null,seekForward:null},this.state.ctrl=$t(this,this.controlHandler),this.state.popup.ctrl=$t(this,this.controlPopup),this.state.popup.bounds.ctrl=$t(this,this.controlPopupBounds),this.state.seekBackward=$t(this,this.seekBackward),this.state.seekForward=$t(this,this.seekForward),b.add(t,"resize",$t(this,this.onResize)),this.updateState();}postActivate(){super.postActivate();let t=this.plugins;this.thumbService=r.exists(t,(function(t){return "BradmaxThumbnailsService"==t.getPluginName()}))?r.find(t,(function(t){return "BradmaxThumbnailsService"==t.getPluginName()})):null;}destroy(){super.destroy(),b.remove(this.context,"resize",$t(this,this.onResize)),this.unobservePopupElement(),this.seekPositionBy=null,this.seekedPosition=null,null!=this.dispatchSeekDelay&&this.dispatchSeekDelay.stop(),this.dispatchSeekDelay=null,null!=this.hidePopupDelay&&this.hidePopupDelay.stop(),this.hidePopupDelay=null;}updateState(t){super.updateState(t),this.state.time=this.current.position,this.state.text=It.formatTime(this.state.time);let e=this.state.time/this.duration,s=isNaN(e)||!isFinite(e);this.state.width=s?"0%":Math.max(0,Math.min(100,100*e))+"%",this.state.has.texts=this.state.has.marker||this.state.has.segment,this.refreshSegments(this.state.time),this.refreshCallback(this.state);}getMaxThumbnailsSize(t){return t.maxThumbnailSize}onResize(t){if(null!=this.skinElement){let t=null;t=this.skinElement.getBoundingClientRect(),this.skinRect=t;}this.updatePopupSizes();}controlHandler(t){if(null==t)return this.handleElement.removeEventListener("touchstart",$t(this,this.handle),!1),this.handleElement.removeEventListener("touchmove",$t(this,this.handle),!1),this.handleElement.removeEventListener("touchend",$t(this,this.handle),!1),this.handleElement.removeEventListener("mousedown",$t(this,this.handle),!1),this.handleElement.removeEventListener("mousemove",$t(this,this.handle),!1),this.handleElement.removeEventListener("mouseup",$t(this,this.handle),!1),this.handleElement=null,void(this.handleRect=null);this.handleElement=t;let e=null;e=this.handleElement.getBoundingClientRect(),this.handleRect=e,this.handleElement.addEventListener("touchstart",$t(this,this.handle),wt.get_passiveOptions()),this.handleElement.addEventListener("touchmove",$t(this,this.handle),wt.get_passiveOptions()),this.handleElement.addEventListener("touchend",$t(this,this.handle),wt.get_passiveOptions()),this.handleElement.addEventListener("mousedown",$t(this,this.handle),wt.get_passiveOptions()),this.handleElement.addEventListener("mousemove",$t(this,this.handle),wt.get_passiveOptions()),this.handleElement.addEventListener("mouseup",$t(this,this.handle),wt.get_passiveOptions());}dispatchSeek(t){let e=new p("skinSeek");e.data={seekedPosition:t,seekSource:"progress"},e.dispatch(this.context);}handle(t){if(!(this.duration<=0))switch(t.type){case"blur":case"mouseleave":case"mouseup":case"touchend":if(this.eventAlreadyTriggered(2,t))return;let e=this.skinElement,s=$t(this,this.handle);g.enableHtmlSelection(),window.document.removeEventListener("mouseup",s),window.document.removeEventListener("mousemove",s),window.document.removeEventListener("mouseleave",s),window.document.removeEventListener("blur",s),e.removeEventListener("mouseup",s),e.removeEventListener("mousemove",s),e.removeEventListener("blur",s),g.isMobile()&&(window.document.removeEventListener("touchend",s),e.removeEventListener("touchend",s)),this.state.popup.active=!1;let i=t.target;this.skinElement.contains(i)&&this.isTrackDown?this.handleMoveEnd(t):(this.current.position=this.handleMoveFromTime,this.updateState()),this.handleMoveFromTime=null,this.isTrackDown=!1;break;case"mousedown":case"touchstart":if(this.isTrackDown)return;if(this.eventAlreadyTriggered(0,t))return;let n=this.skinElement,a=$t(this,this.handle);g.disableHtmlSelection(),window.document.addEventListener("mouseup",a,wt.get_passiveOptions()),window.document.addEventListener("mousemove",a,wt.get_passiveOptions()),window.document.addEventListener("mouseleave",a,wt.get_passiveOptions()),window.document.addEventListener("blur",a,wt.get_passiveOptions()),n.addEventListener("mouseup",a,wt.get_passiveOptions()),n.addEventListener("mousemove",a,wt.get_passiveOptions()),n.addEventListener("blur",a,wt.get_passiveOptions()),g.isMobile()&&(window.document.addEventListener("touchend",a,wt.get_passiveOptions()),n.addEventListener("touchend",a,wt.get_passiveOptions())),this.handleMoveFromTime=this.current.position,this.state.popup.active=!0,this.handleMoving(t),this.isTrackDown=!0;break;case"mousemove":case"touchmove":if(this.eventAlreadyTriggered(1,t))return;this.handleMoving(t);break;default:return}}eventAlreadyTriggered(t,e){let s=e.timeStamp;if(null==s&&(s=(new Date).getTime()),this.eventTsRegistry[t]==s)return !0;let i=0,n=this.eventTsRegistry.length;for(;i<n;){let e=i++;this.eventTsRegistry[e]=t==e?s:0;}return !1}handleMoving(t){if(null==this.duration)return;this.updatePopupSizes();let e=0;t instanceof MouseEvent&&(e=Ut.__cast(t,MouseEvent).clientX);let s,i=window;if(Object.prototype.hasOwnProperty.call(i,"TouchEvent")&&t instanceof TouchEvent){let s=t;if(s.touches.length>0){e=s.touches.item(0).clientX;}}if(this.handleMoveX=e,this.handleMoveTime=this.calculateProgressTime(),null!=this.handleMoveTime){if(this.isTrackDown&&(this.current.position=this.handleMoveTime,this.updateState()),this.updatePopupData(this.handleMoveTime),null==t)s=null;else {let e=t.target;s=null==e?null:e.dataset;}this.searchForMarkerByEvent(s),this.searchForSegmentByEvent(s),this.updateState();}}handleMoveEnd(t){this.isSeekingPossible()&&(this.handleMoveTime<=0||(this.current.position=this.handleMoveTime,this.dispatchSeek(this.current.position),this.handleMoveTime=null,this.handleMoveX=null));}onSeekingStart(t){null!=t&&null!=t.data&&t.data.currentTime>=0&&(this.current.position=t.data.currentTime),this.current.position>0&&(this.hasPlaybackStarted=!0),this.updateState();}onCurrentTimeChange(t){if(this.isTrackDown||null!=this.seekedPosition)return;let e=this.current.position;super.onCurrentTimeChange(t),this.current.position!=e&&(this.isDvr&&this.onDurationChange(t),1==this.state.popup.active&&this.updatePopupData(this.current.position),this.updateState(!0));}onDurationChange(t){this.updateOnEvent(t);}onBufferingEnd(t){this.updateOnEvent(t);}onPlaying(t){this.updateOnEvent(t);}updateOnEvent(t){this.updateDurationOnEvent(t,!1),this.updateSegments(this.duration),this.updateMarkers(this.duration),this.updateState();}onMetadataData(t){super.onMetadataData(t),this.resetThumbs(),this.resetSegments(),this.resetMarkers();let e=this.monitor.currentMedia;if(null==e)return void this.updateState();let s=e.progress;if(null==s)return void this.updateState();let i=s.thumbnails;null!=i?this.onThumbsMetadataData(i):this.resetThumbs(),null!=s.segmentsUrl?this.reqSegmentsVtt(s.segmentsUrl):null!=s.segments?"string"==typeof s.segments?this.reqSegmentsVtt(s.segments):this.parseSegmentsObject(s.segments):this.resetSegments(),null!=s.markersUrl?this.reqMarkersVtt(s.markersUrl):null!=s.markers?"string"==typeof s.markers?this.reqMarkersVtt(s.markers):this.parseMarkersObject(s.markers):this.resetMarkers(),this.updateState();}resetThumbs(){o.deleteField(this.state,"thumb"),this.state.has.thumb=!1,this.thumbnails=null;let t=this.thumbService;null!=t&&t.reset();}onThumbsMetadataData(t){let e=t.url;if(null==e)return void console.error("Cannot load external file. "+e);if(e.lastIndexOf("vtt")<0)return void console.error("Not .vtt file format. "+e+".");let s=e;if(null==t.imageBaseUrl){let t=e.split("/");t.pop(),s=t.join("/");}let i=new c(e);i.onError=$t(this,this.reportError);let n=this;i.onData=function(t){n.parseThumbs(s,t);},i.request();}parseThumbs(t,e){null!=t&&null!=e&&(this.thumbnails=new N(t).parse(e));}searchForThumbByTime(t){if(null!=this.thumbnails){let e=null,s=this.thumbnails.entries,i=0;for(;i<s.length;){let n=s[i];if(++i,t>=n.showTime&&t<=n.hideTime){let t=this.getThumbSize(n.source.w,n.source.h);e={url:n.source.url,x:n.source.x,y:n.source.y,w:t.w,h:t.h,style:{backgroundImage:"url("+n.source.url+")",backgroundPosition:"-"+n.source.x+"px -"+n.source.y+"px",backgroundRepeat:"no-repeat",backgroundColor:"#000",width:t.w+"px",height:t.h+"px"}};break}}this.updateStateThumb(e);}else null!=exports.thumbnailProvider?exports.thumbnailProvider(t,$t(this,this.updateStateWithThumbnail)):null!=this.thumbService?this.thumbService.searchForThumbByTime(t,$t(this,this.updateStateWithThumbnail)):this.updateStateThumb(null);}getThumbSize(t,e){let s={w:t,h:e},i=1;return null!=this.maxThumbSize&&(i=Math.min(1,Math.min(this.maxThumbSize.width/t,this.maxThumbSize.height/e))),1!=i&&(s.w=t*i|0,s.h=e*i|0),s}updateStateWithThumbnail(t){if(null!=t){let e=this.getThumbSize(t.width,t.height);this.updateStateThumb({url:t.url,x:0,y:0,w:e.w,h:e.h,style:{backgroundImage:"url("+t.url+")",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundColor:"#000",width:e.w+"px",height:e.h+"px"}}),this.updateState(),this.updatePopupSizes(),this.correctPopupPosition();}else this.updateStateThumb(null);this.updateState();}updateStateThumb(t){this.state.thumb=t,this.state.has.thumb=null!=this.state.thumb,null==this.state.thumb&&o.deleteField(this.state,"thumb"),this.state.has.thumb?this.state.popup.width=this.state.thumb.w+"px":this.state.popup.width=null;}resetSegments(){o.deleteField(this.state,"segment"),this.state.has.segment=!1,o.deleteField(this.state,"segments"),this.state.has.segments=!1,this.segments=null;}reqSegmentsVtt(t){let e=new c(t);e.onError=$t(this,this.reportError),e.onData=$t(this,this.parseSegmentsVtt),e.request();}parseSegmentsVtt(t){"string"==typeof t?(this.segments=(new L).parse(t),this.updateSegments(this.duration)):console.error("progress.segmentsUrl must be string");}parseSegmentsObject(t){if(!(t instanceof Array))return void console.error("progress.segments must be array");this.segments=[];let e,s=0,i=0,n=0,a=t,l=0;for(;l<a.length;){let t=a[l];++l,Object.prototype.hasOwnProperty.call(t,"duration")&&null!=t.duration&&(s=parseFloat(t.duration),null==s||s<=0||(e=new D,n=i+s,e.showTime=i,e.hideTime=n,e.duration=s,e.text=t.label,this.segments.push(e),i=e.hideTime));}this.updateSegments(this.duration),this.updateState();}searchForSegmentByTime(t){let e=null;if(null!=this.state.segments){let s=this.state.segments,i=0;for(;i<s.length;){let n=s[i];if(++i,t>n.time.show&&t<n.time.hide){e=n;break}}}this.state.segment=e,this.state.has.segment=null!=this.state.segment,null==this.state.segment&&o.deleteField(this.state,"segment");}searchForSegmentByEvent(t){return null!=t&&Object.prototype.hasOwnProperty.call(t,"segmentIndex")&&(this.state.segment=this.state.segments[o.field(t,"segmentIndex")],this.state.has.segment=null!=this.state.segment),this.state.has.segment}updateSegments(t){if(null!=this.segments){if(!isFinite(t)||t<=0)return;let e,s,i,n,a,l,r=[],o=this.segments,h=0;for(;h<o.length;){let u=o[h],c=h++;n=u.showTime,a=u.duration,l=u.hideTime,i=0==c?0:this.segments[c-1].hideTime;let d=(n-i)/t;e={type:"space",time:{show:i,duration:n-i,hide:n},width:isNaN(d)||!isFinite(d)?"0%":Math.max(0,Math.min(100,100*d))+"%",progressWidth:isNaN(0)||!isFinite(0)?"0%":Math.max(0,Math.min(100,0))+"%"},e.time.duration>0&&r.push(e);let p=a/t;if(s={type:"item",time:{show:n,duration:a,hide:l},text:u.text,width:isNaN(p)||!isFinite(p)?"0%":Math.max(0,Math.min(100,100*p))+"%",progressWidth:isNaN(0)||!isFinite(0)?"0%":Math.max(0,Math.min(100,0))+"%"},t>0&&l>t){s.time.duration=t-n,s.time.hide=t;let e=(t-n)/t;s.width=isNaN(e)||!isFinite(e)?"0%":Math.max(0,Math.min(100,100*e))+"%";}if(s.time.duration>0&&r.push(s),c==this.segments.length-1){let i=(t-s.time.hide)/t;e={type:"space",time:{show:s.time.hide,duration:t-s.time.hide,hide:t},width:isNaN(i)||!isFinite(i)?"0%":Math.max(0,Math.min(100,100*i))+"%",progressWidth:isNaN(0)||!isFinite(0)?"0%":Math.max(0,Math.min(100,0))+"%"},e.time.duration>0&&r.push(e);}}this.state.segments=r,this.state.has.segments=this.state.segments.length>0;}else this.resetSegments();}hasSegments(){return !(!Object.prototype.hasOwnProperty.call(this.state,"segments")||null==this.state.segments)&&this.state.segments instanceof Array}refreshSegments(t){if(!this.hasSegments())return;let e=0,s=this.state.segments;for(;e<s.length;){let i=s[e];++e;let n="0%";if(i.time.show<=t&&i.time.hide>=t){let e=(t-i.time.show)/i.time.duration;n=isNaN(e)||!isFinite(e)?"0%":Math.max(0,Math.min(100,100*e))+"%";}else i.time.hide<=t&&(n="100%");i.progressWidth!=n&&(i.progressWidth=n);}}resetMarkers(){this.state.has.marker=!1,o.deleteField(this.state,"marker"),this.state.has.markers=!1,o.deleteField(this.state,"markers"),this.markers=null;}reqMarkersVtt(t){let e=new c(t);e.onError=$t(this,this.reportError),e.onData=$t(this,this.parseMarkersVtt),e.request();}parseMarkersVtt(t){null!=t&&(this.markers=(new I).parse(t),this.updateMarkers(this.duration));}parseMarkersObject(t){if(!(t instanceof Array))return void console.error("progress.segments must be array");this.markers=[];let e,s=0,i=t,n=0;for(;n<i.length;){let t=i[n];++n,Object.prototype.hasOwnProperty.call(t,"time")&&null!=t.time&&(s=parseFloat(t.time),null==s||s<=0||(e=new M,e.showTime=s,e.text=Object.prototype.hasOwnProperty.call(t,"label")?o.field(t,"label"):null,this.markers.push(e)));}this.updateMarkers(this.duration),this.updateState();}searchForMarkerByTime(t){let e=null;if(null!=this.state.markers){let s=this.state.markers,i=0;for(;i<s.length;){let n=s[i];if(++i,n.time==t){e=n;break}}}this.state.marker=e,this.state.has.marker=null!=this.state.marker,null==this.state.marker&&o.deleteField(this.state,"marker");}searchForMarkerByEvent(t){return null!=t&&Object.prototype.hasOwnProperty.call(t,"markerIndex")&&(this.state.marker=this.state.markers[o.field(t,"markerIndex")],this.state.has.marker=null!=this.state.marker),this.state.has.marker}updateMarkers(t){let e;if(null!=this.markers){if(!isFinite(t)||t<=0)return;let s=[],i=0,n=this.markers;for(;i<n.length;){let a=n[i];++i;let l=a.showTime/t;e=isNaN(l)||!isFinite(l)?"0%":Math.max(0,Math.min(100,100*l))+"%",s.push({time:a.showTime,text:a.text,left:e});}this.state.markers=s,this.state.has.markers=this.state.markers.length>0;}else this.resetMarkers();}controlPopup(t){if(null==t)return this.unobservePopupElement(),this.popupElement=null,void(this.popupRect=null);this.popupElement=t;let e=null;e=this.popupElement.getBoundingClientRect(),this.popupRect=e,this.observePopupElement();}controlPopupBounds(t){if(null==t)return this.boundsElement=null,void(this.boundsRect=null);if(this.boundsElement=t,null!=this.boundsElement){let t=null;t=this.boundsElement.getBoundingClientRect(),this.boundsRect=t;}}observePopupElement(){let t=this,e=window;Object.prototype.hasOwnProperty.call(e,"ResizeObserver")&&(this.popupResizeObserver=new ResizeObserver((function(){let e=null;e=t.popupElement.getBoundingClientRect(),t.popupRect=e,t.correctPopupPosition();})),this.popupResizeObserver.observe(this.popupElement));}unobservePopupElement(){null!=this.popupResizeObserver&&this.popupResizeObserver.disconnect();}updatePopupData(t){if(null==t)return;let e=t/this.duration,s=isNaN(e)||!isFinite(e);if(this.state.popup.position=s?"0%":Math.max(0,Math.min(100,100*e))+"%",this.state.popup.bounds.offset="0px",this.isDvr){let e=this.duration-t,s={time:-e,text:"-"+It.formatTime(e)};if(this.isDvrWallTimeMode&&this.monitor.currentMedia instanceof x&&this.duration>0){let e=this.monitor.currentMedia;if(e.dvrWindowLength>0&&e.dvrWindowLiveEdge>0){let i={time:0,text:It.formatDateTime(new Date(1e3*(e.dvrWindowLiveEdge-e.dvrWindowLength*(1-t/this.duration))),0)};null!=i&&(s=i);}}this.state.popup.time=s.time,this.state.popup.text=s.text;}else this.state.popup.time=t,this.state.popup.text=It.formatTime(t),this.searchForThumbByTime(t),this.searchForMarkerByTime(t),this.searchForSegmentByTime(t);this.correctPopupPosition();}correctPopupPosition(){if(null==this.popupRect||null==this.handleMoveX)return;let t=this.popupRect.width/2,e=this.handleMoveX-this.boundsRect.left,s=this.handleMoveX-this.handleRect.left;if(e<t){let e=null!=this.boundsRect?this.handleRect.left-this.boundsRect.left:0,i=Math.abs(t-e);this.state.popup.position=i+"px",this.state.popup.bounds.offset=s-i+"px";}else if(null!=this.boundsRect&&e+t>this.boundsRect.width){let e=this.boundsRect.left-this.handleRect.left,i=this.boundsRect.width-this.handleRect.width,n=this.boundsRect.width-(e+i)-t;this.state.popup.position=n+"px",this.state.popup.bounds.offset=s-n+"px";}else this.state.popup.bounds.offset="0px";}updatePopupSizes(){if(null!=this.handleElement){let t=null;t=this.handleElement.getBoundingClientRect(),this.handleRect=t;}if(null!=this.boundsElement){let t=null;t=this.boundsElement.getBoundingClientRect(),this.boundsRect=t;}if(null!=this.popupElement){let t=null;t=this.popupElement.getBoundingClientRect(),this.popupRect=t;}}calculateProgressTime(){if(null==this.handleMoveX||null==this.handleRect)return 0;let t=0|this.handleRect.left,e=0|this.handleRect.width,s=(this.handleMoveX-t)/e*this.duration;return s>this.duration&&(s=0|this.duration),s<0&&(s=0),s}seekBackward(t){null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()),this.seekPositionBy=this.getSeekPositionBy(),null==this.seekedPosition&&(this.seekedPosition=this.current.position),this.seekedPosition=Math.max(0,this.seekedPosition-this.seekPositionBy),this.current.position=this.seekedPosition,this.updatePopupData(this.seekedPosition),this.state.popup.active=!0,this.updateState(),this.debounceSeekDispatch();}seekForward(t){null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()),this.seekPositionBy=this.getSeekPositionBy(),null==this.seekedPosition&&(this.seekedPosition=this.current.position),this.seekedPosition=Math.min(this.duration-1,this.seekedPosition+this.seekPositionBy),this.current.position=this.seekedPosition,this.updatePopupData(this.seekedPosition),this.state.popup.active=!0,this.updateState(),this.debounceSeekDispatch();}getSeekPositionBy(){return null==this.seekPositionBy&&(this.seekPositionBy=0),Math.min(this.seekPositionBy+5,.05*this.duration)}debounceSeekDispatch(){if(null!=this.dispatchSeekDelay&&this.dispatchSeekDelay.stop(),null==this.seekedPosition)return;let t=this;this.dispatchSeekDelay=Ft.delay((function(){t.dispatchSeekDelay=null,t.dispatchSeek(t.seekedPosition),t.seekPositionBy=null,t.seekedPosition=null,t.hidePopupAfterSeek();}),250);}hidePopupAfterSeek(){null!=this.hidePopupDelay&&this.hidePopupDelay.stop();let t=this;this.hidePopupDelay=Ft.delay((function(){t.hidePopupDelay=null,t.state.popup.active=!1,t.updateState();}),2500);}}rt.__name__="bs.player.plugin.skin.model.progress.ProgressModel",rt.__super__=q,Object.assign(rt.prototype,{__class__:rt});class ot extends B{constructor(t,e,s,i){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i);}_hx_constructor(t,e,s,i){this.activeQualityData="-1",super._hx_constructor(t,e,s,i);let n,a=Mt.syncWithHideUIElements(e,"qualitySelection","qualitySelectionEnabled");if(Object.prototype.hasOwnProperty.call(a,"qualitySelectionEnabled"))switch(o.field(a,"qualitySelectionEnabled")){case 0:case"false":case!1:n=!1;break;default:n=!0;}else n=!0;this.enabled=n,this.state={name:"quality",hasItems:!1,activate:null,value:null},this.enabled&&(this.state.activate=$t(this,this.activate)),this.enabled&&(m.add(t,"videoQualityData",$t(this,this.onQualityData)),m.add(t,"videoQualityPlaybackLevelChange",$t(this,this.onQualityPlaybackLevelChange)),p.add(t,"videoQualityHasChanged",$t(this,this.onQualityChange))),this.refreshCallback(this.state);}destroy(){super.destroy(),this.enabled&&(m.remove(this.context,"videoQualityData",$t(this,this.onQualityData)),m.remove(this.context,"videoQualityPlaybackLevelChange",$t(this,this.onQualityPlaybackLevelChange)),p.remove(this.context,"videoQualityHasChanged",$t(this,this.onQualityChange)));}dispatch(t){let e=new p("requestVideoQualityChange");e.data=t.data,e.dispatch(this.context);}activate(t){if(0==this.enabled)return;null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault());let e=h.parseInt(Ut.__cast(t.target,HTMLElement).getAttribute("data-item-index"));isNaN(e)||this.dispatch(this.state.items[e]);}onQualityPlaybackLevelChange(t){let e=""+t.data;if(!this.state.hasItems)return;let s=this.findItemByData(e);this.activeQualityData==e?this.setAutoSubLabel(null):this.setAutoSubLabel("("+s.label+")"),this.state.value=s.label,this.refreshCallback(this.state);}setAutoSubLabel(t){let e=0,s=this.state.items;for(;e<s.length;){let i=s[e];if(++e,"-1"==i.data){i.sublabel=t;break}}}findItemByData(t){let e=0,s=this.state.items;for(;e<s.length;){let i=s[e];if(++e,i.data==t)return i}return null}onQualityData(t){let e=t.data;this.items=[];let s=0;for(;s<e.length;){let t=e[s];++s,t.label=It.capilizeFirstLetter(t.label),this.items.push(t);}0!=this.enabled&&(this.updateStateItems(),this.refreshCallback(this.state));}updateStateItems(){this.state.hasItems=null!=this.items&&this.items.length>0,this.state.hasItems&&(this.state.items=this.items);}updateActiveQuality(){if(!this.state.hasItems||null==this.activeQualityData)return;let t=0,e=this.state.items;for(;t<e.length;){let s=e[t];++t,s.active=o.field(s,"data")==this.activeQualityData;}}onQualityChange(t){this.activeQualityData=t.data,0!=this.enabled&&(this.updateActiveQuality(),this.refreshCallback(this.state));}}ot.__name__="bs.player.plugin.skin.model.quality.QualityModel",ot.__super__=B,Object.assign(ot.prototype,{__class__:ot});class ht extends B{constructor(t,e,s,i,n,a,l){super(t,e,s,i),this.prefix=n,this.parentElement=a,this.plugin=r.exists(l,(function(t){return "QuanteecPlugin"==t.getPluginName()}))?r.find(l,(function(t){return "QuanteecPlugin"==t.getPluginName()})):null,this.state=null,this.refreshCallback(this.state);}postActivate(){let t;super.postActivate();let e=this.plugin;if(null!=e&&e.hasValidConfig()){let e=this.plugin;t=null!=e?e.hideInUi():null;}else t=!0;t||(this.state=this.createState(),this.refreshCallback(this.state));}createState(){let t=this.plugin;if(null!=(null!=t?t.renderer:null)){let t=this.plugin.renderer.getLogoSvgString(24,24),e=this.plugin;return {icon:t,click:null!=e&&e.hasValidStreamboostConfig()?$t(this,this.openStreamboostPanel):$t(this,this.openQuanteecStatsWindow)}}return null}openQuanteecStatsWindow(){let t=this.plugin,e=null!=t?t.renderer:null;if(null==e)return;let s=new f("showMessage");s.data={type:"normal",title:e.getStatsTitleString(this.prefix),text:e.getStatsContentString(this.prefix),onAfterShow:$t(e,e.startRenderingStats),onAfterClose:$t(e,e.cleanupStats),close:!0,style:{window:{minWidth:"380px",width:"380px",maxWidth:"380px",backgroundColor:"#000",pointerEvents:"all"},overlay:{height:"90%",background:"none",backdropFilter:"none",pointerEvents:"none"}}},s.dispatch(this.context);}openStreamboostPanel(){let t;if(null!=this.parentElement){let e=this.plugin;t=null==(null!=e?e.renderer:null);}else t=!0;t||(this.panelElement=this.plugin.renderer.createStreamboostPanelElement($t(this,this.closeStreamboostPanel)),null!=this.panelElement&&(null==this.panelStyleElement&&(this.panelStyleElement=this.plugin.renderer.createStreamboostPanelStyleElement(),this.parentElement.appendChild(this.panelStyleElement)),this.parentElement.appendChild(this.panelElement)));}closeStreamboostPanel(t){if(null!=this.panelElement){let t=this.parentElement;null!=t&&t.removeChild(this.panelElement);}if(this.panelElement=null,null!=this.panelStyleElement){let t=this.parentElement;null!=t&&t.removeChild(this.panelStyleElement);}this.panelStyleElement=null;}}ht.__name__="bs.player.plugin.skin.model.quanteec.QuanteecModel",ht.__super__=B,Object.assign(ht.prototype,{__class__:ht});class ut extends B{constructor(t,e,s,i,n,a){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i,n,a);}_hx_constructor(t,e,s,i,n,a){this.resizeObserver=null,this.BREAKPOINT_PX=[0,320,576,768,992,1200,1400],this.BREAKPOINT_KEYS=["xxs","xs","sm","md","lg","xl","xxl"],this.BREAKPOINT_LENGTH=7,super._hx_constructor(t,e,s,i),this.observeElement=a,this.cssPrefix=n,this.state={width:NaN,height:NaN,current:"xxs",gt:{xxs:!0,xs:!1,sm:!1,md:!1,lg:!1,xl:!1,xxl:!1},lt:{xxs:!1,xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0}};let l=this.observeElement.ownerDocument;"complete"==l.readyState?this.onReady():l.addEventListener("readystatechange",$t(this,this.onReady));}set_prefix(t){return this.cssPrefix=t,this.update(),this.refreshCallback(this.state),this.cssPrefix}destroy(){super.destroy(),this.observeElement.ownerDocument.removeEventListener("readystatechange",$t(this,this.onReady)),null!=this.resizeObserver&&this.resizeObserver.disconnect(),null!=this.timer&&this.timer.stop();}onReady(t){this.observeElement.ownerDocument.removeEventListener("readystatechange",$t(this,this.onReady)),this.observe();}observe(){let t=window;if(Object.prototype.hasOwnProperty.call(t,"ResizeObserver"))return this.resizeObserver=new ResizeObserver($t(this,this.onResizeObserver)),void this.resizeObserver.observe(this.observeElement);let e=this,s=function(){let t=null;t=e.observeElement.getBoundingClientRect();let s=t;e.updateSize(s.width,s.height);};s(),this.timer=new Ft(500),this.timer.run=s;}onResizeObserver(t){let e=NaN,s=NaN,i=0;for(;i<t.length;){let n=t[i];if(++i,n.contentRect)e=n.contentRect.width,s=n.contentRect.height;else if(n.contentBoxSize){let t=n.contentBoxSize instanceof Array?n.contentBoxSize[0]:n.contentBoxSize;e=t.inlineSize,s=t.blockSize;}}let n=e,a=s;n<1||a<1||this.updateSize(n,a);}updateSize(t,e){let s=!1;if(this.state.width!=t&&(this.state.width=t,s=!0),this.state.height!=e&&(this.state.height=e,s=!0),s){this.update(),this.refreshCallback(this.state);let t=new b("resize");t.data=this.state,t.dispatch(this.context);}}update(){let t="",e=[],s=[],i=NaN,n="",a="",l="",r=0,o=this.BREAKPOINT_LENGTH;for(;r<o;){let o=r++;t=this.BREAKPOINT_KEYS[o],i=this.BREAKPOINT_PX[o],a=this.cssPrefix+"-gt-"+t,l=this.cssPrefix+"-lt-"+t,s.push(this.cssPrefix+"-is-"+t),i<this.state.width?(this.state.gt[t]=!0,this.state.lt[t]=!1,n=t,e.push(a),s.push(l)):(this.state.gt[t]=!1,this.state.lt[t]=!0,e.push(l),s.push(a));}""!=n&&e.push(this.cssPrefix+"-is-"+n),this.state.current=n,this.observeElement.classList.remove(...s),this.observeElement.classList.add(...e);}}ut.__name__="bs.player.plugin.skin.model.size.SizeModel",ut.__super__=B,Object.assign(ut.prototype,{__class__:ut});class ct extends B{constructor(t,e,s,i){super(t,e,s,i),this.state={ctrl:$t(this,this.ctrl)},this.refreshCallback(this.state);}renderHtml(t){}ctrl(t){null!=t&&this.renderHtml(t);}}ct.__name__="bs.player.plugin.skin.model.spinner.SpinnerModel",ct.__super__=B,Object.assign(ct.prototype,{__class__:ct});class dt extends q{constructor(t,e,s,i){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i);}_hx_constructor(t,e,s,i){this.seekFromPosition=NaN,super._hx_constructor(t,e,s,i),this.state={show:{start:!1,actions:!1,state:!1,buttons:!1,end:!1},can:{backward:!1,forward:!1},start:{type:"image"},actions:{seek:{offset:0,animate:!1,countBackward:null,countForward:null,backward:null,forward:null,reset:null},btns:{animate:!1,enabled:!1,countBackward:null,countForward:null,seekBackward:null,seekForward:null},click:null,reset:null},state:{type:"standard"},end:{type:"standard",playNext:null}};let n=this;this.state.actions.seek.countBackward=function(t){n._handleSeekCount(-1,"splash",t);};let a=this;this.state.actions.seek.countForward=function(t){a._handleSeekCount(1,"splash",t);};let l=this;this.state.actions.seek.backward=function(t){l._handleSeekEmit(-1,"splash",t);};let r=this;this.state.actions.seek.forward=function(t){r._handleSeekEmit(1,"splash",t);},this.state.actions.seek.reset=$t(this,this._handleActionsSeekReset);let o=this;this.state.actions.btns.countBackward=function(t){o._handleSeekCount(-1,"splashButton",t);};let h=this;this.state.actions.btns.countForward=function(t){h._handleSeekCount(1,"splashButton",t);};let u=this;this.state.actions.btns.seekBackward=function(t){u._handleSeekEmit(-1,"splashButton",t);};let c=this;this.state.actions.btns.seekForward=function(t){c._handleSeekEmit(1,"splashButton",t);},this.state.actions.click=$t(this,this._handleActionsClick),this.state.actions.reset=$t(this,this._handleActionsReset),this.state.end.playNext=$t(this,this.playNext),this.parseVars(e),m.add(t,"mediaPlaylistData",$t(this,this.onPlaylistData)),p.add(t,"skinSeek",$t(this,this.onSeekEvent)),this.updateState();}destroy(){super.destroy(),m.remove(this.context,"mediaPlaylistData",$t(this,this.onPlaylistData)),p.remove(this.context,"skinSeek",$t(this,this.onSeekEvent)),this.cleanEndState();}onSeekEvent(t){let e,s=t.data.seekSource,i=!1,n=Math.round(t.data.seekedPosition-this.seekFromPosition);switch(this.state.actions.seek.offset!=n&&(this.state.actions.seek.offset=n,i=!0),s){case"jsapi":case"keyboard":case"splash":e=!0;break;default:e=!1;}if(e){let t=this.seekFromPosition;isNaN(t)&&(this.seekFromPosition=this.current.position);}else this.seekFromPosition=NaN,0!=this.state.actions.seek.offset&&(this.state.actions.seek.offset=0,i=!0);this.state.actions.seek.animate!=e&&(this.state.actions.seek.animate=e,i=!0);let a="splashButton"==s;this.state.actions.btns.animate!=a&&(this.state.actions.btns.animate=a,i=!0),i&&this.updateState();}_handleSeekCount(t,e,s){let i=null!=s.detail&&Object.prototype.hasOwnProperty.call(s.detail,"count")?o.field(s.detail,"count"):1;if(0==i)return void this._handleActionsSeekReset();let n="splashButton"==e?0:1,a=!1;if(i>n){let e=Math.round(10*Math.max(1,i-n))*t;this.state.actions.seek.offset!=e&&(this.state.actions.seek.offset=e,a=!0);}let l="splash"==e;this.state.actions.seek.animate!=l&&(this.state.actions.seek.animate=l,a=!0);let r="splashButton"==e;this.state.actions.btns.animate!=r&&(this.state.actions.btns.animate=r,a=!0),a&&this.updateState();}_handleSeekEmit(t,e,s){let i=null!=s.detail&&Object.prototype.hasOwnProperty.call(s.detail,"count")?o.field(s.detail,"count"):1;if(null==i||isNaN(i))return;let n=Math.round(10*Math.max(1,i-("splashButton"==e?0:1)))*t;if(isNaN(n))return;let a=Math.max(0,Math.min(this.get_maxDuration(),this.current.position+n));if(isNaN(a))return;null!=s&&(s.stopImmediatePropagation(),s.stopPropagation(),s.preventDefault());let l=new p("skinSeek");l.data={seekedPosition:a,seekSource:e},l.dispatch(this.context);}_handleActionsSeekReset(){this.seekFromPosition=NaN,this.state.actions.seek.offset=0,this.updateState();}_handleActionsClick(t){if(null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()),!this.state.show.buttons)return this.state.actions.btns.enabled?void new p("skinPlayPause").dispatch(this.context):(this.state.actions.btns.enabled=!0,void this.updateState());new p("skinPlayPause").dispatch(this.context);}_handleActionsReset(){this.state.actions.btns.enabled&&(this.state.actions.btns.enabled=!1,this.updateState());}parseVars(t){let e=null;Object.prototype.hasOwnProperty.call(t,"startSplash")&&(e=o.field(t,"startSplash")),null!=e&&(this.state.start.type="image");let s=null;Object.prototype.hasOwnProperty.call(t,"endSplash")&&(s=o.field(t,"endSplash"));let i=s;if(null!=i)if(null==i)this.state.end.type="standard";else switch(i){case"countdown":this.state.end.type="countdown";break;case"tiles":this.state.end.type="tiles";break;default:this.state.end.type="standard";}}updateState(t){super.updateState(t);let e=!(this.isComplete||this.isSeeking||this.isBuffering||this.duration>1&&!(this.current.time<this.duration));this.state.show.start=e&&!this.isPlaying&&!this.hasPlaybackStarted&&null!=this.state.start.image&&null!=this.state.start.image.url,this.state.show.state=this.isInited&&e,this.state.show.end=!this.isPlaying&&this.isComplete&&!this.isSeeking&&!this.isBuffering,this.state.show.actions=this.isInited&&!this.state.show.end,this.state.show.buttons=this.state.show.state&&this.isInited&&!this.isPlaying||this.isPaused,this.state.can.backward=this.current.position>0,this.state.can.forward=this.duration>1&&this.current.position<this.duration,this.refreshCallback(this.state);}onMetadataData(t){this.hasPlaybackStarted=!1,this.cleanEndState();let e=this.monitor.currentMedia;null!=e&&null!=e.splashImages&&e.splashImages.length>0?this.state.start.image=Ct.imageToState(e.splashImages):o.deleteField(this.state,"image"),super.onMetadataData(t),this.checkEndStateThankYouImage();}onSeekingEnd(t){let e;if(1==this.state.show.end)switch(this.state.end.type){case"countdown":e=null==this.state.end.countdown||null==this.state.end.standard;break;case"image":e=null==this.state.end.image;break;case"reload":case"standard":default:e=null==this.state.end.standard;break;case"tiles":e=null==this.state.end.tiles||null==this.state.end.standard;}else e=!1;e?this.refreshEndState():this.updateState();}cleanEndState(){null!=this.tiles&&this.tiles.destroy(),this.tiles=null,null!=this.countdown&&this.countdown.destroy(),this.countdown=null,o.deleteField(this.state.end,"nextMedia"),o.deleteField(this.state.end,"standard"),o.deleteField(this.state.end,"countdown"),o.deleteField(this.state.end,"tiles"),o.deleteField(this.state.end,"image");}refreshEndState(){let t=null!=this.mediaPlaylist&&this.mediaPlaylist.hasNext();this.cleanEndState();let e=this;switch(this.state.end.type){case"countdown":t?(this.updateNextMediaState(),this.countdown=new pt(this.context,null,(function(t,s){e.state.end.countdown=t,e.updateState();}),$t(this,this.reportError),$t(this,this.playNext))):(this.updateNextMediaState(),this.initStandardEndsplash());break;case"image":this.updateNextMediaState(),this.checkEndStateThankYouImage();break;case"reload":case"standard":default:this.updateNextMediaState(),this.initStandardEndsplash();break;case"tiles":t?this.tiles=new mt(this.context,null,(function(t,s){e.state.end.tiles=t,e.updateState();}),$t(this,this.reportError),this.mediaPlaylist.items.length):(this.updateNextMediaState(),this.initStandardEndsplash());}}updateNextMediaState(){if(this.mediaPlaylist.hasNext()){let t=this.mediaPlaylist.items[this.mediaPlaylist.currentPos+1],e={};null!=t.title&&(e.title=t.title),null!=t.splashImages&&t.splashImages.length>0&&(e.image=Ct.imageToState(t.splashImages)),null!=t.duration&&(e.duration={time:t.duration,text:It.formatTime(t.duration)}),o.fields(e).length>0?this.state.end.nextMedia=e:o.deleteField(this.state.end,"nextMedia");}else o.deleteField(this.state.end,"nextMedia");}onPlaying(t){if(this.isLiveStream){let t=this.monitor.currentMedia.streamWaitingForTransmissionImageUrl;if(null!=t&&""!=t){let e=new P;e.url=t,this.state.state.image=Ct.imageToState([e]),this.state.state.type="image";}}super.onPlaying(t);}onCurrentTimeChange(t){"standard"!=this.state.state.type&&(o.deleteField(this.state.state,"image"),this.state.state.type="standard"),super.onCurrentTimeChange(t);}onComplete(t){this.refreshEndState(),super.onComplete(t);}onPlaylistData(t){this.mediaPlaylist=E.clone(t.data);}playNext(t){null!=t&&null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault());let e=null!=this.mediaPlaylist&&this.mediaPlaylist.hasNext()?this.mediaPlaylist.next():null;null==e||null==e.mediaLandingPage||""==e.mediaLandingPage?at.play(this.context,e,this.mediaPlaylist):window.open(e.mediaLandingPage,"_self");}initStandardEndsplash(){this.state.end.standard={replay:!0};}checkEndStateThankYouImage(){if(this.isLiveStream){let t=this.monitor.currentMedia.streamEndThankYouImageUrl;if(null!=t&&""!=t){let e=new P;e.url=t,this.state.end.image=Ct.imageToState([e]),this.state.end.type="image",this.updateState();}}}}dt.__name__="bs.player.plugin.skin.model.splash.SplashModel",dt.__super__=q,Object.assign(dt.prototype,{__class__:dt});class pt extends B{constructor(t,e,s,i,n){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i,n);}_hx_constructor(t,e,s,i,n){this.counter=10,super._hx_constructor(t,e,s,i),this.onComplete=n,this.state={timer:10},this.refreshCallback(this.state),this.stopCountdown(),this.timer=new Ft(1e3),this.timer.run=$t(this,this.onCountdown);}destroy(){super.destroy(),null!=this.timer&&this.timer.stop();}onCountdown(){this.counter--,this.state.timer=this.counter,this.refreshCallback(this.state),this.counter>0||this.handleCoundown();}stopCountdown(){this.counter=10,null!=this.timer&&this.timer.stop(),this.timer=null;}handleCoundown(t){this.stopCountdown(),this.onComplete(t);}}pt.__name__="bs.player.plugin.skin.model.splash.end.SplashEndCountdownModel",pt.__super__=B,Object.assign(pt.prototype,{__class__:pt});class mt extends B{constructor(t,e,s,i,n){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i,n);}_hx_constructor(t,e,s,i,n){this.tileHeight=0,this.tileWidth=0,this.gridHeight=0,this.gridWidth=0,this.maxTilesCount=0,this.rafId=0,super._hx_constructor(t,e,s,i),this.mediaPlaylistCount=n,this.maxTilesCount=0|Math.max(1,Math.min(12,n)),this.state={count:1,grid:{columns:1,rows:1,ctrl:null},playlist:{from:0,to:1},page:{current:1,total:1,next:null,prev:null}},this.state.count=n,this.state.grid.ctrl=$t(this,this.gridCtrl),this.state.page.next=$t(this,this.nextPage),this.state.page.prev=$t(this,this.prevPage),b.add(t,"resize",$t(this,this.onResize)),this.refreshCallback(this.state);}destroy(){super.destroy(),b.remove(this.context,"resize",$t(this,this.onResize)),this.cleanupTilesGrid();}onResize(t){this.setupTilesGrid();}nextPage(t){this.state.page.current!=this.state.page.total&&(this.state.page.current++,this.updateEndTilesGridPlaylist(),this.refreshCallback(this.state));}prevPage(t){1!=this.state.page.current&&(this.state.page.current--,this.updateEndTilesGridPlaylist(),this.refreshCallback(this.state));}gridCtrl(t){this.gridElement=t,this.tileElement=null!=this.gridElement&&null!=this.gridElement.firstElementChild?this.gridElement.firstElementChild:null,this.cleanupTilesGrid();let e=$t(this,this.setupTilesGrid),s=-1;s=window.requestAnimationFrame((function(t){e();})),this.rafId=s,this.timer=new Ft(250),this.timer.run=$t(this,this.setupTilesGrid);}updateEndTilesGridPlaylist(){let t=this.state.grid.columns*this.state.grid.rows,e=this.state.page.current;this.state.playlist.from=t*(e-1),this.state.playlist.to=t*e-1;}cleanupTilesGrid(){if(null!=this.rafId){let t=this.rafId;null==t||isNaN(t)||window.cancelAnimationFrame(t);}this.rafId=null,null!=this.timer&&this.timer.stop(),this.timer=null;}setupTilesGrid(){if(this.cleanupTilesGrid(),null==this.gridElement||null==this.gridElement.firstElementChild)return;let t=this.gridElement.style.maxWidth;this.gridElement.style.maxWidth="unset";let e=null;e=this.gridElement.getBoundingClientRect();let s=e,i=null;i=this.gridElement.firstElementChild.getBoundingClientRect();let n=i;if(this.gridElement.style.maxWidth=t,this.gridWidth==s.width&&this.gridHeight==s.height&&this.tileWidth==n.width&&this.tileHeight==n.height)return;this.gridWidth=s.width,this.gridHeight=s.height,this.tileWidth=n.width,this.tileHeight=n.height;let a=Math.floor(Math.max(1,Math.min(Math.min(4,this.maxTilesCount),this.gridWidth/(this.tileWidth+2)))),l=Math.floor(Math.max(1,Math.min(3,this.gridHeight/this.tileHeight)));this.state.page.current=1,this.state.page.total=Math.ceil(this.mediaPlaylistCount/(a*l)),this.state.grid.columns=a,this.state.grid.rows=l,this.updateEndTilesGridPlaylist(),this.gridElement.style.maxWidth=Math.ceil((this.tileWidth+2)*a)+"px",this.refreshCallback(this.state);}}mt.__name__="bs.player.plugin.skin.model.splash.end.SplashEndTilesModel",mt.__super__=B,Object.assign(mt.prototype,{__class__:mt});class ft extends B{constructor(t,e,s,i){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i);}_hx_constructor(t,e,s,i){this.subtitlesSets=[],super._hx_constructor(t,e,s,i),this.languageCode=Mt.subtitles(e),this.state={name:"subtitles",hasItems:!1,activate:null},0!=St.subtitleSelectionVisible(e)&&(this.state.activate=$t(this,this.activate),m.add(t,"subtitleData",$t(this,this.onSubtitleData)),m.add(t,"mediaMetadataData",$t(this,this.cleanupState)),this.refreshCallback(this.state));}destroy(){super.destroy(),m.remove(this.context,"subtitleData",$t(this,this.onSubtitleData)),m.remove(this.context,"mediaMetadataData",$t(this,this.cleanupState));}onSubtitleData(t){this.subtitlesSets=t.data;let e,s=this.subtitlesSets;if(null!=s){let t=$t(this,this.formatStateItemFromSubtitlesSets),i=new Array(s.length),n=0,a=s.length;for(;n<a;){let e=n++;i[e]=t(s[e]);}e=i;}else e=null;let i=null!=e?Et.ensureSingleActiveListItem(e):null;this.state.items=i;let n=this.state.items;this.state.hasItems=(null!=n?n.length:null)>0;let a=this.findActiveSubtitlesSet(this.subtitlesSets);this.state.hasItems&&this.state.items.push(this.formatStateItemFromDisablingSubtitles(null==a)),this.dispatchSelectSubtitlesEvent(a);let l=null!=a?a.languageCode:null;if(null!=l){let t=!1,e=null;if(e=Ht.getSessionStorage(),t=null!=e,t)try{if(null==l){let t=null;t=Ht.getSessionStorage(),t.removeItem("_brplayer_sub_lang");}else {let t=null;t=Ht.getSessionStorage(),t.setItem("_brplayer_sub_lang",h.string(l));}}catch(t){console.warn("Error occured durring writing subtitles language into session storage.");}}this.refreshCallback(this.state);}formatStateItemFromDisablingSubtitles(t){return {active:t,label:It.translate("subtitles_disable"),data:"off"}}formatStateItemFromSubtitlesSets(t){let e=this.isSubtitlesSetActive(t),s=t.name;return {active:e,label:It.capilizeFirstLetter(null!=s?s:t.languageCode),data:t.languageCode}}isSubtitlesSetActive(t){return !!t.preselected||this.languageCode==t.languageCode}findActiveSubtitlesSet(t){if(null!=t){let e=$t(this,this.isSubtitlesSetActive),s=[],i=0;for(;i<t.length;){let n=t[i];++i,e(n)&&s.push(n);}return s.shift()}return null}dispatchSelectSubtitlesEvent(t){let e=new p("selectSubtitles");e.data=t,e.dispatch(this.context);}cleanupState(t){this.subtitlesSets=[],o.deleteField(this.state,"items"),this.refreshCallback(this.state);}selectActiveItemByIndex(t){let e=0,s=this.state.items.length;for(;e<s;){let s=e++;this.state.items[s].active=s==t;}}unselectActiveItemByIndex(t){this.state.items[t].active=!1,this.state.items[this.state.items.length-1].active=!0;}activate(t){if(!Object.prototype.hasOwnProperty.call(this.state,"items"))return;null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault());let e=h.parseInt(Ut.__cast(t.target,HTMLElement).getAttribute("data-item-index"));isNaN(e)||(this.state.items[e].active?(this.unselectActiveItemByIndex(e),this.dispatchSelectSubtitlesEvent(null)):(this.selectActiveItemByIndex(e),this.dispatchSelectSubtitlesEvent(this.subtitlesSets[e])),this.refreshCallback(this.state));}}ft.__name__="bs.player.plugin.skin.model.subtitles.SubtitlesModel",ft.__super__=B,Object.assign(ft.prototype,{__class__:ft});class gt extends B{constructor(t,e,s,i){super(t,e,s,i),m.add(t,"mediaMetadataData",$t(this,this.onMetadataData));}destroy(){super.destroy(),m.remove(this.context,"mediaMetadataData",$t(this,this.onMetadataData));}onMetadataData(t){if(null==t||null==t.data)return this.state=null,void this.refreshCallback(this.state);let e=t.data;e.title!=this.state&&(this.state=e.title,this.refreshCallback(this.state));}}gt.__name__="bs.player.plugin.skin.model.title.TitleModel",gt.__super__=B,Object.assign(gt.prototype,{__class__:gt});class vt extends q{constructor(t,e,s,i,n,a){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i,n,a);}_hx_constructor(t,e,s,i,n,a){this.showForcedSpinner=!1,super._hx_constructor(t,e,s,i),this.cssPrefix=n,this.skinElement=a,this.resetState(),f.add(t,"showBufferSpinner",$t(this,this.onShowSpinner)),f.add(t,"hideBufferSpinner",$t(this,this.onHideSpinner)),this.refreshCallback(this.state);}set_prefix(t){return this.cssPrefix=t,null!=this.cssPrefix&&""!=this.cssPrefix&&(this.updateSkinCss(),this.refreshCallback(this.state)),this.cssPrefix}destroy(){super.destroy(),this.resetState(),f.remove(this.context,"showBufferSpinner",$t(this,this.onShowSpinner)),f.remove(this.context,"hideBufferSpinner",$t(this,this.onHideSpinner));}resetState(){this.showForcedSpinner=!1,this.state={current:{time:0,text:It.formatTime(0)},duration:{time:0,text:It.formatTime(0)},status:{inited:!1,playing:!1,paused:!1,buffering:!1,seeking:!1,complete:!1,live:!1,dvr:!1,seekable:!0},playPause:null,seekEnd:null,replay:null};let t=this;this.state.playPause=function(e){null!=e&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()),new p("skinPlayPause").dispatch(t.context);};this.state.seekEnd=function(e){null!=e&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault());let s=new p("skinSeek");s.data={seekedPosition:t.duration,seekSource:"syncLive"},s.dispatch(t.context);};this.state.replay=function(e){null!=e&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault());let s=new p("skinSeek");s.data={seekedPosition:0,seekSource:"syncLive"},s.dispatch(t.context),new p("skinPlayPause").dispatch(t.context);};}updateState(t){if(super.updateState(t),this.isDvr)if(this.isDvrWallTimeMode&&null!=this.monitor.currentMedia.mediaPlaybackInfo&&this.monitor.currentMedia.mediaPlaybackInfo.currentTime>0){let t={time:0,text:It.formatDateTime(new Date(1e3*this.monitor.currentMedia.mediaPlaybackInfo.currentTime),0)};this.state.dvrTime=t;let e=this.current.playback;this.state.current={time:e,text:It.formatTime(e)};}else {this.state.dvrTime=null;let t=this.duration-this.current.time;this.state.current={time:-t,text:"-"+It.formatTime(t)};}else {this.state.dvrTime=null;let t=this.isComplete?this.duration:this.current.time;this.state.current={time:t,text:It.formatTime(t)};}let e=this.duration;this.state.duration={time:e,text:It.formatTime(e)},(this.isPlaying||this.isComplete)&&(this.showForcedSpinner=!1),this.state.status.inited=this.isInited,this.state.status.playing=this.isPlaying,this.state.status.paused=this.isPaused,this.state.status.buffering=this.isBuffering||this.showForcedSpinner,this.state.status.seeking=this.isSeeking,this.state.status.complete=this.isComplete,this.state.status.live=this.isLive,this.state.status.dvr=this.isDvr,this.state.status.seekable=this.isSeekable,this.updateSkinCss(),this.refreshCallback(this.state);}updateSkinCss(){if(null==this.cssPrefix)return;let t=[],e=[];if(this.isLive?(t.push(this.cssPrefix+"-is-live"),e.push(this.cssPrefix+"-not-live")):(t.push(this.cssPrefix+"-not-live"),e.push(this.cssPrefix+"-is-live")),this.isDvr?(t.push(this.cssPrefix+"-is-dvr"),e.push(this.cssPrefix+"-not-dvr")):(t.push(this.cssPrefix+"-not-dvr"),e.push(this.cssPrefix+"-is-dvr")),this.isSeekable?(t.push(this.cssPrefix+"-is-seekable"),e.push(this.cssPrefix+"-not-seekable")):(t.push(this.cssPrefix+"-not-seekable"),e.push(this.cssPrefix+"-is-seekable")),e.length>0){let t=[],s=0;for(;s<e.length;){let i=e[s];++s,1==this.skinElement.classList.contains(i)&&t.push(i);}t.length>0&&this.skinElement.classList.remove(...t);}if(t.length>0){let e=[],s=0;for(;s<t.length;){let i=t[s];++s,0==this.skinElement.classList.contains(i)&&e.push(i);}e.length>0&&this.skinElement.classList.add(...e);}}onShowSpinner(t){0==this.showForcedSpinner&&(this.showForcedSpinner=!0,this.updateState());}onHideSpinner(t){1==this.showForcedSpinner&&(this.showForcedSpinner=!1,this.updateState());}}vt.__name__="bs.player.plugin.skin.model.video.VideoModel",vt.__super__=q,Object.assign(vt.prototype,{__class__:vt});class bt extends B{constructor(t,e,s,i){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i);}_hx_constructor(t,e,s,i){this.videoSets=[],super._hx_constructor(t,e,s,i),this.state={name:"video",hasItems:!1,activate:null},this.state.activate=$t(this,this.activate),m.add(t,"videoTrackData",$t(this,this.onVideoTrackData)),m.add(t,"mediaMetadataData",$t(this,this.cleanupState)),this.refreshCallback(this.state);}destroy(){super.destroy(),m.remove(this.context,"videoTrackData",$t(this,this.onVideoTrackData)),m.remove(this.context,"mediaMetadataData",$t(this,this.cleanupState));}onVideoTrackData(t){this.videoSets=t.data;let e,s=this.videoSets;if(null!=s){let t=$t(this,this.formatStateItemFromVideoSet),i=new Array(s.length),n=0,a=s.length;for(;n<a;){let e=n++;i[e]=t(s[e]);}e=i;}else e=null;let i=null!=e?Et.ensureSingleActiveListItem(e):null;this.state.items=i;let n=this.state.items,a=(null!=n?n.length:null)>0;this.state.hasItems=null!=a&&a,this.dispatchSelectVideoTrackEvent(this.findActiveVideoSet(this.videoSets)),this.refreshCallback(this.state);}formatStateItemFromVideoSet(t){let e=this.isVideoSetActive(t),s=t.name;return {active:e,label:It.capilizeFirstLetter(null!=s?s:t.languageCode),data:t.id}}isVideoSetActive(t){return t.preselected}findActiveVideoSet(t){if(null!=t){let e=$t(this,this.isVideoSetActive),s=[],i=0;for(;i<t.length;){let n=t[i];++i,e(n)&&s.push(n);}return s.shift()}return null}dispatchSelectVideoTrackEvent(t){if(null==t)return;let e=new p("selectVideoTrack");e.data=t,e.dispatch(this.context);}cleanupState(t){this.videoSets=[],o.deleteField(this.state,"items"),this.refreshCallback(this.state);}selectActiveItemByIndex(t){let e=0,s=this.state.items.length;for(;e<s;){let s=e++;this.state.items[s].active=s==t;}}activate(t){if(!Object.prototype.hasOwnProperty.call(this.state,"items"))return;null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault());let e=h.parseInt(Ut.__cast(t.target,HTMLElement).getAttribute("data-item-index"));isNaN(e)||(this.selectActiveItemByIndex(e),this.dispatchSelectVideoTrackEvent(this.videoSets[e]),this.refreshCallback(this.state));}}bt.__name__="bs.player.plugin.skin.model.videoTracks.VideoTracksModel",bt.__super__=B,Object.assign(bt.prototype,{__class__:bt});class _t extends B{constructor(t,e,s,i,n){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i,n);}_hx_constructor(t,e,s,i,n){let a=[],l=0;for(;l<3;)++l,a.push(0);this.eventTsRegistry=a,this.moveDir="ltr",this.moveAxis="y",this.handleVolume=null,this.handleElement=null,this.skinElement=null,this.isTrackDown=!1,super._hx_constructor(t,e,s,i),this.skinElement=n,this.state={name:"volume",mute:!1,value:1,prc:isNaN(1)||!isFinite(1)?"0%":Math.max(0,Math.min(100,100))+"%",text:"100",active:!1,ctrl:null,toggle:null},this.state.ctrl=$t(this,this.controlTrack),this.state.toggle=$t(this,this.toggle),p.add(t,"skinVolume",$t(this,this.onVolumeEvent)),p.add(t,"skinMute",$t(this,this.onMuteEvent)),p.add(t,"skinUnmute",$t(this,this.onUnmuteEvent)),b.add(t,"resize",$t(this,this.onResize)),this.refreshCallback(this.state);}destroy(){super.destroy(),b.remove(this.context,"resize",$t(this,this.onResize)),p.remove(this.context,"skinVolume",$t(this,this.onVolumeEvent)),p.remove(this.context,"skinMute",$t(this,this.onMuteEvent)),p.remove(this.context,"skinUnmute",$t(this,this.onUnmuteEvent));}onResize(t){this.updateMoveDataset();}updateMoveDataset(){if(null==this.handleElement)return;let t=this.handleElement.dataset;null!=t&&(this.moveAxis=Object.prototype.hasOwnProperty.call(t,"axis")?t.axis:"y",this.moveDir=Object.prototype.hasOwnProperty.call(t,"direction")?t.direction:"ltr");}controlTrack(t){null!=t?this.handleElement!=t&&(this.handleElement=t,this.handleElement.addEventListener("touchstart",$t(this,this.handleTrack),wt.get_passiveOptions()),this.handleElement.addEventListener("touchmove",$t(this,this.handleTrack),wt.get_passiveOptions()),this.handleElement.addEventListener("touchend",$t(this,this.handleTrack),wt.get_passiveOptions()),this.handleElement.addEventListener("mousedown",$t(this,this.handleTrack),wt.get_passiveOptions()),this.handleElement.addEventListener("mousemove",$t(this,this.handleTrack),wt.get_passiveOptions()),this.handleElement.addEventListener("mouseup",$t(this,this.handleTrack),wt.get_passiveOptions())):null!=this.handleElement&&(this.handleElement.removeEventListener("touchstart",$t(this,this.handleTrack)),this.handleElement.removeEventListener("touchmove",$t(this,this.handleTrack)),this.handleElement.removeEventListener("touchend",$t(this,this.handleTrack)),this.handleElement.removeEventListener("mousedown",$t(this,this.handleTrack)),this.handleElement.removeEventListener("mousemove",$t(this,this.handleTrack)),this.handleElement.removeEventListener("mouseup",$t(this,this.handleTrack)),this.handleElement=null);}toggle(t){if(null!=t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()),this.state.mute||0==this.state.value){let t=0==this.state.value?1:this.state.value;return this.updateValue(t),this.dispatchVolume(t),void this.dispatchUnmute()}this.dispatchMute();}handleTrack(t){switch(t.type){case"blur":case"mouseleave":case"mouseup":case"touchend":if(this.eventAlreadyTriggered(2,t))return;let e=this.skinElement,s=$t(this,this.handleTrack);g.enableHtmlSelection(),window.document.removeEventListener("mouseup",s),window.document.removeEventListener("mousemove",s),window.document.removeEventListener("mouseleave",s),window.document.removeEventListener("blur",s),e.removeEventListener("mouseup",s),e.removeEventListener("mousemove",s),e.removeEventListener("blur",s),g.isMobile()&&(window.document.removeEventListener("touchend",s),e.removeEventListener("touchend",s)),this.state.active=!1;let i=t.target;this.skinElement.contains(i)&&this.isTrackDown?this.handleMoveEnd(t):this.refreshCallback(this.state),this.isTrackDown=!1;break;case"mousedown":case"touchstart":if(this.isTrackDown)return;if(this.eventAlreadyTriggered(0,t))return;let n=this.skinElement,a=$t(this,this.handleTrack);g.disableHtmlSelection(),window.document.addEventListener("mouseup",a,wt.get_passiveOptions()),window.document.addEventListener("mousemove",a,wt.get_passiveOptions()),window.document.addEventListener("mouseleave",a,wt.get_passiveOptions()),window.document.addEventListener("blur",a,wt.get_passiveOptions()),n.addEventListener("mouseup",a,wt.get_passiveOptions()),n.addEventListener("mousemove",a,wt.get_passiveOptions()),n.addEventListener("blur",a,wt.get_passiveOptions()),g.isMobile()&&(window.document.addEventListener("touchend",a,wt.get_passiveOptions()),n.addEventListener("touchend",a,wt.get_passiveOptions())),this.state.active=!0,this.updateMoveDataset(),this.handleMoving(t),this.isTrackDown=!0;break;case"mousemove":case"touchmove":if(this.eventAlreadyTriggered(1,t))return;this.handleMoving(t);}}eventAlreadyTriggered(t,e){let s=e.timeStamp;if(null==s&&(s=(new Date).getTime()),this.eventTsRegistry[t]==s)return !0;let i=0,n=this.eventTsRegistry.length;for(;i<n;){let e=i++;this.eventTsRegistry[e]=t==e?s:0;}return !1}handleMoving(t){if(null==this.handleElement)return;let e=this.calculateVolume(t);null!=e&&this.handleVolume!=e&&(this.handleVolume=e,this.isTrackDown&&(this.updateValue(this.handleVolume),this.dispatchVolume(this.handleVolume),this.refreshCallback(this.state)));}handleMoveEnd(t){null!=this.handleVolume&&(this.updateValue(this.handleVolume),this.dispatchVolume(this.handleVolume));}calculateVolume(t){let e=null;if("x"==this.moveAxis){let s=0;t instanceof MouseEvent&&(s=Ut.__cast(t,MouseEvent).clientX);let i=window;if(Object.prototype.hasOwnProperty.call(i,"TouchEvent")&&t instanceof TouchEvent){let e=t;if(e.touches.length>0){s=e.touches.item(0).clientX;}}e=s;}else {let s=0;t instanceof MouseEvent&&(s=Ut.__cast(t,MouseEvent).clientY);let i=window;if(Object.prototype.hasOwnProperty.call(i,"TouchEvent")&&t instanceof TouchEvent){let e=t;if(e.touches.length>0){s=e.touches.item(0).clientY;}}e=s;}let s=null;s=this.handleElement.getBoundingClientRect();let i=s,n=0;n="x"==this.moveAxis?e-i.x:e-i.y;let a=0;return a="x"==this.moveAxis?n/i.width:n/i.height,a>.995?a=1:a<.005&&(a=0),"ltr"===this.moveDir?1-a:a}updateValue(t){if(null==t)return;this.state.value=t;let e=isNaN(t)||!isFinite(t);this.state.prc=e?"0%":Math.max(0,Math.min(100,100*t))+"%",this.state.text=""+(100*t|0);}onVolumeEvent(t){this.updateValue(t.data),this.refreshCallback(this.state);}onMuteEvent(t){this.state.mute=!0,this.refreshCallback(this.state);}onUnmuteEvent(t){this.state.mute=!1,this.refreshCallback(this.state);}dispatchVolume(t){let e=new p("skinVolume");e.data=t,e.dispatch(this.context);let s=null==t?"null":""+t,i=!1,n=null;if(n=Ht.getSessionStorage(),i=null!=n,i)try{if(null==s){let t=null;t=Ht.getSessionStorage(),t.removeItem("_brplayer_vol");}else {let t=null;t=Ht.getSessionStorage(),t.setItem("_brplayer_vol",l.substr(h.string(s),0,5));}}catch(t){console.warn("Error occured durring writing volume value into session storage.");}}dispatchMute(){new p("skinMute").dispatch(this.context);let t=!1,e=null;if(e=Ht.getSessionStorage(),t=null!=e,t)try{let t=null;t=Ht.getSessionStorage(),t.setItem("_brplayer_muted","1");}catch(t){console.warn("Error occured durring writing muted value into session storage.");}}dispatchUnmute(){new p("skinUnmute").dispatch(this.context);let t=!1,e=null;if(e=Ht.getSessionStorage(),t=null!=e,t)try{let t=null;t=Ht.getSessionStorage(),t.setItem("_brplayer_muted","0");}catch(t){console.warn("Error occured durring writing muted value into session storage.");}}}_t.__name__="bs.player.plugin.skin.model.volume.VolumeModel",_t.__super__=B,Object.assign(_t.prototype,{__class__:_t});class yt extends W{constructor(t,e,s,i){B._hx_skip_constructor=!0,super(),B._hx_skip_constructor=!1,this._hx_constructor(t,e,s,i);}_hx_constructor(t,e,s,i){this.isVrDevice=!1,this.isVrEnabled=!1,super._hx_constructor(t,e,s,i),g.isSmartTV()||(this.state=null,_.add(t,"vrEnabled",$t(this,this.onVrEnabled)),_.add(t,"vrSupport",$t(this,this.onVrSupport)),_.add(t,"vrActive",$t(this,this.onVrActive)),this.refreshCallback(this.state));}destroy(){super.destroy(),g.isSmartTV()||(_.remove(this.context,"vrEnabled",$t(this,this.onVrEnabled)),_.remove(this.context,"vrSupport",$t(this,this.onVrSupport)),_.remove(this.context,"vrActive",$t(this,this.onVrActive)));}updateState(t){super.updateState(t),this.formatState();}formatState(){this.state=this.isMediaSpherical?{enabled:this.isVrEnabled,active:!1,supported:this.isVrDevice,click:$t(this,this.click)}:null,this.refreshCallback(this.state);}onVrEnabled(t){this.isVrEnabled=t.data,null!=this.state&&(this.state.enabled=this.isVrEnabled,this.refreshCallback(this.state));}onVrSupport(t){this.isVrDevice=t.data,null!=this.state&&(this.state.supported=this.isVrDevice,this.refreshCallback(this.state));}onVrActive(t){null!=this.state&&(this.state.active=t.data,this.refreshCallback(this.state));}click(t){new _(this.state.active?"vrEnd":"vrStart").dispatch(this.context);}}yt.__name__="bs.player.plugin.skin.model.vr.VrModel",yt.__super__=W,Object.assign(yt.prototype,{__class__:yt});class kt{static injectAssets(t,e,s){let i=0;if(null==s)return 0;let n=[],a=0,l=t.getElementsByTagName("link");for(;a<l.length;)n.push(l[a++]);let r=[],o=0,h=s.children;for(;o<h.length;)r.push(h[o++]);let u=[],c=0;for(;c<r.length;){let t=r[c];++c,"LINK"==t.tagName&&u.push(t);}let d=u,p=null,m=null,f=!1,g=0;for(;g<d.length;){let s=d[g];if(++g,null==s||!(s instanceof HTMLLinkElement))continue;if(f=!1,m=null!=s.href&&""!=s.href?s.href:null,null==m)continue;p=null!=s.id&&""!=s.id?s.id:e+"-"+zt.encode(s.href);let a=[],l=0;for(;l<n.length;){let t=n[l];++l,t.id==p&&a.push(t);}f=a.length<1,f&&(t.appendChild(s),++i);}return i}static appendStyle(t,e,s){let i=e+"-skin-"+zt.encode(s),n=t.querySelector("style#"+i);null==n&&(n=window.document.createElement("style"),n.id=""+i,n.insertAdjacentHTML("beforeend",s),t.appendChild(n));}}kt.__name__="bs.player.plugin.skin.util.Dom";class wt{static get_passiveOptions(){return !!wt.get_supportPassive()&&{passive:!0}}static get_supportPassive(){if(null==wt._supportPassive){wt._supportPassive=!1;try{let t=Object.defineProperty({},"passive",{get:function(){wt._supportPassive=!0;}});window.addEventListener("testPassive",null,t),window.removeEventListener("testPassive",null,t);}catch(t){}}return wt._supportPassive}}wt.__name__="bs.player.plugin.skin.util.Event";class xt{static toggle(t,e,s){g.isSmartTV()||(xt.isFullscreen(e)?xt.exit(t,e,s):xt.enter(t,e,s));}static isFullscreen(t){let e=!1,s=window.document,i=window,n=t;return null!=i.bradmaxIsFullscreenEnabled&&o.isFunction($t(i,i.bradmaxIsFullscreenEnabled))?e=i.bradmaxIsFullscreenEnabled():null!=s.fullscreenElement||null!=s.webkitFullscreenElement||null!=s.mozFullScreenElement||null!=s.msFullscreenElement||null!=n&&(1==n.webkitDisplayingFullscreen||"fullscreen"==n.webkitPresentationMode)?e=!0:xt.isFullscreenEmulation&&(e=xt.isFullscreenEmulationActive),e}static enter(t,e,s){let i=window,n=t,a=e,l=null;window.document.addEventListener(v.get_FULLSCREEN_CHANGE(),s),null!=i.bradmaxSetFullscreen?i.bradmaxSetFullscreen(!0):null!=n.requestFullscreen?l=n.requestFullscreen():null!=n.requestFullScreen?l=n.requestFullScreen():null!=n.msRequestFullscreen?l=n.msRequestFullscreen():null!=n.mozRequestFullScreen?l=n.mozRequestFullScreen():null!=n.webkitRequestFullscreen?l=n.webkitRequestFullscreen():null!=a&&null!=a.webkitSupportsFullscreen&&1==a.webkitSupportsFullscreen&&null!=a.webkitEnterFullscreen&&o.isFunction($t(a,a.webkitEnterFullscreen))?a.webkitEnterFullscreen():null!=a&&null!=a.webkitSetPresentationMode&&o.isFunction($t(a,a.webkitSetPresentationMode))&&null!=a.webkitSupportsPresentationMode&&o.isFunction($t(a,a.webkitSupportsPresentationMode))&&a.webkitSupportsPresentationMode("fullscreen")?a.webkitSetPresentationMode("fullscreen"):(xt.isFullscreenEmulation=!0,xt.enterEmulatedFullscreen(n)),null!=l&&l.catch((function(t){console.warn("BRADMAX PLAYER NOTICE:\nBrowser doesn't allow openinng fullscreen mode without user interaction.\nPlayer is waiting for user to click 'fullscreen' button.\n\nPlease also check server HTTP response headers. Fullscreen could be also blocked by setting Feature-Policy proper header https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Feature-Policy/fullscreen \n\n",t);}));}static enterEmulatedFullscreen(t){xt.isFullscreenEmulationActive=!0;let e=t.style;t.setAttribute("data-pre-fullscreen",t.style.cssText),e.objectFit="contain",e.userSelect="text",e.position="fixed",e.top="0",e.left="0",e.boxSizing="border-box",e.minWidth="0px",e.maxWidth="nonet",e.minHeight="0px",e.maxHeight="none",e.width="100%",e.height="100%",e.transform="none",e.inset="0px",e.margin="0px",e.zIndex="10000";let s=window.document;s.body.setAttribute("data-pre-fullscreen",s.body.style.cssText),s.body.style.overflow="hidden";}static exitEmulatedFullscreen(t){xt.isFullscreenEmulationActive=!1,t.style.cssText=t.getAttribute("data-pre-fullscreen");let e=window.document;e.body.style.cssText=e.body.getAttribute("data-pre-fullscreen");}static exit(t,e,s){let i=window.document,n=window,a=e;null!=n.bradmaxSetFullscreen?n.bradmaxSetFullscreen(!1):xt.isFullscreenEmulation?xt.exitEmulatedFullscreen(t):null!=i.exitFullscreen?i.exitFullscreen():null!=i.exitFullScreen?i.exitFullScreen():null!=i.msExitFullscreen?i.msExitFullscreen():null!=i.mozCancelFullScreen?i.mozCancelFullScreen():null!=i.webkitExitFullscreen?i.webkitExitFullscreen():null!=a&&null!=a.webkitExitFullscreen&&a.webkitExitFullscreen(),i.addEventListener(v.get_FULLSCREEN_CHANGE(),s);}}xt.__name__="bs.player.plugin.skin.util.FullscreenTool";class St{static audioSelectionVisible(t){let e=Mt.syncWithHideUIElements(t,"audioSelection","audioSelectionVisible");if(!Object.prototype.hasOwnProperty.call(e,"audioSelectionVisible"))return !0;switch(o.field(e,"audioSelectionVisible")){case 0:case"false":case!1:return !1;default:return !0}}static subtitleSelectionVisible(t){let e=Mt.syncWithHideUIElements(t,"subtitleSelection","subtitleSelectionVisible");if(!Object.prototype.hasOwnProperty.call(e,"subtitleSelectionVisible"))return !0;switch(o.field(e,"subtitleSelectionVisible")){case 0:case"false":case!1:return !1;default:return !0}}}St.__name__="bs.player.plugin.skin.util.HtmlSkinVariableParser";class Et{static ensureSingleActiveListItem(t){if(null==t||0==t.length)return t;let e=Et.findFirstActiveListItem(t);return null==e||r.iter(t,(function(t){t.active=t==e;})),t}static findFirstActiveListItem(t){if(null!=t){let e=[],s=0;for(;s<t.length;){let i=t[s];++s,i.active&&e.push(i);}return e.shift()}return null}}Et.__name__="bs.player.plugin.skin.util.ListItemUtil";class Pt{static unlock(){let t=Pt.orientationApi();if(null!=t&&null!=t.unlock&&o.isFunction($t(t,t.unlock))){try{t.unlock();}catch(t){let e=Nt.caught(t);console.warn("Warning: orientation.unlock error:"),console.error(e);}return}let e=Pt.oldUnlockOrientationApi();if(null!=e&&o.isFunction(e))try{e();}catch(t){let e=Nt.caught(t);console.warn("Warning: screen.unlockOrientation error:"),console.error(e);}}static lock(t){if(null==t)return void Pt.unlock();let e=Pt.orientationApi();if(null!=e&&null!=e.lock&&o.isFunction($t(e,e.lock)))return void e.lock(t).then((function(t){})).catch((function(t){console.warn("Warning: orientation.lock error:"),console.error(t);}));let s=Pt.oldLockOrientationApi();if(null!=s&&o.isFunction(s))try{s(t);}catch(t){let e=Nt.caught(t);console.warn("Warning: screen.lockOrientation error:"),console.error(e);}}static orientationApi(){let t=window;if(Object.prototype.hasOwnProperty.call(t,"screen")){if(null!=t.screen.orientation)return t.screen.orientation;let e=t.screen;if(null!=e.mozOrientation)return e.mozOrientation;if(null!=e.msOrientation)return e.msOrientation}return null}static oldLockOrientationApi(){let t=window;if(Object.prototype.hasOwnProperty.call(t,"screen")){let e=t.screen;if(null!=e.lockOrientation&&o.isFunction(e.lockOrientation))return e.lockOrientation;if(null!=e.mozLockOrientation&&o.isFunction(e.mozLockOrientation))return e.mozLockOrientation;if(null!=e.msLockOrientation&&o.isFunction(e.msLockOrientation))return e.msLockOrientation}return null}static oldUnlockOrientationApi(){let t=window;if(Object.prototype.hasOwnProperty.call(t,"screen")){let e=t.screen;if(null!=e.unlockOrientation&&o.isFunction(e.unlockOrientation))return e.unlockOrientation;if(null!=e.mozUnlockOrientation&&o.isFunction(e.mozUnlockOrientation))return e.mozUnlockOrientation;if(null!=e.msUnlockOrientation&&o.isFunction(e.msUnlockOrientation))return e.msUnlockOrientation}return null}}Pt.__name__="bs.player.plugin.skin.util.ScreenOrientationTool";class Ct{static stateToSizesAttribute(t,e){return null==e||null==e.sources||e.sources.length<2?null:"(min-width: "+t.width+"px) "+t.width+"px, (min-height: "+t.height+"px) "+t.height+"px"}static stateToAttribute(t){if(null==t||null==t.sources)return null;if(null!=t.srcset)return t.srcset;let e=[],s=0,i=t.sources;for(;s<i.length;){let t=i[s];++s;let n="";null!=t.width&&(n=" "+t.width+"w"),e.push(""+t.url+n);}let n=e.join(", ");return t.srcset=n,""+n}static imageToState(t){let e=[],s=0;for(;s<t.length;)e.push(o.copy(t[s++]));e.sort((function(t,e){return e.width-t.width}));let i=[],n=0;for(;n<e.length;){let t=e[n];++n,(null==t.width||t.width<=0)&&i.push(t);}let a=[],l=0;for(;l<e.length;){let t=e[l];++l,null!=t.width&&t.width>0&&a.push(t);}let r=i.length>0?i[0]:a.length>0?a[a.length-1]:null,h=null!=r?r.url:null;if(null==h)return null;let u={url:h};if(a.length>0){u.sources=[];let t=0;for(;t<a.length;){let e=a[t];++t;let s={url:e.url};null!=e.width&&(s.width=e.width),u.sources.push(s);}0==u.sources.length&&o.deleteField(u,"sources");}return u}}Ct.__name__="bs.player.plugin.skin.util.Srcset";class Ot{static cleanup(t){let e=new RegExp("(\x3c!--)([\\s\\S]*?)(--\x3e)","g".split("u").join("")),s=new RegExp("[\n\r]+","g".split("u").join("")),i=new RegExp("[ ]+","g".split("u").join(""));return t=(t=(t=t.replace(e,"")).replace(s,"\n\r")).replace(i," ")}static merge(t,e){let s="",i=0;for(;i<t.length;){let n=t[i++],a=i-1;s+=n+(a<e.length?e[a]:"");}return s}static removeCustomTag(t,e){return t.replace(e.r,"")}static readCustomAttribute(t){return u.htmlUnescape(t)}static escapeCustomAttributes(t,e){let s=0;for(;s<e.length;)t=e[s++].map(t,(function(t){return ""+t.matched(1)+u.htmlEscape(t.matched(2))+t.matched(3)}));return t}}Ot.__name__="bs.player.plugin.skin.util.Template";class Tt{static formatCss(t,e){let s=Object.prototype.hasOwnProperty.call(e,"time")?o.field(e,"time"):null;if(null==s)return null;if("number"==typeof s)return Tt.timeToText(t.time,e.time,NaN);let i=e;return Tt.timeToText(t.time,i.time.show,i.time.hide)}static timeToText(t,e,s){return isNaN(t)?null:t<.1?"future":isNaN(e)?null:isNaN(s)?e<t?"past":"future":t>e&&t<s?"current":e<t?"past":"future"}}Tt.__name__="bs.player.plugin.skin.util.Time";var At=require("bs.util.ObjectTools");class Mt{static volume(t){if(Mt.mute(t))return 0;let e=!1,s=null;if(s=Ht.getSessionStorage(),e=null!=s,e){let t,e=NaN,s=!1,i=null;if(i=Ht.getSessionStorage(),s=null!=i,s){try{let t,s=null,i=!1,n=null;if(n=Ht.getSessionStorage(),i=null!=n,i){let e=null;e=Ht.getSessionStorage(),s=e.getItem("_brplayer_vol"),null==s||(s=u.trim(s)),t=s;}else t=s;null!=t&&""!=t&&(e=parseFloat(t));}catch(t){console.warn("Error occured durring loading volume settings from session storage.");}t=e;}else t=e;if(null!=t&&!isNaN(t)&&isFinite(t))return t}let i=null;Object.prototype.hasOwnProperty.call(t,"volume")&&(i=parseFloat(o.field(t,"volume")),isNaN(i)&&(i=null));let n=i;return null!=n&&!isNaN(n)&&isFinite(n)?n:1}static mute(t){let e,s=!1,i=null;if(i=Ht.getSessionStorage(),s=null!=i,s){let t=!1,s=!1,i=null;if(i=Ht.getSessionStorage(),s=null!=i,s){try{let e,s=null,i=!1,n=null;if(n=Ht.getSessionStorage(),i=null!=n,i){let t=null;t=Ht.getSessionStorage(),s=t.getItem("_brplayer_muted"),null==s||(s=u.trim(s)),e=s;}else e=s;null!=e&&""!=e&&(t=null!=e&&"1"==e);}catch(t){console.warn("Error occured durring loading volume settings from session storage.");}e=t;}else e=!1;}else e=!1;if(e)return !0;if(!Object.prototype.hasOwnProperty.call(t,"mute"))return !1;switch(o.field(t,"mute")){case 1:case"true":case!0:return !0;default:return !1}}static audio(t){let e=null;Object.prototype.hasOwnProperty.call(t,"audio")&&(e=o.field(t,"audio"));let s=!1,i=null;if(i=Ht.getSessionStorage(),s=null!=i,s){let t,s=null,i=!1,n=null;if(n=Ht.getSessionStorage(),i=null!=n,i){try{let t,e=null,i=!1,n=null;if(n=Ht.getSessionStorage(),i=null!=n,i){let s=null;s=Ht.getSessionStorage(),e=s.getItem("_brplayer_aud_lang"),null==e||(e=u.trim(e)),t=e;}else t=e;null!=t&&""!=t&&(s=t);}catch(t){console.warn("Error occured durring loading audio language from session storage.");}t=s;}else t=s;null!=t&&(e=t);}return e}static subtitles(t){let e=null;Object.prototype.hasOwnProperty.call(t,"subtitles")&&(e=o.field(t,"subtitles"));let s=!1,i=null;if(i=Ht.getSessionStorage(),s=null!=i,s){let t,s=null,i=!1,n=null;if(n=Ht.getSessionStorage(),i=null!=n,i){try{let t,e=null,i=!1,n=null;if(n=Ht.getSessionStorage(),i=null!=n,i){let s=null;s=Ht.getSessionStorage(),e=s.getItem("_brplayer_sub_lang"),null==e||(e=u.trim(e)),t=e;}else t=e;null!=t&&""!=t&&(s=t);}catch(t){console.warn("Error occured durring loading subtitles language from session storage.");}t=s;}else t=s;null!=t&&(e=t);}return e}static fullscreenEnabled(t){let e=Mt.syncWithHideUIElements(t,"fullscreenButton","fullscreenEnabled");if(!Object.prototype.hasOwnProperty.call(e,"fullscreenEnabled"))return !0;switch(o.field(e,"fullscreenEnabled")){case 0:case"false":case!1:return !1;default:return !0}}static hideUIElements(t){let e=null;return Object.prototype.hasOwnProperty.call(t,"hideUIElements")&&(e=o.field(t,"hideUIElements")),e}static syncWithHideUIElements(t,e,s){return null!=Mt.hideUIElements(t)&&1==Dt.has(Mt.hideUIElements(t),e)&&(t[s]=!1),t}static decodeBase64(t){try{return Rt.urlDecode(t).toString()}catch(e){try{return Rt.decode(t).toString()}catch(e){try{return window.atob(t)}catch(t){return null}}}}}Mt.__name__="bs.util.PlayerVariableParser";var It=require("bs.util.TextTools");class Dt{static has(t,e){if(null==t||""==t)return !1;if(0==Dt.attributes.length){let e=t.split(","),s=new Array(e.length),i=0,n=e.length;for(;i<n;){let t=i++;s[t]=u.trim(e[t]);}let a=0;for(;a<s.length;)Dt.attributes.push(s[a++]);}return -1!=Dt.attributes.indexOf(e)}}class Nt extends Error{constructor(t,e,s){super(t),this.message=t,this.__previousException=e,this.__nativeException=null!=s?s:this;}get_native(){return this.__nativeException}static caught(t){return t instanceof Nt?t:t instanceof Error?new Nt(t.message,null,t):new Vt(t,null,t)}static thrown(t){if(t instanceof Nt)return t.get_native();if(t instanceof Error)return t;return new Vt(t)}}Nt.__name__="haxe.Exception",Nt.__super__=Error,Object.assign(Nt.prototype,{__class__:Nt});var Ft=require("haxe.Timer");class Vt extends Nt{constructor(t,e,s){super(String(t),e,s),this.value=t;}}Vt.__name__="haxe.ValueException",Vt.__super__=Nt,Object.assign(Vt.prototype,{__class__:Vt});var Bt=require("haxe.io.Bytes"),jt=n["haxe.io.Encoding"]={__ename__:!0,__constructs__:null,UTF8:{_hx_name:"UTF8",_hx_index:0,__enum__:"haxe.io.Encoding",toString:i},RawNative:{_hx_name:"RawNative",_hx_index:1,__enum__:"haxe.io.Encoding",toString:i}};jt.__constructs__=[jt.UTF8,jt.RawNative];var Rt=require("haxe.crypto.Base64");class zt{constructor(){}bitOR(t,e){return (t>>>1|e>>>1)<<1|1&t|1&e}bitXOR(t,e){return (t>>>1^e>>>1)<<1|1&t^1&e}bitAND(t,e){return (t>>>1&e>>>1)<<1|1&t&e}addme(t,e){let s=(65535&t)+(65535&e);return (t>>16)+(e>>16)+(s>>16)<<16|65535&s}hex(t){let e="",s=0;for(;s<t.length;){let i=t[s];++s,e+="0123456789abcdef".charAt(i>>4&15)+"0123456789abcdef".charAt(15&i),e+="0123456789abcdef".charAt(i>>12&15)+"0123456789abcdef".charAt(i>>8&15),e+="0123456789abcdef".charAt(i>>20&15)+"0123456789abcdef".charAt(i>>16&15),e+="0123456789abcdef".charAt(i>>28&15)+"0123456789abcdef".charAt(i>>24&15);}return e}rol(t,e){return t<<e|t>>>32-e}cmn(t,e,s,i,n,a){return this.addme(this.rol(this.addme(this.addme(e,t),this.addme(i,a)),n),s)}ff(t,e,s,i,n,a,l){return this.cmn(this.bitOR(this.bitAND(e,s),this.bitAND(~e,i)),t,e,n,a,l)}gg(t,e,s,i,n,a,l){return this.cmn(this.bitOR(this.bitAND(e,i),this.bitAND(s,~i)),t,e,n,a,l)}hh(t,e,s,i,n,a,l){return this.cmn(this.bitXOR(this.bitXOR(e,s),i),t,e,n,a,l)}ii(t,e,s,i,n,a,l){return this.cmn(this.bitXOR(s,this.bitOR(e,~i)),t,e,n,a,l)}doEncode(t){let e=1732584193,s=-271733879,i=-1732584194,n=271733878,a=0;for(;a<t.length;){let l=e,r=s,o=i,h=n;e=this.ff(e,s,i,n,t[a],7,-680876936),n=this.ff(n,e,s,i,t[a+1],12,-389564586),i=this.ff(i,n,e,s,t[a+2],17,606105819),s=this.ff(s,i,n,e,t[a+3],22,-1044525330),e=this.ff(e,s,i,n,t[a+4],7,-176418897),n=this.ff(n,e,s,i,t[a+5],12,1200080426),i=this.ff(i,n,e,s,t[a+6],17,-1473231341),s=this.ff(s,i,n,e,t[a+7],22,-45705983),e=this.ff(e,s,i,n,t[a+8],7,1770035416),n=this.ff(n,e,s,i,t[a+9],12,-1958414417),i=this.ff(i,n,e,s,t[a+10],17,-42063),s=this.ff(s,i,n,e,t[a+11],22,-1990404162),e=this.ff(e,s,i,n,t[a+12],7,1804603682),n=this.ff(n,e,s,i,t[a+13],12,-40341101),i=this.ff(i,n,e,s,t[a+14],17,-1502002290),s=this.ff(s,i,n,e,t[a+15],22,1236535329),e=this.gg(e,s,i,n,t[a+1],5,-165796510),n=this.gg(n,e,s,i,t[a+6],9,-1069501632),i=this.gg(i,n,e,s,t[a+11],14,643717713),s=this.gg(s,i,n,e,t[a],20,-373897302),e=this.gg(e,s,i,n,t[a+5],5,-701558691),n=this.gg(n,e,s,i,t[a+10],9,38016083),i=this.gg(i,n,e,s,t[a+15],14,-660478335),s=this.gg(s,i,n,e,t[a+4],20,-405537848),e=this.gg(e,s,i,n,t[a+9],5,568446438),n=this.gg(n,e,s,i,t[a+14],9,-1019803690),i=this.gg(i,n,e,s,t[a+3],14,-187363961),s=this.gg(s,i,n,e,t[a+8],20,1163531501),e=this.gg(e,s,i,n,t[a+13],5,-1444681467),n=this.gg(n,e,s,i,t[a+2],9,-51403784),i=this.gg(i,n,e,s,t[a+7],14,1735328473),s=this.gg(s,i,n,e,t[a+12],20,-1926607734),e=this.hh(e,s,i,n,t[a+5],4,-378558),n=this.hh(n,e,s,i,t[a+8],11,-2022574463),i=this.hh(i,n,e,s,t[a+11],16,1839030562),s=this.hh(s,i,n,e,t[a+14],23,-35309556),e=this.hh(e,s,i,n,t[a+1],4,-1530992060),n=this.hh(n,e,s,i,t[a+4],11,1272893353),i=this.hh(i,n,e,s,t[a+7],16,-155497632),s=this.hh(s,i,n,e,t[a+10],23,-1094730640),e=this.hh(e,s,i,n,t[a+13],4,681279174),n=this.hh(n,e,s,i,t[a],11,-358537222),i=this.hh(i,n,e,s,t[a+3],16,-722521979),s=this.hh(s,i,n,e,t[a+6],23,76029189),e=this.hh(e,s,i,n,t[a+9],4,-640364487),n=this.hh(n,e,s,i,t[a+12],11,-421815835),i=this.hh(i,n,e,s,t[a+15],16,530742520),s=this.hh(s,i,n,e,t[a+2],23,-995338651),e=this.ii(e,s,i,n,t[a],6,-198630844),n=this.ii(n,e,s,i,t[a+7],10,1126891415),i=this.ii(i,n,e,s,t[a+14],15,-1416354905),s=this.ii(s,i,n,e,t[a+5],21,-57434055),e=this.ii(e,s,i,n,t[a+12],6,1700485571),n=this.ii(n,e,s,i,t[a+3],10,-1894986606),i=this.ii(i,n,e,s,t[a+10],15,-1051523),s=this.ii(s,i,n,e,t[a+1],21,-2054922799),e=this.ii(e,s,i,n,t[a+8],6,1873313359),n=this.ii(n,e,s,i,t[a+15],10,-30611744),i=this.ii(i,n,e,s,t[a+6],15,-1560198380),s=this.ii(s,i,n,e,t[a+13],21,1309151649),e=this.ii(e,s,i,n,t[a+4],6,-145523070),n=this.ii(n,e,s,i,t[a+11],10,-1120210379),i=this.ii(i,n,e,s,t[a+2],15,718787259),s=this.ii(s,i,n,e,t[a+9],21,-343485551),e=this.addme(e,l),s=this.addme(s,r),i=this.addme(i,o),n=this.addme(n,h),a+=16;}return [e,s,i,n]}static encode(t){let e=new zt;return e.hex(e.doEncode(zt.str2blks(t)))}static str2blks(t){let e=Bt.ofString(t),s=1+(e.length+8>>6),i=[],n=16*s,a=0;for(;a<n;)i[a++]=0;let l=0,r=e.length,o=8*r;for(;l<r;)i[l>>2]|=e.b[l]<<(o+l)%4*8,++l;i[l>>2]|=128<<(o+l)%4*8;let h=16*s-2;return i[h]=255&o,i[h]=(i[h]|=(o>>>8&255)<<8)|(o>>>16&255)<<16,i[h]|=(o>>>24&255)<<24,i}}zt.__name__="haxe.crypto.Md5",Object.assign(zt.prototype,{__class__:zt});var Wt=n["haxe.ds.Either"]={__ename__:!0,__constructs__:null,Left:(s=function(t){return {_hx_index:0,v:t,__enum__:"haxe.ds.Either",toString:i}},s._hx_name="Left",s.__params__=["v"],s),Right:(s=function(t){return {_hx_index:1,v:t,__enum__:"haxe.ds.Either",toString:i}},s._hx_name="Right",s.__params__=["v"],s)};Wt.__constructs__=[Wt.Left,Wt.Right];var qt=require("haxe.ds.StringMap");class Ut{static getClass(t){if(null==t)return null;if(t instanceof Array)return Array;{let e=t.__class__;if(null!=e)return e;let s=Ut.__nativeClassName(t);return null!=s?Ut.__resolveNativeClass(s):null}}static __string_rec(t,e){if(null==t)return "null";if(e.length>=5)return "<...>";let s=typeof t;switch("function"==s&&(t.__name__||t.__ename__)&&(s="object"),s){case"function":return "<function>";case"object":if(t.__enum__){let s=n[t.__enum__].__constructs__[t._hx_index],i=s._hx_name;return s.__params__?(e+="\t",i+"("+function(){let i=[];{let n=0,a=s.__params__;for(;n<a.length;){let s=a[n];n+=1,i.push(Ut.__string_rec(t[s],e));}}return i}().join(",")+")"):i}if(t instanceof Array){let s="[";e+="\t";let i=0,n=t.length;for(;i<n;){let n=i++;s+=(n>0?",":"")+Ut.__string_rec(t[n],e);}return s+="]",s}let s;try{s=t.toString;}catch(t){return "???"}if(null!=s&&s!=Object.toString&&"function"==typeof s){let e=t.toString();if("[object Object]"!=e)return e}let i="{\n";e+="\t";let a=null!=t.hasOwnProperty,l=null;for(l in t)a&&!t.hasOwnProperty(l)||"prototype"!=l&&"__class__"!=l&&"__super__"!=l&&"__interfaces__"!=l&&"__properties__"!=l&&(2!=i.length&&(i+=", \n"),i+=e+l+" : "+Ut.__string_rec(t[l],e));return i+="\n"+(e=e.substring(1))+"}",i;case"string":return t;default:return String(t)}}static __interfLoop(t,e){for(;;){if(null==t)return !1;if(t==e)return !0;let s=t.__interfaces__;if(null!=s&&(null==t.__super__||t.__super__.__interfaces__!=s)){let t=0,i=s.length;for(;t<i;){let i=s[t++];if(i==e||Ut.__interfLoop(i,e))return !0}}t=t.__super__;}}static __instanceof(t,e){if(null==e)return !1;switch(e){case Array:return t instanceof Array;case Kt:return "boolean"==typeof t;case Xt:return null!=t;case Qt:return "number"==typeof t;case Gt:return "number"==typeof t&&(0|t)===t;case String:return "string"==typeof t;default:if(null==t)return !1;if("function"==typeof e){if(Ut.__downcastCheck(t,e))return !0}else if("object"==typeof e&&Ut.__isNativeObj(e)&&t instanceof e)return !0;return e==Yt&&null!=t.__name__||(e==Zt&&null!=t.__ename__||null!=t.__enum__&&n[t.__enum__]==e)}}static __downcastCheck(t,e){return t instanceof e||!!e.__isInterface__&&Ut.__interfLoop(Ut.getClass(t),e)}static __cast(t,e){if(null==t||Ut.__instanceof(t,e))return t;throw Nt.thrown("Cannot cast "+h.string(t)+" to "+h.string(e))}static __nativeClassName(t){let e=Ut.__toStr.call(t).slice(8,-1);return "Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e}static __isNativeObj(t){return null!=Ut.__nativeClassName(t)}static __resolveNativeClass(t){return e[t]}}Ut.__name__="js.Boot";class Ht{static getSessionStorage(){try{let t=window.sessionStorage;if(t.getItem(""),0==t.length){let e="_hx_"+Math.random();t.setItem(e,e),t.removeItem(e);}return t}catch(t){return null}}}function $t(t,s){return null==s?null:(null==s.__id__&&(s.__id__=e.$haxeUID++),null==t.hx__closures__?t.hx__closures__={}:i=t.hx__closures__[s.__id__],null==i&&(i=s.bind(t),t.hx__closures__[s.__id__]=i),i);var i;}Ht.__name__="js.Browser",e.$haxeUID|=0,Object.defineProperty(String.prototype,"__class__",{value:String,enumerable:!1,writable:!0}),String.__name__="String",Array.__name__="Array",Date.prototype.__class__=Date,Date.__name__="Date";var Gt={},Xt={},Qt=Number,Kt=Boolean,Yt={},Zt={};Ut.__toStr={}.toString,A._hx_skip_constructor=!1,F.__plugfaces__="IPlugin",B._hx_skip_constructor=!1,G._hx_skip_constructor=!1,xt.isFullscreenEmulation=!1,xt.isFullscreenEmulationActive=!1,Dt.attributes=[];}(exports,window);
function t$1(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function e$2(t,e,n){return e=l$1(e),function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,c$1()?Reflect.construct(e,n||[],l$1(t).constructor):e.apply(t,n))}function n$1(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i$1(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,y$1(i.key),i);}}function r$1(t,e,n){return e&&i$1(t.prototype,e),n&&i$1(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function o$1(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=$$1(t))||e){n&&(t=n);var i=0,r=function(){};return {s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,s=!1;return {s:function(){n=n.call(t);},n:function(){var t=n.next();return u=t.done,t},e:function(t){s=!0,o=t;},f:function(){try{u||null==n.return||n.return();}finally{if(s)throw o}}}}function u$1(t,e,n){return (e=y$1(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s$2(){return s$2="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=l$1(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},s$2.apply(null,arguments)}function l$1(t){return l$1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},l$1(t)}function a$2(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v$1(t,e);}function c$1(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));}catch(t){}return (c$1=function(){return !!t})()}function h$1(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i);}return n}function f$1(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h$1(Object(n),!0).forEach((function(e){u$1(t,e,n[e]);})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h$1(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e));}));}return t}function v$1(t,e){return v$1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},v$1(t,e)}function d$1(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o,u,s=[],l=!0,a=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1;}else for(;!(l=(i=o.call(n)).done)&&(s.push(i.value),s.length!==e);l=!0);}catch(t){a=!0,r=t;}finally{try{if(!l&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(a)throw r}}return s}}(t,e)||$$1(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p$1(e){return function(e){if(Array.isArray(e))return t$1(e)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||$$1(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y$1(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return ("string"===e?String:Number)(t)}(t,"string");return "symbol"==typeof e?e:e+""}function _$1(t){return _$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_$1(t)}function $$1(e,n){if(e){if("string"==typeof e)return t$1(e,n);var i={}.toString.call(e).slice(8,-1);return "Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?t$1(e,n):void 0}}var m$1,g$1=globalThis,A$1=g$1.trustedTypes,b$1=A$1?A$1.createPolicy("lit-html",{createHTML:function(t){return t}}):void 0,k$1="$lit$",w$1="lit$".concat(Math.random().toFixed(9).slice(2),"$"),O$1="?"+w$1,C$1="<".concat(O$1,">"),x$1=document,T$1=function(){return x$1.createComment("")},E$1=function(t){return null===t||"object"!=_$1(t)&&"function"!=typeof t},j$1=Array.isArray,S$1="[ \t\n\f\r]",P$1=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,N$1=/-->/g,H$1=/>/g,M$1=RegExp(">|".concat(S$1,"(?:([^\\s\"'>=/]+)(").concat(S$1,"*=").concat(S$1,"*(?:[^ \t\n\f\r\"'`<>=]|(\"|')|))|$)"),"g"),I$1=/'/g,D$1=/"/g,L$1=/^(?:script|style|textarea|title)$/i,R$1=function(t){return function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return {_$litType$:t,strings:e,values:i}}},U$1=R$1(1),B$1=R$1(2),Y$1=Symbol.for("lit-noChange"),V$1=Symbol.for("lit-nothing"),z$1=new WeakMap,W$1=x$1.createTreeWalker(x$1,129);
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function F$1(t,e){if(!j$1(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==b$1?b$1.createHTML(e):e}var Z$1=function(t,e){for(var n,i=t.length-1,r=[],o=2===e?"<svg>":3===e?"<math>":"",u=P$1,s=0;s<i;s++){for(var l=t[s],a=void 0,c=void 0,h=-1,f=0;f<l.length&&(u.lastIndex=f,null!==(c=u.exec(l)));){var v;f=u.lastIndex,u===P$1?"!--"===c[1]?u=N$1:void 0!==c[1]?u=H$1:void 0!==c[2]?(L$1.test(c[2])&&(n=RegExp("</"+c[2],"g")),u=M$1):void 0!==c[3]&&(u=M$1):u===M$1?">"===c[0]?(u=null!==(v=n)&&void 0!==v?v:P$1,h=-1):void 0===c[1]?h=-2:(h=u.lastIndex-c[2].length,a=c[1],u=void 0===c[3]?M$1:'"'===c[3]?D$1:I$1):u===D$1||u===I$1?u=M$1:u===N$1||u===H$1?u=P$1:(u=M$1,n=void 0);}var d=u===M$1&&t[s+1].startsWith("/>")?" ":"";o+=u===P$1?l+C$1:h>=0?(r.push(a),l.slice(0,h)+k$1+l.slice(h)+w$1+d):l+w$1+(-2===h?s:d);}return [F$1(t,o+(t[i]||"<?>")+(2===e?"</svg>":3===e?"</math>":"")),r]},Q$1=function(){return r$1((function t(e,i){var r,u=e.strings,s=e._$litType$;n$1(this,t),this.parts=[];var l=0,a=0,c=u.length-1,h=this.parts,f=d$1(Z$1(u,s),2),v=f[0],y=f[1];if(this.el=t.createElement(v,i),W$1.currentNode=this.el.content,2===s||3===s){var _=this.el.content.firstChild;_.replaceWith.apply(_,p$1(_.childNodes));}for(;null!==(r=W$1.nextNode())&&h.length<c;){if(1===r.nodeType){if(r.hasAttributes()){var $,m=o$1(r.getAttributeNames());try{for(m.s();!($=m.n()).done;){var g=$.value;if(g.endsWith(k$1)){var b=y[a++],C=r.getAttribute(g).split(w$1),x=/([.?@])?(.*)/.exec(b);h.push({type:1,index:l,name:x[2],strings:C,ctor:"."===x[1]?X$1:"?"===x[1]?tt$1:"@"===x[1]?et$1:K$1}),r.removeAttribute(g);}else g.startsWith(w$1)&&(h.push({type:6,index:l}),r.removeAttribute(g));}}catch(t){m.e(t);}finally{m.f();}}if(L$1.test(r.tagName)){var E=r.textContent.split(w$1),j=E.length-1;if(j>0){r.textContent=A$1?A$1.emptyScript:"";for(var S=0;S<j;S++)r.append(E[S],T$1()),W$1.nextNode(),h.push({type:2,index:++l});r.append(E[j],T$1());}}}else if(8===r.nodeType)if(r.data===O$1)h.push({type:2,index:l});else for(var P=-1;-1!==(P=r.data.indexOf(w$1,P+1));)h.push({type:7,index:l}),P+=w$1.length-1;l++;}}),null,[{key:"createElement",value:function(t,e){var n=x$1.createElement("template");return n.innerHTML=t,n}}])}();function q$1(t,e){var n,i,r,o,u,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,l=arguments.length>3?arguments[3]:void 0;if(e===Y$1)return e;var a=void 0!==l?null===(n=s._$Co)||void 0===n?void 0:n[l]:s._$Cl,c=E$1(e)?void 0:e._$litDirective$;return (null===(i=a)||void 0===i?void 0:i.constructor)!==c&&(null!==(r=a)&&void 0!==r&&null!==(o=r._$AO)&&void 0!==o&&o.call(r,!1),void 0===c?a=void 0:(a=new c(t))._$AT(t,s,l),void 0!==l?(null!==(u=s._$Co)&&void 0!==u?u:s._$Co=[])[l]=a:s._$Cl=a),void 0!==a&&(e=q$1(t,a._$AS(t,e.values),a,l)),e}var G$1=function(){return r$1((function t(e,i){n$1(this,t),this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=i;}),[{key:"parentNode",get:function(){return this._$AM.parentNode}},{key:"_$AU",get:function(){return this._$AM._$AU}},{key:"u",value:function(t){var e,n=this._$AD,i=n.el.content,r=n.parts,o=(null!==(e=null==t?void 0:t.creationScope)&&void 0!==e?e:x$1).importNode(i,!0);W$1.currentNode=o;for(var u=W$1.nextNode(),s=0,l=0,a=r[0];void 0!==a;){var c;if(s===a.index){var h=void 0;2===a.type?h=new J$1(u,u.nextSibling,this,t):1===a.type?h=new a.ctor(u,a.name,a.strings,this,t):6===a.type&&(h=new nt$1(u,this,t)),this._$AV.push(h),a=r[++l];}s!==(null===(c=a)||void 0===c?void 0:c.index)&&(u=W$1.nextNode(),s++);}return W$1.currentNode=x$1,o}},{key:"p",value:function(t){var e,n=0,i=o$1(this._$AV);try{for(i.s();!(e=i.n()).done;){var r=e.value;void 0!==r&&(void 0!==r.strings?(r._$AI(t,r,n),n+=r.strings.length-2):r._$AI(t[n])),n++;}}catch(t){i.e(t);}finally{i.f();}}}])}(),J$1=function(){function t(e,i,r,o){var u;n$1(this,t),this.type=2,this._$AH=V$1,this._$AN=void 0,this._$AA=e,this._$AB=i,this._$AM=r,this.options=o,this._$Cv=null===(u=null==o?void 0:o.isConnected)||void 0===u||u;}return r$1(t,[{key:"_$AU",get:function(){var t,e;return null!==(t=null===(e=this._$AM)||void 0===e?void 0:e._$AU)&&void 0!==t?t:this._$Cv}},{key:"parentNode",get:function(){var t,e=this._$AA.parentNode,n=this._$AM;return void 0!==n&&11===(null===(t=e)||void 0===t?void 0:t.nodeType)&&(e=n.parentNode),e}},{key:"startNode",get:function(){return this._$AA}},{key:"endNode",get:function(){return this._$AB}},{key:"_$AI",value:function(t){t=q$1(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this),E$1(t)?t===V$1||null==t||""===t?(this._$AH!==V$1&&this._$AR(),this._$AH=V$1):t!==this._$AH&&t!==Y$1&&this._(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):function(t){return j$1(t)||"function"==typeof(null==t?void 0:t[Symbol.iterator])}(t)?this.k(t):this._(t);}},{key:"O",value:function(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}},{key:"T",value:function(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t));}},{key:"_",value:function(t){this._$AH!==V$1&&E$1(this._$AH)?this._$AA.nextSibling.data=t:this.T(x$1.createTextNode(t)),this._$AH=t;}},{key:"$",value:function(t){var e,n=t.values,i=t._$litType$,r="number"==typeof i?this._$AC(t):(void 0===i.el&&(i.el=Q$1.createElement(F$1(i.h,i.h[0]),this.options)),i);if((null===(e=this._$AH)||void 0===e?void 0:e._$AD)===r)this._$AH.p(n);else {var o=new G$1(r,this),u=o.u(this.options);o.p(n),this.T(u),this._$AH=o;}}},{key:"_$AC",value:function(t){var e=z$1.get(t.strings);return void 0===e&&z$1.set(t.strings,e=new Q$1(t)),e}},{key:"k",value:function(e){j$1(this._$AH)||(this._$AH=[],this._$AR());var n,i,r=this._$AH,u=0,s=o$1(e);try{for(s.s();!(i=s.n()).done;){var l=i.value;u===r.length?r.push(n=new t(this.O(T$1()),this.O(T$1()),this,this.options)):n=r[u],n._$AI(l),u++;}}catch(t){s.e(t);}finally{s.f();}u<r.length&&(this._$AR(n&&n._$AB.nextSibling,u),r.length=u);}},{key:"_$AR",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._$AA.nextSibling,e=arguments.length>1?arguments[1]:void 0;for(null===(n=this._$AP)||void 0===n||n.call(this,!1,!0,e);t&&t!==this._$AB;){var n,i=t.nextSibling;t.remove(),t=i;}}},{key:"setConnected",value:function(t){var e;void 0===this._$AM&&(this._$Cv=t,null===(e=this._$AP)||void 0===e||e.call(this,t));}}])}(),K$1=function(){return r$1((function t(e,i,r,o,u){n$1(this,t),this.type=1,this._$AH=V$1,this._$AN=void 0,this.element=e,this.name=i,this._$AM=o,this.options=u,r.length>2||""!==r[0]||""!==r[1]?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=V$1;}),[{key:"tagName",get:function(){return this.element.tagName}},{key:"_$AU",get:function(){return this._$AM._$AU}},{key:"_$AI",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=this.strings,o=!1;if(void 0===r)t=q$1(this,t,e,0),(o=!E$1(t)||t!==this._$AH&&t!==Y$1)&&(this._$AH=t);else {var u,s,l=t;for(t=r[0],u=0;u<r.length-1;u++){var a;(s=q$1(this,l[n+u],e,u))===Y$1&&(s=this._$AH[u]),o||(o=!E$1(s)||s!==this._$AH[u]),s===V$1?t=V$1:t!==V$1&&(t+=(null!==(a=s)&&void 0!==a?a:"")+r[u+1]),this._$AH[u]=s;}}o&&!i&&this.j(t);}},{key:"j",value:function(t){t===V$1?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:"");}}])}(),X$1=function(){function t(){var i;return n$1(this,t),(i=e$2(this,t,arguments)).type=3,i}return a$2(t,K$1),r$1(t,[{key:"j",value:function(t){this.element[this.name]=t===V$1?void 0:t;}}])}(),tt$1=function(){function t(){var i;return n$1(this,t),(i=e$2(this,t,arguments)).type=4,i}return a$2(t,K$1),r$1(t,[{key:"j",value:function(t){this.element.toggleAttribute(this.name,!!t&&t!==V$1);}}])}(),et$1=function(){function t(i,r,o,u,s){var l;return n$1(this,t),(l=e$2(this,t,[i,r,o,u,s])).type=5,l}return a$2(t,K$1),r$1(t,[{key:"_$AI",value:function(t){var e;if((t=null!==(e=q$1(this,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,0))&&void 0!==e?e:V$1)!==Y$1){var n=this._$AH,i=t===V$1&&n!==V$1||t.capture!==n.capture||t.once!==n.once||t.passive!==n.passive,r=t!==V$1&&(n===V$1||i);i&&this.element.removeEventListener(this.name,this,n),r&&this.element.addEventListener(this.name,this,t),this._$AH=t;}}},{key:"handleEvent",value:function(t){var e,n;"function"==typeof this._$AH?this._$AH.call(null!==(e=null===(n=this.options)||void 0===n?void 0:n.host)&&void 0!==e?e:this.element,t):this._$AH.handleEvent(t);}}])}(),nt$1=function(){return r$1((function t(e,i,r){n$1(this,t),this.element=e,this.type=6,this._$AN=void 0,this._$AM=i,this.options=r;}),[{key:"_$AU",get:function(){return this._$AM._$AU}},{key:"_$AI",value:function(t){q$1(this,t);}}])}(),it$1=g$1.litHtmlPolyfillSupport;null!=it$1&&it$1(Q$1,J$1),(null!==(m$1=g$1.litHtmlVersions)&&void 0!==m$1?m$1:g$1.litHtmlVersions=[]).push("3.2.1");var rt$1=function(t,e,n){var i,r=null!==(i=null==n?void 0:n.renderBefore)&&void 0!==i?i:e,o=r._$litPart$;if(void 0===o){var u,s=null!==(u=null==n?void 0:n.renderBefore)&&void 0!==u?u:null;r._$litPart$=o=new J$1(e.insertBefore(T$1(),s),s,void 0,null!=n?n:{});}return o._$AI(t),o},ot$1=1,ut$1=2,st$1=3,lt$1=6,at$1=function(t){return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return {_$litDirective$:t,values:n}}},ct$1=function(){return r$1((function t(e){n$1(this,t);}),[{key:"_$AU",get:function(){return this._$AM._$AU}},{key:"_$AT",value:function(t,e,n){this._$Ct=t,this._$AM=e,this._$Ci=n;}},{key:"_$AS",value:function(t,e){return this.update(t,e)}},{key:"update",value:function(t,e){return this.render.apply(this,p$1(e))}}])}(),ht$1=function(t,e){var n=t._$AN;if(void 0===n)return !1;var i,r=o$1(n);try{for(r.s();!(i=r.n()).done;){var u,s=i.value;null!==(u=s._$AO)&&void 0!==u&&u.call(s,e,!1),ht$1(s,e);}}catch(t){r.e(t);}finally{r.f();}return !0},ft$1=function(t){var e,n;do{var i;if(void 0===(e=t._$AM))break;(n=e._$AN).delete(t),t=e;}while(0===(null===(i=n)||void 0===i?void 0:i.size))},vt$1=function(t){for(var e;e=t._$AM;t=e){var n=e._$AN;if(void 0===n)e._$AN=n=new Set;else if(n.has(t))break;n.add(t),yt$1(e);}};
/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function dt$1(t){void 0!==this._$AN?(ft$1(this),this._$AM=t,vt$1(this)):this._$AM=t;}function pt$1(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this._$AH,r=this._$AN;if(void 0!==r&&0!==r.size)if(e)if(Array.isArray(i))for(var o=n;o<i.length;o++)ht$1(i[o],!1),ft$1(i[o]);else null!=i&&(ht$1(i,!1),ft$1(i));else ht$1(this,t);}var yt$1=function(t){var e,n;t.type==ut$1&&(null!==(e=t._$AP)&&void 0!==e||(t._$AP=pt$1),null!==(n=t._$AQ)&&void 0!==n||(t._$AQ=dt$1));},_t$1=function(){function t(){var i;return n$1(this,t),(i=e$2(this,t,arguments))._$AN=void 0,i}return a$2(t,ct$1),r$1(t,[{key:"_$AT",value:function(e,n,i){((function(t,e,n){var i=s$2(l$1(t.prototype),e,n);return "function"==typeof i?function(t){return i.apply(n,t)}:i}))(t,"_$AT",this)([e,n,i]),vt$1(this),this.isConnected=e._$AU;}},{key:"_$AO",value:function(t){var e,n,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t!==this.isConnected&&(this.isConnected=t,t?null===(e=this.reconnected)||void 0===e||e.call(this):null===(n=this.disconnected)||void 0===n||n.call(this)),i&&(ht$1(this,t),ft$1(this));}},{key:"setValue",value:function(t){if(function(t){return void 0===t.strings}(this._$Ct))this._$Ct._$AI(t,this);else {var e=p$1(this._$Ct._$AH);e[this._$Ci]=t,this._$Ct._$AI(e,this,0);}}},{key:"disconnected",value:function(){}},{key:"reconnected",value:function(){}}])}(),$t$1=new WeakMap,mt$1=at$1(function(){function t(){return n$1(this,t),e$2(this,t,arguments)}return a$2(t,_t$1),r$1(t,[{key:"render",value:function(t){return V$1}},{key:"update",value:function(t,e){var n,i=d$1(e,1)[0],r=i!==this.Y;return r&&void 0!==this.Y&&this.rt(void 0),(r||this.lt!==this.ct)&&(this.Y=i,this.ht=null===(n=t.options)||void 0===n?void 0:n.host,this.rt(this.ct=t.element)),V$1}},{key:"rt",value:function(t){if(this.isConnected||(t=void 0),"function"==typeof this.Y){var e,n=null!==(e=this.ht)&&void 0!==e?e:globalThis,i=$t$1.get(n);void 0===i&&(i=new WeakMap,$t$1.set(n,i)),void 0!==i.get(this.Y)&&this.Y.call(this.ht,void 0),i.set(this.Y,t),void 0!==t&&this.Y.call(this.ht,t);}else this.Y.value=t;}},{key:"lt",get:function(){var t,e,n;return "function"==typeof this.Y?null===(t=$t$1.get(null!==(e=this.ht)&&void 0!==e?e:globalThis))||void 0===t?void 0:t.get(this.Y):null===(n=this.Y)||void 0===n?void 0:n.value}},{key:"disconnected",value:function(){this.lt===this.ct&&this.rt(void 0);}},{key:"reconnected",value:function(){this.rt(this.ct);}}])}()),gt$1="important",At$1=" !"+gt$1,bt$1=at$1(function(){function t(i){var r,o;if(n$1(this,t),o=e$2(this,t,[i]),i.type!==ot$1||"style"!==i.name||(null===(r=i.strings)||void 0===r?void 0:r.length)>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.");return o}return a$2(t,ct$1),r$1(t,[{key:"render",value:function(t){return Object.keys(t).reduce((function(e,n){var i=t[n];return null==i?e:e+"".concat(n=n.includes("-")?n:n.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase(),":").concat(i,";")}),"")}},{key:"update",value:function(t,e){var n=d$1(e,1)[0],i=t.element.style;if(void 0===this.ft)return this.ft=new Set(Object.keys(n)),this.render(n);var r,u=o$1(this.ft);try{for(u.s();!(r=u.n()).done;){var s=r.value;null==n[s]&&(this.ft.delete(s),s.includes("-")?i.removeProperty(s):i[s]=null);}}catch(t){u.e(t);}finally{u.f();}for(var l in n){var a=n[l];if(null!=a){this.ft.add(l);var c="string"==typeof a&&a.endsWith(At$1);l.includes("-")||c?i.setProperty(l,c?a.slice(0,-11):a,c?gt$1:""):i[l]=a;}}return Y$1}}])}()),kt$1=function(){function t(i){var r;if(n$1(this,t),(r=e$2(this,t,[i])).it=V$1,i.type!==ut$1)throw Error(r.constructor.directiveName+"() can only be used in child bindings");return r}return a$2(t,ct$1),r$1(t,[{key:"render",value:function(t){if(t===V$1||null==t)return this._t=void 0,this.it=t;if(t===Y$1)return t;if("string"!=typeof t)throw Error(this.constructor.directiveName+"() called with a non-string value");if(t===this.it)return this._t;this.it=t;var e=[t];return e.raw=e,this._t={_$litType$:this.constructor.resultType,strings:e,values:[]}}}])}();kt$1.directiveName="unsafeHTML",kt$1.resultType=1;var wt$1,Ot$1=at$1(kt$1),Ct$1=function(){function t(i){var r;if(n$1(this,t),r=e$2(this,t,[i]),"class"!==i.name)throw new Error("The `PrefixedCssDirective` must be used as `class` directive");return r}return a$2(t,ct$1),r$1(t,[{key:"update",value:function(t,e){var n=t.options.host.prefix;return n?e.filter((function(t){return !!t&&t.length>0})).map((function(t){return "".concat(n,"-").concat(t)})).join(" "):Y$1}}])}(),xt$1=at$1(Ct$1),Tt$1=at$1(function(){function t(i){var r;if(n$1(this,t),r=e$2(this,t,[i]),"class"!==i.name)throw new Error("The `PrefixedCssDirective` must be used as `class` directive");return r}return a$2(t,ct$1),r$1(t,[{key:"update",value:function(t){var e,n,i=t.options.host.prefix;if(!i)return "";var r=null===(e=t.options.host.nav)||void 0===e?void 0:e.active;if(!r)return "";var o=null===(n=t.element.dataset)||void 0===n?void 0:n.navName;return o&&o===r?"".concat(i,"-nav-focus"):""}}])}()),Et$1=function(){function t(i){var r;n$1(this,t),u$1(r=e$2(this,t,[i]),"_id",null),u$1(r,"_baseUrl",null);var o=i.type,s=i.element,l=i.options;if(o!==lt$1)throw new Error("The `icon` directive must be used as `element` directive");var a=l.host.prefix;return r._addCssClass(s,a),r}return a$2(t,ct$1),r$1(t,[{key:"update",value:function(t,e){var n=d$1(e,1)[0];if(!n)return Y$1;var i=n.id,r=location.hash?location.href.split(location.hash).join(""):location.href;if(this._id===i&&this._baseUrl===r)return Y$1;var o=this._parse(t,n),u=o.element,s=o.host,l=o.prefix,a=o.skinIcoPrefix,c=o.type,h=o.group;try{switch(c){case"css":this._addCssClass(u,l,h),this._updateId(u,i);break;case"svg":rt$1(B$1(wt$1||(wt$1=function(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(['<svg xmlns="http://www.w3.org/2000/svg"><use href="',"#","",'"></use></svg>'])),r,a,i),u,{host:s}),this._addCssClass(u,l,h),this._updateId(u,i);}}catch(t){console.error(t);}return this._baseUrl=r,Y$1}},{key:"render",value:function(t){return V$1}},{key:"_parse",value:function(t,e){var n=t.element,i=t.options.host,r=i.prefix,o=i.icon,u=o.skinIcoPrefix,s=null,l=null;return "group"in e&&e.group in o&&(s=o[l=e.group].type),!s&&null!=o&&o.type&&(s=null==o?void 0:o.type),{element:n,host:i,skinIcoPrefix:u,prefix:r,type:s,group:l}}},{key:"_updateId",value:function(t,e){t.classList.contains(this._id)&&t.classList.remove(this._id),t.classList.contains(e)||t.classList.add(e),this._id=e;}},{key:"_addCssClass",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i="".concat(e,"-ico");if(t.classList.contains(i)||t.classList.add(i),null!=n){var r="".concat(e,"-").concat(n,"-ico");t.classList.contains(r)||t.classList.add(r);}}}])}(),jt$1=at$1(Et$1),St$1=at$1(function(){function t(i){var r;if(n$1(this,t),u$1(r=e$2(this,t,[i]),"_target",null),u$1(r,"_count",0),u$1(r,"_defaultSingleClick",null),u$1(r,"defaultDoubleClick",null),i.type!==lt$1)throw new Error("The `multiclick` directive must be used as `element` directive");var o=r._handleClick.bind(r),s=i.element;return s&&s.removeEventListener("click",o),null==s||s.addEventListener("click",o),r}return a$2(t,ct$1),r$1(t,[{key:"update",value:function(t,e){var n=d$1(e,2),i=n[0],r=n[1];return this._defaultSingleClick=i,this._defaultDoubleClick=r,Y$1}},{key:"render",value:function(t,e){return this._defaultSingleClick=t,this._defaultDoubleClick=e,V$1}},{key:"_handleClick",value:function(t){var e=this;if(null!=this.timeout&&clearTimeout(this.timeout),t.target.isSameNode(this._target)||(this._count=0),this._target=t.target,this._count++,t.defaultPrevented)return this._count=0,void(this._target=null);this._dispatchEvent("multiclick"),this.timeout=setTimeout((function(){if(null!=e.timeout&&clearTimeout(e.timeout),t.defaultPrevented)return e._count=0,e._dispatchEvent("multiclick"),void(e._target=null);e._count>1?("function"==typeof e._defaultDoubleClick&&e._defaultDoubleClick(t),e._dispatchEvent("doublemulticlick")):("function"==typeof e._defaultSingleClick&&e._defaultSingleClick(t),e._dispatchEvent("singlemulticlick")),e._count=0,e._target=null;}),250);}},{key:"_dispatchEvent",value:function(t){this._target.dispatchEvent(new CustomEvent(t,{detail:{count:this._count}}));}}])}()),Pt$1=function(){function t(i){var r;if(n$1(this,t),r=e$2(this,t,[i]),i.type!==st$1||"style"!==i.name)throw new Error("The `PopupTipOffsetDirective` must be used as `style` directive");return r}return a$2(t,ct$1),r$1(t,[{key:"update",value:function(t){var e=t.options.host.prefix;if(!e)return null;var n="calc(var(--".concat(e,"-popup-anchor-x) - var(--").concat(e,"-popup-window-x) - (var(--").concat(e,"-width) / 2) + (var(--").concat(e,"-bar-row-size) / 2))");return "--".concat(e,"-popup-tip-offset: ").concat(n)}},{key:"_isEmptyDOMRect",value:function(t){return !t.x||!t.y||!t.width||!t.height||0===t.width&&0===t.height}}])}(),Nt$1=at$1(Pt$1),Ht$1=at$1(function(){function t(i){var r;if(n$1(this,t),r=e$2(this,t,[i]),i.type!==ot$1||"class"!==i.name)throw new Error("The `PopupOpennedDirective` must be used as `class` directive");return r}return a$2(t,ct$1),r$1(t,[{key:"update",value:function(t,e){if(t.options.host.hide.active)return null;var n=t.options.host.prefix;if(!n)return null;var i=e[0];if(!i)return null;var r=t.options.host.popup;if(r&&r.active&&r.active.includes(i))return "".concat(n,"-popup-openned");var o=t.options.host.nav;return o&&o.active&&o.active.includes(i)?"".concat(n,"-popup-openned"):null}}])}()),Mt$1=at$1(function(){function t(i){var r;if(n$1(this,t),r=e$2(this,t,[i]),i.type!==lt$1)throw new Error("The `ScrollIntoViewDirective` must be used as ELEMENT directive");return r}return a$2(t,ct$1),r$1(t,[{key:"update",value:function(t){return t.options.host.hide.active||t.element&&t.element.scrollIntoView({behavior:"instant",block:"nearest",inline:"nearest"}),Y$1}}])}()),It$1=function(){function t(i){var r;if(n$1(this,t),r=e$2(this,t,[i]),"style"!==i.name)throw new Error("The `SizeCssVarDirective` must be used as `style` directive");return r}return a$2(t,ct$1),r$1(t,[{key:"update",value:function(t,e){var n=t.options.host.prefix;if(!n)return null;var i=e[0];if(!i)return null;var r=e[1];if(!r)return null;var o=t.element;if(!o)return null;var u=o.getBoundingClientRect();return this._isEmptyDOMRect(u)?null:r in u?"--".concat(n,"-").concat(i,"-").concat(r,": ").concat(u[r],"px"):null}},{key:"_isEmptyDOMRect",value:function(t){return !t.x||!t.y||!t.width||!t.height||0===t.width&&0===t.height}}])}(),Dt$1=at$1(It$1),Lt$1={html:U$1,svg:B$1,nothing:V$1,render:rt$1,asHtml:Ot$1,ctrl:mt$1,style:bt$1,optional:function(t){return null!=t?t:V$1},multiclick:St$1,icon:jt$1,css:xt$1,navFocus:Tt$1,sizeCssVar:Dt$1,scrollIntoView:Mt$1,popupOpenned:Ht$1,popupTipOffset:Nt$1},Rt$1=Object.keys(Lt$1).map((function(t){return "var ".concat(t," = this.").concat(t,";")})).join(""),Ut$1=f$1(f$1({},Lt$1),{},{template:function(t){return Function("context","return (function lit(ctx) { "+Rt$1+" return "+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"html")+"`"+t+"`; }).call(this,context)").bind(Lt$1)}});exports.lit=Ut$1;
!function(e,t){e.bs=e.bs||{},e.bs.player=e.bs.player||{},e.bs.player.plugin=e.bs.player.plugin||{},e.bs.player.plugin.dataProvider=e.bs.player.plugin.dataProvider||{};var r=function(){return B.__string_rec(this,"")},a=a||{};Math.__name__="Math";var s=require("haxe.Reflect");class i{static string(e){return B.__string_rec(e,"")}}i.__name__="Std";var l=require("haxe.StringTools"),o=require("bs.net.Http"),n=require("bs.player.core.events.ControlEvent"),p=require("bs.player.core.events.DataProviderEvent"),c=require("bs.player.core.events.ErrorEvent"),u=require("bs.player.core.manager.I18NHelper"),h=require("bs.player.core.model.Media"),d=require("bs.player.core.model.LiveStream"),_=require("bs.player.core.model.LiveChannel"),m=require("bs.player.core.model.MediaPlaylist"),g=require("bs.player.core.model.MediaSource"),y=require("bs.player.core.model.MediaDetails"),b=require("bs.player.core.model.MediaUserSettings"),P=require("bs.player.core.model.MediaSettings"),O=require("bs.player.core.model.MediaPlaybackInfo"),f=require("bs.player.core.model.SubtitlesSet"),w=require("bs.player.core.model.AudioSet"),S=require("bs.player.core.model.Image"),v=require("bs.player.core.model.Genre"),j=require("bs.player.core.model.MediaProgress");class x{constructor(e){x._hx_skip_constructor||this._hx_constructor(e);}_hx_constructor(e){null==e&&(e=5),this.pluginName="";let t=B.getClass(this);this.pluginName=t.__name__.split(".").pop(),this.initPriority=e;let r=this.pluginName,a=exports.configuration;this.pluginConfig=null!=a&&Object.prototype.hasOwnProperty.call(a,r)?s.field(a,r):Object.create(null);}create(){}destroy(){}activate(){}postActivate(){}deactivate(){}eventFilter(e){return !0}registerPlugin(e){}getPluginVersion(){return "v2.15.38"}getPluginName(){return this.pluginName}get_player(){return this.player}set_player(e){return this.player=e}get_variables(){return this.variables}set_variables(e){return this.variables=e}get_eventHub(){return this.eventHub}set_eventHub(e){return this.eventHub=e}get_parentDisplay(){return this.parentDisplay}set_parentDisplay(e){return this.parentDisplay=e}get_display(){return this.display}isCriticalForPlayback(){return !0}}x.__name__="bs.player.core.plugin.PluginBase",Object.assign(x.prototype,{__class__:x});class E extends x{constructor(){x._hx_skip_constructor=!0,super(),x._hx_skip_constructor=!1,this._hx_constructor();}_hx_constructor(){this.emittedMediaPlaylist=null,this.emittedMedia=null,this.data=null,this.reportErrors=!0,this.debugMode=!1,super._hx_constructor(2);let e=B.getClass(this);this.thisClass=e.__name__.split(".").pop(),this.parser=new D(this.reportErrors),this.parser.reportError=q(this,this.reportError);}activate(){super.activate();let e=this.get_variables();Object.prototype.hasOwnProperty.call(e,"dataDebugMode")&&(this.debugMode=s.field(this.get_variables(),"dataDebugMode"));let t=this.get_variables();Object.prototype.hasOwnProperty.call(t,"dataReportErrors")&&(this.reportErrors=s.field(this.get_variables(),"dataReportErrors"));}postActivate(){let e=this.get_variables();if(Object.prototype.hasOwnProperty.call(e,"dataSource"))this.mediaLoad(s.field(this.get_variables(),"dataSource"));else {let e=this.get_variables();Object.prototype.hasOwnProperty.call(e,"dataProvider")&&this.parseData(s.field(this.get_variables(),"dataProvider"));}}changeSource(e){this.mediaLoad(e);}injectData(e){this.parseData(e);}mediaLoad(e){if(null==e){if(this.reportErrors||this.debugMode){let e="["+this.thisClass+"] Error in BradmaxDataProvider : Empty source url";console.error(e);let t=new c("mediaProviderError");t.data="Error in BradmaxDataProvider : Empty source url",t.dispatch(this.context);}return}let t=new o(e);t.onData=q(this,this.parseString),t.onError=q(this,this.mediaLoadError),t.request(!1);}mediaLoadError(e){let t="Error in BradmaxDataProvider : Invalid http request: "+i.string(e);if(this.reportErrors||this.debugMode){let e="["+this.thisClass+"] "+t;console.error(e);let r=new c("mediaProviderError");r.data=t,r.dispatch(this.context);}}parseString(e){this.data=null;try{let t=e;for(;-1!=t.indexOf("/*")||-1!=t.indexOf("*/");){let e=t.indexOf("/*"),r=t.indexOf("*/",e)+2;-1!=e&&-1!=r&&(t=t.substring(0,e)+t.substring(r,t.length));}this.data=JSON.parse(t);}catch(e){let t="Error in BradmaxDataProvider : Invalid string while parsing to object (JSON) : "+i.string(N.caught(e).unwrap());if(this.reportErrors||this.debugMode){let e="["+this.thisClass+"] "+t;console.error(e);let r=new c("mediaProviderError");r.data=t,r.dispatch(this.context);}return}if(null!=this.data)this.parseData(this.data);else if(this.reportErrors||this.debugMode){let e="["+this.thisClass+"] Error in BradmaxDataProvider : Invalid string while parsing to object (JSON)";console.error(e);let t=new c("mediaProviderError");t.data="Error in BradmaxDataProvider : Invalid string while parsing to object (JSON)",t.dispatch(this.context);}}parseData(e){if(null==this.parser){if(this.reportErrors||this.debugMode){let e="["+this.thisClass+"] Error in BradmaxDataProvider : BradmaxMediaParser return empty object";console.error(e);let t=new c("mediaProviderError");t.data="Error in BradmaxDataProvider : BradmaxMediaParser return empty object",t.dispatch(this.context);}return}if(null!=e&&!(e instanceof Array)){let t=e;e=[t];let r=this.parsePlaylistLegacyNames(t);if(null!=r){let t=0;for(;t<r.length;)e.push(r[t++]);}}if(this.parser.parse(e),null==this.parser.playlist){if(this.reportErrors||this.debugMode){let e="["+this.thisClass+"] Error in BradmaxDataProvider : BradmaxMediaParser return empty playlist object";console.error(e);let t=new c("mediaProviderError");t.data="Error in BradmaxDataProvider : BradmaxMediaParser return empty playlist object",t.dispatch(this.context);}return}let t=this.get_variables();if(Object.prototype.hasOwnProperty.call(t,"startTime")&&this.get_variables().startTime>0&&this.parser.playlist.items.length>0){let e=this.parser.playlist.items[0],t=this.get_variables();e.mediaUserSettings.resumePostion=s.field(t,"startTime"),s.deleteField(this.get_variables(),"startTime");}this.parser.playlist.hasNext()&&(this.emitMedia(this.parser.playlist.next()),this.emittedMediaPlaylist=this.parser.playlist,this.emitMediaPlaylist(this.emittedMediaPlaylist));}parsePlaylistLegacyNames(e){let t=null,r=["mediaPlaylist","playList"],a=0;for(;a<r.length;){let s=r[a];if(++a,t=this.findPlaylistLegacyName(s,e),null==t&&(t=this.findPlaylistLegacyName(s.toLowerCase(),e)),null!=t)return t}return t}findPlaylistLegacyName(e,t){let r=null;if(Object.prototype.hasOwnProperty.call(t,e)){let a=s.field(t,e);if(a instanceof Array)r=a;else if(Object.prototype.hasOwnProperty.call(a,"items")){let e=s.field(a,"items");e instanceof Array&&(r=e);}s.deleteField(t,e);}return r}emitMediaPlaylist(e){let t=new p("mediaPlaylistData");t.data=e,t.dispatch(this.context);}orderMediaSourceForBetterSupport(e){if(null==e||null==e.source||0==e.source.length)return;let t=null;t=C.mobile||"Safari"==C.browserName?[q(this,this.isHlsUrl),q(this,this.isMpegDashUrl),q(this,this.isMsSmoothStreamingUrl)]:"Edge"==C.browserName||"Microsoft Internet Explorer"==C.browserName?[q(this,this.isMsSmoothStreamingUrl),q(this,this.isMpegDashUrl),q(this,this.isHlsUrl)]:[q(this,this.isMpegDashUrl),q(this,this.isHlsUrl),q(this,this.isMsSmoothStreamingUrl)];let r=[],a=new U,s=0,i=e.source;for(;s<i.length;)a.add(i[s++]);let l=0;for(;l<t.length;){let e=t[l++],s=new U,i=a.h;for(;null!=i;){let t=i.item;i=i.next,e(t.url)&&(r.push(t),s.add(t));}let o=s.h;for(;null!=o;){let e=o.item;o=o.next,a.remove(e);}}let o=a.h;for(;null!=o;){let e=o.item;o=o.next,r.push(e);}e.source=r;}isHlsUrl(e){return this.normalizeSourceUrl(e).endsWith(".m3u8")}isMpegDashUrl(e){return this.normalizeSourceUrl(e).endsWith(".mpd")}isMsSmoothStreamingUrl(e){let t=this.normalizeSourceUrl(e);return !!t.endsWith(".ism/manifest")||t.endsWith(".isml/manifest")}normalizeSourceUrl(e){return null==e?"":e.split("?")[0].toLowerCase()}emitMedia(e){this.orderMediaSourceForBetterSupport(e),this.emittedMedia=e;let t=new p("mediaMetadataData");t.data=e,t.dispatch(this.context);let r=new p("movieData");r.data=e,r.dispatch(this.context);let a=new p("subtitleData");null!=e.subtitlesSets?a.data=e.subtitlesSets:a.data=null,a.dispatch(this.context),this.emitSubtitlesSet(e.subtitlesSets);let s=new p("audioData");null!=e.audioSets?s.data=e.audioSets:s.data=null,s.dispatch(this.context),this.emitAudioSet(e.audioSets);}emitAudioSet(e){if(null==e)return;let t=null,r=this.get_variables();Object.prototype.hasOwnProperty.call(r,"audio")&&(t=s.field(this.get_variables(),"audio"));let a=!1,o=null;if(o=W.getSessionStorage(),a=null!=o,a){let e,r=null,a=!1,s=null;if(s=W.getSessionStorage(),a=null!=s,a){try{let e,t=null,a=!1,s=null;if(s=W.getSessionStorage(),a=null!=s,a){let r=null;r=W.getSessionStorage(),t=r.getItem("_brplayer_aud_lang"),null==t||(t=l.trim(t)),e=t;}else e=t;null!=e&&""!=e&&(r=e);}catch(p){console.warn("Error occured durring loading audio language from session storage.");}e=r;}else e=r;null!=e&&(t=e);}if(null==t)return;let p=[],c=0;for(;c<e.length;){let r=e[c];++c,r.languageCode==t&&p.push(r);}if(null==p||p.length<1)return;let u=p[0];if(null==u)return;let h=new n("selectAudio");h.data=u,h.dispatch(this.context);let d=u.languageCode,_=!1,m=null;if(m=W.getSessionStorage(),_=null!=m,_)try{if(null==d){let e=null;e=W.getSessionStorage(),e.removeItem("_brplayer_aud_lang");}else {let e=null;e=W.getSessionStorage(),e.setItem("_brplayer_aud_lang",i.string(d));}}catch(p){console.warn("Error occured durring writing audio language into session storage.");}}emitSubtitlesSet(e){if(null==e)return;let t=null,r=this.get_variables();Object.prototype.hasOwnProperty.call(r,"subtitles")&&(t=s.field(this.get_variables(),"subtitles"));let a=!1,o=null;if(o=W.getSessionStorage(),a=null!=o,a){let e,r=null,a=!1,s=null;if(s=W.getSessionStorage(),a=null!=s,a){try{let e,t=null,a=!1,s=null;if(s=W.getSessionStorage(),a=null!=s,a){let r=null;r=W.getSessionStorage(),t=r.getItem("_brplayer_sub_lang"),null==t||(t=l.trim(t)),e=t;}else e=t;null!=e&&""!=e&&(r=e);}catch(p){console.warn("Error occured durring loading subtitles language from session storage.");}e=r;}else e=r;null!=e&&(t=e);}if(null==t)return;let p=[],c=0;for(;c<e.length;){let r=e[c];++c,r.languageCode==t&&p.push(r);}if(null==p||p.length<1)return;let u=p[0];if(null==u)return;let h=new n("selectSubtitles");h.data=u,h.dispatch(this.context);let d=u.languageCode,_=!1,m=null;if(m=W.getSessionStorage(),_=null!=m,_)try{if(null==d){let e=null;e=W.getSessionStorage(),e.removeItem("_brplayer_sub_lang");}else {let e=null;e=W.getSessionStorage(),e.setItem("_brplayer_sub_lang",i.string(d));}}catch(p){console.warn("Error occured durring writing subtitles language into session storage.");}}emitDebug(e){}emitWarning(e){if(this.reportErrors||this.debugMode){let t="["+this.thisClass+"] "+e;console.warn(t);}}emitError(e){if(this.reportErrors||this.debugMode){let t="["+this.thisClass+"] "+e;console.error(t);let r=new c("mediaProviderError");r.data=e,r.dispatch(this.context);}}reportError(e,t){if(e!=M.ERROR){if(e==M.WARNING&&(this.reportErrors||this.debugMode)){let e="["+this.thisClass+"] Warning in BradmaxDataProvider : parser : "+t;console.warn(e);}}else {let e="Error in BradmaxDataProvider : parser : "+t;if(this.reportErrors||this.debugMode){let t="["+this.thisClass+"] "+e;console.error(t);let r=new c("mediaProviderError");r.data=e,r.dispatch(this.context);}}}}e.bs.player.plugin.dataProvider.BradmaxDataProvider=E,E.__name__="bs.player.plugin.dataProvider.BradmaxDataProvider",E.__super__=x,Object.assign(E.prototype,{__class__:E});var M=a["bs.player.plugin.dataProvider.BradmaxDataParseExceptionType"]={__ename__:!0,__constructs__:null,ERROR:{_hx_name:"ERROR",_hx_index:0,__enum__:"bs.player.plugin.dataProvider.BradmaxDataParseExceptionType",toString:r},WARNING:{_hx_name:"WARNING",_hx_index:1,__enum__:"bs.player.plugin.dataProvider.BradmaxDataParseExceptionType",toString:r}};M.__constructs__=[M.ERROR,M.WARNING];class D{constructor(e){null==e&&(e=!1),this.reportErrors=!1,this.reportErrors=e;}reportError(e,t){}parse(e){this.playlist=new m;let t=0;for(;t<e.length;)this.playlist.items.push(this.parseMedia(e[t++]));}parseMedia(e){let t=new h;if(Object.prototype.hasOwnProperty.call(e,"liveStream")&&null!=s.field(e,"liveStream")&&(t=new d,t.duration=-1),Object.prototype.hasOwnProperty.call(e,"channel")&&(t=new _),Object.prototype.hasOwnProperty.call(e,"customParams")&&(t.customParams=e.customParams),Object.prototype.hasOwnProperty.call(e,"id")&&(t.id=e.id),Object.prototype.hasOwnProperty.call(e,"title")&&(t.title=e.title),Object.prototype.hasOwnProperty.call(e,"duration")&&(t.duration=e.duration),Object.prototype.hasOwnProperty.call(e,"source"))t.source=this.parseMediaSource(e.source);else if(Object.prototype.hasOwnProperty.call(e,"sourceWithFallbacks")){let r=this.parseMediaSourceWithFallbacls(e.sourceWithFallbacks);r.length>0&&(t.source=r[0]),r.length>1&&(t.sourceFallbacks=r.slice(1));}else this.reportErrors&&this.reportError(M.ERROR,"media source is missing");if(this.reportErrors&&0==t.source.length&&this.reportError(M.ERROR,"media sources are empty"),Object.prototype.hasOwnProperty.call(e,"audioSets")&&(t.audioSets=this.parseMediaAudioSet(e.audioSets)),Object.prototype.hasOwnProperty.call(e,"mediaDetails")&&(t.mediaDetails=this.parseMediaDetails(e.mediaDetails)),Object.prototype.hasOwnProperty.call(e,"mediaPlaybackInfo")&&(t.mediaPlaybackInfo=this.parseMediaPlaybackInfo(e.mediaPlaybackInfo)),Object.prototype.hasOwnProperty.call(e,"mediaSettings")&&(t.mediaSettings=this.parseMediaSettings(e.mediaSettings)),Object.prototype.hasOwnProperty.call(e,"mediaUserSettings")&&(t.mediaUserSettings=this.parseMediaUserSettings(e.mediaUserSettings)),Object.prototype.hasOwnProperty.call(e,"splashImages")&&(t.splashImages=this.parseMediaImages(e.splashImages)),Object.prototype.hasOwnProperty.call(e,"subtitlesSets")&&(t.subtitlesSets=this.parseMediaSubtitleSets(e.subtitlesSets)),Object.prototype.hasOwnProperty.call(e,"posterImages")&&(t.posterImages=this.parseMediaImages(e.posterImages)),Object.prototype.hasOwnProperty.call(e,"mediaLandingPage")&&(t.mediaLandingPage=e.mediaLandingPage),Object.prototype.hasOwnProperty.call(e,"progress")&&(t.progress=this.parseProgress(e.progress)),t instanceof _?this.parseLiveChannelFields(t,e):t instanceof d&&this.parseLiveStreamFields(t,e),Object.prototype.hasOwnProperty.call(e,"spherical"))switch(""+e.spherical){case"1":case"true":t.spherical=!0;break;default:t.spherical=!1;}return Object.prototype.hasOwnProperty.call(e,"contentMeta")&&(t.contentMeta=this.parseContentMeta(e.contentMeta)),t}parseLiveStreamFields(e,t){let r=s.field(t,"liveStream");Object.prototype.hasOwnProperty.call(r,"endDate")&&(e.streamEnd=this.parseIso8266Date(r.endDate)),Object.prototype.hasOwnProperty.call(r,"thankYouImageUrl")&&(e.streamEndThankYouImageUrl=r.thankYouImageUrl),Object.prototype.hasOwnProperty.call(r,"waitingForTransmissionImageUrl")&&(e.streamWaitingForTransmissionImageUrl=r.waitingForTransmissionImageUrl),Object.prototype.hasOwnProperty.call(r,"lowLatencyMode")&&(e.lowLatencyMode=r.lowLatencyMode);}parseIso8266Date(e){let t=new Date(e);return new Date(t.getTime())}parseLiveChannelFields(e,t){e.id=t.id,e.name=null!=t.channel?t.channel.name:t.title;}parseMediaSource(e){let t=[],r=0;for(;r<e.length;){let a=e[r];++r;let i=new g;if(Object.prototype.hasOwnProperty.call(a,"customParams"))if(B.__implements(a.customParams,I))i.customParams=a.customParams;else if(B.__instanceof(a.customParams,k)){let e=0,t=s.fields(a.customParams);for(;e<t.length;){let r=t[e];++e,i.customParams.h[r]=s.field(a.customParams,r);}}Object.prototype.hasOwnProperty.call(a,"id")&&(i.id=a.id),Object.prototype.hasOwnProperty.call(a,"url")?i.url=a.url:this.reportErrors&&this.reportError(M.WARNING,"media source need url attribute to be present"),Object.prototype.hasOwnProperty.call(a,"width")&&(i.width=a.width),Object.prototype.hasOwnProperty.call(a,"height")&&(i.height=a.height),Object.prototype.hasOwnProperty.call(a,"contentType")&&(i.contentType=a.contentType),Object.prototype.hasOwnProperty.call(a,"drm")&&(i.drm=this.parseDrm(a.drm)),t.push(i);}return t}parseDrm(e){return {provider:s.field(e,"provider"),selectedDrmSystem:s.field(e,"selectedDrmSystem"),playready:this.parseDrmData(s.field(e,"playready")),widevine:this.parseDrmData(s.field(e,"widevine")),fairplay:this.parseDrmData(s.field(e,"fairplay"))}}parseDrmData(e){return null==e?null:{laUrl:s.field(e,"laUrl"),customData:s.field(e,"customData"),certUrl:s.field(e,"certUrl"),audioRobustness:s.field(e,"audioRobustness"),videoRobustness:s.field(e,"videoRobustness")}}parseMediaSourceWithFallbacls(e){let t=[],r=0;for(;r<e.length;){let a=e[r];++r;let s=[],i=0;for(;i<a.length;){let e=a[i];++i;let t=new g;Object.prototype.hasOwnProperty.call(e,"customParams")&&(t.customParams=e.customParams),Object.prototype.hasOwnProperty.call(e,"id")&&(t.id=e.id),Object.prototype.hasOwnProperty.call(e,"url")?t.url=e.url:this.reportErrors&&this.reportError(M.WARNING,"media source need url attribute to be present"),Object.prototype.hasOwnProperty.call(e,"width")&&(t.width=e.width),Object.prototype.hasOwnProperty.call(e,"height")&&(t.height=e.height),Object.prototype.hasOwnProperty.call(e,"contentType")&&(t.contentType=e.contentType),s.push(t);}t.push(s);}return t}parseMediaAudioSet(e){let t=[],r=0;for(;r<e.length;){let a=e[r];++r;let s=new w;Object.prototype.hasOwnProperty.call(a,"customParams")&&(s.customParams=a.customParams),Object.prototype.hasOwnProperty.call(a,"id")&&(s.id=a.id),Object.prototype.hasOwnProperty.call(a,"languageCode")?(s.name=u.getLanguageNativeNameByCode(a.languageCode),s.languageCode=a.languageCode):this.reportErrors?this.reportError(M.WARNING,"media audio set need languageCode attribute to be present"):Object.prototype.hasOwnProperty.call(a,"name")&&(s.name=a.name),t.push(s);}return t}parseMediaDetails(e){let t=new y;return Object.prototype.hasOwnProperty.call(e,"customParams")&&(t.customParams=s.field(e,"customParams")),Object.prototype.hasOwnProperty.call(e,"descriptionLong")&&(t.descriptionLong=e.descriptionLong),Object.prototype.hasOwnProperty.call(e,"descriptionShort")&&(t.descriptionShort=e.descriptionShort),Object.prototype.hasOwnProperty.call(e,"directors")&&(t.directors=e.directors),Object.prototype.hasOwnProperty.call(e,"genres")&&(t.genres=this.parseMediaGenres(e.genres)),Object.prototype.hasOwnProperty.call(e,"mediaCast")&&(t.mediaCast=e.mediaCast),Object.prototype.hasOwnProperty.call(e,"tags")&&(t.tags=e.tags),Object.prototype.hasOwnProperty.call(e,"year")&&(t.year=e.year),t}parseMediaGenres(e){let t=[],r=0;for(;r<e.length;){let a=e[r];++r;let s=new v;Object.prototype.hasOwnProperty.call(a,"customParams")&&(s.customParams=a.customParams),Object.prototype.hasOwnProperty.call(a,"id")&&(s.id=a.id),Object.prototype.hasOwnProperty.call(a,"name")?s.name=a.name:this.reportErrors&&this.reportError(M.WARNING,"media genre need name attribute to be present"),t.push(s);}return t}parseMediaPlaybackInfo(e){let t=new O;return Object.prototype.hasOwnProperty.call(e,"currentTime")&&(t.currentTime=e.currentTime),Object.prototype.hasOwnProperty.call(e,"isPlaying")&&(t.isPlaying=e.isPlaying),Object.prototype.hasOwnProperty.call(e,"customParams")&&(t.customParams=e.customParams),t}parseProgress(e){let t=new j;if(Object.prototype.hasOwnProperty.call(e,"segments")){let r=e.segments;null!=r&&(r instanceof Array&&(t.segments=r),"string"==typeof r&&(t.segmentsUrl=r));}if(Object.prototype.hasOwnProperty.call(e,"markers")){let r=e.markers;null!=r&&(r instanceof Array&&(t.markers=r),"string"==typeof r&&(t.markersUrl=r));}return Object.prototype.hasOwnProperty.call(e,"thumbnails")&&(t.thumbnails=e.thumbnails),t}parseContentMeta(e){let t=new A,r=0,a=s.fields(e);for(;r<a.length;){let i=a[r];++r,t.h[i]=s.field(e,i);}return t}parseMediaSettings(e){let t=new P;return Object.prototype.hasOwnProperty.call(e,"hasConcurrencyControl")&&(t.hasConcurrencyControl=e.hasConcurrencyControl),Object.prototype.hasOwnProperty.call(e,"customParams")&&(t.customParams=e.customParams),t}parseMediaUserSettings(e){let t=new b;return Object.prototype.hasOwnProperty.call(e,"hasWatchingFinished")&&(t.hasWatchingFinished=e.hasWatchingFinished),Object.prototype.hasOwnProperty.call(e,"isFavorite")&&(t.isFavorite=e.isFavorite),Object.prototype.hasOwnProperty.call(e,"resumePostion")&&(t.resumePostion=e.resumePostion),Object.prototype.hasOwnProperty.call(e,"wasWatched")&&(t.wasWatched=e.wasWatched),t}parseMediaImages(e){let t=[],r=0;for(;r<e.length;){let a=e[r];++r;let s=new S;Object.prototype.hasOwnProperty.call(a,"customParams")&&(s.customParams=a.customParams),Object.prototype.hasOwnProperty.call(a,"id")&&(s.id=a.id),Object.prototype.hasOwnProperty.call(a,"url")?s.url=a.url:this.reportErrors&&this.reportError(M.WARNING,"media image need url attribute to be present"),Object.prototype.hasOwnProperty.call(a,"width")&&(s.width=a.width),Object.prototype.hasOwnProperty.call(a,"height")&&(s.height=a.height),t.push(s);}return t}parseMediaSubtitleSets(e){let t=[],r=0;for(;r<e.length;){let a=e[r];++r;let s=new f;Object.prototype.hasOwnProperty.call(a,"customParams")&&(s.customParams=a.customParams),Object.prototype.hasOwnProperty.call(a,"id")&&(s.id=a.id),Object.prototype.hasOwnProperty.call(a,"url")?s.url=a.url:this.reportErrors&&this.reportError(M.WARNING,"media subtitle set need url attribute to be present"),Object.prototype.hasOwnProperty.call(a,"languageCode")?(s.name=u.getLanguageNativeNameByCode(a.languageCode),s.languageCode=a.languageCode):this.reportErrors?this.reportError(M.WARNING,"media subtitle set need languageCode attribute to be present"):Object.prototype.hasOwnProperty.call(a,"name")&&(s.name=a.name),t.push(s);}return t}}D.__name__="bs.player.plugin.dataProvider.BradmaxMediaParser",Object.assign(D.prototype,{__class__:D});var C=require("bs.util.BrowserTools");class I{}I.__name__="haxe.IMap",I.__isInterface__=!0;class N extends Error{constructor(e,t,r){super(e),this.message=e,this.__previousException=t,this.__nativeException=null!=r?r:this;}unwrap(){return this.__nativeException}static caught(e){return e instanceof N?e:e instanceof Error?new N(e.message,null,e):new L(e,null,e)}}N.__name__="haxe.Exception",N.__super__=Error,Object.assign(N.prototype,{__class__:N});class L extends N{constructor(e,t,r){super(String(e),t,r),this.value=e;}unwrap(){return this.value}}L.__name__="haxe.ValueException",L.__super__=N,Object.assign(L.prototype,{__class__:L});var U=require("haxe.ds.List");class R{constructor(e,t){this.item=e,this.next=t;}}R.__name__="haxe.ds._List.ListNode",Object.assign(R.prototype,{__class__:R});var A=require("haxe.ds.StringMap");class B{static getClass(e){if(null==e)return null;if(e instanceof Array)return Array;{let t=e.__class__;if(null!=t)return t;let r=B.__nativeClassName(e);return null!=r?B.__resolveNativeClass(r):null}}static __string_rec(e,t){if(null==e)return "null";if(t.length>=5)return "<...>";let r=typeof e;switch("function"==r&&(e.__name__||e.__ename__)&&(r="object"),r){case"function":return "<function>";case"object":if(e.__enum__){let r=a[e.__enum__].__constructs__[e._hx_index],s=r._hx_name;return r.__params__?(t+="\t",s+"("+function(){let a=[];{let s=0,i=r.__params__;for(;s<i.length;){let r=i[s];s+=1,a.push(B.__string_rec(e[r],t));}}return a}().join(",")+")"):s}if(e instanceof Array){let r="[";t+="\t";let a=0,s=e.length;for(;a<s;){let s=a++;r+=(s>0?",":"")+B.__string_rec(e[s],t);}return r+="]",r}let r;try{r=e.toString;}catch(e){return "???"}if(null!=r&&r!=Object.toString&&"function"==typeof r){let t=e.toString();if("[object Object]"!=t)return t}let s="{\n";t+="\t";let i=null!=e.hasOwnProperty,l=null;for(l in e)i&&!e.hasOwnProperty(l)||"prototype"!=l&&"__class__"!=l&&"__super__"!=l&&"__interfaces__"!=l&&"__properties__"!=l&&(2!=s.length&&(s+=", \n"),s+=t+l+" : "+B.__string_rec(e[l],t));return s+="\n"+(t=t.substring(1))+"}",s;case"string":return e;default:return String(e)}}static __interfLoop(e,t){for(;;){if(null==e)return !1;if(e==t)return !0;let r=e.__interfaces__;if(null!=r&&(null==e.__super__||e.__super__.__interfaces__!=r)){let e=0,a=r.length;for(;e<a;){let a=r[e++];if(a==t||B.__interfLoop(a,t))return !0}}e=e.__super__;}}static __instanceof(e,t){if(null==t)return !1;switch(t){case Array:return e instanceof Array;case G:return "boolean"==typeof e;case k:return null!=e;case T:return "number"==typeof e;case F:return "number"==typeof e&&(0|e)===e;case String:return "string"==typeof e;default:if(null==e)return !1;if("function"==typeof t){if(B.__downcastCheck(e,t))return !0}else if("object"==typeof t&&B.__isNativeObj(t)&&e instanceof t)return !0;return t==H&&null!=e.__name__||(t==J&&null!=e.__ename__||null!=e.__enum__&&a[e.__enum__]==t)}}static __downcastCheck(e,t){return e instanceof t||!!t.__isInterface__&&B.__interfLoop(B.getClass(e),t)}static __implements(e,t){return B.__interfLoop(B.getClass(e),t)}static __nativeClassName(e){let t=B.__toStr.call(e).slice(8,-1);return "Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t}static __isNativeObj(e){return null!=B.__nativeClassName(e)}static __resolveNativeClass(e){return t[e]}}B.__name__="js.Boot";class W{static getSessionStorage(){try{let e=window.sessionStorage;if(e.getItem(""),0==e.length){let t="_hx_"+Math.random();e.setItem(t,t),e.removeItem(t);}return e}catch(e){return null}}}function q(e,r){return null==r?null:(null==r.__id__&&(r.__id__=t.$haxeUID++),null==e.hx__closures__?e.hx__closures__={}:a=e.hx__closures__[r.__id__],null==a&&(a=r.bind(e),e.hx__closures__[r.__id__]=a),a);var a;}W.__name__="js.Browser",t.$haxeUID|=0,Object.defineProperty(String.prototype,"__class__",{value:String,enumerable:!1,writable:!0}),String.__name__="String",Array.__name__="Array",Date.prototype.__class__=Date,Date.__name__="Date";var F={},k={},T=Number,G=Boolean,H={},J={};B.__toStr={}.toString,x._hx_skip_constructor=!1,E.__plugfaces__="IPlugin";}(exports,window);!function(e,t){e.bs=e.bs||{},e.bs.player=e.bs.player||{},e.bs.player.plugin=e.bs.player.plugin||{},e.bs.player.plugin.video=e.bs.player.plugin.video||{};class i{constructor(e,t){this.r=new RegExp(e,t.split("u").join(""));}match(e){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(e),this.r.s=e,null!=this.r.m}matched(e){if(null!=this.r.m&&e>=0&&e<this.r.m.length)return this.r.m[e];throw ee.thrown("EReg::matched")}split(e){return e.replace(this.r,"#__delim__#").split("#__delim__#")}}i.__name__="EReg",Object.assign(i.prototype,{__class__:i});var s=require("haxe.HxOverrides"),n=require("haxe.Lambda");Math.__name__="Math";var a=require("haxe.Reflect");class r{static string(e){return oe.__string_rec(e,"")}static parseInt(e){let t=parseInt(e);return isNaN(t)?null:t}}r.__name__="Std";var l=require("haxe.StringTools"),o=require("bs.player.core.events.AdEvent"),d=require("bs.player.core.events.ChromecastEvent"),h=require("bs.player.core.events.ControlEvent"),u=require("bs.player.core.events.DataProviderEvent"),c=require("bs.player.core.events.DisplayEvent"),m=require("bs.player.core.events.ResizeEvent"),v=require("bs.player.core.events.VideoEvent");class g{}g.__name__="bs.player.core.interfaces.IHlsManifestAssets",g.__isInterface__=!0,Object.assign(g.prototype,{__class__:g});var p=require("bs.player.core.manager.I18NHelper"),y=require("bs.player.core.model.Media"),b=require("bs.player.core.model.Live"),S=require("bs.player.core.model.LiveStream"),f=require("bs.player.core.model.MediaSource"),T=require("bs.player.core.model.SubtitlesSet"),E=require("bs.player.core.model.SubtitleEntry"),P=require("bs.player.core.model.SubtitleEntryText"),_=require("bs.player.core.model.AudioSet"),k=require("bs.player.core.model.VideoSet");class C{}C.__name__="bs.player.core.model.DrmCustomLicenseServerHandler",C.__isInterface__=!0,Object.assign(C.prototype,{__class__:C});var w=require("bs.player.core.model.Point");class A{constructor(e){A._hx_skip_constructor||this._hx_constructor(e);}_hx_constructor(e){null==e&&(e=5),this.pluginName="";let t=oe.getClass(this);this.pluginName=t.__name__.split(".").pop(),this.initPriority=e;let i=this.pluginName,s=exports.configuration;this.pluginConfig=null!=s&&Object.prototype.hasOwnProperty.call(s,i)?a.field(s,i):Object.create(null);}create(){}destroy(){}activate(){}postActivate(){}deactivate(){}eventFilter(e){return !0}registerPlugin(e){}getPluginVersion(){return "v2.15.38"}getPluginName(){return this.pluginName}get_player(){return this.player}set_player(e){return this.player=e}get_variables(){return this.variables}set_variables(e){return this.variables=e}get_eventHub(){return this.eventHub}set_eventHub(e){return this.eventHub=e}get_parentDisplay(){return this.parentDisplay}set_parentDisplay(e){return this.parentDisplay=e}get_display(){return this.display}isCriticalForPlayback(){return !0}}A.__name__="bs.player.core.plugin.PluginBase",Object.assign(A.prototype,{__class__:A});class V{constructor(e,t){this.vars=e,this.util=t;}audioTracksToAudioSets(e,t){if(null==e||0==e.length)return [];let i=[],s=0;for(;s<e.length;){let t=e[s];++s,this.util.isAudioLanguageCodeValid(t.lang)&&i.push(t);}let n=this.sortAudioTracks(i,t),a=new Array(n.length),r=0,l=n.length;for(;r<l;){let e=r++,i=n[e],s=new _;s.id=null==i.idx?"null":""+i.idx,s.languageCode=i.track.lang,s.kind=this.getAudioSetKind(i.track),s.i18n=this.getNameTranslations(i.track.labels),s.name=this.getAudioSetName(i.track,s.i18n),null!=t&&(s.preselected=t.id==i.track.id),a[e]=s;}let o=[],d=0;for(;d<a.length;){let e=a[d];++d,null!=e.kind&&o.push(e);}return this.vars.removeAudioSetLanguageCodeDuplicatesIfNeeded(o)}getAudioSetName(e,t){let i=null,s=e.labels;if((null!=s?s.length:null)>0){let t=e.labels[0];i=null!=t?t.text:null;}return this.util.isNameEmpty(i)&&(i=this.util.translateLanguageCodeToName(e.lang)),this.util.isNameEmpty(i)&&(i=e.lang),i}getAudioSetKind(e){let t;if(null!=e.roles){let i=e.roles;t=0==(null!=i?i.length:null);}else t=!0;return t?null:e.roles.includes("main")?"MAIN":e.roles.includes("caption")?"SPOKEN_SUBTITLES":null}textTracksToSubtitlesSets(e){if(null==e||0==e.length)return [];let t,i=[],s=0,n=e.length;for(;s<n;){let n=s++;t=e[n];let a=this.getSubtitleSetKind(t);if(null==a&&!this.util.isSubtitlesLanguageCodeValid(t.language))continue;let r=new T;r.id=null==n?"null":""+n,r.languageCode=t.language,r.kind=a,r.i18n=this.getNameTranslations(t.labels),r.name=this.getSubtitlesSetName(t,r.i18n),i.push(r);}return this.vars.preselectSubtitlesSet(i),i}getSubtitlesSetName(e,t){let i=null,s=e.labels;if((null!=s?s.length:null)>0){let t=e.labels[0];i=null!=t?t.text:null;}return this.util.isNameEmpty(i)&&(i=this.util.translateLanguageCodeToName(e.language)),this.util.isNameEmpty(i)&&(i=e.language),i}getSubtitleSetKind(e){return null==e.roles||0==e.roles.length?null:e.roles.includes("subtitle")?"SUBTITLE":null}videoTracksToVideoSets(e,t){let i=new Array(e.length),s=0,n=e.length;for(;s<n;){let n=s++,a=e[n],r=new k;r.id=a.id,r.languageCode=a.lang,r.kind=this.getVideoSetKind(a),r.i18n=this.getNameTranslations(a.labels),r.name=this.getVideoSetName(a,r.kind,r.i18n),null!=t&&(r.preselected=t.id==a.id),i[n]=r;}return i}getVideoSetName(e,t,i){let s=null,n=e.labels;if((null!=n?n.length:null)>0){let t=e.labels[0];s=null!=t?t.text:null;}if(this.util.isNameEmpty(s)){s=this.util.translateLanguageCodeToName(e.lang),this.util.isNameEmpty(s)&&(s=e.lang);let i=this.util.translateVideoKindToName(t,e.lang);null!=i&&(s+=" ("+i+")");}return s}getVideoSetKind(e){let t;if(null!=e&&null!=e.roles){let i=e.roles;t=0==(null!=i?i.length:null);}else t=!0;return t||e.roles.includes("main")?"MAIN":e.roles.includes("sign")?"SIGN_LANGUAGE":"MAIN"}getNameTranslations(e){if(null==e||0==e.length)return null;let t=[],i=0;for(;i<e.length;){let s=e[i];++i,null!=s.text&&s.text.length>0&&t.push(s);}return n.fold(t,(function(e,t){return t[e.lang]=e.text,t}),{})}sortAudioTracks(e,t){let i=0,s=[],n=0;for(;n<e.length;)s.push({idx:i++,track:e[n++]});return s.sort((function(e,i){let s=e.track.id==t.id?1:0;return (i.track.id==t.id?1:0)-s})),s}}V.__name__="bs.player.core.plugin.mediaTrackParser.DefaultDashJsTrackParser",Object.assign(V.prototype,{__class__:V});class I{constructor(e,t,i){this.vars=e,this.util=t,this.html=i;}audioTracksToAudioSets(e,t){if(null==e||0==e.length)return [];let i=[],s=0;for(;s<e.length;){let t=e[s];++s,this.util.isAudioLanguageCodeValid(t.lang)&&i.push(t);}let n=new Array(i.length),a=0,r=i.length;for(;a<r;){let e=a++,s=i[e],r=new _;r.id=null==s.id?"null":""+s.id,r.languageCode=s.lang,r.kind=this.getAudioSetKind(s),null!=t&&(r.i18n=t(s.name)),r.name=this.getAudioSetName(s,r.i18n),r.isDefault=s.isDefault,n[e]=r;}return this.vars.removeAudioSetLanguageCodeDuplicatesIfNeeded(n)}getAudioSetName(e,t){let i=null;return null!=t&&Object.prototype.hasOwnProperty.call(t,e.lang)&&(i=t[e.lang]),this.util.isNameEmpty(i)&&(i=this.util.translateLanguageCodeToName(e.lang)),this.util.isNameEmpty(i)&&(i=e.name),this.util.isNameEmpty(i)&&(i=e.lang),i}getAudioSetKind(e,t){let i=null!=e?e.characteristics:null;if(null==i)return "MAIN";if(null==i)return "MAIN";switch(i){case"public.accessibility.describes-video":return "DESCRIPTIVE_AUDIO";case"public.accessibility.enhances-speech-intelligibility":return "CLEAR_SPEECH";case"public.accessibility.transcribes-spoken-dialog":return "SPOKEN_SUBTITLES";default:return "MAIN"}}textTracksToSubtitlesSets(e,t,i){let s=this.mapSubtitleTracksToSubtitlesSets(e,i),n=null!=s?s:this.mapTextTracksToSubtitlesSets(t,i);return this.vars.preselectSubtitlesSet(n),n}mapSubtitleTracksToSubtitlesSets(e,t){if(null==e||0==e.length)return null;{let i=[],s=0;for(;s<e.length;){let t=e[s];++s,this.util.isSubtitlesLanguageCodeValid(t.lang)&&i.push(t);}let n=new Array(i.length),a=0,r=i.length;for(;a<r;){let e=a++,s=i[e],r=new T;r.id=null==s.id?"null":""+s.id,r.languageCode=s.lang,r.kind=this.getSubtitlesSetKind(s),null!=t&&(r.i18n=t(s.name)),r.name=this.getSubtitlesSetName(s,r.i18n),r.preselected=s.autoselect&&s.isDefault,n[e]=r;}return n}}mapTextTracksToSubtitlesSets(e,t){if(null==e||0==e.length)return null;{let i=[],s=0;for(;s<e.length;){let n=e[s];if(++s,!this.util.isSubtitlesLanguageCodeValid(null!=n?n.language:null))continue;let a=new T;a.id=null==n.id?"null":""+n.id,a.languageCode=n.language,null!=t&&(a.i18n=t(n.label)),a.kind=this.html.getSubtitlesSetKind(n),a.name=this.html.getSubtitlesSetName(n,a.i18n),a.preselected="showing"==n.mode,i.push(a);}return i}}getSubtitlesSetKind(e){let t=null!=e?e.characteristics:null;if(null==t)return "SUBTITLE";if(null==t)return "SUBTITLE";switch(t){case"public.accessibility.describes-music-and-sound":case"public.accessibility.transcribes-spoken-dialog,public.accessibility.describes-music-and-sound":return "SDH";default:return "SUBTITLE"}}getSubtitlesSetName(e,t){let i=null;return null!=t&&Object.prototype.hasOwnProperty.call(t,e.lang)&&(i=t[e.lang]),this.util.isNameEmpty(i)&&(i=this.util.translateLanguageCodeToName(e.lang)),i}videoTracksToVideoSets(e,t){let i=n.fold(e,(function(e,t){return null==n.find(t,(function(t){return t.name==e.name}))&&t.push(e),t}),[]),s=new Array(i.length),a=0,l=i.length;for(;a<l;){let e=a++,n=i[e],l=new k,o=n.id;l.id=null!=o?r.string(o):null,l.languageCode=n.attrs.LANG,l.kind=this.getVideoSetKind(n),null!=t&&(l.i18n=t(n.name)),l.name=this.getVideoSetName(n,l.i18n),l.preselected="MAIN"==l.kind,s[e]=l;}return s}getVideoSetKind(e){return "MAIN"}getVideoSetName(e,t){return null!=e?e.name:null}}I.__name__="bs.player.core.plugin.mediaTrackParser.DefaultHlsJsTrackParser",Object.assign(I.prototype,{__class__:I});class R{constructor(e,t){this.vars=e,this.util=t;}audioTracksToAudioSets(e,t){if(null==e||0==e.length)return [];let i,s=[],n=0,a=e.length;for(;n<a;){if(i=e[n++],!this.util.isAudioLanguageCodeValid(i.language))continue;let a,r=new _;r.id=this.getSetId(i.language,s.length),r.languageCode=i.language,null!=t&&(r.i18n=t(i.label));let l=r.i18n;if(null!=l&&Object.prototype.hasOwnProperty.call(l,"en")){let e=r.i18n.en;a=null!=e?e.toLowerCase():null;}else a=i.label;r.kind=this.getAudioSetKind(i,a),r.name=this.getAudioSetName(i,r.i18n),r.preselected=i.enabled,null!=r.kind&&s.push(r);}return this.vars.removeAudioSetLanguageCodeDuplicatesIfNeeded(s)}getAudioSetName(e,t){let i=null;return i=this.util.translateLanguageCodeToName(e.language),this.util.isNameEmpty(i)&&(i=e.language),i}getAudioSetKind(e,t){if(null==(null!=e?e.kind:null))return null;switch(e.kind){case"descriptions":return "DESCRIPTIVE_AUDIO";case"main":return "MAIN";default:return null}}textTracksToSubtitlesSets(e,t){if(null==e||0==e.length)return [];let i=[],s=0,n=e.length;for(;s<n;){let n=e[s++],a=this.getSubtitlesSetKind(n);if(null==a||!this.util.isSubtitlesLanguageCodeValid(null!=n?n.language:null))continue;let r=new T;r.id=this.getSetId(n.language,i.length),r.languageCode=n.language,null!=t&&(r.i18n=t(n.label)),r.kind=a,r.name=this.getSubtitlesSetName(n,r.i18n),r.preselected="showing"==n.mode,i.push(r);}return this.vars.preselectSubtitlesSet(i),i}getSubtitlesSetName(e,t){let i=this.util.translateLanguageCodeToName(e.language);return this.util.isNameEmpty(i)?e.language:i}getSubtitlesSetKind(e){return null==(null!=e?e.kind:null)?"SUBTITLE":"captions"===e.kind?"SDH":"SUBTITLE"}videoTracksToVideoSets(e,t){let i=0,s=[],n=(a=this.getUniqueVideoTrackMap(e))instanceof Array?new haxe_iterators_ArrayIterator(a):a.iterator();for(var a;n.hasNext();){let e=n.next(),a=i++,r=new k;r.id=null==a?"null":""+a,r.languageCode=e.language,r.kind=this.getVideoSetKind(e),null!=t&&(r.i18n=t(e.label)),r.name=this.getVideoSetName(e,r.kind,r.i18n),r.preselected="MAIN"==r.kind,s.push(r);}return s}getUniqueVideoTrackMap(e){let t=new re,i=0;for(;i<e.length;){let s=e[i];++i;let n=this.getVideoTrackUniqueKey(s);t.h[n]=s;}return t}getVideoSetName(e,t,i){let s=null;s=this.util.translateLanguageCodeToName(e.language),this.util.isNameEmpty(s)&&(s=e.label),this.util.isNameEmpty(s)&&(s=e.language);let n=this.util.translateVideoKindToName(t,e.language);return null!=n&&(s+=" ("+n+")"),s}getVideoSetKind(e){return null==(null!=e?e.kind:null)?"MAIN":"sign"==e.kind?"SIGN_LANGUAGE":"MAIN"}getVideoTrackUniqueKey(e){let t=null!=e?e.language:null,i=null!=e?e.kind:null;return (null!=t?t:"und")+"-"+(null!=i?i:this.getVideoSetKind(e))}getSetId(e,t){return e+"-"+t}}R.__name__="bs.player.core.plugin.mediaTrackParser.DefaultHtmlTrackParser",Object.assign(R.prototype,{__class__:R});class x{constructor(e){let t=L.fromObject(e),i=new M(t);this.html=new R(t,i),this.hlsjs=new I(t,i,this.html),this.dashjs=new V(t,i);}}x.__name__="bs.player.core.plugin.mediaTrackParser.DefaultMediaTrackParsers",Object.assign(x.prototype,{__class__:x});class M{constructor(e){this.vars=e;}isAudioLanguageCodeValid(e){return !this.isLanguageCodeEmpty(e)&&this.vars.isAudioLanguageCodeSupported(e)}isSubtitlesLanguageCodeValid(e){return !this.isLanguageCodeEmpty(e)&&this.vars.isSubtitlesLanguageCodeSupported(e)}isLanguageCodeEmpty(e){return null==e||0==l.trim(e).length}isNameEmpty(e){return null==e||0==l.trim(e).length}translateLanguageCodeToName(e){return p.normalizeLanguageNameFormat(p.getLanguageNativeNameByCode(e))}translateVideoKindToName(e,t){return "SIGN_LANGUAGE"==e?J.translate((""+e).toLowerCase(),t):null}}M.__name__="bs.player.core.plugin.mediaTrackParser.MediaTrackParserUtil",Object.assign(M.prototype,{__class__:M});class L{constructor(e,t,i,s){this.suportedSubtitlesLanguageCodes=null,this.suportedAudioLanguageCodes=null,this.languageCodeDuplicationRemoval=!0,this.subtitles=null,null!=e&&(this.subtitles=e),null!=t&&(this.languageCodeDuplicationRemoval=t),null!=i&&(this.suportedAudioLanguageCodes=i),null!=s&&(this.suportedSubtitlesLanguageCodes=s);}isAudioLanguageCodeSupported(e){let t=this.suportedAudioLanguageCodes;return !((null!=t?t.length:null)>0)||this.suportedAudioLanguageCodes.includes(e)}isSubtitlesLanguageCodeSupported(e){let t=this.suportedSubtitlesLanguageCodes;return !((null!=t?t.length:null)>0)||this.suportedSubtitlesLanguageCodes.includes(e)}preselectSubtitlesSet(e){null!=this.subtitles&&e.length>0&&p.preselectSubtitlesSet(this.subtitles,e);}removeAudioSetLanguageCodeDuplicatesIfNeeded(e){return 0==this.languageCodeDuplicationRemoval?e:n.fold(e,(function(e,t){return null==n.find(t,(function(t){return t.languageCode==e.languageCode}))&&t.push(e),t}),[])}static fromObject(e){return null==e?new L(null,null,null,null):new L(e.subtitles,e.languageCodeDuplicationRemoval,e.suportedAudioLanguageCodes,e.suportedSubtitlesLanguageCodes)}}L.__name__="bs.player.core.plugin.mediaTrackParser.MediaTrackParserVariables",Object.assign(L.prototype,{__class__:L});class D{constructor(e,t){this.context=e,this.playerContainer=t,this.isInitialized=!1,h.add(e,"selectSubtitles",he(this,this.onSelectSubtitles)),m.add(e,"resize",he(this,this.onResize));}destroy(){h.remove(this.context,"selectSubtitles",he(this,this.onSelectSubtitles)),m.remove(this.context,"resize",he(this,this.onResize)),this.playerContainer=null;}onSelectSubtitles(e){this.initSubtitlesPlaceholder();}onResize(e){if(null!=this.subtitlesParentContainer){let e=this.subtitlesParentContainer.getBoundingClientRect().height;this.subtitlesContainer.style.fontSize=Math.floor(.05*e)+"px",this.subtitlesContainer.style.lineHeight=Math.floor(.08*e)+"px";}}initSubtitlesPlaceholder(){if(this.isInitialized)return;this.isInitialized=!0;let e=this.playerContainer.getElementsByClassName("htmlSubtitlesPlaceholder");if(0==e.length){this.subtitlesParentContainer=window.document.createElement("div"),this.subtitlesParentContainer.setAttribute("class","htmlSubtitlesPlaceholder"),this.subtitlesParentContainer.setAttribute("style","height: 100%;left: 0px;position: absolute;top: 0px;width: 100%;");let e=this.playerContainer.childNodes,t=e.length-1,i=0,s=e.length;for(;i<s;){let s=i++;"video"==e.item(s).nodeName.toLowerCase()&&(t=s);}t<e.length-1?this.playerContainer.insertBefore(this.subtitlesParentContainer,e[t+1]):this.playerContainer.appendChild(this.subtitlesParentContainer);}else this.subtitlesParentContainer=e.item(0),this.subtitlesParentContainer.innerHTML="";null==this.subtitlesContainer?(this.subtitlesContainer=window.document.createElement("div"),this.subtitlesContainer.style.position="absolute",this.subtitlesContainer.style.display="table",this.subtitlesContainer.style.textAlign="center",this.subtitlesContainer.style.overflow="initial",this.subtitlesContainer.style.pointerEvents="none",this.subtitlesContainer.style.bottom="5%",this.subtitlesContainer.style.left="10%",this.subtitlesContainer.style.width="80%",this.subtitlesContainer.style.height="auto",this.subtitlesContainer.style.justifyContent="center",this.subtitlesContainer.style.color="white",this.subtitlesContainer.style.backgroundColor="transparent",this.subtitlesContainer.style.fontFamily='"Helvetica Neue", Helvetica, Arial,sans-serif',this.subtitlesContainer.style.textShadow="0px 0px 7px #000000, 0px 0px 4px #000000, 0px 0px 10px #000000"):null!=this.subtitlesContainer.parentElement&&this.subtitlesContainer.parentElement.removeChild(this.subtitlesContainer),this.onResize(),this.subtitlesParentContainer.appendChild(this.subtitlesContainer);}onCueEnter(e){this.initSubtitlesPlaceholder();let t=window.document.createElement("p"),i=[],s=0,n=e.texts;for(;s<n.length;)i.push(n[s++].text);t.innerText=i.join("\n"),t.style.margin="0",t.style.display="table-row",null==this.subtitlesParentContainer.parentNode&&this.playerContainer.appendChild(this.subtitlesParentContainer),e.customParams.h._element=t,this.subtitlesContainer.appendChild(t);}onCueExit(e){this.subtitlesContainer.removeChild(e.customParams.h._element);}}D.__name__="bs.player.core.renderer.SubtitlesRenderer",Object.assign(D.prototype,{__class__:D});class N extends A{constructor(){A._hx_skip_constructor=!0,super(),A._hx_skip_constructor=!1,this._hx_constructor();}_hx_constructor(){this.saveBandwidthModeHandler=null,this.firstVideoFrameEventDispatcher=null,this.videoPlaybackRate=1,this.lastAdError=null,this.lastMediaError=null,this.permamentPlaybackErrorTimer=null,this.videoCurrentTime=null,this.volumeValue=null,this.isQuickFallbackPathForLiveEnabled=!0,this.minAudioTracksForInfo=2,this.chromecastSender=ce,this.chromecastSession=ce,this.chromecastConnected=!1,this.videoPlayers=[],this.videoPlayersClasses=[],super._hx_constructor(4),this.isAdVideoTagInitializedForMobiles=!1,this.isInStreamAdPlaying=!1,this.currentMedia=null,this.lastDataProviderEvent=null,this.shouldVideoPlay=!1,this.isNativeVideoInitialised=!1;}isSingleVideoTagPlay(){return !(!X.isiOS&&"Safari"!=X.browserName)||X.isSamsungSmartTVTizen}hasInStreamAds(){let e=this.get_variables();return Object.prototype.hasOwnProperty.call(e,"yospace")}hasDefinedAds(){let e=this.get_variables();if(Object.prototype.hasOwnProperty.call(e,"freewheel"))return !0;{let e=this.get_variables();return Object.prototype.hasOwnProperty.call(e,"advertisement")}}hasAdvertisementPlugin(){let e=exports.bs.player.plugin;return null!=e&&(null!=a.field(e,"freewheel")&&null!=a.field(a.field(e,"freewheel"),"FreeWheel")||null!=a.field(e,"advertisement")&&null!=a.field(a.field(e,"advertisement"),"AdvertisementDataProvider"))}create(){super.create(),this.shouldVideoPlay=1==this.get_variables().autoplay,X.isiOS&&"Safari"==X.browserName&&1==this.get_variables().autoplay&&1==this.get_variables().mute&&(this.get_variables().iosInlineVideo=!0,this.log("BRADMAX PLAYER NOTICE:\nBrowser run with iosInlineVideo:true mode, because it is required for autoplay muted video for iOS.\n","warn")),this.nativeVideo=new O,this.nativeAdVideo=new O;let e=this.context;d.add(e,"connected",he(this,this.onChromecastConnect)),d.add(e,"disconnected",he(this,this.onChromecastDisonnect)),h.add(e,"skinPause",he(this,this.onPauseEvent)),h.add(e,"skinStop",he(this,this.onStopEvent)),h.add(e,"skinPlay",he(this,this.onPlayEvent)),h.add(e,"skinPlayPause",he(this,this.onPlayPauseEvent)),h.add(e,"skinSeek",he(this,this.onSeekEvent)),h.add(e,"selectAudio",he(this,this.onSelectAudioEvent)),h.add(e,"selectSubtitles",he(this,this.onSelectSubtitlesEvent)),h.add(e,"skinVolume",he(this,this.onVolumeEvent)),h.add(e,"skinMute",he(this,this.onMuteEvent)),h.add(e,"skinUnmute",he(this,this.onUnmuteEvent));let t=this;u.add(e,"mediaMetadataData",(function(e){t.onSetDataEvent(e,false);}));let i=this;u.add(e,"adMetadataData",(function(e){i.onSetDataEvent(e,true);})),m.add(e,"resize",he(this,this.onPlayerResizeEvent)),v.add(e,"ready",he(this,this.onVideoReadyEvent)),v.add(e,"connectionError",he(this,this.onNetworkErrorEvent)),v.add(e,"mediaError",he(this,this.onVideoErrorEvent)),v.add(e,"loadError",he(this,this.onVideoErrorEvent)),v.add(e,"currentTimeChange",he(this,this.onVideoTimeChange)),v.add(e,"drmAuthenticationError",he(this,this.onVideoDrmAuthError)),v.add(e,"drmModuleCrush",he(this,this.onVideoDrmModuleCrush)),o.add(e,"adPlay",he(this,this.onAdPlay)),o.add(e,"adPause",he(this,this.onAdPause)),o.add(e,"adResume",he(this,this.onAdResume)),o.add(e,"adMediaError",he(this,this.onAdErrorEvent)),v.add(e,"playing",he(this,this.onVideoPlaying)),o.add(e,"adPlaying",he(this,this.onAdVideoPlaying)),v.add(e,"currentTimeChange",he(this,this.onVideoPlaying)),o.add(e,"adCurrentTimeChange",he(this,this.onAdVideoPlaying)),o.add(e,"adInStreamPlaying",he(this,this.onAdInStreamPlaying)),o.add(e,"adInStreamPlayingSilent",he(this,this.onAdInStreamPlaying)),o.add(e,"adInStreamEnd",he(this,this.onAdInStreamEnd)),o.add(e,"adInStreamEndSilent",he(this,this.onAdInStreamEnd)),o.add(e,"adConnectionError",he(this,this.onNetworkErrorEvent)),h.add(e,"setVideoPlaybackRate",he(this,this.onSetVideoPlaybackRate)),h.add(e,"reloadVideoAfterNetworkProblem",he(this,this.onReloadVideoAfterNetworkProblem)),this.setDefaultVariablesFromVideoPluginConfig(),this.subtitlesRenderer=new D(this.context,this.get_parentDisplay()),this.externalSubtitlesController=new F(this.context,this.subtitlesRenderer),null!=this.get_variables().locale&&(J.locale=this.get_variables().locale),this.enableSaveBandwidthModeHandler(),this.resetFirstVideoFrameEventDispatcher();}enableSaveBandwidthModeHandler(){K.canBeEnabled(this.get_variables())&&null==this.saveBandwidthModeHandler&&(this.saveBandwidthModeHandler=new K(this.playerInstance,this.get_variables()));let e=this.saveBandwidthModeHandler;null!=e&&e.create();}disableSaveBandwidthModeHandler(){let e=this.saveBandwidthModeHandler;null!=e&&e.destroy(),this.saveBandwidthModeHandler=null;}initVideoElementsForHtml(e){this.isNativeVideoInitialised=!0;let t=null;null!=e&&null!=e.source&&e.source.length>0&&null!=e.source[0]&&(t=e.source[0]),this.nativeVideo=this.nativeVideo.clone(),this.nativeVideo.set_videoElement(this.getVideoElementReadyForAutoplayOrCreate(t)),this.isSingleVideoTagPlay()?this.nativeAdVideo=this.nativeVideo:(this.nativeAdVideo=this.nativeAdVideo.clone(),this.nativeAdVideo.set_videoElement(this.getVideoElementReadyForAutoplayOrCreate())),this.nativeAdVideo.mark("bs-v-supporting-ad-play"),this.nativeVideo.setIosInlineFromVariables(this.get_variables()),this.nativeVideo.resize(),this.nativeAdVideo.resize();let i=this.get_variables();Object.prototype.hasOwnProperty.call(i,"mute")&&oe.__cast(a.field(this.get_variables(),"mute"),ve)&&this.nativeVideo.set_muted(this.nativeAdVideo.set_muted(!0));let s=this.get_variables();if(Object.prototype.hasOwnProperty.call(s,"playbackRate")){let e=a.field(this.get_variables(),"playbackRate");!isNaN(e)&&isFinite(e)&&e>=-1&&(this.videoPlaybackRate=e);}this.updateVideoMediaElementCrossOrigin(),this.div=this.get_parentDisplay();let n=this.div,r=this.nativeVideo.get_element();if(null!=n.firstElementChild?n.insertBefore(r,n.firstElementChild):n.appendChild(r),!this.isSingleVideoTagPlay()){let e=this.div,t=this.nativeAdVideo.get_element();null!=e.firstElementChild?e.insertBefore(t,e.firstElementChild):e.appendChild(t);}this.initVideoPlayersClasses(),this.triggerVideoMediaElementInitEvent();}postActivate(){super.postActivate(),this.updateVideoMediaElementCrossOrigin(),this.triggerVideoMediaElementInitEvent(),this.triggerInitialVolumeControlEvent(),this.triggerInitialMuteControlEvent();}updateVideoMediaElementCrossOrigin(){null!=this.nativeVideo&&this.nativeVideo.setAnonymousCrossOriginFromVariables(this.get_variables());}triggerInitialVolumeControlEvent(){let e=Y.volume(this.get_variables());if(null!=e){let t=new h("skinVolume");t.data=e,t.dispatch(this.context);}}triggerInitialMuteControlEvent(){let e=Y.mute(this.get_variables());1==this.get_variables().mute&&a.deleteField(this.get_variables(),"mute"),e&&new h("skinMute").dispatch(this.context);}triggerVideoMediaElementInitEvent(){if(null!=this.nativeVideo){let e=new v("videoMediaElementInit");e.data=this.nativeVideo.get_videoElement(),e.dispatch(this.context);}}destroy(){d.remove(this.context,"connected",he(this,this.onChromecastConnect)),d.remove(this.context,"disconnected",he(this,this.onChromecastDisonnect)),h.remove(this.context,"skinPause",he(this,this.onPauseEvent)),h.remove(this.context,"skinPlay",he(this,this.onPlayEvent)),h.remove(this.context,"skinPlayPause",he(this,this.onPlayPauseEvent)),h.remove(this.context,"skinSeek",he(this,this.onSeekEvent)),h.remove(this.context,"selectAudio",he(this,this.onSelectAudioEvent)),h.remove(this.context,"selectSubtitles",he(this,this.onSelectSubtitlesEvent)),h.remove(this.context,"skinVolume",he(this,this.onVolumeEvent)),h.remove(this.context,"skinMute",he(this,this.onMuteEvent)),h.remove(this.context,"skinUnmute",he(this,this.onUnmuteEvent));let e=this;u.remove(this.context,"mediaMetadataData",(function(t){e.onSetDataEvent(t,false);}));let t=this;u.remove(this.context,"adMetadataData",(function(e){t.onSetDataEvent(e,true);})),m.remove(this.context,"resize",he(this,this.onPlayerResizeEvent)),v.remove(this.context,"ready",he(this,this.onVideoReadyEvent)),v.remove(this.context,"connectionError",he(this,this.onNetworkErrorEvent)),v.remove(this.context,"mediaError",he(this,this.onVideoErrorEvent)),v.remove(this.context,"loadError",he(this,this.onVideoErrorEvent)),v.remove(this.context,"currentTimeChange",he(this,this.onVideoTimeChange)),v.remove(this.context,"drmAuthenticationError",he(this,this.onVideoDrmAuthError)),o.remove(this.context,"adPlay",he(this,this.onAdPlay)),o.remove(this.context,"adPause",he(this,this.onAdPause)),o.remove(this.context,"adResume",he(this,this.onAdResume)),o.remove(this.context,"adMediaError",he(this,this.onAdErrorEvent)),v.remove(this.context,"playing",he(this,this.onVideoPlaying)),o.remove(this.context,"adPlaying",he(this,this.onAdVideoPlaying)),v.remove(this.context,"currentTimeChange",he(this,this.onVideoPlaying)),o.remove(this.context,"adCurrentTimeChange",he(this,this.onAdVideoPlaying)),o.remove(this.context,"adInStreamPlaying",he(this,this.onAdInStreamPlaying)),o.remove(this.context,"adInStreamPlayingSilent",he(this,this.onAdInStreamPlaying)),o.remove(this.context,"adInStreamEnd",he(this,this.onAdInStreamEnd)),o.remove(this.context,"adInStreamEndSilent",he(this,this.onAdInStreamEnd)),o.remove(this.context,"adConnectionError",he(this,this.onNetworkErrorEvent)),h.remove(this.context,"setVideoPlaybackRate",he(this,this.onSetVideoPlaybackRate)),h.remove(this.context,"reloadVideoAfterNetworkProblem",he(this,this.onReloadVideoAfterNetworkProblem)),null!=this.externalSubtitlesController&&(this.externalSubtitlesController.destroy(),this.externalSubtitlesController=null),null!=this.subtitlesRenderer&&(this.subtitlesRenderer.destroy(),this.subtitlesRenderer=null),null!=this.currentMedia&&null!=this.currentMedia.drmCustomLicenseServerHandler&&this.currentMedia.drmCustomLicenseServerHandler.destroy(),this.currentMedia=null;let i=0,s=this.videoPlayers;for(;i<s.length;)s[i++].destroy();this.videoPlayers=null,null!=this.playerInstance&&this.playerInstance.destroy(),this.playerInstance=null,null!=this.adPlayerInstance&&this.adPlayerInstance.destroy(),this.adPlayerInstance=null,null!=this.videoElementsManager&&(this.videoElementsManager.releaseVideoElement(this.nativeVideo.get_videoElement()),this.videoElementsManager.releaseVideoElement(this.nativeAdVideo.get_videoElement())),this.nativeVideo=null,this.nativeAdVideo=null,this.div=null,this.videoPlayersClasses=null,this.isAdVideoTagInitializedForMobiles=null,this.videoPlaybackRate=1,this.disableSaveBandwidthModeHandler(),this.destroyFirstVideoFrameEventDispatcher(),super.destroy();}initVideoPlayersClasses(){if("Safari"==X.browserName&&!X.isSamsungSmartTVTizen||X.isMobile()){this.videoPlayersClasses.push(q);let e=0,t=this.get_player().pluginsVideo;for(;e<t.length;)this.videoPlayersClasses.push(oe.getClass(t[e++]));}else {let e=0,t=this.get_player().pluginsVideo;for(;e<t.length;)this.videoPlayersClasses.push(oe.getClass(t[e++]));this.videoPlayersClasses.push(q);}}moveSelectedMediaSourceToFirstPosition(e,t){let i=[];i.push(e[t]);let s=0,n=e.length;for(;s<n;){let n=s++;n!=t&&i.push(e[n]);}return i}onChromecastConnect(e){this.chromecastConnected=!0,this.chromecastSession=e.data.session,this.chromecastSender=e.data.sender,this.videoPlayersClasses[0].__name__!=H.__name__&&this.videoPlayersClasses.splice(0,0,H),this.onSetDataEvent(this.lastDataProviderEvent,!1),this.updateChromecastPlayerInstanceSession(this.chromecastSession,this.chromecastSender);}onChromecastDisonnect(e){this.chromecastConnected=!1,this.chromecastSession=null,this.playerInstance instanceof H&&this.playerInstance.onChromecastDisonnect(),this.videoPlayersClasses[0].__name__==H.__name__&&this.videoPlayersClasses.shift(),this.onSetDataEvent(this.lastDataProviderEvent,!1),null!=this.currentMedia&&this.currentMedia.mediaPlaybackInfo.currentTime>0&&(this.currentMedia.mediaUserSettings.resumePostion=this.currentMedia.mediaPlaybackInfo.currentTime),null!=this.currentMedia&&this.currentMedia.mediaPlaybackInfo.isPlaying&&new h("skinPlay").dispatch(this.context);}updateChromecastPlayerInstanceSession(e,t){this.playerInstance instanceof H&&this.playerInstance.setSession(this.chromecastSession,this.chromecastSender);}setupParamsForFallbackMechanism(e,t){this.currentMedia=e,this.lastDataProviderEvent=t,this.videoCurrentTime=null,this.currentMedia.mediaUserSettings.resumePostion>0&&(this.videoCurrentTime=this.currentMedia.mediaUserSettings.resumePostion);}onSetDataEvent(e,t){let i=this;if((X.isiOS||"Safari"==X.browserName)&&1==this.get_variables().autoplay){let s=this.videoElementsManager.findVideoElementInfoByElement(this.nativeVideo.get_videoElement());if(null!=s&&!s.readyForAutoplay&&s.preparingForAutoplay)return void s.listenersWaitingForVideoElementForAutoplay.push((function(){i.onSetDataEvent(e,t);}));null!=s&&!s.readyForAutoplay&&this.videoElementsManager.hasHtmlVideoReadyForAutoplay()&&this.recreateNativeVideoElement();}if(null!=this.playerInstance&&(this.isSingleVideoTagPlay()||this.hasInStreamAds())&&this.playerInstance.destroy(),null==this.videoPlayersClasses)return void console.warn("BRADMAX PLAYER: Trying to call bs.player.plugin.video.Video.onSetDataEvent() on deactivated/destroyed video component. Please check if you are not accidental trying to load media after player destroy call.");if(null==e.data)return;let s=null;t?s=e.data.media:(s=e.data,this.setupParamsForFallbackMechanism(s,e)),this.isNativeVideoInitialised||this.initVideoElementsForHtml(s),this.updateVideoMediaElementCrossOrigin();let n,a=this.createNewInternalPlayer(s,t);if(null!=a){if(t?this.adPlayerInstance=a:this.playerInstance=a,null!=this.videoPlaybackRate){let e=this.videoPlaybackRate;n=!isNaN(e);}else n=!1;n&&a.setPlaybackRate(this.videoPlaybackRate),null!=this.volumeValue&&a.volume(this.volumeValue),a.setData(s),this.externalSubtitlesController.setData(s),this.createFirstVideoFrameEventDispatcher(t);}else this.dispatchNotSupportedVideoError();}createNewInternalPlayer(e,t){let i,s=-1,n=this.videoPlayersClasses;if(Object.prototype.hasOwnProperty.call(e.customParams.h,"preferedVideoPlayersClassesOrder")){let t=e.customParams.h.preferedVideoPlayersClassesOrder;if(t.length>0){let e,i=[],s=0;for(;s<t.length;)e=this.getPlayerClassByName(t[s++]),null!=e&&i.push(e),e=null;i.length>0&&(n=this.makePreferedVideoClassesInOrder(i));}}let a=0,r=n.length;for(;a<r;){let t=a++;i=n[t];let r=e.failedPlaybackPlayers,l=n[t].__name__;if(Object.prototype.hasOwnProperty.call(r.h,l))continue;let o=0,d=e.source.length;for(;o<d;){let n=o++;if(i.canPlay(e.source[n])){s=t,e.source=this.moveSelectedMediaSourceToFirstPosition(e.source,n);break}}if(s>-1)break}if(s<0)return null;let l=null,o=0,d=n.length;for(;o<d;){let e=o++;i=n[e],e==s&&(t?(this.shouldPlayerInstanceBeUpdated(this.adPlayerInstance,n[e])&&this.adPlayerInstance.destroy(),l=i.getInstance(this.context,t)):(this.shouldPlayerInstanceBeUpdated(this.playerInstance,n[e])&&this.playerInstance.destroy(),l=i.getInstance(this.context,t)),l.plugins=this.get_player().plugins,l.variables=this.get_variables(),l.minAudioTracksForInfo=this.minAudioTracksForInfo,l.isQuickFallbackPathForLiveEnabled=this.isQuickFallbackPathForLiveEnabled,l.mediaTrackParsers=this.resolveMediaTrackParsers(),l.attachVideo(t?this.nativeAdVideo.get_videoElement():this.nativeVideo.get_videoElement()));}return l}resolveMediaTrackParsers(){let e=n.find(this.get_player().plugins,(function(e){let t=oe.getClass(e);if(0==a.isObject(t))return !1;{let e=Object.prototype.hasOwnProperty.call(t,"__plugfaces__")?a.field(t,"__plugfaces__"):null;return null!=e&&e.indexOf("IMediaTrackParser")>-1}}));return null!=(null!=e?e.mediaTrackParsers:null)?e.mediaTrackParsers:new x(this.get_variables())}createFirstVideoFrameEventDispatcher(e){let t=this.firstVideoFrameEventDispatcher;this.firstVideoFrameEventDispatcher=null!=t?t:new j(this.context,this.nativeVideo,this.nativeAdVideo),this.firstVideoFrameEventDispatcher.create(e);}resetFirstVideoFrameEventDispatcher(){let e=this.firstVideoFrameEventDispatcher;null!=e&&e.reset();}destroyFirstVideoFrameEventDispatcher(){let e=this.firstVideoFrameEventDispatcher;null!=e&&e.destroy(),this.firstVideoFrameEventDispatcher=null;}recreateNativeVideoElement(){let e=this.nativeVideo.clone();e.set_videoElement(this.getVideoElementReadyForAutoplayOrCreate()),this.nativeVideo.replaceWith(e),this.videoElementsManager.releaseVideoElement(this.nativeVideo.get_videoElement()),this.nativeVideo=e,this.updateVideoMediaElementCrossOrigin(),this.triggerVideoMediaElementInitEvent();}dispatchNotSupportedVideoError(){let e=new v("playbackPermamentError");e.data={additionalData:{message:"Provided video is not supported."}},this.lastMediaError=e,this.showMediaErrorMessage(e);}getVideoElementReadyForAutoplayOrCreate(e){return this.videoElementsManager.getVideoElementReadyForAutoplayOrCreate(this.get_player(),e)}makePreferedVideoClassesInOrder(e){let t=[],i=0;for(;i<e.length;){let s=e[i];++i,-1!=this.videoPlayersClasses.indexOf(s)&&t.push(s);}return t}shouldPlayerInstanceBeUpdated(e,t){return null!=e&&oe.getClass(e)!=t}setDefaultVariablesFromVideoPluginConfig(){let e,t,i=["qualitySelectionEnabled","minAudioTracksForInfo","isQuickFallbackPathForLiveEnabled"],s=0;for(;s<i.length;){let e,t=i[s];if(++s,null!=this.pluginConfig&&Object.prototype.hasOwnProperty.call(this.pluginConfig,t)&&null!=this.get_variables()){let i=this.get_variables();e=!Object.prototype.hasOwnProperty.call(i,t);}else e=!1;e&&(this.get_variables()[t]=a.field(this.pluginConfig,t));}if(null!=this.get_variables()){let t=this.get_variables();e=Object.prototype.hasOwnProperty.call(t,"minAudioTracksForInfo");}else e=!1;if(e){let e=a.field(this.get_variables(),"minAudioTracksForInfo");e>=1&&(this.minAudioTracksForInfo=e);}if(null!=this.get_variables()){let e=this.get_variables();t=Object.prototype.hasOwnProperty.call(e,"isQuickFallbackPathForLiveEnabled");}else t=!1;t&&(this.isQuickFallbackPathForLiveEnabled=a.field(this.get_variables(),"isQuickFallbackPathForLiveEnabled"));}onPlayerResizeEvent(e){null==this.playerInstance||e.data instanceof w||this.playerInstance.playerResize(e.data);}onSetVideoPlaybackRate(e){let t;if(this.videoPlaybackRate=parseFloat(e.data),null!=this.playerInstance&&null!=this.videoPlaybackRate){let e=this.videoPlaybackRate;t=isNaN(e);}else t=!0;t||this.playerInstance.setPlaybackRate(this.videoPlaybackRate);}onReloadVideoAfterNetworkProblem(e){this.reloadVideoAfterNetworkProblem();}onVideoReadyEvent(e){}onPauseEvent(e){null!=this.playerInstance&&(this.shouldVideoPlay=!1,this.playerInstance.pause());}onStopEvent(e){null!=this.playerInstance&&(this.shouldVideoPlay=!1,this.playerInstance.pause(),this.playerInstance.destroy());}log(e,t){null==t&&(t="log"),console&&("error"==t?console.error(e):"warn"==t?console.warn(e):console.log(e));}initAdVideoTagForMobilesAndPropagate(){if(null==this.playerInstance)return !1;let e=!0;if(!this.isAdVideoTagInitializedForMobiles&&!X.isWebView()&&!X.isSamsungSmartTVTizen&&(X.isMobile()||"Safari"==X.browserName)&&this.hasDefinedAds()&&this.hasAdvertisementPlugin()){if(!this.isSingleVideoTagPlay()||null==this.playerInstance||this.playerInstance instanceof q||(this.playerInstance.destroy(),e=!1),this.isAdVideoTagInitializedForMobiles=!0,null==this.adPlayerInstance){this.adPlayerInstance=q.getInstance(this.context,!0),this.adPlayerInstance.variables=this.get_variables(),this.adPlayerInstance.plugins=this.get_player().plugins,this.adPlayerInstance.attachVideo(this.nativeAdVideo.get_videoElement());let e=new y,t=new f;t.url=exports.mp4,e.source=[t],this.adPlayerInstance.setData(e);}this.adPlayerInstance.play(),this.adPlayerInstance.pause();}return e}onPlayEvent(e){this.initAdVideoTagForMobilesAndPropagate()&&(this.shouldVideoPlay=!0,this.playerInstance.play());}onPlayPauseEvent(e){this.initAdVideoTagForMobilesAndPropagate()&&(this.shouldVideoPlay=!this.shouldVideoPlay,this.playerInstance.playPause());}onSeekEvent(e){null!=this.playerInstance&&this.playerInstance.seek(e.data.seekedPosition);}onSelectAudioEvent(e){}onSelectSubtitlesEvent(e){}onVolumeEvent(e){this.volumeValue=parseFloat(e.data),null!=this.playerInstance&&(this.nativeVideo.set_muted(this.volumeValue<=0),this.playerInstance.volume(this.volumeValue)),null!=this.adPlayerInstance&&(this.nativeAdVideo.set_muted(this.volumeValue<=0),this.adPlayerInstance.volume(this.volumeValue));}onMuteEvent(e){this.nativeVideo.set_muted(this.nativeAdVideo.set_muted(!0));}onUnmuteEvent(e){this.nativeVideo.set_muted(this.nativeAdVideo.set_muted(!1)),this.nativeVideo.set_volume(0==this.nativeVideo.get_volume()?1:this.nativeVideo.get_volume()),this.nativeAdVideo.set_volume(0==this.nativeAdVideo.get_volume()?1:this.nativeAdVideo.get_volume());}onAdPlay(e){null!=this.adPlayerInstance&&(this.shouldVideoPlay=!0,this.adPlayerInstance.play());}onAdPause(e){null!=this.adPlayerInstance&&(this.shouldVideoPlay=!1,this.adPlayerInstance.pause());}onAdResume(e){null!=this.adPlayerInstance&&(this.shouldVideoPlay=!0,this.adPlayerInstance.play());}onVideoPlaying(e){this.isSingleVideoTagPlay()||(this.nativeVideo.visible||this.nativeVideo.show(),this.nativeAdVideo.visible&&this.nativeAdVideo.hide());}hasFallbackSourceToCheck(e){let t=null!=this.currentMedia&&null!=this.currentMedia.source&&this.currentMedia.source.length>0&&Object.prototype.hasOwnProperty.call(this.currentMedia.source[0].customParams.h,"yospaceStream"),i=null!=this.currentMedia&&null!=this.currentMedia.source&&this.currentMedia.source.length>0&&Object.prototype.hasOwnProperty.call(this.currentMedia.source[0].customParams.h,"psumStream")||null!=this.currentMedia&&null!=this.currentMedia.sourceFallbacks&&this.currentMedia.sourceFallbacks.length>0&&null!=this.currentMedia.sourceFallbacks[0]&&this.currentMedia.sourceFallbacks[0].length>0&&null!=this.currentMedia.sourceFallbacks[0][0]&&Object.prototype.hasOwnProperty.call(this.currentMedia.sourceFallbacks[0][0].customParams.h,"psumStream"),s=null!=this.currentMedia&&null==this.currentMedia.drmCustomLicenseServerHandler||X.isSamsungSmartTVTizen||t||i,n=!1;return null!=e&&null!=e.data&&null!=e.data.additionalData&&1==e.data.additionalData.isTooSlowNetwokForPlayback&&(n=!0),!(null==this.currentMedia||!this.currentMedia.hasFallbackSources()||null==this.lastDataProviderEvent||!s)&&!n}reloadVideoWithNextFallbackSource(){let e=null!=this.nativeAdVideo&&null!=this.nativeAdVideo.get_src()&&!this.nativeAdVideo.get_paused()&&this.nativeVideo!=this.nativeAdVideo;if(e&&(this.shouldVideoPlay=!1),null==this.lastAdError||null!=this.lastMediaError||this.currentMedia.hasFallbackSources()||(this.currentMedia.mediaPlaybackInfo.isInStreamAdvertisementPlaying=!0),null!=this.currentMedia&&!this.currentMedia.hasFallbackSources()){this.get_variables().autoplay=!1,null==this.nativeVideo||this.nativeVideo.get_paused()||this.nativeVideo.pause(),null==this.nativeAdVideo||this.nativeAdVideo.get_paused()||this.nativeAdVideo.pause(),this.stopPermamentPlaybackErrorTimer();let e=new v("playbackPermamentError");return null!=this.lastMediaError&&(e.data=this.lastMediaError.data),void e.dispatch(this.context)}this.log("BRADMAX PLAYER NOTICE:\nError occurred during video load. Trying to load next fallback video.\n","warn");let t=new v("mediaErrorUsingFallbackSource");t.data=this.currentMedia,t.dispatch(this.context),this.currentMedia.useFallbackSources(),this.shouldVideoPlay||1!=this.get_variables().autoplay||(this.get_variables().autoplay=!1),this.lastDataProviderEvent.dispatch(this.context),e&&new o("adPlaying").dispatch(this.context),this.shouldVideoPlay&&new h("skinPlay").dispatch(this.context);}reloadVideoAfterNetworkProblem(){if(new c("closeMessage").dispatch(this.context),null!=this.playerInstance&&(this.playerInstance.destroy(),this.playerInstance=null),null!=this.adPlayerInstance&&(this.adPlayerInstance.destroy(),this.adPlayerInstance=null),null!=this.lastDataProviderEvent){if(this.lastDataProviderEvent.data instanceof y&&this.videoCurrentTime>0){let e=this.lastDataProviderEvent.data;null!=e.mediaUserSettings&&(e.mediaUserSettings.resumePostion=this.videoCurrentTime);}this.lastDataProviderEvent.dispatch(this.context);}new h("skinPlay").dispatch(this.context);}onNetworkErrorEvent(e){this.lastMediaError=e,this.stopPermamentPlaybackErrorTimer(),this.hasFallbackSourceToCheck(e)?this.reloadVideoWithNextFallbackSource():this.showNetworkTemporaryErrorMessage(e);}onVideoErrorEvent(e){this.lastMediaError=e,this.stopPermamentPlaybackErrorTimer(),this.hasFallbackSourceToCheck(e)?this.hasInStreamAds()?te.delay(he(this,this.reloadVideoWithNextFallbackSource),0):this.reloadVideoWithNextFallbackSource():(this.showMediaErrorMessage(e),null!=this.playerInstance&&this.playerInstance.pause());}onAdErrorEvent(e){this.lastAdError=e,this.hasFallbackSourceToCheck(e)?this.hasInStreamAds()?te.delay(he(this,this.reloadVideoWithNextFallbackSource),0):this.reloadVideoWithNextFallbackSource():(this.showMediaErrorMessage(e),null!=this.playerInstance&&this.playerInstance.pause());}onVideoDrmAuthError(e){this.stopPermamentPlaybackErrorTimer();let t=new v("playbackPermamentError");t.data=e.data,t.dispatch(this.context);}onVideoDrmModuleCrush(e){this.stopPermamentPlaybackErrorTimer();let t=new v("playbackPermamentError");t.data=e.data,t.dispatch(this.context);}showMediaErrorMessage(e){let t=new c("showMessage");t.data={type:"normal",title:J.translate("error"),text:J.translate("cannot_decode_media"),textDetails:this.getVideoEventErrorMessage(e),close:!1},t.dispatch(this.context),this.startPermamentPlaybackErrorTimer();}showNetworkPermamentErrorMessage(e){let t=new c("showMessage");t.data={type:"normal",title:J.translate("error"),text:J.translate("connection_error_permanent"),textDetails:this.getVideoEventErrorMessage(e),close:!1},t.dispatch(this.context),this.startPermamentPlaybackErrorTimer();}showNetworkTemporaryErrorMessage(e){let t=new c("showMessage");t.data={type:"normal",title:J.translate("error"),text:J.translate("connection_error"),textDetails:this.getVideoEventErrorMessage(e),userSingleActionButtonText:J.translate("try_again"),onUserSingleAction:he(this,this.reloadVideoAfterNetworkProblem),close:!1},t.dispatch(this.context);let i=new v("connectionErrorWaitingForUserAction");null!=e&&null!=e.data&&(i.data=e.data),i.dispatch(this.context),this.stopPermamentPlaybackErrorTimer();}startPermamentPlaybackErrorTimer(){this.stopPermamentPlaybackErrorTimer();let e=6e3;Object.prototype.hasOwnProperty.call(this.pluginConfig,"permamentPlaybackErrorSafetyWindow")&&this.pluginConfig.permamentPlaybackErrorSafetyWindow>0&&(e=this.pluginConfig.permamentPlaybackErrorSafetyWindow),this.permamentPlaybackErrorTimer=te.delay(he(this,this.onPermamentPlaybackErrorTimer),e);}stopPermamentPlaybackErrorTimer(){null!=this.permamentPlaybackErrorTimer&&(this.permamentPlaybackErrorTimer.stop(),this.permamentPlaybackErrorTimer=null);}onPermamentPlaybackErrorTimer(){this.stopPermamentPlaybackErrorTimer();let e=new v("playbackPermamentError");null!=this.lastMediaError&&(e.data=this.lastMediaError.data),e.dispatch(this.context);}getVideoEventErrorMessage(e){if(0==a.field(this.get_variables(),"showErrorDetails"))return "";let t=J.translate("details");if(null!=this.playerInstance){let e=oe.getClass(this.playerInstance).__name__.split(".");t+=" ["+e[e.length-1]+"]";}return t+=":\n",null!=e&&null!=e.data&&null!=e.data.additionalData&&null!=e.data.additionalData.message&&(t+=r.string(e.data.additionalData.message)),t}onVideoTimeChange(e){null!=e&&null!=e.data&&(this.videoCurrentTime=e.data.currentTime);}onAdVideoPlaying(e){this.isInStreamAdPlaying||this.isSingleVideoTagPlay()||(this.nativeVideo.visible&&this.nativeVideo.hide(),this.nativeAdVideo.visible||this.nativeAdVideo.show());}onAdInStreamPlaying(e){this.isInStreamAdPlaying=!0;}onAdInStreamEnd(e){this.isInStreamAdPlaying=!1;}eventFilter(e){let t=e instanceof v;return t&&"connectionError"==e.type&&this.hasFallbackSourceToCheck(e)?(this.onNetworkErrorEvent(e),!1):t&&("mediaError"==e.type||"loadError"==e.type)&&this.hasFallbackSourceToCheck(e)?(this.onVideoErrorEvent(e),!1):super.eventFilter(e)}getSupportRateForUrls(e){let t=[],i=0;for(;i<e.length;){let s=e[i++],n=0,a=0,r=this.videoPlayersClasses.length;for(;a<r;){let e=a++,t=this.videoPlayersClasses[e],i=new f;i.url=s,t.canPlay(i)&&(n=e+1);}t.push(n);}return t}getPlayerClassByName(e){if(null==this.videoPlayersClasses)return null;let t=0,i=this.videoPlayersClasses;for(;t<i.length;){let s=i[t];if(++t,s.__name__=="bs.player.plugin.video.videoPlayer."+e)return s}return null}}e.bs.player.plugin.video.Video=N,N.__name__="bs.player.plugin.video.Video",N.__super__=A,Object.assign(N.prototype,{__class__:N});class O{constructor(){this._videoElement=null,this._volume=null,this._playbackRate=null,this._iosInline=!1,this._controls=!1,this._muted=!1,this._anonymousCrossOrigin=!1,this.visible=!0;}get_muted(){let e=this._videoElement,t=null!=e?e.muted:null;return null!=t?t:this._muted}set_muted(e){return null!=this._videoElement?this._videoElement.muted=this._muted=e:this._muted=e}get_controls(){let e=this._videoElement,t=null!=e?e.controls:null;return null!=t?t:this._controls}set_controls(e){return null!=this._videoElement?this._videoElement.controls=this._controls=e:this._controls=e}get_playbackRate(){let e=this._videoElement,t=null!=e?e.playbackRate:null;return null!=t?t:this._playbackRate}set_playbackRate(e){return null!=this._videoElement?this._videoElement.playbackRate=this._playbackRate=e:this._playbackRate=e}get_volume(){let e=this._videoElement,t=null!=e?e.volume:null;return null!=t?t:this._volume}set_volume(e){return null!=this._videoElement?this._videoElement.volume=this._volume=e:this._volume=e}get_iosInline(){return this._iosInline}set_iosInline(e){return this.syncVideoIosInline(e),this._iosInline=e}get_anonymousCrossOrigin(){return this._anonymousCrossOrigin}set_anonymousCrossOrigin(e){return this.syncVideoCrossOrigin(e),this._anonymousCrossOrigin=e}get_element(){let e=this._videoElement;return null!=e&&null!=e?oe.__cast(e,HTMLElement):null}get_videoElement(){return this._videoElement}set_videoElement(e){return this._videoElement=e,this.syncVideo(),this.resize(),this._videoElement}get_paused(){let e=this._videoElement;return null!=e?e.paused:null}get_src(){let e=this._videoElement;return null!=e?e.src:null}pause(){let e=this._videoElement;null!=e&&e.pause();}mark(e){let t=this._videoElement;null!=t&&t.classList.add(e);}replaceWith(e){let t=this._videoElement;null!=t&&t.replaceWith(e.get_videoElement());}resize(){let e=this._videoElement;null!=e&&("absolute"!=e.style.position&&(e.style.position="absolute"),"0"!=e.style.top&&(e.style.top="0"),"0"!=e.style.left&&(e.style.left="0"),"100%"!=e.style.width&&(e.style.width="100%"),"100%"!=e.style.height&&(e.style.height="100%"));}show(){if(this.visible||null==this._videoElement)return;let e=this._videoElement;null!=e&&"block"!=e.style.display&&(e.style.display="block"),this.visible=!0;}hide(){if(!this.visible||null==this._videoElement)return;let e=this._videoElement;null!=e&&"none"!=e.style.display&&(e.style.display="none"),this.visible=!1;}clone(){let e=new O;return null!=this.get_controls()&&e.set_controls(this.get_controls()),null!=this.get_anonymousCrossOrigin()&&e.set_anonymousCrossOrigin(this.get_anonymousCrossOrigin()),null!=this.get_playbackRate()&&e.set_playbackRate(this.get_playbackRate()),null!=this.get_muted()&&e.set_muted(this.get_muted()),null!=this.get_volume()&&e.set_volume(this.get_volume()),e.set_iosInline(this.get_iosInline()),e.visible=this.visible,e}setIosInlineFromVariables(e,t){null==t&&(t=!0),this.set_iosInline(X.isiOS?e.iosInlineVideo:t);}setAnonymousCrossOriginFromVariables(e){this.set_anonymousCrossOrigin(e.anonymousCrossOrigin);}syncVideo(){null!=this._videoElement&&(null!=this.get_controls()&&(this._videoElement.controls=this.get_controls()),null!=this.get_playbackRate()&&(this._videoElement.playbackRate=this.get_playbackRate()),null!=this.get_muted()&&(this._videoElement.muted=this.get_muted()),null!=this.get_volume()&&(this._videoElement.volume=this.get_volume()),this.syncVideoCrossOrigin(this.get_anonymousCrossOrigin()),this.syncVideoIosInline(this.get_iosInline()),this.visible?this.show():this.hide());}syncVideoCrossOrigin(e){let t=this._videoElement;null!=t&&(e?t.hasAttribute("crossOrigin")&&"anonymous"==t.getAttribute("crossOrigin")||t.setAttribute("crossOrigin","anonymous"):t.hasAttribute("crossOrigin")&&t.removeAttribute("crossOrigin"));}syncVideoIosInline(e){let t=this._videoElement;null!=t&&(e?(t.hasAttribute("playsinline")||t.setAttribute("playsinline",""),t.hasAttribute("webkit-playsinline")||t.setAttribute("webkit-playsinline","")):(t.hasAttribute("playsinline")&&t.removeAttribute("playsinline"),t.hasAttribute("webkit-playsinline")&&t.removeAttribute("webkit-playsinline")));}}O.__name__="bs.player.plugin.video.VideoElementHolder",Object.assign(O.prototype,{__class__:O});class F{constructor(e,t){this.context=e,this.areListenersAttached=!1,this.renderer=t,this.hasPlaybackStarted=!1,this.activeEntries=new se;}setData(e){this.media=e,this.hasPlaybackStarted=!1,this.selectedSubtitlesSet=null,this.hasMediaExternalSubtitles(e)?this.attachListeners():this.detachListeners();}hasMediaExternalSubtitles(e){if(null!=e.subtitlesSets){let t=0,i=e.subtitlesSets;for(;t<i.length;){let e=i[t];if(++t,null!=e.url&&(this.isExtensionSrt(e.url)||this.isExtensionVtt(e.url)))return !0}}return !1}isExtensionSrt(e){return !!(e=this.stripQueryParams(e)).endsWith(".srt")||e.endsWith(".SRT")}isExtensionVtt(e){return !!((e=this.stripQueryParams(e)).endsWith(".vtt")||e.endsWith(".VTT")||e.endsWith(".webvtt"))||e.endsWith(".WEBVTT")}stripQueryParams(e){let t=new RegExp("[?#].*","".split("u").join(""));return null!=e&&(e=e.replace(t,"")),e}attachListeners(){this.areListenersAttached||(h.add(this.context,"selectSubtitles",he(this,this.onSelectSubtitles)),v.add(this.context,"playing",he(this,this.onPlayEvent)),v.add(this.context,"currentTimeChange",he(this,this.onTimeupdate)),this.areListenersAttached=!0);}detachListeners(){this.areListenersAttached&&(h.remove(this.context,"selectSubtitles",he(this,this.onSelectSubtitles)),v.remove(this.context,"playing",he(this,this.onPlayEvent)),v.remove(this.context,"currentTimeChange",he(this,this.onTimeupdate)),this.areListenersAttached=!1);}onPlayEvent(e){this.hasPlaybackStarted=!0,this.loadSelectedSubtitles();}onSelectSubtitles(e){if(null==e)return;let t=this.activeEntries.h;for(;null!=t;){let e=t.item;t=t.next,this.renderer.onCueExit(e);}this.activeEntries.clear(),this.selectSubtitlesSet(e.data);}selectSubtitlesSet(e){null!=e&&null!=e.url&&(this.isExtensionSrt(e.url)||this.isExtensionVtt(e.url))?(this.selectedSubtitlesSet=e,this.loadSelectedSubtitles()):this.selectedSubtitlesSet=null;}loadSelectedSubtitles(){if(this.hasPlaybackStarted&&null!=this.selectedSubtitlesSet&&null==this.selectedSubtitlesSet.subtitleEntries){let e=new le(this.selectedSubtitlesSet.url);e.onData=he(this,this.onLoadExternalSubtitlesSuccess),e.onError=he(this,this.onLoadExternalSubtitlesError),e.request();}}onTimeupdate(e){if(null==e||null==e.data||null==this.selectedSubtitlesSet||null==this.selectedSubtitlesSet.subtitleEntries)return;this.currentTime=e.data.currentTime;let t=new se,i=this.activeEntries.h;for(;null!=i;){let e=i.item;i=i.next;let s=this.currentTime;e.showTime<=s&&s<e.hideTime||(this.renderer.onCueExit(e),t.add(e));}let s=t.h;for(;null!=s;){let e=s.item;s=s.next,this.activeEntries.remove(e);}let n=this.findEntriesByTime(this.currentTime),a=0;for(;a<n.length;){let e=n[a];++a,this.isEntryOnList(e,this.activeEntries)||(this.activeEntries.push(e),this.renderer.onCueEnter(e));}}isEntryOnList(e,t){let i=t.h;for(;null!=i;){let t=i.item;if(i=i.next,t==e)return !0}return !1}findEntriesByTime(e){let t=[],i=this.selectedSubtitlesSet.subtitleEntries,s=0,n=i.length,a=Math.floor(n/2);for(;s<n;)e<i[a].showTime?n=a-1:s=a+1,a=Math.floor((s+n)/2);let r=a-1;for(;;){let s;if(r>=0){let t=i[r];s=t.showTime<=e&&e<t.hideTime;}else s=!1;if(!s)break;t.unshift(i[r]),--r;}for(r=a;;){let s;if(r<i.length){let t=i[r];s=t.showTime<=e&&e<t.hideTime;}else s=!1;if(!s)break;t.push(i[r]),++r;}return t}destroy(){this.detachListeners();}onLoadExternalSubtitlesSuccess(e){let t=null;t=this.isExtensionSrt(this.selectedSubtitlesSet.url)?new U:new z;try{this.selectedSubtitlesSet.subtitleEntries=t.parse(e);}catch(e){let t=ee.caught(e).unwrap();if(!(t instanceof B))throw e;{let e="Cannot load subtitles file. Parse error. \n"+r.string(t.message);console.error(e);}}}onLoadExternalSubtitlesError(e){let t="Cannot load external subtitles file "+this.selectedSubtitlesSet.url+".";console.error(t);}}F.__name__="bs.player.plugin.video.caption.ExternalSubtitlesController",Object.assign(F.prototype,{__class__:F});class W{}W.__name__="bs.player.plugin.video.caption.SubtitlesParserInterface",W.__isInterface__=!0,Object.assign(W.prototype,{__class__:W});class U{constructor(){this.timeEntriesSeparator=" --\x3e ",this.lineNumber=0,this.lines=null,this.endLinesRegexp=new i("(\r\n)|(\n)","g"),this.milisecondsSeparatorRegexp=new i("[,\\.]","g"),this.whiteSpacesRegexp=new i("[ \t\r\n]+","g");}readLine(){let e=this.lines[this.lineNumber];return this.lineNumber++,null!=e&&0==this.lineNumber?l.replace(e,"\ufeff",""):e}isFileEnd(){return this.lineNumber>=this.lines.length}isEmptyStr(e){return null==e||""==e}skipEmptyLines(){let e=this.readLine();for(;this.isEmptyStr(e)&&!this.isFileEnd();)e=this.readLine();this.isFileEnd()||this.lineNumber--;}parseEntry(){let e=new E;if(this.isEmptyStr(this.readLine()))throw ee.thrown(new B("Error in line: "+this.lineNumber+". Cannot parse entry number."));let t=this.readLine();if(this.isEmptyStr(t))throw ee.thrown(new B("Error in line: "+this.lineNumber+". Cannot parse time for entry."));t=t.replace(this.whiteSpacesRegexp.r," ");let i=t.split(this.timeEntriesSeparator);if(2!=i.length)throw ee.thrown(new B("Error in line: "+this.lineNumber+". Cannot parse time for entry."));e.showTime=this.parseTime(i[0]),e.hideTime=this.parseTime(i[1]),e.texts=[];let s=this.readLine();for(;!this.isEmptyStr(s);){let t=new P;t.text=l.trim(s),e.texts.push(t),s=this.readLine();}if(0==e.texts.length)throw ee.thrown(new B("Error in line: "+this.lineNumber+". No text for entry."));return e}parseTime(e){if(null==e)throw ee.thrown(new B("Error in line: "+this.lineNumber+". Cannot parse time for entry."));let t=this.milisecondsSeparatorRegexp.split(e),i=0;t.length>1&&(i=r.parseInt(t[1]));let s=t[0].split(":");if(3!=s.length)throw ee.thrown(new B("Error in line: "+this.lineNumber+". Cannot parse time for entry."));let n=0;return n=0+3600*r.parseInt(s[0]),n+=60*r.parseInt(s[1]),n+=r.parseInt(s[2]),n+=i/1e3,n}parse(e){this.lines=this.endLinesRegexp.split(e),this.lineNumber=0,this.skipEmptyLines();let t=[];for(;!this.isFileEnd();)t.push(this.parseEntry()),this.skipEmptyLines();return t}}U.__name__="bs.player.plugin.video.caption.SrtSubtitlesParser",U.__interfaces__=[W],Object.assign(U.prototype,{__class__:U});class B{constructor(e){this.message=e;}}B.__name__="bs.player.plugin.video.caption.SubtitlesParserError",Object.assign(B.prototype,{__class__:B});class z extends U{constructor(){super();}parse(e){this.lines=this.endLinesRegexp.split(e),this.lineNumber=0,this.skipEmptyLines();let t=this.readLine();if(t=l.trim(t),65279==s.cca(t,0)&&(t=s.substr(t,1,null)),"WEBVTT"!=t)throw ee.thrown(new B("Error in line: "+this.lineNumber+". WEBVTT text expected in first line."));this.skipEmptyLines();let i=[];for(;!this.isFileEnd();)i.push(this.parseEntry()),this.skipEmptyLines();return i}}z.__name__="bs.player.plugin.video.caption.VttSubtitlesParser",z.__super__=U,Object.assign(z.prototype,{__class__:z});class H{constructor(e){this.state=0,this.castSession=null,this.isSeeking=!1,this.isAdvertisement=!1,this.isQuickFallbackPathForLiveEnabled=!0,this.minAudioTracksForInfo=2,null==H.instances.h[(e?"ad_":"")+this.context]&&(this.volumeLevel=1,this.isAdvertisement=e);}setSession(e,t){this.castSession=e,this.sender=t,h.add(this.context,"skinVolume",he(this,this.onVolumeChange)),h.add(this.context,"skinMute",he(this,this.onMuteChange)),h.add(this.context,"skinUnmute",he(this,this.onUnMuteChange)),null!=this.castSession&&(this.state=10,this.setupMedia());}setPlaybackRate(e){if(this.isAdvertisement||this.currentPlaybackRate==e)return;if(this.desiredPlaybackRate=e,null==this.castSession)return;let t=this.castSession.getMediaSession();null!=t&&this.castSession.sendMessage("urn:x-cast:com.google.cast.media",{type:"SET_PLAYBACK_RATE",playbackRate:this.desiredPlaybackRate,mediaSessionId:t.mediaSessionId,requestId:1}).then((function(e){})).catch((function(e){console.error("Set playback rate error: "+e);}));}getPlaybackRate(){return this.isAdvertisement?1:this.currentPlaybackRate}triggerVideoPlaybackRateEvent(){if(this.isAdvertisement)return;let e=new v("playbackRate");e.data=this.getPlaybackRate(),e.dispatch(this.context);}setupMedia(){let e=this;if(null!=this.media&&null!=this.media.source&&this.media.source.length>0&&null!=this.castSession&&null!=this.sender){this.state=20;let t=this.media.source[0].url,i=this.sender.newMediaInfo(t);i.metadata=this.sender.newGenericMediaMetadata(),i.metadata.title=this.media.title;let s=(null!=this.media.splashImages?this.media.splashImages:[]).concat(null!=this.media.posterImages?this.media.posterImages:[]),n=[],a=0;for(;a<s.length;){let e=s[a];++a,null!=e&&n.push(e);}let r=[],l=0;for(;l<n.length;)r.push(this.sender.castMediaImage(n[l++]));if(i.metadata.images=r,i.customData={statsId:this.media.id,statsTitle:this.media.title},null!=this.mediaVmapResponse||null!=this.mediaVmapUrl){let e={};null!=this.mediaVmapResponse?e.adsResponse=this.mediaVmapResponse:e.adTagUrl=this.mediaVmapUrl,i.vmapAdsRequest=e;}"hls"==Z.detect(t)?this.checkIfCmaf(t,(function(t){t&&(i.hlsSegmentFormat="fmp4",i.hlsVideoSegmentFormat="fmp4"),e.setupMediaFinalize(i);})):this.setupMediaFinalize(i);}}setupMediaFinalize(e){let t,i=this.sender.newLoadRequest(e);if(i.autoplay=this.media.mediaPlaybackInfo.isPlaying,this.media.mediaPlaybackInfo.currentTime>0&&(i.currentTime=this.media.mediaPlaybackInfo.currentTime),null!=this.desiredPlaybackRate){let e=this.desiredPlaybackRate;t=!isNaN(e);}else t=!1;t&&this.desiredPlaybackRate>=.5&&(i.playbackRate=this.desiredPlaybackRate);let s=this.castSession.loadMedia(i);this.setupMediaTimeoutTimer=te.delay(he(this,this.onRemoteMediaSetupTimeout),12e3),s.then(he(this,this.onRemoteMediaLoad),he(this,this.onRemoteMediaError)).catch(he(this,this.onRemoteMediaError));}checkIfCmaf(e,t){let i=new XMLHttpRequest,s=function(){t(!1);},n=this;i.addEventListener("load",(function(a){let r=i.responseText;if(n.hasSubmanifests(r)){let i=new String(new URL(n.hlsFindAnySubmanifest(r),e)),a=new XMLHttpRequest,l=function(e){t(n.hlsFindIfCmaf(a.responseText));};a.addEventListener("load",l,!1),a.addEventListener("error",s,!1),a.open("GET",i,!0),a.send();}else t(n.hlsFindIfCmaf(r));}),!1),i.addEventListener("error",s,!1),i.open("GET",e,!0),i.send();}hasSubmanifests(e){return null!=this.hlsFindAnySubmanifest(e)}hlsFindAnySubmanifest(e){let t=e.split("\n"),i=!1,s=0;for(;s<t.length;){let e=t[s];if(++s,i&&-1!=e.indexOf(".m3u8"))return e;0==e.indexOf("#EXT-X-STREAM-INF:")&&(i=!0);}return null}hlsFindIfCmaf(e){return -1!=e.indexOf("#EXT-X-MAP:URI=")}stopSetupMediaTimeoutTimer(){null!=this.setupMediaTimeoutTimer&&(this.setupMediaTimeoutTimer.stop(),this.setupMediaTimeoutTimer=null);}onRemoteMediaSetupTimeout(){this.stopSetupMediaTimeoutTimer(),this.onRemoteMediaError({description:'Chromecast cannot initialize remote media. Probably Chromecast is blocking playback because of more restricted CORS policy (no wildcard "*" is allowed). Please check page if you are a stream provider: https://developers.google.com/cast/docs/chrome_sender/advanced#cors_requirements '});}onRemoteMediaError(e){this.stopSetupMediaTimeoutTimer();let t="";null!=e&&null!=e.code&&(t="errorCode: "+r.string(e.code)),null!=e&&null!=e.description&&(t+=" description: "+r.string(e.description)),this.dispatchEvent(this.isAdvertisement?new o("adConnectionError"):new v("connectionError"),{errObj:e,isTemporaryNetworkIssue:!1,message:t}),this.sender.disconnect();}onRemoteMediaLoad(){this.stopSetupMediaTimeoutTimer(),new v("videoCastingStart").dispatch(this.context),this.remotePlayer=this.sender.newRemotePlayer(),this.remotePlayerController=this.sender.newRemotePlayerController(this.remotePlayer),this.state=30,this.media.mediaPlaybackInfo.currentTime>0&&this.remotePlayer.canSeek&&this.seek(this.media.mediaPlaybackInfo.currentTime),this.volume(this.volumeLevel),this.dispatchEvent(this.isAdvertisement?new o("adPlaying"):new v("playing")),this.media.mediaPlaybackInfo.isPlaying||this.dispatchEvent(this.isAdvertisement?new o("adPaused"):new v("paused")),this.dispatchEvent(this.isAdvertisement?new o("adDurationChange"):new v("durationChange"));let e=this.sender.getCast().framework.RemotePlayerEventType;this.remotePlayerController.addEventListener(e.CURRENT_TIME_CHANGED,he(this,this.onRemoteTimeChange)),this.remotePlayerController.addEventListener(e.DURATION_CHANGED,he(this,this.onRemoteDurationChange)),this.remotePlayerController.addEventListener(e.IS_PAUSED_CHANGED,he(this,this.onRemotePauseChange)),this.remotePlayerController.addEventListener(e.MEDIA_INFO_CHANGED,he(this,this.onRemoteMediaInfoChange));}onRemoteTimeChange(){null!=this.remotePlayer&&null!=this.remotePlayerController&&this.remotePlayer.isConnected&&(this.dispatchEvent(this.isAdvertisement?new o("adCurrentTimeChange"):new v("currentTimeChange")),this.isSeeking&&(this.isSeeking=!1,this.dispatchEvent(this.isAdvertisement?new o("seekingEnd"):new v("seekingEnd"))),this.remotePlayer.isPaused&&this.dispatchEvent(this.isAdvertisement?new o("adPaused"):new v("paused")));}onRemoteDurationChange(){null!=this.remotePlayer&&null!=this.remotePlayerController&&this.remotePlayer.isConnected&&(this.dispatchEvent(this.isAdvertisement?new o("adDurationChange"):new v("durationChange")),0==this.remotePlayer.duration&&null==this.remotePlayer.mediaInfo&&this.dispatchEvent(this.isAdvertisement?new o("adComplete"):new v("complete")));}onRemotePauseChange(){null!=this.remotePlayer&&null!=this.remotePlayerController&&this.remotePlayer.isConnected&&(this.remotePlayer.isPaused?this.dispatchEvent(this.isAdvertisement?new o("adPaused"):new v("paused")):this.dispatchEvent(this.isAdvertisement?new o("adPlaying"):new v("playing")));}onRemoteMediaInfoChange(){if(null!=this.remotePlayer&&null!=this.remotePlayerController&&this.remotePlayer.isConnected){if(null!=this.castSession){let e=this.castSession.getMediaSession();if(null!=e){let t=e.playbackRate;!isNaN(t)&&t>0&&t!=this.currentPlaybackRate&&(this.currentPlaybackRate=t,this.triggerVideoPlaybackRateEvent());}}this.hasVideoComplete()&&(this.state=10,this.dispatchEvent(this.isAdvertisement?new o("adComplete"):new v("complete")));}}onChromecastDisonnect(){if(null!=this.mediaVmapResponse&&null!=this.variables.freewheel){this.variables.freewheel.testFeed=this.mediaVmapResponse;let e=new o("feedUpdate");e.data=this.mediaVmapResponse,e.dispatch(this.context);}if(null!=this.mediaVmapUrl&&null!=this.variables.freewheel){this.variables.freewheel.testFeedUrl=this.mediaVmapUrl;let e=new o("feedUpdate");e.data=this.mediaVmapUrl,e.dispatch(this.context);}if(null!=this.media&&null!=this.media.mediaPlaybackInfo&&this.media.mediaPlaybackInfo.currentTime>0&&(this.media.mediaUserSettings.resumePostion=this.media.mediaPlaybackInfo.currentTime),h.remove(this.context,"skinVolume",he(this,this.onVolumeChange)),h.remove(this.context,"skinMute",he(this,this.onMuteChange)),h.remove(this.context,"skinUnmute",he(this,this.onUnMuteChange)),null!=this.remotePlayerController){let e=this.sender.getCast().framework.RemotePlayerEventType;this.remotePlayerController.removeEventListener(e.CURRENT_TIME_CHANGED,he(this,this.onRemoteTimeChange)),this.remotePlayerController.removeEventListener(e.DURATION_CHANGED,he(this,this.onRemoteDurationChange)),this.remotePlayerController.removeEventListener(e.IS_PAUSED_CHANGED,he(this,this.onRemotePauseChange)),this.remotePlayerController.removeEventListener(e.MEDIA_INFO_CHANGED,he(this,this.onRemoteMediaInfoChange));}this.state=0,this.media=null,this.remotePlayer=null,this.remotePlayerController=null;}dispatchEvent(e,t){let i=0,s=0;null!=this.remotePlayer&&(i=this.remotePlayer.duration,s=this.remotePlayer.currentTime,0==s&&null!=this.remotePlayer.savedPlayerState&&(s=this.remotePlayer.savedPlayerState.currentTime,i=this.remotePlayer.savedPlayerState.mediaInfo.duration)),null!=this.media&&(this.media.mediaPlaybackInfo.currentTime=s,this.media.mediaPlaybackInfo.isPlaying=null!=this.remotePlayer&&!this.remotePlayer.isPaused,this.media.mediaPlaybackInfo.playbackRate=this.getPlaybackRate()),null==e.data&&(e.data={}),e.data.duration=i,e.data.currentTime=s,e.data.media=this.media,e.data.additionalData=t,e.dispatch(this.context);}create(){}destroy(){}attachVideo(e){}attachSubtitlesRenderer(e){}playerResize(e){}videoReady(){}onDurationChange(e){}pause(){null!=this.remotePlayer&&null!=this.remotePlayerController&&(this.remotePlayer.isPaused||this.remotePlayerController.playOrPause());}play(){null!=this.remotePlayer&&null!=this.remotePlayerController&&this.remotePlayer.isPaused&&(this.hasVideoComplete()?(this.media.mediaPlaybackInfo.isPlaying=!0,this.setupMedia()):this.remotePlayerController.playOrPause());}playPause(){this.hasVideoComplete()?(this.media.mediaPlaybackInfo.isPlaying=!0,this.setupMedia()):null!=this.remotePlayerController&&this.remotePlayerController.playOrPause();}hasVideoComplete(){return null!=this.media&&null!=this.remotePlayer&&null==this.remotePlayer.mediaInfo&&null!=this.castSession&&this.state>=10&&(null==this.remotePlayer.savedPlayerState||this.remotePlayer.savedPlayerState.duration>0&&this.remotePlayer.savedPlayerState.currentTime>=this.remotePlayer.savedPlayerState.duration-1)}reset(){}seek(e){null!=this.remotePlayer&&null!=this.remotePlayerController&&(this.remotePlayer.currentTime=e,this.remotePlayerController.seek(),this.isSeeking=!0,this.dispatchEvent(this.isAdvertisement?new o("seekingStart"):new v("seekingStart")));}selectAudio(e){}selectSubtitles(e){}volume(e){this.volumeLevel=e,null!=this.remotePlayer&&null!=this.remotePlayerController&&(this.remotePlayer.volumeLevel=e,this.remotePlayerController.setVolumeLevel());}onVolumeChange(e){null!=e&&null!=e.data&&this.volume(e.data);}onMuteChange(e){null!=this.remotePlayer&&null!=this.remotePlayerController&&0==this.remotePlayer.isMuted&&this.remotePlayerController.muteOrUnmute();}onUnMuteChange(e){null!=this.remotePlayer&&null!=this.remotePlayerController&&1==this.remotePlayer.isMuted&&this.remotePlayerController.muteOrUnmute();}setData(e){if(this.media=e,this.mediaVmapResponse=null,this.mediaVmapUrl=null,null!=this.variables.freewheel){null!=this.variables.freewheel.testFeed&&(this.mediaVmapResponse=this.variables.freewheel.testFeed,this.variables.freewheel.testFeed=""),null!=this.variables.freewheel.testFeedUrl&&(this.mediaVmapUrl=this.variables.freewheel.testFeedUrl,this.variables.freewheel.testFeedUrl="");let e=new o("feedUpdate");e.data="",e.dispatch(this.context);}null!=this.castSession&&this.state>=10&&(e.mediaPlaybackInfo.isPlaying=!0,this.setupMedia());}saveBandwidthModeVisibilityChange(e){}static canPlay(e){return !0}static getInstance(e,t){let i=t?"ad_":"";if(Object.prototype.hasOwnProperty.call(H.instances.h,i+e))return H.instances.h[i+e];{let s=new H(t);return H.instances.h[i+e]=s,s.context=e,s.create(),s}}}H.__name__="bs.player.plugin.video.chromecast.ChromecastVideo",Object.assign(H.prototype,{__class__:H});class j{constructor(e,t,i){this.alreadyDispatched=!1;let s=HTMLVideoElement.prototype;this.canRequestVideoFrame=null!=(null!=s?he(s,s.requestVideoFrameCallback):null),this.context=e,this.nativeVideo=t,this.nativeAdVideo=i,this.reset();}create(e){if(this.reset(),this.canRequestVideoFrame){let t=(e?this.nativeAdVideo:this.nativeVideo)._videoElement;null!=t&&t.requestVideoFrameCallback(he(this,this.videoFrameCallback));}o.addOnce(this.context,"adCurrentTimeChange",he(this,this.onceEvent)),v.addOnce(this.context,"currentTimeChange",he(this,this.onceEvent));}destroy(){if(this.reset(),this.canRequestVideoFrame){let e=this.nativeAdVideo._videoElement;null!=e&&e.cancelVideoFrameCallback(he(this,this.videoFrameCallback));let t=this.nativeVideo._videoElement;null!=t&&t.cancelVideoFrameCallback(he(this,this.videoFrameCallback));}o.remove(this.context,"adCurrentTimeChange",he(this,this.onceEvent)),v.remove(this.context,"currentTimeChange",he(this,this.onceEvent));}reset(){this.alreadyDispatched=!1;}videoFrameCallback(e,t){this.dispatch();}onceEvent(e){this.dispatch();}dispatch(){this.alreadyDispatched||(new v("firstFrame").dispatch(this.context),this.destroy(),this.alreadyDispatched=!0);}}j.__name__="bs.player.plugin.video.dispatcher.FirstVideoFrameEventDispatcher",Object.assign(j.prototype,{__class__:j});class K{constructor(e,t){this.videoPlayer=e,this.enabled=K.canBeEnabled(t);}create(){this.destroy(),this.enabled&&Q.addRootEventListener("visibilitychange",he(this,this.handleVisibilityChange));}destroy(){Q.removeRootEventListener("visibilitychange",he(this,this.handleVisibilityChange));}handleVisibilityChange(e){let t=this.videoPlayer;null!=t&&t.saveBandwidthModeVisibilityChange(0==Q.isRootVisible());}static canBeEnabled(e){return null!=e&&(null!=e&&oe.__cast(e.saveBandwidthMode,ve))}}K.__name__="bs.player.plugin.video.handler.SaveBandwidthModeHandler",Object.assign(K.prototype,{__class__:K});class q{constructor(e){this.currentVideoResolution=null,this.currentVideoSet=null,this.activeTextTrackId=null,this.playbackRate=1,this.isStartTimeInitialized=!1,this.currentTime=0,this.initialAsAdvertisement=!1,this.isInStreamAdvertisement=!1,this.isAdvertisement=!1,this.isQuickFallbackPathForLiveEnabled=!0,this.minAudioTracksForInfo=2,this.VIDEO_TRACK_RESOLUTION_EREG=new i("([0-9]{3,4})x([0-9]{3,4})",""),null==q.instances.h[(e?"ad_":"")+this.context]&&(this.isAdvertisement=e,this.initialAsAdvertisement=e,this.isInStreamAdvertisement=!1,this.state=0,this.fairPlayDrm=new G(this),this.areSubtitlesAndAudioTracksInitialized=!1,this.isStartTimeInitialized=!1,this.isBuffering=!1,this.prePlaybackSeekRelativePosition=null,this.videoElementCommandsQueue=[],this.videoElementPromise=null,this.androidHlsPlaybackWatchdogTimer=null,this.androidHlsPlaybackEndWatchdogTimer=null,this.onErrorFallbackTriesNum=0,this.iosIsStalledConnection=!1,this.iosIsStalledConnectionDetectionEnabled=!1,this.iosIsStalledConnectionProblemsStart=null,this.hasCriticalErrorBeenDispatched=!1,this.mobileOrSafariBufferingTimeoutOccurred=!1);}create(){h.add(this.context,"selectSubtitles",he(this,this.onSelectSubtitles)),h.add(this.context,"selectAudio",he(this,this.onSelectAudio)),h.add(this.context,"selectVideoTrack",he(this,this.onSelectVideoTrack)),"Safari"!=X.browserName||X.isSamsungSmartTVTizen||(m.add(this.context,"resize",he(this,this.onPlayerResizeEvent)),window.addEventListener("resize",he(this,this.onWindowResize))),o.add(this.context,"adInStreamPlaying",he(this,this.onAdInStreamPlaying)),o.add(this.context,"adInStreamPlayingSilent",he(this,this.onAdInStreamPlaying)),o.add(this.context,"adInStreamEnd",he(this,this.onAdInStreamEnd)),o.add(this.context,"adInStreamEndSilent",he(this,this.onAdInStreamEnd)),o.add(this.context,"adInStreamClipPlaying",he(this,this.onAdClipInStreamPlaying)),o.add(this.context,"adInStreamClipPlayingSilent",he(this,this.onAdClipInStreamPlaying)),o.add(this.context,"adInStreamClipEnd",he(this,this.onAdClipInStreamEnd)),o.add(this.context,"adInStreamClipEndSilent",he(this,this.onAdClipInStreamEnd)),o.add(this.context,"adInStreamAdsBreaksInfo",he(this,this.onAdInStreamAdsBreaksInfo));}onAdInStreamPlaying(e){this.isAdvertisement=!0,this.isInStreamAdvertisement=!0,null!=this.media&&null!=this.media.mediaPlaybackInfo&&(this.media.mediaPlaybackInfo.isInStreamAdvertisementPlaying=!0);}onAdInStreamEnd(e){this.isAdvertisement=this.initialAsAdvertisement,this.isInStreamAdvertisement=!1,null!=this.media&&null!=this.media.mediaPlaybackInfo&&(this.media.mediaPlaybackInfo.isInStreamAdvertisementPlaying=!1),!X.isiOS&&"Safari"!=X.browserName||X.isSamsungSmartTVTizen||(this.iosHitDecoderAfter=this.video.currentTime+.5);}onAdClipInStreamPlaying(e){null!=this.video&&null!=this.media&&(this.inStreamAdvertStartPos=this.video.currentTime,null!=e.data&&e.data.adStartTime>=0&&(this.inStreamAdvertStartPos=e.data.adStartTime,(X.isiOS||"Safari"==X.browserName)&&!X.isSamsungSmartTVTizen&&this.inStreamAdvertStartPos>86400&&null!=this.dvrPlaybackStartTs&&this.dvrPlaybackStartTs>0&&(this.inStreamAdvertStartPos-=this.dvrPlaybackStartTs)),this.inStreamAdvertMedia=null,null!=e&&null!=e.data&&(this.inStreamAdvertMedia=e.data.media));}onAdClipInStreamEnd(e){this.inStreamAdvertStartPos=null,this.inStreamAdvertMedia=null;}onAdInStreamAdsBreaksInfo(e){let t=this.getPlaybackStartTime(this.media);null!=t&&t>0&&this.currentTime!=t&&!this.isStartTimeInitialized&&(this.currentTime=t);}isWebSafari(){return "Safari"==X.browserName&&!X.isSamsungSmartTVTizen}destroy(){this.stopLiveEdgeUpdateTimer(),this.stopAndroidHlsPlaybackEndWatchdogTimer(),this.stopLiveStreamEndingTimeout(),this.stopMobileOrSafariBufferingTimeoutTimer(),this.stopPlaybackRestartTimeoutTimer(),this.stopInitializeAfterCanplaythrouTimer(),this.stopSafariErrorTimeoutTimer(),this.stopVideoResolutionWatchdogTimer(),h.remove(this.context,"selectSubtitles",he(this,this.onSelectSubtitles)),h.remove(this.context,"selectAudio",he(this,this.onSelectAudio)),h.remove(this.context,"selectVideoTrack",he(this,this.onSelectVideoTrack)),"Safari"!=X.browserName||X.isSamsungSmartTVTizen||(m.remove(this.context,"resize",he(this,this.onPlayerResizeEvent)),window.removeEventListener("resize",he(this,this.onWindowResize))),o.remove(this.context,"adInStreamPlaying",he(this,this.onAdInStreamPlaying)),o.remove(this.context,"adInStreamPlayingSilent",he(this,this.onAdInStreamPlaying)),o.remove(this.context,"adInStreamEnd",he(this,this.onAdInStreamEnd)),o.remove(this.context,"adInStreamEndSilent",he(this,this.onAdInStreamEnd)),o.remove(this.context,"adInStreamClipPlaying",he(this,this.onAdClipInStreamPlaying)),o.remove(this.context,"adInStreamClipPlayingSilent",he(this,this.onAdClipInStreamPlaying)),o.remove(this.context,"adInStreamClipEnd",he(this,this.onAdClipInStreamEnd)),o.remove(this.context,"adInStreamClipEndSilent",he(this,this.onAdClipInStreamEnd)),o.remove(this.context,"adInStreamAdsBreaksInfo",he(this,this.onAdInStreamAdsBreaksInfo)),null!=this.video&&(this.video.removeEventListener("pause",he(this,this.onVideoPause)),this.video.removeEventListener("play",he(this,this.onVideoPlay)),this.video.removeEventListener("playing",he(this,this.onVideoPlaying)),this.video.removeEventListener("timeupdate",he(this,this.onVideoTimeupdate)),this.video.removeEventListener("durationchange",he(this,this.onVideoDurationchange)),this.video.removeEventListener("waiting",he(this,this.onVideoWaiting)),this.video.removeEventListener("ended",he(this,this.onVideoEnded)),this.video.removeEventListener("seeking",he(this,this.onVideoSeeking)),this.video.removeEventListener("seeked",he(this,this.onVideoSeeked)),this.isWebSafari()?this.video.removeEventListener("error",he(this,this.onErrorWebSafari)):this.video.removeEventListener("error",he(this,this.onError)),!X.isiOS&&"Safari"!=X.browserName||X.isSamsungSmartTVTizen||this.video.removeEventListener("stalled",he(this,this.onIosStalled)),this.video.removeEventListener("canplaythrough",he(this,this.onVideoCanplaythrough)),null!=this.fairPlayDrm&&this.video.removeEventListener("webkitneedkey",he(ae=this.fairPlayDrm,ae.onNeedKey)),this.video.removeEventListener("loadedmetadata",he(this,this.onVideoLoadedMetadata)),null!=this.video.textTracks&&(this.video.textTracks.removeEventListener("addtrack",he(this,this.onAddTrack)),this.video.textTracks.removeEventListener("change",he(this,this.onChangeTextTrack))),this.video.removeEventListener("ratechange",he(this,this.onVideoRateChange)),this.video.setAttribute("src",""),this.video.load()),this.video=null,this.mediaSourceUrl=null,q.canPlayFileExtensionCache=new re,q.instances=new re,this.isAdvertisement=null,this.media=null,this.currentTime=null,this.state=null,this.fairPlayDrm.reset(),this.areSubtitlesAndAudioTracksInitialized=null,this.isStartTimeInitialized=!1,this.isBuffering=!1,this.onErrorFallbackTriesNum=0,this.iosIsStalledConnection=!1,this.iosIsStalledConnectionDetectionEnabled=!1,this.iosIsStalledConnectionProblemsStart=null,this.currentVideoSet=null,this.currentVideoResolution=null,this.unregisterThumbnailProvider();}dispatchEvent(e,t){if(!this.isEventFromRightContext())return;let i=this.video.duration,s=this.currentTime;if(null!=this.media&&(this.media.mediaPlaybackInfo.playbackRate=this.getPlaybackRate()),null!=this.media&&this.areSubtitlesAndAudioTracksInitialized){if(this.media.mediaPlaybackInfo.currentTime=s,this.media.mediaPlaybackInfo.isPlaying=!this.video.paused,this.isDvr()){i=this.getDVRWindowSize(),this.media.duration=i;let t=this.getDVRWindowRange();this.isVideoCurrentTimeReliable()?(s=this.dvrRelativePlaybackTimeToDvrWindowTime(this.video.currentTime),this.media.mediaPlaybackInfo.currentTime=this.dvrRelativePlaybackTimeToTs(this.video.currentTime)):(s=this.dvrRelativePlaybackTimeToDvrWindowTime(this.currentTime),this.media.mediaPlaybackInfo.currentTime=this.dvrRelativePlaybackTimeToTs(this.currentTime));let n=this.media;n.dvrWindowLength=i,null!=t&&(n.dvrWindowLiveEdge=this.dvrRelativePlaybackTimeToTs(t.end),"currentTimeChange"==e.type&&(this.dvrWindowTailLastSend=t.start));}}else if(null!=this.media&&this.isDvr()&&0==this.currentTime){let e=this.getPlaybackStartTime(this.media),t=this.getDVRWindowRange();this.media.mediaPlaybackInfo.currentTime=e>0?e:null!=t?this.dvrRelativePlaybackTimeToTs(t.end):this.getNowTs();}null!=this.prePlaybackSeekRelativePosition&&0==s&&(s=this.prePlaybackSeekRelativePosition*this.media.duration);let n=0,a=0,r=this.video.buffered.length;for(;a<r;){let e=a++;n+=this.video.buffered.end(e)-this.video.buffered.start(e);}null==e.data&&(e.data={}),this.isInStreamAdvertisement&&this.inStreamAdvertStartPos>=0&&(s=this.video.currentTime-this.inStreamAdvertStartPos,null!=this.inStreamAdvertMedia&&(i=this.inStreamAdvertMedia.duration),s>i&&(s=i),0==this.video.currentTime&&s<0&&(s=i,null!=this.media&&null!=this.media.mediaPlaybackInfo&&(this.media.mediaPlaybackInfo.currentTime=this.inStreamAdvertStartPos+i))),e.data.duration=i,e.data.currentTime=s,e.data.videoTagCurrentTime=this.video.currentTime,e.data.source=this.video.currentSrc,e.data.totalBufferedTime=n,e.data.media=this.media,e.data.additionalData=t,this.isPlaybackNotAllowed&&(null==e.data.additionalData&&(e.data.additionalData={}),e.data.additionalData.isPlaybackNotAllowed=!0),e.dispatch(this.context);}dvrRelativePlaybackTimeToDvrWindowTime(e){let t=this.getDVRWindowRange();return null==t?e:e-t.start}dvrWindowTimeToDvrRelativePlaybackTime(e){if(null!=this.dvrWindowTailLastSend)return e+this.dvrWindowTailLastSend;let t=this.getDVRWindowRange();return null==t?e:e<t.start?t.start:e>t.end?t.end:e}isDvr(){return null!=this.media&&this.media instanceof b}dvrRelativePlaybackTimeToTs(e){let t=0;return null!=this.dvrPlaybackStartTs&&(t=this.dvrPlaybackStartTs),t+e}getDVRWindowRangeRaw(){if(null==this.video||null==this.video.seekable||0==this.video.seekable.length)return null;return {start:this.video.seekable.start(0),end:this.video.seekable.end(0)}}getDVRWindowRange(){let e=this.getDVRWindowRangeRaw();return null==e?null:(null!=this.dvrWindowStartTimeTs&&null!=this.dvrPlaybackStartTs&&this.dvrRelativePlaybackTimeToTs(e.start)<this.dvrWindowStartTimeTs&&(e.start=this.dvrWindowStartTimeTs-this.dvrPlaybackStartTs),null!=this.dvrWindowEndTimeTs&&null!=this.dvrPlaybackStartTs&&this.dvrWindowEndTimeTs<this.dvrRelativePlaybackTimeToTs(e.end)&&(e.end=this.dvrWindowEndTimeTs-this.dvrPlaybackStartTs),e)}getDVRWindowSize(){let e,t=this.getDVRWindowRange();if(null!=t){let i=t.end;e=!isFinite(i);}else e=!0;return e?0:t.end-t.start}getNowTs(){return (new Date).getTime()/1e3}attachSubtitlesRenderer(e){this.subtitlesRenderer=e;}attachVideo(e){this.video=e,this.video.addEventListener("pause",he(this,this.onVideoPause)),this.video.addEventListener("play",he(this,this.onVideoPlay)),this.video.addEventListener("playing",he(this,this.onVideoPlaying)),this.video.addEventListener("timeupdate",he(this,this.onVideoTimeupdate)),this.video.addEventListener("durationchange",he(this,this.onVideoDurationchange)),this.video.addEventListener("waiting",he(this,this.onVideoWaiting)),this.video.addEventListener("ended",he(this,this.onVideoEnded)),this.video.addEventListener("seeking",he(this,this.onVideoSeeking)),this.video.addEventListener("seeked",he(this,this.onVideoSeeked)),this.isWebSafari()?this.video.addEventListener("error",he(this,this.onErrorWebSafari)):this.video.addEventListener("error",he(this,this.onError)),!X.isiOS&&"Safari"!=X.browserName||X.isSamsungSmartTVTizen||this.video.addEventListener("stalled",he(this,this.onIosStalled)),this.video.addEventListener("canplaythrough",he(this,this.onVideoCanplaythrough)),this.video.addEventListener("loadedmetadata",he(this,this.onVideoLoadedMetadata)),null!=this.video.textTracks&&(this.video.textTracks.addEventListener("addtrack",he(this,this.onAddTrack)),this.video.textTracks.addEventListener("change",he(this,this.onChangeTextTrack))),"Safari"!=X.browserName||X.isSamsungSmartTVTizen||this.video.addEventListener("webkitneedkey",he(ae=this.fairPlayDrm,ae.onNeedKey),!1),this.video.addEventListener("ratechange",he(this,this.onVideoRateChange)),this.checkPlaybackRate(),this.triggerVideoPlaybackRateEvent();}setPlaybackRate(e){this.isAdvertisement||(this.playbackRate=e,this.checkPlaybackRate());}getPlaybackRate(){return this.video.playbackRate}onVideoRateChange(e){this.triggerVideoPlaybackRateEvent();}triggerVideoPlaybackRateEvent(){if(this.isAdvertisement)return;let e=new v("playbackRate");e.data=this.getPlaybackRate(),e.dispatch(this.context);}checkPlaybackRate(){let e;if(this.isAdvertisement)e=!0;else {let t=this.playbackRate;e=isNaN(t);}e||this.getPlaybackRate()==this.playbackRate||(this.video.playbackRate=this.playbackRate);}onAddTrack(e){let t=this.isAdvertisement?new o("addTrack"):new v("addTrack");t.data={track:e},this.dispatchEvent(t);}onVideoPause(){this.isEventFromRightContext()&&(this.stopAndroidHlsPlaybackEndWatchdogTimer(),this.lastPausedTime=new Date,this.video.currentTime>0&&this.video.currentTime==this.video.duration||(this.state=102,this.dispatchEvent(this.isAdvertisement?new o("adPaused"):new v("paused"))));}onVideoPlay(){this.isEventFromRightContext()&&(this.state=103,this.stopAndroidHlsPlaybackEndWatchdogTimer(),(!X.isiOS&&"Safari"!=X.browserName||X.isSamsungSmartTVTizen||!this.isDvr()||this.isVideoElementPlaying())&&(this.checkPlaybackRate(),this.storeStartPlayingPositionForCastingIos(),this.dispatchEvent(this.isAdvertisement?new o("adPlaying"):new v("playing"))));}onVideoPlaying(){this.isEventFromRightContext()&&(this.stopMobileOrSafariBufferingTimeoutTimer(),this.stopAndroidHlsPlaybackEndWatchdogTimer(),this.storeStartPlayingPositionForCastingIos());}storeStartPlayingPositionForCastingIos(){(X.isiOS||"Safari"==X.browserName)&&!X.isSamsungSmartTVTizen&&null!=this.video&&this.video.currentTime>0&&(this.iosLastPlayingEvent=new Date,this.iosLastPlayingEventPosition=this.video.currentTime);}shouldRestorePlaybackPositionForCastingIos(){return !!((X.isiOS||"Safari"==X.browserName)&&!X.isSamsungSmartTVTizen&&null!=this.iosLastPlayingEvent&&this.isAirPlayCasting()&&(new Date).getTime()-this.iosLastPlayingEvent.getTime()<3e3&&null!=this.iosLastPlayingEventPosition&&null!=this.video&&this.video.currentTime>=1&&this.video.duration!=1/0&&this.video.duration>=1)&&this.iosLastPlayingEventPosition-this.video.currentTime>1}restorePlayingPositionForCastingIos(){let e=this.iosLastPlayingEventPosition;this.iosLastPlayingEvent=null,this.iosLastPlayingEventPosition=null;let t=this;te.delay((function(){t.seek(e);}),100);}stopAndroidHlsPlaybackEndWatchdogTimer(){null!=this.androidHlsPlaybackEndWatchdogTimer&&(this.androidHlsPlaybackEndWatchdogTimer.stop(),this.androidHlsPlaybackEndWatchdogTimer=null);}onVideoTimeupdate(){if(!this.isEventFromRightContext())return;if(null!=this.mobileOrSafariBufferingTimeoutTimer&&null!=this.video&&this.video.readyState>=2&&(this.video.readyState>=3?this.stopMobileOrSafariBufferingTimeoutTimer():2==this.video.readyState&&this.startMobileOrSafariBufferingTimeoutTimer()),this.isDvr()&&null==this.liveEdgeUpdateTimer&&(this.liveEdgeUpdateTimer=new te(1e3),this.liveEdgeUpdateTimer.run=he(this,this.onLiveEdgeUpdate)),X.isAndroid&&this.isVideoElementPlaying()&&(this.stopAndroidHlsPlaybackEndWatchdogTimer(),this.androidHlsPlaybackEndWatchdogTimer=te.delay(he(this,this.onVideoWaiting),1e3)),null!=this.androidHlsPlaybackWatchdogTimer&&null!=this.video&&this.video.currentTime>0&&(this.androidHlsPlaybackWatchdogTimer.stop(),this.androidHlsPlaybackWatchdogTimer=null),null!=this.iosHitDecoderAfter&&null!=this.video&&this.iosHitDecoderAfter<=this.video.currentTime&&(this.iosHitDecoderAfter=null,this.video.pause(),this.video.play()),this.shouldRestorePlaybackPositionForCastingIos())return void this.restorePlayingPositionForCastingIos();this.isVideoCurrentTimeReliable()&&(this.currentTime=this.video.currentTime,0<this.dvrWindowStartTimeTs&&0<this.media.mediaPlaybackInfo.currentTime&&(X.isiOS||"Safari"==X.browserName)&&!X.isSamsungSmartTVTizen&&this.media.mediaPlaybackInfo.currentTime<this.dvrWindowStartTimeTs&&this.seek(this.currentTime+(this.dvrWindowStartTimeTs-this.media.mediaPlaybackInfo.currentTime))),this.iosIsStalledConnectionDetectionEnabled&&!this.isAirPlayCasting()&&this.iosDetectStalledConnection(),this.onErrorFallbackTriesNum>0&&this.isVideoElementPlaying()&&(this.onErrorFallbackTriesNum=0);let e=(101==this.state||15==this.state||this.isBuffering)&&this.isVideoElementPlaying();e&&(this.state=103),this.dispatchEvent(this.isAdvertisement?new o("adCurrentTimeChange"):new v("currentTimeChange")),e&&(this.isBuffering=!1,this.dispatchEvent(this.isAdvertisement?new o("adBufferingEnd"):new v("bufferingEnd")),!X.isiOS&&"Safari"!=X.browserName||X.isSamsungSmartTVTizen||!this.isVideoElementPlaying()||(this.storeStartPlayingPositionForCastingIos(),this.dispatchEvent(this.isAdvertisement?new o("adPlaying"):new v("playing")))),this.isDvr()&&null!=this.dvrWindowEndTimeTs&&this.media.mediaPlaybackInfo.currentTime>this.dvrWindowEndTimeTs&&(new h("skinPause").dispatch(this.context),this.dispatchEvent(this.isAdvertisement?new o("adComplete"):new v("complete")));}isAirPlayCasting(){return !(!X.isiOS||null==this.video)&&this.video.webkitCurrentPlaybackTargetIsWireless}iosDetectStalledConnection(){if(null==this.video||this.video.seeking||this.video.ended||this.video.paused||null==this.video.buffered||0==this.video.buffered.length)return;let e=!1,t=0,i=this.video.buffered.length;for(;t<i;){let i=t++;if(this.video.buffered.start(i)<=this.video.currentTime&&this.video.currentTime<=this.video.buffered.end(i)){e=!0;break}}if(e)this.iosIsStalledConnectionProblemsStart=null;else {null==this.iosIsStalledConnectionProblemsStart&&(this.iosIsStalledConnectionProblemsStart=new Date);let e=5e3;this.isAdsInsertionStream(this.media)&&(e=25e3),null!=this.iosIsStalledConnectionProblemsStart&&(new Date).getTime()-this.iosIsStalledConnectionProblemsStart.getTime()>e&&(null!=this.video&&this.video.pause(),this.iosIsStalledConnection=!0,this.onError({message:"Connection with server has stalled/broken. No data from server."}));}}isVideoElementPlaying(){if(null==this.video)return !1;let e=!0;if((X.isiOS||"Safari"==X.browserName)&&!X.isSamsungSmartTVTizen){let t=null!=this.video&&null!=this.video.seekable&&this.video.seekable.length>0&&this.video.seekable.end(0)-this.video.seekable.start(0)>0,i=null!=this.video&&this.video.duration==1/0&&null!=this.video.buffered&&this.video.buffered.length>0&&this.video.buffered.end(0)-this.video.buffered.start(0)>0&&this.video.buffered.end(0)-this.video.buffered.start(0)<30&&this.video.buffered.start(0)<=this.video.currentTime&&this.video.currentTime<=this.video.buffered.end(0);e=t||i;}return this.video.currentTime>0&&!this.video.paused&&!this.video.seeking&&!this.video.ended&&this.video.readyState>2&&e}isVideoCurrentTimeReliable(){return !(null==this.video||!this.isStartTimeInitialized||4!=this.video.readyState)&&(!this.isDvr()||this.video.currentTime>1)}onVideoDurationchange(){if(this.isEventFromRightContext()&&!this.isAirPlayCasting()){if(this.media instanceof y&&!(this.media instanceof b)&&this.video.duration==1/0){let e=new b;this.media.copyFieldsTo(e),this.media=e;let t=new u("mediaAfterPlaybackStartMetadata");t.data=e,t.dispatch(this.context);}if(this.media instanceof b&&this.video.duration!=1/0&&this.video.duration>0){let e=new y;this.media.copyFieldsTo(e),this.media=e;let t=new u("mediaAfterPlaybackStartMetadata");t.data=this.media,t.dispatch(this.context);}if(this.media.duration=this.video.duration,null!=this.prePlaybackSeekRelativePosition&&this.video.duration>0){let e=this.prePlaybackSeekRelativePosition;this.prePlaybackSeekRelativePosition=null;let t=e*this.video.duration,i=Math.abs(this.video.duration-this.media.duration)>2,s=Math.abs(this.video.currentTime-t)>1;(i||s)&&this.seek(t);}this.dispatchEvent(this.isAdvertisement?new o("adDurationChange"):new v("durationChange"));}}onVideoWaiting(){this.isEventFromRightContext()&&(this.state>=101&&(this.state=101),this.dispatchEvent(this.isAdvertisement?new o("adBufferingStart"):new v("bufferingStart")),this.isBuffering=!0,this.stopAndroidHlsPlaybackEndWatchdogTimer(),this.startMobileOrSafariBufferingTimeoutTimer());}onMobileOrSafariBufferingTimeout(){let e;if(this.stopMobileOrSafariBufferingTimeoutTimer(),this.isInStreamAdvertisement&&this.isDvr()){let t=this.video;e=(null!=t?t.readyState:null)<4;}else e=!1;e?this.video.currentTime+=10:(this.mobileOrSafariBufferingTimeoutOccurred=!0,this.onError("Buffering timeout occured."));}onVideoEnded(){this.isEventFromRightContext()&&(this.stopLiveStreamEndingTimeout(),this.stopAndroidHlsPlaybackEndWatchdogTimer(),200!=this.state&&0!=this.state&&(this.state=200,this.dispatchEvent(this.isAdvertisement?new o("adComplete"):new v("complete"))));}onVideoSeeking(){if(!this.isEventFromRightContext())return;this.stopAndroidHlsPlaybackEndWatchdogTimer();let e=this.state;this.state=101,this.dispatchEvent(this.isAdvertisement?new o("seekingStart"):new v("seekingStart")),!X.isiOS&&"Safari"!=X.browserName||X.isSamsungSmartTVTizen||this.isBuffering||102!=e||(this.isBuffering=!0,this.dispatchEvent(this.isAdvertisement?new o("adBufferingStart"):new v("bufferingStart")));}onVideoSeeked(){this.isEventFromRightContext()&&(this.stopAndroidHlsPlaybackEndWatchdogTimer(),this.state=102,this.dispatchEvent(this.isAdvertisement?new o("seekingEnd"):new v("seekingEnd")),!X.isiOS&&"Safari"!=X.browserName||X.isSamsungSmartTVTizen||!this.isVideoElementPlaying()||(this.storeStartPlayingPositionForCastingIos(),this.dispatchEvent(this.isAdvertisement?new o("adPlaying"):new v("playing"))),!X.isiOS&&"Safari"!=X.browserName||X.isSamsungSmartTVTizen||!this.isBuffering||(this.isBuffering=!1,this.dispatchEvent(this.isAdvertisement?new o("adBufferingEnd"):new v("bufferingEnd"))),this.refreshIosOrSafariWhenPausedAtStart());}refreshIosOrSafariWhenPausedAtStart(){let e=this,t=function(){return !(!X.isiOS&&"Safari"!=X.browserName||X.isSamsungSmartTVTizen||null==e.video||0!=e.video.currentTime)&&e.video.paused};t()&&(null!=this.refreshIosOrSafariWhenPausedAtStartTimer&&this.refreshIosOrSafariWhenPausedAtStartTimer.stop(),this.refreshIosOrSafariWhenPausedAtStartTimer=te.delay((function(){if(t()){let t=e.video.play();null!=t&&t.then((function(){e.video.pause();}));}}),500));}initDvrWindowStartTimestamp(){if(null==this.dvrPlaybackStartTs&&this.isDvr()){let e=this.getDVRWindowRangeRaw();if(null==e&&null!=this.video&&null!=this.video.buffered&&this.video.buffered.length>0&&(e={end:this.video.buffered.end(0)}),null!=e){this.dvrPlaybackStartTs=this.getNowTs()-e.end;let t=this.video;this.isSafariBrowser()&&null!=t&&t.getStartDate&&t.getStartDate()&&(this.dvrPlaybackStartTs=t.getStartDate().getTime()/1e3);}null!=this.dvrPlaybackStartTs&&null!=this.dvrRequestedInitialTimeTs&&this.seek(this.dvrRequestedInitialTimeTs-this.dvrPlaybackStartTs);}}isSafariBrowser(){return "Safari"==X.browserName&&!X.isSamsungSmartTVTizen}onVideoCanplaythrough(){this.isEventFromRightContext()&&(this.initStartTimeForLiveStreamEventRecording(),this.isPlaybackNotAllowed&&"Safari"==X.browserName&&!X.isSamsungSmartTVTizen?(this.stopInitializeAfterCanplaythrouTimer(),this.initializeAfterCanplaythrouTimer=te.delay(he(this,this.initializeAfterCanplaythrou),500)):this.initializeAfterCanplaythrou());}initStartTimeForLiveStreamEventRecording(){if((null==this.dvrPlaybackStartTs&&this.isDvr()||101==this.state)&&0==this.currentTime&&null==this.getPlaybackStartTime(this.media)&&this.isDvr()&&this.video.currentTime<.1&&this.video.seekable.length>0){let e=null,t=0,i=this.video.seekable.length;for(;t<i;){let i=this.video.seekable.end(t++);isFinite(i)&&((null==e||i>e)&&(e=i));}null!=e&&(this.video.currentTime=Math.max(0,e-15));}}isHlsSource(e){return null!=e&&("m3u8"==q.getExtension(e)||e.includes("m3u8"))}canUseHlsManifestAssets(){return !(!X.isiOS&&"Safari"!=X.browserName||X.isSamsungSmartTVTizen||!this.isHlsSource(this.mediaSourceUrl))&&n.exists(this.plugins,(function(e){return "HlsManifestAssets"==e.getPluginName()}))}getHlsManifestAssets(){if(this.canUseHlsManifestAssets()){let e=this.plugins;return n.exists(e,(function(e){return "HlsManifestAssets"==e.getPluginName()}))?n.find(e,(function(e){return "HlsManifestAssets"==e.getPluginName()})):null}return null}initializeAfterCanplaythrou(){let e=this;this.areSubtitlesAndAudioTracksInitialized||(this.areSubtitlesAndAudioTracksInitialized=!0,this.canUseHlsManifestAssets()?this.getHlsManifestAssets().fetchManifestData(this.mediaSourceUrl,(function(){e.updateMediaSets(),e.registerThumbnailProvider();})):this.updateMediaSets()),this.initVideoCurrentTime(),this.initDvrWindowStartTimestamp();}registerThumbnailProvider(){let e=this.getHlsManifestAssets();null!=e&&e.registerThumbnailProvider();}unregisterThumbnailProvider(){let e=this.getHlsManifestAssets();null!=e&&e.unregisterThumbnailProvider();}getNameTranslator(){let e=function(e){return null};if(!this.canUseHlsManifestAssets())return e;let t=this.getHlsManifestAssets();return null!=t&&t.canUseHlsLabelTranslations?he(t,t.getTranslationForLabel):e}updateMediaSets(){let e=this.getNameTranslator();this.updateAudioSets(e),this.updateSubtitlesSets(e),this.updateVideoSets(e),this.isWebSafari()&&this.updateSafariStylingForSubtitles();}onVideoLoadedMetadata(){this.isEventFromRightContext()&&(!X.isiOS&&"Safari"!=X.browserName||X.isSamsungSmartTVTizen)&&this.initVideoCurrentTime();}initVideoCurrentTime(){if(this.video.readyState>=1&&!this.isStartTimeInitialized)if(0!=this.currentTime){let e=Math.floor(1e3*this.currentTime)/1e3;this.video.currentTime=e,this.isStartTimeInitialized=this.video.currentTime==e;}else this.isStartTimeInitialized=!0;}reset(){null!=this.video&&(this.video.pause(),this.video.setAttribute("src",""),this.video.load()),this.mediaSourceUrl="",this.isStartTimeInitialized=!1,this.fairPlayDrm.reset(),this.state=0,this.currentVideoSet=null,this.currentVideoResolution=null;}pause(){this.stopAndroidHlsPlaybackEndWatchdogTimer(),this.videoElementCommandAdd(2);}startMobileOrSafariBufferingTimeoutTimer(){((X.isiOS||"Safari"==X.browserName)&&!X.isSamsungSmartTVTizen||X.isAndroid)&&(this.stopMobileOrSafariBufferingTimeoutTimer(),this.mobileOrSafariBufferingTimeoutTimer=te.delay(he(this,this.onMobileOrSafariBufferingTimeout),14e3));}stopMobileOrSafariBufferingTimeoutTimer(){null!=this.mobileOrSafariBufferingTimeoutTimer&&(this.mobileOrSafariBufferingTimeoutTimer.stop(),this.mobileOrSafariBufferingTimeoutTimer=null);}reloadPlayerSourceAndCurrentTimeIfNeeded(){return null!=this.media&&null!=this.media.source&&null!=this.video&&this.mediaSourceUrl!=this.media.source[0].url?(this.video.src=this.mediaSourceUrl=this.media.source[0].url,this.state=0,this.hasCriticalErrorBeenDispatched=!1,this.mobileOrSafariBufferingTimeoutOccurred=!1,!0):(this.video.getAttribute("src")!=this.mediaSourceUrl&&(X.isiOS&&(this.isStartTimeInitialized=!1),this.hasCriticalErrorBeenDispatched=!1,this.mobileOrSafariBufferingTimeoutOccurred=!1,this.video.src=this.mediaSourceUrl),!1)}play(){this.stopAndroidHlsPlaybackEndWatchdogTimer(),this.reloadPlayerSourceAndCurrentTimeIfNeeded(),this.videoElementCommandAdd(1);}onAndrdoidHlsPlaybackStartTimout(){null!=this.androidHlsPlaybackWatchdogTimer&&this.androidHlsPlaybackWatchdogTimer.stop(),this.androidHlsPlaybackWatchdogTimer=null,null==this.video||this.video.readyState>1||this.video.currentTime>0||(console.warn("Chrome has problem with correct playback start for HLS stream with native player on Android device. Bradmax 'fix' is now applyed."),this.video.currentTime=1);}videoElementCommandAdd(e){this.videoElementCommandsQueue.push(e),1==this.videoElementCommandsQueue.length&&null==this.videoElementPromise&&this.onVideoElementCommandComplete();}onVideoElementCommandComplete(){if(this.videoElementPromise=null,0==this.videoElementCommandsQueue.length)return;let e=this.videoElementCommandsQueue.shift();1==e?this.videoElementCommandPlay():2==e?this.videoElementCommandPause():3==e?this.videoElementCommandPlayPause():console.error("ERROR: Invalid command type for VideoWeb ("+e+")");}onPlayerResetWithMseExtension(){null!=this.video&&(this.video.removeEventListener("player_reset",he(this,this.onPlayerResetWithMseExtension)),this.videoElementCommandPlay());}videoElementCommandPlay(){if(null!=this.video&&this.video.hasAttribute("data-mse-resetting"))this.video.addEventListener("player_reset",he(this,this.onPlayerResetWithMseExtension));else {if(this.isPlaybackNotAllowed=!1,this.reloadPlayerSourceAndCurrentTimeIfNeeded(),0==this.state){let e=this.getM3U8MediaSource(this.media.source);X.isAndroid&&null!=e&&(this.androidHlsPlaybackWatchdogTimer=new te(7e3),this.androidHlsPlaybackWatchdogTimer.run=he(this,this.onAndrdoidHlsPlaybackStartTimout));let t=null!=e&&Object.prototype.hasOwnProperty.call(e.customParams.h,"laUrl")&&Object.prototype.hasOwnProperty.call(e.customParams.h,"certUrl"),i=null!=e&&null!=e.drm,s=null!=e&&null!=this.media.drmCustomLicenseServerHandler;if(s&&this.media.drmCustomLicenseServerHandler.initContext(this.media,e,this.variables),t||i||s)return this.video.load(),void this.fairPlayDrm.init(this.media,e)}if(null!=this.video&&(X.isiOS||"Safari"==X.browserName)&&!X.isSamsungSmartTVTizen&&this.video.duration==1/0){let e=this.isPositionInTimeRanges(this.video.seekable,this.video.currentTime)||this.isPositionInTimeRanges(this.video.buffered,this.video.currentTime);if(e&&1==this.video.buffered.length&&null!=this.lastPausedTime){e=((new Date).getTime()-this.lastPausedTime.getTime())/1e3<this.video.buffered.end(0)-this.video.buffered.start(0);}if(this.video.buffered.length>0&&!e)return this.dispatchEvent(new v("videoOutsideDvrWindow")),this.log("BRADMAX PLAYER NOTICE:\nVideo paused outside DVR window. Restarting video for catching-up live stream.","warn"),void this.handlePlaybackRestart()}try{this.videoElementPromise=this.videoElemPlayCallWithErrorCatch(),null!=this.videoElementPromise&&(!X.isiOS&&"Safari"!=X.browserName||X.isSamsungSmartTVTizen)?this.videoElementPromise.then(he(this,this.onVideoElementCommandComplete),he(this,this.onVideoElementCommandComplete)):this.onVideoElementCommandComplete();}catch(e){console.error("Error occured during play call on video HtmlMediaElement."),this.onVideoElementCommandComplete();}}}isPositionInTimeRanges(e,t){let i=0,s=e.length;for(;i<s;){let s=i++;if(e.start(s)<=t&&t<=e.end(s))return !0}return !1}videoElemPlayCallWithErrorCatch(){let e=null;return e=this.video.play(),null!=e&&e.catch(he(this,this.onPlayPromiseError)),e}log(e,t){null==t&&(t="log"),console&&("error"==t?console.error(e):"warn"==t?console.warn(e):console.log(e));}onPlayPromiseError(e){if(null!=e&&"AbortError"==e.name&&null!=this.video&&null!=this.video.src&&-1!=this.video.src.indexOf("data:video/mp4;base64,"))return;if(this.onErrorFallbackTriesNum>0&&this.isSafariBrowser())return;let t=this;null==e||"NotAllowedError"!=e.name&&"AbortError"!=e.name||X.isSamsungSmartTVTizen?(this.log("BRADMAX PLAYER NOTICE:\nException occured durring starting player. Details below:\n","error"),this.log(e,"error")):(this.isPlaybackNotAllowed=!0,this.videoElementPromise=null,this.variables.autoplay&&"NotAllowedError"==e.name?this.log("BRADMAX PLAYER NOTICE:\nBrowser doesn't allow for autoplaying video without user interaction.\nPlayer is waiting for user 'play' click. You can autoplay muted video (mute=true).\n\nMode details about browser autoplay policy: https://developers.google.com/web/updates/2017/09/autoplay-policy-changes","warn"):(this.log("BRADMAX PLAYER NOTICE:\nBrowser block starting playing video. Details below:\n","warn"),this.log(e,"warn")),te.delay((function(){t.isBuffering=!1,t.dispatchEvent(t.isAdvertisement?new o("adBufferingEnd"):new v("bufferingEnd")),t.dispatchEvent(t.isAdvertisement?new o("adPlaying"):new v("playing")),t.dispatchEvent(t.isAdvertisement?new o("adPaused"):new v("paused")),t.onVideoTimeupdate();}),0));}videoElementCommandPause(){null!=this.video&&this.video.pause(),this.onVideoElementCommandComplete();}videoElementCommandPlayPause(){null!=this.video&&(this.video.paused?this.videoElementCommandPlay():this.videoElementCommandPause());}stopPlaybackRestartTimeoutTimer(){null!=this.playbackRestartTimeoutTimer&&(this.playbackRestartTimeoutTimer.stop(),this.playbackRestartTimeoutTimer=null);}stopSafariErrorTimeoutTimer(){null!=this.safariErrorTimoutTimer&&(this.safariErrorTimoutTimer.stop(),this.safariErrorTimoutTimer=null);}stopInitializeAfterCanplaythrouTimer(){null!=this.initializeAfterCanplaythrouTimer&&(this.initializeAfterCanplaythrouTimer.stop(),this.initializeAfterCanplaythrouTimer=null);}stopLiveEdgeUpdateTimer(){null!=this.liveEdgeUpdateTimer&&(this.liveEdgeUpdateTimer.stop(),this.liveEdgeUpdateTimer=null);}onLiveEdgeUpdate(){null!=this.video&&this.video.paused&&!this.video.seeking&&!this.video.ended&&this.video.readyState>2&&this.onVideoTimeupdate();}hasLiveStreamEnded(){if(!(this.media instanceof S))return !1;let e=this.media;return null==e.streamEnd||e.streamEnd.getTime()<(new Date).getTime()}hasVideoErrorCode(){return null!=this.video&&null!=this.video.error&&this.video.error.code>=0}onErrorWebSafari(e){let t=this.video.currentTime,i=null!=this.video&&null!=this.video.error&&3==this.video.error.code,s=this;i?(this.stopSafariErrorTimeoutTimer(),this.safariErrorTimoutTimer=te.delay((function(){null==s.video||t==s.video.currentTime||!X.isMobile()&&!X.isSmartTV()&&X.majorVersion<17?s.onError(e):console.warn("Warning: Supressing false MEDIA_ERR_DECODE from native iOS player. Playback seems to be possible.");}),2e3)):this.onError(e);}onError(e){if(this.isAdvertisement&&!this.isInStreamAdvertisement)return void this.dispatchEvent(new o("adMediaError"),this.prepareErrorMessage(e));if(this.hasCriticalErrorBeenDispatched)return;if(!this.isEventFromRightContext()||10==this.state&&!this.hasVideoErrorCode()||150==this.state)return;if(this.stopPlaybackRestartTimeoutTimer(),this.stopAndroidHlsPlaybackEndWatchdogTimer(),this.stopSafariErrorTimeoutTimer(),this.state>=200)return;if(this.media instanceof S){let e,t=this.hasLiveStreamEnded();if(t)e=!1;else {let t=this.media;e=this.onErrorFallbackTriesNum>=(null!=t?t.getLimitOfRestartsOnError():null);}if(e&&(this.onErrorFallbackTriesNum-=1),t)return void this.handleLiveStreamEnding()}let t,i=X.isAndroid&&!this.isNetworkConnectionProblem(),s=this.isQuickFallbackPathForLiveEnabled&&this.isDvr()&&this.media.hasFallbackSources(),n=this.isDvr()&&102==this.state;if(103==this.state||101==this.state||n){let e=this.media;t=this.onErrorFallbackTriesNum<(null!=e?e.getLimitOfRestartsOnError():null);}else t=!1;if(t&&!i&&!s){this.stopPlaybackRestartTimeoutTimer(),this.state=150,this.playbackRestartTimeoutTimer=te.delay(he(this,this.handlePlaybackRestart),1e3*(this.onErrorFallbackTriesNum+1));let t={videowebError:e,currTry:this.onErrorFallbackTriesNum};return void this.dispatchEvent(this.isAdvertisement&&!this.isInStreamAdvertisement?new o("adMediaErrorFallbackTry"):new v("mediaErrorFallbackTry"),t)}let a=this.state;if(this.state=210,this.stopMobileOrSafariBufferingTimeoutTimer(),this.isNetworkConnectionProblem())this.dispatchEvent(this.isAdvertisement&&!this.isInStreamAdvertisement?new o("adConnectionError"):new v("connectionError"),this.prepareErrorMessage(e));else if(!this.hasVideoErrorCode()&&(10<=a&&a<=15||20==a))this.hasCriticalErrorBeenDispatched=!0,this.dispatchEvent(new v("drmAuthenticationError"),this.prepareErrorMessage(e)),this.reset();else {let t=this.video;3==(null!=t?t.networkState:null)?(this.hasCriticalErrorBeenDispatched=!0,this.dispatchEvent(this.isAdvertisement&&!this.isInStreamAdvertisement?new o("adMediaError"):new v("loadError"),this.prepareErrorMessage(e)),this.reset()):(this.hasCriticalErrorBeenDispatched=!0,this.dispatchEvent(this.isAdvertisement&&!this.isInStreamAdvertisement?new o("adMediaError"):new v("mediaError"),this.prepareErrorMessage(e)),this.reset());}}onIosStalled(e){this.iosIsStalledConnectionDetectionEnabled=!0;}prepareErrorMessage(e){let t=this.isNetworkConnectionProblem()&&(this.media instanceof S||this.video.currentTime>0||null!=this.video.error&&2==this.video.error.code||null!=this.media.mediaUserSettings&&this.media.mediaUserSettings.resumePostion>0),i="";if(null!=this.video&&null!=this.video.error&&(i=" code: ",i=1==this.video.error.code?" code: MEDIA_ERR_ABORTED":2==this.video.error.code?" code: MEDIA_ERR_NETWORK":3==this.video.error.code?" code: MEDIA_ERR_DECODE":4==this.video.error.code?" code: MEDIA_ERR_SRC_NOT_SUPPORTED":" code: "+this.video.error.code),null!=this.video&&null!=this.video.networkState)switch(i+=" net: ",this.video.networkState){case 0:i+="NETWORK_EMPTY";break;case 1:i+="NETWORK_IDLE";break;case 2:i+="NETWORK_LOADING";break;case 3:i+="NETWORK_NO_SOURCE";break;default:i+=this.video.networkState;}return null!=this.video&&null!=this.video.src&&(i+="\nurl: "+this.video.src),null!=e&&(this.log("bradmax.player.error: Error occured durring playback. "+i,"error"),this.log(e,"error")),{errObj:e,isTemporaryNetworkIssue:t,message:i}}stopLiveStreamEndingTimeout(){null!=this.liveStreamEndingTimeout&&(this.liveStreamEndingTimeout.stop(),this.liveStreamEndingTimeout=null);}handleLiveStreamEnding(){new h("skinPause").dispatch(this.context),this.state=180,this.stopLiveStreamEndingTimeout(),this.stopAndroidHlsPlaybackEndWatchdogTimer(),this.liveStreamEndingTimeout=te.delay(he(this,this.onVideoEnded),500);}isNetworkConnectionProblem(){if(null==this.video||null==this.media)return !1;let e;if(t.navigator.onLine&&!this.mobileOrSafariBufferingTimeoutOccurred){let t=this.video,i=null!=t?t.error:null;e=2==(null!=i?i.code:null);}else e=!0;return !(!e&&!this.iosIsStalledConnection)||3==this.video.networkState&&(null!=this.video.error&&4!=this.video.error.code)}handlePlaybackRestart(){this.onErrorFallbackTriesNum++;let e=this.currentTime;this.video.pause(),this.video.setAttribute("src",""),this.video.load(),this.mediaSourceUrl="",this.isStartTimeInitialized=!1,this.isDvr()||this.seek(e),this.fairPlayDrm.reset(),this.state=0,this.play();}playPause(){this.videoElementCommandAdd(3);}seek(e){this.video.duration>0&&e+1>=this.video.duration&&(e=this.video.duration-1);let t,i=this.video.paused&&(null==this.video.getAttribute("src")||""==this.video.getAttribute("src"))&&null!=this.media&&this.media.duration>0;if(i&&(this.prePlaybackSeekRelativePosition=e/this.media.duration),this.isDvr()&&(e=this.dvrWindowTimeToDvrRelativePlaybackTime(e)),this.currentTime=e,this.reloadPlayerSourceAndCurrentTimeIfNeeded(),this.stopAndroidHlsPlaybackEndWatchdogTimer(),!i&&this.video.readyState>=1&&this.currentTime>=0){let e=this.currentTime;t=isFinite(e);}else t=!1;t&&(this.video.currentTime=this.currentTime),i&&this.video.load(),!this.video.paused||"Microsoft Internet Explorer"!=X.browserName&&"Edge"!=X.browserName||this.preloadPausedVideoAfterSeek();}preloadPausedVideoAfterSeek(){let e=this;try{let t=this.video.play();null!=t?t.then((function(){e.video.pause();})):this.video.pause();}catch(e){console.error("Error occured during seeking in VideoWeb component, when video was played.");}}selectAudio(e){}selectSubtitles(e){}volume(e){this.video.volume=e;}isEventFromRightContext(){return null!=this.video&&null!=this.media&&null!=this.media.source&&this.video.getAttribute("src")==this.media.source[0].url}setData(e){this.media=e,this.areSubtitlesAndAudioTracksInitialized=!1,this.isStartTimeInitialized=!1,this.onErrorFallbackTriesNum=0,this.iosIsStalledConnection=!1,this.iosIsStalledConnectionDetectionEnabled=!1,this.isPlaybackNotAllowed=!1,this.hasCriticalErrorBeenDispatched=!1,this.mobileOrSafariBufferingTimeoutOccurred=!1,this.stopAndroidHlsPlaybackEndWatchdogTimer(),this.stopInitializeAfterCanplaythrouTimer(),this.mediaSourceUrl=e.source[0].url,this.unregisterThumbnailProvider(),null!=this.video&&null!=this.video.src&&this.video.duration>0&&(this.pause(),null!=this.video.seekable&&this.video.seekable.length>0&&(this.video.currentTime=this.video.seekable.start(0))),Object.prototype.hasOwnProperty.call(this.variables,"dvrWindowStartTime")?(this.dvrWindowStartTimeTs=a.field(this.variables,"dvrWindowStartTime"),this.getNowTs()<this.dvrWindowStartTimeTs&&(console.warn("Warning: dvrWindowStartTime player setting was ignored, because it is starting in the future."),this.dvrWindowStartTimeTs=null),a.deleteField(this.variables,"dvrWindowStartTime")):this.dvrWindowStartTimeTs=null,Object.prototype.hasOwnProperty.call(this.variables,"dvrWindowEndTime")?(this.dvrWindowEndTimeTs=a.field(this.variables,"dvrWindowEndTime"),a.deleteField(this.variables,"dvrWindowEndTime")):this.dvrWindowEndTimeTs=null,this.dvrPlaybackStartTs=null,this.dvrRequestedInitialTimeTs=null,this.dvrWindowTailLastSend=null,this.currentTime=0,this.prePlaybackSeekRelativePosition=null;let t=this.getPlaybackStartTime(e);null!=t&&t>0&&(this.video.currentTime=this.currentTime=t),this.state=0,1==this.variables.autoplay&&this.play();}getPlaybackStartTime(e){let t=null;return null!=this.dvrWindowStartTimeTs&&null!=this.dvrWindowEndTimeTs&&this.dvrWindowEndTimeTs<this.getNowTs()&&this.isDvr()&&(t=this.dvrWindowStartTimeTs,this.dvrRequestedInitialTimeTs=this.dvrWindowStartTimeTs),null!=e&&null!=e.mediaUserSettings&&null!=e.mediaUserSettings.resumePostion&&(t=e.mediaUserSettings.resumePostion),null==t&&null!=this.dvrWindowStartTimeTs&&t<this.dvrWindowStartTimeTs&&(t=this.dvrWindowStartTimeTs),null==t&&null!=this.dvrWindowEndTimeTs&&this.dvrWindowEndTimeTs<t&&(t=this.dvrWindowEndTimeTs),this.isDvr()&&null!=t&&(this.dvrRequestedInitialTimeTs=t),t}playerResize(e){}videoReady(){}onDurationChange(e){}hasTextTrackToSelect(){let e=this.video,t=null!=e?e.textTracks:null;return null!=t&&t.length>0}updateSubtitlesSets(e){if(!this.hasTextTrackToSelect())return;let t=this.video,i=null!=t?t.textTracks:null;if(null==i||0==i.length)return;let s=this.mediaTrackParsers.html.textTracksToSubtitlesSets(i,e);if(0==s.length)return;let n=this.context,a=new u("subtitleData");a.data=s,a.dispatch(n);}canSelectActiveTextTrack(){let e=this.video,t=null!=e?e.textTracks:null;if(null==t||0==t.length)return !1;let i=0,s=t.length;for(;i<s;){let e=i++,s=t[e];if("showing"!=s.mode&&this.mediaTrackParsers.html.getSetId(s.language,e)==this.activeTextTrackId)return !0}return !1}onChangeTextTrack(e){if(null==this.activeTextTrackId||!this.canSelectActiveTextTrack())return;e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation();let t=new h("selectSubtitles");t.data=new T,t.data.id=this.activeTextTrackId,t.dispatch(this.context);}onSelectSubtitles(e){if(null==e||null==this.video)return;let t=e.data;this.activeTextTrackId=null;let i=this.video.textTracks;if(null!=t){let e=null,s=null,n=0,a=i.length;for(;n<a;){let a=n++,r=i[a],l=this.mediaTrackParsers.html.getSetId(r.language,a);r.mode="hidden",l==t.id&&(s=l,e=r);}null!=e&&(e.mode="showing",this.activeTextTrackId=s);}else {let e=0;for(;e<i.length;)i[e++].mode="hidden";}}hasAudioTrackToSelect(){let e=this.video,t=null!=e?e.audioTracks:null;return (null!=t?t.length:null)>=this.minAudioTracksForInfo}updateAudioSets(e){if(!this.hasAudioTrackToSelect())return;let t=this.video,i=null!=t?t.audioTracks:null;if(null==i||0==i.length)return;let s=this.mediaTrackParsers.html.audioTracksToAudioSets(i,e);if(0==s.length)return;let n=this.context,a=new u("audioData");a.data=s,a.dispatch(n);}onSelectAudio(e){if(null==e||null==this.video)return;let t=e.data;if(null==t)return;if(this.getActiveAudioTrackId()==t.id)return;let i=!this.video.paused;i&&this.video.pause();let s=this;te.delay((function(){let e=s.video.audioTracks;if(null!=e&&null!=t){let i=0,n=e.length;for(;i<n;){let n=i++,a=e[n];a.enabled=s.mediaTrackParsers.html.getSetId(a.language,n)==t.id;}}i&&s.video.play();}),100);}getActiveAudioTrackId(){let e=this.video,t=null!=e?e.audioTracks:null;if(null==t||t.length<=1)return null;let i=0,s=t.length;for(;i<s;){let e=i++,s=t[e];if(s.enabled)return this.mediaTrackParsers.html.getSetId(s.language,e)}return null}updateVideoSets(e){if(!this.hasVideoTrackToSelect())return;let t=this.video,i=null!=t?t.videoTracks:null;if(null==i||i.length<=1)return;let s=this.mediaTrackParsers.html.videoTracksToVideoSets(i,e);if(s.length<=1)return;let n=this.context,a=new u("videoTrackData");a.data=s,a.dispatch(n);}onSelectVideoTrack(e){null!=(null!=e?e.data:null)&&this.hasVideoTrackToSelect()&&(this.currentVideoSet=e.data,this.updateVideoTrackSelection());}updateVideoTrackSelection(){this.updateCurrentVideoResolution();let e=this.findVideoTracksToSelect();if(null==e)return;let t=0,i=this.video.videoTracks;for(;t<i.length;){let s=i[t];++t,s.selected=s.id==e.id;}this.updateVideoResolutionWatchdogTimer();}hasVideoTrackToSelect(){let e=this.video,t=null!=e?e.videoTracks:null;return (null!=t?t.length:null)>1}findVideoTracksToSelect(){if(null==this.currentVideoSet||!this.hasVideoTrackToSelect())return null;let e,t=this.video,i=null!=t?t.videoTracks:null;if(null==i||0==i.length)return null;let s=0,n=i.length;for(;s<n;)if(e=i[s++],this.isVideoTrackMatchingCurrentVideoSet(e)&&this.isVideoTrackMatchingCurrentResolution(e))return e;return null}isVideoTrackMatchingCurrentVideoSet(e){return e.language==this.currentVideoSet.languageCode&&this.mediaTrackParsers.html.getVideoSetKind(e)==this.currentVideoSet.kind}isVideoTrackMatchingCurrentResolution(e){let t=null!=e?e.label:null;return 0!=(null!=t?t.length:null)&&0!=this.VIDEO_TRACK_RESOLUTION_EREG.match(e.label)&&this.VIDEO_TRACK_RESOLUTION_EREG.matched(0)==this.currentVideoResolution}updateVideoResolutionWatchdogTimer(){let e=this.currentVideoSet,t=null!=e?e.kind:null;null==t?this.stopVideoResolutionWatchdogTimer():"SIGN_LANGUAGE"==t?this.startVideoResolutionWatchdogTimer():this.stopVideoResolutionWatchdogTimer();}startVideoResolutionWatchdogTimer(){this.stopVideoResolutionWatchdogTimer(),this.videoResolutionWatchdogTimer=new te(1e3),this.videoResolutionWatchdogTimer.run=he(this,this.updateCurrentVideoResolution);}updateCurrentVideoResolution(){if(null==this.video)return;let e=this.video.videoWidth+"x"+this.video.videoHeight;this.currentVideoResolution!=e&&(this.currentVideoResolution=e,this.updateVideoTrackSelection());}stopVideoResolutionWatchdogTimer(){null!=this.videoResolutionWatchdogTimer&&(this.videoResolutionWatchdogTimer.stop(),this.videoResolutionWatchdogTimer=null);}onPlayerResizeEvent(e){"Safari"!=X.browserName||X.isSamsungSmartTVTizen||this.updateSafariStylingForSubtitles();}onWindowResize(){"Safari"!=X.browserName||X.isSamsungSmartTVTizen||(this.updateSafariStylingForSubtitles(),te.delay(he(this,this.updateSafariStylingForSubtitles),300));}updateSafariStylingForSubtitles(){if(null==this.video)return;if(!q.subtitlesStylesForSafariInitialized){let e="",t=0;for(;t<100;){let i=t++;e+="video.bs-subs-top"+i+"::-webkit-media-text-track-container {top:"+i+"%;overflow:visible;} ",e+="video.bs-subs-height"+i+"::-webkit-media-text-track-container {height:"+i+"%;} ";}let i=10;for(;i<80;){let t=i++;e+="video.bs-subs-fontsize"+t+"::cue {font-size:"+t+"px;} ";}let s=document.createElement("style");s.setAttribute("type","text/css"),s.innerHTML=e,document.body.appendChild(s),q.subtitlesStylesForSafariInitialized=!0;}let e=this.video.clientWidth,t=this.video.clientHeight,i=this.video.videoWidth,s=this.video.videoHeight;if(i>0&&s>0&&e>0&&t>0){let n=this.getVideoVisibleVideoSize(e,t,i,s),a=[],r=0,l=this.video.classList;for(;r<l.length;){let e=l[r];++r,null!=e&&0!=e.indexOf("bs-subs-")&&a.push(e);}let o=a.join(" ")+" ";t>e&&n.y>0&&(n=this.adjustSubtitlesPlaceholderForMobiles(e,t,n),o+="bs-subs-top"+Math.floor(100*n.y/t)+" bs-subs-height"+Math.floor(100*n.h/t)+" bs-subs-fontsize"+Math.ceil(.05*Math.min(n.w,n.h))),e>t&&X.isiPhone&&(o+=" bs-subs-height"+(100-Math.ceil(3e3/t))+" "),this.video.setAttribute("class",o);}}getVideoVisibleVideoSize(e,t,i,s){let n=i/s,a=0,r=0;e/t>i/s?(r=t,a=t/s*i):(a=e,r=e/i*s);let l=0,o=0,d=0,h=0;return a/r>n?(h=r,d=r*n):(d=a,h=a/n),l=(e-d)/2,o=(t-h)/2,{x:l,y:o,w:d,h}}adjustSubtitlesPlaceholderForMobiles(e,t,i){return t>e&&i.y>0?{x:i.x,y:Math.floor(i.y/2),w:i.w,h:i.h+i.y}:i}getM3U8MediaSource(e){let t=0;for(;t<e.length;){let i=e[t];if(++t,"m3u8"==q.getExtension(i.url))return i}return null}isAdsInsertionStream(e){return null!=e.source&&e.source.length>0&&null!=e.source[0]&&1==e.source[0].customParams.h.yospaceStream}saveBandwidthModeVisibilityChange(e){}static canPlay(e){if(null==e.url)return !1;let t=q.getExtension(e.url);if("com/videoplayback"==t&&null!=e.url&&-1!=e.url.indexOf("googlevideo.com/videoplayback")&&-1!=e.url.indexOf("mime=video/mp4")&&(t="mp4"),X.isAndroid&&"m3u8"==t)return !1;if(!Object.prototype.hasOwnProperty.call(q.canPlayFileExtensionCache.h,t)){let e=q.canPlayFileExtensionCache,i=q.checkIfCanPlayFileType(t);e.h[t]=i;}return q.canPlayFileExtensionCache.h[t]}static getExtension(e){let t=e.split("?")[0];if(t=s.substr(t,t.lastIndexOf(".")+1,null).toLowerCase(),-1!=e.indexOf(";jsessionid=")){let i=e.split(";jsessionid=")[0];t=s.substr(i,i.lastIndexOf(".")+1,null).toLowerCase();}return t}static checkIfCanPlayFileType(e){let t="";return t="m3u8"==e?"application/vnd.apple.mpegurl":"video/"+e,""!=window.document.createElement("video").canPlayType(t)}static getInstance(e,t){let i=t?"ad_":"";if(Object.prototype.hasOwnProperty.call(q.instances.h,i+e))return q.instances.h[i+e];{let s=new q(t);return q.instances.h[i+e]=s,s.context=e,s.create(),s}}}q.__name__="bs.player.plugin.video.videoPlayer.VideoWeb",Object.assign(q.prototype,{__class__:q});class G{constructor(e){this.videoWeb=e,this.initialized=!1,this.initKeySessionData=null,this.keySessions=[];}reset(){this.clearStepTimeoutTimer();let e=0,t=this.keySessions;for(;e<t.length;){let i=t[e];++e,i.removeEventListener("webkitkeymessage",he(this,this.onLicenseWaiting),!1),i.removeEventListener("webkitkeyadded",he(this,this.onKeyAdded),!1),i.removeEventListener("webkitkeyerror",he(ae=this.videoWeb,ae.onError),!1),null!=i.close&&i.close();}this.initialized=!1,this.laUrl=null,this.certUrl=null,this.certificate=null,this.keySystem=null,this.keySessions=[],this.stepTimeoutTimer=null,this.initKeySessionData=null;}setStepTimeoutTimer(){this.clearStepTimeoutTimer(),this.stepTimeoutTimer=te.delay(he(this,this.onStepTimeout),3e4);}clearStepTimeoutTimer(){null!=this.stepTimeoutTimer&&(this.stepTimeoutTimer.stop(),this.stepTimeoutTimer=null);}init(e,t){if("Safari"!=X.browserName)return void this.videoWeb.onError("FairPlay DRM is not supported by this browser.");this.videoWeb.state=10,this.currMedia=e,this.setStepTimeoutTimer();let i=null;try{i=t.drm.provider;}catch(e){}this.drmProvider=null!=i?i.toLowerCase():null;try{this.certUrl=t.customParams.h.certUrl,this.laUrl=t.customParams.h.laUrl;}catch(e){}try{null==this.certUrl&&(this.certUrl=t.drm.fairplay.certUrl,this.laUrl=t.drm.fairplay.laUrl);}catch(e){}try{this.drmCustomData=t.drm.fairplay.customData;}catch(e){}if("ezdrm"==i){let e=new XMLHttpRequest;e.responseType="arraybuffer",e.addEventListener("load",he(this,this.onCertificateResponseRawBytes),!1),e.addEventListener("error",he(this,this.onServerCertificateDownloadError),!1),e.open("GET",this.certUrl,!0),e.send();}else if("keyos"==i){let e=new XMLHttpRequest;e.responseType="arraybuffer",e.addEventListener("load",he(this,this.onCertificateResponseRawBytes),!1),e.addEventListener("error",he(this,this.onServerCertificateDownloadError),!1),e.open("GET",this.certUrl,!0),e.send();}else if("default"==i){let e=new XMLHttpRequest;e.responseType="arraybuffer",e.addEventListener("load",he(this,this.onCertificateResponseRawBytes),!1),e.addEventListener("error",he(this,this.onServerCertificateDownloadError),!1),e.open("GET",this.certUrl,!0),e.send();}else if(null==e.drmCustomLicenseServerHandler){let e=new le(this.certUrl);e.setHeader("Accept","application/json"),e.onData=he(this,this.onCertificateResponse),e.onError=he(this,this.onServerCertificateDownloadError),e.request(!0);}else e.drmCustomLicenseServerHandler.customFairplayCertificateRequestHandler(he(this,this.onCertificateResponse),he(this,this.onServerCertificateDownloadError));}onServerCertificateDownloadError(e){this.videoWeb.state=11,this.videoWeb.onError("DRM initialization error. Error occurred during DRM server certificate download.");}onCertificateResponseRawBytes(e){this.videoWeb.state=11,this.setStepTimeoutTimer(),this.certificate=new Uint8Array(e.target.response),this.videoWeb.videoElemPlayCallWithErrorCatch();}onCertificateResponse(e){this.videoWeb.state=11,this.setStepTimeoutTimer();let t=JSON.parse(e);if(!Object.prototype.hasOwnProperty.call(t,"certificate"))throw new Error("Cannot initialize DRM module.");if(this.certificate=this.base64DecodeUint8Array(t.certificate),this.videoWeb.videoElemPlayCallWithErrorCatch(),null!=this.initKeySessionData){let e=this.initKeySessionData;this.initKeySessionData=null,this.initKeySession(e);}}onNeedKey(e){"Safari"==X.browserName?null!=this.certificate?this.initKeySession(e.initData):this.initKeySessionData=e.initData:this.videoWeb.onError("FairPlay DRM is not supported by this browser.");}initKeySession(e){this.videoWeb.state<12&&(this.setStepTimeoutTimer(),this.videoWeb.state=12);let t=this.extractContentId(e,!0),i=this.concatInitDataIdAndCertificate(e,t,this.certificate);this.videoWeb.video.webkitKeys||null!=this.keySystem||(this.keySystem=this.selectKeySystem(),this.videoWeb.video.webkitSetMediaKeys(new window.WebKitMediaKeys(this.keySystem))),this.videoWeb.video.webkitKeys||this.videoWeb.onError("DRM initialization error. Could not create MediaKeys.");let s=this.videoWeb.video.webkitKeys.createSession("video/mp4",i);null==s&&this.videoWeb.onError("DRM initialization error. Could not create key session"),s.contentId=t,s.keyPath=this.extractContentId(e,!1),s.addEventListener("webkitkeymessage",he(this,this.onLicenseWaiting),!1),s.addEventListener("webkitkeyadded",he(this,this.onKeyAdded),!1),s.addEventListener("webkitkeyerror",he(ae=this.videoWeb,ae.onError),!1),this.keySessions.push(s);}extractContentId(e,t){null==t&&(t=!0);let s=this.arrayToString(e),n=null;if("ezdrm"==this.drmProvider){let e=document.createElement("a");e.href=s,n=e.hostname;}else {if(-1==s.indexOf("skd://"))throw new Error("DRM Initialization error. Cannot prepare content identifier from initData.");if(n=s.split("skd://")[1],t){let e=new i("\\?.*?key[^=]*=([a-fA-F0-9]+)","");e.match(n)&&(n=e.matched(1)),n=n.split("?")[0];}}return n}concatInitDataIdAndCertificate(e,t,i){"string"==typeof t&&(t=this.stringToArray(t));let s=0,n=new ArrayBuffer(e.byteLength+4+t.byteLength+4+i.byteLength),a=new DataView(n);new Uint8Array(n,0,e.byteLength).set(e),s=0+e.byteLength,a.setUint32(s,t.byteLength,!0),s+=4;let r=new Uint16Array(n,s,t.length);return r.set(t),s+=r.byteLength,a.setUint32(s,i.byteLength,!0),s+=4,new Uint8Array(n,s,i.byteLength).set(i),new Uint8Array(n,0,n.byteLength)}selectKeySystem(){if(window.WebKitMediaKeys.isTypeSupported("com.apple.fps.1_0","video/mp4"))return "com.apple.fps.1_0";throw new Error("Key System not supported")}onLicenseWaiting(e){this.videoWeb.state<13&&(this.videoWeb.state=13,this.setStepTimeoutTimer());let t=e.target,i=e.message;if("ezdrm"==this.drmProvider){let e=new XMLHttpRequest;e.responseType="arraybuffer";let s=this,n=t;e.addEventListener("load",(function(e){s.onLicenseLoadedRawBytes(n,e);}),!1),e.addEventListener("error",he(ae=this.videoWeb,ae.onError),!1),e.open("POST",this.laUrl,!0),e.setRequestHeader("Content-type","application/octet-stream"),e.send(i);}else if("keyos"==this.drmProvider){let e=new le(this.laUrl);e.setHeader("customdata",this.drmCustomData);let s=this,n=t;e.onData=function(e){s.onLicenseLoadedBase64(n,e);},e.onError=he(ae=this.videoWeb,ae.onError);let a="";a+="spc="+this.base64EncodeUint8Array(i);let r=t.contentId;a+="&assetId="+encodeURIComponent(r),e.setPostData(a),e.request(!0);}else if("default"==this.drmProvider){let e=new le(this.laUrl);e.setHeader("customdata",this.drmCustomData);let s=this,n=t;e.onData=function(e){s.onLicenseLoadedBase64(n,e);},e.onError=he(ae=this.videoWeb,ae.onError);let a="";a+="spc="+this.base64EncodeUint8Array(i);let r=t.contentId;a+="&assetId="+encodeURIComponent(r),e.setPostData(a),e.request(!0);}else if(null==this.currMedia.drmCustomLicenseServerHandler){let e=this.base64EncodeUint8Array(i),s=new le(this.laUrl);s.setHeader("Accept","application/json"),s.setHeader("Content-Type","application/json");let n=this,a=t;s.onData=function(e){n.onLicenseLoaded(a,e);},s.onError=he(ae=this.videoWeb,ae.onError),s.setPostData(JSON.stringify({spc:e})),s.request(!0);}else {let e=this,s=t,n=function(t){e.onCustomLicenseLoaderSuccess(s,t);};this.currMedia.drmCustomLicenseServerHandler.customFairplayLicenseRequestHandler(i,n,he(ae=this.videoWeb,ae.onError),t);}}onLicenseLoadedRawBytes(e,t){this.videoWeb.state<14&&(this.videoWeb.state=14,this.setStepTimeoutTimer()),e.update(new Uint8Array(t.target.response));}onLicenseLoadedBase64(e,t){this.videoWeb.state<14&&(this.videoWeb.state=14,this.setStepTimeoutTimer()),e.update(this.base64DecodeUint8Array(t));}onLicenseLoaded(e,t){this.videoWeb.state<14&&(this.videoWeb.state=14,this.setStepTimeoutTimer());let i=this.base64DecodeUint8Array(JSON.parse(t).licence);e.update(i);}onCustomLicenseLoaderSuccess(e,t){this.videoWeb.state<14&&(this.videoWeb.state=14,this.setStepTimeoutTimer()),e.update(new Uint8Array(t));}onKeyAdded(e){this.clearStepTimeoutTimer(),this.videoWeb.state=15;}onStepTimeout(){null!=this.videoWeb.video&&this.videoWeb.video.currentTime>0||(this.videoWeb.state=20,this.videoWeb.onError("DRM initialization error. Internal error - DRM initialisation timeout."));}stringToArray(e){let t=new Uint16Array(new ArrayBuffer(2*e.length)),i=0,n=e.length;for(;i<n;){let n=i++;t[n]=s.cca(e,n);}return t}arrayToString(e){let t=new Uint16Array(e.buffer),i="",s=0,n=t.length;for(;s<n;){let e=s++;i+=String.fromCodePoint(t[e]);}return i}base64DecodeUint8Array(e){let t=window.atob(e),i=t.length,n=new Uint8Array(new ArrayBuffer(i)),a=0;for(;a<i;){let e=a++;n[e]=s.cca(t,e);}return n}base64EncodeUint8Array(e){let t,i,s,n,a,r,l,o="",d=0;for(;d<e.length;)t=e[d++],i=d<e.length?e[d++]:null,s=d<e.length?e[d++]:null,n=t>>2,a=(3&t)<<4|i>>4,r=(15&i)<<2|s>>6,l=63&s,null==i?(l=64,r=64):null==s&&(l=64),o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(n)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(r)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l);return o}}G.__name__="bs.player.plugin.video.videoPlayer.VideoWebHelperForFairPlayDrm",Object.assign(G.prototype,{__class__:G});var Q=require("bs.ui.Ui"),X=require("bs.util.BrowserTools");class Y{static volume(e){if(Y.mute(e))return 0;let t=!1,i=null;if(i=de.getSessionStorage(),t=null!=i,t){let e,t=NaN,i=!1,s=null;if(s=de.getSessionStorage(),i=null!=s,i){try{let e,i=null,s=!1,n=null;if(n=de.getSessionStorage(),s=null!=n,s){let t=null;t=de.getSessionStorage(),i=t.getItem("_brplayer_vol"),null==i||(i=l.trim(i)),e=i;}else e=i;null!=e&&""!=e&&(t=parseFloat(e));}catch(e){console.warn("Error occured durring loading volume settings from session storage.");}e=t;}else e=t;if(null!=e&&!isNaN(e)&&isFinite(e))return e}let s=null;Object.prototype.hasOwnProperty.call(e,"volume")&&(s=parseFloat(a.field(e,"volume")),isNaN(s)&&(s=null));let n=s;return null!=n&&!isNaN(n)&&isFinite(n)?n:1}static mute(e){let t,i=!1,s=null;if(s=de.getSessionStorage(),i=null!=s,i){let e=!1,i=!1,s=null;if(s=de.getSessionStorage(),i=null!=s,i){try{let t,i=null,s=!1,n=null;if(n=de.getSessionStorage(),s=null!=n,s){let e=null;e=de.getSessionStorage(),i=e.getItem("_brplayer_muted"),null==i||(i=l.trim(i)),t=i;}else t=i;null!=t&&""!=t&&(e=null!=t&&"1"==t);}catch(e){console.warn("Error occured durring loading volume settings from session storage.");}t=e;}else t=!1;}else t=!1;if(t)return !0;if(!Object.prototype.hasOwnProperty.call(e,"mute"))return !1;switch(a.field(e,"mute")){case 1:case"true":case!0:return !0;default:return !1}}}Y.__name__="bs.util.PlayerVariableParser";var J=require("bs.util.TextTools");class Z{static getTypeMap(){return null==Z.typeMap&&(Z.typeMap=new re,Z.typeMap.h.webm="file",Z.typeMap.h.mpg="file",Z.typeMap.h.mp2="file",Z.typeMap.h.mpeg="file",Z.typeMap.h.mpe="file",Z.typeMap.h.mpv="file",Z.typeMap.h.ogg="file",Z.typeMap.h.mp4="file",Z.typeMap.h.m4p="file",Z.typeMap.h.m4v="file",Z.typeMap.h.avi="file",Z.typeMap.h.wmv="file",Z.typeMap.h.mov="file",Z.typeMap.h.qt="file",Z.typeMap.h.flv="file",Z.typeMap.h.swf="file",Z.typeMap.h.m3u8="hls",Z.typeMap.h.mpd="dash",Z.typeMap.h["ism/manifest"]="mss",Z.typeMap.h["isml/manifest"]="mss"),Z.typeMap}static getFileExtension(e){let t=e.split(".");return t[t.length-1]}static normalizeSourceUrl(e){return null==e?"":e.replace(Z.skipQueryParamsAndHashAncorRegex.r,"").toLowerCase()}static detect(e){for(;;){let t=Z.normalizeSourceUrl(e);if(""==t)return "-";let i=Z.getFileExtension(t),s=Z.getTypeMap().h[i];if(null==s){if(-1!=e.indexOf(";")){e=e.replace(Z.fallbackSkipSemicolonRegex.r,"");continue}return "-"}return s}}}Z.__name__="bs.util.VideoFormatDetector";class ee extends Error{constructor(e,t,i){super(e),this.message=e,this.__previousException=t,this.__nativeException=null!=i?i:this;}unwrap(){return this.__nativeException}get_native(){return this.__nativeException}static caught(e){return e instanceof ee?e:e instanceof Error?new ee(e.message,null,e):new ie(e,null,e)}static thrown(e){if(e instanceof ee)return e.get_native();if(e instanceof Error)return e;return new ie(e)}}ee.__name__="haxe.Exception",ee.__super__=Error,Object.assign(ee.prototype,{__class__:ee});var te=require("haxe.Timer");class ie extends ee{constructor(e,t,i){super(String(e),t,i),this.value=e;}unwrap(){return this.value}}ie.__name__="haxe.ValueException",ie.__super__=ee,Object.assign(ie.prototype,{__class__:ie});var se=require("haxe.ds.List");class ne{constructor(e,t){this.item=e,this.next=t;}}ne.__name__="haxe.ds._List.ListNode",Object.assign(ne.prototype,{__class__:ne});var ae,re=require("haxe.ds.StringMap"),le=require("haxe.http.HttpJs");class oe{static getClass(e){if(null==e)return null;if(e instanceof Array)return Array;{let t=e.__class__;if(null!=t)return t;let i=oe.__nativeClassName(e);return null!=i?oe.__resolveNativeClass(i):null}}static __string_rec(e,t){if(null==e)return "null";if(t.length>=5)return "<...>";let i=typeof e;switch("function"==i&&(e.__name__||e.__ename__)&&(i="object"),i){case"function":return "<function>";case"object":if(e instanceof Array){let i="[";t+="\t";let s=0,n=e.length;for(;s<n;){let n=s++;i+=(n>0?",":"")+oe.__string_rec(e[n],t);}return i+="]",i}let i;try{i=e.toString;}catch(e){return "???"}if(null!=i&&i!=Object.toString&&"function"==typeof i){let t=e.toString();if("[object Object]"!=t)return t}let s="{\n";t+="\t";let n=null!=e.hasOwnProperty,a=null;for(a in e)n&&!e.hasOwnProperty(a)||"prototype"!=a&&"__class__"!=a&&"__super__"!=a&&"__interfaces__"!=a&&"__properties__"!=a&&(2!=s.length&&(s+=", \n"),s+=t+a+" : "+oe.__string_rec(e[a],t));return s+="\n"+(t=t.substring(1))+"}",s;case"string":return e;default:return String(e)}}static __interfLoop(e,t){for(;;){if(null==e)return !1;if(e==t)return !0;let i=e.__interfaces__;if(null!=i&&(null==e.__super__||e.__super__.__interfaces__!=i)){let e=0,s=i.length;for(;e<s;){let s=i[e++];if(s==t||oe.__interfLoop(s,t))return !0}}e=e.__super__;}}static __instanceof(e,t){if(null==t)return !1;switch(t){case Array:return e instanceof Array;case ve:return "boolean"==typeof e;case ce:return null!=e;case me:return "number"==typeof e;case ue:return "number"==typeof e&&(0|e)===e;case String:return "string"==typeof e;default:if(null==e)return !1;if("function"==typeof t){if(oe.__downcastCheck(e,t))return !0}else if("object"==typeof t&&oe.__isNativeObj(t)&&e instanceof t)return !0;return t==ge&&null!=e.__name__||t==pe&&null!=e.__ename__}}static __downcastCheck(e,t){return e instanceof t||!!t.__isInterface__&&oe.__interfLoop(oe.getClass(e),t)}static __cast(e,t){if(null==e||oe.__instanceof(e,t))return e;throw ee.thrown("Cannot cast "+r.string(e)+" to "+r.string(t))}static __nativeClassName(e){let t=oe.__toStr.call(e).slice(8,-1);return "Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t}static __isNativeObj(e){return null!=oe.__nativeClassName(e)}static __resolveNativeClass(e){return t[e]}}oe.__name__="js.Boot";class de{static getSessionStorage(){try{let e=window.sessionStorage;if(e.getItem(""),0==e.length){let t="_hx_"+Math.random();e.setItem(t,t),e.removeItem(t);}return e}catch(e){return null}}}function he(e,i){return null==i?null:(null==i.__id__&&(i.__id__=t.$haxeUID++),null==e.hx__closures__?e.hx__closures__={}:s=e.hx__closures__[i.__id__],null==s&&(s=i.bind(e),e.hx__closures__[i.__id__]=s),s);var s;}de.__name__="js.Browser",t.$haxeUID|=0,null==String.fromCodePoint&&(String.fromCodePoint=function(e){return e<65536?String.fromCharCode(e):String.fromCharCode(55232+(e>>10))+String.fromCharCode(56320+(1023&e))}),Object.defineProperty(String.prototype,"__class__",{value:String,enumerable:!1,writable:!0}),String.__name__="String",Array.__name__="Array",Date.prototype.__class__=Date,Date.__name__="Date";var ue={},ce={},me=Number,ve=Boolean,ge={},pe={};oe.__toStr={}.toString,A._hx_skip_constructor=!1,N.SUPPORT_RATE_NOT_SUPPORTED=0,N.SUPPORT_RATE_BEST_RATE=1,N.PERMAMENT_PLAYBACK_ERROR_SAFETY_WINDOW=6e3,N.__plugfaces__="IVideoPluginSupportRateForUrls,IPlugin",H.instances=new re,q.canPlayFileExtensionCache=new re,q.instances=new re,q.subtitlesStylesForSafariInitialized=!1,Z.skipQueryParamsAndHashAncorRegex=new i("[\\?#].*","g"),Z.fallbackSkipSemicolonRegex=new i("[;].*","g");}(exports,window);
!function(e,t){e.bs=e.bs||{},e.bs.player=e.bs.player||{},e.bs.player.plugin=e.bs.player.plugin||{},e.bs.player.plugin.video=e.bs.player.plugin.video||{},e.bs.player.plugin.video.videoPlayer=e.bs.player.plugin.video.videoPlayer||{};var i=require("haxe.HxOverrides"),s=require("haxe.Lambda");Math.__name__="Math";var a=require("haxe.Reflect");class r{static string(e){return _.__string_rec(e,"")}static parseInt(e){let t=parseInt(e);return isNaN(t)?null:t}}r.__name__="Std";var n=require("bs.player.core.events.AdEvent"),l=require("bs.player.core.events.ControlEvent"),o=require("bs.player.core.events.DataProviderEvent"),d=require("bs.player.core.events.VideoEvent");class h{}h.__name__="bs.player.core.interfaces.IHlsManifestAssets",h.__isInterface__=!0,Object.assign(h.prototype,{__class__:h});var u=require("bs.player.core.model.Media"),c=require("bs.player.core.model.Live"),v=require("bs.player.core.model.LiveStream"),p=require("bs.player.core.model.VideoQualityEventData");class m{constructor(e){null==e&&(e=5),this.pluginName="";let t=_.getClass(this);this.pluginName=t.__name__.split(".").pop(),this.initPriority=e;let i=this.pluginName,s=exports.configuration;this.pluginConfig=null!=s&&Object.prototype.hasOwnProperty.call(s,i)?a.field(s,i):Object.create(null);}create(){}destroy(){}activate(){}postActivate(){}deactivate(){}eventFilter(e){return !0}registerPlugin(e){}getPluginVersion(){return "v2.15.38"}getPluginName(){return this.pluginName}get_player(){return this.player}set_player(e){return this.player=e}get_variables(){return this.variables}set_variables(e){return this.variables=e}get_eventHub(){return this.eventHub}set_eventHub(e){return this.eventHub=e}get_parentDisplay(){return this.parentDisplay}set_parentDisplay(e){return this.parentDisplay=e}get_display(){return this.display}isCriticalForPlayback(){return !0}}m.__name__="bs.player.core.plugin.PluginBase",Object.assign(m.prototype,{__class__:m});var g=require("bs.player.core.plugin.VideoPlayerUtil");class y{constructor(e){this.translationsUrl=null,this.saveBandwidthModeStore=null,this.playbackRate=1,this.initialAsAdvertisement=!1,this.isInStreamAdvertisement=!1,this.isAdvertisement=!1,this.isQuickFallbackPathForLiveEnabled=!0,this.minAudioTracksForInfo=2,null==y.instances.h[(e?"ad_":"")+this.context]&&(this.pluginConfig=g.readPluginConfig(this),this.isAdvertisement=e,this.initialAsAdvertisement=e,this.isInStreamAdvertisement=!1,this.isQualitySelectionEnabled=!0,this.hasSubtitlesAndAudioInitialized=!1,this.liveStreamRestartsOnError=0,this.prePlaybackSeekRelativePosition=null,this.prePlaybackHandlingSeeking=!1,this.dvrPlaybackStartTs=null,this.dvrRequestedInitialTimeTs=null,this.dvrWindowLength=null,this.isHlsLiveStream=!1,this.isPlaybackNotAllowed=!1,this.lastTimeUpdatePostionForEdgeBrowser=null,this.unfreezeEdgeBrowserTimer=null,this.hlsQualityLevel=r.parseInt("-1"),this.playbackState=0,this.saveBandwidthModeStore=null);}create(){l.add(this.context,"selectSubtitles",E(this,this.onSelectSubtitles)),l.add(this.context,"selectAudio",E(this,this.onSelectAudio)),l.add(this.context,"requestVideoQualityChange",E(this,this.onVideoQualityChange)),n.add(this.context,"adInStreamPlaying",E(this,this.onAdInStreamPlaying)),n.add(this.context,"adInStreamPlayingSilent",E(this,this.onAdInStreamPlaying)),n.add(this.context,"adInStreamEnd",E(this,this.onAdInStreamEnd)),n.add(this.context,"adInStreamEndSilent",E(this,this.onAdInStreamEnd)),n.add(this.context,"adInStreamClipPlaying",E(this,this.onAdClipInStreamPlaying)),n.add(this.context,"adInStreamClipPlayingSilent",E(this,this.onAdClipInStreamPlaying)),n.add(this.context,"adInStreamClipEnd",E(this,this.onAdClipInStreamEnd)),n.add(this.context,"adInStreamClipEndSilent",E(this,this.onAdClipInStreamEnd));}destroy(){l.remove(this.context,"selectSubtitles",E(this,this.onSelectSubtitles)),l.remove(this.context,"selectAudio",E(this,this.onSelectAudio)),l.remove(this.context,"requestVideoQualityChange",E(this,this.onVideoQualityChange)),n.remove(this.context,"adInStreamPlaying",E(this,this.onAdInStreamPlaying)),n.remove(this.context,"adInStreamPlayingSilent",E(this,this.onAdInStreamPlaying)),n.remove(this.context,"adInStreamEnd",E(this,this.onAdInStreamEnd)),n.remove(this.context,"adInStreamEndSilent",E(this,this.onAdInStreamEnd)),n.remove(this.context,"adInStreamClipPlaying",E(this,this.onAdClipInStreamPlaying)),n.remove(this.context,"adInStreamClipPlayingSilent",E(this,this.onAdClipInStreamPlaying)),n.remove(this.context,"adInStreamClipEnd",E(this,this.onAdClipInStreamEnd)),n.remove(this.context,"adInStreamClipEndSilent",E(this,this.onAdClipInStreamEnd)),this.stopLiveEdgeUpdateTimer(),this.cleanVideoAndPlayer(),this.media=null,this.liveStreamRestartsOnError=0;}cleanVideoAndPlayer(){this.cleanPlayer(),null!=this.video&&(this.video.removeEventListener("pause",E(this,this.onHlsjsPause)),this.video.removeEventListener("play",E(this,this.onHlsjsPlay)),this.video.removeEventListener("playing",E(this,this.onHlsjsPlaying)),this.video.removeEventListener("timeupdate",E(this,this.onHlsjsTimeupdate)),this.video.removeEventListener("durationchange",E(this,this.onHlsjsDurationchange)),this.video.removeEventListener("waiting",E(this,this.onHlsjsWaiting)),this.video.removeEventListener("ended",E(this,this.onHlsjsEnded)),this.video.removeEventListener("seeked",E(this,this.onHlsjsSeeked)),this.video.removeEventListener("canplaythrough",E(this,this.onVideoCanplaythrough)),null!=this.video.textTracks&&this.video.textTracks.removeEventListener("addtrack",E(this,this.onAddTrack)),this.video.removeEventListener("ratechange",E(this,this.onVideoRateChange)),this.video.pause(),this.video=null),this.source=null,this.saveBandwidthModeStore=null;}onAdInStreamPlaying(e){this.isAdvertisement=!0,this.isInStreamAdvertisement=!0,null!=this.media&&null!=this.media.mediaPlaybackInfo&&(this.media.mediaPlaybackInfo.isInStreamAdvertisementPlaying=!0);}onAdClipInStreamPlaying(e){null!=this.video&&null!=this.media&&(this.inStreamAdvertStartPos=null,this.video.currentTime>=0&&(this.inStreamAdvertStartPos=this.video.currentTime),this.inStreamAdvertMedia=null,null!=e&&null!=e.data&&(this.inStreamAdvertMedia=e.data.media));}onAdClipInStreamEnd(e){this.inStreamAdvertStartPos=null,this.inStreamAdvertMedia=null;}onAdInStreamEnd(e){this.isAdvertisement=this.initialAsAdvertisement,this.isInStreamAdvertisement=!1,null!=this.media&&null!=this.media.mediaPlaybackInfo&&(this.media.mediaPlaybackInfo.isInStreamAdvertisementPlaying=!1);}onLiveEdgeUpdate(){null!=this.player&&this.hasSubtitlesAndAudioInitialized&&this.isPaused()&&this.dispatchEvent(this.isAdvertisement?new n("adCurrentTimeChange"):new d("currentTimeChange"));}dispatchEvent(e,t){if(null==this.video)return;let i=this.video.duration,s=this.video.currentTime;if(null!=this.media&&this.hasSubtitlesAndAudioInitialized&&(this.media.mediaPlaybackInfo.currentTime=s,this.media.mediaPlaybackInfo.isPlaying=!this.video.paused,null!=this.player&&null!=this.player.levels&&null!=this.player.currentLevel&&this.player.currentLevel<this.player.levels.length&&null!=this.player.levels[this.player.currentLevel]&&this.player.levels[this.player.currentLevel].bitrate>0&&(this.media.mediaPlaybackInfo.currentTotalBitrateKpbs=Math.round(this.player.levels[this.player.currentLevel].bitrate/1e3)),this.media.mediaPlaybackInfo.playbackRate=this.getPlaybackRate(),this.isDvr()&&(s=this.dvrRelativePlaybackTimeToDvrWindowTime(this.video.currentTime),this.media.mediaPlaybackInfo.currentTime=this.dvrRelatibePlaybackTimeToTs(this.video.currentTime))),this.isDvr()){let e=this.media,t=this.getDVRWindowRange(),s=this.getDvrWindowLengthFromHls();s>0&&(this.dvrWindowLength=s),i=this.isDvrSeekingSupported()?this.dvrWindowLength:1,null!=t&&null!=this.dvrPlaybackStartTs?(e.dvrWindowLength=t.end-t.start,e.dvrWindowLiveEdge=this.dvrRelatibePlaybackTimeToTs(t.end)):(e.dvrWindowLength=this.dvrWindowLength,e.dvrWindowLiveEdge=(new Date).getTime()/1e3),null!=e.dvrWindowLength&&(i=e.dvrWindowLength),null==this.liveEdgeUpdateTimer&&(this.liveEdgeUpdateTimer=new T(1e3),this.liveEdgeUpdateTimer.run=E(this,this.onLiveEdgeUpdate));}null==e.data&&(e.data={}),0==s&&null!=this.media&&null!=this.media.mediaUserSettings&&this.media.mediaUserSettings.resumePostion>0&&(s=this.media.mediaUserSettings.resumePostion),this.isInStreamAdvertisement&&this.inStreamAdvertStartPos>=0&&(s=this.video.currentTime-this.inStreamAdvertStartPos,null!=this.inStreamAdvertMedia&&(i=this.inStreamAdvertMedia.duration),s>i&&(s=i)),e.data.duration=i,e.data.currentTime=s,e.data.videoTagCurrentTime=this.video.currentTime,e.data.source=this.video.currentSrc,e.data.media=this.media,e.data.additionalData=t,this.isPlaybackNotAllowed&&(null==e.data.additionalData&&(e.data.additionalData={}),e.data.additionalData.isPlaybackNotAllowed=!0),e.dispatch(this.context);}isDvrSeekingSupported(){return this.dvrWindowLength>0&&this.dvrWindowLength>this.getLiveStreamDvrMinLen()}getDvrWindowLengthFromHls(){let e=0;if(null!=this.player&&null!=this.player.levels){let t=0,i=this.player.levels;for(;t<i.length;){let s=i[t];++t,null!=s.details&&s.details.totalduration>e&&(e=s.details.totalduration);}}return e}onHlsjsLevelLoaded(e,t){null!=t&&null!=t.details&&(this.isHlsLiveStream=t.details.live,this.checkMediaType(),null==this.dvrWindowLength&&(this.dvrWindowLength=t.details.totalduration),null!=t.level&&this.updateVideoQualityPlaybackLevel(t.level)),this.triggerCodecsEvent();}getLiveStreamDvrMinLen(){let e=600;return Object.prototype.hasOwnProperty.call(this.variables,"dvrMinLenForSeekbar")&&this.variables.dvrMinLenForSeekbar>=0&&(e=this.variables.dvrMinLenForSeekbar),Object.prototype.hasOwnProperty.call(this.pluginConfig,"liveStreamDvrMinLen")&&null!=a.field(this.pluginConfig,"liveStreamDvrMinLen")&&(e=this.pluginConfig.liveStreamDvrMinLen),e}onHlsjsManifestLoaded(e,t){this.isDvr()&&(this.dvrPlaybackStartTs=null),this.triggerCodecsEvent(),this.updateVideoQualityList(),this.setTranslationsUrl(t);}checkMediaType(){if(this.media instanceof u&&this.isHlsLiveStream&&!(this.media instanceof c)){let e=new c;this.media.copyFieldsTo(e),this.media=e;let t=new o("mediaAfterPlaybackStartMetadata");t.data=e,t.dispatch(this.context);}if(this.media instanceof c&&!this.isHlsLiveStream&&this.video.duration>0){let e=new u;this.media.copyFieldsTo(e),this.media=e;let t=new o("mediaAfterPlaybackStartMetadata");t.data=this.media,t.dispatch(this.context);}}xhrSetupForToHttpsRedirect(e,t){"http://"==i.substr(t,0,7)&&(t="https://"+i.substr(t,7,null)),this.xhrSetupForNetworkActivity(e,t),e.open("GET",t,!0);}xhrSetupForNetworkActivity(e,t){let i=this;e.addEventListener("loadstart",(function(e){i.emitNetworkRequestStart(t);})),e.addEventListener("progress",(function(e){i.emitNetworkActivity(t,e);}));}emitNetworkRequestStart(e){let t=new d("networkRequestStart");t.data={url:e},t.dispatch(this.context);}emitNetworkActivity(e,t){let i=new d("networkActivityUrl");i.data={url:e,loaded:t.loaded},i.dispatch(this.context);}initPlayer(){let e={maxMaxBufferLength:120,maxBufferLength:30,autoStartLoad:!0,lowLatencyMode:!1,capLevelOnFPSDrop:!0,fpsDroppedMonitoringPeriod:1e4,fpsDroppedMonitoringThreshold:.05,liveSyncDuration:15};if(f.isSamsungSmartTVTizen&&(e.liveSyncDuration=20),Object.prototype.hasOwnProperty.call(this.pluginConfig,"hlsSettings")&&null!=this.pluginConfig.hlsSettings){let t=0,i=a.fields(this.pluginConfig.hlsSettings);for(;t<i.length;){let s=i[t];++t,e[s]=a.field(this.pluginConfig.hlsSettings,s);}}if(Object.prototype.hasOwnProperty.call(this.variables,"hlsSettings")&&null!=this.variables.hlsSettings){let t=0,i=a.fields(this.variables.hlsSettings);for(;t<i.length;){let s=i[t];++t,e[s]=a.field(this.variables.hlsSettings,s);}}if(Object.prototype.hasOwnProperty.call(this.variables,"saveBandwidthMode")&&_.__cast(this.variables.saveBandwidthMode,x)&&(e.capLevelToPlayerSize=!0),null!=this.media){let t=this.getPlaybackStartTime(this.media);null!=t&&(e.startPosition=t),null!=this.media.source&&this.media.source.length>0&&null!=this.media.source[0]&&1==this.media.source[0].customParams.h.hlsjsForceHttpsUse?e.xhrSetup=E(this,this.xhrSetupForToHttpsRedirect):e.xhrSetup=E(this,this.xhrSetupForNetworkActivity),this.media instanceof c&&1==this.media.lowLatencyMode&&(e.lowLatencyMode=!0);}null!=this.player&&this.player.destroy(),this.wrapPlayerConfigWithSystem73(e),this.player=new exports.Hls(e),this.wrapPlayerWithSystem73(this.player),this.wrapPlayerWithQuanteec(this.player,this.media),this.player.attachMedia(this.video),this.player.on("hlsLevelLoaded",E(this,this.onHlsjsLevelLoaded)),this.player.on("hlsLevelSwitched",E(this,this.onHlsjsPlaybackBitrateChange)),this.player.on("hlsManifestLoaded",E(this,this.onHlsjsManifestLoaded)),this.player.on("hlsError",E(this,this.onHlsjsError));}onPlayerResetWithMseExtension(){if(null==this.video)return;this.video.removeEventListener("player_reset",E(this,this.onPlayerResetWithMseExtension));let e=this.video;this.video=null,this.attachVideo(e),null!=this.media&&this.play();}attachSubtitlesRenderer(e){this.subtitlesRenderer=e;}attachVideo(e){this.video!=e&&(this.cleanPlayer(),Object.prototype.hasOwnProperty.call(this.variables,"qualitySelectionEnabled")&&(this.isQualitySelectionEnabled=a.field(this.variables,"qualitySelectionEnabled")),this.video=e,this.video.addEventListener("pause",E(this,this.onHlsjsPause)),this.video.addEventListener("play",E(this,this.onHlsjsPlay)),this.video.addEventListener("playing",E(this,this.onHlsjsPlaying)),this.video.addEventListener("timeupdate",E(this,this.onHlsjsTimeupdate)),this.video.addEventListener("durationchange",E(this,this.onHlsjsDurationchange)),this.video.addEventListener("waiting",E(this,this.onHlsjsWaiting)),this.video.addEventListener("ended",E(this,this.onHlsjsEnded)),this.video.addEventListener("seeked",E(this,this.onHlsjsSeeked)),this.video.addEventListener("canplaythrough",E(this,this.onVideoCanplaythrough)),null!=this.video.textTracks&&this.video.textTracks.addEventListener("addtrack",E(this,this.onAddTrack)),this.video.addEventListener("ratechange",E(this,this.onVideoRateChange)),this.checkPlaybackRate(),this.triggerVideoPlaybackRateEvent());}setPlaybackRate(e){this.isAdvertisement||(this.playbackRate=e,this.checkPlaybackRate());}getPlaybackRate(){return this.video.playbackRate}onVideoRateChange(e){this.triggerVideoPlaybackRateEvent();}triggerVideoPlaybackRateEvent(){if(this.isAdvertisement)return;let e=new d("playbackRate");e.data=this.getPlaybackRate(),e.dispatch(this.context);}checkPlaybackRate(){let e;if(this.isAdvertisement)e=!0;else {let t=this.playbackRate;e=isNaN(t);}e||this.getPlaybackRate()==this.playbackRate||(this.video.playbackRate=this.playbackRate);}cleanPlayer(){this.destroySystem73(),this.destroyQuanteec(),null!=this.player&&(this.player.detachMedia(),this.player.destroy(),this.player=null);}reset(){}isPaused(){return null==this.video||this.video.paused}onAddTrack(e){let t=this.isAdvertisement?new n("addTrack"):new d("addTrack");t.data={track:e},this.dispatchEvent(t);}onHlsjsPause(e){return this.dispatchEvent(this.isAdvertisement?new n("adPaused"):new d("paused")),this.dispatchEvent(this.isAdvertisement?new n("adBufferingEnd"):new d("bufferingEnd")),this.isBuffering=!1,20==this.playbackState&&this.onHlsjsEnded(),null}onHlsjsPlay(e){return this.checkPlaybackRate(),this.dispatchEvent(this.isAdvertisement?new n("adPlaying"):new d("playing")),null}stopLiveStreamRestartTimeoutTimer(){null!=this.liveStreamRestartTimeoutTimer&&(this.liveStreamRestartTimeoutTimer.stop(),this.liveStreamRestartTimeoutTimer=null);}stopLiveStreamRestartDelayTimer(){null!=this.liveStreamRestartDelayTimer&&(this.liveStreamRestartDelayTimer.stop(),this.liveStreamRestartDelayTimer=null);}stopLiveStreamEndingTimeout(){null!=this.liveStreamEndingTimeout&&(this.liveStreamEndingTimeout.stop(),this.liveStreamEndingTimeout=null);}stopLiveEdgeUpdateTimer(){null!=this.liveEdgeUpdateTimer&&(this.liveEdgeUpdateTimer.stop(),this.liveEdgeUpdateTimer=null);}onHlsjsPlaying(e){return this.stopLiveStreamRestartTimeoutTimer(),this.liveStreamRestartsOnError=0,this.dispatchEvent(this.isAdvertisement?new n("adBufferingEnd"):new d("bufferingEnd")),this.isBuffering=!1,this.dispatchEvent(this.isAdvertisement?new n("adPlaying"):new d("playing")),null}unfreezeEdgeBrowser(){this.stopUnfreezeEdgeBrowserTimer();let e=this;null!=this.video&&this.video.currentTime>0&&(this.video.currentTime+=.2,this.lastTimeUpdatePostionForEdgeBrowser=null,T.delay((function(){e.video.currentTime+=.2;}),100));}stopUnfreezeEdgeBrowserTimer(){null!=this.unfreezeEdgeBrowserTimer&&(this.unfreezeEdgeBrowserTimer.stop(),this.unfreezeEdgeBrowserTimer=null);}isVideoStalledAtEnd(){return null!=this.video&&!this.isDvr()&&Math.abs(this.video.duration-this.video.currentTime)<.15}isVideoStalledAtBegin(e){if(null!=this.player&&null!=e&&"bufferStalledError"==e.details&&null!=e.error&&null!=e.error.message&&-1!=e.error.message.indexOf("Playback stalling at @0 due to low buffer")&&null!=this.player.bufferController.tracks.audio&&null!=this.player.bufferController.tracks.video&&this.player.bufferController.tracks.audio.buffer.buffered.length>0&&this.player.bufferController.tracks.video.buffer.buffered.length>0){let e=this.player.bufferController.tracks.audio.buffer.buffered.start(0),t=this.player.bufferController.tracks.video.buffer.buffered.start(0);return e>=0&&t>=0&&Math.abs(e-t)>3*this.player.config.maxBufferHole}return !1}seekOverBeginingInconsistiency(){if(null!=this.player&&null!=this.player.bufferController.tracks.audio&&null!=this.player.bufferController.tracks.video&&this.player.bufferController.tracks.audio.buffer.buffered.length>0&&this.player.bufferController.tracks.video.buffer.buffered.length>0){let e=this.player.bufferController.tracks.audio.buffer.buffered.start(0),t=this.player.bufferController.tracks.video.buffer.buffered.start(0),i=Math.max(e,t);i>=0&&this.seek(i);}}triggerVideoCompleteOnVideoStalledAtEnd(){this.video.pause(),this.playbackState=25,this.video.currentTime=0;}triggerVideoCompleteOnVideoStalledAtEndComplete(){this.dispatchEvent(this.isAdvertisement?new n("adBufferingEnd"):new d("bufferingEnd")),this.isBuffering=!1,this.onHlsjsEnded(),this.playbackState=0;}onHlsjsTimeupdate(e){if(0==this.video.readyState||25==this.playbackState)return null;this.playbackState=0;let t,i=this.isDvr();if(this.getNowTs(),this.stopUnfreezeEdgeBrowserTimer(),f.isEdge&&null!=this.video&&!this.video.paused&&(this.lastTimeUpdatePostionForEdgeBrowser==this.video.currentTime&&this.lastTimeUpdatePostionForEdgeBrowser>0&&(this.unfreezeEdgeBrowserTimer=T.delay(E(this,this.unfreezeEdgeBrowser),2e3)),this.lastTimeUpdatePostionForEdgeBrowser=this.video.currentTime),!this.isPlaybackNotAllowed||null==this.video||this.video.paused||this.video.seeking||(this.isPlaybackNotAllowed=!1),this.dispatchEvent(this.isAdvertisement?new n("adCurrentTimeChange"):new d("currentTimeChange")),this.isBuffering){let e=this.video;t=(null!=e?e.readyState:null)>=4;}else t=!1;return t&&!this.video.paused&&!this.video.seeking&&(this.video.playbackRate>0||null==this.video.playbackRate)&&(this.dispatchEvent(this.isAdvertisement?new n("adBufferingEnd"):new d("bufferingEnd")),this.isBuffering=!1),i&&null!=this.dvrWindowEndTimeTs&&this.media.mediaPlaybackInfo.currentTime>this.dvrWindowEndTimeTs&&(new l("skinPause").dispatch(this.context),this.onHlsjsEnded()),null}onHlsjsDurationchange(e){if(this.isHlsLiveStream||null!=this.media.duration||(this.media.duration=this.video.duration),null!=this.prePlaybackSeekRelativePosition){let e=this.prePlaybackSeekRelativePosition;this.prePlaybackSeekRelativePosition=null,this.video.duration>0&&Math.abs(this.video.duration-this.media.duration)>2&&(this.prePlaybackHandlingSeeking=!0,this.seek(e*this.video.duration),this.pause());}return this.dispatchEvent(this.isAdvertisement?new n("adDurationChange"):new d("durationChange")),null}onHlsjsWaiting(e){return this.isVideoStalledAtEnd()?(this.triggerVideoCompleteOnVideoStalledAtEnd(),null):(this.isBuffering=!0,this.dispatchEvent(this.isAdvertisement?new n("adBufferingStart"):new d("bufferingStart")),null)}onHlsjsPlaybackBitrateChange(e,t){return null!=t&&null!=t.level&&this.updateVideoQualityPlaybackLevel(t.level),null}updateVideoQualityPlaybackLevel(e){this.hlsQualityLevel=e;let t=new o("videoQualityPlaybackLevelChange");t.data=e,t.dispatch(this.context);}triggerCodecsEvent(){if(null!=this.player.levels&&null!=this.player.currentLevel&&this.player.levels.length>=this.player.currentLevel&&null!=this.player.levels[this.player.currentLevel]){let e=this.player.levels[this.player.currentLevel];if(null!=e&&null!=e.audioCodec&&null!=e.videoCodec){let t=new o("codecData");t.data={audioCodec:e.audioCodec,videoCodec:e.videoCodec},t.dispatch(this.context);}}}updateVideoQualityList(){if(!this.isQualitySelectionEnabled||null==this.player.levels||this.player.levels.length<2||this.isAdvertisement)return;let e=new o("videoQualityData");e.data=this.getQualityLevels(),e.dispatch(this.context);let t=new l("videoQualityHasChanged");t.data="-1",t.dispatch(this.context),this.setInitialVideoQualityKbps();}setInitialVideoQualityKbps(){if(!Object.prototype.hasOwnProperty.call(this.variables,"qualityInitialBandwidthKbs"))return;let e=a.field(this.variables,"qualityInitialBandwidthKbs");if(null==e)return;let t=1e3*r.parseInt(e);if(null==t||isNaN(t)||!isFinite(t))return;let i=0;if(t>0){i=-1;let e=this.player.levels,s=0;for(;s<e.length;){let n=e[s],l=s++;if(!Object.prototype.hasOwnProperty.call(n,"bitrate"))continue;let o=a.field(n,"bitrate");if(null==o)continue;let d=r.parseInt(o);null!=d&&!isNaN(d)&&isFinite(d)&&(d<=t&&(i=l));}}-1==i||this.player.startLevel==i&&this.player.nextAutoLevel==i||(this.player.startLevel=this.player.nextAutoLevel=i);}getQualityLevels(){let e="resolution";if(Object.prototype.hasOwnProperty.call(this.variables,"qualityLabelType")&&(e=a.field(this.variables,"qualityLabelType"),e=e.toLowerCase()),"resolution"==e){let t=0,i=this.player.levels;for(;t<i.length;){let s=i[t];if(++t,s.width<=0||s.height<=0){e="bitrate";break}}}let t=[];t.push(new p("Auto","-1"));let i=0,s=this.player.levels.length;for(;i<s;){let s=i++,a="resolution"==e?this.player.levels[s].height+"p":this.mapBitrateToLabel(this.player.levels[s].bitrate),r=new p(a,null==s?"null":""+s);r.height=this.player.levels[s].height,r.width=this.player.levels[s].width,r.bitrateKbps=this.player.levels[s].bitrate>0?this.player.levels[s].bitrate/1e3:null,t.push(r);}return t.reverse(),t}mapBitrateToLabel(e){return Math.floor(e/1e3)+"k"}onVideoCanplaythrough(){if(this.hasSubtitlesAndAudioInitialized||(this.resolveMediaAssets(),this.triggerCodecsEvent(),this.updateVideoQualityList(),this.hasSubtitlesAndAudioInitialized=!0),null==this.dvrPlaybackStartTs&&this.isDvr()){let e=this.getDVRWindowRangeRaw();null!=e&&(this.dvrPlaybackStartTs=this.getNowTs()-e.end,null!=this.dvrRequestedInitialTimeTs&&this.seek(this.dvrRequestedInitialTimeTs-this.dvrPlaybackStartTs));}}getHlsManifestAssets(){if(s.exists(this.plugins,(function(e){return "HlsManifestAssets"==e.getPluginName()}))){let e=this.plugins;return s.exists(e,(function(e){return "HlsManifestAssets"==e.getPluginName()}))?s.find(e,(function(e){return "HlsManifestAssets"==e.getPluginName()})):null}return null}canUseHlsLabelTranslations(){let e=this.getHlsManifestAssets();return null!=e?e.canUseHlsLabelTranslations:null}setTranslationsUrl(e){this.canUseHlsLabelTranslations()&&(this.translationsUrl=this.getHlsManifestAssets().searchTranslationsUrlInHlsJsManifestData(e));}resolveMediaAssets(){null!=this.translationsUrl&&this.canUseHlsLabelTranslations()?this.getHlsManifestAssets().fetchHlsTranslations(this.translationsUrl).finally(E(this,this.updateMediaSets)):this.updateMediaSets();}getNameTranslator(){let e=function(e){return null};if(!this.canUseHlsLabelTranslations())return e;let t=this.getHlsManifestAssets();return t.canUseHlsLabelTranslations?E(t,t.getTranslationForLabel):e}updateMediaSets(){let e=this.getNameTranslator();this.updateSubtitlesSets(e),this.updateAudioSets(e),this.updateVideoSets(e);}getDVRWindowRangeRaw(){if(null==this.video||null==this.video.duration||this.video.duration<=0||null==this.dvrWindowLength)return null;return {start:this.video.duration-this.dvrWindowLength,end:this.video.duration}}isDvr(){return null!=this.media&&this.media instanceof c}onHlsjsEndingTimeout(){this.onHlsjsEnded();}onHlsjsEnded(e){return this.stopLiveStreamEndingTimeout(),this.media instanceof v&&(this.playbackState=21),this.dispatchEvent(this.isAdvertisement?new n("adComplete"):new d("complete")),null}onHlsjsSeeked(e){return this.prePlaybackHandlingSeeking&&(this.prePlaybackHandlingSeeking=!1,this.play(),this.pause()),25==this.playbackState&&this.triggerVideoCompleteOnVideoStalledAtEndComplete(),this.dispatchEvent(this.isAdvertisement?new n("seekingEnd"):new d("seekingEnd")),this.isPaused()&&(this.dispatchEvent(this.isAdvertisement?new n("adBufferingEnd"):new d("bufferingEnd")),this.isBuffering=!1),null}onHlsjsError(e,t){if(this.isAdvertisement&&!this.isInStreamAdvertisement)return this.dispatchEvent(new n("adMediaError"),this.prepareErrorMessage(e)),null;if(10==this.playbackState)return null;if(t&&"otherError"==t.type)return null;if(t&&"mediaError"==t.type&&"bufferFullError"==t.details)return null;if(t&&"mediaError"==t.type&&("bufferNudgeOnStall"==t.details||"bufferStalledError"==t.details))return this.isVideoStalledAtBegin(t)?this.seekOverBeginingInconsistiency():this.isDvr()?this.hasLiveStreamEnded()?this.handleLiveStreamEnding():console.warn("bradmax.player Warning: There seems to be problem with connection with streaming server. Waiting for new data from streaming server."):this.isVideoStalledAtEnd()&&this.triggerVideoCompleteOnVideoStalledAtEnd(),null;if(t&&"networkError"==t.type&&!t.fatal)return null;if(t&&"mediaError"==t.type&&!t.fatal)return null;this.stopLiveStreamRestartTimeoutTimer();let i,s=!0;if(this.media instanceof v){let e,t=this.hasLiveStreamEnded();if(t)e=!1;else {let t=this.media;e=this.liveStreamRestartsOnError>=(null!=t?t.getLimitOfRestartsOnError():null);}e&&(this.liveStreamRestartsOnError-=1),t&&(s=!1,this.handleLiveStreamEnding());}if(null!=e&&null!=t&&(console.error("bradmax.player.error: "+e),console.error(t)),s&&this.isDvr()){let e=this.media;i=this.liveStreamRestartsOnError<(null!=e?e.getLimitOfRestartsOnError():null);}else i=!1;if(i&&!this.media.hasFallbackSources()){s=!1,this.stopLiveStreamRestartDelayTimer(),this.liveStreamRestartDelayTimer=T.delay(E(this,this.handleLivestreamRestart),2e3*(this.liveStreamRestartsOnError+1)),this.playbackState=10,this.isBuffering=!0,this.dispatchEvent(this.isAdvertisement?new n("adBufferingStart"):new d("bufferingStart"));let e={hasplayerError:t,currTry:this.liveStreamRestartsOnError};this.dispatchEvent(this.isAdvertisement?new n("adMediaErrorFallbackTry"):new d("mediaErrorFallbackTry"),e);}return s&&(this.isNetworkConnectionProblem(t)?(this.pause(),this.dispatchEvent(this.isAdvertisement?new n("adConnectionError"):new d("connectionError"),this.prepareErrorMessage(t))):this.dispatchEvent(this.isAdvertisement?new n("adMediaError"):new d("mediaError"),this.prepareErrorMessage(t))),null}prepareErrorMessage(e){let t=this.isNetworkConnectionProblem(e)&&(this.media instanceof v||this.video.currentTime>0||null!=e&&null!=e.response&&e.response.code>=500||null!=this.media.mediaUserSettings&&this.media.mediaUserSettings.resumePostion>0),i="";return null!=e&&null!=e.details&&(i=" type: "+r.string(e.details)),null!=e&&null!=e.context&&null!=e.context.url&&(i+="\nurl: "+r.string(e.context.url)),{errObj:e,isTemporaryNetworkIssue:t,message:i}}hasLiveStreamEnded(){if(!(this.media instanceof v))return !1;let e=this.media;return null!=e.streamEnd&&e.streamEnd.getTime()<(new Date).getTime()||null==e.streamEnd&&null!=e.streamEndThankYouImageUrl&&(null==e.lowLatencyMode||!e.lowLatencyMode)}handleLiveStreamEnding(){new l("skinPause").dispatch(this.context),this.playbackState=20,this.stopLiveStreamEndingTimeout(),this.liveStreamEndingTimeout=T.delay(E(this,this.onHlsjsEndingTimeout),500);}isNetworkConnectionProblem(e){return null!=e&&"networkError"==e.type&&null!=this.video&&null!=this.media}handleLivestreamRestart(){this.liveStreamRestartsOnError++,this.playbackState=11,this.stopLiveStreamRestartDelayTimer(),this.stopLiveStreamRestartTimeoutTimer();let e=this.video;this.cleanVideoAndPlayer(),this.attachVideo(e),this.play(),this.liveStreamRestartTimeoutTimer=T.delay(E(this,this.onHlsjsLivestreamRestartTimeout),1e4);}onHlsjsLivestreamRestartTimeout(){let e=this.media;this.liveStreamRestartsOnError<(null!=e?e.getLimitOfRestartsOnError():null)?this.handleLivestreamRestart():(this.playbackState=30,this.dispatchEvent(this.isAdvertisement?new n("adMediaError"):new d("mediaError"),{message:"Livestream restart all tries failed."}));}onVideoQualityChange(e){if(null==e||null==e.data||"string"!=typeof e.data||null==this.player||null==this.player.levels||this.player.levels.length<2)return;let t=e.data,i=r.string(this.hlsQualityLevel);if(this.player.autoLevelEnabled&&(i="-1"),this.player.currentLevel>=0&&this.updateVideoQualityPlaybackLevel(this.player.currentLevel),t==i)return;this.hlsQualityLevel=r.parseInt(t),this.player.currentLevel=this.hlsQualityLevel,Object.prototype.hasOwnProperty.call(this.variables,"saveBandwidthMode")&&_.__cast(this.variables.saveBandwidthMode,x)&&(this.player.capLevelToPlayerSize="-1"==t);let s=new l("videoQualityHasChanged");s.data=t,s.dispatch(this.context);}updateAudioSets(e){if(null==this.player)return;let t=this.player.audioTracks;if(t.length<this.minAudioTracksForInfo)return;let i=this.mediaTrackParsers.hlsjs.audioTracksToAudioSets(t,e);if(i.length<this.minAudioTracksForInfo)return;let s=this.context,a=new o("audioData");a.data=i,a.dispatch(s);}updateSubtitlesSets(e){let t=this.player,i=null!=t?t.subtitleTracks:null,s=this.video,a=null!=s?s.textTracks:null;if(!(null!=i&&0!=i.length||null!=a&&0!=a.length))return;let r=this.mediaTrackParsers.hlsjs.textTracksToSubtitlesSets(i,a,e);if(0==r.length)return;let n=this.context,l=new o("subtitleData");l.data=r,l.dispatch(n);}updateVideoSets(e){if(null==this.player)return;let t=this.player.levels;if(t.length<=1)return;let i=this.mediaTrackParsers.hlsjs.videoTracksToVideoSets(t,e);if(i.length<=1)return;let s=this.context,a=new o("videoTrackData");a.data=i,a.dispatch(s);}onHasplayerKeySessionCreated(e){return new d("drmAuthenticationComplete").dispatch(this.context),null}onSelectSubtitles(e){if(null==e||null==this.player)return;let t=e.data;if(this.player.subtitleTracks.length>0)if(null!=t){let e=r.parseInt(t.id),i=0,s=this.player.subtitleTracks;for(;i<s.length;)if(s[i++].id==e){this.player.subtitleTrack=e;break}}else this.player.subtitleTrack=-1;else if(null!=this.video&&null!=this.video.textTracks&&this.video.textTracks.length>0)if(null!=t){let e=0,i=this.video.textTracks.length;for(;e<i;){let i=this.video.textTracks[e++];i.id==t.id?i.mode="showing":i.mode="disabled";}}else {let e=0,t=this.video.textTracks.length;for(;e<t;){this.video.textTracks[e++].mode="disabled";}}}onSelectAudio(e){if(null==e||null==this.player)return;let t=e.data;if(null!=t){let e=r.parseInt(t.id),i=0,s=this.player.audioTracks;for(;i<s.length;)if(s[i++].id==e){this.player.audioTrack=e;break}}}pause(){f.isEdge&&null!=this.unfreezeEdgeBrowserTimer||null!=this.video&&this.video.pause();}initSource(){let e=this;null!=this.media&&this.source!=this.media.source[0].url&&(this.setDefaultPlayback(),this.source=this.media.source[0].url,T.delay((function(){e.isBuffering=!0,e.dispatchEvent(e.isAdvertisement?new n("adBufferingStart"):new d("bufferingStart"));}),0));}play(){if(null!=this.video&&this.video.hasAttribute("data-mse-resetting"))this.video.addEventListener("player_reset",E(this,this.onPlayerResetWithMseExtension));else {if(this.initSource(),this.isDvr()){let e=this.getDVRWindowRange();null!=e&&(this.video.currentTime<e.start?this.seek(0):this.video.currentTime>e.end&&this.seek(e.end-e.start));}if(null!=this.video){let e=this.video.play();null!=e&&e.catch(E(this,this.onPlayPromiseError));}}}log(e,t){null==t&&(t="log"),console&&("error"==t?console.error(e):"warn"==t?console.warn(e):console.log(e));}onPlayPromiseError(e){let t=this;null==e||"NotAllowedError"!=e.name&&"AbortError"!=e.name||f.isSamsungSmartTVTizen?(this.log("BRADMAX PLAYER NOTICE:\nException occured durring starting player. Details below:\n","error"),this.log(e,"error")):(this.isPlaybackNotAllowed=!0,this.variables.autoplay?this.log("BRADMAX PLAYER NOTICE:\nBrowser doesn't allow for autoplaying video without user interaction.\nPlayer is waiting for user 'play' click. You can autoplay muted video (mute=true).\n\nMode details about browser autoplay policy: https://developers.google.com/web/updates/2017/09/autoplay-policy-changes","warn"):(this.log("BRADMAX PLAYER NOTICE:\nBrowser block starting playing video. Details below:\n","warn"),this.log(e,"warn")),21!=this.playbackState&&20!=this.playbackState&&11!=this.playbackState&&10!=this.playbackState&&T.delay((function(){t.dispatchEvent(t.isAdvertisement?new n("adPaused"):new d("paused")),t.dispatchEvent(t.isAdvertisement?new n("adBufferingEnd"):new d("bufferingEnd")),t.isBuffering=!1;}),0));}playPause(){this.isPaused()?this.play():this.pause();}setDefaultPlayback(){this.cleanPlayer(),this.initPlayer(),this.player.loadSource(this.media.source[0].url);}getPlaybackStartTime(e){let t=null;return null!=this.dvrWindowStartTimeTs&&null!=this.dvrWindowEndTimeTs&&this.dvrWindowEndTimeTs<this.getNowTs()&&(t=this.dvrWindowStartTimeTs),null!=e&&null!=e.mediaUserSettings&&null!=e.mediaUserSettings.resumePostion&&(t=e.mediaUserSettings.resumePostion),null!=this.prePlaybackSeekRelativePosition&&null!=e&&e.duration>0&&(t=this.prePlaybackSeekRelativePosition*e.duration),null!=t&&null!=this.dvrWindowStartTimeTs&&t<this.dvrWindowStartTimeTs&&(t=this.dvrWindowStartTimeTs),null!=t&&null!=this.dvrWindowEndTimeTs&&this.dvrWindowEndTimeTs<t&&(t=this.dvrWindowEndTimeTs),t}seek(e){let t=this.isPaused()&&null==this.source,i=!1,s=this;if(this.isDvr()){e=this.dvrWindowTimeToDvrRelativePlaybackTime(e);let t=this.getDVRWindowRange();if(null!=t){let s=0;null!=this.player&&null!=this.player.bufferController&&null!=this.player.bufferController.details&&this.player.bufferController.details.averagetargetduration>0&&(s=this.player.bufferController.details.averagetargetduration),e>t.end-s?e=t.end-s:e<t.start&&(e=t.start),i=e<=t.start+s;}}else e<0?(console.warn('bradmax.player.seek Warning: Trying to seek to negative position. Fallback - setting to "0" position.'),e=0):null!=this.video&&e>this.video.duration&&(console.warn("bradmax.player.seek Warning: Trying to seek to position bigger than duration of media. Fallback - setting to end position of media."),e=this.video.duration),t&&(this.media.duration>0&&(this.prePlaybackSeekRelativePosition=e/this.media.duration,this.prePlaybackHandlingSeeking=!0),this.initSource()),this.isPaused()&&!t&&T.delay((function(){s.isBuffering=!0,s.dispatchEvent(s.isAdvertisement?new n("adBufferingStart"):new d("bufferingStart"));}),0);this.video.currentTime=e,this.dispatchEvent(new d("seekingStart")),null!=this.video&&this.video.paused&&!i&&(this.play(),this.pause());}dvrWindowTimeToDvrRelativePlaybackTime(e){let t=this.getDVRWindowRange();return null==t?e:e+t.start}getDvrWindowEndTimeOffset(){let e=0;if(null!=this.dvrWindowEndTimeTs){let t=this.getDVRWindowRange();null!=t&&this.dvrWindowEndTimeTs<t.end&&(e=t.end-this.dvrWindowEndTimeTs);}return e}getDVRWindowRange(){let e=this.getDVRWindowRangeRaw();return null==e?null:(null!=this.dvrWindowStartTimeTs&&null!=this.dvrPlaybackStartTs&&this.dvrRelatibePlaybackTimeToTs(e.start)<this.dvrWindowStartTimeTs&&(e.start=this.dvrWindowStartTimeTs-this.dvrPlaybackStartTs),null!=this.dvrWindowEndTimeTs&&null!=this.dvrPlaybackStartTs&&this.dvrWindowEndTimeTs<this.dvrRelatibePlaybackTimeToTs(e.end)&&(e.end=this.dvrWindowEndTimeTs-this.dvrPlaybackStartTs),e)}dvrRelativePlaybackTimeToDvrWindowTime(e){let t=this.getDVRWindowRange();return null==t?e:e-t.start}dvrRelatibePlaybackTimeToTs(e){let t=0;return null!=this.dvrPlaybackStartTs&&(t=this.dvrPlaybackStartTs),t+e}getDVRWindowSize(){let e=this.getDVRWindowRange();return null==e?0:e.end-e.start}getNowTs(){return (new Date).getTime()/1e3}selectAudio(e){}selectSubtitles(e){}volume(e){this.video.volume=e;}canUseSystem73Plugin(){if(this.isAdvertisement||0!=this.liveStreamRestartsOnError)return !1;let e=this.plugins,t=s.exists(e,(function(e){return "System73Plugin"==e.getPluginName()}))?s.find(e,(function(e){return "System73Plugin"==e.getPluginName()})):null;return null!=t&&(!(!t.canBeUsed()||!t.hasValidConfig())&&t.hasHlsWrapper())}wrapPlayerConfigWithSystem73(e){if(!this.canUseSystem73Plugin())return;let t=this.plugins,i=s.exists(t,(function(e){return "System73Plugin"==e.getPluginName()}))?s.find(t,(function(e){return "System73Plugin"==e.getPluginName()})):null;i.wrapHls(),i.wrapHlsConfig(e);}wrapPlayerWithSystem73(e){if(!this.canUseSystem73Plugin())return;let t=this.plugins;(s.exists(t,(function(e){return "System73Plugin"==e.getPluginName()}))?s.find(t,(function(e){return "System73Plugin"==e.getPluginName()})):null).wrapHlsPlayer(e);}destroySystem73(){if(!this.canUseSystem73Plugin())return;let e=this.plugins;(s.exists(e,(function(e){return "System73Plugin"==e.getPluginName()}))?s.find(e,(function(e){return "System73Plugin"==e.getPluginName()})):null).destroyWrapper();}canUseQuanteecPlugin(){if(null==this.media||this.isAdvertisement||0!=this.liveStreamRestartsOnError)return !1;let e=this.plugins,t=s.exists(e,(function(e){return "QuanteecPlugin"==e.getPluginName()}))?s.find(e,(function(e){return "QuanteecPlugin"==e.getPluginName()})):null;return null!=t&&(!!t.hasValidConfig()&&t.hasHlsWrapper())}wrapPlayerWithQuanteec(e,t){if(!this.canUseQuanteecPlugin())return;let i=this.plugins;(s.exists(i,(function(e){return "QuanteecPlugin"==e.getPluginName()}))?s.find(i,(function(e){return "QuanteecPlugin"==e.getPluginName()})):null).wrapHlsPlayer(e,t);}updateQuanteecWrapper(e){if(!this.canUseQuanteecPlugin())return;let t=this.plugins;(s.exists(t,(function(e){return "QuanteecPlugin"==e.getPluginName()}))?s.find(t,(function(e){return "QuanteecPlugin"==e.getPluginName()})):null).updateConfigFromMedia(e);}destroyQuanteec(){if(!this.canUseQuanteecPlugin())return;let e=this.plugins;(s.exists(e,(function(e){return "QuanteecPlugin"==e.getPluginName()}))?s.find(e,(function(e){return "QuanteecPlugin"==e.getPluginName()})):null).destroyWrapper();}setData(e){this.media=e,this.hasSubtitlesAndAudioInitialized=!1,this.isHlsLiveStream=!1,this.isPlaybackNotAllowed=!1,this.isBuffering=!1,this.lastTimeUpdatePostionForEdgeBrowser=null,this.prePlaybackHandlingSeeking=!1,this.stopUnfreezeEdgeBrowserTimer(),this.stopLiveStreamRestartDelayTimer(),this.stopLiveEdgeUpdateTimer(),this.hlsQualityLevel=r.parseInt("-1"),null!=this.player&&(this.player.stopLoad(),this.player.destroy(),this.player=null),this.liveStreamRestartsOnError=0,this.dvrPlaybackStartTs=null,this.dvrRequestedInitialTimeTs=null,this.dvrWindowLength=null,Object.prototype.hasOwnProperty.call(this.variables,"dvrWindowStartTime")?(this.dvrWindowStartTimeTs=a.field(this.variables,"dvrWindowStartTime"),this.getNowTs()<this.dvrWindowStartTimeTs&&(console.warn("Warning: dvrWindowStartTime player setting was ignored, because it is starting in the future."),this.dvrWindowStartTimeTs=null),a.deleteField(this.variables,"dvrWindowStartTime")):this.dvrWindowStartTimeTs=null,Object.prototype.hasOwnProperty.call(this.variables,"dvrWindowEndTime")?(this.dvrWindowEndTimeTs=a.field(this.variables,"dvrWindowEndTime"),a.deleteField(this.variables,"dvrWindowEndTime")):this.dvrWindowEndTimeTs=null,this.updateQuanteecWrapper(e),1==this.variables.autoplay&&this.play();}playerResize(e){}videoReady(){}onDurationChange(e){}saveBandwidthModeVisibilityChange(e){e?(this.saveBandwidthModeStore={currentLevel:this.player.currentLevel,nextLevel:this.player.nextLevel,nextAutoLevel:this.player.nextAutoLevel,nextLoadLevel:this.player.nextLoadLevel,capLevelToPlayerSize:this.player.capLevelToPlayerSize},this.player.capLevelToPlayerSize=!1,this.player.nextLevel=0,this.player.nextAutoLevel=0,this.player.nextLoadLevel=0):null!=this.saveBandwidthModeStore&&(this.player.nextLevel=this.saveBandwidthModeStore.nextLevel,this.player.nextAutoLevel=this.saveBandwidthModeStore.nextAutoLevel,this.player.nextLoadLevel=this.saveBandwidthModeStore.nextLoadLevel,this.player.currentLevel=this.saveBandwidthModeStore.currentLevel,this.player.capLevelToPlayerSize=this.saveBandwidthModeStore.capLevelToPlayerSize,this.saveBandwidthModeStore=null);}static canPlay(e){return !(!f.isSamsungSmartTVTizen&&"Safari"==f.browserName)&&(!("Microsoft Internet Explorer"==f.browserName&&f.majorVersion<11)&&(null==e.drm&&(null!=e.url&&e.url.toLowerCase().indexOf(".m3u8")>1)))}static getInstance(e,t){let i=t?"ad_":"";if(Object.prototype.hasOwnProperty.call(y.instances.h,i+e))return y.instances.h[i+e];{let s=new y(t);return y.instances.h[i+e]=s,s.context=e,s.create(),s}}}e.bs.player.plugin.video.videoPlayer.VideoHlsJs=y,y.__name__="bs.player.plugin.video.videoPlayer.VideoHlsJs",Object.assign(y.prototype,{__class__:y});var f=require("bs.util.BrowserTools");class b extends Error{constructor(e,t,i){super(e),this.message=e,this.__previousException=t,this.__nativeException=null!=i?i:this;}get_native(){return this.__nativeException}static thrown(e){if(e instanceof b)return e.get_native();if(e instanceof Error)return e;return new w(e)}}b.__name__="haxe.Exception",b.__super__=Error,Object.assign(b.prototype,{__class__:b});var T=require("haxe.Timer");class w extends b{constructor(e,t,i){super(String(e),t,i),this.value=e;}}w.__name__="haxe.ValueException",w.__super__=b,Object.assign(w.prototype,{__class__:w});var P=require("haxe.ds.StringMap");class _{static getClass(e){if(null==e)return null;if(e instanceof Array)return Array;{let t=e.__class__;if(null!=t)return t;let i=_.__nativeClassName(e);return null!=i?_.__resolveNativeClass(i):null}}static __string_rec(e,t){if(null==e)return "null";if(t.length>=5)return "<...>";let i=typeof e;switch("function"==i&&(e.__name__||e.__ename__)&&(i="object"),i){case"function":return "<function>";case"object":if(e instanceof Array){let i="[";t+="\t";let s=0,a=e.length;for(;s<a;){let a=s++;i+=(a>0?",":"")+_.__string_rec(e[a],t);}return i+="]",i}let i;try{i=e.toString;}catch(e){return "???"}if(null!=i&&i!=Object.toString&&"function"==typeof i){let t=e.toString();if("[object Object]"!=t)return t}let s="{\n";t+="\t";let a=null!=e.hasOwnProperty,r=null;for(r in e)a&&!e.hasOwnProperty(r)||"prototype"!=r&&"__class__"!=r&&"__super__"!=r&&"__interfaces__"!=r&&"__properties__"!=r&&(2!=s.length&&(s+=", \n"),s+=t+r+" : "+_.__string_rec(e[r],t));return s+="\n"+(t=t.substring(1))+"}",s;case"string":return e;default:return String(e)}}static __interfLoop(e,t){for(;;){if(null==e)return !1;if(e==t)return !0;let i=e.__interfaces__;if(null!=i&&(null==e.__super__||e.__super__.__interfaces__!=i)){let e=0,s=i.length;for(;e<s;){let s=i[e++];if(s==t||_.__interfLoop(s,t))return !0}}e=e.__super__;}}static __instanceof(e,t){if(null==t)return !1;switch(t){case Array:return e instanceof Array;case x:return "boolean"==typeof e;case L:return null!=e;case A:return "number"==typeof e;case k:return "number"==typeof e&&(0|e)===e;case String:return "string"==typeof e;default:if(null==e)return !1;if("function"==typeof t){if(_.__downcastCheck(e,t))return !0}else if("object"==typeof t&&_.__isNativeObj(t)&&e instanceof t)return !0;return t==R&&null!=e.__name__||t==C&&null!=e.__ename__}}static __downcastCheck(e,t){return e instanceof t||!!t.__isInterface__&&_.__interfLoop(_.getClass(e),t)}static __cast(e,t){if(null==e||_.__instanceof(e,t))return e;throw b.thrown("Cannot cast "+r.string(e)+" to "+r.string(t))}static __nativeClassName(e){let t=_.__toStr.call(e).slice(8,-1);return "Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t}static __isNativeObj(e){return null!=_.__nativeClassName(e)}static __resolveNativeClass(e){return t[e]}}function E(e,i){return null==i?null:(null==i.__id__&&(i.__id__=t.$haxeUID++),null==e.hx__closures__?e.hx__closures__={}:s=e.hx__closures__[i.__id__],null==s&&(s=i.bind(e),e.hx__closures__[i.__id__]=s),s);var s;}_.__name__="js.Boot",t.$haxeUID|=0,Object.defineProperty(String.prototype,"__class__",{value:String,enumerable:!1,writable:!0}),String.__name__="String",Array.__name__="Array",Date.prototype.__class__=Date,Date.__name__="Date";var k={},L={},A=Number,x=Boolean,R={},C={};_.__toStr={}.toString,y.instances=new P,y.__plugfaces__="ICanPlay,INoPlayerPlugin,IVideoPlayer";}(exports,window);
!function e(t){var r,i;r=this,i=function(){function r(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,f(i.key),i);}}function i(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function n(e,t,r){return (t=f(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)({}).hasOwnProperty.call(r,i)&&(e[i]=r[i]);}return e},a.apply(null,arguments)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,h(e,t);}function l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));}catch(e){}return (l=function(){return !!e})()}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i);}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){n(e,t,r[t]);})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t));}));}return e}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}function f(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return ("string"===t?String:Number)(e)}(e,"string");return "symbol"==typeof t?t:t+""}function c(e){var t="function"==typeof Map?new Map:void 0;return c=function(e){if(null===e||!function(e){try{return -1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return "function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r);}function r(){return function(e,t,r){if(l())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,t);var n=new(e.bind.apply(e,i));return r&&h(n,r.prototype),n}(e,arguments,s(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),h(r,e)},c(e)}function g(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var v,m,p={exports:{}},y=(v||(v=1,function(e){var t=Object.prototype.hasOwnProperty,r="~";function i(){}function n(e,t,r){this.fn=e,this.context=t,this.once=r||!1;}function a(e,t,i,a,s){if("function"!=typeof i)throw new TypeError("The listener must be a function");var o=new n(i,a||e,s),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t];}function o(){this._events=new i,this._eventsCount=0;}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(r=!1)),o.prototype.eventNames=function(){var e,i,n=[];if(0===this._eventsCount)return n;for(i in e=this._events)t.call(e,i)&&n.push(r?i.slice(1):i);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},o.prototype.listeners=function(e){var t=r?r+e:e,i=this._events[t];if(!i)return [];if(i.fn)return [i.fn];for(var n=0,a=i.length,s=new Array(a);n<a;n++)s[n]=i[n].fn;return s},o.prototype.listenerCount=function(e){var t=r?r+e:e,i=this._events[t];return i?i.fn?1:i.length:0},o.prototype.emit=function(e,t,i,n,a,s){var o=r?r+e:e;if(!this._events[o])return !1;var l,u,d=this._events[o],h=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),h){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,i),!0;case 4:return d.fn.call(d.context,t,i,n),!0;case 5:return d.fn.call(d.context,t,i,n,a),!0;case 6:return d.fn.call(d.context,t,i,n,a,s),!0}for(u=1,l=new Array(h-1);u<h;u++)l[u-1]=arguments[u];d.fn.apply(d.context,l);}else {var f,c=d.length;for(u=0;u<c;u++)switch(d[u].once&&this.removeListener(e,d[u].fn,void 0,!0),h){case 1:d[u].fn.call(d[u].context);break;case 2:d[u].fn.call(d[u].context,t);break;case 3:d[u].fn.call(d[u].context,t,i);break;case 4:d[u].fn.call(d[u].context,t,i,n);break;default:if(!l)for(f=1,l=new Array(h-1);f<h;f++)l[f-1]=arguments[f];d[u].fn.apply(d[u].context,l);}}return !0},o.prototype.on=function(e,t,r){return a(this,e,t,r,!1)},o.prototype.once=function(e,t,r){return a(this,e,t,r,!0)},o.prototype.removeListener=function(e,t,i,n){var a=r?r+e:e;if(!this._events[a])return this;if(!t)return s(this,a),this;var o=this._events[a];if(o.fn)o.fn!==t||n&&!o.once||i&&o.context!==i||s(this,a);else {for(var l=0,u=[],d=o.length;l<d;l++)(o[l].fn!==t||n&&!o[l].once||i&&o[l].context!==i)&&u.push(o[l]);u.length?this._events[a]=1===u.length?u[0]:u:s(this,a);}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o;}(p)),p.exports),E=g(y),T={exports:{}},S=(m||(m=1,function(e,t){var r,i,n,a,s;r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,i=/^(?=([^\/?#]*))\1([^]*)$/,n=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,s={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var n=s.parseURL(e);if(!n)throw new Error("Error trying to parse base URL.");return n.path=s.normalizePath(n.path),s.buildURLFromParts(n)}var a=s.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return r.alwaysNormalize?(a.path=s.normalizePath(a.path),s.buildURLFromParts(a)):t;var o=s.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var l=i.exec(o.path);o.netLoc=l[1],o.path=l[2];}o.netLoc&&!o.path&&(o.path="/");var u={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(u.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var d=o.path,h=d.substring(0,d.lastIndexOf("/")+1)+a.path;u.path=s.normalizePath(h);}else u.path=o.path,a.params||(u.params=o.params,a.query||(u.query=o.query));return null===u.path&&(u.path=r.alwaysNormalize?s.normalizePath(a.path):a.path),s.buildURLFromParts(u)},parseURL:function(e){var t=r.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(n,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=s;}(T)),T.exports),A=Number.isFinite||function(e){return "number"==typeof e&&isFinite(e)},L=Number.isSafeInteger||function(e){return "number"==typeof e&&Math.abs(e)<=I},I=Number.MAX_SAFE_INTEGER||9007199254740991,R=function(e){return e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError",e}({}),k=function(e){return e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",e.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",e.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",e.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",e.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",e.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",e.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_PARSING_ERROR="levelParsingError",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",e.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.FRAG_GAP="fragGap",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.ASSET_LIST_LOAD_ERROR="assetListLoadError",e.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",e.ASSET_LIST_PARSING_ERROR="assetListParsingError",e.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",e.INTERNAL_EXCEPTION="internalException",e.INTERNAL_ABORTED="aborted",e.ATTACH_MEDIA_ERROR="attachMediaError",e.UNKNOWN="unknown",e}({}),b=function(e){return e.MEDIA_ATTACHING="hlsMediaAttaching",e.MEDIA_ATTACHED="hlsMediaAttached",e.MEDIA_DETACHING="hlsMediaDetaching",e.MEDIA_DETACHED="hlsMediaDetached",e.MEDIA_ENDED="hlsMediaEnded",e.STALL_RESOLVED="hlsStallResolved",e.BUFFER_RESET="hlsBufferReset",e.BUFFER_CODECS="hlsBufferCodecs",e.BUFFER_CREATED="hlsBufferCreated",e.BUFFER_APPENDING="hlsBufferAppending",e.BUFFER_APPENDED="hlsBufferAppended",e.BUFFER_EOS="hlsBufferEos",e.BUFFERED_TO_END="hlsBufferedToEnd",e.BUFFER_FLUSHING="hlsBufferFlushing",e.BUFFER_FLUSHED="hlsBufferFlushed",e.MANIFEST_LOADING="hlsManifestLoading",e.MANIFEST_LOADED="hlsManifestLoaded",e.MANIFEST_PARSED="hlsManifestParsed",e.LEVEL_SWITCHING="hlsLevelSwitching",e.LEVEL_SWITCHED="hlsLevelSwitched",e.LEVEL_LOADING="hlsLevelLoading",e.LEVEL_LOADED="hlsLevelLoaded",e.LEVEL_UPDATED="hlsLevelUpdated",e.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",e.LEVELS_UPDATED="hlsLevelsUpdated",e.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",e.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",e.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",e.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",e.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",e.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",e.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",e.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",e.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",e.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",e.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",e.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",e.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",e.CUES_PARSED="hlsCuesParsed",e.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",e.INIT_PTS_FOUND="hlsInitPtsFound",e.FRAG_LOADING="hlsFragLoading",e.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",e.FRAG_LOADED="hlsFragLoaded",e.FRAG_DECRYPTED="hlsFragDecrypted",e.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",e.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",e.FRAG_PARSING_METADATA="hlsFragParsingMetadata",e.FRAG_PARSED="hlsFragParsed",e.FRAG_BUFFERED="hlsFragBuffered",e.FRAG_CHANGED="hlsFragChanged",e.FPS_DROP="hlsFpsDrop",e.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",e.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",e.ERROR="hlsError",e.DESTROYING="hlsDestroying",e.KEY_LOADING="hlsKeyLoading",e.KEY_LOADED="hlsKeyLoaded",e.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",e.BACK_BUFFER_REACHED="hlsBackBufferReached",e.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",e.ASSET_LIST_LOADING="hlsAssetListLoading",e.ASSET_LIST_LOADED="hlsAssetListLoaded",e.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",e.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",e.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",e.INTERSTITIAL_STARTED="hlsInterstitialStarted",e.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",e.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",e.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",e.INTERSTITIAL_ENDED="hlsInterstitialEnded",e.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",e.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",e.EVENT_CUE_ENTER="hlsEventCueEnter",e}({}),D="manifest",_="level",P="audioTrack",C="subtitleTrack",w="main",O="audio",x="subtitle",M=function(){function e(e,t,r){void 0===t&&(t=0),void 0===r&&(r=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=r;}var t=e.prototype;return t.sample=function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e;},t.getTotalWeight=function(){return this.totalWeight_},t.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_},e}(),F=function(){function e(e,t,r,i){void 0===i&&(i=100),this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new M(e),this.fast_=new M(t),this.defaultTTFB_=i,this.ttfb_=new M(e);}var t=e.prototype;return t.update=function(e,t){var r=this.slow_,i=this.fast_,n=this.ttfb_;r.halfLife!==e&&(this.slow_=new M(e,r.getEstimate(),r.getTotalWeight())),i.halfLife!==t&&(this.fast_=new M(t,i.getEstimate(),i.getTotalWeight())),n.halfLife!==e&&(this.ttfb_=new M(e,n.getEstimate(),n.getTotalWeight()));},t.sample=function(e,t){var r=(e=Math.max(e,this.minDelayMs_))/1e3,i=8*t/r;this.fast_.sample(r,i),this.slow_.sample(r,i);},t.sampleTTFB=function(e){var t=e/1e3,r=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(r,Math.max(e,5));},t.canEstimate=function(){return this.fast_.getTotalWeight()>=this.minWeight_},t.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.getEstimateTTFB=function(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_},t.destroy=function(){},i(e,[{key:"defaultEstimate",get:function(){return this.defaultEstimate_}}])}(),N=function(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;var r="["+e+"]:";this.trace=U,this.debug=t.debug.bind(null,r),this.log=t.log.bind(null,r),this.warn=t.warn.bind(null,r),this.info=t.info.bind(null,r),this.error=t.error.bind(null,r);},U=function(){},B={trace:U,debug:U,log:U,warn:U,info:U,error:U};function G(){return a({},B)}function K(e,t,r){return t[e]?t[e].bind(t):function(e,t){var r=self.console[e];return r?r.bind(self.console,(t?"["+t+"] ":"")+"["+e+"] >"):U}(e,r)}var V=G();function H(e,t,r){var i=G();if("object"==typeof console&&!0===e||"object"==typeof e){var n=["debug","log","info","warn","error"];n.forEach((function(t){i[t]=K(t,e,r);}));try{i.log('Debug logs enabled for "'+t+'" in hls.js version 1.6.14');}catch(e){return G()}n.forEach((function(t){V[t]=K(t,e);}));}else a(V,i);return i}var Y=V;function W(e){if(void 0===e&&(e=!0),"undefined"!=typeof self)return (e||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function j(e,t){var r=Object.keys(e),i=Object.keys(t),n=r.length,a=i.length;return !n||!a||n===a&&!r.some((function(e){return -1===i.indexOf(e)}))}function q(e,t){if(void 0===t&&(t=!1),"undefined"!=typeof TextDecoder){var r=new TextDecoder("utf-8").decode(e);if(t){var i=r.indexOf("\0");return -1!==i?r.substring(0,i):r}return r.replace(/\0/g,"")}for(var n,a,s,o=e.length,l="",u=0;u<o;){if(0===(n=e[u++])&&t)return l;if(0!==n&&3!==n)switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:l+=String.fromCharCode(n);break;case 12:case 13:a=e[u++],l+=String.fromCharCode((31&n)<<6|63&a);break;case 14:a=e[u++],s=e[u++],l+=String.fromCharCode((15&n)<<12|(63&a)<<6|(63&s)<<0);}}return l}function X(e){for(var t="",r=0;r<e.length;r++){var i=e[r].toString(16);i.length<2&&(i="0"+i),t+=i;}return t}function Q(e){return Uint8Array.from(e.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}var z=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0};},$="audio",Z="video",J="audiovideo",ee=function(){function e(e){var t,r,i;this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,"string"==typeof e&&(e={url:e}),this.base=e,(i=ne(t=this,r="stats"))&&(i.enumerable=!0,Object.defineProperty(t,r,i));}var t=e.prototype;return t.setByteRange=function(e,t){var r,i=e.split("@",2);r=1===i.length?(null==t?void 0:t.byteRangeEndOffset)||0:parseInt(i[1]),this._byteRange=[r,parseInt(i[0])+r];},t.clearElementaryStreamInfo=function(){var e=this.elementaryStreams;e[$]=null,e[Z]=null,e[J]=null;},i(e,[{key:"baseurl",get:function(){return this.base.url}},{key:"byteRange",get:function(){return null===this._byteRange?[]:this._byteRange}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"elementaryStreams",get:function(){var e;return null===this._streams&&(this._streams=((e={})[$]=null,e[Z]=null,e[J]=null,e)),this._streams},set:function(e){this._streams=e;}},{key:"hasStats",get:function(){return null!==this._stats}},{key:"hasStreams",get:function(){return null!==this._streams}},{key:"stats",get:function(){return null===this._stats&&(this._stats=new z),this._stats},set:function(e){this._stats=e;}},{key:"url",get:function(){return !this._url&&this.baseurl&&this.relurl&&(this._url=S.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(e){this._url=e;}}])}();function te(e){return "initSegment"!==e.sn}var re=function(e){function t(t,r){var i;return (i=e.call(this,r)||this)._decryptdata=null,i._programDateTime=null,i._ref=null,i._bitrate=void 0,i.rawProgramDateTime=null,i.tagList=[],i.duration=0,i.sn=0,i.levelkeys=void 0,i.type=void 0,i.loader=null,i.keyLoader=null,i.level=-1,i.cc=0,i.startPTS=void 0,i.endPTS=void 0,i.startDTS=void 0,i.endDTS=void 0,i.start=0,i.playlistOffset=0,i.deltaPTS=void 0,i.maxStartPTS=void 0,i.minEndPTS=void 0,i.data=void 0,i.bitrateTest=!1,i.title=null,i.initSegment=null,i.endList=void 0,i.gap=void 0,i.urlId=0,i.type=t,i}o(t,e);var r=t.prototype;return r.addStart=function(e){this.setStart(this.start+e);},r.setStart=function(e){this.start=e,this._ref&&(this._ref.start=e);},r.setDuration=function(e){this.duration=e,this._ref&&(this._ref.duration=e);},r.setKeyFormat=function(e){var t=this.levelkeys;if(t){var r,i=t[e];!i||null!=(r=this._decryptdata)&&r.keyId||(this._decryptdata=i.getDecryptData(this.sn,t));}},r.abortRequests=function(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort();},r.setElementaryStreamInfo=function(e,t,r,i,n,a){void 0===a&&(a=!1);var s=this.elementaryStreams,o=s[e];o?(o.startPTS=Math.min(o.startPTS,t),o.endPTS=Math.max(o.endPTS,r),o.startDTS=Math.min(o.startDTS,i),o.endDTS=Math.max(o.endDTS,n)):s[e]={startPTS:t,endPTS:r,startDTS:i,endDTS:n,partial:a};},i(t,[{key:"byteLength",get:function(){if(this.hasStats){var e=this.stats.total;if(e)return e}if(this.byteRange.length){var t=this.byteRange[0],r=this.byteRange[1];if(A(t)&&A(r))return r-t}return null}},{key:"bitrate",get:function(){return this.byteLength?8*this.byteLength/this.duration:this._bitrate?this._bitrate:null},set:function(e){this._bitrate=e;}},{key:"decryptdata",get:function(){var e,t=this.levelkeys;if(!t||t.NONE)return null;if(t.identity)this._decryptdata||(this._decryptdata=t.identity.getDecryptData(this.sn));else if(null==(e=this._decryptdata)||!e.keyId){var r=Object.keys(t);if(1===r.length){var i=this._decryptdata=t[r[0]]||null;i&&(this._decryptdata=i.getDecryptData(this.sn,t));}}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;var e=A(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return !0;if(this.levelkeys){var t,r=Object.keys(this.levelkeys),i=r.length;if(i>1||1===i&&null!=(t=this.levelkeys[r[0]])&&t.encrypted)return !0}return !1}},{key:"programDateTime",get:function(){return null===this._programDateTime&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime},set:function(e){A(e)?this._programDateTime=e:this._programDateTime=this.rawProgramDateTime=null;}},{key:"ref",get:function(){return te(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}}])}(ee),ie=function(e){function t(t,r,i,n,a){var s;(s=e.call(this,i)||this).fragOffset=0,s.duration=0,s.gap=!1,s.independent=!1,s.relurl=void 0,s.fragment=void 0,s.index=void 0,s.duration=t.decimalFloatingPoint("DURATION"),s.gap=t.bool("GAP"),s.independent=t.bool("INDEPENDENT"),s.relurl=t.enumeratedString("URI"),s.fragment=r,s.index=n;var o=t.enumeratedString("BYTERANGE");return o&&s.setByteRange(o,a),a&&(s.fragOffset=a.fragOffset+a.duration),s}return o(t,e),i(t,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var e=this.elementaryStreams;return !!(e.audio||e.video||e.audiovideo)}}])}(ee);function ne(e,t){var r=Object.getPrototypeOf(e);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i||ne(r,t)}}var ae=Math.pow(2,32)-1,se=[].push,oe={video:1,audio:2,id3:3,text:4};function le(e){return String.fromCharCode.apply(null,e)}function ue(e,t){var r=e[t]<<8|e[t+1];return r<0?65536+r:r}function de(e,t){var r=fe(e,t);return r<0?4294967296+r:r}function he(e,t){var r=de(e,t);return r*=Math.pow(2,32),r+=de(e,t+4)}function fe(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function ce(e,t){var r=[];if(!t.length)return r;for(var i=e.byteLength,n=0;n<i;){var a=de(e,n),s=a>1?n+a:i;if(le(e.subarray(n+4,n+8))===t[0])if(1===t.length)r.push(e.subarray(n+8,s));else {var o=ce(e.subarray(n+8,s),t.slice(1));o.length&&se.apply(r,o);}n=s;}return r}function ge(e){var t=[],r=e[0],i=8,n=de(e,i);i+=4;var a=0,s=0;0===r?(a=de(e,i),s=de(e,i+4),i+=8):(a=he(e,i),s=he(e,i+8),i+=16),i+=2;var o=e.length+s,l=ue(e,i);i+=2;for(var u=0;u<l;u++){var d=i,h=de(e,d);d+=4;var f=2147483647&h;if(1==(2147483648&h)>>>31)return Y.warn("SIDX has hierarchical references (not supported)"),null;var c=de(e,d);d+=4,t.push({referenceSize:f,subsegmentDuration:c,info:{duration:c/n,start:o,end:o+f-1}}),o+=f,i=d+=4;}return {earliestPresentationTime:a,timescale:n,version:r,referencesCount:l,references:t}}function ve(e){for(var t=[],r=ce(e,["moov","trak"]),i=0;i<r.length;i++){var n=r[i],a=ce(n,["tkhd"])[0];if(a){var s=a[0],o=de(a,0===s?12:20),l=ce(n,["mdia","mdhd"])[0];if(l){var u=de(l,0===(s=l[0])?12:20),h=ce(n,["mdia","hdlr"])[0];if(h){var f=le(h.subarray(8,12)),c={soun:$,vide:Z}[f],g=me(ce(n,["mdia","minf","stbl","stsd"])[0]);c?(t[o]={timescale:u,type:c,stsd:g},t[c]=d({timescale:u,id:o},g)):t[o]={timescale:u,type:f,stsd:g};}}}}return ce(e,["moov","mvex","trex"]).forEach((function(e){var r=de(e,4),i=t[r];i&&(i.default={duration:de(e,12),flags:de(e,20)});})),t}function me(e){var t,r=e.subarray(8),i=r.subarray(86),n=le(r.subarray(4,8)),a=n,s="enca"===n||"encv"===n;if(s){var o=ce(r,[n])[0];ce(o.subarray("enca"===n?28:78),["sinf"]).forEach((function(e){var t=ce(e,["schm"])[0];if(t){var r=le(t.subarray(4,8));if("cbcs"===r||"cenc"===r){var i=ce(e,["frma"])[0];i&&(a=le(i));}}}));}var l=a;switch(a){case"avc1":case"avc2":case"avc3":case"avc4":var u=ce(i,["avcC"])[0];u&&u.length>3&&(a+="."+Ee(u[1])+Ee(u[2])+Ee(u[3]),t=pe("avc1"===l?"dva1":"dvav",i));break;case"mp4a":var d=ce(r,[n])[0],h=ce(d.subarray(28),["esds"])[0];if(h&&h.length>7){var f=4;if(3!==h[f++])break;f=ye(h,f),f+=2;var c=h[f++];if(128&c&&(f+=2),64&c&&(f+=h[f++]),4!==h[f++])break;f=ye(h,f);var g=h[f++];if(64!==g)break;if(a+="."+Ee(g),f+=12,5!==h[f++])break;f=ye(h,f);var v=h[f++],m=(248&v)>>3;31===m&&(m+=1+((7&v)<<3)+((224&h[f])>>5)),a+="."+m;}break;case"hvc1":case"hev1":var p=ce(i,["hvcC"])[0];if(p&&p.length>12){var y=p[1],E=["","A","B","C"][y>>6],T=31&y,S=de(p,2),A=(32&y)>>5?"H":"L",L=p[12],I=p.subarray(6,12);a+="."+E+T,a+="."+function(e){for(var t=0,r=0;r<32;r++)t|=(e>>r&1)<<31-r;return t>>>0}(S).toString(16).toUpperCase(),a+="."+A+L;for(var R="",k=I.length;k--;){var b=I[k];(b||R)&&(R="."+b.toString(16).toUpperCase()+R);}a+=R;}t=pe("hev1"==l?"dvhe":"dvh1",i);break;case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":a=pe(a,i)||a;break;case"vp09":var D=ce(i,["vpcC"])[0];if(D&&D.length>6){var _=D[4],P=D[5],C=D[6]>>4&15;a+="."+Te(_)+"."+Te(P)+"."+Te(C);}break;case"av01":var w=ce(i,["av1C"])[0];if(w&&w.length>2){var O=w[1]>>>5,x=31&w[1],M=w[2]>>>7?"H":"M",F=(64&w[2])>>6,N=(32&w[2])>>5,U=2===O&&F?N?12:10:F?10:8,B=(16&w[2])>>4,G=(8&w[2])>>3,K=(4&w[2])>>2,V=3&w[2];a+="."+O+"."+Te(x)+M+"."+Te(U)+"."+B+"."+G+K+V+"."+Te(1)+"."+Te(1)+"."+Te(1)+".0",t=pe("dav1",i);}}return {codec:a,encrypted:s,supplemental:t}}function pe(e,t){var r=ce(t,["dvvC"]),i=r.length?r[0]:ce(t,["dvcC"])[0];if(i){var n=i[2]>>1&127,a=i[2]<<5&32|i[3]>>3&31;return e+"."+Te(n)+"."+Te(a)}}function ye(e,t){for(var r=t+5;128&e[t++]&&t<r;);return t}function Ee(e){return ("0"+e.toString(16).toUpperCase()).slice(-2)}function Te(e){return (e<10?"0":"")+e}function Se(e,t){ce(e,["moov","trak"]).forEach((function(e){var r=ce(e,["mdia","minf","stbl","stsd"])[0];if(r){var i=r.subarray(8),n=ce(i,["enca"]),a=n.length>0;a||(n=ce(i,["encv"])),n.forEach((function(e){ce(a?e.subarray(28):e.subarray(78),["sinf"]).forEach((function(e){var r=Ae(e);r&&t(r,a);}));}));}}));}function Ae(e){var t=ce(e,["schm"])[0];if(t){var r=le(t.subarray(4,8));if("cbcs"===r||"cenc"===r){var i=ce(e,["schi","tenc"])[0];if(i)return i}}}function Le(e,t){var r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function Ie(e,t){var r=[],i=t.samples,n=t.timescale,a=t.id,s=!1;return ce(i,["moof"]).map((function(o){var l=o.byteOffset-8;ce(o,["traf"]).map((function(o){var u=ce(o,["tfdt"]).map((function(e){var t=e[0],r=de(e,4);return 1===t&&(r*=Math.pow(2,32),r+=de(e,8)),r/n}))[0];return void 0!==u&&(e=u),ce(o,["tfhd"]).map((function(u){var d=de(u,4),h=16777215&de(u,0),f=0,c=0!=(16&h),g=0,v=0!=(32&h),m=8;d===a&&(0!=(1&h)&&(m+=8),0!=(2&h)&&(m+=4),0!=(8&h)&&(f=de(u,m),m+=4),c&&(g=de(u,m),m+=4),v&&(m+=4),"video"===t.type&&(s=Re(t.codec)),ce(o,["trun"]).map((function(a){var o=a[0],u=16777215&de(a,0),d=0!=(1&u),h=0,c=0!=(4&u),v=0!=(256&u),m=0,p=0!=(512&u),y=0,E=0!=(1024&u),T=0!=(2048&u),S=0,A=de(a,4),L=8;d&&(h=de(a,L),L+=4),c&&(L+=4);for(var I=h+l,R=0;R<A;R++){if(v?(m=de(a,L),L+=4):m=f,p?(y=de(a,L),L+=4):y=g,E&&(L+=4),T&&(S=0===o?de(a,L):fe(a,L),L+=4),t.type===Z)for(var k=0;k<y;){var b=de(i,I);ke(s,i[I+=4])&&be(i.subarray(I,I+b),s?2:1,e+S/n,r),I+=b,k+=b+4;}e+=m/n;}})));}))}));})),r}function Re(e){if(!e)return !1;var t=e.substring(0,4);return "hvc1"===t||"hev1"===t||"dvh1"===t||"dvhe"===t}function ke(e,t){if(e){var r=t>>1&63;return 39===r||40===r}return 6==(31&t)}function be(e,t,r,i){var n=De(e),a=0;a+=t;for(var s=0,o=0,l=0;a<n.length;){s=0;do{if(a>=n.length)break;s+=l=n[a++];}while(255===l);o=0;do{if(a>=n.length)break;o+=l=n[a++];}while(255===l);var u=n.length-a,d=a;if(o<u)a+=o;else if(o>u){Y.error("Malformed SEI payload. "+o+" is too small, only "+u+" bytes left to parse.");break}if(4===s){if(181===n[d++]){var h=ue(n,d);if(d+=2,49===h){var f=de(n,d);if(d+=4,1195456820===f){var c=n[d++];if(3===c){var g=n[d++],v=64&g,m=v?2+3*(31&g):0,p=new Uint8Array(m);if(v){p[0]=g;for(var y=1;y<m;y++)p[y]=n[d++];}i.push({type:c,payloadType:s,pts:r,bytes:p});}}}}}else if(5===s&&o>16){for(var E=[],T=0;T<16;T++){var S=n[d++].toString(16);E.push(1==S.length?"0"+S:S),3!==T&&5!==T&&7!==T&&9!==T||E.push("-");}for(var A=o-16,L=new Uint8Array(A),I=0;I<A;I++)L[I]=n[d++];i.push({payloadType:s,pts:r,uuid:E.join(""),userData:q(L),userDataBytes:L});}}}function De(e){for(var t=e.byteLength,r=[],i=1;i<t-2;)0===e[i]&&0===e[i+1]&&3===e[i+2]?(r.push(i+2),i+=2):i++;if(0===r.length)return e;var n=t-r.length,a=new Uint8Array(n),s=0;for(i=0;i<n;s++,i++)s===r[0]&&(s++,r.shift()),a[i]=e[s];return a}function _e(e,t,r){if(16!==e.byteLength)throw new RangeError("Invalid system id");var i,n;i=new Uint8Array,n=new Uint8Array;var a=new Uint8Array(4);return r.byteLength>0&&new DataView(a.buffer).setUint32(0,r.byteLength,!1),function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];for(var n=r.length,a=8,s=n;s--;)a+=r[s].byteLength;var o=new Uint8Array(a);for(o[0]=a>>24&255,o[1]=a>>16&255,o[2]=a>>8&255,o[3]=255&a,o.set(e,4),s=0,a=8;s<n;s++)o.set(r[s],a),a+=r[s].byteLength;return o}([112,115,115,104],new Uint8Array([0,0,0,0]),e,n,i,a,r)}function Pe(e){var t=e.getUint32(0),r=e.byteOffset,i=e.byteLength;if(i<t)return {offset:r,size:i};if(1886614376!==e.getUint32(4))return {offset:r,size:t};var n=e.getUint32(8)>>>24;if(0!==n&&1!==n)return {offset:r,size:t};var a=e.buffer,s=X(new Uint8Array(a,r+12,16)),o=null,l=0;if(0===n)l=28;else {var u=e.getUint32(28);if(!u||i<32+16*u)return {offset:r,size:t};o=[];for(var d=0;d<u;d++)o.push(new Uint8Array(a,r+32+16*d,16));l=32+16*u;}if(!l)return {offset:r,size:t};var h=e.getUint32(l);return t-32<h?{offset:r,size:t}:{version:n,systemId:s,kids:o,data:new Uint8Array(a,r+l+4,h),offset:r,size:t}}var Ce=function(){return /\(Windows.+Firefox\//i.test(navigator.userAgent)},we={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Oe(e,t){var r=we[t];return !!r&&!!r[e.slice(0,4)]}function xe(e,t,r){return void 0===r&&(r=!0),!e.split(",").some((function(e){return !Me(e,t,r)}))}function Me(e,t,r){var i;void 0===r&&(r=!0);var n=W(r);return null!=(i=null==n?void 0:n.isTypeSupported(Fe(e,t)))&&i}function Fe(e,t){return t+"/mp4;codecs="+e}function Ne(e){if(e){var t=e.substring(0,4);return we.video[t]}return 2}function Ue(e){var t=Ce();return e.split(",").reduce((function(e,r){var i=t&&Re(r)?9:we.video[r];return i?(2*i+e)/(e?3:2):(we.audio[r]+e)/(e?2:1)}),0)}var Be={},Ge=/flac|opus|mp4a\.40\.34/i;function Ke(e,t){return void 0===t&&(t=!0),e.replace(Ge,(function(e){return function(e,t){if(void 0===t&&(t=!0),Be[e])return Be[e];for(var r={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[e],i=0;i<r.length;i++){var n;if(Me(r[i],"audio",t))return Be[e]=r[i],r[i];if("mp3"===r[i]&&null!=(n=W(t))&&n.isTypeSupported("audio/mpeg"))return ""}return e}(e.toLowerCase(),t)}))}function Ve(e,t){if(e&&(e.length>4||-1!==["ac-3","ec-3","alac","fLaC","Opus"].indexOf(e))&&(He(e,"audio")||He(e,"video")))return e;if(t){var r=t.split(",");if(r.length>1){if(e)for(var i=r.length;i--;)if(r[i].substring(0,4)===e.substring(0,4))return r[i];return r[0]}}return t||e}function He(e,t){return Oe(e,t)&&Me(e,t)}function Ye(e){if(e.startsWith("av01.")){for(var t=e.split("."),r=["0","111","01","01","01","0"],i=t.length;i>4&&i<10;i++)t[i]=r[i-4];return t.join(".")}return e}function We(e){var t=W(e)||{isTypeSupported:function(){return !1}};return {mpeg:t.isTypeSupported("audio/mpeg"),mp3:t.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:t.isTypeSupported('audio/mp4; codecs="ac-3"')}}function je(e){return e.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}var qe={supported:!1,smooth:!1,powerEfficient:!1},Xe={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function Qe(e,t){return {supported:!1,configurations:t,decodingInfoResults:[qe],error:e}}function ze(e,t,r,i){void 0===i&&(i={});var n=e.videoCodec;if(!n&&!e.audioCodec||!r)return Promise.resolve(Xe);for(var a=[],s=function(e){var t,r=null==(t=e.videoCodec)?void 0:t.split(","),i=Ze(e),n=e.width||640,a=e.height||480,s=e.frameRate||30,o=e.videoRange.toLowerCase();return r?r.map((function(e){var t={contentType:Fe(Ye(e),"video"),width:n,height:a,bitrate:i,framerate:s};return "sdr"!==o&&(t.transferFunction=o),t})):[]}(e),o=s.length,l=function(e,t,r){var i,n=null==(i=e.audioCodec)?void 0:i.split(","),a=Ze(e);return n&&e.audioGroups?e.audioGroups.reduce((function(e,i){var s,o=i?null==(s=t.groups[i])?void 0:s.tracks:null;return o?o.reduce((function(e,t){if(t.groupId===i){var s=parseFloat(t.channels||"");n.forEach((function(t){var i={contentType:Fe(t,"audio"),bitrate:r?$e(t,a):a};s&&(i.channels=""+s),e.push(i);}));}return e}),e):e}),[]):[]}(e,t,o>0),u=l.length,d=o||1*u||1;d--;){var h={type:"media-source"};if(o&&(h.video=s[d%o]),u){h.audio=l[d%u];var f=h.audio.bitrate;h.video&&f&&(h.video.bitrate-=f);}a.push(h);}if(n){var c=navigator.userAgent;if(n.split(",").some((function(e){return Re(e)}))&&Ce())return Promise.resolve(Qe(new Error("Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: ("+c+")"),a))}return Promise.all(a.map((function(e){var t,n,a,s,o=(n="",a=(t=e).audio,(s=t.video)&&(n+=je(s.contentType)+"_r"+s.height+"x"+s.width+"f"+Math.ceil(s.framerate)+(s.transferFunction||"sd")+"_"+Math.ceil(s.bitrate/1e5)),a&&(n+=(s?"_":"")+je(a.contentType)+"_c"+a.channels),n);return i[o]||(i[o]=r.decodingInfo(e))}))).then((function(e){return {supported:!e.some((function(e){return !e.supported})),configurations:a,decodingInfoResults:e}})).catch((function(e){return {supported:!1,configurations:a,decodingInfoResults:[],error:e}}))}function $e(e,t){if(t<=1)return 1;var r=128e3;return "ec-3"===e?r=768e3:"ac-3"===e&&(r=64e4),Math.min(t/2,r)}function Ze(e){return 1e3*Math.ceil(Math.max(.9*e.bitrate,e.averageBitrate)/1e3)||1}var Je=["NONE","TYPE-0","TYPE-1",null],et=["SDR","PQ","HLG"],tt="",rt="YES",it="v2";function nt(e){var t=e.canSkipUntil,r=e.canSkipDateRanges,i=e.age;return t&&i<t/2?r?it:rt:tt}var at=function(){function e(e,t,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=r;}return e.prototype.addDirectives=function(e){var t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href},e}(),st=function(){function e(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter((function(e){return !!e})).map((function(e){return e.substring(0,4)})).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;var r=null==(t=e.supplemental)?void 0:t.videoCodec;r&&r!==e.videoCodec&&(this.codecSet+=","+r.substring(0,4));}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES);}var t=e.prototype;return t.hasAudioGroup=function(e){return ot(this._audioGroups,e)},t.hasSubtitleGroup=function(e){return ot(this._subtitleGroups,e)},t.addGroupId=function(e,t){if(t)if("audio"===e){var r=this._audioGroups;r||(r=this._audioGroups=[]),-1===r.indexOf(t)&&r.push(t);}else if("text"===e){var i=this._subtitleGroups;i||(i=this._subtitleGroups=[]),-1===i.indexOf(t)&&i.push(t);}},t.addFallback=function(){},i(e,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"averageBitrate",get:function(){return this._avgBitrate||this.realBitrate||this.bitrate}},{key:"attrs",get:function(){return this._attrs[0]}},{key:"codecs",get:function(){return this.attrs.CODECS||""}},{key:"pathwayId",get:function(){return this.attrs["PATHWAY-ID"]||"."}},{key:"videoRange",get:function(){return this.attrs["VIDEO-RANGE"]||"SDR"}},{key:"score",get:function(){return this.attrs.optionalFloat("SCORE",0)}},{key:"uri",get:function(){return this.url[0]||""}},{key:"audioGroups",get:function(){return this._audioGroups}},{key:"subtitleGroups",get:function(){return this._subtitleGroups}},{key:"urlId",get:function(){return 0},set:function(e){}},{key:"audioGroupIds",get:function(){return this.audioGroups?[this.audioGroupId]:void 0}},{key:"textGroupIds",get:function(){return this.subtitleGroups?[this.textGroupId]:void 0}},{key:"audioGroupId",get:function(){var e;return null==(e=this.audioGroups)?void 0:e[0]}},{key:"textGroupId",get:function(){var e;return null==(e=this.subtitleGroups)?void 0:e[0]}}])}();function ot(e,t){return !(!t||!e)&&-1!==e.indexOf(t)}function lt(e,t){var r=!1,i=[];if(e&&(r="SDR"!==e,i=[e]),t){var n="SDR"!==(i=t.allowedVideoRanges||et.slice(0)).join("")&&!t.videoCodec;(r=void 0!==t.preferHDR?t.preferHDR:n&&function(){if("function"==typeof matchMedia){var e=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(e.media!==t.media)return !0===e.matches}return !1}())||(i=["SDR"]);}return {preferHDR:r,allowedVideoRanges:i}}var ut=function(e,t){return JSON.stringify(e,function(e){var t=new WeakSet;return function(r,i){if(e&&(i=e(r,i)),"object"==typeof i&&null!==i){if(t.has(i))return;t.add(i);}return i}}(t))};function dt(e,t){Y.log('[abr] start candidates with "'+e+'" ignored because '+t);}function ht(e){return e.reduce((function(e,t){var r=e.groups[t.groupId];r||(r=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),r.tracks.push(t);var i=t.channels||"2";return r.channels[i]=(r.channels[i]||0)+1,r.hasDefault=r.hasDefault||t.default,r.hasAutoSelect=r.hasAutoSelect||t.autoselect,r.hasDefault&&(e.hasDefaultAudio=!0),r.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e}),{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function ft(e){if(!e)return e;var t=e;return {lang:t.lang,assocLang:t.assocLang,characteristics:t.characteristics,channels:t.channels,audioCodec:t.audioCodec}}function ct(e,t,r){if("attrs"in e){var i=t.indexOf(e);if(-1!==i)return i}for(var n=0;n<t.length;n++)if(gt(e,t[n],r))return n;return -1}function gt(e,t,r){var i,n,a=e.groupId,s=e.name,o=e.lang,l=e.assocLang,u=e.default,d=e.forced;return (void 0===a||t.groupId===a)&&(void 0===s||t.name===s)&&(void 0===o||(i=o,void 0===(n=t.lang)&&(n="--"),i.length===n.length?i===n:i.startsWith(n)||n.startsWith(i)))&&(void 0===o||t.assocLang===l)&&(void 0===u||t.default===u)&&(void 0===d||t.forced===d)&&(!("characteristics"in e)||function(e,t){void 0===t&&(t="");var r=e.split(","),i=t.split(",");return r.length===i.length&&!r.some((function(e){return -1===i.indexOf(e)}))}(e.characteristics||"",t.characteristics))&&(void 0===r||r(e,t))}function vt(e,t){var r=e.audioCodec,i=e.channels;return !(void 0!==r&&(t.audioCodec||"").substring(0,4)!==r.substring(0,4)||void 0!==i&&i!==(t.channels||"2"))}function mt(e,t,r){for(var i=t;i>-1;i--)if(r(e[i]))return i;for(var n=t+1;n<e.length;n++)if(r(e[n]))return n;return -1}function pt(e,t){var r;return !!e&&e!==(null==(r=t.loadLevelObj)?void 0:r.uri)}var yt=function(e){function t(t){var r;return (r=e.call(this,"abr",t.logger)||this).hls=void 0,r.lastLevelLoadSec=0,r.lastLoadedFragLevel=-1,r.firstSelection=-1,r._nextAutoLevel=-1,r.nextAutoLevelKey="",r.audioTracksByGroup=null,r.codecTiers=null,r.timer=-1,r.fragCurrent=null,r.partCurrent=null,r.bitrateTestDelay=0,r.rebufferNotice=-1,r.supportedCache={},r.bwEstimator=void 0,r._abandonRulesCheck=function(e){var t,i=r,n=i.fragCurrent,a=i.partCurrent,s=i.hls,o=s.autoLevelEnabled,l=s.media;if(n&&l){var u=performance.now(),d=a?a.stats:n.stats,h=a?a.duration:n.duration,f=u-d.loading.start,c=s.minAutoLevel,g=n.level,v=r._nextAutoLevel;if(d.aborted||d.loaded&&d.loaded===d.total||g<=c)return r.clearTimer(),void(r._nextAutoLevel=-1);if(o){var m=v>-1&&v!==g,p=!!e||m;if(p||!l.paused&&l.playbackRate&&l.readyState){var y=s.mainForwardBufferInfo;if(p||null!==y){var E=r.bwEstimator.getEstimateTTFB(),T=Math.abs(l.playbackRate);if(!(f<=Math.max(E,h/(2*T)*1e3))){var S=y?y.len/T:0,L=d.loading.first?d.loading.first-d.loading.start:-1,I=d.loaded&&L>-1,R=r.getBwEstimate(),k=s.levels,D=k[g],_=Math.max(d.loaded,Math.round(h*(n.bitrate||D.averageBitrate)/8)),P=I?f-L:f;P<1&&I&&(P=Math.min(f,8*d.loaded/R));var C=I?1e3*d.loaded/P:0,w=E/1e3,O=C?(_-d.loaded)/C:8*_/R+w;if(!(O<=S)){var x,M=C?8*C:R,F=!0===(null==(t=(null==e?void 0:e.details)||r.hls.latestLevelDetails)?void 0:t.live),N=r.hls.config.abrBandWidthUpFactor,U=Number.POSITIVE_INFINITY;for(x=g-1;x>c;x--){var B=k[x].maxBitrate,G=!k[x].details||F;if((U=r.getTimeToLoadFrag(w,M,h*B,G))<Math.min(S,h+w))break}if(!(U>=O||U>10*h)){I?r.bwEstimator.sample(f-Math.min(E,L),d.loaded):r.bwEstimator.sampleTTFB(f);var K=k[x].maxBitrate;r.getBwEstimate()*N>K&&r.resetEstimator(K);var V=r.findBestLevel(K,c,x,0,S,1,1);V>-1&&(x=V),r.warn("Fragment "+n.sn+(a?" part "+a.index:"")+" of level "+g+" is loading too slowly;\n      Fragment duration: "+n.duration.toFixed(3)+"\n      Time to underbuffer: "+S.toFixed(3)+" s\n      Estimated load time for current fragment: "+O.toFixed(3)+" s\n      Estimated load time for down switch fragment: "+U.toFixed(3)+" s\n      TTFB estimate: "+(0|L)+" ms\n      Current BW estimate: "+(A(R)?0|R:"Unknown")+" bps\n      New BW estimate: "+(0|r.getBwEstimate())+" bps\n      Switching to level "+x+" @ "+(0|K)+" bps"),s.nextLoadLevel=s.nextAutoLevel=x,r.clearTimer();var H=function(){if(r.clearTimer(),r.fragCurrent===n&&r.hls.loadLevel===x&&x>0){var e=r.getStarvationDelay();if(r.warn("Aborting inflight request "+(x>0?"and switching down":"")+"\n      Fragment duration: "+n.duration.toFixed(3)+" s\n      Time to underbuffer: "+e.toFixed(3)+" s"),n.abortRequests(),r.fragCurrent=r.partCurrent=null,x>c){var t=r.findBestLevel(r.hls.levels[c].bitrate,c,x,0,e,1,1);-1===t&&(t=c),r.hls.nextLoadLevel=r.hls.nextAutoLevel=t,r.resetEstimator(r.hls.levels[t].bitrate);}}};m||O>2*U?H():r.timer=self.setInterval(H,1e3*U),s.trigger(b.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,part:a,stats:d});}}}}}}}},r.hls=t,r.bwEstimator=r.initEstimator(),r.registerListeners(),r}o(t,e);var r=t.prototype;return r.resetEstimator=function(e){e&&(this.log("setting initial bwe to "+e),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator();},r.initEstimator=function(){var e=this.hls.config;return new F(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)},r.registerListeners=function(){var e=this.hls;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.FRAG_LOADING,this.onFragLoading,this),e.on(b.FRAG_LOADED,this.onFragLoaded,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this),e.on(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(b.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(b.ERROR,this.onError,this);},r.unregisterListeners=function(){var e=this.hls;e&&(e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.FRAG_LOADING,this.onFragLoading,this),e.off(b.FRAG_LOADED,this.onFragLoaded,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this),e.off(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(b.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(b.ERROR,this.onError,this));},r.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null;},r.onManifestLoading=function(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer();},r.onLevelsUpdated=function(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null;},r.onMaxAutoLevelUpdated=function(){this.firstSelection=-1,this.nextAutoLevelKey="";},r.onFragLoading=function(e,t){var r,i=t.frag;this.ignoreFragment(i)||(i.bitrateTest||(this.fragCurrent=i,this.partCurrent=null!=(r=t.part)?r:null),this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100));},r.onLevelSwitching=function(e,t){this.clearTimer();},r.onError=function(e,t){if(!t.fatal)switch(t.details){case k.BUFFER_ADD_CODEC_ERROR:case k.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case k.FRAG_LOAD_TIMEOUT:var r=t.frag,i=this.fragCurrent,n=this.partCurrent;if(r&&i&&r.sn===i.sn&&r.level===i.level){var a=performance.now(),s=n?n.stats:r.stats,o=a-s.loading.start,l=s.loading.first?s.loading.first-s.loading.start:-1;if(s.loaded&&l>-1){var u=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(o-Math.min(u,l),s.loaded);}else this.bwEstimator.sampleTTFB(o);}}},r.getTimeToLoadFrag=function(e,t,r,i){return e+r/t+(i?e+this.lastLevelLoadSec:0)},r.onLevelLoaded=function(e,t){var r=this.hls.config,i=t.stats.loading,n=i.end-i.first;A(n)&&(this.lastLevelLoadSec=n/1e3),t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo);},r.onFragLoaded=function(e,t){var r=t.frag,i=t.part,n=i?i.stats:r.stats;if(r.type===w&&this.bwEstimator.sampleTTFB(n.loading.first-n.loading.start),!this.ignoreFragment(r)){if(this.clearTimer(),r.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){var a=i?i.duration:r.duration,s=this.hls.levels[r.level],o=(s.loaded?s.loaded.bytes:0)+n.loaded,l=(s.loaded?s.loaded.duration:0)+a;s.loaded={bytes:o,duration:l},s.realBitrate=Math.round(8*o/l);}if(r.bitrateTest){var u={stats:n,frag:r,part:i,id:r.type};this.onFragBuffered(b.FRAG_BUFFERED,u),r.bitrateTest=!1;}else this.lastLoadedFragLevel=r.level;}},r.onFragBuffered=function(e,t){var r=t.frag,i=t.part,n=null!=i&&i.stats.loaded?i.stats:r.stats;if(!n.aborted&&!this.ignoreFragment(r)){var a=n.parsing.end-n.loading.start-Math.min(n.loading.first-n.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,n.loaded),n.bwEstimate=this.getBwEstimate(),r.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0;}},r.ignoreFragment=function(e){return e.type!==w||"initSegment"===e.sn},r.clearTimer=function(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1);},r.getAutoLevelKey=function(){return this.getBwEstimate()+"_"+this.getStarvationDelay().toFixed(2)},r.getNextABRAutoLevel=function(){var e=this.fragCurrent,t=this.partCurrent,r=this.hls;if(r.levels.length<=1)return r.loadLevel;var i=r.maxAutoLevel,n=r.config,a=r.minAutoLevel,s=t?t.duration:e?e.duration:0,o=this.getBwEstimate(),l=this.getStarvationDelay(),u=n.abrBandWidthFactor,d=n.abrBandWidthUpFactor;if(l){var h=this.findBestLevel(o,a,i,l,0,u,d);if(h>=0)return this.rebufferNotice=-1,h}var f=s?Math.min(s,n.maxStarvationDelay):n.maxStarvationDelay;if(!l){var c=this.bitrateTestDelay;c&&(f=(s?Math.min(s,n.maxLoadingDelay):n.maxLoadingDelay)-c,this.info("bitrate test took "+Math.round(1e3*c)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*f)+" ms"),u=d=1);}var g=this.findBestLevel(o,a,i,l,f,u,d);if(this.rebufferNotice!==g&&(this.rebufferNotice=g,this.info((l?"rebuffering expected":"buffer is empty")+", optimal quality level "+g)),g>-1)return g;var v=r.levels[a],m=r.loadLevelObj;return m&&(null==v?void 0:v.bitrate)<m.bitrate?a:r.loadLevel},r.getStarvationDelay=function(){var e=this.hls,t=e.media;if(!t)return 1/0;var r=t&&0!==t.playbackRate?Math.abs(t.playbackRate):1,i=e.mainForwardBufferInfo;return (i?i.len:0)/r},r.getBwEstimate=function(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate},r.findBestLevel=function(e,t,r,i,n,a,s){var o,l=this,u=i+n,d=this.lastLoadedFragLevel,h=-1===d?this.hls.firstLevel:d,f=this.fragCurrent,c=this.partCurrent,g=this.hls,v=g.levels,m=g.allAudioTracks,p=g.loadLevel,y=g.config;if(1===v.length)return 0;var E,T=v[h],S=!(null==(o=this.hls.latestLevelDetails)||!o.live),L=-1===p||-1===d,I="SDR",R=(null==T?void 0:T.frameRate)||0,k=y.audioPreference,b=y.videoPreference,D=this.audioTracksByGroup||(this.audioTracksByGroup=ht(m)),_=-1;if(L){if(-1!==this.firstSelection)return this.firstSelection;var P=this.codecTiers||(this.codecTiers=function(e,t,r,i){return e.slice(r,i+1).reduce((function(e,r,i){if(!r.codecSet)return e;var n=r.audioGroups,a=e[r.codecSet];a||(e[r.codecSet]=a={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:i,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!n,fragmentError:0}),a.minBitrate=Math.min(a.minBitrate,r.bitrate);var s=Math.min(r.height,r.width);return a.minHeight=Math.min(a.minHeight,s),a.minFramerate=Math.min(a.minFramerate,r.frameRate),a.minIndex=Math.min(a.minIndex,i),a.maxScore=Math.max(a.maxScore,r.score),a.fragmentError+=r.fragmentError,a.videoRanges[r.videoRange]=(a.videoRanges[r.videoRange]||0)+1,n&&n.forEach((function(e){if(e){var r=t.groups[e];r&&(a.hasDefaultAudio=a.hasDefaultAudio||t.hasDefaultAudio?r.hasDefault:r.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(r.channels).forEach((function(e){a.channels[e]=(a.channels[e]||0)+r.channels[e];})));}})),e}),{})}(v,D,t,r)),C=function(e,t,r,i,n){for(var a=Object.keys(e),s=null==i?void 0:i.channels,o=null==i?void 0:i.audioCodec,l=null==n?void 0:n.videoCodec,u=s&&2===parseInt(s),d=!1,h=!1,f=1/0,c=1/0,g=1/0,v=1/0,m=0,p=[],y=lt(t,n),E=y.preferHDR,T=y.allowedVideoRanges,S=function(){var t=e[a[L]];d||(d=t.channels[2]>0),f=Math.min(f,t.minHeight),c=Math.min(c,t.minFramerate),g=Math.min(g,t.minBitrate),T.filter((function(e){return t.videoRanges[e]>0})).length>0&&(h=!0);},L=a.length;L--;)S();f=A(f)?f:0,c=A(c)?c:0;var I=Math.max(1080,f),R=Math.max(30,c);g=A(g)?g:r,r=Math.max(g,r),h||(t=void 0);var k=a.length>1;return {codecSet:a.reduce((function(t,i){var n=e[i];if(i===t)return t;if(p=h?T.filter((function(e){return n.videoRanges[e]>0})):[],k){if(n.minBitrate>r)return dt(i,"min bitrate of "+n.minBitrate+" > current estimate of "+r),t;if(!n.hasDefaultAudio)return dt(i,"no renditions with default or auto-select sound found"),t;if(o&&i.indexOf(o.substring(0,4))%5!=0)return dt(i,'audio codec preference "'+o+'" not found'),t;if(s&&!u){if(!n.channels[s])return dt(i,"no renditions with "+s+" channel sound found (channels options: "+Object.keys(n.channels)+")"),t}else if((!o||u)&&d&&0===n.channels[2])return dt(i,"no renditions with stereo sound found"),t;if(n.minHeight>I)return dt(i,"min resolution of "+n.minHeight+" > maximum of "+I),t;if(n.minFramerate>R)return dt(i,"min framerate of "+n.minFramerate+" > maximum of "+R),t;if(!p.some((function(e){return n.videoRanges[e]>0})))return dt(i,"no variants with VIDEO-RANGE of "+ut(p)+" found"),t;if(l&&i.indexOf(l.substring(0,4))%5!=0)return dt(i,'video codec preference "'+l+'" not found'),t;if(n.maxScore<m)return dt(i,"max score of "+n.maxScore+" < selected max of "+m),t}return t&&(Ue(i)>=Ue(t)||n.fragmentError>e[t].fragmentError)?t:(v=n.minIndex,m=n.maxScore,i)}),void 0),videoRanges:p,preferHDR:E,minFramerate:c,minBitrate:g,minIndex:v}}(P,I,e,k,b),w=C.codecSet,O=C.videoRanges,x=C.minFramerate,M=C.minBitrate,F=C.minIndex,N=C.preferHDR;_=F,E=w,I=N?O[O.length-1]:O[0],R=x,e=Math.max(e,M),this.log("picked start tier "+ut(C));}else E=null==T?void 0:T.codecSet,I=null==T?void 0:T.videoRange;for(var U,B=c?c.duration:f?f.duration:0,G=this.bwEstimator.getEstimateTTFB()/1e3,K=[],V=function(){var t,o=v[H],f=H>h;if(!o)return 0;if(y.useMediaCapabilities&&!o.supportedResult&&!o.supportedPromise){var g=navigator.mediaCapabilities;"function"==typeof(null==g?void 0:g.decodingInfo)&&function(e,t,r,i,n,a){var s=e.videoCodec,o=e.audioCodec?e.audioGroups:null,l=null==a?void 0:a.audioCodec,u=null==a?void 0:a.channels,d=u?parseInt(u):l?1/0:2,h=null;if(null!=o&&o.length)try{h=1===o.length&&o[0]?t.groups[o[0]].channels:o.reduce((function(e,r){if(r){var i=t.groups[r];if(!i)throw new Error("Audio track group "+r+" not found");Object.keys(i.channels).forEach((function(t){e[t]=(e[t]||0)+i.channels[t];}));}return e}),{2:0});}catch(e){return !0}return void 0!==s&&(s.split(",").some((function(e){return Re(e)}))||e.width>1920&&e.height>1088||e.height>1920&&e.width>1088||e.frameRate>Math.max(i,30)||"SDR"!==e.videoRange&&e.videoRange!==r||e.bitrate>Math.max(n,8e6))||!!h&&A(d)&&Object.keys(h).some((function(e){return parseInt(e)>d}))}(o,D,I,R,e,k)?(o.supportedPromise=ze(o,D,g,l.supportedCache),o.supportedPromise.then((function(e){if(l.hls){o.supportedResult=e;var t=l.hls.levels,r=t.indexOf(o);e.error?l.warn('MediaCapabilities decodingInfo error: "'+e.error+'" for level '+r+" "+ut(e)):e.supported?e.decodingInfoResults.some((function(e){return !1===e.smooth||!1===e.powerEfficient}))&&l.log("MediaCapabilities decodingInfo for level "+r+" not smooth or powerEfficient: "+ut(e)):(l.warn("Unsupported MediaCapabilities decodingInfo result for level "+r+" "+ut(e)),r>-1&&t.length>1&&(l.log("Removing unsupported level "+r),l.hls.removeLevel(r),-1===l.hls.loadLevel&&(l.hls.nextLoadLevel=0)));}})).catch((function(e){l.warn("Error handling MediaCapabilities decodingInfo: "+e);}))):o.supportedResult=Xe;}if((E&&o.codecSet!==E||I&&o.videoRange!==I||f&&R>o.frameRate||!f&&R>0&&R<o.frameRate||null!=(t=o.supportedResult)&&null!=(t=t.decodingInfoResults)&&t.some((function(e){return !1===e.smooth})))&&(!L||H!==_))return K.push(H),0;var m,T=o.details,b=(c?null==T?void 0:T.partTarget:null==T?void 0:T.averagetargetduration)||B;m=f?s*e:a*e;var P=B&&i>=2*B&&0===n?o.averageBitrate:o.maxBitrate,C=l.getTimeToLoadFrag(G,m,P*b,void 0===T);if(m>=P&&(H===d||0===o.loadError&&0===o.fragmentError)&&(C<=G||!A(C)||S&&!l.bitrateTestDelay||C<u)){var w=l.forcedAutoLevel;return H===p||-1!==w&&w===p||(K.length&&l.trace("Skipped level(s) "+K.join(",")+" of "+r+' max with CODECS and VIDEO-RANGE:"'+v[K[0]].codecs+'" '+v[K[0]].videoRange+'; not compatible with "'+E+'" '+I),l.info("switch candidate:"+h+"->"+H+" adjustedbw("+Math.round(m)+")-bitrate="+Math.round(m-P)+" ttfb:"+G.toFixed(1)+" avgDuration:"+b.toFixed(1)+" maxFetchDuration:"+u.toFixed(1)+" fetchDuration:"+C.toFixed(1)+" firstSelection:"+L+" codecSet:"+o.codecSet+" videoRange:"+o.videoRange+" hls.loadLevel:"+p)),L&&(l.firstSelection=H),{v:H}}},H=r;H>=t;H--)if(0!==(U=V())&&U)return U.v;return -1},r.deriveNextAutoLevel=function(e){var t=this.hls,r=t.maxAutoLevel,i=t.minAutoLevel;return Math.min(Math.max(e,i),r)},i(t,[{key:"firstAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,r=e.minAutoLevel,i=this.getBwEstimate(),n=this.hls.config.maxStarvationDelay,a=this.findBestLevel(i,r,t,0,n,1,1);if(a>-1)return a;var s=this.hls.firstLevel,o=Math.min(Math.max(s,r),t);return this.warn("Could not find best starting auto level. Defaulting to first in playlist "+s+" clamped to "+o),o}},{key:"forcedAutoLevel",get:function(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}},{key:"nextAutoLevel",get:function(){var e=this.forcedAutoLevel,t=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(!(-1===e||t&&r&&this.nextAutoLevelKey!==this.getAutoLevelKey()))return e;var i=t&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==e){var n=this.hls.levels;if(n.length>Math.max(e,i)&&n[e].loadError<=n[i].loadError)return e}return this._nextAutoLevel=i,this.nextAutoLevelKey=this.getAutoLevelKey(),i},set:function(e){var t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t);}}])}(N),Et=function(e,t){for(var r=0,i=e.length-1,n=null,a=null;r<=i;){var s=t(a=e[n=(r+i)/2|0]);if(s>0)r=n+1;else {if(!(s<0))return a;i=n-1;}}return null};function Tt(e,t,r,i,n){void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=.005);var a=null;if(e){a=t[1+e.sn-t[0].sn]||null;var s=e.endDTS-r;s>0&&s<15e-7&&(r+=15e-7),a&&e.level!==a.level&&a.end<=e.end&&(a=t[2+e.sn-t[0].sn]||null);}else 0===r&&0===t[0].start&&(a=t[0]);if(a&&((!e||e.level===a.level)&&0===St(r,i,a)||function(e,t,r){if(t&&0===t.start&&t.level<e.level&&(t.endPTS||0)>0){var i=t.tagList.reduce((function(e,t){return "INF"===t[0]&&(e+=parseFloat(t[1])),e}),r);return e.start<=i}return !1}(a,e,Math.min(n,i))))return a;var o=Et(t,St.bind(null,r,i));return !o||o===e&&a?a:o}function St(e,t,r){if(void 0===e&&(e=0),void 0===t&&(t=0),r.start<=e&&r.start+r.duration>e)return 0;var i=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-i<=e?1:r.start-i>e&&r.start?-1:0}function At(e,t,r){var i=1e3*Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return (r.endProgramDateTime||0)-i>e}function Lt(e,t,r){if(e&&e.startCC<=t&&e.endCC>=t){var i,n=e.fragments,a=e.fragmentHint;return a&&(n=n.concat(a)),Et(n,(function(e){return e.cc<t?1:e.cc>t?-1:(i=e,e.end<=r?1:e.start>r?-1:0)})),i||null}return null}function It(e){switch(e.details){case k.FRAG_LOAD_TIMEOUT:case k.KEY_LOAD_TIMEOUT:case k.LEVEL_LOAD_TIMEOUT:case k.MANIFEST_LOAD_TIMEOUT:return !0}return !1}function Rt(e){return e.details.startsWith("key")}function kt(e){return Rt(e)&&!!e.frag&&!e.frag.decryptdata}function bt(e,t){var r=It(t);return e.default[(r?"timeout":"error")+"Retry"]}function Dt(e,t){var r="linear"===e.backoff?1:Math.pow(2,t);return Math.min(r*e.retryDelayMs,e.maxRetryDelayMs)}function _t(e){return d(d({},e),{errorRetry:null,timeoutRetry:null})}function Pt(e,t,r,i){if(!e)return !1;var n=null==i?void 0:i.code,a=t<e.maxNumRetry&&(function(e){return Ct(e)||!!e&&(e<400||e>499)}(n)||!!r);return e.shouldRetry?e.shouldRetry(e,t,r,i,a):a}function Ct(e){return 0===e&&!1===navigator.onLine}var wt=0,Ot=2,xt=3,Mt=5,Ft=0,Nt=1,Ut=2,Bt=4,Gt=function(e){function t(t){var r;return (r=e.call(this,"error-controller",t.logger)||this).hls=void 0,r.playlistError=0,r.hls=t,r.registerListeners(),r}o(t,e);var r=t.prototype;return r.registerListeners=function(){var e=this.hls;e.on(b.ERROR,this.onError,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this);},r.unregisterListeners=function(){var e=this.hls;e&&(e.off(b.ERROR,this.onError,this),e.off(b.ERROR,this.onErrorOut,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this));},r.destroy=function(){this.unregisterListeners(),this.hls=null;},r.startLoad=function(e){},r.stopLoad=function(){this.playlistError=0;},r.getVariantLevelIndex=function(e){return (null==e?void 0:e.type)===w?e.level:this.getVariantIndex()},r.getVariantIndex=function(){var e,t=this.hls,r=t.currentLevel;return null!=(e=t.loadLevelObj)&&e.details||-1===r?t.loadLevel:r},r.variantHasKey=function(e,t){if(e){var r;if(null!=(r=e.details)&&r.hasKey(t))return !0;var i=e.audioGroups;if(i)return this.hls.allAudioTracks.filter((function(e){return i.indexOf(e.groupId)>=0})).some((function(e){var r;return null==(r=e.details)?void 0:r.hasKey(t)}))}return !1},r.onManifestLoading=function(){this.playlistError=0;},r.onLevelUpdated=function(){this.playlistError=0;},r.onError=function(e,t){var r;if(!t.fatal){var i=this.hls,n=t.context;switch(t.details){case k.FRAG_LOAD_ERROR:case k.FRAG_LOAD_TIMEOUT:case k.KEY_LOAD_ERROR:case k.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case k.FRAG_PARSING_ERROR:if(null!=(r=t.frag)&&r.gap)return void(t.errorAction=Kt());case k.FRAG_GAP:case k.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=Ot);case k.LEVEL_EMPTY_ERROR:case k.LEVEL_PARSING_ERROR:var a,s=t.parent===w?t.level:i.loadLevel;return void(t.details===k.LEVEL_EMPTY_ERROR&&null!=(a=t.context)&&null!=(a=a.levelDetails)&&a.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,s)));case k.LEVEL_LOAD_ERROR:case k.LEVEL_LOAD_TIMEOUT:return void("number"==typeof(null==n?void 0:n.level)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,n.level)));case k.AUDIO_TRACK_LOAD_ERROR:case k.AUDIO_TRACK_LOAD_TIMEOUT:case k.SUBTITLE_LOAD_ERROR:case k.SUBTITLE_TRACK_LOAD_TIMEOUT:if(n){var o=i.loadLevelObj;if(o&&(n.type===P&&o.hasAudioGroup(n.groupId)||n.type===C&&o.hasSubtitleGroup(n.groupId)))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.loadLevel),t.errorAction.action=Ot,void(t.errorAction.flags=Nt)}return;case k.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:return void(t.errorAction={action:Ot,flags:Ut});case k.KEY_SYSTEM_SESSION_UPDATE_FAILED:case k.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case k.KEY_SYSTEM_NO_SESSION:return void(t.errorAction={action:Ot,flags:Bt});case k.BUFFER_ADD_CODEC_ERROR:case k.REMUX_ALLOC_ERROR:case k.BUFFER_APPEND_ERROR:var l;return void(t.errorAction||(t.errorAction=this.getLevelSwitchAction(t,null!=(l=t.level)?l:i.loadLevel)));case k.INTERNAL_EXCEPTION:case k.BUFFER_APPENDING_ERROR:case k.BUFFER_FULL_ERROR:case k.LEVEL_SWITCH_ERROR:case k.BUFFER_STALLED_ERROR:case k.BUFFER_SEEK_OVER_HOLE:case k.BUFFER_NUDGE_ON_STALL:return void(t.errorAction=Kt())}t.type===R.KEY_SYSTEM_ERROR&&(t.levelRetry=!1,t.errorAction=Kt());}},r.getPlaylistRetryOrSwitchAction=function(e,t){var r=bt(this.hls.config.playlistLoadPolicy,e),i=this.playlistError++;if(Pt(r,i,It(e),e.response))return {action:Mt,flags:Ft,retryConfig:r,retryCount:i};var n=this.getLevelSwitchAction(e,t);return r&&(n.retryConfig=r,n.retryCount=i),n},r.getFragRetryOrSwitchAction=function(e){var t=this.hls,r=this.getVariantLevelIndex(e.frag),i=t.levels[r],n=t.config,a=n.fragLoadPolicy,s=n.keyLoadPolicy,o=bt(Rt(e)?s:a,e),l=t.levels.reduce((function(e,t){return e+t.fragmentError}),0);if(i&&(e.details!==k.FRAG_GAP&&i.fragmentError++,!kt(e)&&Pt(o,l,It(e),e.response)))return {action:Mt,flags:Ft,retryConfig:o,retryCount:l};var u=this.getLevelSwitchAction(e,r);return o&&(u.retryConfig=o,u.retryCount=l),u},r.getLevelSwitchAction=function(e,t){var r=this.hls;null==t&&(t=r.loadLevel);var i=this.hls.levels[t];if(i){var n,a,s=e.details;i.loadError++,s===k.BUFFER_APPEND_ERROR&&i.fragmentError++;var o=-1,l=r.levels,u=r.loadLevel,d=r.minAutoLevel,h=r.maxAutoLevel;r.autoLevelEnabled||r.config.preserveManualLevelOnError||(r.loadLevel=-1);for(var f,c=null==(n=e.frag)?void 0:n.type,g=(c===O&&s===k.FRAG_PARSING_ERROR||"audio"===e.sourceBufferName&&(s===k.BUFFER_ADD_CODEC_ERROR||s===k.BUFFER_APPEND_ERROR))&&l.some((function(e){var t=e.audioCodec;return i.audioCodec!==t})),v="video"===e.sourceBufferName&&(s===k.BUFFER_ADD_CODEC_ERROR||s===k.BUFFER_APPEND_ERROR)&&l.some((function(e){var t=e.codecSet,r=e.audioCodec;return i.codecSet!==t&&i.audioCodec===r})),m=null!=(a=e.context)?a:{},p=m.type,y=m.groupId,E=function(){var t=(T+u)%l.length;if(t!==u&&t>=d&&t<=h&&0===l[t].loadError){var r,n,a=l[t];if(s===k.FRAG_GAP&&c===w&&e.frag){var f=l[t].details;if(f){var m=Tt(e.frag,f.fragments,e.frag.start);if(null!=m&&m.gap)return 0}}else {if(p===P&&a.hasAudioGroup(y)||p===C&&a.hasSubtitleGroup(y))return 0;if(c===O&&null!=(r=i.audioGroups)&&r.some((function(e){return a.hasAudioGroup(e)}))||c===x&&null!=(n=i.subtitleGroups)&&n.some((function(e){return a.hasSubtitleGroup(e)}))||g&&i.audioCodec===a.audioCodec||v&&i.codecSet===a.codecSet||!g&&i.codecSet!==a.codecSet)return 0}return o=t,1}},T=l.length;T--&&(0===(f=E())||1!==f););if(o>-1&&r.loadLevel!==o)return e.levelRetry=!0,this.playlistError=0,{action:Ot,flags:Ft,nextAutoLevel:o}}return {action:Ot,flags:Nt}},r.onErrorOut=function(e,t){var r;switch(null==(r=t.errorAction)?void 0:r.action){case wt:break;case Ot:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===k.FRAG_GAP?/MediaSource readyState: ended/.test(t.error.message)&&(this.warn('MediaSource ended after "'+t.sourceBufferName+'" sourceBuffer append error. Attempting to recover from media error.'),this.hls.recoverMediaError()):t.fatal=!0;}t.fatal&&this.hls.stopLoad();},r.sendAlternateToPenaltyBox=function(e){var t=this.hls,r=e.errorAction;if(r){var i=r.flags,n=r.nextAutoLevel;switch(i){case Ft:this.switchLevel(e,n);break;case Ut:var a=this.getVariantLevelIndex(e.frag),s=t.levels[a],o=null==s?void 0:s.attrs["HDCP-LEVEL"];if(r.hdcpLevel=o,"NONE"===o)this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(o){t.maxHdcpLevel=Je[Je.indexOf(o)-1],r.resolved=!0,this.warn('Restricting playback to HDCP-LEVEL of "'+t.maxHdcpLevel+'" or lower');break}case Bt:var l=e.decryptdata;if(l){for(var u=this.hls.levels,d=u.length,h=d;h--;){var f,c;this.variantHasKey(u[h],l)&&(this.log("Banned key found in level "+h+" ("+u[h].bitrate+'bps) or audio group "'+(null==(f=u[h].audioGroups)?void 0:f.join(","))+'" ('+(null==(c=e.frag)?void 0:c.type)+" fragment) "+X(l.keyId||[])),u[h].fragmentError++,u[h].loadError++,this.log("Removing level "+h+" with key error ("+e.error+")"),this.hls.removeLevel(h));}var g=e.frag;if(this.hls.levels.length<d)r.resolved=!0;else if(g&&g.type!==w){var v=g.decryptdata;v&&!l.matches(v)&&(r.resolved=!0);}}}r.resolved||this.switchLevel(e,n);}},r.switchLevel=function(e,t){if(void 0!==t&&e.errorAction&&(this.warn("switching to level "+t+" after "+e.details),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===k.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&"audiovideo"!==e.sourceBufferName))for(var r=je(e.mimeType),i=this.hls.levels,n=i.length;n--;)i[n][e.sourceBufferName+"Codec"]===r&&(this.log("Removing level "+n+" for "+e.details+' ("'+r+'" not supported)'),this.hls.removeLevel(n));},t}(N);function Kt(e){var t={action:wt,flags:Ft};return e&&(t.resolved=!0),t}var Vt="NOT_LOADED",Ht="APPENDING",Yt="PARTIAL",Wt="OK",jt=function(){function e(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners();}var t=e.prototype;return t._registerListeners=function(){var e=this.hls;e&&(e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.BUFFER_APPENDED,this.onBufferAppended,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this),e.on(b.FRAG_LOADED,this.onFragLoaded,this));},t._unregisterListeners=function(){var e=this.hls;e&&(e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.BUFFER_APPENDED,this.onBufferAppended,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this),e.off(b.FRAG_LOADED,this.onFragLoaded,this));},t.destroy=function(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null;},t.getAppendedFrag=function(e,t){var r=this.activePartLists[t];if(r)for(var i=r.length;i--;){var n=r[i];if(!n)break;if(n.start<=e&&e<=n.end&&n.loaded)return n}return this.getBufferedFrag(e,t)},t.getBufferedFrag=function(e,t){return this.getFragAtPos(e,t,!0)},t.getFragAtPos=function(e,t,r){for(var i=this.fragments,n=Object.keys(i),a=n.length;a--;){var s=i[n[a]];if((null==s?void 0:s.body.type)===t&&(!r||s.buffered)){var o=s.body;if(o.start<=e&&e<=o.end)return o}}return null},t.detectEvictedFragments=function(e,t,r,i,n){var a=this;this.timeRanges&&(this.timeRanges[e]=t);var s=(null==i?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach((function(i){var o=a.fragments[i];if(o&&!(s>=o.body.sn))if(o.buffered||o.loaded&&!n){var l=o.range[e];l&&(0!==l.time.length?l.time.some((function(e){var r=!a.isTimeBuffered(e.startPTS,e.endPTS,t);return r&&a.removeFragment(o.body),r})):a.removeFragment(o.body));}else o.body.type===r&&a.removeFragment(o.body);}));},t.detectPartialFragments=function(e){var t=this,r=this.timeRanges;if(r&&"initSegment"!==e.frag.sn){var i=e.frag,n=Xt(i),a=this.fragments[n];if(!(!a||a.buffered&&i.gap)){var s=!i.relurl;Object.keys(r).forEach((function(n){var o=i.elementaryStreams[n];if(o){var l=r[n],u=s||!0===o.partial;a.range[n]=t.getBufferedTimes(i,e.part,u,l);}})),a.loaded=null,Object.keys(a.range).length?(a.buffered=!0,(a.body.endList=i.endList||a.body.endList)&&(this.endListFragments[a.body.type]=a),qt(a)||this.removeParts(i.sn-1,i.type)):this.removeFragment(a.body);}}},t.removeParts=function(e,t){var r=this.activePartLists[t];r&&(this.activePartLists[t]=Qt(r,(function(t){return t.fragment.sn>=e})));},t.fragBuffered=function(e,t){var r=Xt(e),i=this.fragments[r];!i&&t&&(i=this.fragments[r]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,i.buffered=!0);},t.getBufferedTimes=function(e,t,r,i){for(var n={time:[],partial:r},a=e.start,s=e.end,o=e.minEndPTS||s,l=e.maxStartPTS||a,u=0;u<i.length;u++){var d=i.start(u)-this.bufferPadding,h=i.end(u)+this.bufferPadding;if(l>=d&&o<=h){n.time.push({startPTS:Math.max(a,i.start(u)),endPTS:Math.min(s,i.end(u))});break}if(a<h&&s>d){var f=Math.max(a,i.start(u)),c=Math.min(s,i.end(u));c>f&&(n.partial=!0,n.time.push({startPTS:f,endPTS:c}));}else if(s<=d)break}return n},t.getPartialFragment=function(e){var t,r,i,n=null,a=0,s=this.bufferPadding,o=this.fragments;return Object.keys(o).forEach((function(l){var u=o[l];u&&qt(u)&&(r=u.body.start-s,i=u.body.end+s,e>=r&&e<=i&&(t=Math.min(e-r,i-e),a<=t&&(n=u.body,a=t)));})),n},t.isEndListAppended=function(e){var t=this.endListFragments[e];return void 0!==t&&(t.buffered||qt(t))},t.getState=function(e){var t=Xt(e),r=this.fragments[t];return r?r.buffered?qt(r)?Yt:Wt:Ht:Vt},t.isTimeBuffered=function(e,t,r){for(var i,n,a=0;a<r.length;a++){if(i=r.start(a)-this.bufferPadding,n=r.end(a)+this.bufferPadding,e>=i&&t<=n)return !0;if(t<=i)return !1}return !1},t.onManifestLoading=function(){this.removeAllFragments();},t.onFragLoaded=function(e,t){if("initSegment"!==t.frag.sn&&!t.frag.bitrateTest){var r=t.frag,i=t.part?null:t,n=Xt(r);this.fragments[n]={body:r,appendedPTS:null,loaded:i,buffered:!1,range:Object.create(null)};}},t.onBufferAppended=function(e,t){var r=t.frag,i=t.part,n=t.timeRanges,a=t.type;if("initSegment"!==r.sn){var s=r.type;if(i){var o=this.activePartLists[s];o||(this.activePartLists[s]=o=[]),o.push(i);}this.timeRanges=n;var l=n[a];this.detectEvictedFragments(a,l,s,i);}},t.onFragBuffered=function(e,t){this.detectPartialFragments(t);},t.hasFragment=function(e){var t=Xt(e);return !!this.fragments[t]},t.hasFragments=function(e){var t=this.fragments,r=Object.keys(t);if(!e)return r.length>0;for(var i=r.length;i--;){var n=t[r[i]];if((null==n?void 0:n.body.type)===e)return !0}return !1},t.hasParts=function(e){var t;return !(null==(t=this.activePartLists[e])||!t.length)},t.removeFragmentsInRange=function(e,t,r,i,n){var a=this;i&&!this.hasGaps||Object.keys(this.fragments).forEach((function(s){var o=a.fragments[s];if(o){var l=o.body;l.type!==r||i&&!l.gap||l.start<t&&l.end>e&&(o.buffered||n)&&a.removeFragment(l);}}));},t.removeFragment=function(e){var t=Xt(e);e.clearElementaryStreamInfo();var r=this.activePartLists[e.type];if(r){var i=e.sn;this.activePartLists[e.type]=Qt(r,(function(e){return e.fragment.sn!==i}));}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type];},t.removeAllFragments=function(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;var t=null==(e=this.hls)||null==(e=e.latestLevelDetails)?void 0:e.partList;t&&t.forEach((function(e){return e.clearElementaryStreamInfo()}));},e}();function qt(e){var t,r,i;return e.buffered&&!!(e.body.gap||null!=(t=e.range.video)&&t.partial||null!=(r=e.range.audio)&&r.partial||null!=(i=e.range.audiovideo)&&i.partial)}function Xt(e){return e.type+"_"+e.level+"_"+e.sn}function Qt(e,t){return e.filter((function(e){var r=t(e);return r||e.clearElementaryStreamInfo(),r}))}var zt=0,$t=1,Zt=function(){function e(e,t,r){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=r;}return e.prototype.decrypt=function(e,t){switch(this.aesMode){case zt:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case $t:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error("[AESCrypto] invalid aes mode "+this.aesMode)}},e}(),Jt=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable();}var t=e.prototype;return t.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),r=new Uint32Array(4),i=0;i<4;i++)r[i]=t.getUint32(4*i);return r},t.initTable=function(){var e=this.sBox,t=this.invSBox,r=this.subMix,i=r[0],n=r[1],a=r[2],s=r[3],o=this.invSubMix,l=o[0],u=o[1],d=o[2],h=o[3],f=new Uint32Array(256),c=0,g=0,v=0;for(v=0;v<256;v++)f[v]=v<128?v<<1:v<<1^283;for(v=0;v<256;v++){var m=g^g<<1^g<<2^g<<3^g<<4;m=m>>>8^255&m^99,e[c]=m,t[m]=c;var p=f[c],y=f[p],E=f[y],T=257*f[m]^16843008*m;i[c]=T<<24|T>>>8,n[c]=T<<16|T>>>16,a[c]=T<<8|T>>>24,s[c]=T,T=16843009*E^65537*y^257*p^16843008*c,l[m]=T<<24|T>>>8,u[m]=T<<16|T>>>16,d[m]=T<<8|T>>>24,h[m]=T,c?(c=p^f[f[f[E^p]]],g^=f[f[g]]):c=g=1;}},t.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,i=0;i<t.length&&r;)r=t[i]===this.key[i],i++;if(!r){this.key=t;var n=this.keySize=t.length;if(4!==n&&6!==n&&8!==n)throw new Error("Invalid aes key size="+n);var a,s,o,l,u=this.ksRows=4*(n+6+1),d=this.keySchedule=new Uint32Array(u),h=this.invKeySchedule=new Uint32Array(u),f=this.sBox,c=this.rcon,g=this.invSubMix,v=g[0],m=g[1],p=g[2],y=g[3];for(a=0;a<u;a++)a<n?o=d[a]=t[a]:(l=o,a%n==0?(l=f[(l=l<<8|l>>>24)>>>24]<<24|f[l>>>16&255]<<16|f[l>>>8&255]<<8|f[255&l],l^=c[a/n|0]<<24):n>6&&a%n==4&&(l=f[l>>>24]<<24|f[l>>>16&255]<<16|f[l>>>8&255]<<8|f[255&l]),d[a]=o=(d[a-n]^l)>>>0);for(s=0;s<u;s++)a=u-s,l=3&s?d[a]:d[a-4],h[s]=s<4||a<=4?l:v[f[l>>>24]]^m[f[l>>>16&255]]^p[f[l>>>8&255]]^y[f[255&l]],h[s]=h[s]>>>0;}},t.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},t.decrypt=function(e,t,r){for(var i,n,a,s,o,l,u,d,h,f,c,g,v,m,p=this.keySize+6,y=this.invKeySchedule,E=this.invSBox,T=this.invSubMix,S=T[0],A=T[1],L=T[2],I=T[3],R=this.uint8ArrayToUint32Array_(r),k=R[0],b=R[1],D=R[2],_=R[3],P=new Int32Array(e),C=new Int32Array(P.length),w=this.networkToHostOrderSwap;t<P.length;){for(h=w(P[t]),f=w(P[t+1]),c=w(P[t+2]),g=w(P[t+3]),o=h^y[0],l=g^y[1],u=c^y[2],d=f^y[3],v=4,m=1;m<p;m++)i=S[o>>>24]^A[l>>16&255]^L[u>>8&255]^I[255&d]^y[v],n=S[l>>>24]^A[u>>16&255]^L[d>>8&255]^I[255&o]^y[v+1],a=S[u>>>24]^A[d>>16&255]^L[o>>8&255]^I[255&l]^y[v+2],s=S[d>>>24]^A[o>>16&255]^L[l>>8&255]^I[255&u]^y[v+3],o=i,l=n,u=a,d=s,v+=4;i=E[o>>>24]<<24^E[l>>16&255]<<16^E[u>>8&255]<<8^E[255&d]^y[v],n=E[l>>>24]<<24^E[u>>16&255]<<16^E[d>>8&255]<<8^E[255&o]^y[v+1],a=E[u>>>24]<<24^E[d>>16&255]<<16^E[o>>8&255]<<8^E[255&l]^y[v+2],s=E[d>>>24]<<24^E[o>>16&255]<<16^E[l>>8&255]<<8^E[255&u]^y[v+3],C[t]=w(i^k),C[t+1]=w(s^b),C[t+2]=w(a^D),C[t+3]=w(n^_),k=h,b=f,D=c,_=g,t+=4;}return C.buffer},e}(),er=function(){function e(e,t,r){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=r;}return e.prototype.expandKey=function(){var e=function(e){switch(e){case zt:return "AES-CBC";case $t:return "AES-CTR";default:throw new Error("[FastAESKey] invalid aes mode "+e)}}(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])},e}(),tr=function(){function e(e,t){var r=(void 0===t?{}:t).removePKCS7Padding,i=void 0===r||r;if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=i,i)try{var n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle);}catch(e){}this.useSoftware=!this.subtle;}var t=e.prototype;return t.destroy=function(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null;},t.isSync=function(){return this.useSoftware},t.flush=function(){var e=this.currentResult,t=this.remainderData;if(!e||t)return this.reset(),null;var r,i,n,a=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?(i=(r=a).byteLength,(n=i&&new DataView(r.buffer).getUint8(i-1))?r.slice(0,i-n):r):a},t.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null);},t.decrypt=function(e,t,r,i){var n=this;return this.useSoftware?new Promise((function(a,s){var o=ArrayBuffer.isView(e)?e:new Uint8Array(e);n.softwareDecrypt(o,t,r,i);var l=n.flush();l?a(l.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"));})):this.webCryptoDecrypt(new Uint8Array(e),t,r,i)},t.softwareDecrypt=function(e,t,r,i){var n=this.currentIV,a=this.currentResult,s=this.remainderData;if(i!==zt||16!==t.byteLength)return Y.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),s&&(e=Le(s,e),this.remainderData=null);var o=this.getValidChunk(e);if(!o.length)return null;n&&(r=n);var l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new Jt),l.expandKey(t);var u=a;return this.currentResult=l.decrypt(o.buffer,0,r),this.currentIV=o.slice(-16).buffer,u||null},t.webCryptoDecrypt=function(e,t,r,i){var n=this;if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,r,i));this.key=t,this.fastAesKey=new er(this.subtle,t,i);}return this.fastAesKey.expandKey().then((function(t){return n.subtle?(n.logOnce("WebCrypto AES decrypt"),new Zt(n.subtle,new Uint8Array(r),i).decrypt(e.buffer,t)):Promise.reject(new Error("web crypto not initialized"))})).catch((function(a){return Y.warn("[decrypter]: WebCrypto Error, disable WebCrypto API, "+a.name+": "+a.message),n.onWebCryptoError(e,t,r,i)}))},t.onWebCryptoError=function(e,t,r,i){var n=this.enableSoftwareAES;if(n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,r,i);var a=this.flush();if(a)return a.buffer}throw new Error("WebCrypto"+(n?" and softwareDecrypt":"")+": failed to decrypt data")},t.getValidChunk=function(e){var t=e,r=e.length-e.length%16;return r!==e.length&&(t=e.slice(0,r),this.remainderData=e.slice(r)),t},t.logOnce=function(e){this.logEnabled&&(Y.log("[decrypter]: "+e),this.logEnabled=!1);},e}(),rr=Math.pow(2,17),ir=function(){function e(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e;}var t=e.prototype;return t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null);},t.abort=function(){this.loader&&this.loader.abort();},t.load=function(e,t){var r=this,i=e.url;if(!i)return Promise.reject(new sr({type:R.NETWORK_ERROR,details:k.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error("Fragment does not have a "+(i?"part list":"url")),networkDetails:null}));this.abort();var n=this.config,a=n.fLoader,s=n.loader;return new Promise((function(o,l){if(r.loader&&r.loader.destroy(),e.gap){if(e.tagList.some((function(e){return "GAP"===e[0]})))return void l(ar(e));e.gap=!1;}var u=r.loader=a?new a(n):new s(n),h=nr(e);e.loader=u;var f=_t(n.fragLoadPolicy.default),c={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:rr};e.stats=u.stats;var g={onSuccess:function(t,i,n,a){r.resetLoader(e,u);var s=t.data;n.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(s.slice(0,16)),s=s.slice(16)),o({frag:e,part:null,payload:s,networkDetails:a});},onError:function(t,n,a,s){r.resetLoader(e,u),l(new sr({type:R.NETWORK_ERROR,details:k.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:d({url:i,data:void 0},t),error:new Error("HTTP Error "+t.code+" "+t.text),networkDetails:a,stats:s}));},onAbort:function(t,i,n){r.resetLoader(e,u),l(new sr({type:R.NETWORK_ERROR,details:k.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:n,stats:t}));},onTimeout:function(t,i,n){r.resetLoader(e,u),l(new sr({type:R.NETWORK_ERROR,details:k.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error("Timeout after "+c.timeout+"ms"),networkDetails:n,stats:t}));}};t&&(g.onProgress=function(r,i,n,a){return t({frag:e,part:null,payload:n,networkDetails:a})}),u.load(h,c,g);}))},t.loadPart=function(e,t,r){var i=this;this.abort();var n=this.config,a=n.fLoader,s=n.loader;return new Promise((function(o,l){if(i.loader&&i.loader.destroy(),e.gap||t.gap)l(ar(e,t));else {var u=i.loader=a?new a(n):new s(n),h=nr(e,t);e.loader=u;var f=_t(n.fragLoadPolicy.default),c={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:rr};t.stats=u.stats,u.load(h,c,{onSuccess:function(n,a,s,l){i.resetLoader(e,u),i.updateStatsFromPart(e,t);var d={frag:e,part:t,payload:n.data,networkDetails:l};r(d),o(d);},onError:function(r,n,a,s){i.resetLoader(e,u),l(new sr({type:R.NETWORK_ERROR,details:k.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:d({url:h.url,data:void 0},r),error:new Error("HTTP Error "+r.code+" "+r.text),networkDetails:a,stats:s}));},onAbort:function(r,n,a){e.stats.aborted=t.stats.aborted,i.resetLoader(e,u),l(new sr({type:R.NETWORK_ERROR,details:k.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:a,stats:r}));},onTimeout:function(r,n,a){i.resetLoader(e,u),l(new sr({type:R.NETWORK_ERROR,details:k.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error("Timeout after "+c.timeout+"ms"),networkDetails:a,stats:r}));}});}}))},t.updateStatsFromPart=function(e,t){var r=e.stats,i=t.stats,n=i.total;if(r.loaded+=i.loaded,n){var a=Math.round(e.duration/t.duration),s=Math.min(Math.round(r.loaded/n),a),o=(a-s)*Math.round(r.loaded/s);r.total=r.loaded+o;}else r.total=Math.max(r.loaded,r.total);var l=r.loading,u=i.loading;l.start?l.first+=u.first-u.start:(l.start=u.start,l.first=u.first),l.end=u.end;},t.resetLoader=function(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy();},e}();function nr(e,t){void 0===t&&(t=null);var r,i=t||e,n={frag:e,part:t,responseType:"arraybuffer",url:i.url,headers:{},rangeStart:0,rangeEnd:0},a=i.byteRangeStartOffset,s=i.byteRangeEndOffset;if(A(a)&&A(s)){var o,l=a,u=s;if("initSegment"===e.sn&&("AES-128"===(r=null==(o=e.decryptdata)?void 0:o.method)||"AES-256"===r)){var d=s-a;d%16&&(u=s+(16-d%16)),0!==a&&(n.resetIV=!0,l=a-16);}n.rangeStart=l,n.rangeEnd=u;}return n}function ar(e,t){var r=new Error("GAP "+(e.gap?"tag":"attribute")+" found"),i={type:R.MEDIA_ERROR,details:k.FRAG_GAP,fatal:!1,frag:e,error:r,networkDetails:null};return t&&(i.part=t),(t||e).stats.aborted=!0,new sr(i)}var sr=function(e){function t(t){var r;return (r=e.call(this,t.error.message)||this).data=void 0,r.data=t,r}return o(t,e),t}(c(Error)),or=function(e){function t(t,r){var i;return (i=e.call(this,t,r)||this)._boundTick=void 0,i._tickTimer=null,i._tickInterval=null,i._tickCallCount=0,i._boundTick=i.tick.bind(i),i}o(t,e);var r=t.prototype;return r.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed();},r.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval();},r.onHandlerDestroyed=function(){},r.hasInterval=function(){return !!this._tickInterval},r.hasNextTick=function(){return !!this._tickTimer},r.setInterval=function(e){return !this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)},r.clearInterval=function(){return !!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},r.clearNextTick=function(){return !!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},r.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0);},r.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0);},r.doTick=function(){},t}(N),lr=function(e,t,r,i,n,a){void 0===i&&(i=0),void 0===n&&(n=-1),void 0===a&&(a=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=e,this.sn=t,this.id=r,this.size=i,this.part=n,this.partial=a;},ur={length:0,start:function(){return 0},end:function(){return 0}},dr=function(){function e(){}return e.isBuffered=function(t,r){if(t)for(var i=e.getBuffered(t),n=i.length;n--;)if(r>=i.start(n)&&r<=i.end(n))return !0;return !1},e.bufferedRanges=function(t){if(t){var r=e.getBuffered(t);return e.timeRangesToArray(r)}return []},e.timeRangesToArray=function(e){for(var t=[],r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t},e.bufferInfo=function(t,r,i){if(t){var n=e.bufferedRanges(t);if(n.length)return e.bufferedInfo(n,r,i)}return {len:0,start:r,end:r,bufferedIndex:-1}},e.bufferedInfo=function(e,t,r){t=Math.max(0,t),e.length>1&&e.sort((function(e,t){return e.start-t.start||t.end-e.end}));var i=-1,n=[];if(r)for(var a=0;a<e.length;a++){t>=e[a].start&&t<=e[a].end&&(i=a);var s=n.length;if(s){var o=n[s-1].end;e[a].start-o<r?e[a].end>o&&(n[s-1].end=e[a].end):n.push(e[a]);}else n.push(e[a]);}else n=e;for(var l,u=0,d=t,h=t,f=0;f<n.length;f++){var c=n[f].start,g=n[f].end;if(-1===i&&t>=c&&t<=g&&(i=f),t+r>=c&&t<g)d=c,u=(h=g)-t;else if(t+r<c){l=c;break}}return {len:u,start:d||0,end:h||0,nextStart:l,buffered:e,bufferedIndex:i}},e.getBuffered=function(e){try{return e.buffered||ur}catch(e){return Y.log("failed to get media.buffered",e),ur}},e}(),hr=/\{\$([a-zA-Z0-9-_]+)\}/g;function fr(e){return hr.test(e)}function cr(e,t){if(null!==e.variableList||e.hasVariableRefs){var r=e.variableList;return t.replace(hr,(function(t){var i=t.substring(2,t.length-1),n=null==r?void 0:r[i];return void 0===n?(e.playlistParsingError||(e.playlistParsingError=new Error('Missing preceding EXT-X-DEFINE tag for Variable Reference: "'+i+'"')),t):n}))}return t}function gr(e,t,r){var i,n,a=e.variableList;if(a||(e.variableList=a={}),"QUERYPARAM"in t){i=t.QUERYPARAM;try{var s=new self.URL(r).searchParams;if(!s.has(i))throw new Error('"'+i+'" does not match any query parameter in URI: "'+r+'"');n=s.get(i);}catch(t){e.playlistParsingError||(e.playlistParsingError=new Error("EXT-X-DEFINE QUERYPARAM: "+t.message));}}else i=t.NAME,n=t.VALUE;i in a?e.playlistParsingError||(e.playlistParsingError=new Error('EXT-X-DEFINE duplicate Variable Name declarations: "'+i+'"')):a[i]=n||"";}function vr(e,t,r){var i=t.IMPORT;if(r&&i in r){var n=e.variableList;n||(e.variableList=n={}),n[i]=r[i];}else e.playlistParsingError||(e.playlistParsingError=new Error('EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "'+i+'"'));}var mr=/^(\d+)x(\d+)$/,pr=/(.+?)=(".*?"|.*?)(?:,|$)/g,yr=function(){function e(t,r){"string"==typeof t&&(t=e.parseAttrList(t,r)),a(this,t);}var t=e.prototype;return t.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),i=0;i<t.length/2;i++)r[i]=parseInt(t.slice(2*i,2*i+2),16);return r}return null},t.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.decimalFloatingPoint=function(e){return parseFloat(this[e])},t.optionalFloat=function(e,t){var r=this[e];return r?parseFloat(r):t},t.enumeratedString=function(e){return this[e]},t.enumeratedStringList=function(e,t){var r=this[e];return (r?r.split(/[ ,]+/):[]).reduce((function(e,t){return e[t.toLowerCase()]=!0,e}),t)},t.bool=function(e){return "YES"===this[e]},t.decimalResolution=function(e){var t=mr.exec(this[e]);if(null!==t)return {width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e,t){var r,i={};for(pr.lastIndex=0;null!==(r=pr.exec(e));){var n=r[1].trim(),a=r[2],s=0===a.indexOf('"')&&a.lastIndexOf('"')===a.length-1,o=!1;if(s)a=a.slice(1,-1);else switch(n){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":o=!0;}if(t&&(s||o))a=cr(t,a);else if(!o&&!s)switch(n){case"CLOSED-CAPTIONS":if("NONE"===a)break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":Y.warn(e+": attribute "+n+" is missing quotes");}i[n]=a;}return i},i(e,[{key:"clientAttrs",get:function(){return Object.keys(this).filter((function(e){return "X-"===e.substring(0,2)}))}}])}();function Er(e){return "SCTE35-OUT"===e||"SCTE35-IN"===e||"SCTE35-CMD"===e}var Tr=function(){return i((function(e,t,r){var i;if(void 0===r&&(r=0),this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(null==t?void 0:t.tagAnchor)||null,this.tagOrder=null!=(i=null==t?void 0:t.tagOrder)?i:r,t){var n=t.attr;for(var s in n)if(Object.prototype.hasOwnProperty.call(e,s)&&e[s]!==n[s]){Y.warn('DATERANGE tag attribute: "'+s+'" does not match for tags with ID: "'+e.ID+'"'),this._badValueForSameId=s;break}e=a(new yr({}),n,e);}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){var o=(null==t?void 0:t.endDate)||new Date(this.attr["END-DATE"]);A(o.getTime())&&(this._endDate=o);}}),[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"cue",get:function(){var e=this._cue;return void 0===e?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}},{key:"startTime",get:function(){var e=this.tagAnchor;return null===e||null===e.programDateTime?(Y.warn('Expected tagAnchor Fragment with PDT set for DateRange "'+this.id+'": '+e),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){var e=this._endDate||this._dateAtEnd;if(e)return e;var t=this.duration;return null!==t?this._dateAtEnd=new Date(this._startDate.getTime()+1e3*t):null}},{key:"duration",get:function(){if("DURATION"in this.attr){var e=this.attr.decimalFloatingPoint("DURATION");if(A(e))return e}else if(this._endDate)return (this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return "PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}},{key:"endOnNext",get:function(){return this.attr.bool("END-ON-NEXT")}},{key:"isInterstitial",get:function(){return "com.apple.hls.interstitial"===this.class}},{key:"isValid",get:function(){return !!this.id&&!this._badValueForSameId&&A(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}])}(),Sr=function(){function e(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e;}var t=e.prototype;return t.reloaded=function(e){if(!e)return this.advanced=!0,void(this.updated=!0);var t=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||0===t&&r>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1;},t.hasKey=function(e){return this.encryptedFragments.some((function(t){var r=t.decryptdata;return r||(t.setKeyFormat(e.keyFormat),r=t.decryptdata),!!r&&e.matches(r)}))},i(e,[{key:"hasProgramDateTime",get:function(){return !!this.fragments.length&&A(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var e=this.driftEndTime-this.driftStartTime;return e>0?1e3*(this.driftEnd-this.driftStart)/e:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}},{key:"fragmentStart",get:function(){return this.fragments.length?this.fragments[0].start:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}},{key:"maxPartIndex",get:function(){var e=this.partList;if(e){var t=this.lastPartIndex;if(-1!==t){for(var r=e.length;r--;)if(e[r].index>t)return e[r].index;return t}}return 0}},{key:"lastPartSn",get:function(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}},{key:"expired",get:function(){if(this.live&&this.age&&this.misses<3){var e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return !1}}])}();function Ar(e,t){return e.length===t.length&&!e.some((function(e,r){return e!==t[r]}))}function Lr(e,t){return !e&&!t||!(!e||!t)&&Ar(e,t)}function Ir(e){return "AES-128"===e||"AES-256"===e||"AES-256-CTR"===e}function Rr(e){switch(e){case"AES-128":case"AES-256":return zt;case"AES-256-CTR":return $t;default:throw new Error("invalid full segment method "+e)}}function kr(e){return Uint8Array.from(atob(e),(function(e){return e.charCodeAt(0)}))}function br(e){return Uint8Array.from(unescape(encodeURIComponent(e)),(function(e){return e.charCodeAt(0)}))}function Dr(e){var t=function(e,t,r){var i=e[t];e[t]=e[r],e[r]=i;};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7);}function _r(e){var t,r,i=e.split(":"),n=null;if("data"===i[0]&&2===i.length){var a=i[1].split(";"),s=a[a.length-1].split(",");if(2===s.length){var o="base64"===s[0],l=s[1];o?(a.splice(-1,1),n=kr(l)):(t=br(l).subarray(0,16),(r=new Uint8Array(16)).set(t,16-t.length),n=r);}}return n}var Pr="undefined"!=typeof self?self:void 0,Cr={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},wr="org.w3.clearkey",Or="com.apple.streamingkeydelivery",xr="com.microsoft.playready",Mr="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function Fr(e){switch(e){case Or:return Cr.FAIRPLAY;case xr:return Cr.PLAYREADY;case Mr:return Cr.WIDEVINE;case wr:return Cr.CLEARKEY}}function Nr(e){switch(e){case Cr.FAIRPLAY:return Or;case Cr.PLAYREADY:return xr;case Cr.WIDEVINE:return Mr;case Cr.CLEARKEY:return wr}}function Ur(e){var t=e.drmSystems,r=e.widevineLicenseUrl,i=t?[Cr.FAIRPLAY,Cr.WIDEVINE,Cr.PLAYREADY,Cr.CLEARKEY].filter((function(e){return !!t[e]})):[];return !i[Cr.WIDEVINE]&&r&&i.push(Cr.WIDEVINE),i}var Br,Gr=null!=Pr&&null!=(Br=Pr.navigator)&&Br.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;function Kr(e){var t=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),r=String.fromCharCode.apply(null,Array.from(t)),i=r.substring(r.indexOf("<"),r.length),n=(new DOMParser).parseFromString(i,"text/xml").getElementsByTagName("KID")[0];if(n){var a=n.childNodes[0]?n.childNodes[0].nodeValue:n.getAttribute("VALUE");if(a){var s=kr(a).subarray(0,16);return Dr(s),s}}return null}var Vr={},Hr=function(){function e(e,t,r,i,n,a){void 0===i&&(i=[1]),void 0===n&&(n=null),this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=r,this.keyFormatVersions=i,this.iv=n,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&!Ir(e),null!=a&&a.startsWith("0x")&&(this.keyId=new Uint8Array(Q(a)));}e.clearKeyUriToKeyIdMap=function(){Vr={};},e.setKeyIdForUri=function(e,t){Vr[e]=t;};var t=e.prototype;return t.matches=function(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&Ar(e.keyFormatVersions,this.keyFormatVersions)&&Lr(e.iv,this.iv)&&Lr(e.keyId,this.keyId)},t.isSupported=function(){if(this.method){if(Ir(this.method)||"NONE"===this.method)return !0;if("identity"===this.keyFormat)return "SAMPLE-AES"===this.method;switch(this.keyFormat){case Or:case Mr:case xr:case wr:return -1!==["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return !1},t.getDecryptData=function(t,r){if(!this.encrypted||!this.uri)return null;if(Ir(this.method)){var i=this.iv;return i||("number"!=typeof t&&(Y.warn('missing IV for initialization segment with method="'+this.method+'" - compliance issue'),t=0),i=function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t}(t)),new e(this.method,this.uri,"identity",this.keyFormatVersions,i)}if(this.keyId){var n=Vr[this.uri];if(n&&!Ar(this.keyId,n)&&e.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}var a,s=_r(this.uri);if(s)switch(this.keyFormat){case Mr:if(this.pssh=s,!this.keyId){var o=function(e){var t=[];if(e instanceof ArrayBuffer)for(var r=e.byteLength,i=0;i+32<r;){var n=Pe(new DataView(e,i));t.push(n),i+=n.size;}return t}(s.buffer);if(o.length){var l,u=o[0];this.keyId=null!=(l=u.kids)&&l.length?u.kids[0]:null;}}this.keyId||(this.keyId=Yr(r));break;case xr:var d=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=_e(d,0,s),this.keyId=Kr(s);break;default:var h=s.subarray(0,16);if(16!==h.length){var f=new Uint8Array(16);f.set(h,16-h.length),h=f;}this.keyId=h;}return this.keyId&&16===this.keyId.byteLength||(a=function(e){var t=null==e?void 0:e[Mr];return t?t.keyId:null}(r),a||(a=Yr(r))||(a=Vr[this.uri]),a&&(this.keyId=a,e.setKeyIdForUri(this.uri,a))),this},e}();function Yr(e){var t=null==e?void 0:e[xr];if(t){var r=_r(t.uri);if(r)return Kr(r)}return null}var Wr=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,jr=/#EXT-X-MEDIA:(.*)/g,qr=/^#EXT(?:INF|-X-TARGETDURATION):/m,Xr=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),Qr=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),zr=function(){function e(){}return e.findGroup=function(e,t){for(var r=0;r<e.length;r++){var i=e[r];if(i.id===t)return i}},e.resolve=function(e,t){return S.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},e.isMediaPlaylist=function(e){return qr.test(e)},e.parseMasterPlaylist=function(t,r){var i,n={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:fr(t)},a=[];if(Wr.lastIndex=0,!t.startsWith("#EXTM3U"))return n.playlistParsingError=new Error("no EXTM3U delimiter"),n;for(;null!=(i=Wr.exec(t));)if(i[1]){var s,o=new yr(i[1],n),l=cr(n,i[2]),u={attrs:o,bitrate:o.decimalInteger("BANDWIDTH")||o.decimalInteger("AVERAGE-BANDWIDTH"),name:o.NAME,url:e.resolve(l,r)},d=o.decimalResolution("RESOLUTION");d&&(u.width=d.width,u.height=d.height),ti(o.CODECS,u);var h=o["SUPPLEMENTAL-CODECS"];h&&(u.supplemental={},ti(h,u.supplemental)),null!=(s=u.unknownCodecs)&&s.length||a.push(u),n.levels.push(u);}else if(i[3]){var f=i[3],c=i[4];switch(f){case"SESSION-DATA":var g=new yr(c,n),v=g["DATA-ID"];v&&(null===n.sessionData&&(n.sessionData={}),n.sessionData[v]=g);break;case"SESSION-KEY":var m=Jr(c,r,n);m.encrypted&&m.isSupported()?(null===n.sessionKeys&&(n.sessionKeys=[]),n.sessionKeys.push(m)):Y.warn('[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "'+c+'"');break;case"DEFINE":gr(n,new yr(c,n),r);break;case"CONTENT-STEERING":var p=new yr(c,n);n.contentSteering={uri:e.resolve(p["SERVER-URI"],r),pathwayId:p["PATHWAY-ID"]||"."};break;case"START":n.startTimeOffset=ei(c);}}var y=a.length>0&&a.length<n.levels.length;return n.levels=y?a:n.levels,0===n.levels.length&&(n.playlistParsingError=new Error("no levels found in manifest")),n},e.parseMasterPlaylistMedia=function(t,r,i){var n,a={},s=i.levels,o={AUDIO:s.map((function(e){return {id:e.attrs.AUDIO,audioCodec:e.audioCodec}})),SUBTITLES:s.map((function(e){return {id:e.attrs.SUBTITLES,textCodec:e.textCodec}})),"CLOSED-CAPTIONS":[]},l=0;for(jr.lastIndex=0;null!==(n=jr.exec(t));){var u=new yr(n[1],i),d=u.TYPE;if(d){var h=o[d],f=a[d]||[];a[d]=f;var c=u.LANGUAGE,g=u["ASSOC-LANGUAGE"],v=u.CHANNELS,m=u.CHARACTERISTICS,p=u["INSTREAM-ID"],y={attrs:u,bitrate:0,id:l++,groupId:u["GROUP-ID"]||"",name:u.NAME||c||"",type:d,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:c,url:u.URI?e.resolve(u.URI,r):""};if(g&&(y.assocLang=g),v&&(y.channels=v),m&&(y.characteristics=m),p&&(y.instreamId=p),null!=h&&h.length){var E=e.findGroup(h,y.groupId)||h[0];ri(y,E,"audioCodec"),ri(y,E,"textCodec");}f.push(y);}}return a},e.parseLevelPlaylist=function(e,t,r,i,n,s){var o,l,u,d,h,f={url:t},c=new Sr(t),g=c.fragments,v=[],m=null,p=0,y=0,E=0,T=0,S=0,L=null,I=new re(i,f),R=-1,k=!1,b=null;if(Xr.lastIndex=0,c.m3u8=e,c.hasVariableRefs=fr(e),"#EXTM3U"!==(null==(o=Xr.exec(e))?void 0:o[0]))return c.playlistParsingError=new Error("Missing format identifier #EXTM3U"),c;for(;null!==(l=Xr.exec(e));){k&&(k=!1,(I=new re(i,f)).playlistOffset=E,I.setStart(E),I.sn=p,I.cc=T,S&&(I.bitrate=S),I.level=r,m&&(I.initSegment=m,m.rawProgramDateTime&&(I.rawProgramDateTime=m.rawProgramDateTime,m.rawProgramDateTime=null),b&&(I.setByteRange(b),b=null)));var D=l[1];if(D){I.duration=parseFloat(D);var _=(" "+l[2]).slice(1);I.title=_||null,I.tagList.push(_?["INF",D,_]:["INF",D]);}else if(l[3]){if(A(I.duration)){I.playlistOffset=E,I.setStart(E),d&&ai(I,d,c),I.sn=p,I.level=r,I.cc=T,g.push(I);var P=(" "+l[3]).slice(1);I.relurl=cr(c,P),ii(I,L,v),L=I,E+=I.duration,p++,y=0,k=!0;}}else {if(!(l=l[0].match(Qr))){Y.warn("No matches on slow regex match for level playlist!");continue}for(u=1;u<l.length&&void 0===l[u];u++);var C=(" "+l[u]).slice(1),w=(" "+l[u+1]).slice(1),O=l[u+2]?(" "+l[u+2]).slice(1):null;switch(C){case"BYTERANGE":L?I.setByteRange(w,L):I.setByteRange(w);break;case"PROGRAM-DATE-TIME":I.rawProgramDateTime=w,I.tagList.push(["PROGRAM-DATE-TIME",w]),-1===R&&(R=g.length);break;case"PLAYLIST-TYPE":c.type&&si(c,C,l),c.type=w.toUpperCase();break;case"MEDIA-SEQUENCE":0!==c.startSN?si(c,C,l):g.length>0&&oi(c,C,l),p=c.startSN=parseInt(w);break;case"SKIP":c.skippedSegments&&si(c,C,l);var x=new yr(w,c),M=x.decimalInteger("SKIPPED-SEGMENTS");if(A(M)){c.skippedSegments+=M;for(var F=M;F--;)g.push(null);p+=M;}var N=x.enumeratedString("RECENTLY-REMOVED-DATERANGES");N&&(c.recentlyRemovedDateranges=(c.recentlyRemovedDateranges||[]).concat(N.split("\t")));break;case"TARGETDURATION":0!==c.targetduration&&si(c,C,l),c.targetduration=Math.max(parseInt(w),1);break;case"VERSION":null!==c.version&&si(c,C,l),c.version=parseInt(w);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":c.live||si(c,C,l),c.live=!1;break;case"#":(w||O)&&I.tagList.push(O?[w,O]:[w]);break;case"DISCONTINUITY":T++,I.tagList.push(["DIS"]);break;case"GAP":I.gap=!0,I.tagList.push([C]);break;case"BITRATE":I.tagList.push([C,w]),S=1e3*parseInt(w),A(S)?I.bitrate=S:S=0;break;case"DATERANGE":var U=new yr(w,c),B=new Tr(U,c.dateRanges[U.ID],c.dateRangeTagCount);c.dateRangeTagCount++,B.isValid||c.skippedSegments?c.dateRanges[B.id]=B:Y.warn('Ignoring invalid DATERANGE tag: "'+w+'"'),I.tagList.push(["EXT-X-DATERANGE",w]);break;case"DEFINE":var G=new yr(w,c);"IMPORT"in G?vr(c,G,s):gr(c,G,t);break;case"DISCONTINUITY-SEQUENCE":0!==c.startCC?si(c,C,l):g.length>0&&oi(c,C,l),c.startCC=T=parseInt(w);break;case"KEY":var K=Jr(w,t,c);if(K.isSupported()){if("NONE"===K.method){d=void 0;break}d||(d={});var V=d[K.keyFormat];null!=V&&V.matches(K)||(V&&(d=a({},d)),d[K.keyFormat]=K);}else Y.warn('[Keys] Ignoring unsupported EXT-X-KEY tag: "'+w+'"');break;case"START":c.startTimeOffset=ei(w);break;case"MAP":var H=new yr(w,c);if(I.duration){var W=new re(i,f);ni(W,H,r,d),m=W,I.initSegment=m,m.rawProgramDateTime&&!I.rawProgramDateTime&&(I.rawProgramDateTime=m.rawProgramDateTime);}else {var j=I.byteRangeEndOffset;if(j){var q=I.byteRangeStartOffset;b=j-q+"@"+q;}else b=null;ni(I,H,r,d),m=I,k=!0;}m.cc=T;break;case"SERVER-CONTROL":h&&si(c,C,l),h=new yr(w),c.canBlockReload=h.bool("CAN-BLOCK-RELOAD"),c.canSkipUntil=h.optionalFloat("CAN-SKIP-UNTIL",0),c.canSkipDateRanges=c.canSkipUntil>0&&h.bool("CAN-SKIP-DATERANGES"),c.partHoldBack=h.optionalFloat("PART-HOLD-BACK",0),c.holdBack=h.optionalFloat("HOLD-BACK",0);break;case"PART-INF":c.partTarget&&si(c,C,l);var X=new yr(w);c.partTarget=X.decimalFloatingPoint("PART-TARGET");break;case"PART":var Q=c.partList;Q||(Q=c.partList=[]);var z=y>0?Q[Q.length-1]:void 0,$=y++,Z=new yr(w,c),J=new ie(Z,I,f,$,z);Q.push(J),I.duration+=J.duration;break;case"PRELOAD-HINT":var ee=new yr(w,c);c.preloadHint=ee;break;case"RENDITION-REPORT":var te=new yr(w,c);c.renditionReports=c.renditionReports||[],c.renditionReports.push(te);break;default:Y.warn("line parsed but not handled: "+l);}}}L&&!L.relurl?(g.pop(),E-=L.duration,c.partList&&(c.fragmentHint=L)):c.partList&&(ii(I,L,v),I.cc=T,c.fragmentHint=I,d&&ai(I,d,c)),c.targetduration||(c.playlistParsingError=new Error("Missing Target Duration"));var ne=g.length,ae=g[0],se=g[ne-1];if((E+=c.skippedSegments*c.targetduration)>0&&ne&&se){c.averagetargetduration=E/ne;var oe=se.sn;c.endSN="initSegment"!==oe?oe:0,c.live||(se.endList=!0),R>0&&(function(e,t){for(var r=e[t],i=t;i--;){var n=e[i];if(!n)return;n.programDateTime=r.programDateTime-1e3*n.duration,r=n;}}(g,R),ae&&v.unshift(ae));}return c.fragmentHint&&(E+=c.fragmentHint.duration),c.totalduration=E,v.length&&c.dateRangeTagCount&&ae&&$r(v,c),c.endCC=T,c},e}();function $r(e,t){var r=e.length;if(!r){if(!t.hasProgramDateTime)return;var i=t.fragments[t.fragments.length-1];e.push(i),r++;}for(var n=e[r-1],a=t.live?1/0:t.totalduration,s=Object.keys(t.dateRanges),o=s.length;o--;){var l=t.dateRanges[s[o]],u=l.startDate.getTime();l.tagAnchor=n.ref;for(var d=r;d--;){var h;if((null==(h=e[d])?void 0:h.sn)<t.startSN)break;var f=Zr(t,u,e,d,a);if(-1!==f){l.tagAnchor=t.fragments[f].ref;break}}}}function Zr(e,t,r,i,n){var a=r[i];if(a){var s,o=a.programDateTime;if((t>=o||0===i)&&t<=o+1e3*(((null==(s=r[i+1])?void 0:s.start)||n)-a.start)){var l=r[i].sn-e.startSN;if(l<0)return -1;var u=e.fragments;if(u.length>r.length)for(var d=(r[i+1]||u[u.length-1]).sn-e.startSN;d>l;d--){var h=u[d].programDateTime;if(t>=h&&t<h+1e3*u[d].duration)return d}return l}}return -1}function Jr(e,t,r){var i,n,a=new yr(e,r),s=null!=(i=a.METHOD)?i:"",o=a.URI,l=a.hexadecimalInteger("IV"),u=a.KEYFORMATVERSIONS,d=null!=(n=a.KEYFORMAT)?n:"identity";o&&a.IV&&!l&&Y.error("Invalid IV: "+a.IV);var h=o?zr.resolve(o,t):"",f=(u||"1").split("/").map(Number).filter(Number.isFinite);return new Hr(s,h,d,f,l,a.KEYID)}function ei(e){var t=new yr(e).decimalFloatingPoint("TIME-OFFSET");return A(t)?t:null}function ti(e,t){var r=(e||"").split(/[ ,]+/).filter((function(e){return e}));["video","audio","text"].forEach((function(e){var i=r.filter((function(t){return Oe(t,e)}));i.length&&(t[e+"Codec"]=i.map((function(e){return e.split("/")[0]})).join(","),r=r.filter((function(e){return -1===i.indexOf(e)})));})),t.unknownCodecs=r;}function ri(e,t,r){var i=t[r];i&&(e[r]=i);}function ii(e,t,r){e.rawProgramDateTime?r.push(e):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime);}function ni(e,t,r,i){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=r,e.sn="initSegment",i&&(e.levelkeys=i),e.initSegment=null;}function ai(e,t,r){e.levelkeys=t;var i=r.encryptedFragments;i.length&&i[i.length-1].levelkeys===t||!Object.keys(t).some((function(e){return t[e].isCommonEncryption}))||i.push(e);}function si(e,t,r){e.playlistParsingError=new Error("#EXT-X-"+t+" must not appear more than once ("+r[0]+")");}function oi(e,t,r){e.playlistParsingError=new Error("#EXT-X-"+t+" must appear before the first Media Segment ("+r[0]+")");}function li(e,t){var r=t.startPTS;if(A(r)){var i,n=0;t.sn>e.sn?(n=r-e.start,i=e):(n=e.start-r,i=t),i.duration!==n&&i.setDuration(n);}else t.sn>e.sn?e.cc===t.cc&&e.minEndPTS?t.setStart(e.start+(e.minEndPTS-e.start)):t.setStart(e.start+e.duration):t.setStart(Math.max(e.start-t.duration,0));}function ui(e,t,r,i,n,a,s){i-r<=0&&(s.warn("Fragment should have a positive duration",t),i=r+t.duration,a=n+t.duration);var o=r,l=i,u=t.startPTS,d=t.endPTS;if(A(u)){var h=Math.abs(u-r);e&&h>e.totalduration?s.warn("media timestamps and playlist times differ by "+h+"s for level "+t.level+" "+e.url):A(t.deltaPTS)?t.deltaPTS=Math.max(h,t.deltaPTS):t.deltaPTS=h,o=Math.max(r,u),r=Math.min(r,u),n=void 0!==t.startDTS?Math.min(n,t.startDTS):n,l=Math.min(i,d),i=Math.max(i,d),a=void 0!==t.endDTS?Math.max(a,t.endDTS):a;}var f=r-t.start;0!==t.start&&t.setStart(r),t.setDuration(i-t.start),t.startPTS=r,t.maxStartPTS=o,t.startDTS=n,t.endPTS=i,t.minEndPTS=l,t.endDTS=a;var c,g=t.sn;if(!e||g<e.startSN||g>e.endSN)return 0;var v=g-e.startSN,m=e.fragments;for(m[v]=t,c=v;c>0;c--)li(m[c],m[c-1]);for(c=v;c<m.length-1;c++)li(m[c],m[c+1]);return e.fragmentHint&&li(m[m.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,f}function di(e,t,r){if(e!==t){for(var i,n=null,s=e.fragments,o=s.length-1;o>=0;o--){var l=s[o].initSegment;if(l){n=l;break}}e.fragmentHint&&delete e.fragmentHint.endPTS,function(e,t,r){for(var i=t.skippedSegments,n=Math.max(e.startSN,t.startSN)-t.startSN,a=(e.fragmentHint?1:0)+(i?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,s=t.startSN-e.startSN,o=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,u=n;u<=a;u++){var d=l[s+u],h=o[u];if(i&&!h&&d&&(h=t.fragments[u]=d),d&&h){r(d,h,u,o);var f=d.relurl,c=h.relurl;if(f&&Ei(f,c))return void(t.playlistParsingError=hi("media sequence mismatch "+h.sn+":",e,t,0,h));if(d.cc!==h.cc)return void(t.playlistParsingError=hi("discontinuity sequence mismatch ("+d.cc+"!="+h.cc+")",e,t,0,h))}}}(e,t,(function(e,r,a,s){if((!t.startCC||t.skippedSegments)&&r.cc!==e.cc){for(var o=e.cc-r.cc,l=a;l<s.length;l++)s[l].cc+=o;t.endCC=s[s.length-1].cc;}A(e.startPTS)&&A(e.endPTS)&&(r.setStart(r.startPTS=e.startPTS),r.startDTS=e.startDTS,r.maxStartPTS=e.maxStartPTS,r.endPTS=e.endPTS,r.endDTS=e.endDTS,r.minEndPTS=e.minEndPTS,r.setDuration(e.endPTS-e.startPTS),r.duration&&(i=r),t.PTSKnown=t.alignedSliding=!0),e.hasStreams&&(r.elementaryStreams=e.elementaryStreams),r.loader=e.loader,e.hasStats&&(r.stats=e.stats),e.initSegment&&(r.initSegment=e.initSegment,n=e.initSegment);}));var u=t.fragments,d=t.fragmentHint?u.concat(t.fragmentHint):u;if(n&&d.forEach((function(e){var t;!e||e.initSegment&&e.initSegment.relurl!==(null==(t=n)?void 0:t.relurl)||(e.initSegment=n);})),t.skippedSegments){if(t.deltaUpdateFailed=u.some((function(e){return !e})),t.deltaUpdateFailed){r.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var h=t.skippedSegments;h--;)u.shift();t.startSN=u[0].sn;}else {t.canSkipDateRanges&&(t.dateRanges=function(e,t,r){var i=t.dateRanges,n=t.recentlyRemovedDateranges,s=a({},e);n&&n.forEach((function(e){delete s[e];}));var o=Object.keys(s).length;return o?(Object.keys(i).forEach((function(e){var t=s[e],n=new Tr(i[e].attr,t);n.isValid?(s[e]=n,t||(n.tagOrder+=o)):r.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+ut(i[e].attr)+'"');})),s):i}(e.dateRanges,t,r));var f=e.fragments.filter((function(e){return e.rawProgramDateTime}));if(e.hasProgramDateTime&&!t.hasProgramDateTime)for(var c=1;c<d.length;c++)null===d[c].programDateTime&&ii(d[c],d[c-1],f);$r(f,t);}t.endCC=u[u.length-1].cc;}if(!t.startCC){var g,v=vi(e,t.startSN-1);t.startCC=null!=(g=null==v?void 0:v.cc)?g:u[0].cc;}!function(e,t,r){if(e&&t)for(var i=0,n=0,a=e.length;n<=a;n++){var s=e[n],o=t[n+i];s&&o&&s.index===o.index&&s.fragment.sn===o.fragment.sn?r(s,o):i--;}}(e.partList,t.partList,(function(e,t){t.elementaryStreams=e.elementaryStreams,t.stats=e.stats;})),i?ui(t,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS,r):fi(e,t),u.length&&(t.totalduration=t.edge-u[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;var m=t.advancedDateTime;if(t.advanced&&m){var p=t.edge;t.driftStart||(t.driftStartTime=m,t.driftStart=p),t.driftEndTime=m,t.driftEnd=p;}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime;-1===t.requestScheduled&&(t.requestScheduled=e.requestScheduled);}}function hi(e,t,r,i,n){return new Error(e+" "+n.url+"\nPlaylist starting @"+t.startSN+"\n"+t.m3u8+"\n\nPlaylist starting @"+r.startSN+"\n"+r.m3u8)}function fi(e,t,r){void 0===r&&(r=!0);var i=t.startSN+t.skippedSegments-e.startSN,n=e.fragments,a=i>=0,s=0;if(a&&i<n.length)s=n[i].start;else if(a&&t.startSN===e.endSN+1)s=e.fragmentEnd;else if(a&&r)s=e.fragmentStart+i*t.levelTargetDuration;else {if(t.skippedSegments||0!==t.fragmentStart)return;s=e.fragmentStart;}ci(t,s);}function ci(e,t){if(t){for(var r=e.fragments,i=e.skippedSegments;i<r.length;i++)r[i].addStart(t);e.fragmentHint&&e.fragmentHint.addStart(t);}}function gi(e,t){void 0===t&&(t=1/0);var r=1e3*e.targetduration;if(e.updated){var i=e.fragments;if(i.length&&4*r>t){var n=1e3*i[i.length-1].duration;n<r&&(r=n);}}else r/=2;return Math.round(r)}function vi(e,t,r){if(!e)return null;var i=e.fragments[t-e.startSN];return i||((i=e.fragmentHint)&&i.sn===t?i:t<e.startSN&&r&&r.sn===t?r:null)}function mi(e,t,r){return e?pi(e.partList,t,r):null}function pi(e,t,r){if(e)for(var i=e.length;i--;){var n=e[i];if(n.index===r&&n.fragment.sn===t)return n}return null}function yi(e){e.forEach((function(e,t){var r;null==(r=e.details)||r.fragments.forEach((function(e){e.level=t,e.initSegment&&(e.initSegment.level=t);}));}));}function Ei(e,t){return !(e===t||!t)&&Ti(e)!==Ti(t)}function Ti(e){return e.replace(/\?[^?]*$/,"")}function Si(e,t){for(var r=0,i=e.length;r<i;r++){var n;if((null==(n=e[r])?void 0:n.cc)===t)return e[r]}return null}function Ai(e,t){var r=e.start+t;e.startPTS=r,e.setStart(r),e.endPTS=r+e.duration;}function Li(e,t){for(var r=t.fragments,i=0,n=r.length;i<n;i++)Ai(r[i],e);t.fragmentHint&&Ai(t.fragmentHint,e),t.alignedSliding=!0;}function Ii(e,t){if(function(e,t){return !!(e&&t.startCC<e.endCC&&t.endCC>e.startCC)}(t,e)){var r=Math.min(t.endCC,e.endCC),i=Si(t.fragments,r),n=Si(e.fragments,r);i&&n&&(Y.log("Aligning playlist at start of dicontinuity sequence "+r),Li(i.start-n.start,e));}}function Ri(e,t){if(e.hasProgramDateTime&&t.hasProgramDateTime){var r=e.fragments,i=t.fragments;if(r.length&&i.length){var n,a,s=Math.min(t.endCC,e.endCC);t.startCC<s&&e.startCC<s&&(n=Si(i,s),a=Si(r,s)),n&&a||(a=Si(r,(n=i[Math.floor(i.length/2)]).cc)||r[Math.floor(r.length/2)]);var o=n.programDateTime,l=a.programDateTime;o&&l&&Li((l-o)/1e3-(a.start-n.start),e);}}}function ki(e,t,r){bi(e,t,r),e.addEventListener(t,r);}function bi(e,t,r){e.removeEventListener(t,r);}var Di=function(e){for(var t="",r=e.length,i=0;i<r;i++)t+="["+e.start(i).toFixed(3)+"-"+e.end(i).toFixed(3)+"]";return t},_i={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},Pi=function(e){function t(t,r,i,n,a){var s;return (s=e.call(this,n,t.logger)||this).hls=void 0,s.fragPrevious=null,s.fragCurrent=null,s.fragmentTracker=void 0,s.transmuxer=null,s._state=_i.STOPPED,s.playlistType=void 0,s.media=null,s.mediaBuffer=null,s.config=void 0,s.bitrateTest=!1,s.lastCurrentTime=0,s.nextLoadPosition=0,s.startPosition=0,s.startTimeOffset=null,s.retryDate=0,s.levels=null,s.fragmentLoader=void 0,s.keyLoader=void 0,s.levelLastLoaded=null,s.startFragRequested=!1,s.decrypter=void 0,s.initPTS=[],s.buffering=!0,s.loadingParts=!1,s.loopSn=void 0,s.onMediaSeeking=function(){var e=s,t=e.config,r=e.fragCurrent,i=e.media,n=e.mediaBuffer,a=e.state,o=i?i.currentTime:0,l=dr.bufferInfo(n||i,o,t.maxBufferHole),u=!l.len;if(s.log("Media seeking to "+(A(o)?o.toFixed(3):o)+", state: "+a+", "+(u?"out of":"in")+" buffer"),s.state===_i.ENDED)s.resetLoadingState();else if(r){var d=t.maxFragLookUpTolerance,h=r.start-d,f=r.start+r.duration+d;if(u||f<l.start||h>l.end){var c=o>f;(o<h||c)&&(c&&r.loader&&(s.log("Cancelling fragment load for seek (sn: "+r.sn+")"),r.abortRequests(),s.resetLoadingState()),s.fragPrevious=null);}}if(i&&(s.fragmentTracker.removeFragmentsInRange(o,1/0,s.playlistType,!0),o>s.lastCurrentTime&&(s.lastCurrentTime=o),!s.loadingParts)){var g=Math.max(l.end,o),v=s.shouldLoadParts(s.getLevelDetails(),g);v&&(s.log("LL-Part loading ON after seeking to "+o.toFixed(2)+" with buffer @"+g.toFixed(2)),s.loadingParts=v);}s.hls.hasEnoughToStart||(s.log("Setting "+(u?"startPosition":"nextLoadPosition")+" to "+o+" for seek without enough to start"),s.nextLoadPosition=o,u&&(s.startPosition=o)),u&&s.state===_i.IDLE&&s.tickImmediate();},s.onMediaEnded=function(){s.log("setting startPosition to 0 because media ended"),s.startPosition=s.lastCurrentTime=0;},s.playlistType=a,s.hls=t,s.fragmentLoader=new ir(t.config),s.keyLoader=i,s.fragmentTracker=r,s.config=t.config,s.decrypter=new tr(t.config),s}o(t,e);var r=t.prototype;return r.registerListeners=function(){var e=this.hls;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(b.ERROR,this.onError,this);},r.unregisterListeners=function(){var e=this.hls;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(b.ERROR,this.onError,this);},r.doTick=function(){this.onTickEnd();},r.onTickEnd=function(){},r.startLoad=function(e){},r.stopLoad=function(){if(this.state!==_i.STOPPED){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);var e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=_i.STOPPED;}},r.pauseBuffering=function(){this.buffering=!1;},r.resumeBuffering=function(){this.buffering=!0;},r._streamEnded=function(e,t){if(t.live||!this.media)return !1;var r=e.end||0,i=this.config.timelineOffset||0;if(r<=i)return !1;var n=e.buffered;this.config.maxBufferHole&&n&&n.length>1&&(e=dr.bufferedInfo(n,e.start,0));var a=e.nextStart;if(a&&a>i&&a<t.edge)return !1;if(this.media.currentTime<e.start)return !1;var s=t.partList;if(null!=s&&s.length){var o=s[s.length-1];return dr.isBuffered(this.media,o.start+o.duration/2)}var l=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(l)},r.getLevelDetails=function(){if(this.levels&&null!==this.levelLastLoaded)return this.levelLastLoaded.details},r.onMediaAttached=function(e,t){var r=this.media=this.mediaBuffer=t.media;ki(r,"seeking",this.onMediaSeeking),ki(r,"ended",this.onMediaEnded);var i=this.config;this.levels&&i.autoStartLoad&&this.state===_i.STOPPED&&this.startLoad(i.startPosition);},r.onMediaDetaching=function(e,t){var r=!!t.transferMedia,i=this.media;if(null!==i){if(i.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),bi(i,"seeking",this.onMediaSeeking),bi(i,"ended",this.onMediaEnded),this.keyLoader&&!r&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,r)return this.resetLoadingState(),void this.resetTransmuxer();this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad();}},r.onManifestLoading=function(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1;},r.onError=function(e,t){},r.onManifestLoaded=function(e,t){this.startTimeOffset=t.startTimeOffset;},r.onHandlerDestroying=function(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),e.prototype.onHandlerDestroying.call(this),this.hls=this.onMediaSeeking=this.onMediaEnded=null;},r.onHandlerDestroyed=function(){this.state=_i.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,e.prototype.onHandlerDestroyed.call(this);},r.loadFragment=function(e,t,r){this.startFragRequested=!0,this._loadFragForPlayback(e,t,r);},r._loadFragForPlayback=function(e,t,r){var i=this;this._doFragLoad(e,t,r,(function(e){var t=e.frag;if(i.fragContextChanged(t))return i.warn(t.type+" sn: "+t.sn+(e.part?" part: "+e.part.index:"")+" of "+i.fragInfo(t,!1,e.part)+") was dropped during download."),void i.fragmentTracker.removeFragment(t);t.stats.chunkCount++,i._handleFragmentLoadProgress(e);})).then((function(e){if(e){var t=i.state,r=e.frag;i.fragContextChanged(r)?(t===_i.FRAG_LOADING||!i.fragCurrent&&t===_i.PARSING)&&(i.fragmentTracker.removeFragment(r),i.state=_i.IDLE):("payload"in e&&(i.log("Loaded "+r.type+" sn: "+r.sn+" of "+i.playlistLabel()+" "+r.level),i.hls.trigger(b.FRAG_LOADED,e)),i._handleFragmentLoadComplete(e));}})).catch((function(t){i.state!==_i.STOPPED&&i.state!==_i.ERROR&&(i.warn("Frag error: "+((null==t?void 0:t.message)||t)),i.resetFragmentLoading(e));}));},r.clearTrackerIfNeeded=function(e){var t,r=this.fragmentTracker;if(r.getState(e)===Ht){var i=e.type,n=this.getFwdBufferInfo(this.mediaBuffer,i),a=Math.max(e.duration,n?n.len:this.config.maxBufferLength),s=this.backtrackFragment;(1==(s?e.sn-s.sn:0)||this.reduceMaxBufferLength(a,e.duration))&&r.removeFragment(e);}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===Yt&&r.removeFragment(e));},r.checkLiveUpdate=function(e){if(e.updated&&!e.live){var t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type});}e.fragments[0]||(e.deltaUpdateFailed=!0);},r.waitForLive=function(e){var t=e.details;return (null==t?void 0:t.live)&&"EVENT"!==t.type&&(this.levelLastLoaded!==e||t.expired)},r.flushMainBuffer=function(e,t,r){if(void 0===r&&(r=null),e-t){var i={startOffset:e,endOffset:t,type:r};this.hls.trigger(b.BUFFER_FLUSHING,i);}},r._loadInitSegment=function(e,t){var r=this;this._doFragLoad(e,t).then((function(e){var t=null==e?void 0:e.frag;if(!t||r.fragContextChanged(t)||!r.levels)throw new Error("init load aborted");return e})).then((function(e){var t=r.hls,i=e.frag,n=e.payload,a=i.decryptdata;if(n&&n.byteLength>0&&null!=a&&a.key&&a.iv&&Ir(a.method)){var s=self.performance.now();return r.decrypter.decrypt(new Uint8Array(n),a.key.buffer,a.iv.buffer,Rr(a.method)).catch((function(e){throw t.trigger(b.ERROR,{type:R.MEDIA_ERROR,details:k.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:i}),e})).then((function(n){var a=self.performance.now();return t.trigger(b.FRAG_DECRYPTED,{frag:i,payload:n,stats:{tstart:s,tdecrypt:a}}),e.payload=n,r.completeInitSegmentLoad(e)}))}return r.completeInitSegmentLoad(e)})).catch((function(t){r.state!==_i.STOPPED&&r.state!==_i.ERROR&&(r.warn(t),r.resetFragmentLoading(e));}));},r.completeInitSegmentLoad=function(e){if(!this.levels)throw new Error("init load aborted, missing levels");var t=e.frag.stats;this.state!==_i.STOPPED&&(this.state=_i.IDLE),e.frag.data=new Uint8Array(e.payload),t.parsing.start=t.buffering.start=self.performance.now(),t.parsing.end=t.buffering.end=self.performance.now(),this.tick();},r.unhandledEncryptionError=function(e,t){var r,i,n=e.tracks;if(n&&!t.encrypted&&(null!=(r=n.audio)&&r.encrypted||null!=(i=n.video)&&i.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){var a=this.media,s=new Error("Encrypted track with no key in "+this.fragInfo(t)+" (media "+(a?"attached mediaKeys: "+a.mediaKeys:"detached")+")");return this.warn(s.message),!(!a||a.mediaKeys)&&(this.hls.trigger(b.ERROR,{type:R.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_NO_KEYS,fatal:!1,error:s,frag:t}),this.resetTransmuxer(),!0)}return !1},r.fragContextChanged=function(e){var t=this.fragCurrent;return !e||!t||e.sn!==t.sn||e.level!==t.level},r.fragBufferedComplete=function(e,t){var r=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log("Buffered "+e.type+" sn: "+e.sn+(t?" part: "+t.index:"")+" of "+this.fragInfo(e,!1,t)+" > buffer:"+(r?Di(dr.getBuffered(r)):"(detached)")+")"),te(e)){var i;if(e.type!==x){var n=e.elementaryStreams;if(!Object.keys(n).some((function(e){return !!n[e]})))return void(this.state=_i.IDLE)}var a=null==(i=this.levels)?void 0:i[e.level];null!=a&&a.fragmentError&&(this.log("Resetting level fragment error count of "+a.fragmentError+" on frag buffered"),a.fragmentError=0);}this.state=_i.IDLE;},r._handleFragmentLoadComplete=function(e){var t=this.transmuxer;if(t){var r=e.frag,i=e.part,n=e.partsLoaded,a=!n||0===n.length||n.some((function(e){return !e})),s=new lr(r.level,r.sn,r.stats.chunkCount+1,0,i?i.index:-1,!a);t.flush(s);}},r._handleFragmentLoadProgress=function(e){},r._doFragLoad=function(e,t,r,i){var n,a=this;void 0===r&&(r=null),this.fragCurrent=e;var s=t.details;if(!this.levels||!s)throw new Error("frag load aborted, missing level"+(s?"":" detail")+"s");var o=null;if(!e.encrypted||null!=(n=e.decryptdata)&&n.key)e.encrypted||(o=this.keyLoader.loadClear(e,s.encryptedFragments,this.startFragRequested))&&this.log("[eme] blocking frag load until media-keys acquired");else if(this.log("Loading key for "+e.sn+" of ["+s.startSN+"-"+s.endSN+"], "+this.playlistLabel()+" "+e.level),this.state=_i.KEY_LOADING,this.fragCurrent=e,o=this.keyLoader.load(e).then((function(e){if(!a.fragContextChanged(e.frag))return a.hls.trigger(b.KEY_LOADED,e),a.state===_i.KEY_LOADING&&(a.state=_i.IDLE),e})),this.hls.trigger(b.KEY_LOADING,{frag:e}),null===this.fragCurrent)return this.log("context changed in KEY_LOADING"),Promise.resolve(null);var l,u=this.fragPrevious;if(te(e)&&(!u||e.sn!==u.sn)){var d=this.shouldLoadParts(t.details,e.end);d!==this.loadingParts&&(this.log("LL-Part loading "+(d?"ON":"OFF")+" loading sn "+(null==u?void 0:u.sn)+"->"+e.sn),this.loadingParts=d);}if(r=Math.max(e.start,r||0),this.loadingParts&&te(e)){var h=s.partList;if(h&&i){r>s.fragmentEnd&&s.fragmentHint&&(e=s.fragmentHint);var f=this.getNextPart(h,e,r);if(f>-1){var c,g=h[f];return e=this.fragCurrent=g.fragment,this.log("Loading "+e.type+" sn: "+e.sn+" part: "+g.index+" ("+f+"/"+(h.length-1)+") of "+this.fragInfo(e,!1,g)+") cc: "+e.cc+" ["+s.startSN+"-"+s.endSN+"], target: "+parseFloat(r.toFixed(3))),this.nextLoadPosition=g.start+g.duration,this.state=_i.FRAG_LOADING,c=o?o.then((function(r){return !r||a.fragContextChanged(r.frag)?null:a.doFragPartsLoad(e,g,t,i)})).catch((function(e){return a.handleFragLoadError(e)})):this.doFragPartsLoad(e,g,t,i).catch((function(e){return a.handleFragLoadError(e)})),this.hls.trigger(b.FRAG_LOADING,{frag:e,part:g,targetBufferTime:r}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):c}if(!e.url||this.loadedEndOfParts(h,r))return Promise.resolve(null)}}if(te(e)&&this.loadingParts)this.log("LL-Part loading OFF after next part miss @"+r.toFixed(2)+" Check buffer at sn: "+e.sn+" loaded parts: "+(null==(l=s.partList)?void 0:l.filter((function(e){return e.loaded})).map((function(e){return "["+e.start+"-"+e.end+"]"})))),this.loadingParts=!1;else if(!e.url)return Promise.resolve(null);this.log("Loading "+e.type+" sn: "+e.sn+" of "+this.fragInfo(e,!1)+") cc: "+e.cc+" ["+s.startSN+"-"+s.endSN+"], target: "+parseFloat(r.toFixed(3))),A(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=_i.FRAG_LOADING;var v,m=this.config.progressive;return v=m&&o?o.then((function(t){return !t||a.fragContextChanged(t.frag)?null:a.fragmentLoader.load(e,i)})).catch((function(e){return a.handleFragLoadError(e)})):Promise.all([this.fragmentLoader.load(e,m?i:void 0),o]).then((function(e){var t=e[0];return !m&&i&&i(t),t})).catch((function(e){return a.handleFragLoadError(e)})),this.hls.trigger(b.FRAG_LOADING,{frag:e,targetBufferTime:r}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):v},r.doFragPartsLoad=function(e,t,r,i){var n=this;return new Promise((function(a,s){var o,l=[],u=null==(o=r.details)?void 0:o.partList,d=function(t){n.fragmentLoader.loadPart(e,t,i).then((function(i){l[t.index]=i;var s=i.part;n.hls.trigger(b.FRAG_LOADED,i);var o=mi(r.details,e.sn,t.index+1)||pi(u,e.sn,t.index+1);if(!o)return a({frag:e,part:s,partsLoaded:l});d(o);})).catch(s);};d(t);}))},r.handleFragLoadError=function(e){if("data"in e){var t=e.data;t.frag&&t.details===k.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):t.frag&&t.type===R.KEY_SYSTEM_ERROR?(t.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(t.frag)):this.hls.trigger(b.ERROR,t);}else this.hls.trigger(b.ERROR,{type:R.OTHER_ERROR,details:k.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null},r._handleTransmuxerFlush=function(e){var t=this.getCurrentContext(e);if(t&&this.state===_i.PARSING){var r=t.frag,i=t.part,n=t.level,a=self.performance.now();r.stats.parsing.end=a,i&&(i.stats.parsing.end=a);var s=this.getLevelDetails(),o=s&&r.sn>s.endSN||this.shouldLoadParts(s,r.end);o!==this.loadingParts&&(this.log("LL-Part loading "+(o?"ON":"OFF")+" after parsing segment ending @"+r.end.toFixed(2)),this.loadingParts=o),this.updateLevelTiming(r,i,n,e.partial);}else this.fragCurrent||this.state===_i.STOPPED||this.state===_i.ERROR||(this.state=_i.IDLE);},r.shouldLoadParts=function(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var r,i,n=e.partList[0];if(n.fragment.type===x)return !1;if(t>=n.end+((null==(r=e.fragmentHint)?void 0:r.duration)||0)&&(this.hls.hasEnoughToStart?(null==(i=this.media)?void 0:i.currentTime)||this.lastCurrentTime:this.getLoadPosition())>n.start-n.fragment.duration)return !0}}return !1},r.getCurrentContext=function(e){var t=this.levels,r=this.fragCurrent,i=e.level,n=e.sn,a=e.part;if(null==t||!t[i])return this.warn("Levels object was unset while buffering fragment "+n+" of "+this.playlistLabel()+" "+i+". The current chunk will not be buffered."),null;var s=t[i],o=s.details,l=a>-1?mi(o,n,a):null,u=l?l.fragment:vi(o,n,r);return u?(r&&r!==u&&(u.stats=r.stats),{frag:u,part:l,level:s}):null},r.bufferFragmentData=function(e,t,r,i,n){if(this.state===_i.PARSING){var a=e.data1,s=e.data2,o=a;if(s&&(o=Le(a,s)),o.length){var l=this.initPTS[t.cc],u=l?-l.baseTime/l.timescale:void 0,d={type:e.type,frag:t,part:r,chunkMeta:i,offset:u,parent:t.type,data:o};if(this.hls.trigger(b.BUFFER_APPENDING,d),e.dropped&&e.independent&&!r){if(n)return;this.flushBufferGap(t);}}}},r.flushBufferGap=function(e){var t=this.media;if(t)if(dr.isBuffered(t,t.currentTime)){var r=t.currentTime,i=dr.bufferInfo(t,r,0),n=e.duration,a=Math.min(2*this.config.maxFragLookUpTolerance,.25*n),s=Math.max(Math.min(e.start-a,i.end-a),r+a);e.start-s>a&&this.flushMainBuffer(s,e.start);}else this.flushMainBuffer(0,e.start);},r.getFwdBufferInfo=function(e,t){var r,i=this.getLoadPosition();if(!A(i))return null;var n=this.lastCurrentTime>i||null!=(r=this.media)&&r.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,i,t,n)},r.getFwdBufferInfoAtPos=function(e,t,r,i){var n=dr.bufferInfo(e,t,i);if(0===n.len&&void 0!==n.nextStart){var a=this.fragmentTracker.getBufferedFrag(t,r);if(a&&(n.nextStart<=a.end||a.gap)){var s=Math.max(Math.min(n.nextStart,a.end)-t,i);return dr.bufferInfo(e,t,s)}}return n},r.getMaxBufferLength=function(e){var t,r=this.config;return t=e?Math.max(8*r.maxBufferSize/e,r.maxBufferLength):r.maxBufferLength,Math.min(t,r.maxMaxBufferLength)},r.reduceMaxBufferLength=function(e,t){var r=this.config,i=Math.max(Math.min(e-t,r.maxBufferLength),t),n=Math.max(e-3*t,r.maxMaxBufferLength/2,i);return n>=i&&(r.maxMaxBufferLength=n,this.warn("Reduce max buffer length to "+n+"s"),!0)},r.getAppendedFrag=function(e,t){void 0===t&&(t=w);var r=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,t):null;return r&&"fragment"in r?r.fragment:r},r.getNextFragment=function(e,t){var r=t.fragments,i=r.length;if(!i)return null;var n=this.config,a=r[0].start,s=n.lowLatencyMode&&!!t.partList,o=null;if(t.live){var l=n.initialLiveManifestSize;if(i<l)return this.warn("Not enough fragments to start playback (have: "+i+", need: "+l+")"),null;if(!t.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||e<a){var u;s&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),o=this.getInitialLiveFragment(t);var d=this.hls.startPosition,h=this.hls.liveSyncPosition,f=o?(-1!==d&&d>=a?d:h)||o.start:e;this.log("Setting startPosition to "+f+" to match start frag at live edge. mainStart: "+d+" liveSyncPosition: "+h+" frag.start: "+(null==(u=o)?void 0:u.start)),this.startPosition=this.nextLoadPosition=f;}}else e<=a&&(o=r[0]);if(!o){var c=this.loadingParts?t.partEnd:t.fragmentEnd;o=this.getFragmentAtPosition(e,c,t);}var g=this.filterReplacedPrimary(o,t);if(!g&&o){var v=o.sn-t.startSN;g=this.filterReplacedPrimary(r[v+1]||null,t);}return this.mapToInitFragWhenRequired(g)},r.isLoopLoading=function(e,t){var r=this.fragmentTracker.getState(e);return (r===Wt||r===Yt&&!!e.gap)&&this.nextLoadPosition>t},r.getNextFragmentLoopLoading=function(e,t,r,i,n){var a=null;if(e.gap&&(a=this.getNextFragment(this.nextLoadPosition,t))&&!a.gap&&r.nextStart){var s=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,i,0);if(null!==s&&r.len+s.len>=n){var o=a.sn;return this.loopSn!==o&&(this.log('buffer full after gaps in "'+i+'" playlist starting at sn: '+o),this.loopSn=o),null}}return this.loopSn=void 0,a},r.filterReplacedPrimary=function(e,t){if(!e)return e;if(Ci(this.config)&&e.type!==x){var r=this.hls.interstitialsManager,i=null==r?void 0:r.bufferingItem;if(i){var n=i.event;if(n){if(n.appendInPlace||Math.abs(e.start-i.start)>1||0===i.start)return null}else {if(e.end<=i.start&&!1===(null==t?void 0:t.live))return null;if(e.start>i.end&&i.nextEvent&&(i.nextEvent.appendInPlace||e.start-i.end>1))return null}}var a=null==r?void 0:r.playerQueue;if(a)for(var s=a.length;s--;){var o=a[s].interstitial;if(o.appendInPlace&&e.start>=o.startTime&&e.end<=o.resumeTime)return null}}return e},r.mapToInitFragWhenRequired=function(e){return null==e||!e.initSegment||e.initSegment.data||this.bitrateTest?e:e.initSegment},r.getNextPart=function(e,t,r){for(var i=-1,n=!1,a=!0,s=0,o=e.length;s<o;s++){var l=e[s];if(a=a&&!l.independent,i>-1&&r<l.start)break;var u=l.loaded;u?i=-1:(n||(l.independent||a)&&l.fragment===t)&&(l.fragment!==t&&this.warn("Need buffer at "+r+" but next unloaded part starts at "+l.start),i=s),n=u;}return i},r.loadedEndOfParts=function(e,t){for(var r,i=e.length;i--;){if(!(r=e[i]).loaded)return !1;if(t>r.start)return !0}return !1},r.getInitialLiveFragment=function(e){var t=e.fragments,r=this.fragPrevious,i=null;if(r){if(e.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+r.programDateTime),i=function(e,t,r){if(null===t||!Array.isArray(e)||!e.length||!A(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;for(var i=0;i<e.length;++i){var n=e[i];if(At(t,r,n))return n}return null}(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){var n=r.sn+1;if(n>=e.startSN&&n<=e.endSN){var a=t[n-e.startSN];r.cc===a.cc&&(i=a,this.log("Live playlist, switching playlist, load frag with next SN: "+i.sn));}i||(i=Lt(e,r.cc,r.end))&&this.log("Live playlist, switching playlist, load frag with same CC: "+i.sn);}}else {var s=this.hls.liveSyncPosition;null!==s&&(i=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e));}return i},r.getFragmentAtPosition=function(e,t,r){var i,n,a=this.config,s=this.fragPrevious,o=r.fragments,l=r.endSN,u=r.fragmentHint,d=a.maxFragLookUpTolerance,h=r.partList,f=!!(this.loadingParts&&null!=h&&h.length&&u);if(f&&!this.bitrateTest&&h[h.length-1].fragment.sn===u.sn&&(o=o.concat(u),l=u.sn),i=e<t?Tt(s,o,e,e<this.lastCurrentTime||e>t-d||null!=(n=this.media)&&n.paused||!this.startFragRequested?0:d):o[o.length-1]){var c=i.sn-r.startSN,g=this.fragmentTracker.getState(i);if((g===Wt||g===Yt&&i.gap)&&(s=i),s&&i.sn===s.sn&&(!f||h[0].fragment.sn>i.sn||!r.live)&&i.level===s.level){var v=o[c+1];i=i.sn<l&&this.fragmentTracker.getState(v)!==Wt?v:null;}}return i},r.alignPlaylists=function(e,t,r){var i=e.fragments.length;if(!i)return this.warn("No fragments in live playlist"),0;var n=e.fragmentStart,a=!t,s=e.alignedSliding&&A(n);if(a||!s&&!n){!function(e,t){e&&(Ii(t,e),t.alignedSliding||Ri(t,e),t.alignedSliding||t.skippedSegments||fi(e,t,!1));}(r,e);var o=e.fragmentStart;return this.log("Live playlist sliding: "+o.toFixed(2)+" start-sn: "+(t?t.startSN:"na")+"->"+e.startSN+" fragments: "+i),o}return n},r.waitForCdnTuneIn=function(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)},r.setStartPosition=function(e,t){var r=this.startPosition;r<t&&(r=-1);var i=this.timelineOffset;if(-1===r){var n=null!==this.startTimeOffset,a=n?this.startTimeOffset:e.startTimeOffset;null!==a&&A(a)?(r=t+a,a<0&&(r+=e.edge),r=Math.min(Math.max(t,r),t+e.totalduration),this.log("Setting startPosition to "+r+" for start time offset "+a+" found in "+(n?"multivariant":"media")+" playlist"),this.startPosition=r):e.live?(r=this.hls.liveSyncPosition||t,this.log("Setting startPosition to -1 to start at live edge "+r),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=r=0),this.lastCurrentTime=r+i;}this.nextLoadPosition=r+i;},r.getLoadPosition=function(){var e,t=this.media,r=0;return null!=(e=this.hls)&&e.hasEnoughToStart&&t?r=t.currentTime:this.nextLoadPosition>=0&&(r=this.nextLoadPosition),r},r.handleFragLoadAborted=function(e,t){this.transmuxer&&e.type===this.playlistType&&te(e)&&e.stats.aborted&&(this.log("Fragment "+e.sn+(t?" part "+t.index:"")+" of "+this.playlistLabel()+" "+e.level+" was aborted"),this.resetFragmentLoading(e));},r.resetFragmentLoading=function(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===_i.FRAG_LOADING_WAITING_RETRY)||(this.state=_i.IDLE);},r.onFragmentOrKeyLoadError=function(e,t){var r;if(t.chunkMeta&&!t.frag){var i=this.getCurrentContext(t.chunkMeta);i&&(t.frag=i.frag);}var n=t.frag;if(n&&n.type===e&&this.levels)if(this.fragContextChanged(n)){var a;this.warn("Frag load error must match current frag to retry "+n.url+" > "+(null==(a=this.fragCurrent)?void 0:a.url));}else {var s=t.details===k.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(n,!0);var o=t.errorAction;if(o){var l=o.action,u=o.flags,d=o.retryCount,h=void 0===d?0:d,f=o.retryConfig,c=!!f,g=c&&l===Mt,v=c&&!o.resolved&&u===Nt,m=null==(r=this.hls.latestLevelDetails)?void 0:r.live;if(!g&&v&&te(n)&&!n.endList&&m&&!kt(t))this.resetFragmentErrors(e),this.treatAsGap(n),o.resolved=!0;else if((g||v)&&h<f.maxNumRetry){var p,y=Ct(null==(p=t.response)?void 0:p.code),E=Dt(f,h);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+E,this.state=_i.FRAG_LOADING_WAITING_RETRY,o.resolved=!0,y)return this.log("Waiting for connection (offline)"),this.retryDate=1/0,void(t.reason="offline");this.warn("Fragment "+n.sn+" of "+e+" "+n.level+" errored with "+t.details+", retrying loading "+(h+1)+"/"+f.maxNumRetry+" in "+E+"ms");}else if(f){if(this.resetFragmentErrors(e),!(h<f.maxNumRetry))return void this.warn(t.details+" reached or exceeded max retry ("+h+")");s||l===xt||(o.resolved=!0);}else this.state=l===Ot?_i.WAITING_LEVEL:_i.ERROR;this.tickImmediate();}else this.state=_i.ERROR;}},r.checkRetryDate=function(){var e=self.performance.now(),t=this.retryDate,r=t===1/0;(!t||e>=t||r&&!Ct(0))&&(r&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=_i.IDLE);},r.reduceLengthAndFlushBuffer=function(e){if(this.state===_i.PARSING||this.state===_i.PARSED){var t=e.frag,r=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,r),n=i&&i.len>.5;n&&this.reduceMaxBufferLength(i.len,(null==t?void 0:t.duration)||10);var a=!n;return a&&this.warn("Buffer full error while media.currentTime ("+this.getLoadPosition()+") is not buffered, flush "+r+" buffer"),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),a}return !1},r.resetFragmentErrors=function(e){e===O&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==_i.STOPPED&&(this.state=_i.IDLE);},r.afterBufferFlushed=function(e,t,r){if(e){var i=dr.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,r),this.state===_i.ENDED&&this.resetLoadingState();}},r.resetLoadingState=function(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==_i.STOPPED&&(this.state=_i.IDLE);},r.resetStartWhenNotLoaded=function(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;var e=this.levelLastLoaded,t=e?e.details:null;null!=t&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition;}},r.resetWhenMissingContext=function(e){this.log("Loading context changed while buffering sn "+e.sn+" of "+this.playlistLabel()+" "+(-1===e.level?"<removed>":e.level)+". This chunk will not be buffered."),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState();},r.removeUnbufferedFrags=function(e){void 0===e&&(e=0),this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0);},r.updateLevelTiming=function(e,t,r,i){var n=this,a=r.details;if(a){var s;if(!Object.keys(e.elementaryStreams).reduce((function(t,s){var o=e.elementaryStreams[s];if(o){var l=o.endPTS-o.startPTS;if(l<=0)return n.warn("Could not parse fragment "+e.sn+" "+s+" duration reliably ("+l+")"),t||!1;var u=i?0:ui(a,e,o.startPTS,o.endPTS,o.startDTS,o.endDTS,n);return n.hls.trigger(b.LEVEL_PTS_UPDATED,{details:a,level:r,drift:u,type:s,frag:e,start:o.startPTS,end:o.endPTS}),!0}return t}),!1)&&(0===r.fragmentError&&this.treatAsGap(e,r),null===(null==(s=this.transmuxer)?void 0:s.error))){var o=new Error("Found no media in fragment "+e.sn+" of "+this.playlistLabel()+" "+e.level+" resetting transmuxer to fallback to playlist timing");if(this.warn(o.message),this.hls.trigger(b.ERROR,{type:R.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,fatal:!1,error:o,frag:e,reason:"Found no media in msn "+e.sn+" of "+this.playlistLabel()+' "'+r.url+'"'}),!this.hls)return;this.resetTransmuxer();}this.state=_i.PARSED,this.log("Parsed "+e.type+" sn: "+e.sn+(t?" part: "+t.index:"")+" of "+this.fragInfo(e,!1,t)+")"),this.hls.trigger(b.FRAG_PARSED,{frag:e,part:t});}else this.warn("level.details undefined");},r.playlistLabel=function(){return this.playlistType===w?"level":"track"},r.fragInfo=function(e,t,r){var i,n;return void 0===t&&(t=!0),this.playlistLabel()+" "+e.level+" ("+(r?"part":"frag")+":["+(null!=(i=t&&!r?e.startPTS:(r||e).start)?i:NaN).toFixed(3)+"-"+(null!=(n=t&&!r?e.endPTS:(r||e).end)?n:NaN).toFixed(3)+"]"+(r&&"main"===e.type?"INDEPENDENT="+(r.independent?"YES":"NO"):"")},r.treatAsGap=function(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0);},r.resetTransmuxer=function(){var e;null==(e=this.transmuxer)||e.reset();},r.recoverWorkerError=function(e){"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState());},i(t,[{key:"startPositionValue",get:function(){var e=this.nextLoadPosition,t=this.startPosition;return -1===t&&e?e:t}},{key:"bufferingEnabled",get:function(){return this.buffering}},{key:"inFlightFrag",get:function(){return {frag:this.fragCurrent,state:this.state}}},{key:"timelineOffset",get:function(){var e,t=this.config.timelineOffset;return t?(null==(e=this.getLevelDetails())?void 0:e.appliedTimelineOffset)||t:0}},{key:"primaryPrefetch",get:function(){var e;return !(!Ci(this.config)||!(null==(e=this.hls.interstitialsManager)||null==(e=e.playingItem)?void 0:e.event))}},{key:"state",get:function(){return this._state},set:function(e){var t=this._state;t!==e&&(this._state=e,this.log(t+"->"+e));}}])}(or);function Ci(e){return !!e.interstitialsController&&!1!==e.enableInterstitialPlayback}var wi=function(){function e(){this.chunks=[],this.dataLength=0;}var t=e.prototype;return t.push=function(e){this.chunks.push(e),this.dataLength+=e.length;},t.flush=function(){var e,t=this.chunks,r=this.dataLength;return t.length?(e=1===t.length?t[0]:function(e,t){for(var r=new Uint8Array(t),i=0,n=0;n<e.length;n++){var a=e[n];r.set(a,i),i+=a.length;}return r}(t,r),this.reset(),e):new Uint8Array(0)},t.reset=function(){this.chunks.length=0,this.dataLength=0;},e}();function Oi(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function xi(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function Mi(e,t){var r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,r|=(127&e[t+2])<<7,r|=127&e[t+3]}function Fi(e,t){for(var r=t,i=0;xi(e,t);)i+=10,i+=Mi(e,t+6),Oi(e,t+10)&&(i+=10),t+=i;if(i>0)return e.subarray(r,r+i)}function Ni(e,t){return 255===e[t]&&240==(246&e[t+1])}function Ui(e,t){return 1&e[t+1]?7:9}function Bi(e,t){return (3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function Gi(e,t){return t+1<e.length&&Ni(e,t)}function Ki(e,t){if(Gi(e,t)){var r=Ui(e,t);if(t+r>=e.length)return !1;var i=Bi(e,t);if(i<=r)return !1;var n=t+i;return n===e.length||Gi(e,n)}return !1}function Vi(e,t,r,i,n){if(!e.samplerate){var s=function(e,t,r,i){var n=t[r+2],a=n>>2&15;if(!(a>12)){var s=1+(n>>6&3),o=t[r+3]>>6&3|(1&n)<<2,l="mp4a.40."+s,u=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350][a],d=a;5!==s&&29!==s||(d-=3);var h=[s<<3|(14&d)>>1,(1&d)<<7|o<<3];return Y.log("manifest codec:"+i+", parsed codec:"+l+", channels:"+o+", rate:"+u+" (ADTS object type:"+s+" sampling index:"+a+")"),{config:h,samplerate:u,channelCount:o,codec:l,parsedCodec:l,manifestCodec:i}}var f=new Error("invalid ADTS sampling index:"+a);e.emit(b.ERROR,b.ERROR,{type:R.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,fatal:!0,error:f,reason:f.message});}(t,r,i,n);if(!s)return;a(e,s);}}function Hi(e){return 9216e4/e}function Yi(e,t,r,i,n){var a,s=i+n*Hi(e.samplerate),o=function(e,t){var r=Ui(e,t);if(t+r<=e.length){var i=Bi(e,t)-r;if(i>0)return {headerLength:r,frameLength:i}}}(t,r);if(o){var l=o.frameLength,u=o.headerLength,d=u+l,h=Math.max(0,r+d-t.length);h?(a=new Uint8Array(d-u)).set(t.subarray(r+u,t.length),0):a=t.subarray(r+u,r+d);var f={unit:a,pts:s};return h||e.samples.push(f),{sample:f,length:d,missing:h}}var c=t.length-r;return (a=new Uint8Array(c)).set(t.subarray(r,t.length),0),{sample:{unit:a,pts:s},length:c,missing:-1}}function Wi(e,t){return xi(e,t)&&Mi(e,t+6)+10<=e.length-t}function ji(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=1/0),function(e,t,r,i){var n=function(e){return e instanceof ArrayBuffer?e:e.buffer}(e),a=1;"BYTES_PER_ELEMENT"in i&&(a=i.BYTES_PER_ELEMENT);var s,o=(s=e)&&s.buffer instanceof ArrayBuffer&&void 0!==s.byteLength&&void 0!==s.byteOffset?e.byteOffset:0,l=(o+e.byteLength)/a,u=(o+t)/a,d=Math.floor(Math.max(0,Math.min(u,l))),h=Math.floor(Math.min(d+Math.max(r,0),l));return new i(n,d,h-d)}(e,t,r,Uint8Array)}function qi(e){var t={key:e.type,description:"",data:"",mimeType:null,pictureType:null};if(!(e.size<2))if(3===e.data[0]){var r=e.data.subarray(1).indexOf(0);if(-1!==r){var i=q(ji(e.data,1,r)),n=e.data[2+r],a=e.data.subarray(3+r).indexOf(0);if(-1!==a){var s,o=q(ji(e.data,3+r,a));return s="--\x3e"===i?q(ji(e.data,4+r+a)):function(e){return e instanceof ArrayBuffer?e:0==e.byteOffset&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer}(e.data.subarray(4+r+a)),t.mimeType=i,t.pictureType=n,t.description=o,t.data=s,t}}}else console.log("Ignore frame with unrecognized character encoding");}function Xi(e){return "PRIV"===e.type?function(e){if(!(e.size<2)){var t=q(e.data,!0),r=new Uint8Array(e.data.subarray(t.length+1));return {key:e.type,info:t,data:r.buffer}}}(e):"W"===e.type[0]?function(e){if("WXXX"===e.type){if(e.size<2)return;var t=1,r=q(e.data.subarray(t),!0);t+=r.length+1;var i=q(e.data.subarray(t));return {key:e.type,info:r,data:i}}var n=q(e.data);return {key:e.type,info:"",data:n}}(e):"APIC"===e.type?qi(e):function(e){if(!(e.size<2)){if("TXXX"===e.type){var t=1,r=q(e.data.subarray(t),!0);t+=r.length+1;var i=q(e.data.subarray(t));return {key:e.type,info:r,data:i}}var n=q(e.data.subarray(1));return {key:e.type,info:"",data:n}}}(e)}function Qi(e){var t=String.fromCharCode(e[0],e[1],e[2],e[3]),r=Mi(e,4);return {type:t,size:r,data:e.subarray(10,10+r)}}var zi=10,$i=10;function Zi(e){for(var t=0,r=[];xi(e,t);){var i=Mi(e,t+6);e[t+5]>>6&1&&(t+=zi);for(var n=(t+=zi)+i;t+$i<n;){var a=Qi(e.subarray(t)),s=Xi(a);s&&r.push(s),t+=a.size+zi;}Oi(e,t)&&(t+=zi);}return r}function Ji(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info}function en(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),r=1&t[3],i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,r&&(i+=47721858.84),Math.round(i)}}function tn(e){for(var t=Zi(e),r=0;r<t.length;r++){var i=t[r];if(Ji(i))return en(i)}}var rn=function(e){return e.audioId3="org.id3",e.dateRange="com.apple.quicktime.HLS",e.emsg="https://aomedia.org/emsg/ID3",e.misbklv="urn:misb:KLV:bin:1910.1",e}({});function nn(e,t){return void 0===e&&(e=""),void 0===t&&(t=9e4),{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}var an=function(){function e(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null;}var t=e.prototype;return t.resetInitSegment=function(e,t,r,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0};},t.resetTimeStamp=function(e){this.initPTS=e,this.resetContiguity();},t.resetContiguity=function(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0;},t.canParse=function(e,t){return !1},t.appendFrame=function(e,t,r){},t.demux=function(e,t){this.cachedData&&(e=Le(this.cachedData,e),this.cachedData=null);var r,i=Fi(e,0),n=i?i.length:0,a=this._audioTrack,s=this._id3Track,o=i?tn(i):void 0,l=e.length;for((null===this.basePTS||0===this.frameIndex&&A(o))&&(this.basePTS=sn(o,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),i&&i.length>0&&s.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:rn.audioId3,duration:Number.POSITIVE_INFINITY});n<l;){if(this.canParse(e,n)){var u=this.appendFrame(a,e,n);u?(this.frameIndex++,this.lastPTS=u.sample.pts,r=n+=u.length):n=l;}else Wi(e,n)?(i=Fi(e,n),s.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:rn.audioId3,duration:Number.POSITIVE_INFINITY}),r=n+=i.length):n++;if(n===l&&r!==l){var d=e.slice(r);this.cachedData?this.cachedData=Le(this.cachedData,d):this.cachedData=d;}}return {audioTrack:a,videoTrack:nn(),id3Track:s,textTrack:nn()}},t.demuxSampleAes=function(e,t,r){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},t.flush=function(e){var t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:nn(),id3Track:this._id3Track,textTrack:nn()}},t.destroy=function(){this.cachedData=null,this._audioTrack=this._id3Track=void 0;},e}(),sn=function(e,t,r){return A(e)?90*e:9e4*t+(r?9e4*r.baseTime/r.timescale:0)},on=null,ln=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],un=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],dn=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],hn=[0,1,1,4];function fn(e,t,r,i,n){if(!(r+24>t.length)){var a=cn(t,r);if(a&&r+a.frameLength<=t.length){var s=i+n*(9e4*a.samplesPerFrame/a.sampleRate),o={unit:t.subarray(r,r+a.frameLength),pts:s,dts:s};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(o),{sample:o,length:a.frameLength,missing:0}}}}function cn(e,t){var r=e[t+1]>>3&3,i=e[t+1]>>1&3,n=e[t+2]>>4&15,a=e[t+2]>>2&3;if(1!==r&&0!==n&&15!==n&&3!==a){var s=e[t+2]>>1&1,o=e[t+3]>>6,l=1e3*ln[14*(3===r?3-i:3===i?3:4)+n-1],u=un[3*(3===r?0:2===r?1:2)+a],d=3===o?1:2,h=dn[r][i],f=hn[i],c=8*h*f,g=Math.floor(h*l/u+s)*f;if(null===on){var v=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);on=v?parseInt(v[1]):0;}return !!on&&on<=87&&2===i&&l>=224e3&&0===o&&(e[t+3]=128|e[t+3]),{sampleRate:u,channelCount:d,frameLength:g,samplesPerFrame:c}}}function gn(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])}function vn(e,t){return t+1<e.length&&gn(e,t)}function mn(e,t){if(t+1<e.length&&gn(e,t)){var r=cn(e,t),i=4;null!=r&&r.frameLength&&(i=r.frameLength);var n=t+i;return n===e.length||vn(e,n)}return !1}var pn=function(e){function t(t,r){var i;return (i=e.call(this)||this).observer=void 0,i.config=void 0,i.observer=t,i.config=r,i}o(t,e);var r=t.prototype;return r.resetInitSegment=function(t,r,i,n){e.prototype.resetInitSegment.call(this,t,r,i,n),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:r,duration:n,inputTimeScale:9e4,dropped:0};},t.probe=function(e,t){if(!e)return !1;var r=Fi(e,0),i=(null==r?void 0:r.length)||0;if(mn(e,i))return !1;for(var n=e.length;i<n;i++)if(Ki(e,i))return t.log("ADTS sync word found !"),!0;return !1},r.canParse=function(e,t){return function(e,t){return function(e,t){return t+5<e.length}(e,t)&&Ni(e,t)&&Bi(e,t)<=e.length-t}(e,t)},r.appendFrame=function(e,t,r){Vi(e,this.observer,t,r,e.manifestCodec);var i=Yi(e,t,r,this.basePTS,this.frameIndex);if(i&&0===i.missing)return i},t}(an),yn=function(e,t){var r=0,i=5;t+=i;for(var n=new Uint32Array(1),a=new Uint32Array(1),s=new Uint8Array(1);i>0;){s[0]=e[t];var o=Math.min(i,8),l=8-o;a[0]=4278190080>>>24+l<<l,n[0]=(s[0]&a[0])>>l,r=r?r<<o|n[0]:n[0],t+=1,i-=o;}return r},En=function(e){function t(t){var r;return (r=e.call(this)||this).observer=void 0,r.observer=t,r}o(t,e);var r=t.prototype;return r.resetInitSegment=function(t,r,i,n){e.prototype.resetInitSegment.call(this,t,r,i,n),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:r,duration:n,inputTimeScale:9e4,dropped:0};},r.canParse=function(e,t){return t+64<e.length},r.appendFrame=function(e,t,r){var i=Tn(e,t,r,this.basePTS,this.frameIndex);if(-1!==i)return {sample:e.samples[e.samples.length-1],length:i,missing:0}},t.probe=function(e){if(!e)return !1;var t=Fi(e,0);if(!t)return !1;var r=t.length;return 11===e[r]&&119===e[r+1]&&void 0!==tn(t)&&yn(e,r)<16},t}(an);function Tn(e,t,r,i,n){if(r+8>t.length)return -1;if(11!==t[r]||119!==t[r+1])return -1;var a=t[r+4]>>6;if(a>=3)return -1;var s=[48e3,44100,32e3][a],o=63&t[r+4],l=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*o+a];if(r+l>t.length)return -1;var u=t[r+6]>>5,d=0;2===u?d+=2:(1&u&&1!==u&&(d+=2),4&u&&(d+=2));var h=(t[r+6]<<8|t[r+7])>>12-d&1,f=[2,1,2,3,3,4,4,5][u]+h,c=t[r+5]>>3,g=7&t[r+5],v=new Uint8Array([a<<6|c<<1|g>>2,(3&g)<<6|u<<3|h<<2|o>>4,o<<4&224]),m=i+n*(1536/s*9e4),p=t.subarray(r,r+l);return e.config=v,e.channelCount=f,e.samplerate=s,e.samples.push({unit:p,pts:m}),l}var Sn=function(e){function t(){return e.apply(this,arguments)||this}o(t,e);var r=t.prototype;return r.resetInitSegment=function(t,r,i,n){e.prototype.resetInitSegment.call(this,t,r,i,n),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:r,duration:n,inputTimeScale:9e4,dropped:0};},t.probe=function(e){if(!e)return !1;var t=Fi(e,0),r=(null==t?void 0:t.length)||0;if(t&&11===e[r]&&119===e[r+1]&&void 0!==tn(t)&&yn(e,r)<=16)return !1;for(var i=e.length;r<i;r++)if(mn(e,r))return Y.log("MPEG Audio sync word found !"),!0;return !1},r.canParse=function(e,t){return function(e,t){return gn(e,t)&&4<=e.length-t}(e,t)},r.appendFrame=function(e,t,r){if(null!==this.basePTS)return fn(e,t,r,this.basePTS,this.frameIndex)},t}(an),An=/\/emsg[-/]ID3/i,Ln=function(){function e(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t;}var t=e.prototype;return t.resetTimeStamp=function(){},t.resetInitSegment=function(e,t,r,i){var n=this.videoTrack=nn("video",1),a=this.audioTrack=nn("audio",1),s=this.txtTrack=nn("text",1);if(this.id3Track=nn("id3",1),this.timeOffset=0,null!=e&&e.byteLength){var o=ve(e);if(o.video){var l=o.video,u=l.id,d=l.timescale,h=l.codec,f=l.supplemental;n.id=u,n.timescale=s.timescale=d,n.codec=h,n.supplemental=f;}if(o.audio){var c=o.audio,g=c.id,v=c.timescale,m=c.codec;a.id=g,a.timescale=v,a.codec=m;}s.id=oe.text,n.sampleDuration=0,n.duration=a.duration=i;}},t.resetContiguity=function(){this.remainderData=null;},e.probe=function(e){return function(e){for(var t=e.byteLength,r=0;r<t;){var i=de(e,r);if(i>8&&109===e[r+4]&&111===e[r+5]&&111===e[r+6]&&102===e[r+7])return !0;r=i>1?r+i:t;}return !1}(e)},t.demux=function(e,t){this.timeOffset=t;var r=e,i=this.videoTrack,n=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=Le(this.remainderData,e));var a=function(e){var t={valid:null,remainder:null},r=ce(e,["moof"]);if(r.length<2)return t.remainder=e,t;var i=r[r.length-1];return t.valid=e.slice(0,i.byteOffset-8),t.remainder=e.slice(i.byteOffset-8),t}(r);this.remainderData=a.remainder,i.samples=a.valid||new Uint8Array;}else i.samples=r;var s=this.extractID3Track(i,t);return n.samples=Ie(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:s,textTrack:this.txtTrack}},t.flush=function(){var e=this.timeOffset,t=this.videoTrack,r=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;var i=this.extractID3Track(t,this.timeOffset);return r.samples=Ie(e,t),{videoTrack:t,audioTrack:nn(),id3Track:i,textTrack:nn()}},t.extractID3Track=function(e,t){var r=this,i=this.id3Track;if(e.samples.length){var n=ce(e.samples,["emsg"]);n&&n.forEach((function(e){var n=function(e){var t=e[0],r="",i="",n=0,a=0,s=0,o=0,l=0,u=0;if(0===t){for(;"\0"!==le(e.subarray(u,u+1));)r+=le(e.subarray(u,u+1)),u+=1;for(r+=le(e.subarray(u,u+1)),u+=1;"\0"!==le(e.subarray(u,u+1));)i+=le(e.subarray(u,u+1)),u+=1;i+=le(e.subarray(u,u+1)),u+=1,n=de(e,12),a=de(e,16),o=de(e,20),l=de(e,24),u=28;}else if(1===t){n=de(e,u+=4);var d=de(e,u+=4),h=de(e,u+=4);for(u+=4,s=Math.pow(2,32)*d+h,L(s)||(s=Number.MAX_SAFE_INTEGER,Y.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=de(e,u),l=de(e,u+=4),u+=4;"\0"!==le(e.subarray(u,u+1));)r+=le(e.subarray(u,u+1)),u+=1;for(r+=le(e.subarray(u,u+1)),u+=1;"\0"!==le(e.subarray(u,u+1));)i+=le(e.subarray(u,u+1)),u+=1;i+=le(e.subarray(u,u+1)),u+=1;}return {schemeIdUri:r,value:i,timeScale:n,presentationTime:s,presentationTimeDelta:a,eventDuration:o,id:l,payload:e.subarray(u,e.byteLength)}}(e);if(An.test(n.schemeIdUri)){var a=In(n,t),s=4294967295===n.eventDuration?Number.POSITIVE_INFINITY:n.eventDuration/n.timeScale;s<=.001&&(s=Number.POSITIVE_INFINITY);var o=n.payload;i.samples.push({data:o,len:o.byteLength,dts:a,pts:a,type:rn.emsg,duration:s});}else if(r.config.enableEmsgKLVMetadata&&n.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){var l=In(n,t);i.samples.push({data:n.payload,len:n.payload.byteLength,dts:l,pts:l,type:rn.misbklv,duration:Number.POSITIVE_INFINITY});}}));}return i},t.demuxSampleAes=function(e,t,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},t.destroy=function(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0;},e}();function In(e,t){return A(e.presentationTime)?e.presentationTime/e.timeScale:t+e.presentationTimeDelta/e.timeScale}var Rn=function(){function e(e,t,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new tr(t,{removePKCS7Padding:!1});}var t=e.prototype;return t.decryptBuffer=function(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,zt)},t.decryptAacSample=function(e,t,r){var i=this,n=e[t].unit;if(!(n.length<=16)){var a=n.subarray(16,n.length-n.length%16),s=a.buffer.slice(a.byteOffset,a.byteOffset+a.length);this.decryptBuffer(s).then((function(a){var s=new Uint8Array(a);n.set(s,16),i.decrypter.isSync()||i.decryptAacSamples(e,t+1,r);})).catch(r);}},t.decryptAacSamples=function(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32||(this.decryptAacSample(e,t,r),this.decrypter.isSync())))return}},t.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t),i=0,n=32;n<e.length-16;n+=160,i+=16)r.set(e.subarray(n,n+16),i);return r},t.getAvcDecryptedUnit=function(e,t){for(var r=new Uint8Array(t),i=0,n=32;n<e.length-16;n+=160,i+=16)e.set(r.subarray(i,i+16),n);return e},t.decryptAvcSample=function(e,t,r,i,n){var a=this,s=De(n.data),o=this.getAvcEncryptedData(s);this.decryptBuffer(o.buffer).then((function(o){n.data=a.getAvcDecryptedUnit(s,o),a.decrypter.isSync()||a.decryptAvcSamples(e,t,r+1,i);})).catch(i);},t.decryptAvcSamples=function(e,t,r,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,r=0){if(t>=e.length)return void i();for(var n=e[t].units;!(r>=n.length);r++){var a=n[r];if(!(a.data.length<=48||1!==a.type&&5!==a.type||(this.decryptAvcSample(e,t,r,i,a),this.decrypter.isSync())))return}}},e}(),kn=function(){function e(){this.VideoSample=null;}var t=e.prototype;return t.createVideoSample=function(e,t,r){return {key:e,frame:!1,pts:t,dts:r,units:[],length:0}},t.getLastNalUnit=function(e){var t,r,i=this.VideoSample;if(i&&0!==i.units.length||(i=e[e.length-1]),null!=(t=i)&&t.units){var n=i.units;r=n[n.length-1];}return r},t.pushAccessUnit=function(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){var r=t.samples,i=r.length;if(!i)return void t.dropped++;var n=r[i-1];e.pts=n.pts,e.dts=n.dts;}t.samples.push(e);}},t.parseNALu=function(e,t,r){var i,n,a=t.byteLength,s=e.naluState||0,o=s,l=[],u=0,d=-1,h=0;for(-1===s&&(d=0,h=this.getNALuType(t,0),s=0,u=1);u<a;)if(i=t[u++],s)if(1!==s)if(i)if(1===i){if(n=u-s-1,d>=0){var f={data:t.subarray(d,n),type:h};l.push(f);}else {var c=this.getLastNalUnit(e.samples);c&&(o&&u<=4-o&&c.state&&(c.data=c.data.subarray(0,c.data.byteLength-o)),n>0&&(c.data=Le(c.data,t.subarray(0,n)),c.state=0));}u<a?(d=u,h=this.getNALuType(t,u),s=0):s=-1;}else s=0;else s=3;else s=i?0:2;else s=i?0:1;if(d>=0&&s>=0){var g={data:t.subarray(d,a),type:h,state:s};l.push(g);}if(0===l.length){var v=this.getLastNalUnit(e.samples);v&&(v.data=Le(v.data,t));}return e.naluState=s,l},e}(),bn=function(){function e(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0;}var t=e.prototype;return t.loadWord=function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,i=new Uint8Array(4),n=Math.min(4,t);if(0===n)throw new Error("no bytes available");i.set(e.subarray(r,r+n)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*n,this.bytesAvailable-=n;},t.skipBits=function(e){var t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e);},t.readBits=function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;if(e>32&&Y.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else {if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord();}return (t=e-t)>0&&this.bitsAvailable?r<<t|this.readBits(t):r},t.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},t.skipUEG=function(){this.skipBits(1+this.skipLZ());},t.skipEG=function(){this.skipBits(1+this.skipLZ());},t.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},t.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},t.readBoolean=function(){return 1===this.readBits(1)},t.readUByte=function(){return this.readBits(8)},t.readUShort=function(){return this.readBits(16)},t.readUInt=function(){return this.readBits(32)},e}(),Dn=function(e){function t(){return e.apply(this,arguments)||this}o(t,e);var r=t.prototype;return r.parsePES=function(e,t,r,i){var n,a=this,s=this.parseNALu(e,r.data,i),o=this.VideoSample,l=!1;r.data=null,o&&s.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),s.forEach((function(i){var s,u;switch(i.type){case 1:var d=!1;n=!0;var h,f=i.data;if(l&&f.length>4){var c=a.readSliceType(f);2!==c&&4!==c&&7!==c&&9!==c||(d=!0);}d&&null!=(h=o)&&h.frame&&!o.key&&(a.pushAccessUnit(o,e),o=a.VideoSample=null),o||(o=a.VideoSample=a.createVideoSample(!0,r.pts,r.dts)),o.frame=!0,o.key=d;break;case 5:n=!0,null!=(s=o)&&s.frame&&!o.key&&(a.pushAccessUnit(o,e),o=a.VideoSample=null),o||(o=a.VideoSample=a.createVideoSample(!0,r.pts,r.dts)),o.key=!0,o.frame=!0;break;case 6:n=!0,be(i.data,1,r.pts,t.samples);break;case 7:var g,v;n=!0,l=!0;var m=i.data,p=a.readSPS(m);if(!e.sps||e.width!==p.width||e.height!==p.height||(null==(g=e.pixelRatio)?void 0:g[0])!==p.pixelRatio[0]||(null==(v=e.pixelRatio)?void 0:v[1])!==p.pixelRatio[1]){e.width=p.width,e.height=p.height,e.pixelRatio=p.pixelRatio,e.sps=[m];for(var y=m.subarray(1,4),E="avc1.",T=0;T<3;T++){var S=y[T].toString(16);S.length<2&&(S="0"+S),E+=S;}e.codec=E;}break;case 8:n=!0,e.pps=[i.data];break;case 9:n=!0,e.audFound=!0,null!=(u=o)&&u.frame&&(a.pushAccessUnit(o,e),o=null),o||(o=a.VideoSample=a.createVideoSample(!1,r.pts,r.dts));break;case 12:n=!0;break;default:n=!1;}o&&n&&o.units.push(i);})),i&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null);},r.getNALuType=function(e,t){return 31&e[t]},r.readSliceType=function(e){var t=new bn(e);return t.readUByte(),t.readUEG(),t.readUEG()},r.skipScalingList=function(e,t){for(var r=8,i=8,n=0;n<e;n++)0!==i&&(i=(r+t.readEG()+256)%256),r=0===i?r:i;},r.readSPS=function(e){var t,r,i,n=new bn(e),a=0,s=0,o=0,l=0,u=n.readUByte.bind(n),d=n.readBits.bind(n),h=n.readUEG.bind(n),f=n.readBoolean.bind(n),c=n.skipBits.bind(n),g=n.skipEG.bind(n),v=n.skipUEG.bind(n),m=this.skipScalingList.bind(this);u();var p=u();if(d(5),c(3),u(),v(),100===p||110===p||122===p||244===p||44===p||83===p||86===p||118===p||128===p){var y=h();if(3===y&&c(1),v(),v(),c(1),f())for(r=3!==y?8:12,i=0;i<r;i++)f()&&m(i<6?16:64,n);}v();var E=h();if(0===E)h();else if(1===E)for(c(1),g(),g(),t=h(),i=0;i<t;i++)g();v(),c(1);var T=h(),S=h(),A=d(1);0===A&&c(1),c(1),f()&&(a=h(),s=h(),o=h(),l=h());var L=[1,1];if(f()&&f())switch(u()){case 1:L=[1,1];break;case 2:L=[12,11];break;case 3:L=[10,11];break;case 4:L=[16,11];break;case 5:L=[40,33];break;case 6:L=[24,11];break;case 7:L=[20,11];break;case 8:L=[32,11];break;case 9:L=[80,33];break;case 10:L=[18,11];break;case 11:L=[15,11];break;case 12:L=[64,33];break;case 13:L=[160,99];break;case 14:L=[4,3];break;case 15:L=[3,2];break;case 16:L=[2,1];break;case 255:L=[u()<<8|u(),u()<<8|u()];}return {width:Math.ceil(16*(T+1)-2*a-2*s),height:(2-A)*(S+1)*16-(A?2:4)*(o+l),pixelRatio:L}},t}(kn),_n=function(e){function t(){for(var t,r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return (t=e.call.apply(e,[this].concat(i))||this).initVPS=null,t}o(t,e);var r=t.prototype;return r.parsePES=function(e,t,r,i){var n,s=this,o=this.parseNALu(e,r.data,i),l=this.VideoSample,u=!1;r.data=null,l&&o.length&&!e.audFound&&(this.pushAccessUnit(l,e),l=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),o.forEach((function(i){var o,d;switch(i.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:l||(l=s.VideoSample=s.createVideoSample(!1,r.pts,r.dts)),l.frame=!0,n=!0;break;case 16:case 17:case 18:case 21:var h;n=!0,u&&null!=(h=l)&&h.frame&&!l.key&&(s.pushAccessUnit(l,e),l=s.VideoSample=null),l||(l=s.VideoSample=s.createVideoSample(!0,r.pts,r.dts)),l.key=!0,l.frame=!0;break;case 19:case 20:n=!0,null!=(o=l)&&o.frame&&!l.key&&(s.pushAccessUnit(l,e),l=s.VideoSample=null),l||(l=s.VideoSample=s.createVideoSample(!0,r.pts,r.dts)),l.key=!0,l.frame=!0;break;case 39:n=!0,be(i.data,2,r.pts,t.samples);break;case 32:n=!0,e.vps||("object"!=typeof e.params&&(e.params={}),e.params=a(e.params,s.readVPS(i.data)),s.initVPS=i.data),e.vps=[i.data];break;case 33:if(n=!0,u=!0,void 0===e.vps||e.vps[0]===s.initVPS||void 0===e.sps||s.matchSPS(e.sps[0],i.data)||(s.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){var f=s.readSPS(i.data);for(var c in e.width=f.width,e.height=f.height,e.pixelRatio=f.pixelRatio,e.codec=f.codecString,e.sps=[],"object"!=typeof e.params&&(e.params={}),f.params)e.params[c]=f.params[c];}s.pushParameterSet(e.sps,i.data,e.vps),l||(l=s.VideoSample=s.createVideoSample(!0,r.pts,r.dts)),l.key=!0;break;case 34:if(n=!0,"object"==typeof e.params){if(!e.pps){e.pps=[];var g=s.readPPS(i.data);for(var v in g)e.params[v]=g[v];}s.pushParameterSet(e.pps,i.data,e.vps);}break;case 35:n=!0,e.audFound=!0,null!=(d=l)&&d.frame&&(s.pushAccessUnit(l,e),l=null),l||(l=s.VideoSample=s.createVideoSample(!1,r.pts,r.dts));break;default:n=!1;}l&&n&&l.units.push(i);})),i&&l&&(this.pushAccessUnit(l,e),this.VideoSample=null);},r.pushParameterSet=function(e,t,r){(r&&r[0]===this.initVPS||!r&&!e.length)&&e.push(t);},r.getNALuType=function(e,t){return (126&e[t])>>>1},r.ebsp2rbsp=function(e){for(var t=new Uint8Array(e.byteLength),r=0,i=0;i<e.byteLength;i++)i>=2&&3===e[i]&&0===e[i-1]&&0===e[i-2]||(t[r]=e[i],r++);return new Uint8Array(t.buffer,0,r)},r.pushAccessUnit=function(t,r){e.prototype.pushAccessUnit.call(this,t,r),this.initVPS&&(this.initVPS=null);},r.readVPS=function(e){var t=new bn(e);return t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6),{numTemporalLayers:t.readBits(3)+1,temporalIdNested:t.readBoolean()}},r.readSPS=function(e){var t=new bn(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);var r=t.readBits(3);t.readBoolean();for(var i=t.readBits(2),n=t.readBoolean(),a=t.readBits(5),s=t.readUByte(),o=t.readUByte(),l=t.readUByte(),u=t.readUByte(),d=t.readUByte(),h=t.readUByte(),f=t.readUByte(),c=t.readUByte(),g=t.readUByte(),v=t.readUByte(),m=t.readUByte(),p=[],y=[],E=0;E<r;E++)p.push(t.readBoolean()),y.push(t.readBoolean());if(r>0)for(var T=r;T<8;T++)t.readBits(2);for(var S=0;S<r;S++)p[S]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),y[S]&&t.readUByte();t.readUEG();var A=t.readUEG();3==A&&t.skipBits(1);var L=t.readUEG(),I=t.readUEG(),R=t.readBoolean(),k=0,b=0,D=0,_=0;R&&(k+=t.readUEG(),b+=t.readUEG(),D+=t.readUEG(),_+=t.readUEG());for(var P=t.readUEG(),C=t.readUEG(),w=t.readUEG(),O=t.readBoolean()?0:r;O<=r;O++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(var x=0;x<4;x++)for(var M=0;M<(3===x?2:6);M++)if(t.readBoolean()){var F=Math.min(64,1<<4+(x<<1));x>1&&t.readEG();for(var N=0;N<F;N++)t.readEG();}else t.readUEG();t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());for(var U=t.readUEG(),B=0,G=0;G<U;G++){var K=!1;if(0!==G&&(K=t.readBoolean()),K){G===U&&t.readUEG(),t.readBoolean(),t.readUEG();for(var V=0,H=0;H<=B;H++){var Y=t.readBoolean(),W=!1;Y||(W=t.readBoolean()),(Y||W)&&V++;}B=V;}else {var j=t.readUEG(),q=t.readUEG();B=j+q;for(var X=0;X<j;X++)t.readUEG(),t.readBoolean();for(var Q=0;Q<q;Q++)t.readUEG(),t.readBoolean();}}if(t.readBoolean())for(var z=t.readUEG(),$=0;$<z;$++){for(var Z=0;Z<w+4;Z++)t.readBits(1);t.readBits(1);}var J=0,ee=1,te=1,re=!0,ie=1,ne=0;if(t.readBoolean(),t.readBoolean(),t.readBoolean()){if(t.readBoolean()){var ae=t.readUByte();ae>0&&ae<16?(ee=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][ae-1],te=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][ae-1]):255===ae&&(ee=t.readBits(16),te=t.readBits(16));}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG()),t.readBoolean()&&(ie=t.readBits(32),ne=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){var se=t.readBoolean(),oe=t.readBoolean(),le=!1;(se||oe)&&((le=t.readBoolean())&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),le&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(var ue=0;ue<=r;ue++){var de=!1;(re=t.readBoolean())||t.readBoolean()?t.readEG():de=t.readBoolean();var he=de?1:t.readUEG()+1;if(se)for(var fe=0;fe<he;fe++)t.readUEG(),t.readUEG(),le&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(oe)for(var ce=0;ce<he;ce++)t.readUEG(),t.readUEG(),le&&(t.readUEG(),t.readUEG()),t.skipBits(1);}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),J=t.readUEG());}var ge=L,ve=I;if(R){var me=1,pe=1;1===A?me=pe=2:2==A&&(me=2),ge=L-me*b-me*k,ve=I-pe*_-pe*D;}for(var ye=i?["A","B","C"][i]:"",Ee=s<<24|o<<16|l<<8|u,Te=0,Se=0;Se<32;Se++)Te=(Te|(Ee>>Se&1)<<31-Se)>>>0;var Ae=Te.toString(16);return 1===a&&"2"===Ae&&(Ae="6"),{codecString:"hvc1."+ye+a+"."+Ae+"."+(n?"H":"L")+m+".B0",params:{general_tier_flag:n,general_profile_idc:a,general_profile_space:i,general_profile_compatibility_flags:[s,o,l,u],general_constraint_indicator_flags:[d,h,f,c,g,v],general_level_idc:m,bit_depth:P+8,bit_depth_luma_minus8:P,bit_depth_chroma_minus8:C,min_spatial_segmentation_idc:J,chroma_format_idc:A,frame_rate:{fixed:re,fps:ne/ie}},width:ge,height:ve,pixelRatio:[ee,te]}},r.readPPS=function(e){var t=new bn(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);var r=t.readBoolean(),i=t.readBoolean(),n=1;return i&&r?n=0:i?n=3:r&&(n=2),{parallelismType:n}},r.matchSPS=function(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)},t}(kn),Pn=188,Cn=function(){function e(e,t,r,i){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.logger=i,this.videoParser=null;}e.probe=function(t,r){var i=e.syncOffset(t);return i>0&&r.warn("MPEG2-TS detected but first sync word found @ offset "+i),-1!==i},e.syncOffset=function(e){for(var t=e.length,r=Math.min(940,t-Pn)+1,i=0;i<r;){for(var n=!1,a=-1,s=0,o=i;o<t;o+=Pn){if(71!==e[o]||t-o!==Pn&&71!==e[o+Pn]){if(s)return -1;break}if(s++,-1===a&&0!==(a=o)&&(r=Math.min(a+18612,e.length-Pn)+1),n||(n=0===wn(e,o)),n&&s>1&&(0===a&&s>2||o+Pn>r))return a}i++;}return -1},e.createTrack=function(e,t){return {container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:oe[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}};var t=e.prototype;return t.resetInitSegment=function(t,r,i,n){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=e.createTrack("video"),this._videoTrack.duration=n,this._audioTrack=e.createTrack("audio",n),this._id3Track=e.createTrack("id3"),this._txtTrack=e.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=r,this.videoCodec=i;},t.resetTimeStamp=function(){},t.resetContiguity=function(){var e=this._audioTrack,t=this._videoTrack,r=this._id3Track;e&&(e.pesData=null),t&&(t.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.remainderData=null;},t.demux=function(t,r,i,n){var a;void 0===i&&(i=!1),void 0===n&&(n=!1),i||(this.sampleAes=null);var s=this._videoTrack,o=this._audioTrack,l=this._id3Track,u=this._txtTrack,d=s.pid,h=s.pesData,f=o.pid,c=l.pid,g=o.pesData,v=l.pesData,m=null,p=this.pmtParsed,y=this._pmtId,E=t.length;if(this.remainderData&&(E=(t=Le(this.remainderData,t)).length,this.remainderData=null),E<Pn&&!n)return this.remainderData=t,{audioTrack:o,videoTrack:s,id3Track:l,textTrack:u};var T=Math.max(0,e.syncOffset(t));(E-=(E-T)%Pn)<t.byteLength&&!n&&(this.remainderData=new Uint8Array(t.buffer,E,t.buffer.byteLength-E));for(var S=0,A=T;A<E;A+=Pn)if(71===t[A]){var L=!!(64&t[A+1]),I=wn(t,A),R=void 0;if((48&t[A+3])>>4>1){if((R=A+5+t[A+4])===A+Pn)continue}else R=A+4;switch(I){case d:L&&(h&&(a=Nn(h,this.logger))&&(this.readyVideoParser(s.segmentCodec),null!==this.videoParser&&this.videoParser.parsePES(s,u,a,!1)),h={data:[],size:0}),h&&(h.data.push(t.subarray(R,A+Pn)),h.size+=A+Pn-R);break;case f:if(L){if(g&&(a=Nn(g,this.logger)))switch(o.segmentCodec){case"aac":this.parseAACPES(o,a);break;case"mp3":this.parseMPEGPES(o,a);break;case"ac3":this.parseAC3PES(o,a);}g={data:[],size:0};}g&&(g.data.push(t.subarray(R,A+Pn)),g.size+=A+Pn-R);break;case c:L&&(v&&(a=Nn(v,this.logger))&&this.parseID3PES(l,a),v={data:[],size:0}),v&&(v.data.push(t.subarray(R,A+Pn)),v.size+=A+Pn-R);break;case 0:L&&(R+=t[R]+1),y=this._pmtId=On(t,R);break;case y:L&&(R+=t[R]+1);var k=xn(t,R,this.typeSupported,i,this.observer,this.logger);(d=k.videoPid)>0&&(s.pid=d,s.segmentCodec=k.segmentVideoCodec),(f=k.audioPid)>0&&(o.pid=f,o.segmentCodec=k.segmentAudioCodec),(c=k.id3Pid)>0&&(l.pid=c),null===m||p||(this.logger.warn("MPEG-TS PMT found at "+A+" after unknown PID '"+m+"'. Backtracking to sync byte @"+T+" to parse all TS packets."),m=null,A=T-188),p=this.pmtParsed=!0;break;case 17:case 8191:break;default:m=I;}}else S++;S>0&&Mn(this.observer,new Error("Found "+S+" TS packet/s that do not start with 0x47"),void 0,this.logger),s.pesData=h,o.pesData=g,l.pesData=v;var b={audioTrack:o,videoTrack:s,id3Track:l,textTrack:u};return n&&this.extractRemainingSamples(b),b},t.flush=function(){var e,t=this.remainderData;return this.remainderData=null,e=t?this.demux(t,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e},t.extractRemainingSamples=function(e){var t,r=e.audioTrack,i=e.videoTrack,n=e.id3Track,a=e.textTrack,s=i.pesData,o=r.pesData,l=n.pesData;if(s&&(t=Nn(s,this.logger))?(this.readyVideoParser(i.segmentCodec),null!==this.videoParser&&(this.videoParser.parsePES(i,a,t,!0),i.pesData=null)):i.pesData=s,o&&(t=Nn(o,this.logger))){switch(r.segmentCodec){case"aac":this.parseAACPES(r,t);break;case"mp3":this.parseMPEGPES(r,t);break;case"ac3":this.parseAC3PES(r,t);}r.pesData=null;}else null!=o&&o.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),r.pesData=o;l&&(t=Nn(l,this.logger))?(this.parseID3PES(n,t),n.pesData=null):n.pesData=l;},t.demuxSampleAes=function(e,t,r){var i=this.demux(e,r,!0,!this.config.progressive),n=this.sampleAes=new Rn(this.observer,this.config,t);return this.decrypt(i,n)},t.readyVideoParser=function(e){null===this.videoParser&&("avc"===e?this.videoParser=new Dn:"hevc"===e&&(this.videoParser=new _n));},t.decrypt=function(e,t){return new Promise((function(r){var i=e.audioTrack,n=e.videoTrack;i.samples&&"aac"===i.segmentCodec?t.decryptAacSamples(i.samples,0,(function(){n.samples?t.decryptAvcSamples(n.samples,0,0,(function(){r(e);})):r(e);})):n.samples&&t.decryptAvcSamples(n.samples,0,0,(function(){r(e);}));}))},t.destroy=function(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0;},t.parseAACPES=function(e,t){var r,i,n,a=0,s=this.aacOverFlow,o=t.data;if(s){this.aacOverFlow=null;var l=s.missing,u=s.sample.unit.byteLength;if(-1===l)o=Le(s.sample.unit,o);else {var d=u-l;s.sample.unit.set(o.subarray(0,l),d),e.samples.push(s.sample),a=s.missing;}}for(r=a,i=o.length;r<i-1&&!Gi(o,r);r++);if(r!==a){var h,f=r<i-1;if(h=f?"AAC PES did not start with ADTS header,offset:"+r:"No ADTS header found in AAC PES",Mn(this.observer,new Error(h),f,this.logger),!f)return}if(Vi(e,this.observer,o,r,this.audioCodec),void 0!==t.pts)n=t.pts;else {if(!s)return void this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");var c=Hi(e.samplerate);n=s.sample.pts+c;}for(var g,v=0;r<i;){if(r+=(g=Yi(e,o,r,n,v)).length,g.missing){this.aacOverFlow=g;break}for(v++;r<i-1&&!Gi(o,r);r++);}},t.parseMPEGPES=function(e,t){var r=t.data,i=r.length,n=0,a=0,s=t.pts;if(void 0!==s)for(;a<i;)if(vn(r,a)){var o=fn(e,r,a,s,n);if(!o)break;a+=o.length,n++;}else a++;else this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");},t.parseAC3PES=function(e,t){var r=t.data,i=t.pts;if(void 0!==i)for(var n,a=r.length,s=0,o=0;o<a&&(n=Tn(e,r,o,i,s++))>0;)o+=n;else this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");},t.parseID3PES=function(e,t){if(void 0!==t.pts){var r=a({},t,{type:this._videoTrack?rn.emsg:rn.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(r);}else this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");},e}();function wn(e,t){return ((31&e[t+1])<<8)+e[t+2]}function On(e,t){return (31&e[t+10])<<8|e[t+11]}function xn(e,t,r,i,n,a){var s={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<o;){var l=wn(e,t),u=(15&e[t+3])<<8|e[t+4];switch(e[t]){case 207:if(!i){Fn("ADTS AAC",a);break}case 15:-1===s.audioPid&&(s.audioPid=l);break;case 21:-1===s.id3Pid&&(s.id3Pid=l);break;case 219:if(!i){Fn("H.264",a);break}case 27:-1===s.videoPid&&(s.videoPid=l);break;case 3:case 4:r.mpeg||r.mp3?-1===s.audioPid&&(s.audioPid=l,s.segmentAudioCodec="mp3"):a.log("MPEG audio found, not supported in this browser");break;case 193:if(!i){Fn("AC-3",a);break}case 129:r.ac3?-1===s.audioPid&&(s.audioPid=l,s.segmentAudioCodec="ac3"):a.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===s.audioPid&&u>0)for(var d=t+5,h=u;h>2;){106===e[d]&&(!0!==r.ac3?a.log("AC-3 audio found, not supported in this browser for now"):(s.audioPid=l,s.segmentAudioCodec="ac3"));var f=e[d+1]+2;d+=f,h-=f;}break;case 194:case 135:return Mn(n,new Error("Unsupported EC-3 in M2TS found"),void 0,a),s;case 36:-1===s.videoPid&&(s.videoPid=l,s.segmentVideoCodec="hevc",a.log("HEVC in M2TS found"));}t+=u+5;}return s}function Mn(e,t,r,i){i.warn("parsing error: "+t.message),e.emit(b.ERROR,b.ERROR,{type:R.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,fatal:!1,levelRetry:r,error:t,reason:t.message});}function Fn(e,t){t.log(e+" with AES-128-CBC encryption found in unencrypted stream");}function Nn(e,t){var r,i,n,a,s,o=0,l=e.data;if(!e||0===e.size)return null;for(;l[0].length<19&&l.length>1;)l[0]=Le(l[0],l[1]),l.splice(1,1);if(1===((r=l[0])[0]<<16)+(r[1]<<8)+r[2]){if((i=(r[4]<<8)+r[5])&&i>e.size-6)return null;var u=r[7];192&u&&(a=536870912*(14&r[9])+4194304*(255&r[10])+16384*(254&r[11])+128*(255&r[12])+(254&r[13])/2,64&u?a-(s=536870912*(14&r[14])+4194304*(255&r[15])+16384*(254&r[16])+128*(255&r[17])+(254&r[18])/2)>54e5&&(t.warn(Math.round((a-s)/9e4)+"s delta between PTS and DTS, align them"),a=s):s=a);var d=(n=r[8])+9;if(e.size<=d)return null;e.size-=d;for(var h=new Uint8Array(e.size),f=0,c=l.length;f<c;f++){var g=(r=l[f]).byteLength;if(d){if(d>g){d-=g;continue}r=r.subarray(d),g-=d,d=0;}h.set(r,o),o+=g;}return i&&(i-=n+3),{data:h,pts:a,dts:s,len:i}}return null}var Un=function(){function e(){}return e.getSilentFrame=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else {if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},e}(),Bn=Math.pow(2,32)-1,Gn=function(){function e(){}return e.init=function(){var t;for(t in e.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:i};var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=a,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var s=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,s,l,s,o),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,n));},e.box=function(e){for(var t=8,r=arguments.length,i=new Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];for(var a=i.length,s=a;a--;)t+=i[a].byteLength;var o=new Uint8Array(t);for(o[0]=t>>24&255,o[1]=t>>16&255,o[2]=t>>8&255,o[3]=255&t,o.set(e,4),a=0,t=8;a<s;a++)o.set(i[a],t),t+=i[a].byteLength;return o},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,r){r*=t;var i=Math.floor(r/(Bn+1)),n=Math.floor(r%(Bn+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale||0,t.duration||0),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return "audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,r,i){return e.box(e.types.moof,e.mfhd(t),e.traf(i,r))},e.moov=function(t){for(var r=t.length,i=[];r--;)i[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale||0,t[0].duration||0)].concat(i).concat(e.mvex(t)))},e.mvex=function(t){for(var r=t.length,i=[];r--;)i[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(i))},e.mvhd=function(t,r){r*=t;var i=Math.floor(r/(Bn+1)),n=Math.floor(r%(Bn+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,n>>24,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,a)},e.sdtp=function(t){var r,i,n=t.samples||[],a=new Uint8Array(4+n.length);for(r=0;r<n.length;r++)i=n[r].flags,a[r+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return e.box(e.types.sdtp,a)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var r,i,n,a=[],s=[];for(r=0;r<t.sps.length;r++)n=(i=t.sps[r]).byteLength,a.push(n>>>8&255),a.push(255&n),a=a.concat(Array.prototype.slice.call(i));for(r=0;r<t.pps.length;r++)n=(i=t.pps[r]).byteLength,s.push(n>>>8&255),s.push(255&n),s=s.concat(Array.prototype.slice.call(i));var o=e.box(e.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|t.sps.length].concat(a).concat([t.pps.length]).concat(s))),l=t.width,u=t.height,d=t.pixelRatio[0],h=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,255&d,h>>24,h>>16&255,h>>8&255,255&h])))},e.esds=function(e){var t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2].concat(t,[6,1,2]))},e.audioStsd=function(e){var t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,255&t,0,0])},e.mp4a=function(t){return e.box(e.types.mp4a,e.audioStsd(t),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){return e.box(e.types[".mp3"],e.audioStsd(t))},e.ac3=function(t){return e.box(e.types["ac-3"],e.audioStsd(t),e.box(e.types.dac3,t.config))},e.stsd=function(t){var r=t.segmentCodec;if("audio"===t.type){if("aac"===r)return e.box(e.types.stsd,e.STSD,e.mp4a(t));if("ac3"===r&&t.config)return e.box(e.types.stsd,e.STSD,e.ac3(t));if("mp3"===r&&"mp3"===t.codec)return e.box(e.types.stsd,e.STSD,e.mp3(t))}else {if(!t.pps||!t.sps)throw new Error("video track missing pps or sps");if("avc"===r)return e.box(e.types.stsd,e.STSD,e.avc1(t));if("hevc"===r&&t.vps)return e.box(e.types.stsd,e.STSD,e.hvc1(t))}throw new Error("unsupported "+t.type+" segment codec ("+r+"/"+t.codec+")")},e.tkhd=function(t){var r=t.id,i=(t.duration||0)*(t.timescale||0),n=t.width||0,a=t.height||0,s=Math.floor(i/(Bn+1)),o=Math.floor(i%(Bn+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,o>>24,o>>16&255,o>>8&255,255&o,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,a>>8&255,255&a,0,0]))},e.traf=function(t,r){var i=e.sdtp(t),n=t.id,a=Math.floor(r/(Bn+1)),s=Math.floor(r%(Bn+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,s>>24,s>>16&255,s>>8&255,255&s])),e.trun(t,i.length+16+20+8+16+8+8),i)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,r){var i,n,a,s,o,l,u=t.samples||[],d=u.length,h=12+16*d,f=new Uint8Array(h);for(r+=8+h,f.set(["video"===t.type?1:0,0,15,1,d>>>24&255,d>>>16&255,d>>>8&255,255&d,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),i=0;i<d;i++)a=(n=u[i]).duration,s=n.size,o=n.flags,l=n.cts,f.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,s>>>24&255,s>>>16&255,s>>>8&255,255&s,o.isLeading<<2|o.dependsOn,o.isDependedOn<<6|o.hasRedundancy<<4|o.paddingValue<<1|o.isNonSync,61440&o.degradPrio,15&o.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*i);return e.box(e.types.trun,f)},e.initSegment=function(t){e.types||e.init();var r=e.moov(t);return Le(e.FTYP,r)},e.hvc1=function(t){for(var r=t.params,i=[t.vps,t.sps,t.pps],n=new Uint8Array([1,r.general_profile_space<<6|(r.general_tier_flag?32:0)|r.general_profile_idc,r.general_profile_compatibility_flags[0],r.general_profile_compatibility_flags[1],r.general_profile_compatibility_flags[2],r.general_profile_compatibility_flags[3],r.general_constraint_indicator_flags[0],r.general_constraint_indicator_flags[1],r.general_constraint_indicator_flags[2],r.general_constraint_indicator_flags[3],r.general_constraint_indicator_flags[4],r.general_constraint_indicator_flags[5],r.general_level_idc,240|r.min_spatial_segmentation_idc>>8,255&r.min_spatial_segmentation_idc,252|r.parallelismType,252|r.chroma_format_idc,248|r.bit_depth_luma_minus8,248|r.bit_depth_chroma_minus8,0,parseInt(r.frame_rate.fps),3|r.temporal_id_nested<<2|r.num_temporal_layers<<3|(r.frame_rate.fixed?64:0),i.length]),a=n.length,s=0;s<i.length;s+=1){a+=3;for(var o=0;o<i[s].length;o+=1)a+=2+i[s][o].length;}var l=new Uint8Array(a);l.set(n,0),a=n.length;for(var u=i.length-1,d=0;d<i.length;d+=1){l.set(new Uint8Array([32+d|(d===u?128:0),0,i[d].length]),a),a+=3;for(var h=0;h<i[d].length;h+=1)l.set(new Uint8Array([i[d][h].length>>8,255&i[d][h].length]),a),a+=2,l.set(i[d][h],a),a+=i[d][h].length;}var f=e.box(e.types.hvcC,l),c=t.width,g=t.height,v=t.pixelRatio[0],m=t.pixelRatio[1];return e.box(e.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>8&255,255&c,g>>8&255,255&g,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),f,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([v>>24,v>>16&255,v>>8&255,255&v,m>>24,m>>16&255,m>>8&255,255&m])))},e}();Gn.types=void 0,Gn.HDLR_TYPES=void 0,Gn.STTS=void 0,Gn.STSC=void 0,Gn.STCO=void 0,Gn.STSZ=void 0,Gn.VMHD=void 0,Gn.SMHD=void 0,Gn.STSD=void 0,Gn.FTYP=void 0,Gn.DINF=void 0;var Kn=9e4;function Vn(e,t,r,i){void 0===r&&(r=1),void 0===i&&(i=!1);var n=e*t*r;return i?Math.round(n):n}function Hn(e,t){return Vn(e,1e3,1/Kn,t)}function Yn(e){var t=e.baseTime,r=e.timescale;return t/r+" ("+t+"/"+r+") trackId: "+e.trackId}var Wn=null,jn=null;function qn(e,t,r,i){return {duration:t,size:r,cts:i,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}var Xn=function(e){function t(t,r,i,n){var a;if((a=e.call(this,"mp4-remuxer",n)||this).observer=void 0,a.config=void 0,a.typeSupported=void 0,a.ISGenerated=!1,a._initPTS=null,a._initDTS=null,a.nextVideoTs=null,a.nextAudioTs=null,a.videoSampleDuration=null,a.isAudioContiguous=!1,a.isVideoContiguous=!1,a.videoTrackConfig=void 0,a.observer=t,a.config=r,a.typeSupported=i,a.ISGenerated=!1,null===Wn){var s=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Wn=s?parseInt(s[1]):0;}if(null===jn){var o=navigator.userAgent.match(/Safari\/(\d+)/i);jn=o?parseInt(o[1]):0;}return a}o(t,e);var r=t.prototype;return r.destroy=function(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null;},r.resetTimeStamp=function(e){var t=this._initPTS;t&&e&&e.trackId===t.trackId&&e.baseTime===t.baseTime&&e.timescale===t.timescale||this.log("Reset initPTS: "+(t?Yn(t):t)+" > "+(e?Yn(e):e)),this._initPTS=this._initDTS=e;},r.resetNextTimestamp=function(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1;},r.resetInitSegment=function(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0;},r.getVideoStartPts=function(e){var t=!1,r=e[0].pts,i=e.reduce((function(e,i){var n=i.pts,a=n-e;return a<-4294967296&&(t=!0,a=(n=Qn(n,r))-e),a>0?e:n}),r);return t&&this.debug("PTS rollover detected"),i},r.remux=function(e,t,r,i,n,a,s,o){var l,u,d,h,f,c,g=n,v=n,m=e.pid>-1,p=t.pid>-1,y=t.samples.length,E=e.samples.length>0,T=s&&y>0||y>1;if((!m||E)&&(!p||T)||this.ISGenerated||s){if(this.ISGenerated){var S,A,L,I,R=this.videoTrackConfig;(R&&(t.width!==R.width||t.height!==R.height||(null==(S=t.pixelRatio)?void 0:S[0])!==(null==(A=R.pixelRatio)?void 0:A[0])||(null==(L=t.pixelRatio)?void 0:L[1])!==(null==(I=R.pixelRatio)?void 0:I[1]))||!R&&T||null===this.nextAudioTs&&E)&&this.resetInitSegment();}this.ISGenerated||(d=this.generateIS(e,t,n,a));var k,b=this.isVideoContiguous,D=-1;if(T&&(D=function(e){for(var t=0;t<e.length;t++)if(e[t].key)return t;return -1}(t.samples),!b&&this.config.forceKeyFrameOnDiscontinuity))if(c=!0,D>0){this.warn("Dropped "+D+" out of "+y+" video samples due to a missing keyframe");var _=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(D),t.dropped+=D,k=v+=(t.samples[0].pts-_)/t.inputTimeScale;}else -1===D&&(this.warn("No keyframe found out of "+y+" video samples"),c=!1);if(this.ISGenerated){if(E&&T){var P=this.getVideoStartPts(t.samples),C=(Qn(e.samples[0].pts,P)-P)/t.inputTimeScale;g+=Math.max(0,C),v+=Math.max(0,-C);}if(E){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),d=this.generateIS(e,t,n,a)),u=this.remuxAudio(e,g,this.isAudioContiguous,a,p||T||o===O?v:void 0),T){var w=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),d=this.generateIS(e,t,n,a)),l=this.remuxVideo(t,v,b,w);}}else T&&(l=this.remuxVideo(t,v,b,0));l&&(l.firstKeyFrame=D,l.independent=-1!==D,l.firstKeyFramePTS=k);}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(f=zn(r,n,this._initPTS,this._initDTS)),i.samples.length&&(h=$n(i,n,this._initPTS))),{audio:u,video:l,initSegment:d,independent:c,text:h,id3:f}},r.computeInitPts=function(e,t,r,i){var n=Math.round(r*t),a=Qn(e,n);if(a<n+t)for(this.log("Adjusting PTS for rollover in timeline near "+(n-a)/t+" "+i);a<n+t;)a+=8589934592;return a-n},r.generateIS=function(e,t,r,i){var n,a,s,o=e.samples,l=t.samples,u=this.typeSupported,d={},h=this._initPTS,f=!h||i,c="audio/mp4",g=-1;if(f&&(n=a=1/0),e.config&&o.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":u.mpeg?(c="audio/mpeg",e.codec=""):u.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";}d.audio={id:"audio",container:c,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&u.mpeg?new Uint8Array(0):Gn.initSegment([e]),metadata:{channelCount:e.channelCount}},f&&(g=e.id,s=e.inputTimeScale,h&&s===h.timescale?f=!1:n=a=this.computeInitPts(o[0].pts,s,r,"audio"));}if(t.sps&&t.pps&&l.length){if(t.timescale=t.inputTimeScale,d.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Gn.initSegment([t]),metadata:{width:t.width,height:t.height}},f)if(g=t.id,s=t.inputTimeScale,h&&s===h.timescale)f=!1;else {var v=this.getVideoStartPts(l),m=Qn(l[0].dts,v),p=this.computeInitPts(m,s,r,"video"),y=this.computeInitPts(v,s,r,"video");a=Math.min(a,p),n=Math.min(n,y);}this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio};}if(Object.keys(d).length)return this.ISGenerated=!0,f?(h&&this.warn("Timestamps at playlist time: "+(i?"":"~")+r+" "+n/s+" != initPTS: "+h.baseTime/h.timescale+" ("+h.baseTime+"/"+h.timescale+") trackId: "+h.trackId),this.log("Found initPTS at playlist time: "+r+" offset: "+n/s+" ("+n+"/"+s+") trackId: "+g),this._initPTS={baseTime:n,timescale:s,trackId:g},this._initDTS={baseTime:a,timescale:s,trackId:g}):n=s=void 0,{tracks:d,initPTS:n,timescale:s,trackId:g}},r.remuxVideo=function(e,t,r,i){var n,s,o=e.inputTimeScale,l=e.samples,u=[],d=l.length,h=this._initPTS,f=h.baseTime*o/h.timescale,c=this.nextVideoTs,g=8,v=this.videoSampleDuration,m=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY,y=!1;if(!r||null===c){var E=f+t*o,T=l[0].pts-Qn(l[0].dts,l[0].pts);Wn&&null!==c&&Math.abs(E-T-(c+f))<15e3?r=!0:c=E-T-f;}for(var S=c+f,A=0;A<d;A++){var L=l[A];L.pts=Qn(L.pts,S),L.dts=Qn(L.dts,S),L.dts<l[A>0?A-1:A].dts&&(y=!0);}y&&l.sort((function(e,t){var r=e.dts-t.dts,i=e.pts-t.pts;return r||i})),n=l[0].dts;var I=(s=l[l.length-1].dts)-n,D=I?Math.round(I/(d-1)):v||e.inputTimeScale/30;if(r){var _=n-S,P=_>D,C=_<-1;if((P||C)&&(P?this.warn((e.segmentCodec||"").toUpperCase()+": "+Hn(_,!0)+" ms ("+_+"dts) hole between fragments detected at "+t.toFixed(3)):this.warn((e.segmentCodec||"").toUpperCase()+": "+Hn(-_,!0)+" ms ("+_+"dts) overlapping between fragments detected at "+t.toFixed(3)),!C||S>=l[0].pts||Wn)){n=S;var w=l[0].pts-_;if(P)l[0].dts=n,l[0].pts=w;else for(var O=!0,x=0;x<l.length&&!(l[x].dts>w&&O);x++){var M=l[x].pts;if(l[x].dts-=_,l[x].pts-=_,x<l.length-1){var F=l[x+1].pts;O=F<=l[x].pts==F<=M;}}this.log("Video: Initial PTS/DTS adjusted: "+Hn(w,!0)+"/"+Hn(n,!0)+", delta: "+Hn(_,!0)+" ms");}}for(var N=0,U=0,B=n=Math.max(0,n),G=0;G<d;G++){for(var K=l[G],V=K.units,H=V.length,Y=0,W=0;W<H;W++)Y+=V[W].data.length;U+=Y,N+=H,K.length=Y,K.dts<B?(K.dts=B,B+=D/4|0||1):B=K.dts,m=Math.min(K.pts,m),p=Math.max(K.pts,p);}s=l[d-1].dts;var j,q=U+4*N+8;try{j=new Uint8Array(q);}catch(e){return void this.observer.emit(b.ERROR,b.ERROR,{type:R.MUX_ERROR,details:k.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:q,reason:"fail allocating video mdat "+q})}var X=new DataView(j.buffer);X.setUint32(0,q),j.set(Gn.types.mdat,4);for(var Q=!1,z=Number.POSITIVE_INFINITY,$=Number.POSITIVE_INFINITY,Z=Number.NEGATIVE_INFINITY,J=Number.NEGATIVE_INFINITY,ee=0;ee<d;ee++){for(var te=l[ee],re=te.units,ie=0,ne=0,ae=re.length;ne<ae;ne++){var se=re[ne],oe=se.data,le=se.data.byteLength;X.setUint32(g,le),g+=4,j.set(oe,g),g+=le,ie+=4+le;}var ue=void 0;if(ee<d-1)v=l[ee+1].dts-te.dts,ue=l[ee+1].pts-te.pts;else {var de=this.config,he=ee>0?te.dts-l[ee-1].dts:D;if(ue=ee>0?te.pts-l[ee-1].pts:D,de.stretchShortVideoTrack&&null!==this.nextAudioTs){var fe=Math.floor(de.maxBufferHole*o),ce=(i?m+i*o:this.nextAudioTs+f)-te.pts;ce>fe?((v=ce-he)<0?v=he:Q=!0,this.log("It is approximately "+ce/90+" ms to the next segment; using duration "+v/90+" ms for the last video frame.")):v=he;}else v=he;}var ge=Math.round(te.pts-te.dts);z=Math.min(z,v),Z=Math.max(Z,v),$=Math.min($,ue),J=Math.max(J,ue),u.push(qn(te.key,v,ie,ge));}if(u.length)if(Wn){if(Wn<70){var ve=u[0].flags;ve.dependsOn=2,ve.isNonSync=0;}}else if(jn&&J-$<Z-z&&D/Z<.025&&0===u[0].cts){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var me=n,pe=0,ye=u.length;pe<ye;pe++){var Ee=me+u[pe].duration,Te=me+u[pe].cts;if(pe<ye-1){var Se=Ee+u[pe+1].cts;u[pe].duration=Se-Te;}else u[pe].duration=pe?u[pe-1].duration:D;u[pe].cts=0,me=Ee;}}var Ae=s+(v=Q||!v?D:v);this.nextVideoTs=c=Ae-f,this.videoSampleDuration=v,this.isVideoContiguous=!0;var Le={data1:Gn.moof(e.sequenceNumber++,n,a(e,{samples:u})),data2:j,startPTS:(m-f)/o,endPTS:(p+v-f)/o,startDTS:(n-f)/o,endDTS:c/o,type:"video",hasAudio:!1,hasVideo:!0,nb:u.length,dropped:e.dropped};return e.samples=[],e.dropped=0,Le},r.getSamplesPerFrame=function(e){switch(e.segmentCodec){case"mp3":return 1152;case"ac3":return 1536;default:return 1024}},r.remuxAudio=function(e,t,r,i,n){var s=e.inputTimeScale,o=s/(e.samplerate?e.samplerate:s),l=this.getSamplesPerFrame(e),u=l*o,d=this._initPTS,h="mp3"===e.segmentCodec&&this.typeSupported.mpeg,f=[],c=void 0!==n,g=e.samples,v=h?0:8,m=this.nextAudioTs||-1,p=d.baseTime*s/d.timescale,y=p+t*s;if(this.isAudioContiguous=r=r||g.length&&m>0&&(i&&Math.abs(y-(m+p))<9e3||Math.abs(Qn(g[0].pts,y)-(m+p))<20*u),g.forEach((function(e){e.pts=Qn(e.pts,y);})),!r||m<0){var E=g.length;if(g=g.filter((function(e){return e.pts>=0})),E!==g.length&&this.warn("Removed "+(g.length-E)+" of "+E+" samples (initPTS "+p+" / "+s+")"),!g.length)return;m=0===n?0:i&&!c?Math.max(0,y-p):g[0].pts-p;}if("aac"===e.segmentCodec)for(var T=this.config.maxAudioFramesDrift,S=0,A=m+p;S<g.length;S++){var L=g[S],I=L.pts,D=I-A,_=Math.abs(1e3*D/s);if(D<=-T*u&&c)0===S&&(this.warn("Audio frame @ "+(I/s).toFixed(3)+"s overlaps marker by "+Math.round(1e3*D/s)+" ms."),this.nextAudioTs=m=I-p,A=I);else if(D>=T*u&&_<1e4&&c){var P=Math.round(D/u);for(A=I-P*u;A<0&&P&&u;)P--,A+=u;0===S&&(this.nextAudioTs=m=A-p),this.warn("Injecting "+P+" audio frames @ "+((A-p)/s).toFixed(3)+"s due to "+Math.round(1e3*D/s)+" ms gap.");for(var C=0;C<P;C++){var w=Un.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);w||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),w=L.unit.subarray()),g.splice(S,0,{unit:w,pts:A}),A+=u,S++;}}L.pts=A,A+=u;}for(var O,x=null,M=null,F=0,N=g.length;N--;)F+=g[N].unit.byteLength;for(var U=0,B=g.length;U<B;U++){var G=g[U],K=G.unit,V=G.pts;if(null!==M)f[U-1].duration=Math.round((V-M)/o);else {if(r&&"aac"===e.segmentCodec&&(V=m+p),x=V,!(F>0))return;F+=v;try{O=new Uint8Array(F);}catch(e){return void this.observer.emit(b.ERROR,b.ERROR,{type:R.MUX_ERROR,details:k.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:F,reason:"fail allocating audio mdat "+F})}h||(new DataView(O.buffer).setUint32(0,F),O.set(Gn.types.mdat,4));}O.set(K,v);var H=K.byteLength;v+=H,f.push(qn(!0,l,H,0)),M=V;}var Y=f.length;if(Y){var W=f[f.length-1];m=M-p,this.nextAudioTs=m+o*W.duration;var j=h?new Uint8Array(0):Gn.moof(e.sequenceNumber++,x/o,a({},e,{samples:f}));e.samples=[];var q=(x-p)/s,X=m/s,Q={data1:j,data2:O,startPTS:q,endPTS:X,startDTS:q,endDTS:X,type:"audio",hasAudio:!0,hasVideo:!1,nb:Y};return this.isAudioContiguous=!0,Q}},t}(N);function Qn(e,t){var r;if(null===t)return e;for(r=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=r;return e}function zn(e,t,r,i){var n=e.samples.length;if(n){for(var a=e.inputTimeScale,s=0;s<n;s++){var o=e.samples[s];o.pts=Qn(o.pts-r.baseTime*a/r.timescale,t*a)/a,o.dts=Qn(o.dts-i.baseTime*a/i.timescale,t*a)/a;}var l=e.samples;return e.samples=[],{samples:l}}}function $n(e,t,r){var i=e.samples.length;if(i){for(var n=e.inputTimeScale,a=0;a<i;a++){var s=e.samples[a];s.pts=Qn(s.pts-r.baseTime*n/r.timescale,t*n)/n;}e.samples.sort((function(e,t){return e.pts-t.pts}));var o=e.samples;return e.samples=[],{samples:o}}}var Zn,Jn=function(e){function t(t,r,i,n){var a;return (a=e.call(this,"passthrough-remuxer",n)||this).emitInitSegment=!1,a.audioCodec=void 0,a.videoCodec=void 0,a.initData=void 0,a.initPTS=null,a.initTracks=void 0,a.lastEndTime=null,a.isVideoContiguous=!1,a}o(t,e);var r=t.prototype;return r.destroy=function(){},r.resetTimeStamp=function(e){this.lastEndTime=null;var t=this.initPTS;t&&e&&t.baseTime===e.baseTime&&t.timescale===e.timescale||(this.initPTS=e);},r.resetNextTimestamp=function(){this.isVideoContiguous=!1,this.lastEndTime=null;},r.resetInitSegment=function(e,t,r,i){this.audioCodec=t,this.videoCodec=r,this.generateInitSegment(e,i),this.emitInitSegment=!0;},r.generateInitSegment=function(e,t){var r=this.audioCodec,i=this.videoCodec;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var n=this.initData=ve(e),a=n.audio,s=n.video;if(t)!function(e,t){if(e&&t){var r=t.keyId;r&&t.isCommonEncryption&&Se(e,(function(e,t){var i=e.subarray(8,24);i.some((function(e){return 0!==e}))||(Y.log("[eme] Patching keyId in 'enc"+(t?"a":"v")+">sinf>>tenc' box: "+X(i)+" -> "+X(r)),e.set(r,8));}));}}(e,t);else {var o=a||s;null!=o&&o.encrypted&&this.warn('Init segment with encrypted track with has no key ("'+o.codec+'")!');}a&&(r=ta(a,$,this)),s&&(i=ta(s,Z,this));var l={};a&&s?l.audiovideo={container:"video/mp4",codec:r+","+i,supplemental:s.supplemental,encrypted:s.encrypted,initSegment:e,id:"main"}:a?l.audio={container:"audio/mp4",codec:r,encrypted:a.encrypted,initSegment:e,id:"audio"}:s?l.video={container:"video/mp4",codec:i,supplemental:s.supplemental,encrypted:s.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=l;},r.remux=function(e,t,r,i,n,a){var s,o,l=this.initPTS,u=this.lastEndTime,d={audio:void 0,video:void 0,text:i,id3:r,initSegment:void 0};A(u)||(u=this.lastEndTime=n||0);var h=t.samples;if(!h.length)return d;var f={initPTS:void 0,timescale:void 0,trackId:void 0},c=this.initData;if(null!=(s=c)&&s.length||(this.generateInitSegment(h),c=this.initData),null==(o=c)||!o.length)return this.warn("Failed to generate initSegment."),d;this.emitInitSegment&&(f.tracks=this.initTracks,this.emitInitSegment=!1);var g=function(e,t,r){for(var i={},n=ce(e,["moof","traf"]),a=0;a<n.length;a++){var s=n[a],o=ce(s,["tfhd"])[0],l=de(o,4),u=t[l];if(u){i[l]||(i[l]={start:NaN,duration:0,sampleCount:0,timescale:u.timescale,type:u.type});var d=i[l],h=ce(s,["tfdt"])[0];if(h){var f=h[0],c=de(h,4);1===f&&(c===ae?r.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(c*=ae+1,c+=de(h,8))),A(c)&&(!A(d.start)||c<d.start)&&(d.start=c);}var g=u.default,v=de(o,0)|(null==g?void 0:g.flags),m=(null==g?void 0:g.duration)||0;8&v&&(m=de(o,2&v?12:8));for(var p=ce(s,["trun"]),y=d.start||0,E=0,T=m,S=0;S<p.length;S++){var L=p[S],I=de(L,4),R=d.sampleCount;d.sampleCount+=I;var k=1&L[3],b=4&L[3],D=1&L[2],_=2&L[2],P=4&L[2],C=8&L[2],w=8,O=I;for(k&&(w+=4),b&&I&&(1&L[w+1]||void 0!==d.keyFrameIndex||(d.keyFrameIndex=R),w+=4,D?(T=de(L,w),w+=4):T=m,_&&(w+=4),C&&(w+=4),y+=T,E+=T,O--);O--;)D?(T=de(L,w),w+=4):T=m,_&&(w+=4),P&&(1&L[w+1]||void 0===d.keyFrameIndex&&(d.keyFrameIndex=d.sampleCount-(O+1),d.keyFrameStart=y),w+=4),C&&(w+=4),y+=T,E+=T;!E&&m&&(E+=m*I);}d.duration+=E;}}if(!Object.keys(i).some((function(e){return i[e].duration}))){for(var x=1/0,M=0,F=ce(e,["sidx"]),N=0;N<F.length;N++){var U=ge(F[N]);if(null!=U&&U.references){x=Math.min(x,U.earliestPresentationTime/U.timescale);var B=U.references.reduce((function(e,t){return e+t.info.duration||0}),0);M=Math.max(M,B+U.earliestPresentationTime/U.timescale);}}M&&A(M)&&Object.keys(i).forEach((function(e){i[e].duration||(i[e].duration=M*i[e].timescale-i[e].start);}));}return i}(h,c,this),v=c.audio?g[c.audio.id]:null,m=c.video?g[c.video.id]:null,p=ea(m,1/0),y=ea(v,1/0),E=ea(m,0,!0),T=ea(v,0,!0),S=n,L=0,I=v&&(!m||!l&&y<p||l&&l.trackId===c.audio.id),R=I?v:m;if(R){var k=R.timescale,b=R.start-n*k,D=I?c.audio.id:c.video.id;S=R.start/k,L=I?T-y:E-p,!a&&l||!function(e,t,r,i){if(null===e)return !0;var n=Math.max(i,1),a=t-e.baseTime/e.timescale;return Math.abs(a-r)>n}(l,S,n,L)&&k===l.timescale||(l&&this.warn("Timestamps at playlist time: "+(a?"":"~")+n+" "+b/k+" != initPTS: "+l.baseTime/l.timescale+" ("+l.baseTime+"/"+l.timescale+") trackId: "+l.trackId),this.log("Found initPTS at playlist time: "+n+" offset: "+(S-n)+" ("+b+"/"+k+") trackId: "+D),l=null,f.initPTS=b,f.timescale=k,f.trackId=D);}else this.warn("No audio or video samples found for initPTS at playlist time: "+n);l?(f.initPTS=l.baseTime,f.timescale=l.timescale,f.trackId=l.trackId):(f.timescale&&void 0!==f.trackId&&void 0!==f.initPTS||(this.warn("Could not set initPTS"),f.initPTS=S,f.timescale=1,f.trackId=-1),this.initPTS=l={baseTime:f.initPTS,timescale:f.timescale,trackId:f.trackId});var _=S-l.baseTime/l.timescale,P=_+L;L>0?this.lastEndTime=P:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var C=!!c.audio,w=!!c.video,O="";C&&(O+="audio"),w&&(O+="video");var x={data1:h,startPTS:_,startDTS:_,endPTS:P,endDTS:P,type:O,hasAudio:C,hasVideo:w,nb:1,dropped:0,encrypted:!!c.audio&&c.audio.encrypted||!!c.video&&c.video.encrypted};d.audio=C&&!w?x:void 0,d.video=w?x:void 0;var M=null==m?void 0:m.sampleCount;if(M){var F=m.keyFrameIndex,N=-1!==F;x.nb=M,x.dropped=0===F||this.isVideoContiguous?0:N?F:M,x.independent=N,x.firstKeyFrame=F,N&&m.keyFrameStart&&(x.firstKeyFramePTS=(m.keyFrameStart-l.baseTime)/l.timescale),this.isVideoContiguous||(d.independent=N),this.isVideoContiguous||(this.isVideoContiguous=N),x.dropped&&this.warn("fmp4 does not start with IDR: firstIDR "+F+"/"+M+" dropped: "+x.dropped+" start: "+(x.firstKeyFramePTS||"NA"));}return d.initSegment=f,d.id3=zn(r,n,l,l),i.samples.length&&(d.text=$n(i,n,l)),d},t}(N);function ea(e,t,r){return void 0===r&&(r=!1),void 0!==(null==e?void 0:e.start)?(e.start+(r?e.duration:0))/e.timescale:t}function ta(e,t,r){var i=e.codec;return i&&i.length>4?i:t===$?"ec-3"===i||"ac-3"===i||"alac"===i?i:"fLaC"===i||"Opus"===i?Ke(i,!1):(r.warn('Unhandled audio codec "'+i+'" in mp4 MAP'),i||"mp4a"):(r.warn('Unhandled video codec "'+i+'" in mp4 MAP'),i||"avc1")}try{Zn=self.performance.now.bind(self.performance);}catch(e){Zn=Date.now;}var ra=[{demux:Ln,remux:Jn},{demux:Cn,remux:Xn},{demux:pn,remux:Xn},{demux:Sn,remux:Xn}];ra.splice(2,0,{demux:En,remux:Xn});var ia=function(){function e(e,t,r,i,n,a){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=r,this.id=n,this.logger=a;}var t=e.prototype;return t.configure=function(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset();},t.push=function(e,t,r,i){var n=this,a=r.transmuxing;a.executeStart=Zn();var s=new Uint8Array(e),o=this.currentTransmuxState,l=this.transmuxConfig;i&&(this.currentTransmuxState=i);var u=i||o,d=u.contiguous,h=u.discontinuity,f=u.trackSwitch,c=u.accurateTimeOffset,g=u.timeOffset,v=u.initSegmentChange,m=l.audioCodec,p=l.videoCodec,y=l.defaultInitPts,E=l.duration,T=l.initSegmentData,S=function(e,t){var r=null;return e.byteLength>0&&null!=(null==t?void 0:t.key)&&null!==t.iv&&null!=t.method&&(r=t),r}(s,t);if(S&&Ir(S.method)){var A=this.getDecrypter(),L=Rr(S.method);if(!A.isSync())return this.asyncResult=!0,this.decryptionPromise=A.webCryptoDecrypt(s,S.key.buffer,S.iv.buffer,L).then((function(e){var t=n.push(e,null,r);return n.decryptionPromise=null,t})),this.decryptionPromise;var I=A.softwareDecrypt(s,S.key.buffer,S.iv.buffer,L);if(r.part>-1){var D=A.flush();I=D?D.buffer:D;}if(!I)return a.executeEnd=Zn(),na(r);s=new Uint8Array(I);}var _=this.needsProbing(h,f);if(_){var P=this.configureTransmuxer(s);if(P)return this.logger.warn("[transmuxer] "+P.message),this.observer.emit(b.ERROR,b.ERROR,{type:R.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,fatal:!1,error:P,reason:P.message}),a.executeEnd=Zn(),na(r)}(h||f||v||_)&&this.resetInitSegment(T,m,p,E,t),(h||v||_)&&this.resetInitialTimestamp(y),d||this.resetContiguity();var C=this.transmux(s,S,g,c,r);this.asyncResult=aa(C);var w=this.currentTransmuxState;return w.contiguous=!0,w.discontinuity=!1,w.trackSwitch=!1,a.executeEnd=Zn(),C},t.flush=function(e){var t=this,r=e.transmuxing;r.executeStart=Zn();var i=this.decrypter,n=this.currentTransmuxState,a=this.decryptionPromise;if(a)return this.asyncResult=!0,a.then((function(){return t.flush(e)}));var s=[],o=n.timeOffset;if(i){var l=i.flush();l&&s.push(this.push(l.buffer,null,e));}var u=this.demuxer,d=this.remuxer;if(!u||!d){r.executeEnd=Zn();var h=[na(e)];return this.asyncResult?Promise.resolve(h):h}var f=u.flush(o);return aa(f)?(this.asyncResult=!0,f.then((function(r){return t.flushRemux(s,r,e),s}))):(this.flushRemux(s,f,e),this.asyncResult?Promise.resolve(s):s)},t.flushRemux=function(e,t,r){var i=t.audioTrack,n=t.videoTrack,a=t.id3Track,s=t.textTrack,o=this.currentTransmuxState,l=o.accurateTimeOffset,u=o.timeOffset;this.logger.log("[transmuxer.ts]: Flushed "+this.id+" sn: "+r.sn+(r.part>-1?" part: "+r.part:"")+" of "+(this.id===w?"level":"track")+" "+r.level);var d=this.remuxer.remux(i,n,a,s,u,l,!0,this.id);e.push({remuxResult:d,chunkMeta:r}),r.transmuxing.executeEnd=Zn();},t.resetInitialTimestamp=function(e){var t=this.demuxer,r=this.remuxer;t&&r&&(t.resetTimeStamp(e),r.resetTimeStamp(e));},t.resetContiguity=function(){var e=this.demuxer,t=this.remuxer;e&&t&&(e.resetContiguity(),t.resetNextTimestamp());},t.resetInitSegment=function(e,t,r,i,n){var a=this.demuxer,s=this.remuxer;a&&s&&(a.resetInitSegment(e,t,r,i),s.resetInitSegment(e,t,r,n));},t.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0);},t.transmux=function(e,t,r,i,n){return t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,r,i,n):this.transmuxUnencrypted(e,r,i,n)},t.transmuxUnencrypted=function(e,t,r,i){var n=this.demuxer.demux(e,t,!1,!this.config.progressive),a=n.audioTrack,s=n.videoTrack,o=n.id3Track,l=n.textTrack;return {remuxResult:this.remuxer.remux(a,s,o,l,t,r,!1,this.id),chunkMeta:i}},t.transmuxSampleAes=function(e,t,r,i,n){var a=this;return this.demuxer.demuxSampleAes(e,t,r).then((function(e){return {remuxResult:a.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,r,i,!1,a.id),chunkMeta:n}}))},t.configureTransmuxer=function(e){for(var t,r=this.config,i=this.observer,n=this.typeSupported,a=0,s=ra.length;a<s;a++){var o;if(null!=(o=ra[a].demux)&&o.probe(e,this.logger)){t=ra[a];break}}if(!t)return new Error("Failed to find demuxer by probing fragment data");var l=this.demuxer,u=this.remuxer,d=t.remux,h=t.demux;u&&u instanceof d||(this.remuxer=new d(i,r,n,this.logger)),l&&l instanceof h||(this.demuxer=new h(i,r,n,this.logger),this.probe=h.probe);},t.needsProbing=function(e,t){return !this.demuxer||!this.remuxer||e||t},t.getDecrypter=function(){var e=this.decrypter;return e||(e=this.decrypter=new tr(this.config)),e},e}(),na=function(e){return {remuxResult:{},chunkMeta:e}};function aa(e){return "then"in e&&e.then instanceof Function}var sa=function(e,t,r,i,n){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=r,this.duration=i,this.defaultInitPts=n||null;},oa=function(e,t,r,i,n,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=r,this.trackSwitch=i,this.timeOffset=n,this.initSegmentChange=a;},la=[];function ua(e,t,r){if(!((i=t.remuxResult).audio||i.video||i.text||i.id3||i.initSegment))return !1;var i,n=[],a=t.remuxResult,s=a.audio,o=a.video;return s&&da(n,s),o&&da(n,o),e.postMessage({event:"transmuxComplete",data:t,instanceNo:r},n),!0}function da(e,t){t.data1&&e.push(t.data1.buffer),t.data2&&e.push(t.data2.buffer);}function ha(e,t,r,i){t.reduce((function(t,r){return ua(e,r,i)||t}),!1)||e.postMessage({event:"transmuxComplete",data:t[0],instanceNo:i}),e.postMessage({event:"flush",data:r,instanceNo:i});}function fa(e,t,r){self.postMessage({event:e,data:t,instanceNo:r});}void 0!==t&&t&&self.addEventListener("message",(function(e){var t=e.data,r=t.instanceNo;if(void 0!==r){var i=la[r];if("reset"===t.cmd&&(delete la[t.resetNo],i&&i.destroy(),t.cmd="init"),"init"===t.cmd){var n=JSON.parse(t.config),a=new E;a.on(b.FRAG_DECRYPTED,fa),a.on(b.ERROR,fa);var s=H(n.debug,t.id);return function(e,t){var r=function(r){e[r]=function(){var e=Array.prototype.join.call(arguments," ");fa("workerLog",{logType:r,message:e},t);};};for(var i in e)r(i);}(s,r),la[r]=new ia(a,t.typeSupported,n,"",t.id,s),void fa("init",null,r)}if(i)switch(t.cmd){case"configure":i.configure(t.config);break;case"demux":var o=i.push(t.data,t.decryptdata,t.chunkMeta,t.state);aa(o)?o.then((function(e){ua(self,e,r);})).catch((function(e){fa(b.ERROR,{instanceNo:r,type:R.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,chunkMeta:t.chunkMeta,fatal:!1,error:e,err:e,reason:"transmuxer-worker push error"},r);})):ua(self,o,r);break;case"flush":var l=t.chunkMeta,u=i.flush(l);aa(u)?u.then((function(e){ha(self,e,l,r);})).catch((function(e){fa(b.ERROR,{type:R.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,chunkMeta:t.chunkMeta,fatal:!1,error:e,err:e,reason:"transmuxer-worker flush error"},r);})):ha(self,u,l,r);}}}));var ca="1.6.14",ga={},va=0,ma=function(){function t(t,r,i,n){var a=this;this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=va++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=function(e){var t=e.data,r=a.hls;if(r&&null!=t&&t.event&&t.instanceNo===a.instanceNo)switch(t.event){case"init":var i,n=null==(i=a.workerContext)?void 0:i.objectURL;n&&self.URL.revokeObjectURL(n);break;case"transmuxComplete":a.handleTransmuxComplete(t.data);break;case"flush":a.onFlush(t.data);break;case"workerLog":r.logger[t.data.logType]&&r.logger[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=a.frag,t.data.part=a.part,t.data.id=a.id,r.trigger(t.event,t.data);}},this.onWorkerError=function(e){if(a.hls){var t=new Error(e.message+"  ("+e.filename+":"+e.lineno+")");a.hls.config.enableWorker=!1,a.hls.logger.warn('Error in "'+a.id+'" Web Worker, fallback to inline'),a.hls.trigger(b.ERROR,{type:R.OTHER_ERROR,details:k.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:t});}};var s=t.config;this.hls=t,this.id=r,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=i,this.onFlush=n;var o=function(e,t){(t=t||{}).frag=a.frag||void 0,e===b.ERROR&&(t.parent=a.id,t.part=a.part,a.error=t.error),a.hls.trigger(e,t);};this.observer=new E,this.observer.on(b.FRAG_DECRYPTED,o),this.observer.on(b.ERROR,o);var l=We(s.preferManagedMediaSource);if(this.useWorker&&"undefined"!=typeof Worker){var u=this.hls.logger;s.workerPath;try{s.workerPath?(u.log("loading Web Worker "+s.workerPath+' for "'+r+'"'),this.workerContext=function(e){var t=ga[e];if(t)return t.clientCount++,t;var r=new self.URL(e,self.location.href).href,i={worker:new self.Worker(r),scriptURL:r,clientCount:1};return ga[e]=i,i}(s.workerPath)):(u.log('injecting Web Worker for "'+r+'"'),this.workerContext=function(){var t=ga[ca];if(t)return t.clientCount++,t;var r=new self.Blob(["var exports={};var module={exports:exports};function define(f){f()};define.amd=true;("+e.toString()+")(true);"],{type:"text/javascript"}),i=self.URL.createObjectURL(r),n={worker:new self.Worker(i),objectURL:i,clientCount:1};return ga[ca]=n,n}());var d=this.workerContext.worker;d.addEventListener("message",this.onWorkerMessage),d.addEventListener("error",this.onWorkerError),d.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:l,id:r,config:ut(s)});}catch(e){u.warn('Error setting up "'+r+'" Web Worker, fallback to inline',e),this.terminateWorker(),this.error=null,this.transmuxer=new ia(this.observer,l,s,"",r,t.logger);}}else this.transmuxer=new ia(this.observer,l,s,"",r,t.logger);}var r=t.prototype;return r.reset=function(){if(this.frag=null,this.part=null,this.workerContext){var e=this.instanceNo;this.instanceNo=va++;var t=this.hls.config,r=We(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:r,id:this.id,config:ut(t)});}},r.terminateWorker=function(){if(this.workerContext){var e=this.workerContext.worker;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),function(e){var t=ga[e||ca];if(t&&1==t.clientCount--){var r=t.worker,i=t.objectURL;delete ga[e||ca],i&&self.URL.revokeObjectURL(i),r.terminate();}}(this.hls.config.workerPath);}},r.destroy=function(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else {var e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null);}var t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null;},r.push=function(e,t,r,i,n,a,s,o,l,u){var d,h,f=this;l.transmuxing.start=self.performance.now();var c=this.instanceNo,g=this.transmuxer,v=a?a.start:n.start,m=n.decryptdata,p=this.frag,y=!(p&&n.cc===p.cc),E=!(p&&l.level===p.level),T=p?l.sn-p.sn:-1,S=this.part?l.part-this.part.index:-1,A=0===T&&l.id>1&&l.id===(null==p?void 0:p.stats.chunkCount),L=!E&&(1===T||0===T&&(1===S||A&&S<=0)),I=self.performance.now();(E||T||0===n.stats.parsing.start)&&(n.stats.parsing.start=I),!a||!S&&L||(a.stats.parsing.start=I);var R=!(p&&(null==(d=n.initSegment)?void 0:d.url)===(null==(h=p.initSegment)?void 0:h.url)),k=new oa(y,L,o,E,v,R);if(!L||y||R){this.hls.logger.log("[transmuxer-interface]: Starting new transmux session for "+n.type+" sn: "+l.sn+(l.part>-1?" part: "+l.part:"")+" "+(this.id===w?"level":"track")+": "+l.level+" id: "+l.id+"\n        discontinuity: "+y+"\n        trackSwitch: "+E+"\n        contiguous: "+L+"\n        accurateTimeOffset: "+o+"\n        timeOffset: "+v+"\n        initSegmentChange: "+R);var b=new sa(r,i,t,s,u);this.configureTransmuxer(b);}if(this.frag=n,this.part=a,this.workerContext)this.workerContext.worker.postMessage({instanceNo:c,cmd:"demux",data:e,decryptdata:m,chunkMeta:l,state:k},e instanceof ArrayBuffer?[e]:[]);else if(g){var D=g.push(e,m,l,k);aa(D)?D.then((function(e){f.handleTransmuxComplete(e);})).catch((function(e){f.transmuxerError(e,l,"transmuxer-interface push error");})):this.handleTransmuxComplete(D);}},r.flush=function(e){var t=this;e.transmuxing.start=self.performance.now();var r=this.instanceNo,i=this.transmuxer;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:r,cmd:"flush",chunkMeta:e});else if(i){var n=i.flush(e);aa(n)?n.then((function(r){t.handleFlushResult(r,e);})).catch((function(r){t.transmuxerError(r,e,"transmuxer-interface flush error");})):this.handleFlushResult(n,e);}},r.transmuxerError=function(e,t,r){this.hls&&(this.error=e,this.hls.trigger(b.ERROR,{type:R.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:r}));},r.handleFlushResult=function(e,t){var r=this;e.forEach((function(e){r.handleTransmuxComplete(e);})),this.onFlush(t);},r.configureTransmuxer=function(e){var t=this.instanceNo,r=this.transmuxer;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):r&&r.configure(e);},r.handleTransmuxComplete=function(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e);},t}(),pa=function(e){function t(t,r,i){var n;return (n=e.call(this,t,r,i,"audio-stream-controller",O)||this).mainAnchor=null,n.mainFragLoading=null,n.audioOnly=!1,n.bufferedTrack=null,n.switchingTrack=null,n.trackId=-1,n.waitingData=null,n.mainDetails=null,n.flushing=!1,n.bufferFlushed=!1,n.cachedTrackLoadedData=null,n.registerListeners(),n}o(t,e);var r=t.prototype;return r.onHandlerDestroying=function(){this.unregisterListeners(),e.prototype.onHandlerDestroying.call(this),this.resetItem();},r.resetItem=function(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null;},r.registerListeners=function(){e.prototype.registerListeners.call(this);var t=this.hls;t.on(b.LEVEL_LOADED,this.onLevelLoaded,this),t.on(b.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.on(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(b.BUFFER_RESET,this.onBufferReset,this),t.on(b.BUFFER_CREATED,this.onBufferCreated,this),t.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(b.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(b.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(b.FRAG_LOADING,this.onFragLoading,this),t.on(b.FRAG_BUFFERED,this.onFragBuffered,this);},r.unregisterListeners=function(){var t=this.hls;t&&(e.prototype.unregisterListeners.call(this),t.off(b.LEVEL_LOADED,this.onLevelLoaded,this),t.off(b.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.off(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(b.BUFFER_RESET,this.onBufferReset,this),t.off(b.BUFFER_CREATED,this.onBufferCreated,this),t.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(b.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(b.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(b.FRAG_LOADING,this.onFragLoading,this),t.off(b.FRAG_BUFFERED,this.onFragBuffered,this));},r.onInitPtsFound=function(e,t){var r=t.frag,i=t.id,n=t.initPTS,a=t.timescale,s=t.trackId;if(i===w){var o=r.cc,l=this.fragCurrent;if(this.initPTS[o]={baseTime:n,timescale:a,trackId:s},this.log("InitPTS for cc: "+o+" found from main: "+n/a+" ("+n+"/"+a+") trackId: "+s),this.mainAnchor=r,this.state===_i.WAITING_INIT_PTS){var u=this.waitingData;(!u&&!this.loadingParts||u&&u.frag.cc!==o)&&this.syncWithAnchor(r,null==u?void 0:u.frag);}else !this.hls.hasEnoughToStart&&l&&l.cc!==o?(l.abortRequests(),this.syncWithAnchor(r,l)):this.state===_i.IDLE&&this.tick();}},r.getLoadPosition=function(){return !this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:e.prototype.getLoadPosition.call(this)},r.syncWithAnchor=function(e,t){var r,i=(null==(r=this.mainFragLoading)?void 0:r.frag)||null;if(!t||(null==i?void 0:i.cc)!==t.cc){var n=(i||e).cc,a=Lt(this.getLevelDetails(),n,this.getLoadPosition());a&&(this.log("Syncing with main frag at "+a.start+" cc "+a.cc),this.startFragRequested=!1,this.nextLoadPosition=a.start,this.resetLoadingState(),this.state===_i.IDLE&&this.doTickIdle());}},r.startLoad=function(e,t){if(!this.levels)return this.startPosition=e,void(this.state=_i.STOPPED);var r=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),r>0&&-1===e?(this.log("Override startPosition with lastCurrentTime @"+r.toFixed(3)),e=r,this.state=_i.IDLE):this.state=_i.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick();},r.doTick=function(){switch(this.state){case _i.IDLE:this.doTickIdle();break;case _i.WAITING_TRACK:var t=this.levels,r=this.trackId,i=null==t?void 0:t[r],n=null==i?void 0:i.details;if(n&&!this.waitForLive(i)){if(this.waitForCdnTuneIn(n))break;this.state=_i.WAITING_INIT_PTS;}break;case _i.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break;case _i.WAITING_INIT_PTS:var a=this.waitingData;if(a){var s=a.frag,o=a.part,l=a.cache,u=a.complete,d=this.mainAnchor;if(void 0!==this.initPTS[s.cc]){this.waitingData=null,this.state=_i.FRAG_LOADING;var h={frag:s,part:o,payload:l.flush().buffer,networkDetails:null};this._handleFragmentLoadProgress(h),u&&e.prototype._handleFragmentLoadComplete.call(this,h);}else d&&d.cc!==a.frag.cc&&this.syncWithAnchor(d,a.frag);}else this.state=_i.IDLE;}this.onTickEnd();},r.resetLoadingState=function(){var t=this.waitingData;t&&(this.fragmentTracker.removeFragment(t.frag),this.waitingData=null),e.prototype.resetLoadingState.call(this);},r.onTickEnd=function(){var e=this.media;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime);},r.doTickIdle=function(){var e,t=this.hls,r=this.levels,i=this.media,n=this.trackId,a=t.config;if(this.buffering&&(i||this.primaryPrefetch||!this.startFragRequested&&a.startFragPrefetch)&&null!=r&&r[n]){var s=r[n],o=s.details;if(!o||this.waitForLive(s)||this.waitForCdnTuneIn(o))return this.state=_i.WAITING_TRACK,void(this.startFragRequested=!1);var l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,$,O));var u=this.getFwdBufferInfo(l,O);if(null!==u){if(!this.switchingTrack&&this._streamEnded(u,o))return t.trigger(b.BUFFER_EOS,{type:"audio"}),void(this.state=_i.ENDED);var d=u.len,h=t.maxBufferLength,f=o.fragments,c=f[0].start,g=this.getLoadPosition(),v=this.flushing?g:u.end;if(this.switchingTrack&&i){var m=g;o.PTSKnown&&m<c&&(u.end>c||u.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),i.currentTime=c+.05);}if(!(d>=h&&!this.switchingTrack&&v<f[f.length-1].start)){var p=this.getNextFragment(v,o);if(p&&this.isLoopLoading(p,v)&&(p=this.getNextFragmentLoopLoading(p,o,u,w,h)),p){var y=(null==(e=this.mainFragLoading)?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&y&&te(p)&&!p.endList&&(!o.live||!this.loadingParts&&v<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(y)===Wt&&(this.mainFragLoading=y=null),y&&te(y))){if(p.start>y.end){var E=this.fragmentTracker.getFragAtPos(v,w);E&&E.end>y.end&&(y=E,this.mainFragLoading={frag:E,targetBufferTime:null});}if(p.start>y.end)return}this.loadFragment(p,s,v);}else this.bufferFlushed=!0;}}}},r.onMediaDetaching=function(t,r){this.bufferFlushed=this.flushing=!1,e.prototype.onMediaDetaching.call(this,t,r);},r.onAudioTracksUpdated=function(e,t){var r=t.audioTracks;this.resetTransmuxer(),this.levels=r.map((function(e){return new st(e)}));},r.onAudioTrackSwitching=function(e,t){var r=!!t.url;this.trackId=t.id;var i=this.fragCurrent;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),r?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==_i.STOPPED&&(this.setInterval(100),this.state=_i.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval());},r.onManifestLoading=function(){e.prototype.onManifestLoading.call(this),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1;},r.onLevelLoaded=function(e,t){this.mainDetails=t.details;var r=this.cachedTrackLoadedData;r&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(b.AUDIO_TRACK_LOADED,r));},r.onAudioTrackLoaded=function(e,t){var r,i=this.levels,n=t.details,a=t.id,s=t.groupId,o=t.track;if(i){var l=this.mainDetails;if(!l||n.endCC>l.endCC||l.expired)return this.cachedTrackLoadedData=t,void(this.state!==_i.STOPPED&&(this.state=_i.WAITING_TRACK));this.cachedTrackLoadedData=null,this.log("Audio track "+a+' "'+o.name+'" of "'+s+'" loaded ['+n.startSN+","+n.endSN+"]"+(n.lastPartSn?"[part-"+n.lastPartSn+"-"+n.lastPartIndex+"]":"")+",duration:"+n.totalduration);var u=i[a],d=0;if(n.live||null!=(r=u.details)&&r.live){if(this.checkLiveUpdate(n),n.deltaUpdateFailed)return;var h;u.details&&(d=this.alignPlaylists(n,u.details,null==(h=this.levelLastLoaded)?void 0:h.details)),n.alignedSliding||(Ii(n,l),n.alignedSliding||Ri(n,l),d=n.fragmentStart);}u.details=n,this.levelLastLoaded=u,this.startFragRequested||this.setStartPosition(l,d),this.hls.trigger(b.AUDIO_TRACK_UPDATED,{details:n,id:a,groupId:t.groupId}),this.state!==_i.WAITING_TRACK||this.waitForCdnTuneIn(n)||(this.state=_i.IDLE),this.tick();}else this.warn("Audio tracks reset while loading track "+a+' "'+o.name+'" of "'+s+'"');},r._handleFragmentLoadProgress=function(e){var t,r=e.frag,i=e.part,n=e.payload,a=this.config,s=this.trackId,o=this.levels;if(o){var l=o[s];if(l){var u=l.details;if(!u)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(r.start);var d=a.defaultAudioCodec||l.audioCodec||"mp4a.40.2",h=this.transmuxer;h||(h=this.transmuxer=new ma(this.hls,O,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var f=this.initPTS[r.cc],c=null==(t=r.initSegment)?void 0:t.data;if(void 0!==f){var g=i?i.index:-1,v=-1!==g,m=new lr(r.level,r.sn,r.stats.chunkCount,n.byteLength,g,v);h.push(n,c,d,"",r,i,u.totalduration,!1,m,f);}else this.log("Unknown video PTS for cc "+r.cc+", waiting for video PTS before demuxing audio frag "+r.sn+" of ["+u.startSN+" ,"+u.endSN+"],track "+s),(this.waitingData=this.waitingData||{frag:r,part:i,cache:new wi,complete:!1}).cache.push(new Uint8Array(n)),this.state!==_i.STOPPED&&(this.state=_i.WAITING_INIT_PTS);}else this.warn("Audio track is undefined on fragment load progress");}else this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+r.sn+" of level "+r.level+" will not be buffered");},r._handleFragmentLoadComplete=function(t){this.waitingData?this.waitingData.complete=!0:e.prototype._handleFragmentLoadComplete.call(this,t);},r.onBufferReset=function(){this.mediaBuffer=null;},r.onBufferCreated=function(e,t){this.bufferFlushed=this.flushing=!1;var r=t.tracks.audio;r&&(this.mediaBuffer=r.buffer||null);},r.onFragLoading=function(e,t){!this.audioOnly&&t.frag.type===w&&te(t.frag)&&(this.mainFragLoading=t,this.state===_i.IDLE&&this.tick());},r.onFragBuffered=function(e,t){var r=t.frag,i=t.part;if(r.type===O)if(this.fragContextChanged(r))this.warn("Fragment "+r.sn+(i?" p: "+i.index:"")+" of level "+r.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+(this.switchingTrack?this.switchingTrack.name:"false"));else {if(te(r)){this.fragPrevious=r;var n=this.switchingTrack;n&&(this.bufferedTrack=n,this.switchingTrack=null,this.hls.trigger(b.AUDIO_TRACK_SWITCHED,d({},n)));}this.fragBufferedComplete(r,i),this.media&&this.tick();}else this.audioOnly||r.type!==w||r.elementaryStreams.video||r.elementaryStreams.audiovideo||(this.audioOnly=!0,this.mainFragLoading=null);},r.onError=function(t,r){var i;if(r.fatal)this.state=_i.ERROR;else switch(r.details){case k.FRAG_GAP:case k.FRAG_PARSING_ERROR:case k.FRAG_DECRYPT_ERROR:case k.FRAG_LOAD_ERROR:case k.FRAG_LOAD_TIMEOUT:case k.KEY_LOAD_ERROR:case k.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(O,r);break;case k.AUDIO_TRACK_LOAD_ERROR:case k.AUDIO_TRACK_LOAD_TIMEOUT:case k.LEVEL_PARSING_ERROR:r.levelRetry||this.state!==_i.WAITING_TRACK||(null==(i=r.context)?void 0:i.type)!==P||(this.state=_i.IDLE);break;case k.BUFFER_ADD_CODEC_ERROR:case k.BUFFER_APPEND_ERROR:if("audio"!==r.parent)return;this.reduceLengthAndFlushBuffer(r)||this.resetLoadingState();break;case k.BUFFER_FULL_ERROR:if("audio"!==r.parent)return;this.reduceLengthAndFlushBuffer(r)&&(this.bufferedTrack=null,e.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio"));break;case k.INTERNAL_EXCEPTION:this.recoverWorkerError(r);}},r.onBufferFlushing=function(e,t){t.type!==Z&&(this.flushing=!0);},r.onBufferFlushed=function(e,t){var r=t.type;if(r!==Z){this.flushing=!1,this.bufferFlushed=!0,this.state===_i.ENDED&&(this.state=_i.IDLE);var i=this.mediaBuffer||this.media;i&&(this.afterBufferFlushed(i,r,O),this.tick());}},r._handleTransmuxComplete=function(e){var t,r="audio",i=this.hls,n=e.remuxResult,s=e.chunkMeta,o=this.getCurrentContext(s);if(o){var l=o.frag,u=o.part,d=o.level,h=d.details,f=n.audio,c=n.text,g=n.id3,v=n.initSegment;if(!this.fragContextChanged(l)&&h){if(this.state=_i.PARSING,this.switchingTrack&&f&&this.completeAudioSwitch(this.switchingTrack),null!=v&&v.tracks){var m=l.initSegment||l;if(this.unhandledEncryptionError(v,l))return;this._bufferInitSegment(d,v.tracks,m,s),i.trigger(b.FRAG_PARSING_INIT_SEGMENT,{frag:m,id:r,tracks:v.tracks});}if(f){var p=f.startPTS,y=f.endPTS,E=f.startDTS,T=f.endDTS;u&&(u.elementaryStreams[$]={startPTS:p,endPTS:y,startDTS:E,endDTS:T}),l.setElementaryStreamInfo($,p,y,E,T),this.bufferFragmentData(f,l,u,s);}if(null!=g&&null!=(t=g.samples)&&t.length){var S=a({id:r,frag:l,details:h},g);i.trigger(b.FRAG_PARSING_METADATA,S);}if(c){var A=a({id:r,frag:l,details:h},c);i.trigger(b.FRAG_PARSING_USERDATA,A);}}else this.fragmentTracker.removeFragment(l);}else this.resetWhenMissingContext(s);},r._bufferInitSegment=function(e,t,r,i){if(this.state===_i.PARSING&&(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,t.audio)){var n=t.audio;n.id=O;var a=e.audioCodec;this.log("Init audio buffer, container:"+n.container+", codecs[level/parsed]=["+a+"/"+n.codec+"]"),a&&1===a.split(",").length&&(n.levelCodec=a),this.hls.trigger(b.BUFFER_CODECS,t);var s=n.initSegment;if(null!=s&&s.byteLength){var o={type:"audio",frag:r,part:null,chunkMeta:i,parent:r.type,data:s};this.hls.trigger(b.BUFFER_APPENDING,o);}this.tickImmediate();}},r.loadFragment=function(t,r,i){var n,a=this.fragmentTracker.getState(t);if(this.switchingTrack||a===Vt||a===Yt)if(te(t))if(null!=(n=r.details)&&n.live&&!this.initPTS[t.cc]){this.log("Waiting for video PTS in continuity counter "+t.cc+" of live stream before loading audio fragment "+t.sn+" of level "+this.trackId),this.state=_i.WAITING_INIT_PTS;var s=this.mainDetails;s&&s.fragmentStart!==r.details.fragmentStart&&Ri(r.details,s);}else e.prototype.loadFragment.call(this,t,r,i);else this._loadInitSegment(t,r);else this.clearTrackerIfNeeded(t);},r.flushAudioIfNeeded=function(t){if(this.media&&this.bufferedTrack){var r=this.bufferedTrack;gt({name:r.name,lang:r.lang,assocLang:r.assocLang,characteristics:r.characteristics,audioCodec:r.audioCodec,channels:r.channels},t,vt)||(pt(t.url,this.hls)?(this.log("Switching audio track : flushing all audio"),e.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=t);}},r.completeAudioSwitch=function(e){var t=this.hls;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(b.AUDIO_TRACK_SWITCHED,d({},e));},t}(Pi),ya=function(e){function t(t,r){var i;return (i=e.call(this,r,t.logger)||this).hls=void 0,i.canLoad=!1,i.timer=-1,i.hls=t,i}o(t,e);var r=t.prototype;return r.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null;},r.clearTimer=function(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1);},r.startLoad=function(){this.canLoad=!0,this.loadPlaylist();},r.stopLoad=function(){this.canLoad=!1,this.clearTimer();},r.switchParams=function(e,t,r){var i=null==t?void 0:t.renditionReports;if(i){for(var n=-1,a=0;a<i.length;a++){var s=i[a],o=void 0;try{o=new self.URL(s.URI,t.url).href;}catch(e){this.warn("Could not construct new URL for Rendition Report: "+e),o=s.URI||"";}if(o===e){n=a;break}o===e.substring(0,o.length)&&(n=a);}if(-1!==n){var l=i[n],u=parseInt(l["LAST-MSN"])||t.lastPartSn,d=parseInt(l["LAST-PART"])||t.lastPartIndex;if(this.hls.config.lowLatencyMode){var h=Math.min(t.age-t.partTarget,t.targetduration);d>=0&&h>t.partTarget&&(d+=1);}var f=r&&nt(r);return new at(u,d>=0?d:void 0,f)}}},r.loadPlaylist=function(e){this.clearTimer();},r.loadingPlaylist=function(e,t){this.clearTimer();},r.shouldLoadPlaylist=function(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)},r.getUrlWithDirectives=function(e,t){if(t)try{return t.addDirectives(e)}catch(e){this.warn("Could not construct new URL with HLS Delivery Directives: "+e);}return e},r.playlistLoaded=function(e,t,r){var i=t.details,n=t.stats,a=self.performance.now(),s=n.loading.first?Math.max(0,a-n.loading.first):0;i.advancedDateTime=Date.now()-s;var o=this.hls.config.timelineOffset;if(o!==i.appliedTimelineOffset){var l=Math.max(o||0,0);i.appliedTimelineOffset=l,i.fragments.forEach((function(e){e.setStart(e.playlistOffset+l);}));}if(i.live||null!=r&&r.live){var u="levelInfo"in t?t.levelInfo:t.track;if(i.reloaded(r),r&&i.fragments.length>0){di(r,i,this);var d=i.playlistParsingError;if(d){this.warn(d);var h=this.hls;if(!h.config.ignorePlaylistParsingErrors){var f,c=t.networkDetails;return void h.trigger(b.ERROR,{type:R.NETWORK_ERROR,details:k.LEVEL_PARSING_ERROR,fatal:!1,url:i.url,error:d,reason:d.message,level:t.level||void 0,parent:null==(f=i.fragments[0])?void 0:f.type,networkDetails:c,stats:n})}i.playlistParsingError=null;}}-1===i.requestScheduled&&(i.requestScheduled=n.loading.start);var g,v=this.hls.mainForwardBufferInfo,m=v?v.end-v.len:0,p=gi(i,1e3*(i.edge-m));if(i.requestScheduled+p<a?i.requestScheduled=a:i.requestScheduled+=p,this.log("live playlist "+e+" "+(i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:i.updated?"UPDATED":"MISSED")),!this.canLoad||!i.live)return;var y=void 0,E=void 0;if(i.canBlockReload&&i.endSN&&i.advanced){var T=this.hls.config.lowLatencyMode,S=i.lastPartSn,A=i.endSN,L=i.lastPartIndex,I=S===A;-1!==L?I?(y=A+1,E=T?0:L):(y=S,E=T?L+1:i.maxPartIndex):y=A+1;var D=i.age,_=D+i.ageHeader,P=Math.min(_-i.partTarget,1.5*i.targetduration);if(P>0){if(_>3*i.targetduration)this.log("Playlist last advanced "+D.toFixed(2)+"s ago. Omitting segment and part directives."),y=void 0,E=void 0;else if(null!=r&&r.tuneInGoal&&_-i.partTarget>r.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+r.tuneInGoal+" to: "+P+" with playlist age: "+i.age),P=0;else {var C=Math.floor(P/i.targetduration);y+=C,void 0!==E&&(E+=Math.round(P%i.targetduration/i.partTarget)),this.log("CDN Tune-in age: "+i.ageHeader+"s last advanced "+D.toFixed(2)+"s goal: "+P+" skip sn "+C+" to part "+E);}i.tuneInGoal=P;}if(g=this.getDeliveryDirectives(i,t.deliveryDirectives,y,E),T||!I)return i.requestScheduled=a,void this.loadingPlaylist(u,g)}else (i.canBlockReload||i.canSkipUntil)&&(g=this.getDeliveryDirectives(i,t.deliveryDirectives,y,E));g&&void 0!==y&&i.canBlockReload&&(i.requestScheduled=n.loading.first+Math.max(p-2*s,p/2)),this.scheduleLoading(u,g,i);}else this.clearTimer();},r.scheduleLoading=function(e,t,r){var i=this,n=r||e.details;if(n){var a=self.performance.now(),s=n.requestScheduled;if(a>=s)this.loadingPlaylist(e,t);else {var o=s-a;this.log("reload live playlist "+(e.name||e.bitrate+"bps")+" in "+Math.round(o)+" ms"),this.clearTimer(),this.timer=self.setTimeout((function(){return i.loadingPlaylist(e,t)}),o);}}else this.loadingPlaylist(e,t);},r.getDeliveryDirectives=function(e,t,r,i){var n=nt(e);return null!=t&&t.skip&&e.deltaUpdateFailed&&(r=t.msn,i=t.part,n=tt),new at(r,i,n)},r.checkRetry=function(e){var t=this,r=e.details,i=It(e),n=e.errorAction,a=n||{},s=a.action,o=a.retryCount,l=void 0===o?0:o,u=a.retryConfig,d=!!n&&!!u&&(s===Mt||!n.resolved&&s===Ot);if(d){var h;if(l>=u.maxNumRetry)return !1;if(i&&null!=(h=e.context)&&h.deliveryDirectives)this.warn("Retrying playlist loading "+(l+1)+"/"+u.maxNumRetry+' after "'+r+'" without delivery-directives'),this.loadPlaylist();else {var f=Dt(u,l);this.clearTimer(),this.timer=self.setTimeout((function(){return t.loadPlaylist()}),f),this.warn("Retrying playlist loading "+(l+1)+"/"+u.maxNumRetry+' after "'+r+'" in '+f+"ms");}e.levelRetry=!0,n.resolved=!0;}return d},t}(N);function Ea(e,t){if(e.length!==t.length)return !1;for(var r=0;r<e.length;r++)if(!Ta(e[r].attrs,t[r].attrs))return !1;return !0}function Ta(e,t,r){var i=e["STABLE-RENDITION-ID"];return i&&!r?i===t["STABLE-RENDITION-ID"]:!(r||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some((function(r){return e[r]!==t[r]}))}function Sa(e,t){return t.label.toLowerCase()===e.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(e.lang||"").toLowerCase())}var Aa=function(e){function t(t){var r;return (r=e.call(this,t,"audio-track-controller")||this).tracks=[],r.groupIds=null,r.tracksInGroup=[],r.trackId=-1,r.currentTrack=null,r.selectDefaultTrack=!0,r.registerListeners(),r}o(t,e);var r=t.prototype;return r.registerListeners=function(){var e=this.hls;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.LEVEL_LOADING,this.onLevelLoading,this),e.on(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(b.ERROR,this.onError,this);},r.unregisterListeners=function(){var e=this.hls;e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.LEVEL_LOADING,this.onLevelLoading,this),e.off(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(b.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(b.ERROR,this.onError,this);},r.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,e.prototype.destroy.call(this);},r.onManifestLoading=function(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0;},r.onManifestParsed=function(e,t){this.tracks=t.audioTracks||[];},r.onAudioTrackLoaded=function(e,t){var r=t.id,i=t.groupId,n=t.details,a=this.tracksInGroup[r];if(a&&a.groupId===i){var s=a.details;a.details=t.details,this.log("Audio track "+r+' "'+a.name+'" lang:'+a.lang+" group:"+i+" loaded ["+n.startSN+"-"+n.endSN+"]"),r===this.trackId&&this.playlistLoaded(r,t,s);}else this.warn("Audio track with id:"+r+" and group:"+i+" not found in active group "+(null==a?void 0:a.groupId));},r.onLevelLoading=function(e,t){this.switchLevel(t.level);},r.onLevelSwitching=function(e,t){this.switchLevel(t.level);},r.switchLevel=function(e){var t=this.hls.levels[e];if(t){var r=t.audioGroups||null,i=this.groupIds,n=this.currentTrack;if(!r||(null==i?void 0:i.length)!==(null==r?void 0:r.length)||null!=r&&r.some((function(e){return -1===(null==i?void 0:i.indexOf(e))}))){this.groupIds=r,this.trackId=-1,this.currentTrack=null;var a=this.tracks.filter((function(e){return !r||-1!==r.indexOf(e.groupId)}));if(a.length)this.selectDefaultTrack&&!a.some((function(e){return e.default}))&&(this.selectDefaultTrack=!1),a.forEach((function(e,t){e.id=t;}));else if(!n&&!this.tracksInGroup.length)return;this.tracksInGroup=a;var s=this.hls.config.audioPreference;if(!n&&s){var o=ct(s,a,vt);if(o>-1)n=a[o];else {var l=ct(s,this.tracks);n=this.tracks[l];}}var u=this.findTrackId(n);-1===u&&n&&(u=this.findTrackId(null));var d={audioTracks:a};this.log("Updating audio tracks, "+a.length+" track(s) found in group(s): "+(null==r?void 0:r.join(","))),this.hls.trigger(b.AUDIO_TRACKS_UPDATED,d);var h=this.trackId;if(-1!==u&&-1===h)this.setAudioTrack(u);else if(a.length&&-1===h){var f,c=new Error("No audio track selected for current audio group-ID(s): "+(null==(f=this.groupIds)?void 0:f.join(","))+" track count: "+a.length);this.warn(c.message),this.hls.trigger(b.ERROR,{type:R.MEDIA_ERROR,details:k.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:c});}}}},r.onError=function(e,t){!t.fatal&&t.context&&(t.context.type!==P||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t));},r.setAudioOption=function(e){var t=this.hls;if(t.config.audioPreference=e,e){var r=this.allAudioTracks;if(this.selectDefaultTrack=!1,r.length){var i=this.currentTrack;if(i&&gt(e,i,vt))return i;var n=ct(e,this.tracksInGroup,vt);if(n>-1){var a=this.tracksInGroup[n];return this.setAudioTrack(n),a}if(i){var s=t.loadLevel;-1===s&&(s=t.firstAutoLevel);var o=function(e,t,r,i,n){var a=t[i],s=t.reduce((function(e,t,r){var i=t.uri;return (e[i]||(e[i]=[])).push(r),e}),{})[a.uri];s.length>1&&(i=Math.max.apply(Math,s));var o=a.videoRange,l=a.frameRate,u=a.codecSet.substring(0,4),d=mt(t,i,(function(t){if(t.videoRange!==o||t.frameRate!==l||t.codecSet.substring(0,4)!==u)return !1;var i=t.audioGroups,a=r.filter((function(e){return !i||-1!==i.indexOf(e.groupId)}));return ct(e,a,n)>-1}));return d>-1?d:mt(t,i,(function(t){var i=t.audioGroups,a=r.filter((function(e){return !i||-1!==i.indexOf(e.groupId)}));return ct(e,a,n)>-1}))}(e,t.levels,r,s,vt);if(-1===o)return null;t.nextLoadLevel=o;}if(e.channels||e.audioCodec){var l=ct(e,r);if(l>-1)return r[l]}}}return null},r.setAudioTrack=function(e){var t=this.tracksInGroup;if(e<0||e>=t.length)this.warn("Invalid audio track id: "+e);else {this.selectDefaultTrack=!1;var r=this.currentTrack,i=t[e],n=i.details&&!i.details.live;if(!(e===this.trackId&&i===r&&n||(this.log("Switching to audio-track "+e+' "'+i.name+'" lang:'+i.lang+" group:"+i.groupId+" channels:"+i.channels),this.trackId=e,this.currentTrack=i,this.hls.trigger(b.AUDIO_TRACK_SWITCHING,d({},i)),n))){var a=this.switchParams(i.url,null==r?void 0:r.details,i.details);this.loadPlaylist(a);}}},r.findTrackId=function(e){for(var t=this.tracksInGroup,r=0;r<t.length;r++){var i=t[r];if((!this.selectDefaultTrack||i.default)&&(!e||gt(e,i,vt)))return r}if(e){for(var n=e.name,a=e.lang,s=e.assocLang,o=e.characteristics,l=e.audioCodec,u=e.channels,d=0;d<t.length;d++)if(gt({name:n,lang:a,assocLang:s,characteristics:o,audioCodec:l,channels:u},t[d],vt))return d;for(var h=0;h<t.length;h++){var f=t[h];if(Ta(e.attrs,f.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return h}for(var c=0;c<t.length;c++){var g=t[c];if(Ta(e.attrs,g.attrs,["LANGUAGE"]))return c}}return -1},r.loadPlaylist=function(t){e.prototype.loadPlaylist.call(this);var r=this.currentTrack;this.shouldLoadPlaylist(r)&&pt(r.url,this.hls)&&this.scheduleLoading(r,t);},r.loadingPlaylist=function(t,r){e.prototype.loadingPlaylist.call(this,t,r);var i=t.id,n=t.groupId,a=this.getUrlWithDirectives(t.url,r),s=t.details,o=null==s?void 0:s.age;this.log("Loading audio-track "+i+' "'+t.name+'" lang:'+t.lang+" group:"+n+(void 0!==(null==r?void 0:r.msn)?" at sn "+r.msn+" part "+r.part:"")+(o&&s.live?" age "+o.toFixed(1)+(s.type&&" "+s.type||""):"")+" "+a),this.hls.trigger(b.AUDIO_TRACK_LOADING,{url:a,id:i,groupId:n,deliveryDirectives:r||null,track:t});},i(t,[{key:"allAudioTracks",get:function(){return this.tracks}},{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(e){this.selectDefaultTrack=!1,this.setAudioTrack(e);}}])}(ya),La=function(){function e(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e;}var t=e.prototype;return t.destroy=function(){this.tracks=this.queues=null;},t.append=function(e,t,r){if(null!==this.queues&&null!==this.tracks){var i=this.queues[t];i.push(e),1!==i.length||r||this.executeNext(t);}},t.appendBlocker=function(e){var t=this;return new Promise((function(r){var i={label:"async-blocker",execute:r,onStart:function(){},onComplete:function(){},onError:function(){}};t.append(i,e);}))},t.prependBlocker=function(e){var t=this;return new Promise((function(r){if(t.queues){var i={label:"async-blocker-prepend",execute:r,onStart:function(){},onComplete:function(){},onError:function(){}};t.queues[e].unshift(i);}}))},t.removeBlockers=function(){null!==this.queues&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach((function(e){var t,r=null==(t=e[0])?void 0:t.label;"async-blocker"!==r&&"async-blocker-prepend"!==r||(e[0].execute(),e.splice(0,1));}));},t.unblockAudio=function(e){null!==this.queues&&this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio");},t.executeNext=function(e){if(null!==this.queues&&null!==this.tracks){var t=this.queues[e];if(t.length){var r=t[0];try{r.execute();}catch(t){var i;if(r.onError(t),null===this.queues||null===this.tracks)return;var n=null==(i=this.tracks[e])?void 0:i.buffer;null!=n&&n.updating||this.shiftAndExecuteNext(e);}}}},t.shiftAndExecuteNext=function(e){null!==this.queues&&(this.queues[e].shift(),this.executeNext(e));},t.current=function(e){var t;return (null==(t=this.queues)?void 0:t[e][0])||null},t.toString=function(){var e=this.queues,t=this.tracks;return null===e||null===t?"<destroyed>":"\n"+this.list("video")+"\n"+this.list("audio")+"\n"+this.list("audiovideo")+"}"},t.list=function(e){var t,r;return null!=(t=this.queues)&&t[e]||null!=(r=this.tracks)&&r[e]?e+": ("+this.listSbInfo(e)+") "+this.listOps(e):""},t.listSbInfo=function(e){var t,r=null==(t=this.tracks)?void 0:t[e],i=null==r?void 0:r.buffer;return i?"SourceBuffer"+(i.updating?" updating":"")+(r.ended?" ended":"")+(r.ending?" ending":""):"none"},t.listOps=function(e){var t;return (null==(t=this.queues)?void 0:t[e].map((function(e){return e.label})).join(", "))||""},e}(),Ia=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,Ra="HlsJsTrackRemovedError",ka=function(e){function t(t){var r;return (r=e.call(this,t)||this).name=Ra,r}return o(t,e),t}(c(Error)),ba=function(e){function t(t,r){var i,n;return (i=e.call(this,"buffer-controller",t.logger)||this).hls=void 0,i.fragmentTracker=void 0,i.details=null,i._objectUrl=null,i.operationQueue=null,i.bufferCodecEventsTotal=0,i.media=null,i.mediaSource=null,i.lastMpegAudioChunk=null,i.blockedAudioAppend=null,i.lastVideoAppendEnd=0,i.appendSource=void 0,i.transferData=void 0,i.overrides=void 0,i.appendErrors={audio:0,video:0,audiovideo:0},i.tracks={},i.sourceBuffers=[[null,null],[null,null]],i._onEndStreaming=function(e){var t;i.hls&&"open"===(null==(t=i.mediaSource)?void 0:t.readyState)&&i.hls.pauseBuffering();},i._onStartStreaming=function(e){i.hls&&i.hls.resumeBuffering();},i._onMediaSourceOpen=function(e){var t=i,r=t.media,n=t.mediaSource;e&&i.log("Media source opened"),r&&n&&(n.removeEventListener("sourceopen",i._onMediaSourceOpen),r.removeEventListener("emptied",i._onMediaEmptied),i.updateDuration(),i.hls.trigger(b.MEDIA_ATTACHED,{media:r,mediaSource:n}),null!==i.mediaSource&&i.checkPendingTracks());},i._onMediaSourceClose=function(){i.log("Media source closed");},i._onMediaSourceEnded=function(){i.log("Media source ended");},i._onMediaEmptied=function(){var e=i,t=e.mediaSrc,r=e._objectUrl;t!==r&&i.error("Media element src was set while attaching MediaSource ("+r+" > "+t+")");},i.hls=t,i.fragmentTracker=r,i.appendSource=(n=W(t.config.preferManagedMediaSource),"undefined"!=typeof self&&n===self.ManagedMediaSource),i.initTracks(),i.registerListeners(),i}o(t,e);var r=t.prototype;return r.hasSourceTypes=function(){return Object.keys(this.tracks).length>0},r.destroy=function(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null;},r.registerListeners=function(){var e=this.hls;e.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.BUFFER_RESET,this.onBufferReset,this),e.on(b.BUFFER_APPENDING,this.onBufferAppending,this),e.on(b.BUFFER_CODECS,this.onBufferCodecs,this),e.on(b.BUFFER_EOS,this.onBufferEos,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(b.FRAG_PARSED,this.onFragParsed,this),e.on(b.FRAG_CHANGED,this.onFragChanged,this),e.on(b.ERROR,this.onError,this);},r.unregisterListeners=function(){var e=this.hls;e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.BUFFER_RESET,this.onBufferReset,this),e.off(b.BUFFER_APPENDING,this.onBufferAppending,this),e.off(b.BUFFER_CODECS,this.onBufferCodecs,this),e.off(b.BUFFER_EOS,this.onBufferEos,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(b.FRAG_PARSED,this.onFragParsed,this),e.off(b.FRAG_CHANGED,this.onFragChanged,this),e.off(b.ERROR,this.onError,this);},r.transferMedia=function(){var e=this,t=this.media,r=this.mediaSource;if(!t)return null;var i={};if(this.operationQueue){var n=this.isUpdating();n||this.operationQueue.removeBlockers();var s=this.isQueued();(n||s)&&this.warn("Transfering MediaSource with"+(s?" operations in queue":"")+(n?" updating SourceBuffer(s)":"")+" "+this.operationQueue),this.operationQueue.destroy();}var o=this.transferData;return !this.sourceBufferCount&&o&&o.mediaSource===r?a(i,o.tracks):this.sourceBuffers.forEach((function(t){var r=t[0];r&&(i[r]=a({},e.tracks[r]),e.removeBuffer(r)),t[0]=t[1]=null;})),{media:t,mediaSource:r,tracks:i}},r.initTracks=function(){this.sourceBuffers=[[null,null],[null,null]],this.tracks={},this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0;},r.onManifestLoading=function(){this.bufferCodecEventsTotal=0,this.details=null;},r.onManifestParsed=function(e,t){var r,i=2;(t.audio&&!t.video||!t.altAudio)&&(i=1),this.bufferCodecEventsTotal=i,this.log(i+" bufferCodec event(s) expected."),null!=(r=this.transferData)&&r.mediaSource&&this.sourceBufferCount&&i&&this.bufferCreated();},r.onMediaAttaching=function(e,t){var r=this.media=t.media;this.transferData=this.overrides=void 0;var i=W(this.appendSource);if(i){var n=!!t.mediaSource;(n||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);var a=this.mediaSource=t.mediaSource||new i;if(this.assignMediaSource(a),n)this._objectUrl=r.src,this.attachTransferred();else {var s=this._objectUrl=self.URL.createObjectURL(a);if(this.appendSource)try{r.removeAttribute("src");var o=self.ManagedMediaSource;r.disableRemotePlayback=r.disableRemotePlayback||o&&a instanceof o,Da(r),function(e,t){var r=self.document.createElement("source");r.type="video/mp4",r.src=t,e.appendChild(r);}(r,s),r.load();}catch(e){r.src=s;}else r.src=s;}r.addEventListener("emptied",this._onMediaEmptied);}},r.assignMediaSource=function(e){var t,r;this.log(((null==(t=this.transferData)?void 0:t.mediaSource)===e?"transferred":"created")+" media source: "+(null==(r=e.constructor)?void 0:r.name)),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming));},r.attachTransferred=function(){var e=this,t=this.media,r=this.transferData;if(r&&t){var i=this.tracks,n=r.tracks,a=n?Object.keys(n):null,s=a?a.length:0,o=function(){Promise.resolve().then((function(){e.media&&e.mediaSourceOpenOrEnded&&e._onMediaSourceOpen();}));};if(n&&a&&s){if(!this.tracksReady)return this.hls.config.startFragPrefetch=!0,void this.log("attachTransferred: waiting for SourceBuffer track info");if(this.log("attachTransferred: (bufferCodecEventsTotal "+this.bufferCodecEventsTotal+")\nrequired tracks: "+ut(i,(function(e,t){return "initSegment"===e?void 0:t}))+";\ntransfer tracks: "+ut(n,(function(e,t){return "initSegment"===e?void 0:t}))+"}"),!j(n,i)){r.mediaSource=null,r.tracks=void 0;var l=t.currentTime,u=this.details,d=Math.max(l,(null==u?void 0:u.fragments[0].start)||0);return d-l>1?void this.log("attachTransferred: waiting for playback to reach new tracks start time "+l+" -> "+d):(this.warn('attachTransferred: resetting MediaSource for incompatible tracks ("'+Object.keys(n)+'"->"'+Object.keys(i)+'") start time: '+d+" currentTime: "+l),this.onMediaDetaching(b.MEDIA_DETACHING,{}),this.onMediaAttaching(b.MEDIA_ATTACHING,r),void(t.currentTime=d))}this.transferData=void 0,a.forEach((function(t){var r=t,i=n[r];if(i){var a=i.buffer;if(a){var s=e.fragmentTracker,o=i.id;if(s.hasFragments(o)||s.hasParts(o)){var l=dr.getBuffered(a);s.detectEvictedFragments(r,l,o,null,!0);}var u=_a(r),d=[r,a];e.sourceBuffers[u]=d,a.updating&&e.operationQueue&&e.operationQueue.prependBlocker(r),e.trackSourceBuffer(r,i);}}})),o(),this.bufferCreated();}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),o();}},r.onMediaDetaching=function(e,t){var r=this,i=!!t.transferMedia;this.transferData=this.overrides=void 0;var n=this.media,a=this.mediaSource,s=this._objectUrl;if(a){if(this.log("media source "+(i?"transferring":"detaching")),i)this.sourceBuffers.forEach((function(e){var t=e[0];t&&r.removeBuffer(t);})),this.resetQueue();else {if(this.mediaSourceOpenOrEnded){var o="open"===a.readyState;try{for(var l=a.sourceBuffers,u=l.length;u--;)o&&l[u].abort(),a.removeSourceBuffer(l[u]);o&&a.endOfStream();}catch(e){this.warn("onMediaDetaching: "+e.message+" while calling endOfStream");}}this.sourceBufferCount&&this.onBufferReset();}a.removeEventListener("sourceopen",this._onMediaSourceOpen),a.removeEventListener("sourceended",this._onMediaSourceEnded),a.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(a.removeEventListener("startstreaming",this._onStartStreaming),a.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null;}n&&(n.removeEventListener("emptied",this._onMediaEmptied),i||(s&&self.URL.revokeObjectURL(s),this.mediaSrc===s?(n.removeAttribute("src"),this.appendSource&&Da(n),n.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(b.MEDIA_DETACHED,t);},r.onBufferReset=function(){var e=this;this.sourceBuffers.forEach((function(t){var r=t[0];r&&e.resetBuffer(r);})),this.initTracks();},r.resetBuffer=function(e){var t,r=null==(t=this.tracks[e])?void 0:t.buffer;if(this.removeBuffer(e),r)try{var i;null!=(i=this.mediaSource)&&i.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(r);}catch(t){this.warn("onBufferReset "+e,t);}delete this.tracks[e];},r.removeBuffer=function(e){this.removeBufferListeners(e),this.sourceBuffers[_a(e)]=[null,null];var t=this.tracks[e];t&&(t.buffer=void 0);},r.resetQueue=function(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new La(this.tracks);},r.onBufferCodecs=function(e,t){var r,i=this,n=this.tracks,a=Object.keys(t);this.log('BUFFER_CODECS: "'+a+'" (current SB count '+this.sourceBufferCount+")");var s="audiovideo"in t&&(n.audio||n.video)||n.audiovideo&&("audio"in t||"video"in t),o=!s&&this.sourceBufferCount&&this.media&&a.some((function(e){return !n[e]}));s||o?this.warn('Unsupported transition between "'+Object.keys(n)+'" and "'+a+'" SourceBuffers'):(a.forEach((function(e){var r,a,s=t[e],o=s.id,l=s.codec,u=s.levelCodec,d=s.container,h=s.metadata,f=s.supplemental,c=n[e],g=null==(r=i.transferData)||null==(r=r.tracks)?void 0:r[e],v=null!=g&&g.buffer?g:c,m=(null==v?void 0:v.pendingCodec)||(null==v?void 0:v.codec),p=null==v?void 0:v.levelCodec;c||(c=n[e]={buffer:void 0,listeners:[],codec:l,supplemental:f,container:d,levelCodec:u,metadata:h,id:o});var y=Ve(m,p),E=null==y?void 0:y.replace(Ia,"$1"),T=Ve(l,u),S=null==(a=T)?void 0:a.replace(Ia,"$1");T&&y&&E!==S&&("audio"===e.slice(0,5)&&(T=Ke(T,i.appendSource)),i.log("switching codec "+m+" to "+T),T!==(c.pendingCodec||c.codec)&&(c.pendingCodec=T),c.container=d,i.appendChangeType(e,d,T));})),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),this.sourceBufferCount||(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!t.video&&"main"===(null==(r=t.audio)?void 0:r.id)&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks()));},r.appendChangeType=function(e,t,r){var i=this,n=t+";codecs="+r,a={label:"change-type="+n,execute:function(){var a=i.tracks[e];if(a){var s=a.buffer;null!=s&&s.changeType&&(i.log("changing "+e+" sourceBuffer type to "+n),s.changeType(n),a.codec=r,a.container=t);}i.shiftAndExecuteNext(e);},onStart:function(){},onComplete:function(){},onError:function(t){i.warn("Failed to change "+e+" SourceBuffer type",t);}};this.append(a,e,this.isPending(this.tracks[e]));},r.blockAudio=function(e){var t,r=this,i=e.start,n=i+.05*e.duration;if(!0!==(null==(t=this.fragmentTracker.getAppendedFrag(i,w))?void 0:t.gap)){var a={label:"block-audio",execute:function(){var e,t=r.tracks.video;(r.lastVideoAppendEnd>n||null!=t&&t.buffer&&dr.isBuffered(t.buffer,n)||!0===(null==(e=r.fragmentTracker.getAppendedFrag(n,w))?void 0:e.gap))&&(r.blockedAudioAppend=null,r.shiftAndExecuteNext("audio"));},onStart:function(){},onComplete:function(){},onError:function(e){r.warn("Error executing block-audio operation",e);}};this.blockedAudioAppend={op:a,frag:e},this.append(a,"audio",!0);}},r.unblockAudio=function(){var e=this.blockedAudioAppend,t=this.operationQueue;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op));},r.onBufferAppending=function(e,t){var r=this,i=this.tracks,n=t.data,a=t.type,s=t.parent,o=t.frag,l=t.part,u=t.chunkMeta,d=t.offset,h=u.buffering[a],f=o.sn,c=o.cc,g=self.performance.now();h.start=g;var v=o.stats.buffering,m=l?l.stats.buffering:null;0===v.start&&(v.start=g),m&&0===m.start&&(m.start=g);var p=i.audio,y=!1;"audio"===a&&"audio/mpeg"===(null==p?void 0:p.container)&&(y=!this.lastMpegAudioChunk||1===u.id||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);var E=i.video,T=null==E?void 0:E.buffer;if(T&&"initSegment"!==f){var S=l||o,L=this.blockedAudioAppend;if("audio"!==a||"main"===s||this.blockedAudioAppend||E.ending||E.ended){if("video"===a){var I=S.end;if(L){var D=L.frag.start;(I>D||I<this.lastVideoAppendEnd||dr.isBuffered(T,D))&&this.unblockAudio();}this.lastVideoAppendEnd=I;}}else {var _=S.start+.05*S.duration,P=T.buffered,C=this.currentOp("video");P.length||C?!C&&!dr.isBuffered(T,_)&&this.lastVideoAppendEnd<_&&this.blockAudio(S):this.blockAudio(S);}}var O=(l||o).start,x={label:"append-"+a,execute:function(){var e;h.executeStart=self.performance.now();var t=null==(e=r.tracks[a])?void 0:e.buffer;t&&(y?r.updateTimestampOffset(t,O,.1,a,f,c):void 0!==d&&A(d)&&r.updateTimestampOffset(t,d,1e-6,a,f,c)),r.appendExecutor(n,a);},onStart:function(){},onComplete:function(){var e=self.performance.now();h.executeEnd=h.end=e,0===v.first&&(v.first=e),m&&0===m.first&&(m.first=e);var t={};r.sourceBuffers.forEach((function(e){var r=e[0],i=e[1];r&&(t[r]=dr.getBuffered(i));})),r.appendErrors[a]=0,"audio"===a||"video"===a?r.appendErrors.audiovideo=0:(r.appendErrors.audio=0,r.appendErrors.video=0),r.hls.trigger(b.BUFFER_APPENDED,{type:a,frag:o,part:l,chunkMeta:u,parent:o.type,timeRanges:t});},onError:function(e){var t,i={type:R.MEDIA_ERROR,parent:o.type,details:k.BUFFER_APPEND_ERROR,sourceBufferName:a,frag:o,part:l,chunkMeta:u,error:e,err:e,fatal:!1},n=null==(t=r.media)?void 0:t.error;if(e.code===DOMException.QUOTA_EXCEEDED_ERR||"QuotaExceededError"==e.name||"quota"in e)i.details=k.BUFFER_FULL_ERROR;else if(e.code===DOMException.INVALID_STATE_ERR&&r.mediaSourceOpenOrEnded&&!n)i.errorAction=Kt(!0);else if(e.name===Ra&&0===r.sourceBufferCount)i.errorAction=Kt(!0);else {var s=++r.appendErrors[a];r.warn("Failed "+s+"/"+r.hls.config.appendErrorMaxRetry+' times to append segment in "'+a+'" sourceBuffer ('+(n||"no media error")+")"),(s>=r.hls.config.appendErrorMaxRetry||n)&&(i.fatal=!0);}r.hls.trigger(b.ERROR,i);}};this.log('queuing "'+a+'" append sn: '+f+(l?" p: "+l.index:"")+" of "+(o.type===w?"level":"track")+" "+o.level+" cc: "+c),this.append(x,a,this.isPending(this.tracks[a]));},r.getFlushOp=function(e,t,r){var i=this;return this.log('queuing "'+e+'" remove '+t+"-"+r),{label:"remove",execute:function(){i.removeExecutor(e,t,r);},onStart:function(){},onComplete:function(){i.hls.trigger(b.BUFFER_FLUSHED,{type:e});},onError:function(n){i.warn("Failed to remove "+t+"-"+r+' from "'+e+'" SourceBuffer',n);}}},r.onBufferFlushing=function(e,t){var r=this,i=t.type,n=t.startOffset,a=t.endOffset;i?this.append(this.getFlushOp(i,n,a),i):this.sourceBuffers.forEach((function(e){var t=e[0];t&&r.append(r.getFlushOp(t,n,a),t);}));},r.onFragParsed=function(e,t){var r=this,i=t.frag,n=t.part,a=[],s=n?n.elementaryStreams:i.elementaryStreams;s[J]?a.push("audiovideo"):(s[$]&&a.push("audio"),s[Z]&&a.push("video")),0===a.length&&this.warn("Fragments must have at least one ElementaryStreamType set. type: "+i.type+" level: "+i.level+" sn: "+i.sn),this.blockBuffers((function(){var e=self.performance.now();i.stats.buffering.end=e,n&&(n.stats.buffering.end=e);var t=n?n.stats:i.stats;r.hls.trigger(b.FRAG_BUFFERED,{frag:i,part:n,stats:t,id:i.type});}),a).catch((function(e){r.warn("Fragment buffered callback "+e),r.stepOperationQueue(r.sourceBufferTypes);}));},r.onFragChanged=function(e,t){this.trimBuffers();},r.onBufferEos=function(e,t){var r,i=this;this.sourceBuffers.forEach((function(e){var r=e[0];if(r){var n=i.tracks[r];t.type&&t.type!==r||(n.ending=!0,n.ended||(n.ended=!0,i.log(r+" buffer reached EOS")));}}));var n=!1!==(null==(r=this.overrides)?void 0:r.endOfStream);this.sourceBufferCount>0&&!this.sourceBuffers.some((function(e){var t,r=e[0];return r&&!(null!=(t=i.tracks[r])&&t.ended)}))?n?(this.log("Queueing EOS"),this.blockUntilOpen((function(){i.tracksEnded();var e=i.mediaSource;e&&"open"===e.readyState?(i.log("Calling mediaSource.endOfStream()"),e.endOfStream(),i.hls.trigger(b.BUFFERED_TO_END,void 0)):e&&i.log("Could not call mediaSource.endOfStream(). mediaSource.readyState: "+e.readyState);}))):(this.tracksEnded(),this.hls.trigger(b.BUFFERED_TO_END,void 0)):"video"===t.type&&this.unblockAudio();},r.tracksEnded=function(){var e=this;this.sourceBuffers.forEach((function(t){var r=t[0];if(null!==r){var i=e.tracks[r];i&&(i.ending=!1);}}));},r.onLevelUpdated=function(e,t){var r=t.details;r.fragments.length&&(this.details=r,this.updateDuration());},r.updateDuration=function(){var e=this;this.blockUntilOpen((function(){var t=e.getDurationAndRange();t&&e.updateMediaSource(t);}));},r.onError=function(e,t){if(t.details===k.BUFFER_APPEND_ERROR&&t.frag){var r,i=null==(r=t.errorAction)?void 0:r.nextAutoLevel;A(i)&&i!==t.frag.level&&this.resetAppendErrors();}},r.resetAppendErrors=function(){this.appendErrors={audio:0,video:0,audiovideo:0};},r.trimBuffers=function(){var e=this.hls,t=this.details,r=this.media;if(r&&null!==t&&this.sourceBufferCount){var i=e.config,n=r.currentTime,a=t.levelTargetDuration,s=t.live&&null!==i.liveBackBufferLength?i.liveBackBufferLength:i.backBufferLength;if(A(s)&&s>=0){var o=Math.max(s,a),l=Math.floor(n/a)*a-o;this.flushBackBuffer(n,a,l);}var u=i.frontBufferFlushThreshold;if(A(u)&&u>0){var d=Math.max(i.maxBufferLength,u),h=Math.max(d,a),f=Math.floor(n/a)*a+h;this.flushFrontBuffer(n,a,f);}}},r.flushBackBuffer=function(e,t,r){var i=this;this.sourceBuffers.forEach((function(e){var t=e[0],n=e[1];if(n){var a=dr.getBuffered(n);if(a.length>0&&r>a.start(0)){var s;i.hls.trigger(b.BACK_BUFFER_REACHED,{bufferEnd:r});var o=i.tracks[t];if(null!=(s=i.details)&&s.live)i.hls.trigger(b.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r});else if(null!=o&&o.ended)return void i.log("Cannot flush "+t+" back buffer while SourceBuffer is in ended state");i.hls.trigger(b.BUFFER_FLUSHING,{startOffset:0,endOffset:r,type:t});}}}));},r.flushFrontBuffer=function(e,t,r){var i=this;this.sourceBuffers.forEach((function(t){var n=t[0],a=t[1];if(a){var s=dr.getBuffered(a),o=s.length;if(o<2)return;var l=s.start(o-1),u=s.end(o-1);if(r>l||e>=l&&e<=u)return;i.hls.trigger(b.BUFFER_FLUSHING,{startOffset:l,endOffset:1/0,type:n});}}));},r.getDurationAndRange=function(){var e,t=this.details,r=this.mediaSource;if(!t||!this.media||"open"!==(null==r?void 0:r.readyState))return null;var i=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&r.setLiveSeekableRange){var n=Math.max(0,t.fragmentStart);return {duration:1/0,start:n,end:Math.max(n,i)}}return {duration:1/0}}var a=null==(e=this.overrides)?void 0:e.duration;if(a)return A(a)?{duration:a}:null;var s=this.media.duration;return i>(A(r.duration)?r.duration:0)&&i>s||!A(s)?{duration:i}:null},r.updateMediaSource=function(e){var t=e.duration,r=e.start,i=e.end,n=this.mediaSource;this.media&&n&&"open"===n.readyState&&(n.duration!==t&&(A(t)&&this.log("Updating MediaSource duration to "+t.toFixed(3)),n.duration=t),void 0!==r&&void 0!==i&&(this.log("MediaSource duration is set to "+n.duration+". Setting seekable range to "+r+"-"+i+"."),n.setLiveSeekableRange(r,i)));},r.checkPendingTracks=function(){var e=this.bufferCodecEventsTotal,t=this.pendingTrackCount,r=this.tracks;if(this.log("checkPendingTracks (pending: "+t+" codec events expected: "+e+") "+ut(r)),this.tracksReady){var i,n=null==(i=this.transferData)?void 0:i.tracks;n&&Object.keys(n).length?this.attachTransferred():this.createSourceBuffers();}},r.bufferCreated=function(){var e=this;if(this.sourceBufferCount){var t={};this.sourceBuffers.forEach((function(r){var i=r[0],n=r[1];if(i){var a=e.tracks[i];t[i]={buffer:n,container:a.container,codec:a.codec,supplemental:a.supplemental,levelCodec:a.levelCodec,id:a.id,metadata:a.metadata};}})),this.hls.trigger(b.BUFFER_CREATED,{tracks:t}),this.log("SourceBuffers created. Running queue: "+this.operationQueue),this.sourceBuffers.forEach((function(t){var r=t[0];e.executeNext(r);}));}else {var r=new Error("could not create source buffer for media codec(s)");this.hls.trigger(b.ERROR,{type:R.MEDIA_ERROR,details:k.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:r,reason:r.message});}},r.createSourceBuffers=function(){var e=this.tracks,t=this.sourceBuffers,r=this.mediaSource;if(!r)throw new Error("createSourceBuffers called when mediaSource was null");for(var i in e){var n=i,a=e[n];if(this.isPending(a)){var s=this.getTrackCodec(a,n),o=a.container+";codecs="+s;a.codec=s,this.log("creating sourceBuffer("+o+")"+(this.currentOp(n)?" Queued":"")+" "+ut(a));try{var l=r.addSourceBuffer(o),u=_a(n),d=[n,l];t[u]=d,a.buffer=l;}catch(e){var h;return this.error("error while trying to add sourceBuffer: "+e.message),this.shiftAndExecuteNext(n),null==(h=this.operationQueue)||h.removeBlockers(),delete this.tracks[n],void this.hls.trigger(b.ERROR,{type:R.MEDIA_ERROR,details:k.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:e,sourceBufferName:n,mimeType:o,parent:a.id})}this.trackSourceBuffer(n,a);}}this.bufferCreated();},r.getTrackCodec=function(e,t){var r=e.supplemental,i=e.codec;r&&("video"===t||"audiovideo"===t)&&xe(r,"video")&&(i=function(e,t){var r=[];if(e)for(var i=e.split(","),n=0;n<i.length;n++)Oe(i[n],"video")||r.push(i[n]);return t&&r.push(t),r.join(",")}(i,r));var n=Ve(i,e.levelCodec);return n?"audio"===t.slice(0,5)?Ke(n,this.appendSource):n:""},r.trackSourceBuffer=function(e,t){var r=this,i=t.buffer;if(i){var n=this.getTrackCodec(t,e);this.tracks[e]={buffer:i,codec:n,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(function(e,t){var i=t.removedRanges;null!=i&&i.length&&r.hls.trigger(b.BUFFER_FLUSHED,{type:e});}));}},r.onSBUpdateStart=function(e){var t=this.currentOp(e);t&&t.onStart();},r.onSBUpdateEnd=function(e){var t;if("closed"!==(null==(t=this.mediaSource)?void 0:t.readyState)){var r=this.currentOp(e);r&&(r.onComplete(),this.shiftAndExecuteNext(e));}else this.resetBuffer(e);},r.onSBUpdateError=function(e,t){var r,i=new Error(e+" SourceBuffer error. MediaSource readyState: "+(null==(r=this.mediaSource)?void 0:r.readyState));this.error(""+i,t),this.hls.trigger(b.ERROR,{type:R.MEDIA_ERROR,details:k.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:i,fatal:!1});var n=this.currentOp(e);n&&n.onError(i);},r.updateTimestampOffset=function(e,t,r,i,n,a){var s=t-e.timestampOffset;Math.abs(s)>=r&&(this.log("Updating "+i+" SourceBuffer timestampOffset to "+t+" (sn: "+n+" cc: "+a+")"),e.timestampOffset=t);},r.removeExecutor=function(e,t,r){var i=this.media,n=this.mediaSource,a=this.tracks[e],s=null==a?void 0:a.buffer;if(!i||!n||!s)return this.warn("Attempting to remove from the "+e+" SourceBuffer, but it does not exist"),void this.shiftAndExecuteNext(e);var o=A(i.duration)?i.duration:1/0,l=A(n.duration)?n.duration:1/0,u=Math.max(0,t),d=Math.min(r,o,l);d>u&&(!a.ending||a.ended)?(a.ended=!1,this.log("Removing ["+u+","+d+"] from the "+e+" SourceBuffer"),s.remove(u,d)):this.shiftAndExecuteNext(e);},r.appendExecutor=function(e,t){var r=this.tracks[t],i=null==r?void 0:r.buffer;if(!i)throw new ka("Attempting to append to the "+t+" SourceBuffer, but it does not exist");r.ending=!1,r.ended=!1,i.appendBuffer(e);},r.blockUntilOpen=function(e){var t=this;if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch((function(e){t.warn("SourceBuffer blocked callback "+e),t.stepOperationQueue(t.sourceBufferTypes);}));else try{e();}catch(e){this.warn("Callback run without blocking "+this.operationQueue+" "+e);}},r.isUpdating=function(){return this.sourceBuffers.some((function(e){var t=e[0],r=e[1];return t&&r.updating}))},r.isQueued=function(){var e=this;return this.sourceBuffers.some((function(t){var r=t[0];return r&&!!e.currentOp(r)}))},r.isPending=function(e){return !!e&&!e.buffer},r.blockBuffers=function(e,t){var r=this;if(void 0===t&&(t=this.sourceBufferTypes),!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);var i=this.operationQueue,n=t.map((function(e){return r.appendBlocker(e)}));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(n).then((function(t){i===r.operationQueue&&(e(),r.stepOperationQueue(r.sourceBufferTypes));}))},r.stepOperationQueue=function(e){var t=this;e.forEach((function(e){var r,i=null==(r=t.tracks[e])?void 0:r.buffer;i&&!i.updating&&t.shiftAndExecuteNext(e);}));},r.append=function(e,t,r){this.operationQueue&&this.operationQueue.append(e,t,r);},r.appendBlocker=function(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)},r.currentOp=function(e){return this.operationQueue?this.operationQueue.current(e):null},r.executeNext=function(e){e&&this.operationQueue&&this.operationQueue.executeNext(e);},r.shiftAndExecuteNext=function(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e);},r.addBufferListener=function(e,t,r){var i=this.tracks[e];if(i){var n=i.buffer;if(n){var a=r.bind(this,e);i.listeners.push({event:t,listener:a}),n.addEventListener(t,a);}}},r.removeBufferListeners=function(e){var t=this.tracks[e];if(t){var r=t.buffer;r&&(t.listeners.forEach((function(e){r.removeEventListener(e.event,e.listener);})),t.listeners.length=0);}},i(t,[{key:"mediaSourceOpenOrEnded",get:function(){var e,t=null==(e=this.mediaSource)?void 0:e.readyState;return "open"===t||"ended"===t}},{key:"sourceBufferTracks",get:function(){var e=this;return Object.keys(this.tracks).reduce((function(t,r){var i=e.tracks[r];return t[r]={id:i.id,container:i.container,codec:i.codec,levelCodec:i.levelCodec},t}),{})}},{key:"bufferedToEnd",get:function(){var e=this;return this.sourceBufferCount>0&&!this.sourceBuffers.some((function(t){var r=t[0];if(r){var i=e.tracks[r];if(i)return !i.ended||i.ending}return !1}))}},{key:"tracksReady",get:function(){var e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}},{key:"mediaSrc",get:function(){var e,t,r=(null==(e=this.media)||null==(t=e.querySelector)?void 0:t.call(e,"source"))||this.media;return null==r?void 0:r.src}},{key:"pendingTrackCount",get:function(){var e=this;return Object.keys(this.tracks).reduce((function(t,r){return t+(e.isPending(e.tracks[r])?1:0)}),0)}},{key:"sourceBufferCount",get:function(){return this.sourceBuffers.reduce((function(e,t){return e+(t[0]?1:0)}),0)}},{key:"sourceBufferTypes",get:function(){return this.sourceBuffers.map((function(e){return e[0]})).filter((function(e){return !!e}))}}])}(N);function Da(e){var t=e.querySelectorAll("source");[].slice.call(t).forEach((function(t){e.removeChild(t);}));}function _a(e){return "audio"===e?1:0}var Pa=function(){function e(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners();}var t=e.prototype;return t.setStreamController=function(e){this.streamController=e;},t.destroy=function(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null;},t.registerListeners=function(){var e=this.hls;e.on(b.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(b.BUFFER_CODECS,this.onBufferCodecs,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this);},t.unregisterListener=function(){var e=this.hls;e.off(b.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(b.BUFFER_CODECS,this.onBufferCodecs,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this);},t.onFpsDropLevelCapping=function(e,t){var r=this.hls.levels[t.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width});},t.onMediaAttaching=function(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize();},t.onManifestParsed=function(e,t){var r=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,r.config.capLevelToPlayerSize&&t.video&&this.startCapping();},t.onLevelsUpdated=function(e,t){this.timer&&A(this.autoLevelCapping)&&this.detectPlayerSize();},t.onBufferCodecs=function(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping();},t.onMediaDetaching=function(){this.stopCapping(),this.media=null;},t.detectPlayerSize=function(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);var e=this.hls.levels;if(e.length){var t=this.hls,r=this.getMaxLevel(e.length-1);r!==this.autoLevelCapping&&t.logger.log("Setting autoLevelCapping to "+r+": "+e[r].height+"p@"+e[r].bitrate+" for media "+this.mediaWidth+"x"+this.mediaHeight),t.autoLevelCapping=r,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping;}}},t.getMaxLevel=function(t){var r=this,i=this.hls.levels;if(!i.length)return -1;var n=i.filter((function(e,i){return r.isLevelAllowed(e)&&i<=t}));return this.clientRect=null,e.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)},t.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize());},t.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0);},t.getDimensions=function(){if(this.clientRect)return this.clientRect;var e=this.media,t={width:0,height:0};if(e){var r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,t.width||t.height||(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0);}return this.clientRect=t,t},t.isLevelAllowed=function(e){return !this.restrictedLevels.some((function(t){return e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height}))},e.getMaxLevelByMediaSize=function(e,t,r){if(null==e||!e.length)return -1;for(var i,n,a=e.length-1,s=Math.max(t,r),o=0;o<e.length;o+=1){var l=e[o];if((l.width>=s||l.height>=s)&&(i=l,!(n=e[o+1])||i.width!==n.width||i.height!==n.height)){a=o;break}}return a},i(e,[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio;}catch(e){}return Math.min(e,this.hls.config.maxDevicePixelRatio)}}])}(),Ca={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},wa={HLS:"h"},Oa=function e(t,r){Array.isArray(t)&&(t=t.map((function(t){return t instanceof e?t:new e(t)}))),this.value=t,this.params=r;},xa="Dict";function Ma(e,t,r,i){return new Error("failed to "+e+' "'+(n=t,(Array.isArray(n)?JSON.stringify(n):n instanceof Map?"Map{}":n instanceof Set?"Set{}":"object"==typeof n?JSON.stringify(n):String(n))+'" as ')+r,{cause:i});var n;}function Fa(e,t,r){return Ma("serialize",e,t,r)}var Na=function(e){this.description=e;},Ua="Bare Item",Ba="Boolean",Ga="Byte Sequence";function Ka(e){if(!1===ArrayBuffer.isView(e))throw Fa(e,Ga);return ":"+(t=e,btoa(String.fromCharCode.apply(String,t))+":");var t;}var Va="Integer";function Ha(e){if(function(e){return e<-999999999999999||999999999999999<e}(e))throw Fa(e,Va);return e.toString()}function Ya(e,t){if(e<0)return -Ya(-e,t);var r=Math.pow(10,t);if(Math.abs(e*r%1-.5)<Number.EPSILON){var i=Math.floor(e*r);return (i%2==0?i:i+1)/r}return Math.round(e*r)/r}var Wa="Decimal";function ja(e){var t=Ya(e,3);if(Math.floor(Math.abs(t)).toString().length>12)throw Fa(e,Wa);var r=t.toString();return r.includes(".")?r:r+".0"}var qa="String",Xa=/[\x00-\x1f\x7f]+/,Qa="Token";function za(e){var t,r=(t=e).description||t.toString().slice(7,-1);if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(r))throw Fa(r,Qa);return r}function $a(e){switch(typeof e){case"number":if(!A(e))throw Fa(e,Ua);return Number.isInteger(e)?Ha(e):ja(e);case"string":return function(e){if(Xa.test(e))throw Fa(e,qa);return '"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'}(e);case"symbol":return za(e);case"boolean":return function(e){if("boolean"!=typeof e)throw Fa(e,Ba);return e?"?1":"?0"}(e);case"object":if(e instanceof Date)return function(e){return "@"+Ha(e.getTime()/1e3)}(e);if(e instanceof Uint8Array)return Ka(e);if(e instanceof Na)return za(e);default:throw Fa(e,Ua)}}var Za="Key";function Ja(e){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(e))throw Fa(e,Za);return e}function es(e){return null==e?"":Object.entries(e).map((function(e){var t=e[0],r=e[1];return !0===r?";"+Ja(t):";"+Ja(t)+"="+$a(r)})).join("")}function ts(e){return e instanceof Oa?""+$a(e.value)+es(e.params):$a(e)}function rs(e,t){if(void 0===t&&(t={whitespace:!0}),"object"!=typeof e||null==e)throw Fa(e,xa);var r=e instanceof Map?e.entries():Object.entries(e),i=(null==t?void 0:t.whitespace)?" ":"";return Array.from(r).map((function(e){var t=e[0],r=e[1];r instanceof Oa==0&&(r=new Oa(r));var i,n=Ja(t);return !0===r.value?n+=es(r.params):(n+="=",Array.isArray(r.value)?n+="("+(i=r).value.map(ts).join(" ")+")"+es(i.params):n+=ts(r)),n})).join(","+i)}function is(e,t){return rs(e,t)}var ns="CMCD-Object",as="CMCD-Request",ss="CMCD-Session",os="CMCD-Status",ls={br:ns,ab:ns,d:ns,ot:ns,tb:ns,tpb:ns,lb:ns,tab:ns,lab:ns,url:ns,pb:as,bl:as,tbl:as,dl:as,ltc:as,mtp:as,nor:as,nrr:as,rc:as,sn:as,sta:as,su:as,ttfb:as,ttfbb:as,ttlb:as,cmsdd:as,cmsds:as,smrt:as,df:as,cs:as,ts:as,cid:ss,pr:ss,sf:ss,sid:ss,st:ss,v:ss,msd:ss,bs:os,bsd:os,cdn:os,rtp:os,bg:os,pt:os,ec:os,e:os},us={REQUEST:as};function ds(e,t){var r={};if(!e)return r;var i,n=Object.keys(e),a=t?(i=t,Object.keys(i).reduce((function(e,t){var r;return null===(r=i[t])||void 0===r||r.forEach((function(r){return e[r]=t})),e}),{})):{};return n.reduce((function(t,r){var i,n=ls[r]||a[r]||us.REQUEST;return (null!==(i=t[n])&&void 0!==i?i:t[n]={})[r]=e[r],t}),r)}var hs="event",fs=function(e){return Math.round(e)},cs=function(e,t){return Array.isArray(e)?e.map((function(e){return cs(e,t)})):e instanceof Oa&&"string"==typeof e.value?new Oa(cs(e.value,t),e.params):(t.baseUrl&&(e=function(e,t){var r=new URL(e),i=new URL(t);if(r.origin!==i.origin)return e;for(var n=r.pathname.split("/").slice(1),a=i.pathname.split("/").slice(1,-1);n[0]===a[0];)n.shift(),a.shift();for(;a.length;)a.shift(),n.unshift("..");return n.join("/")+r.search+r.hash}(e,t.baseUrl)),1===t.version?encodeURIComponent(e):e)},gs=function(e){return 100*fs(e/100)},vs={br:fs,d:fs,bl:gs,dl:gs,mtp:gs,nor:function(e,t){var r=e;return t.version>=2&&(e instanceof Oa&&"string"==typeof e.value?r=new Oa([e]):"string"==typeof e&&(r=[e])),cs(r,t)},rtp:gs,tb:fs},ms="request",ps="response",ys=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],Es=["e"],Ts=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function Ss(e){return Ts.test(e)}var As,Ls=["d","dl","nor","ot","rtp","su"],Is=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"],Rs=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function ks(e){return Rs.includes(e)||Ss(e)}var bs=((As={})[ps]=function(e){return ys.includes(e)||Ls.includes(e)||Is.includes(e)||Ss(e)},As[hs]=function(e){return ys.includes(e)||Es.includes(e)||Ss(e)},As[ms]=function(e){return ys.includes(e)||Ls.includes(e)||Ss(e)},As);function Ds(e,t){void 0===t&&(t={});var r={};if(null==e||"object"!=typeof e)return r;var i=t.version||e.v||1,n=t.reportingMode||ms,s=1===i?ks:bs[n],o=Object.keys(e).filter(s),l=t.filter;"function"==typeof l&&(o=o.filter(l));var u=n===ps||n===hs;u&&!o.includes("ts")&&o.push("ts"),i>1&&!o.includes("v")&&o.push("v");var d=a({},vs,t.formatters),h={version:i,reportingMode:n,baseUrl:t.baseUrl};return o.sort().forEach((function(t){var n=e[t],a=d[t];if("function"==typeof a&&(n=a(n,h)),"v"===t){if(1===i)return;n=i;}"pr"==t&&1===n||(u&&"ts"===t&&!A(n)&&(n=Date.now()),function(e){return "number"==typeof e?A(e):null!=e&&""!==e&&!1!==e}(n)&&(function(e){return ["ot","sf","st","e","sta"].includes(e)}(t)&&"string"==typeof n&&(n=new Na(n)),r[t]=n));})),r}function _s(e,t,r){return a(e,function(e,t){void 0===t&&(t={});var r={};if(!e)return r;var i=ds(Ds(e,t),null==t?void 0:t.customHeaderMap);return Object.entries(i).reduce((function(e,t){var r=t[0],i=is(t[1],{whitespace:!1});return i&&(e[r]=i),e}),r)}(t,r))}var Ps="CMCD";function Cs(e,t){if(void 0===t&&(t={}),!e)return "";var r=function(e,t){return void 0===t&&(t={}),e?is(Ds(e,t),{whitespace:!1}):""}(e,t);return encodeURIComponent(r)}var ws=/CMCD=[^&#]+/;function Os(e,t,r){var i=function(e,t){if(void 0===t&&(t={}),!e)return "";var r=Cs(e,t);return Ps+"="+r}(t,r);if(!i)return e;if(ws.test(e))return e.replace(ws,i);var n=e.includes("?")?"&":"?";return ""+e+n+i}var xs=function(){function e(e){var t=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){t.initialized&&(t.starved=!0),t.buffering=!0;},this.onPlaying=function(){t.initialized||(t.initialized=!0),t.buffering=!1;},this.applyPlaylistData=function(e){try{t.apply(e,{ot:Ca.MANIFEST,su:!t.initialized});}catch(e){t.hls.logger.warn("Could not generate manifest CMCD data.",e);}},this.applyFragmentData=function(e){try{var r=e.frag,i=e.part,n=t.hls.levels[r.level],a=t.getObjectType(r),s={d:1e3*(i||r).duration,ot:a};a!==Ca.VIDEO&&a!==Ca.AUDIO&&a!=Ca.MUXED||(s.br=n.bitrate/1e3,s.tb=t.getTopBandwidth(a)/1e3,s.bl=t.getBufferLength(a));var o=i?t.getNextPart(i):t.getNextFrag(r);null!=o&&o.url&&o.url!==r.url&&(s.nor=o.url),t.apply(e,s);}catch(e){t.hls.logger.warn("Could not generate segment CMCD data.",e);}},this.hls=e;var r=this.config=e.config,i=r.cmcd;null!=i&&(r.pLoader=this.createPlaylistLoader(),r.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||e.sessionId,this.cid=i.contentId,this.useHeaders=!0===i.useHeaders,this.includeKeys=i.includeKeys,this.registerListeners());}var t=e.prototype;return t.registerListeners=function(){var e=this.hls;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHED,this.onMediaDetached,this),e.on(b.BUFFER_CREATED,this.onBufferCreated,this);},t.unregisterListeners=function(){var e=this.hls;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHED,this.onMediaDetached,this),e.off(b.BUFFER_CREATED,this.onBufferCreated,this);},t.destroy=function(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null;},t.onMediaAttached=function(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying);},t.onMediaDetached=function(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null);},t.onBufferCreated=function(e,t){var r,i;this.audioBuffer=null==(r=t.tracks.audio)?void 0:r.buffer,this.videoBuffer=null==(i=t.tracks.video)?void 0:i.buffer;},t.createData=function(){var e;return {v:1,sf:wa.HLS,sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},t.apply=function(e,t){void 0===t&&(t={}),a(t,this.createData());var r=t.ot===Ca.INIT||t.ot===Ca.VIDEO||t.ot===Ca.MUXED;this.starved&&r&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering);var i=this.includeKeys;i&&(t=Object.keys(t).reduce((function(e,r){return i.includes(r)&&(e[r]=t[r]),e}),{}));var n={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),_s(e.headers,t,n)):e.url=Os(e.url,t,n);},t.getNextFrag=function(e){var t,r=null==(t=this.hls.levels[e.level])?void 0:t.details;if(r){var i=e.sn-r.startSN;return r.fragments[i+1]}},t.getNextPart=function(e){var t,r=e.index,i=e.fragment,n=null==(t=this.hls.levels[i.level])||null==(t=t.details)?void 0:t.partList;if(n)for(var a=i.sn,s=n.length-1;s>=0;s--){var o=n[s];if(o.index===r&&o.fragment.sn===a)return n[s+1]}},t.getObjectType=function(e){var t=e.type;return "subtitle"===t?Ca.TIMED_TEXT:"initSegment"===e.sn?Ca.INIT:"audio"===t?Ca.AUDIO:"main"===t?this.hls.audioTracks.length?Ca.VIDEO:Ca.MUXED:void 0},t.getTopBandwidth=function(e){var t,r=0,i=this.hls;if(e===Ca.AUDIO)t=i.audioTracks;else {var n=i.maxAutoLevel,a=n>-1?n+1:i.levels.length;t=i.levels.slice(0,a);}return t.forEach((function(e){e.bitrate>r&&(r=e.bitrate);})),r>0?r:NaN},t.getBufferLength=function(e){var t=this.media,r=e===Ca.AUDIO?this.audioBuffer:this.videoBuffer;return r&&t?1e3*dr.bufferInfo(r,t.currentTime,this.config.maxBufferHole).len:NaN},t.createPlaylistLoader=function(){var e=this.config.pLoader,t=this.applyPlaylistData,r=e||this.config.loader;return function(){function e(e){this.loader=void 0,this.loader=new r(e);}var n=e.prototype;return n.destroy=function(){this.loader.destroy();},n.abort=function(){this.loader.abort();},n.load=function(e,r,i){t(e),this.loader.load(e,r,i);},i(e,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}])}()},t.createFragmentLoader=function(){var e=this.config.fLoader,t=this.applyFragmentData,r=e||this.config.loader;return function(){function e(e){this.loader=void 0,this.loader=new r(e);}var n=e.prototype;return n.destroy=function(){this.loader.destroy();},n.abort=function(){this.loader.abort();},n.load=function(e,r,i){t(e),this.loader.load(e,r,i);},i(e,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}])}()},e}(),Ms=function(e){function t(t){var r;return (r=e.call(this,"content-steering",t.logger)||this).hls=void 0,r.loader=null,r.uri=null,r.pathwayId=".",r._pathwayPriority=null,r.timeToLoad=300,r.reloadTimer=-1,r.updated=0,r.started=!1,r.enabled=!0,r.levels=null,r.audioTracks=null,r.subtitleTracks=null,r.penalizedPathways={},r.hls=t,r.registerListeners(),r}o(t,e);var r=t.prototype;return r.registerListeners=function(){var e=this.hls;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.ERROR,this.onError,this);},r.unregisterListeners=function(){var e=this.hls;e&&(e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.ERROR,this.onError,this));},r.pathways=function(){return (this.levels||[]).reduce((function(e,t){return -1===e.indexOf(t.pathwayId)&&e.push(t.pathwayId),e}),[])},r.startLoad=function(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){var e=1e3*this.timeToLoad-(performance.now()-this.updated);if(e>0)return void this.scheduleRefresh(this.uri,e)}this.loadSteeringManifest(this.uri);}},r.stopLoad=function(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout();},r.clearTimeout=function(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1);},r.destroy=function(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null;},r.removeLevel=function(e){var t=this.levels;t&&(this.levels=t.filter((function(t){return t!==e})));},r.onManifestLoading=function(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null;},r.onManifestLoaded=function(e,t){var r=t.contentSteering;null!==r&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad());},r.onManifestParsed=function(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks;},r.onError=function(e,t){var r=t.errorAction;if((null==r?void 0:r.action)===Ot&&r.flags===Nt){var i=this.levels,n=this._pathwayPriority,a=this.pathwayId;if(t.context){var s=t.context,o=s.groupId,l=s.pathwayId,u=s.type;o&&i?a=this.getPathwayForGroupId(o,u,a):l&&(a=l);}a in this.penalizedPathways||(this.penalizedPathways[a]=performance.now()),!n&&i&&(n=this.pathways()),n&&n.length>1&&(this.updatePathwayPriority(n),r.resolved=this.pathwayId!==a),t.details!==k.BUFFER_APPEND_ERROR||t.fatal?r.resolved||this.warn("Could not resolve "+t.details+' ("'+t.error.message+'") with content-steering for Pathway: '+a+" levels: "+(i?i.length:i)+" priorities: "+ut(n)+" penalized: "+ut(this.penalizedPathways)):r.resolved=!0;}},r.filterParsedLevels=function(e){this.levels=e;var t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){var r=e[0].pathwayId;this.log("No levels found in Pathway "+this.pathwayId+'. Setting initial Pathway to "'+r+'"'),t=this.getLevelsForPathway(r),this.pathwayId=r;}return t.length!==e.length&&this.log("Found "+t.length+"/"+e.length+' levels in Pathway "'+this.pathwayId+'"'),t},r.getLevelsForPathway=function(e){return null===this.levels?[]:this.levels.filter((function(t){return e===t.pathwayId}))},r.updatePathwayPriority=function(e){var t;this._pathwayPriority=e;var r=this.penalizedPathways,i=performance.now();Object.keys(r).forEach((function(e){i-r[e]>3e5&&delete r[e];}));for(var n=0;n<e.length;n++){var a=e[n];if(!(a in r)){if(a===this.pathwayId)return;var s=this.hls.nextLoadLevel,o=this.hls.levels[s];if((t=this.getLevelsForPathway(a)).length>0){this.log('Setting Pathway to "'+a+'"'),this.pathwayId=a,yi(t),this.hls.trigger(b.LEVELS_UPDATED,{levels:t});var l=this.hls.levels[s];o&&l&&this.levels&&(l.attrs["STABLE-VARIANT-ID"]!==o.attrs["STABLE-VARIANT-ID"]&&l.bitrate!==o.bitrate&&this.log("Unstable Pathways change from bitrate "+o.bitrate+" to "+l.bitrate),this.hls.nextLoadLevel=s);break}}}},r.getPathwayForGroupId=function(e,t,r){for(var i=this.getLevelsForPathway(r).concat(this.levels||[]),n=0;n<i.length;n++)if(t===P&&i[n].hasAudioGroup(e)||t===C&&i[n].hasSubtitleGroup(e))return i[n].pathwayId;return r},r.clonePathways=function(e){var t=this,r=this.levels;if(r){var i={},n={};e.forEach((function(e){var a=e.ID,s=e["BASE-ID"],o=e["URI-REPLACEMENT"];if(!r.some((function(e){return e.pathwayId===a}))){var l=t.getLevelsForPathway(s).map((function(e){var t=new yr(e.attrs);t["PATHWAY-ID"]=a;var r=t.AUDIO&&t.AUDIO+"_clone_"+a,s=t.SUBTITLES&&t.SUBTITLES+"_clone_"+a;r&&(i[t.AUDIO]=r,t.AUDIO=r),s&&(n[t.SUBTITLES]=s,t.SUBTITLES=s);var l=Ns(e.uri,t["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",o),u=new st({attrs:t,audioCodec:e.audioCodec,bitrate:e.bitrate,height:e.height,name:e.name,url:l,videoCodec:e.videoCodec,width:e.width});if(e.audioGroups)for(var d=1;d<e.audioGroups.length;d++)u.addGroupId("audio",e.audioGroups[d]+"_clone_"+a);if(e.subtitleGroups)for(var h=1;h<e.subtitleGroups.length;h++)u.addGroupId("text",e.subtitleGroups[h]+"_clone_"+a);return u}));r.push.apply(r,l),Fs(t.audioTracks,i,o,a),Fs(t.subtitleTracks,n,o,a);}}));}},r.loadSteeringManifest=function(e){var t,r=this,i=this.hls.config,n=i.loader;this.loader&&this.loader.destroy(),this.loader=new n(i);try{t=new self.URL(e);}catch(t){return this.enabled=!1,void this.log("Failed to parse Steering Manifest URI: "+e)}if("data:"!==t.protocol){var a=0|(this.hls.bandwidthEstimate||i.abrEwmaDefaultEstimate);t.searchParams.set("_HLS_pathway",this.pathwayId),t.searchParams.set("_HLS_throughput",""+a);}var s={responseType:"json",url:t.href},o=i.steeringManifestLoadPolicy.default,l=o.errorRetry||o.timeoutRetry||{},u={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0},d={onSuccess:function(e,i,n,a){r.log('Loaded steering manifest: "'+t+'"');var s=e.data;if(1===(null==s?void 0:s.VERSION)){r.updated=performance.now(),r.timeToLoad=s.TTL;var o=s["RELOAD-URI"],l=s["PATHWAY-CLONES"],u=s["PATHWAY-PRIORITY"];if(o)try{r.uri=new self.URL(o,t).href;}catch(e){return r.enabled=!1,void r.log("Failed to parse Steering Manifest RELOAD-URI: "+o)}r.scheduleRefresh(r.uri||n.url),l&&r.clonePathways(l);var d={steeringManifest:s,url:t.toString()};r.hls.trigger(b.STEERING_MANIFEST_LOADED,d),u&&r.updatePathwayPriority(u);}else r.log("Steering VERSION "+s.VERSION+" not supported!");},onError:function(e,t,i,n){if(r.log("Error loading steering manifest: "+e.code+" "+e.text+" ("+t.url+")"),r.stopLoad(),410===e.code)return r.enabled=!1,void r.log("Steering manifest "+t.url+" no longer available");var a=1e3*r.timeToLoad;if(429!==e.code)r.scheduleRefresh(r.uri||t.url,a);else {var s=r.loader;if("function"==typeof(null==s?void 0:s.getResponseHeader)){var o=s.getResponseHeader("Retry-After");o&&(a=1e3*parseFloat(o));}r.log("Steering manifest "+t.url+" rate limited");}},onTimeout:function(e,t,i){r.log("Timeout loading steering manifest ("+t.url+")"),r.scheduleRefresh(r.uri||t.url);}};this.log("Requesting steering manifest: "+t),this.loader.load(s,u,d);},r.scheduleRefresh=function(e,t){var r=this;void 0===t&&(t=1e3*this.timeToLoad),this.clearTimeout(),this.reloadTimer=self.setTimeout((function(){var t,i=null==(t=r.hls)?void 0:t.media;!i||i.ended?r.scheduleRefresh(e,1e3*r.timeToLoad):r.loadSteeringManifest(e);}),t);},i(t,[{key:"pathwayPriority",get:function(){return this._pathwayPriority},set:function(e){this.updatePathwayPriority(e);}}])}(N);function Fs(e,t,r,i){e&&Object.keys(t).forEach((function(n){var s=e.filter((function(e){return e.groupId===n})).map((function(e){var s=a({},e);return s.details=void 0,s.attrs=new yr(s.attrs),s.url=s.attrs.URI=Ns(e.url,e.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",r),s.groupId=s.attrs["GROUP-ID"]=t[n],s.attrs["PATHWAY-ID"]=i,s}));e.push.apply(e,s);}));}function Ns(e,t,r,i){var n,a=i.HOST,s=i.PARAMS,o=i[r];t&&(n=null==o?void 0:o[t])&&(e=n);var l=new self.URL(e);return a&&!n&&(l.host=a),s&&Object.keys(s).sort().forEach((function(e){e&&l.searchParams.set(e,s[e]);})),l.href}var Us=function(e){function t(r){var i;return (i=e.call(this,"eme",r.logger)||this).hls=void 0,i.config=void 0,i.media=null,i.mediaResolved=void 0,i.keyFormatPromise=null,i.keySystemAccessPromises={},i._requestLicenseFailureCount=0,i.mediaKeySessions=[],i.keyIdToKeySessionPromise={},i.mediaKeys=null,i.setMediaKeysQueue=t.CDMCleanupPromise?[t.CDMCleanupPromise]:[],i.bannedKeyIds={},i.onMediaEncrypted=function(e){var t=e.initDataType,r=e.initData,n='"'+e.type+'" event: init data type: "'+t+'"';if(i.debug(n),null!==r){if(!i.keyFormatPromise){var a=Object.keys(i.keySystemAccessPromises);a.length||(a=Ur(i.config));var s=a.map(Nr).filter((function(e){return !!e}));i.keyFormatPromise=i.getKeyFormatPromise(s);}i.keyFormatPromise.then((function(a){var s=Fr(a);if("sinf"===t&&s===Cr.FAIRPLAY){var o;try{var l=le(new Uint8Array(r)),u=Ae(kr(JSON.parse(l).sinf));if(!u)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");o=new Uint8Array(u.subarray(8,24));}catch(e){return void i.warn(n+" Failed to parse sinf: "+e)}for(var d,h=X(o),f=i,c=f.keyIdToKeySessionPromise,g=f.mediaKeySessions,v=c[h],m=function(){var e=g[p],n=e.decryptdata;if(!n.keyId)return 0;var a=X(n.keyId);return Ar(o,n.keyId)||-1!==n.uri.replace(/-/g,"").indexOf(h)?(v=c[a])?(n.pssh||(delete c[a],n.pssh=new Uint8Array(r),n.keyId=o,(v=c[h]=v.then((function(){return i.generateRequestWithPreferredKeySession(e,t,r,"encrypted-event-key-match")}))).catch((function(e){return i.handleError(e)}))),1):0:void 0},p=0;p<g.length&&(0===(d=m())||1!==d);p++);v||i.handleError(new Error("Key ID "+h+" not encountered in playlist. Key-system sessions "+g.length+"."));}else i.log('Ignoring "'+e.type+'" event with init data type: "'+t+'" for selected key-system '+s);})).catch((function(e){return i.handleError(e)}));}},i.onWaitingForKey=function(e){i.log('"'+e.type+'" event');},i.hls=r,i.config=r.config,i.registerListeners(),i}o(t,e);var r=t.prototype;return r.destroy=function(){this.onDestroying(),this.onMediaDetached();var e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null;},r.registerListeners=function(){this.hls.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(b.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(b.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(b.DESTROYING,this.onDestroying,this);},r.unregisterListeners=function(){this.hls.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(b.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(b.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(b.DESTROYING,this.onDestroying,this);},r.getLicenseServerUrl=function(e){var t=this.config,r=t.drmSystems,i=t.widevineLicenseUrl,n=null==r?void 0:r[e];return n?n.licenseUrl:e===Cr.WIDEVINE&&i?i:void 0},r.getLicenseServerUrlOrThrow=function(e){var t=this.getLicenseServerUrl(e);if(void 0===t)throw new Error('no license server URL configured for key-system "'+e+'"');return t},r.getServerCertificateUrl=function(e){var t=this.config.drmSystems,r=null==t?void 0:t[e];if(r)return r.serverCertificateUrl;this.log('No Server Certificate in config.drmSystems["'+e+'"]');},r.attemptKeySystemAccess=function(e){var t=this,r=this.hls.levels,i=function(e,t,r){return !!e&&r.indexOf(e)===t},n=r.map((function(e){return e.audioCodec})).filter(i),a=r.map((function(e){return e.videoCodec})).filter(i);return n.length+a.length===0&&a.push("avc1.42e01e"),new Promise((function(r,i){var s=function(e){var o=e.shift();t.getMediaKeysPromise(o,n,a).then((function(e){return r({keySystem:o,mediaKeys:e})})).catch((function(t){e.length?s(e):i(t instanceof Ks?t:new Ks({type:R.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message));}));};s(e);}))},r.requestMediaKeySystemAccess=function(e,t){var r=this.config.requestMediaKeySystemAccessFunc;if("function"!=typeof r){var i="Configured requestMediaKeySystemAccess is not a function "+r;return null===Gr&&"http:"===self.location.protocol&&(i="navigator.requestMediaKeySystemAccess is not available over insecure protocol "+location.protocol),Promise.reject(new Error(i))}return r(e,t)},r.getMediaKeysPromise=function(e,t,r){var i,n=this,a=function(e,t,r,i){var n;switch(e){case Cr.FAIRPLAY:n=["cenc","sinf"];break;case Cr.WIDEVINE:case Cr.PLAYREADY:n=["cenc"];break;case Cr.CLEARKEY:n=["cenc","keyids"];break;default:throw new Error("Unknown key-system: "+e)}return function(e,t,r,i){return [{initDataTypes:e,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:t.map((function(e){return {contentType:"audio/mp4; codecs="+e,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null}})),videoCapabilities:r.map((function(e){return {contentType:"video/mp4; codecs="+e,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}}))}]}(n,t,r,i)}(e,t,r,this.config.drmSystemOptions||{}),s=this.keySystemAccessPromises[e],o=null==(i=s)?void 0:i.keySystemAccess;if(!o){this.log('Requesting encrypted media "'+e+'" key-system access with config: '+ut(a)),o=this.requestMediaKeySystemAccess(e,a);var l=s=this.keySystemAccessPromises[e]={keySystemAccess:o};return o.catch((function(t){n.log('Failed to obtain access to key-system "'+e+'": '+t);})),o.then((function(t){n.log('Access for key-system "'+t.keySystem+'" obtained');var r=n.fetchServerCertificate(e);n.log('Create media-keys for "'+e+'"');var i=l.mediaKeys=t.createMediaKeys().then((function(t){return n.log('Media-keys created for "'+e+'"'),l.hasMediaKeys=!0,r.then((function(r){return r?n.setMediaKeysServerCertificate(t,e,r):t}))}));return i.catch((function(t){n.error('Failed to create media-keys for "'+e+'"}: '+t);})),i}))}return o.then((function(){return s.mediaKeys}))},r.createMediaKeySessionContext=function(e){var t=e.decryptdata,r=e.keySystem,i=e.mediaKeys;this.log('Creating key-system session "'+r+'" keyId: '+X(t.keyId||[])+" keyUri: "+t.uri);var n=i.createSession(),a={decryptdata:t,keySystem:r,mediaKeys:i,mediaKeysSession:n,keyStatus:"status-pending"};return this.mediaKeySessions.push(a),a},r.renewKeySession=function(e){var t=e.decryptdata;if(t.pssh){var r=this.createMediaKeySessionContext(e),i=Bs(t);this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(r,"cenc",t.pssh.buffer,"expired");}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e);},r.updateKeySession=function(e,t){var r=e.mediaKeysSession;return this.log('Updating key-session "'+r.sessionId+'" for keyId '+X(e.decryptdata.keyId||[])+"\n      } (data length: "+t.byteLength+")"),r.update(t)},r.getSelectedKeySystemFormats=function(){var e=this;return Object.keys(this.keySystemAccessPromises).map((function(t){return {keySystem:t,hasMediaKeys:e.keySystemAccessPromises[t].hasMediaKeys}})).filter((function(e){return !!e.hasMediaKeys})).map((function(e){return Nr(e.keySystem)})).filter((function(e){return !!e}))},r.getKeySystemAccess=function(e){var t=this;return this.getKeySystemSelectionPromise(e).then((function(e){var r=e.keySystem,i=e.mediaKeys;return t.attemptSetMediaKeys(r,i)}))},r.selectKeySystem=function(e){var t=this;return new Promise((function(r,i){t.getKeySystemSelectionPromise(e).then((function(e){var t=e.keySystem,n=Nr(t);n?r(n):i(new Error('Unable to find format for key-system "'+t+'"'));})).catch(i);}))},r.selectKeySystemFormat=function(e){var t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log("Selecting key-system from fragment (sn: "+e.sn+" "+e.type+": "+e.level+") key formats "+t.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise},r.getKeyFormatPromise=function(e){var t=Ur(this.config),r=e.map(Fr).filter((function(e){return !!e&&-1!==t.indexOf(e)}));return this.selectKeySystem(r)},r.getKeyStatus=function(e){for(var t=this.mediaKeySessions,r=0;r<t.length;r++){var i=Gs(e,t[r]);if(i)return i}},r.loadKey=function(e){var t=this,r=e.keyInfo.decryptdata,i=Bs(r),n=this.bannedKeyIds[i];if(n||"internal-error"===this.getKeyStatus(r)){var a=Vs(n||"internal-error",r);return this.handleError(a,e.frag),Promise.reject(a)}var s="(keyId: "+i+' format: "'+r.keyFormat+'" method: '+r.method+" uri: "+r.uri+")";this.log("Starting session for key "+s);var o=this.keyIdToKeySessionPromise[i];if(!o){var l=this.getKeySystemForKeyPromise(r).then((function(i){var n=i.keySystem,a=i.mediaKeys;return t.throwIfDestroyed(),t.log("Handle encrypted media sn: "+e.frag.sn+" "+e.frag.type+": "+e.frag.level+" using key "+s),t.attemptSetMediaKeys(n,a).then((function(){return t.throwIfDestroyed(),t.createMediaKeySessionContext({keySystem:n,mediaKeys:a,decryptdata:r})}))})).then((function(e){var i=r.pssh?r.pssh.buffer:null;return t.generateRequestWithPreferredKeySession(e,"cenc",i,"playlist-key")}));return l.catch((function(r){return t.handleError(r,e.frag)})),this.keyIdToKeySessionPromise[i]=l,l}return o.catch((function(i){if(i instanceof Ks){var n=d({},i.data);"internal-error"===t.getKeyStatus(r)&&(n.decryptdata=r);var a=new Ks(n,i.message);t.handleError(a,e.frag);}})),o},r.throwIfDestroyed=function(e){if(!this.hls)throw new Error("invalid state")},r.handleError=function(e,t){if(this.hls)if(e instanceof Ks){t&&(e.data.frag=t);var r=e.data.decryptdata;this.error(e.message+(r?" ("+X(r.keyId||[])+")":"")),this.hls.trigger(b.ERROR,e.data);}else this.error(e.message),this.hls.trigger(b.ERROR,{type:R.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0});},r.getKeySystemForKeyPromise=function(e){var t=Bs(e),r=this.keyIdToKeySessionPromise[t];if(!r){var i=Fr(e.keyFormat),n=i?[i]:Ur(this.config);return this.attemptKeySystemAccess(n)}return r},r.getKeySystemSelectionPromise=function(e){if(e.length||(e=Ur(this.config)),0===e.length)throw new Ks({type:R.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options "+ut({drmSystems:this.config.drmSystems}));return this.attemptKeySystemAccess(e)},r.attemptSetMediaKeys=function(e,t){var r=this;if(this.mediaResolved=void 0,this.mediaKeys===t)return Promise.resolve();var i=this.setMediaKeysQueue.slice();this.log('Setting media-keys for "'+e+'"');var n=Promise.all(i).then((function(){return r.media?r.media.setMediaKeys(t):new Promise((function(e,i){r.mediaResolved=function(){if(r.mediaResolved=void 0,!r.media)return i(new Error("Attempted to set mediaKeys without media element attached"));r.mediaKeys=t,r.media.setMediaKeys(t).then(e).catch(i);};}))}));return this.mediaKeys=t,this.setMediaKeysQueue.push(n),n.then((function(){r.log('Media-keys set for "'+e+'"'),i.push(n),r.setMediaKeysQueue=r.setMediaKeysQueue.filter((function(e){return -1===i.indexOf(e)}));}))},r.generateRequestWithPreferredKeySession=function(e,t,r,i){var n,a=this,s=null==(n=this.config.drmSystems)||null==(n=n[e.keySystem])?void 0:n.generateRequest;if(s)try{var o=s.call(this.hls,t,r,e);if(!o)throw new Error("Invalid response from configured generateRequest filter");t=o.initDataType,r=o.initData?o.initData:null,e.decryptdata.pssh=r?new Uint8Array(r):null;}catch(e){if(this.warn(e.message),this.hls&&this.hls.config.debug)throw e}if(null===r)return this.log('Skipping key-session request for "'+i+'" (no initData)'),Promise.resolve(e);var l=Bs(e.decryptdata),u=e.decryptdata.uri;this.log('Generating key-session request for "'+i+'" keyId: '+l+" URI: "+u+" (init data type: "+t+" length: "+r.byteLength+")");var d=new E,h=e._onmessage=function(t){var r=e.mediaKeysSession;if(r){var i=t.messageType,n=t.message;a.log('"'+i+'" message event for session "'+r.sessionId+'" message size: '+n.byteLength),"license-request"===i||"license-renewal"===i?a.renewLicense(e,n).catch((function(e){d.eventNames().length?d.emit("error",e):a.handleError(e);})):"license-release"===i?e.keySystem===Cr.FAIRPLAY&&a.updateKeySession(e,br("acknowledged")).then((function(){return a.removeSession(e)})).catch((function(e){return a.handleError(e)})):a.warn('unhandled media key message type "'+i+'"');}else d.emit("error",new Error("invalid state"));},f=function(e,t){var r;t.keyStatus=e,e.startsWith("usable")?d.emit("resolved"):"internal-error"===e||"output-restricted"===e||"output-downscaled"===e?r=Vs(e,t.decryptdata):"expired"===e?r=new Error("key expired (keyId: "+l+")"):"released"===e?r=new Error("key released"):"status-pending"===e||a.warn('unhandled key status change "'+e+'" (keyId: '+l+")"),r&&(d.eventNames().length?d.emit("error",r):a.handleError(r));},c=e._onkeystatuseschange=function(t){if(e.mediaKeysSession){var r=a.getKeyStatuses(e);if(Object.keys(r).some((function(e){return "status-pending"!==r[e]}))){if("expired"===r[l])return a.log("Expired key "+ut(r)+' in key-session "'+e.mediaKeysSession.sessionId+'"'),void a.renewKeySession(e);var i,n=r[l];if(n)f(n,e);else e.keyStatusTimeouts||(e.keyStatusTimeouts={}),(i=e.keyStatusTimeouts)[l]||(i[l]=self.setTimeout((function(){if(e.mediaKeysSession&&a.mediaKeys){var t=a.getKeyStatus(e.decryptdata);if(t&&"status-pending"!==t)return a.log("No status for keyId "+l+' in key-session "'+e.mediaKeysSession.sessionId+'". Using session key-status '+t+" from other session."),f(t,e);a.log("key status for "+l+' in key-session "'+e.mediaKeysSession.sessionId+'" timed out after 1000ms'),f(n="internal-error",e);}}),1e3)),a.log("No status for keyId "+l+" ("+ut(r)+").");}}else d.emit("error",new Error("invalid state"));};ki(e.mediaKeysSession,"message",h),ki(e.mediaKeysSession,"keystatuseschange",c);var g=new Promise((function(e,t){d.on("error",t),d.on("resolved",e);}));return e.mediaKeysSession.generateRequest(t,r).then((function(){a.log('Request generated for key-session "'+e.mediaKeysSession.sessionId+'" keyId: '+l+" URI: "+u);})).catch((function(t){throw new Ks({type:R.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_NO_SESSION,error:t,decryptdata:e.decryptdata,fatal:!1},"Error generating key-session request: "+t)})).then((function(){return g})).catch((function(t){return d.removeAllListeners(),a.removeSession(e).then((function(){throw t}))})).then((function(){return d.removeAllListeners(),e}))},r.getKeyStatuses=function(e){var t=this,r={};return e.mediaKeysSession.keyStatuses.forEach((function(i,n){if("string"==typeof n&&"object"==typeof i){var a=n;n=i,i=a;}var s="buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n);e.keySystem===Cr.PLAYREADY&&16===s.length&&Dr(s);var o=X(s);"internal-error"===i&&(t.bannedKeyIds[o]=i),t.log('key status change "'+i+'" for keyStatuses keyId: '+o+' key-session "'+e.mediaKeysSession.sessionId+'"'),r[o]=i;})),r},r.fetchServerCertificate=function(e){var t=this.config,r=new(t.loader)(t),i=this.getServerCertificateUrl(e);return i?(this.log('Fetching server certificate for "'+e+'"'),new Promise((function(n,a){var s={responseType:"arraybuffer",url:i},o=t.certLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},u={onSuccess:function(e,t,r,i){n(e.data);},onError:function(t,r,n,o){a(new Ks({type:R.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:n,response:d({url:s.url,data:void 0},t)},'"'+e+'" certificate request failed ('+i+"). Status: "+t.code+" ("+t.text+")"));},onTimeout:function(t,r,n){a(new Ks({type:R.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:n,response:{url:s.url,data:void 0}},'"'+e+'" certificate request timed out ('+i+")"));},onAbort:function(e,t,r){a(new Error("aborted"));}};r.load(s,l,u);}))):Promise.resolve()},r.setMediaKeysServerCertificate=function(e,t,r){var i=this;return new Promise((function(n,a){e.setServerCertificate(r).then((function(a){i.log("setServerCertificate "+(a?"success":"not supported by CDM")+" ("+r.byteLength+') on "'+t+'"'),n(e);})).catch((function(e){a(new Ks({type:R.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message));}));}))},r.renewLicense=function(e,t){var r=this;return this.requestLicense(e,new Uint8Array(t)).then((function(t){return r.updateKeySession(e,new Uint8Array(t)).catch((function(t){throw new Ks({type:R.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:t,fatal:!1},t.message)}))}))},r.unpackPlayReadyKeyMessage=function(e,t){var r=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!r.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;var i=(new DOMParser).parseFromString(r,"application/xml"),n=i.querySelectorAll("HttpHeader");if(n.length>0)for(var a,s=0,o=n.length;s<o;s++){var l,u,d=null==(l=(a=n[s]).querySelector("name"))?void 0:l.textContent,h=null==(u=a.querySelector("value"))?void 0:u.textContent;d&&h&&e.setRequestHeader(d,h);}var f=i.querySelector("Challenge"),c=null==f?void 0:f.textContent;if(!c)throw new Error("Cannot find <Challenge> in key message");return br(atob(c))},r.setupLicenseXHR=function(e,t,r,i){var n=this,a=this.config.licenseXhrSetup;return a?Promise.resolve().then((function(){if(!r.decryptdata)throw new Error("Key removed");return a.call(n.hls,e,t,r,i)})).catch((function(s){if(!r.decryptdata)throw s;return e.open("POST",t,!0),a.call(n.hls,e,t,r,i)})).then((function(r){return e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:r||i}})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))},r.requestLicense=function(e,t){var r=this,i=this.config.keyLoadPolicy.default;return new Promise((function(n,a){var s=r.getLicenseServerUrlOrThrow(e.keySystem);r.log("Sending license request to URL: "+s);var o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=function(){if(!r.hls||!e.mediaKeysSession)return a(new Error("invalid state"));if(4===o.readyState)if(200===o.status){r._requestLicenseFailureCount=0;var l=o.response;r.log("License received "+(l instanceof ArrayBuffer?l.byteLength:l));var u=r.config.licenseResponseCallback;if(u)try{l=u.call(r.hls,o,s,e);}catch(e){r.error(e);}n(l);}else {var d=i.errorRetry,h=d?d.maxNumRetry:0;if(r._requestLicenseFailureCount++,r._requestLicenseFailureCount>h||o.status>=400&&o.status<500)a(new Ks({type:R.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:o,response:{url:s,data:void 0,code:o.status,text:o.statusText}},"License Request XHR failed ("+s+"). Status: "+o.status+" ("+o.statusText+")"));else {var f=h-r._requestLicenseFailureCount+1;r.warn("Retrying license request, "+f+" attempts left"),r.requestLicense(e,t).then(n,a);}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=o,r.setupLicenseXHR(o,s,e,t).then((function(t){var i=t.xhr,n=t.licenseChallenge;e.keySystem==Cr.PLAYREADY&&(n=r.unpackPlayReadyKeyMessage(i,n)),i.send(n);})).catch(a);}))},r.onDestroying=function(){this.unregisterListeners(),this._clear();},r.onMediaAttached=function(e,t){if(this.config.emeEnabled){var r=t.media;this.media=r,ki(r,"encrypted",this.onMediaEncrypted),ki(r,"waitingforkey",this.onWaitingForKey);var i=this.mediaResolved;i?i():this.mediaKeys=r.mediaKeys;}},r.onMediaDetached=function(){var e=this.media;e&&(bi(e,"encrypted",this.onMediaEncrypted),bi(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null);},r._clear=function(){var e,r=this;this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={};var i=this.mediaResolved;if(i&&i(),this.mediaKeys||this.mediaKeySessions.length){var n=this.media,a=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,Hr.clearKeyUriToKeyIdMap();var s=a.length;t.CDMCleanupPromise=Promise.all(a.map((function(e){return r.removeSession(e)})).concat((null==n||null==(e=n.setMediaKeys(null))?void 0:e.catch((function(e){r.log("Could not clear media keys: "+e),r.hls&&r.hls.trigger(b.ERROR,{type:R.OTHER_ERROR,details:k.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error("Could not clear media keys: "+e)});})))||Promise.resolve())).catch((function(e){r.log("Could not close sessions and clear media keys: "+e),r.hls&&r.hls.trigger(b.ERROR,{type:R.OTHER_ERROR,details:k.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error("Could not close sessions and clear media keys: "+e)});})).then((function(){s&&r.log("finished closing key sessions and clearing media keys");}));}},r.onManifestLoading=function(){this._clear();},r.onManifestLoaded=function(e,t){var r=t.sessionKeys;if(r&&this.config.emeEnabled&&!this.keyFormatPromise){var i=r.reduce((function(e,t){return -1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e}),[]);this.log("Selecting key-system from session-keys "+i.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(i);}},r.removeSession=function(e){var t=this,r=e.mediaKeysSession,i=e.licenseXhr,n=e.decryptdata;if(r){this.log('Remove licenses and keys and close session "'+r.sessionId+'" keyId: '+X((null==n?void 0:n.keyId)||[])),e._onmessage&&(r.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(r.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),i&&i.readyState!==XMLHttpRequest.DONE&&i.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;var a=this.mediaKeySessions.indexOf(e);a>-1&&this.mediaKeySessions.splice(a,1);var s=e.keyStatusTimeouts;s&&Object.keys(s).forEach((function(e){return self.clearTimeout(s[e])}));var o=function(e){var t;return !(!e||"persistent-license"!==e.sessionType&&(null==(t=e.sessionTypes)||!t.some((function(e){return "persistent-license"===e}))))}(this.config.drmSystemOptions)?new Promise((function(e,t){self.setTimeout((function(){return t(new Error("MediaKeySession.remove() timeout"))}),8e3),r.remove().then(e).catch(t);})):Promise.resolve();return o.catch((function(e){t.log("Could not remove session: "+e),t.hls&&t.hls.trigger(b.ERROR,{type:R.OTHER_ERROR,details:k.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error("Could not remove session: "+e)});})).then((function(){return r.close()})).catch((function(e){t.log("Could not close session: "+e),t.hls&&t.hls.trigger(b.ERROR,{type:R.OTHER_ERROR,details:k.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error("Could not close session: "+e)});}))}return Promise.resolve()},t}(N);function Bs(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw new Error("keyId is null");return X(e.keyId)}function Gs(e,t){return e.keyId&&t.mediaKeysSession.keyStatuses.has(e.keyId)?t.mediaKeysSession.keyStatuses.get(e.keyId):e.matches(t.decryptdata)?t.keyStatus:void 0}Us.CDMCleanupPromise=void 0;var Ks=function(e){function t(t,r){var i;return (i=e.call(this,r)||this).data=void 0,t.error||(t.error=new Error(r)),i.data=t,t.err=t.error,i}return o(t,e),t}(c(Error));function Vs(e,t){var r="output-restricted"===e,i=r?k.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:k.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new Ks({type:R.KEY_SYSTEM_ERROR,details:i,fatal:!1,decryptdata:t},r?"HDCP level output restricted":'key status changed to "'+e+'"')}var Hs=function(){function e(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners();}var t=e.prototype;return t.setStreamController=function(e){this.streamController=e;},t.registerListeners=function(){this.hls.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(b.MEDIA_DETACHING,this.onMediaDetaching,this);},t.unregisterListeners=function(){this.hls.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(b.MEDIA_DETACHING,this.onMediaDetaching,this);},t.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null;},t.onMediaAttaching=function(e,t){var r=this.hls.config;if(r.capLevelOnFPSDrop){var i=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=i,i&&"function"==typeof i.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod);}},t.onMediaDetaching=function(){this.media=null;},t.checkFPS=function(e,t,r){var i=performance.now();if(t){if(this.lastTime){var n=i-this.lastTime,a=r-this.lastDroppedFrames,s=t-this.lastDecodedFrames,o=1e3*a/n,l=this.hls;if(l.trigger(b.FPS_DROP,{currentDropped:a,currentDecoded:s,totalDroppedFrames:r}),o>0&&a>l.config.fpsDroppedMonitoringThreshold*s){var u=l.currentLevel;l.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(-1===l.autoLevelCapping||l.autoLevelCapping>=u)&&(u-=1,l.trigger(b.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:l.currentLevel}),l.autoLevelCapping=u,this.streamController.nextLevelSwitch());}}this.lastTime=i,this.lastDroppedFrames=r,this.lastDecodedFrames=t;}},t.checkFPSInterval=function(){var e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames);}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount);},e}();function Ys(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return (t>>>0).toString()}var Ws=.025,js=function(e){return e[e.Point=0]="Point",e[e.Range=1]="Range",e}({});function qs(e,t,r){return e.identifier+"-"+(r+1)+"-"+Ys(t)}var Xs=function(){function e(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e);}var t=e.prototype;return t.setDateRange=function(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions);},t.reset=function(){var e;this.appendInPlaceStarted=!1,null==(e=this.assetListLoader)||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null);},t.isAssetPastPlayoutLimit=function(e){var t;if(e>0&&e>=this.assetList.length)return !0;var r=this.playoutLimit;return !(e<=0||isNaN(r))&&(0===r||((null==(t=this.assetList[e])?void 0:t.startOffset)||0)>r)},t.findAssetIndex=function(e){return this.assetList.indexOf(e)},t.toString=function(){return '["'+(e=this).identifier+'" '+(e.cue.pre?"<pre>":e.cue.post?"<post>":"")+e.timelineStart.toFixed(2)+"-"+e.resumeTime.toFixed(2)+"]";var e;},i(e,[{key:"identifier",get:function(){return this.dateRange.id}},{key:"startDate",get:function(){return this.dateRange.startDate}},{key:"startTime",get:function(){var e=this.dateRange.startTime;if(this.snapOptions.out){var t=this.dateRange.tagAnchor;if(t)return Qs(e,t)}return e}},{key:"startOffset",get:function(){return this.cue.pre?0:this.startTime}},{key:"startIsAligned",get:function(){if(0===this.startTime||this.snapOptions.out)return !0;var e=this.dateRange.tagAnchor;if(e){var t=this.dateRange.startTime;return t-Qs(t,e)<.1}return !1}},{key:"resumptionOffset",get:function(){var e=this.resumeOffset,t=A(e)?e:this.duration;return this.cumulativeDuration+t}},{key:"resumeTime",get:function(){var e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){var t=this.resumeAnchor;if(t)return Qs(e,t)}return e}},{key:"appendInPlace",get:function(){return !!this.appendInPlaceStarted||!this.appendInPlaceDisabled&&!(this.cue.once||this.cue.pre||!this.startIsAligned||!(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Ws))},set:function(e){this.appendInPlaceStarted?this.resetOnResume=!e:this.appendInPlaceDisabled=!e;}},{key:"timelineStart",get:function(){return null!==this._timelineStart?this._timelineStart:this.startTime},set:function(e){this._timelineStart=e;}},{key:"duration",get:function(){var e,t=this.playoutLimit;return e=null!==this._duration?this._duration:this.dateRange.duration?this.dateRange.duration:this.dateRange.plannedDuration||0,!isNaN(t)&&t<e&&(e=t),e},set:function(e){this._duration=e;}},{key:"cue",get:function(){return this.dateRange.cue}},{key:"timelineOccupancy",get:function(){return "RANGE"===this.dateRange.attr["X-TIMELINE-OCCUPIES"]?js.Range:js.Point}},{key:"supplementsPrimary",get:function(){return "PRIMARY"===this.dateRange.attr["X-TIMELINE-STYLE"]}},{key:"contentMayVary",get:function(){return "NO"!==this.dateRange.attr["X-CONTENT-MAY-VARY"]}},{key:"assetUrl",get:function(){return this.dateRange.attr["X-ASSET-URI"]}},{key:"assetListUrl",get:function(){return this.dateRange.attr["X-ASSET-LIST"]}},{key:"baseUrl",get:function(){return this.base.url}},{key:"assetListLoaded",get:function(){return this.assetList.length>0||null!==this.assetListResponse}}])}();function Qs(e,t){return e-t.start<t.duration/2&&!(Math.abs(e-(t.start+t.duration))<Ws)?t.start:t.start+t.duration}function zs(e,t,r){var i=new self.URL(e,r);return "data:"!==i.protocol&&i.searchParams.set("_HLS_primary_id",t),i}function $s(e,t){for(;null!=(r=e.assetList[++t])&&r.error;)var r;return t}function Zs(e){var t=e.timelineStart,r=e.duration||0;return '["'+e.identifier+'" '+t.toFixed(2)+"-"+(t+r).toFixed(2)+"]"}var Js=function(){function e(e,t,r,i){var n=this;this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=function(){n.reachedPlayout(n.currentTime)&&n.hls&&n.hls.trigger(b.PLAYOUT_LIMIT_REACHED,{});};var a=this.hls=new e(t);this.interstitial=r,this.assetItem=i;var s=function(){n.hasDetails=!0;};a.once(b.LEVEL_LOADED,s),a.once(b.AUDIO_TRACK_LOADED,s),a.once(b.SUBTITLE_TRACK_LOADED,s),a.on(b.MEDIA_ATTACHING,(function(e,t){var r=t.media;n.removeMediaListeners(),n.mediaAttached=r,n.interstitial.playoutLimit&&(r.addEventListener("timeupdate",n.checkPlayout),n.appendInPlace&&a.on(b.BUFFER_APPENDED,(function(){var e=n.bufferedEnd;n.reachedPlayout(e)&&(n._bufferedEosTime=e,a.trigger(b.BUFFERED_TO_END,void 0));})));}));}var t=e.prototype;return t.loadSource=function(){var e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else {var t=this.assetItem.uri;try{t=zs(t,e.config.primarySessionId||"").href;}catch(e){}e.loadSource(t);}},t.bufferedInPlaceToEnd=function(e){var t;if(!this.appendInPlace)return !1;if(null!=(t=this.hls)&&t.bufferedToEnd)return !0;if(!e)return !1;var r=Math.min(this._bufferedEosTime||1/0,this.duration),i=this.timelineOffset,n=dr.bufferInfo(e,i,0);return this.getAssetTime(n.end)>=r-.02},t.reachedPlayout=function(e){var t=this.interstitial.playoutLimit;return this.startOffset+e>=t},t.getAssetTime=function(e){var t=this.timelineOffset,r=this.duration;return Math.min(Math.max(0,e-t),r)},t.removeMediaListeners=function(){var e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout));},t.bufferSnapShot=function(){var e;this.mediaAttached&&null!=(e=this.hls)&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd);},t.destroy=function(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null;},t.attachMedia=function(e){var t;this.loadSource(),null==(t=this.hls)||t.attachMedia(e);},t.detachMedia=function(){var e;this.removeMediaListeners(),this.mediaAttached=null,null==(e=this.hls)||e.detachMedia();},t.resumeBuffering=function(){var e;null==(e=this.hls)||e.resumeBuffering();},t.pauseBuffering=function(){var e;null==(e=this.hls)||e.pauseBuffering();},t.transferMedia=function(){var e;return this.bufferSnapShot(),(null==(e=this.hls)?void 0:e.transferMedia())||null},t.resetDetails=function(){var e=this.hls;if(e&&this.hasDetails){e.stopLoad();var t=function(e){return delete e.details};e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1;}},t.on=function(e,t,r){var i;null==(i=this.hls)||i.on(e,t);},t.once=function(e,t,r){var i;null==(i=this.hls)||i.once(e,t);},t.off=function(e,t,r){var i;null==(i=this.hls)||i.off(e,t);},t.toString=function(){var e;return "HlsAssetPlayer: "+Zs(this.assetItem)+" "+(null==(e=this.hls)?void 0:e.sessionId)+" "+(this.appendInPlace?"append-in-place":"")},i(e,[{key:"appendInPlace",get:function(){return this.interstitial.appendInPlace}},{key:"destroyed",get:function(){var e;return !(null!=(e=this.hls)&&e.userConfig)}},{key:"assetId",get:function(){return this.assetItem.identifier}},{key:"interstitialId",get:function(){return this.assetItem.parentIdentifier}},{key:"media",get:function(){var e;return (null==(e=this.hls)?void 0:e.media)||null}},{key:"bufferedEnd",get:function(){var e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;var t=dr.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}},{key:"currentTime",get:function(){var e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}},{key:"duration",get:function(){var e=this.assetItem.duration;if(!e)return 0;var t=this.interstitial.playoutLimit;if(t){var r=t-this.startOffset;if(r>0&&r<e)return r}return e}},{key:"remaining",get:function(){var e=this.duration;return e?Math.max(0,e-this.currentTime):0}},{key:"startOffset",get:function(){return this.assetItem.startOffset}},{key:"timelineOffset",get:function(){var e;return (null==(e=this.hls)?void 0:e.config.timelineOffset)||0},set:function(e){var t=this.timelineOffset;if(e!==t){var r=e-t;if(Math.abs(r)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e;}}}}])}(),eo=function(e){function t(t,r){var i;return (i=e.call(this,"interstitials-sched",r)||this).onScheduleUpdate=void 0,i.eventMap={},i.events=null,i.items=null,i.durations={primary:0,playout:0,integrated:0},i.onScheduleUpdate=t,i}o(t,e);var r=t.prototype;return r.destroy=function(){this.reset(),this.onScheduleUpdate=null;},r.reset=function(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach((function(e){return e.reset()})),this.events=this.items=null;},r.resetErrorsInRange=function(e,t){return this.events?this.events.reduce((function(r,i){return e<=i.startOffset&&t>i.startOffset?(delete i.error,r+1):r}),0):0},r.getEvent=function(e){return e&&this.eventMap[e]||null},r.hasEvent=function(e){return e in this.eventMap},r.findItemIndex=function(e,t){if(e.event)return this.findEventIndex(e.event.identifier);var r=-1;e.nextEvent?r=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(r=this.findEventIndex(e.previousEvent.identifier)+1);var i=this.items;if(i)for(i[r]||(void 0===t&&(t=e.start),r=this.findItemIndexAtTime(t));r>=0&&null!=(n=i[r])&&n.event;){var n;r--;}return r},r.findItemIndexAtTime=function(e,t){var r=this.items;if(r)for(var i=0;i<r.length;i++){var n=r[i];if(t&&"primary"!==t&&(n=n[t]),e===n.start||e>n.start&&e<n.end)return i}return -1},r.findJumpRestrictedIndex=function(e,t){var r=this.items;if(r)for(var i=e;i<=t&&r[i];i++){var n=r[i].event;if(null!=n&&n.restrictions.jump&&!n.appendInPlace)return i}return -1},r.findEventIndex=function(e){var t=this.items;if(t)for(var r=t.length;r--;){var i;if((null==(i=t[r].event)?void 0:i.identifier)===e)return r}return -1},r.findAssetIndex=function(e,t){var r=e.assetList,i=r.length;if(i>1)for(var n=0;n<i;n++){var a=r[n];if(!a.error){var s=a.timelineStart;if(t===s||t>s&&(t<s+(a.duration||0)||n===i-1))return n}}return 0},r.parseInterstitialDateRanges=function(e,t){var r=this,i=e.main.details,n=i.dateRanges,a=this.events,s=this.parseDateRanges(n,{url:i.url},t),o=Object.keys(n),l=a?a.filter((function(e){return !o.includes(e.identifier)})):[];s.length&&s.sort((function(e,t){var r=e.cue.pre,i=e.cue.post,n=t.cue.pre,a=t.cue.post;if(r&&!n)return -1;if(n&&!r)return 1;if(i&&!a)return 1;if(a&&!i)return -1;if(!(r||n||i||a)){var s=e.startTime,o=t.startTime;if(s!==o)return s-o}return e.dateRange.tagOrder-t.dateRange.tagOrder})),this.events=s,l.forEach((function(e){r.removeEvent(e);})),this.updateSchedule(e,l);},r.updateSchedule=function(e,t,r){void 0===t&&(t=[]),void 0===r&&(r=!1);var i=this.events||[];if(i.length||t.length||this.length<2){var n=this.items,a=this.parseSchedule(i,e);(r||t.length||(null==n?void 0:n.length)!==a.length||a.some((function(e,t){return Math.abs(e.playout.start-n[t].playout.start)>.005||Math.abs(e.playout.end-n[t].playout.end)>.005})))&&(this.items=a,this.onScheduleUpdate(t,n));}},r.parseDateRanges=function(e,t,r){for(var i=[],n=Object.keys(e),a=0;a<n.length;a++){var s=n[a],o=e[s];if(o.isInterstitial){var l=this.eventMap[s];l?l.setDateRange(o):(l=new Xs(o,t),this.eventMap[s]=l,!1===r&&(l.appendInPlace=r)),i.push(l);}}return i},r.parseSchedule=function(e,t){var r=[],i=t.main.details,n=i.live?1/0:i.edge,a=0;if((e=e.filter((function(e){return !(e.error||e.cue.once&&e.hasPlayed)}))).length){this.resolveOffsets(e,t);var s=0,o=0;if(e.forEach((function(t,i){var l=t.cue.pre,u=t.cue.post,d=e[i-1]||null,h=t.appendInPlace,f=u?n:t.startOffset,c=t.duration,g=t.timelineOccupancy===js.Range?c:0,v=t.resumptionOffset,m=(null==d?void 0:d.startTime)===f,p=f+t.cumulativeDuration,y=h?p+c:f+v;if(l||!u&&f<=0){var E=o;o+=g,t.timelineStart=p;var T=a;a+=c,r.push({event:t,start:p,end:y,playout:{start:T,end:a},integrated:{start:E,end:o}});}else {if(!(f<=n))return;if(!m){var S=f-s;if(S>.033){var A=s,L=o;o+=S;var I=a;a+=S;var R={previousEvent:e[i-1]||null,nextEvent:t,start:A,end:A+S,playout:{start:I,end:a},integrated:{start:L,end:o}};r.push(R);}else S>0&&d&&(d.cumulativeDuration+=S,r[r.length-1].end=f);}u&&(y=p),t.timelineStart=p;var k=o;o+=g;var b=a;a+=c,r.push({event:t,start:p,end:y,playout:{start:b,end:a},integrated:{start:k,end:o}});}var D=t.resumeTime;s=u||D>n?n:D;})),s<n){var l,u=s,d=o,h=n-s;o+=h;var f=a;a+=h,r.push({previousEvent:(null==(l=r[r.length-1])?void 0:l.event)||null,nextEvent:null,start:s,end:u+h,playout:{start:f,end:a},integrated:{start:d,end:o}});}this.setDurations(n,a,o);}else r.push({previousEvent:null,nextEvent:null,start:0,end:n,playout:{start:0,end:n},integrated:{start:0,end:n}}),this.setDurations(n,n,n);return r},r.setDurations=function(e,t,r){this.durations={primary:e,playout:t,integrated:r};},r.resolveOffsets=function(e,t){var r=this,i=t.main.details,n=i.live?1/0:i.edge,a=0,s=-1;e.forEach((function(o,l){var u=o.cue.pre,d=o.cue.post,h=u?0:d?n:o.startTime;r.updateAssetDurations(o),s===h?o.cumulativeDuration=a:(a=0,s=h),!d&&o.snapOptions.in&&(o.resumeAnchor=Tt(null,i.fragments,o.startOffset+o.resumptionOffset,0,0)||void 0),o.appendInPlace&&!o.appendInPlaceStarted&&(r.primaryCanResumeInPlaceAt(o,t)||(o.appendInPlace=!1)),!o.appendInPlace&&l+1<e.length&&e[l+1].startTime-e[l].resumeTime<.033&&(e[l+1].appendInPlace=!1,e[l+1].appendInPlace&&r.warn("Could not change append strategy for abutting event "+o));var f=A(o.resumeOffset)?o.resumeOffset:o.duration;a+=f;}));},r.primaryCanResumeInPlaceAt=function(e,t){var r=this,i=e.resumeTime,n=e.startTime+e.resumptionOffset;return Math.abs(i-n)>Ws?(this.log('"'+e.identifier+'" resumption '+i+" not aligned with estimated timeline end "+n),!1):!Object.keys(t).some((function(n){var a=t[n].details,s=a.edge;if(i>=s)return r.log('"'+e.identifier+'" resumption '+i+" past "+n+" playlist end "+s),!1;var o=Tt(null,a.fragments,i);if(!o)return r.log('"'+e.identifier+'" resumption '+i+" does not align with any fragments in "+n+" playlist ("+a.fragStart+"-"+a.fragmentEnd+")"),!0;var l="audio"===n?.175:0;return !(Math.abs(o.start-i)<Ws+l||Math.abs(o.end-i)<Ws+l||(r.log('"'+e.identifier+'" resumption '+i+" not aligned with "+n+" fragment bounds ("+o.start+"-"+o.end+" sn: "+o.sn+" cc: "+o.cc+")"),0))}))},r.updateAssetDurations=function(e){if(e.assetListLoaded){for(var t=e.timelineStart,r=0,i=!1,n=!1,a=0;a<e.assetList.length;a++){var s=e.assetList[a],o=t+r;s.startOffset=r,s.timelineStart=o,i||(i=null===s.duration),n||(n=!!s.error),r+=s.error?0:s.duration||0;}e.duration=i&&!n?Math.max(r,e.duration):r;}},r.removeEvent=function(e){e.reset(),delete this.eventMap[e.identifier];},i(t,[{key:"duration",get:function(){var e=this.items;return e?e[e.length-1].end:0}},{key:"length",get:function(){return this.items?this.items.length:0}},{key:"assetIdAtEnd",get:function(){var e,t=null==(e=this.items)||null==(e=e[this.length-1])?void 0:e.event;if(t){var r=t.assetList,i=r[r.length-1];if(i)return i.identifier}return null}}])}(N);function to(e){return "["+(e.event?'"'+e.event.identifier+'"':"primary")+": "+e.start.toFixed(2)+"-"+e.end.toFixed(2)+"]"}var ro=function(){function e(e){this.hls=void 0,this.hls=e;}var t=e.prototype;return t.destroy=function(){this.hls=null;},t.loadAssetList=function(e,t){var r,i=this,n=e.assetListUrl;try{r=zs(n,this.hls.sessionId,e.baseUrl);}catch(t){var a=this.assignAssetListError(e,k.ASSET_LIST_LOAD_ERROR,t,n);return void this.hls.trigger(b.ERROR,a)}t&&"data:"!==r.protocol&&r.searchParams.set("_HLS_start_offset",""+t);var s=this.hls.config,o=new(s.loader)(s),l={responseType:"json",url:r.href},u=s.interstitialAssetListLoadPolicy.default,d={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:function(t,r,n,a){var s=t.data,o=null==s?void 0:s.ASSETS;if(Array.isArray(o))e.assetListResponse=s,i.hls.trigger(b.ASSET_LIST_LOADED,{event:e,assetListResponse:s,networkDetails:a});else {var l=i.assignAssetListError(e,k.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),n.url,r,a);i.hls.trigger(b.ERROR,l);}},onError:function(t,r,n,a){var s=i.assignAssetListError(e,k.ASSET_LIST_LOAD_ERROR,new Error("Error loading X-ASSET-LIST: HTTP status "+t.code+" "+t.text+" ("+r.url+")"),r.url,a,n);i.hls.trigger(b.ERROR,s);},onTimeout:function(t,r,n){var a=i.assignAssetListError(e,k.ASSET_LIST_LOAD_TIMEOUT,new Error("Timeout loading X-ASSET-LIST ("+r.url+")"),r.url,t,n);i.hls.trigger(b.ERROR,a);}};return o.load(l,d,h),this.hls.trigger(b.ASSET_LIST_LOADING,{event:e}),o},t.assignAssetListError=function(e,t,r,i,n,a){return e.error=r,{type:R.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:i,error:r,networkDetails:a,stats:n}},e}();function io(e){var t;null==e||null==(t=e.play())||t.catch((function(){}));}function no(e,t){return "["+e+"] Advancing timeline position to "+t}var ao=function(e){function t(t,r){var i;return (i=e.call(this,"interstitials",t.logger)||this).HlsPlayerClass=void 0,i.hls=void 0,i.assetListLoader=void 0,i.mediaSelection=null,i.altSelection=null,i.media=null,i.detachedData=null,i.requiredTracks=null,i.manager=null,i.playerQueue=[],i.bufferedPos=-1,i.timelinePos=-1,i.schedule=void 0,i.playingItem=null,i.bufferingItem=null,i.waitingItem=null,i.endedItem=null,i.playingAsset=null,i.endedAsset=null,i.bufferingAsset=null,i.shouldPlay=!1,i.onPlay=function(){i.shouldPlay=!0;},i.onPause=function(){i.shouldPlay=!1;},i.onSeeking=function(){var e=i.currentTime;if(void 0!==e&&!i.playbackDisabled&&i.schedule){var t=e-i.timelinePos;if(!(Math.abs(t)<1/7056e5)){var r=t<=-.01;i.timelinePos=e,i.bufferedPos=e;var n=i.playingItem;if(n)if(r&&i.schedule.resetErrorsInRange(e,e-t)&&i.updateSchedule(!0),i.checkBuffer(),r&&e<n.start||e>=n.end){var a,s=i.findItemIndex(n),o=i.schedule.findItemIndexAtTime(e);if(-1===o&&(o=s+(r?-1:1),i.log("seeked "+(r?"back ":"")+"to position not covered by schedule "+e+" (resolving from "+s+" to "+o+")")),!i.isInterstitial(n)&&null!=(a=i.media)&&a.paused&&(i.shouldPlay=!1),!r&&o>s){var l=i.schedule.findJumpRestrictedIndex(s+1,o);if(l>s)return void i.setSchedulePosition(l)}i.setSchedulePosition(o);}else {var u=i.playingAsset;if(u){var d,h=u.timelineStart,f=u.duration||0;(r&&e<h||e>=h+f)&&(null!=(d=n.event)&&d.appendInPlace&&(i.clearInterstitial(n.event,n),i.flushFrontBuffer(e)),i.setScheduleToAssetAtTime(e,u));}else if(i.playingLastItem&&i.isInterstitial(n)){var c=n.event.assetList[0];c&&(i.endedItem=i.playingItem,i.playingItem=null,i.setScheduleToAssetAtTime(e,c));}}else i.checkBuffer();}}},i.onTimeupdate=function(){var e=i.currentTime;if(void 0!==e&&!i.playbackDisabled&&e>i.timelinePos){i.timelinePos=e,e>i.bufferedPos&&i.checkBuffer();var t=i.playingItem;if(t&&!i.playingLastItem){if(e>=t.end){i.timelinePos=t.end;var r=i.findItemIndex(t);i.setSchedulePosition(r+1);}var n=i.playingAsset;n&&e>=n.timelineStart+(n.duration||0)&&i.setScheduleToAssetAtTime(e,n);}}},i.onScheduleUpdate=function(e,t){var r=i.schedule;if(r){var n=i.playingItem,a=r.events||[],s=r.items||[],o=r.durations,l=e.map((function(e){return e.identifier})),u=!(!a.length&&!l.length);(u||t)&&i.log("INTERSTITIALS_UPDATED ("+a.length+"): "+a+"\nSchedule: "+s.map((function(e){return to(e)}))+" pos: "+i.timelinePos),l.length&&i.log("Removed events "+l);var d=null,h=null;n&&(d=i.updateItem(n,i.timelinePos),i.itemsMatch(n,d)?i.playingItem=d:i.waitingItem=i.endedItem=null),i.waitingItem=i.updateItem(i.waitingItem),i.endedItem=i.updateItem(i.endedItem);var f=i.bufferingItem;if(f&&(h=i.updateItem(f,i.bufferedPos),i.itemsMatch(f,h)?i.bufferingItem=h:f.event&&(i.bufferingItem=i.playingItem,i.clearInterstitial(f.event,null))),e.forEach((function(e){e.assetList.forEach((function(e){i.clearAssetPlayer(e.identifier,null);}));})),i.playerQueue.forEach((function(e){if(e.interstitial.appendInPlace){var t=e.assetItem.timelineStart,r=e.timelineOffset-t;if(r)try{e.timelineOffset=t;}catch(n){Math.abs(r)>Ws&&i.warn(n+' ("'+e.assetId+'" '+e.timelineOffset+"->"+t+")");}}})),u||t){if(i.hls.trigger(b.INTERSTITIALS_UPDATED,{events:a.slice(0),schedule:s.slice(0),durations:o,removedIds:l}),i.isInterstitial(n)&&l.includes(n.event.identifier))return i.warn('Interstitial "'+n.event.identifier+'" removed while playing'),void i.primaryFallback(n.event);n&&i.trimInPlace(d,n),f&&h!==d&&i.trimInPlace(h,f),i.checkBuffer();}}},i.hls=t,i.HlsPlayerClass=r,i.assetListLoader=new ro(t),i.schedule=new eo(i.onScheduleUpdate,t.logger),i.registerListeners(),i}o(t,e);var r=t.prototype;return r.registerListeners=function(){var e=this.hls;e&&(e.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(b.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(b.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(b.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(b.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(b.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(b.BUFFER_APPENDED,this.onBufferAppended,this),e.on(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(b.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(b.MEDIA_ENDED,this.onMediaEnded,this),e.on(b.ERROR,this.onError,this),e.on(b.DESTROYING,this.onDestroying,this));},r.unregisterListeners=function(){var e=this.hls;e&&(e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(b.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(b.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(b.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(b.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(b.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(b.BUFFER_CODECS,this.onBufferCodecs,this),e.off(b.BUFFER_APPENDED,this.onBufferAppended,this),e.off(b.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(b.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(b.MEDIA_ENDED,this.onMediaEnded,this),e.off(b.ERROR,this.onError,this),e.off(b.DESTROYING,this.onDestroying,this));},r.startLoad=function(){this.resumeBuffering();},r.stopLoad=function(){this.pauseBuffering();},r.resumeBuffering=function(){var e;null==(e=this.getBufferingPlayer())||e.resumeBuffering();},r.pauseBuffering=function(){var e;null==(e=this.getBufferingPlayer())||e.pauseBuffering();},r.destroy=function(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null;},r.onDestroying=function(){var e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e);},r.removeMediaListeners=function(e){bi(e,"play",this.onPlay),bi(e,"pause",this.onPause),bi(e,"seeking",this.onSeeking),bi(e,"timeupdate",this.onTimeupdate);},r.onMediaAttaching=function(e,t){var r=this.media=t.media;ki(r,"seeking",this.onSeeking),ki(r,"timeupdate",this.onTimeupdate),ki(r,"play",this.onPlay),ki(r,"pause",this.onPause);},r.onMediaAttached=function(e,t){var r=this.effectivePlayingItem,i=this.detachedData;if(this.detachedData=null,null===r)this.checkStart();else if(!i){this.clearScheduleState();var n=this.findItemIndex(r);this.setSchedulePosition(n);}},r.clearScheduleState=function(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null;},r.onMediaDetaching=function(e,t){var r=!!t.transferMedia,i=this.media;if(this.media=null,!r&&(i&&this.removeMediaListeners(i),this.detachedData)){var n=this.getBufferingPlayer();n&&(this.log("Removing schedule state for detachedData and "+n),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,n.detachMedia()),this.shouldPlay=!1;}},r.isInterstitial=function(e){return !(null==e||!e.event)},r.retreiveMediaSource=function(e,t){var r=this.getAssetPlayer(e);r&&this.transferMediaFromPlayer(r,t);},r.transferMediaFromPlayer=function(e,t){var r=e.interstitial.appendInPlace,i=e.media;if(r&&i===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&i)return void(this.detachedData={media:i});var n=e.transferMedia();this.log("transfer MediaSource from "+e+" "+ut(n)),this.detachedData=n;}else t&&i&&(this.shouldPlay||(this.shouldPlay=!i.paused));},r.transferMediaTo=function(e,t){var r,i,n=this;if(e.media!==t){var a,s=null,o=this.hls,l=e!==o,u=l&&e.interstitial.appendInPlace,d=null==(r=this.detachedData)?void 0:r.mediaSource;if(o.media)u&&(s=o.transferMedia(),this.detachedData=s),a="Primary";else if(d){var h=this.getBufferingPlayer();h?(s=h.transferMedia(),a=""+h):a="detached MediaSource";}else a="detached media";if(!s)if(d)s=this.detachedData,this.log("using detachedData: MediaSource "+ut(s));else if(!this.detachedData||o.media===t){var f=this.playerQueue;f.length>1&&f.forEach((function(e){if(l&&e.interstitial.appendInPlace!==u){var t=e.interstitial;n.clearInterstitial(e.interstitial,null),t.appendInPlace=!1,t.appendInPlace&&n.warn("Could not change append strategy for queued assets "+t);}})),this.hls.detachMedia(),this.detachedData={media:t};}var c=s&&"mediaSource"in s&&"closed"!==(null==(i=s.mediaSource)?void 0:i.readyState),g=c&&s?s:t;this.log((c?"transfering MediaSource":"attaching media")+" to "+(l?e:"Primary")+" from "+a+" (media.currentTime: "+t.currentTime+")");var v=this.schedule;if(g===s&&v){var m=l&&e.assetId===v.assetIdAtEnd;g.overrides={duration:v.duration,endOfStream:!l||m,cueRemoval:!l};}e.attachMedia(g);}},r.onInterstitialCueEnter=function(){this.onTimeupdate();},r.checkStart=function(){var e=this.schedule,t=null==e?void 0:e.events;if(t&&!this.playbackDisabled&&this.media){-1===this.bufferedPos&&(this.bufferedPos=0);var r=this.timelinePos,i=this.effectivePlayingItem;if(-1===r){var n=this.hls.startPosition;if(this.log(no("checkStart",n)),this.timelinePos=n,t.length&&t[0].cue.pre){var a=e.findEventIndex(t[0].identifier);this.setSchedulePosition(a);}else if(n>=0||!this.primaryLive){var s=this.timelinePos=n>0?n:0,o=e.findItemIndexAtTime(s);this.setSchedulePosition(o);}}else if(i&&!this.playingItem){var l=e.findItemIndex(i);this.setSchedulePosition(l);}}},r.advanceAssetBuffering=function(e,t){var r=e.event,i=r.findAssetIndex(t),n=$s(r,i);if(r.isAssetPastPlayoutLimit(n)){if(this.schedule){var a,s=null==(a=this.schedule.items)?void 0:a[this.findItemIndex(e)+1];s&&this.bufferedToItem(s);}}else this.bufferedToEvent(e,n);},r.advanceAfterAssetEnded=function(e,t,r){var i=$s(e,r);if(e.isAssetPastPlayoutLimit(i)){if(this.schedule){var n=this.schedule.items;if(n){var a=t+1;if(a>=n.length)return void this.setSchedulePosition(-1);var s=e.resumeTime;this.timelinePos<s&&(this.log(no("advanceAfterAssetEnded",s)),this.timelinePos=s,e.appendInPlace&&this.advanceInPlace(s),this.checkBuffer(this.bufferedPos<s)),this.setSchedulePosition(a);}}}else {if(e.appendInPlace){var o=e.assetList[i];o&&this.advanceInPlace(o.timelineStart);}this.setSchedulePosition(t,i);}},r.setScheduleToAssetAtTime=function(e,t){var r=this.schedule;if(r){var i=t.parentIdentifier,n=r.getEvent(i);if(n){var a=r.findEventIndex(i),s=r.findAssetIndex(n,e);this.advanceAfterAssetEnded(n,a,s-1);}}},r.setSchedulePosition=function(e,t){var r,i=null==(r=this.schedule)?void 0:r.items;if(i&&!this.playbackDisabled){var n=e>=0?i[e]:null;this.log("setSchedulePosition "+e+", "+t+" ("+(n?to(n):n)+") pos: "+this.timelinePos);var a=this.waitingItem||this.playingItem,s=this.playingLastItem;if(this.isInterstitial(a)){var o=a.event,l=this.playingAsset,u=null==l?void 0:l.identifier,d=u?this.getAssetPlayer(u):null;if(d&&u&&(!this.eventItemsMatch(a,n)||void 0!==t&&u!==o.assetList[t].identifier)){var h,f=o.findAssetIndex(l);if(this.log("INTERSTITIAL_ASSET_ENDED "+(f+1)+"/"+o.assetList.length+" "+Zs(l)),this.endedAsset=l,this.playingAsset=null,this.hls.trigger(b.INTERSTITIAL_ASSET_ENDED,{asset:l,assetListIndex:f,event:o,schedule:i.slice(0),scheduleIndex:e,player:d}),a!==this.playingItem)return void(this.itemsMatch(a,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(o,this.findItemIndex(this.playingItem),f));this.retreiveMediaSource(u,n),!d.media||null!=(h=this.detachedData)&&h.mediaSource||d.detachMedia();}if(!this.eventItemsMatch(a,n)&&(this.endedItem=a,this.playingItem=null,this.log("INTERSTITIAL_ENDED "+o+" "+to(a)),o.hasPlayed=!0,this.hls.trigger(b.INTERSTITIAL_ENDED,{event:o,schedule:i.slice(0),scheduleIndex:e}),o.cue.once)){var c;this.updateSchedule();var g=null==(c=this.schedule)?void 0:c.items;if(n&&g){var v=this.findItemIndex(n);this.advanceSchedule(v,g,t,a,s);}return}}this.advanceSchedule(e,i,t,a,s);}},r.advanceSchedule=function(e,t,r,i,n){var a=this,s=this.schedule;if(s){var o=t[e]||null,l=this.primaryMedia,u=this.playerQueue;if(u.length&&u.forEach((function(t){var r=t.interstitial,i=s.findEventIndex(r.identifier);(i<e||i>e+1)&&a.clearInterstitial(r,o);})),this.isInterstitial(o)){this.timelinePos=Math.min(Math.max(this.timelinePos,o.start),o.end);var d=o.event;if(void 0===r){var h=$s(d,(r=s.findAssetIndex(d,this.timelinePos))-1);if(d.isAssetPastPlayoutLimit(h)||d.appendInPlace&&this.timelinePos===o.end)return void this.advanceAfterAssetEnded(d,e,r);r=h;}var f=this.waitingItem;this.assetsBuffered(o,l)||this.setBufferingItem(o);var c=this.preloadAssets(d,r);if(this.eventItemsMatch(o,f||i)||(this.waitingItem=o,this.log("INTERSTITIAL_STARTED "+to(o)+" "+(d.appendInPlace?"append in place":"")),this.hls.trigger(b.INTERSTITIAL_STARTED,{event:d,schedule:t.slice(0),scheduleIndex:e})),!d.assetListLoaded)return void this.log("Waiting for ASSET-LIST to complete loading "+d);if(d.assetListLoader&&(d.assetListLoader.destroy(),d.assetListLoader=void 0),!l)return void this.log("Waiting for attachMedia to start Interstitial "+d);this.waitingItem=this.endedItem=null,this.playingItem=o;var g=d.assetList[r];if(!g)return void this.advanceAfterAssetEnded(d,e,r||0);if(c||(c=this.getAssetPlayer(g.identifier)),null===c||c.destroyed){var v=d.assetList.length;this.warn("asset "+(r+1)+"/"+v+" player destroyed "+d),(c=this.createAssetPlayer(d,g,r)).loadSource();}if(!this.eventItemsMatch(o,this.bufferingItem)&&d.appendInPlace&&this.isAssetBuffered(g))return;this.startAssetPlayer(c,r,t,e,l),this.shouldPlay&&io(c.media);}else o?(this.resumePrimary(o,e,i),this.shouldPlay&&io(this.hls.media)):n&&this.isInterstitial(i)&&(this.endedItem=null,this.playingItem=i,i.event.appendInPlace||this.attachPrimary(s.durations.primary,null));}},r.resumePrimary=function(e,t,r){var i,n;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log("resuming "+to(e)),null==(i=this.detachedData)||!i.mediaSource){var a=this.timelinePos;(a<e.start||a>=e.end)&&(a=this.getPrimaryResumption(e,t),this.log(no("resumePrimary",a)),this.timelinePos=a),this.attachPrimary(a,e);}if(r){var s=null==(n=this.schedule)?void 0:n.items;s&&(this.log("INTERSTITIALS_PRIMARY_RESUMED "+to(e)),this.hls.trigger(b.INTERSTITIALS_PRIMARY_RESUMED,{schedule:s.slice(0),scheduleIndex:t}),this.checkBuffer());}},r.getPrimaryResumption=function(e,t){var r=e.start;if(this.primaryLive){var i=this.primaryDetails;if(0===t)return this.hls.startPosition;if(i&&(r<i.fragmentStart||r>i.edge))return this.hls.liveSyncPosition||-1}return r},r.isAssetBuffered=function(e){var t=this.getAssetPlayer(e.identifier);return null!=t&&t.hls?t.hls.bufferedToEnd:dr.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)},r.attachPrimary=function(e,t,r){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;var i=this.primaryMedia;if(i){var n=this.hls;n.media?this.checkBuffer():(this.transferMediaTo(n,i),r&&this.startLoadingPrimaryAt(e,r)),r||(this.log(no("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,r));}},r.startLoadingPrimaryAt=function(e,t){var r,i=this.hls;!i.loadingEnabled||!i.media||Math.abs(((null==(r=i.mainForwardBufferInfo)?void 0:r.start)||i.media.currentTime)-e)>.5?i.startLoad(e,t):i.bufferingEnabled||i.resumeBuffering();},r.onManifestLoading=function(){var e;this.stopLoad(),null==(e=this.schedule)||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(b.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(b.BUFFER_CODECS,this.onBufferCodecs,this);},r.onLevelUpdated=function(e,t){if(-1!==t.level&&this.schedule){var r=this.hls.levels[t.level];if(r.details){var i=d(d({},this.mediaSelection||this.altSelection),{},{main:r});this.mediaSelection=i,this.schedule.parseInterstitialDateRanges(i,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart();}}},r.onAudioTrackUpdated=function(e,t){var r=this.hls.audioTracks[t.id],i=this.mediaSelection;if(i){var n=d(d({},i),{},{audio:r});this.mediaSelection=n;}else this.altSelection=d(d({},this.altSelection),{},{audio:r});},r.onSubtitleTrackUpdated=function(e,t){var r=this.hls.subtitleTracks[t.id],i=this.mediaSelection;if(i){var n=d(d({},i),{},{subtitles:r});this.mediaSelection=n;}else this.altSelection=d(d({},this.altSelection),{},{subtitles:r});},r.onAudioTrackSwitching=function(e,t){var r=ft(t);this.playerQueue.forEach((function(e){var i=e.hls;return i&&(i.setAudioOption(t)||i.setAudioOption(r))}));},r.onSubtitleTrackSwitch=function(e,t){var r=ft(t);this.playerQueue.forEach((function(e){var i=e.hls;return i&&(i.setSubtitleOption(t)||-1!==t.id&&i.setSubtitleOption(r))}));},r.onBufferCodecs=function(e,t){var r=t.tracks;r&&(this.requiredTracks=r);},r.onBufferAppended=function(e,t){this.checkBuffer();},r.onBufferFlushed=function(e,t){var r=this.playingItem;if(r&&!this.itemsMatch(r,this.bufferingItem)&&!this.isInterstitial(r)){var i=this.timelinePos;this.bufferedPos=i,this.checkBuffer();}},r.onBufferedToEnd=function(e){if(this.schedule){var t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(var r=0;r<t.length;r++){var i=t[r];if(i.cue.post){var n,a=this.schedule.findEventIndex(i.identifier),s=null==(n=this.schedule.items)?void 0:n[a];this.isInterstitial(s)&&this.eventItemsMatch(s,this.bufferingItem)&&this.bufferedToItem(s,0);break}}this.bufferedPos=Number.MAX_VALUE;}}},r.onMediaEnded=function(e){var t=this.playingItem;if(!this.playingLastItem&&t){var r=this.findItemIndex(t);this.setSchedulePosition(r+1);}else this.shouldPlay=!1;},r.updateItem=function(e,t){var r,i=null==(r=this.schedule)?void 0:r.items;return e&&i&&i[this.findItemIndex(e,t)]||null},r.trimInPlace=function(e,t){var r=this;if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((function(t,i){e.event.isAssetPastPlayoutLimit(i)&&r.clearAssetPlayer(t.identifier,null);}));var i=e.end+.25,n=dr.bufferInfo(this.primaryMedia,i,0);(n.end>i||(n.nextStart||0)>i)&&(this.log("trim buffered interstitial "+to(e)+" (was "+to(t)+")"),this.attachPrimary(i,null,!0),this.flushFrontBuffer(i));}},r.itemsMatch=function(e,t){return !!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))},r.eventItemsMatch=function(e,t){var r;return !!t&&(e===t||e.event.identifier===(null==(r=t.event)?void 0:r.identifier))},r.findItemIndex=function(e,t){return e&&this.schedule?this.schedule.findItemIndex(e,t):-1},r.updateSchedule=function(e){var t;void 0===e&&(e=!1);var r=this.mediaSelection;r&&(null==(t=this.schedule)||t.updateSchedule(r,[],e));},r.checkBuffer=function(e){var t,r=null==(t=this.schedule)?void 0:t.items;if(r){var i=dr.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=i.len<1),this.updateBufferedPos(i.end,r,e);}},r.updateBufferedPos=function(e,t,r){var i=this.schedule,n=this.bufferingItem;if(!(this.bufferedPos>e)&&i)if(1===t.length&&this.itemsMatch(t[0],n))this.bufferedPos=e;else {var a=this.playingItem,s=this.findItemIndex(a),o=i.findItemIndexAtTime(e);if(this.bufferedPos<e){var l,u=this.findItemIndex(n),d=Math.min(u+1,t.length-1),h=t[d];if((-1===o&&n&&e>=n.end||null!=(l=h.event)&&l.appendInPlace&&e+.01>=h.start)&&(o=d),this.isInterstitial(n)){var f=n.event;if(d-s>1&&!1===f.appendInPlace)return;if(0===f.assetList.length&&f.assetListLoader)return}if(this.bufferedPos=e,o>u&&o>s)this.bufferedToItem(h);else {var c=this.primaryDetails;this.primaryLive&&c&&e>c.edge-c.targetduration&&h.start<c.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(h)&&this.preloadAssets(h.event,0);}}else r&&a&&!this.itemsMatch(a,n)&&(o===s?this.bufferedToItem(a):o===s+1&&this.bufferedToItem(t[o]));}},r.assetsBuffered=function(e,t){var r=this;return 0!==e.event.assetList.length&&!e.event.assetList.some((function(e){var i=r.getAssetPlayer(e.identifier);return !(null!=i&&i.bufferedInPlaceToEnd(t))}))},r.setBufferingItem=function(e){var t=this,r=this.bufferingItem,i=this.schedule;if(!this.itemsMatch(e,r)&&i){var n=i.items,a=i.events;if(!n||!a)return r;var s=this.isInterstitial(e),o=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));var l=o?o.remaining:r?r.end-this.timelinePos:0;if(this.log("INTERSTITIALS_BUFFERED_TO_BOUNDARY "+to(e)+(r?" ("+l.toFixed(2)+" remaining)":"")),!this.playbackDisabled)if(s){var u=i.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((function(e,r){var i=t.getAssetPlayer(e.identifier);i&&(r===u&&i.loadSource(),i.resumeBuffering());}));}else this.hls.resumeBuffering(),this.playerQueue.forEach((function(e){return e.pauseBuffering()}));this.hls.trigger(b.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:a.slice(0),schedule:n.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)});}else this.bufferingItem!==e&&(this.bufferingItem=e);return r},r.bufferedToItem=function(e,t){void 0===t&&(t=0);var r=this.setBufferingItem(e);if(!this.playbackDisabled)if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(null!==r){this.bufferingAsset=null;var i=this.detachedData;i&&i.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e);}},r.preloadPrimary=function(e){var t=this.findItemIndex(e),r=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(r);},r.bufferedToEvent=function(e,t){var r=e.event,i=0===r.assetList.length&&!r.assetListLoader,n=r.cue.once;if(i||!n){var a=this.preloadAssets(r,t);if(null!=a&&a.interstitial.appendInPlace){var s=this.primaryMedia;s&&this.bufferAssetPlayer(a,s);}}},r.preloadAssets=function(e,t){var r=e.assetUrl,i=e.assetList.length,n=0===i&&!e.assetListLoader,a=e.cue.once;if(n){var s,o=e.timelineStart;if(e.appendInPlace){var l,u=this.playingItem;this.isInterstitial(u)||(null==u||null==(l=u.nextEvent)?void 0:l.identifier)!==e.identifier||this.flushFrontBuffer(o+.25);}var d=0;if(!this.playingItem&&this.primaryLive&&-1===(d=this.hls.startPosition)&&(d=this.hls.liveSyncPosition||0),d&&!e.cue.pre&&!e.cue.post){var h=d-o;h>0&&(s=Math.round(1e3*h)/1e3);}if(this.log("Load interstitial asset "+(t+1)+"/"+(r?1:i)+" "+e+(s?" live-start: "+d+" start-offset: "+s:"")),r)return this.createAsset(e,0,0,o,e.duration,r);var f=this.assetListLoader.loadAssetList(e,s);f&&(e.assetListLoader=f);}else if(!a&&i){for(var c=t;c<i;c++){var g=e.assetList[c],v=this.getAssetPlayerQueueIndex(g.identifier);-1!==v&&!this.playerQueue[v].destroyed||g.error||this.createAssetPlayer(e,g,c);}var m=e.assetList[t];if(m){var p=this.getAssetPlayer(m.identifier);return p&&p.loadSource(),p}}return null},r.flushFrontBuffer=function(e){var t=this,r=this.requiredTracks;r&&(this.log("Removing front buffer starting at "+e),Object.keys(r).forEach((function(r){t.hls.trigger(b.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:r});})));},r.getAssetPlayerQueueIndex=function(e){for(var t=this.playerQueue,r=0;r<t.length;r++)if(e===t[r].assetId)return r;return -1},r.getAssetPlayer=function(e){var t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null},r.getBufferingPlayer=function(){var e=this.playerQueue,t=this.primaryMedia;if(t)for(var r=0;r<e.length;r++)if(e[r].media===t)return e[r];return null},r.createAsset=function(e,t,r,i,n,a){var s={parentIdentifier:e.identifier,identifier:qs(e,a,t),duration:n,startOffset:r,timelineStart:i,uri:a};return this.createAssetPlayer(e,s,t)},r.createAssetPlayer=function(e,t,r){var i=this,n=this.hls,s=n.userConfig,o=s.videoPreference,l=n.loadLevelObj||n.levels[n.currentLevel];(o||l)&&(o=a({},o),l.videoCodec&&(o.videoCodec=l.videoCodec),l.videoRange&&(o.allowedVideoRanges=[l.videoRange]));var u=n.audioTracks[n.audioTrack],h=n.subtitleTracks[n.subtitleTrack],f=0;if(this.primaryLive||e.appendInPlace){var c=this.timelinePos-t.timelineStart;if(c>1){var g=t.duration;g&&c<g&&(f=c);}}var v=t.identifier,m=d(d({},s),{},{maxMaxBufferLength:Math.min(180,n.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:n.sessionId,assetPlayerId:v,abrEwmaDefaultEstimate:n.bandwidthEstimate,interstitialsController:void 0,startPosition:f,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:o,audioPreference:u||s.audioPreference,subtitlePreference:h||s.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(m.timelineOffset=t.timelineStart));var p=m.cmcd;null!=p&&p.sessionId&&p.contentId&&(m.cmcd=a({},p,{contentId:Ys(t.uri)})),this.getAssetPlayer(v)&&this.warn("Duplicate date range identifier "+e+" and asset "+v);var y=new Js(this.HlsPlayerClass,m,e,t);this.playerQueue.push(y),e.assetList[r]=t;var E=!0,T=function(n){if(n.live){var a,s=new Error("Interstitials MUST be VOD assets "+e),o={fatal:!0,type:R.OTHER_ERROR,details:k.INTERSTITIAL_ASSET_ITEM_ERROR,error:s},l=(null==(a=i.schedule)?void 0:a.findEventIndex(e.identifier))||-1;i.handleAssetItemError(o,e,l,r,s.message);}else {var u=n.edge-n.fragmentStart,d=t.duration;(E||null===d||u>d)&&(E=!1,i.log('Interstitial asset "'+v+'" duration change '+d+" > "+u),t.duration=u,i.updateSchedule());}};y.on(b.LEVEL_UPDATED,(function(e,t){var r=t.details;return T(r)})),y.on(b.LEVEL_PTS_UPDATED,(function(e,t){var r=t.details;return T(r)})),y.on(b.EVENT_CUE_ENTER,(function(){return i.onInterstitialCueEnter()}));var S=function(e,t){var r=i.getAssetPlayer(v);if(r&&t.tracks){r.off(b.BUFFER_CODECS,S),r.tracks=t.tracks;var n=i.primaryMedia;i.bufferingAsset===r.assetItem&&n&&!r.media&&i.bufferAssetPlayer(r,n);}};y.on(b.BUFFER_CODECS,S),y.on(b.BUFFERED_TO_END,(function(){var r,n=i.getAssetPlayer(v);if(i.log("buffered to end of asset "+n),n&&i.schedule){var a=i.schedule.findEventIndex(e.identifier),s=null==(r=i.schedule.items)?void 0:r[a];i.isInterstitial(s)&&i.advanceAssetBuffering(s,t);}}));var A=function(t){return function(){if(i.getAssetPlayer(v)&&i.schedule){i.shouldPlay=!0;var r=i.schedule.findEventIndex(e.identifier);i.advanceAfterAssetEnded(e,r,t);}}};return y.once(b.MEDIA_ENDED,A(r)),y.once(b.PLAYOUT_LIMIT_REACHED,A(1/0)),y.on(b.ERROR,(function(t,n){if(i.schedule){var a=i.getAssetPlayer(v);if(n.details===k.BUFFER_STALLED_ERROR)return null!=a&&a.appendInPlace?void i.handleInPlaceStall(e):(i.onTimeupdate(),void i.checkBuffer(!0));i.handleAssetItemError(n,e,i.schedule.findEventIndex(e.identifier),r,"Asset player error "+n.error+" "+e);}})),y.on(b.DESTROYING,(function(){if(i.getAssetPlayer(v)&&i.schedule){var t=new Error("Asset player destroyed unexpectedly "+v),n={fatal:!0,type:R.OTHER_ERROR,details:k.INTERSTITIAL_ASSET_ITEM_ERROR,error:t};i.handleAssetItemError(n,e,i.schedule.findEventIndex(e.identifier),r,t.message);}})),this.log("INTERSTITIAL_ASSET_PLAYER_CREATED "+Zs(t)),this.hls.trigger(b.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:r,event:e,player:y}),y},r.clearInterstitial=function(e,t){var r=this;e.assetList.forEach((function(e){r.clearAssetPlayer(e.identifier,t);})),e.reset();},r.resetAssetPlayer=function(e){var t=this.getAssetPlayerQueueIndex(e);if(-1!==t){this.log('reset asset player "'+e+'" after error');var r=this.playerQueue[t];this.transferMediaFromPlayer(r,null),r.resetDetails();}},r.clearAssetPlayer=function(e,t){var r=this.getAssetPlayerQueueIndex(e);if(-1!==r){var i=this.playerQueue[r];this.log("clear "+i+" toSegment: "+(t?to(t):t)),this.transferMediaFromPlayer(i,t),this.playerQueue.splice(r,1),i.destroy();}},r.emptyPlayerQueue=function(){for(var e;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[];},r.startAssetPlayer=function(e,t,r,i,n){var a=e.interstitial,s=e.assetItem,o=e.assetId,l=a.assetList.length,u=this.playingAsset;this.endedAsset=null,this.playingAsset=s,u&&u.identifier===o||(u&&(this.clearAssetPlayer(u.identifier,r[i]),delete u.error),this.log("INTERSTITIAL_ASSET_STARTED "+(t+1)+"/"+l+" "+Zs(s)),this.hls.trigger(b.INTERSTITIAL_ASSET_STARTED,{asset:s,assetListIndex:t,event:a,schedule:r.slice(0),scheduleIndex:i,player:e})),this.bufferAssetPlayer(e,n);},r.bufferAssetPlayer=function(e,t){var r,i;if(this.schedule){var n=e.interstitial,a=e.assetItem,s=this.schedule.findEventIndex(n.identifier),o=null==(r=this.schedule.items)?void 0:r[s];if(o){e.loadSource(),this.setBufferingItem(o),this.bufferingAsset=a;var l=this.getBufferingPlayer();if(l!==e){var u=n.appendInPlace;if(!u||!1!==(null==l?void 0:l.interstitial.appendInPlace)){var d=(null==l?void 0:l.tracks)||(null==(i=this.detachedData)?void 0:i.tracks)||this.requiredTracks;if(u&&a!==this.playingAsset){if(!e.tracks)return void this.log("Waiting for track info before buffering "+e);if(d&&!j(d,e.tracks)){var h=new Error("Asset "+Zs(a)+" SourceBuffer tracks ('"+Object.keys(e.tracks)+"') are not compatible with primary content tracks ('"+Object.keys(d)+"')"),f={fatal:!0,type:R.OTHER_ERROR,details:k.INTERSTITIAL_ASSET_ITEM_ERROR,error:h},c=n.findAssetIndex(a);return void this.handleAssetItemError(f,n,s,c,h.message)}}this.transferMediaTo(e,t);}}}}},r.handleInPlaceStall=function(e){var t=this.schedule,r=this.primaryMedia;if(t&&r){var i=r.currentTime,n=t.findAssetIndex(e,i),a=e.assetList[n];if(a){var s=this.getAssetPlayer(a.identifier);if(s){var o=s.currentTime||i-a.timelineStart,l=s.duration-o;if(this.warn("Stalled at "+o+" of "+(o+l)+" in "+s+" "+e+" (media.currentTime: "+i+")"),o&&(l/r.playbackRate<.5||s.bufferedInPlaceToEnd(r))&&s.hls){var u=t.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,u,n);}}}}},r.advanceInPlace=function(e){var t=this.primaryMedia;t&&t.currentTime<e&&(t.currentTime=e);},r.handleAssetItemError=function(e,t,r,i,n){if(e.details!==k.BUFFER_STALLED_ERROR){var s=t.assetList[i]||null;if(this.warn("INTERSTITIAL_ASSET_ERROR "+(s?Zs(s):s)+" "+e.error),this.schedule){var o=(null==s?void 0:s.identifier)||"",l=this.getAssetPlayerQueueIndex(o),u=this.playerQueue[l]||null,d=this.schedule.items,h=a({},e,{fatal:!1,errorAction:Kt(!0),asset:s,assetListIndex:i,event:t,schedule:d,scheduleIndex:r,player:u});if(this.hls.trigger(b.INTERSTITIAL_ASSET_ERROR,h),e.fatal){var f=this.playingAsset,c=this.bufferingAsset,g=new Error(n);if(s&&(this.clearAssetPlayer(o,null),s.error=g),t.assetList.some((function(e){return !e.error})))for(var v=i;v<t.assetList.length;v++)this.resetAssetPlayer(t.assetList[v].identifier);else t.error=g;this.updateSchedule(!0),t.error?this.primaryFallback(t):f&&f.identifier===o?this.advanceAfterAssetEnded(t,r,i):c&&c.identifier===o&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,c);}}}},r.primaryFallback=function(e){var t=e.timelineStart,r=this.effectivePlayingItem;if(r){this.log('Fallback to primary from event "'+e.identifier+'" start: '+t+" pos: "+this.timelinePos+" playing: "+to(r)+" error: "+e.error);var i=this.timelinePos;-1===i&&(i=this.hls.startPosition);var n=this.updateItem(r,i);if(this.itemsMatch(r,n)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t)),!this.schedule)return;var a=this.schedule.findItemIndexAtTime(i);this.setSchedulePosition(a);}else this.checkStart();},r.onAssetListLoaded=function(e,t){var r,i,n=this,a=t.event,s=a.identifier,o=t.assetListResponse.ASSETS;if(null!=(r=this.schedule)&&r.hasEvent(s)){var l=a.timelineStart,u=a.duration,d=0;o.forEach((function(e,t){var r=parseFloat(e.DURATION);n.createAsset(a,t,d,l+d,r,e.URI),d+=r;})),a.duration=d,this.log("Loaded asset-list with duration: "+d+" (was: "+u+") "+a);var h=this.waitingItem,f=(null==h?void 0:h.event.identifier)===s;this.updateSchedule();var c=null==(i=this.bufferingItem)?void 0:i.event;if(f){var g,v=this.schedule.findEventIndex(s),m=null==(g=this.schedule.items)?void 0:g[v];if(m){if(!this.playingItem&&this.timelinePos>m.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==v)return a.error=new Error("Interstitial no longer within playback range "+this.timelinePos+" "+a),this.updateSchedule(!0),void this.primaryFallback(a);this.setBufferingItem(m);}this.setSchedulePosition(v);}else if((null==c?void 0:c.identifier)===s){var p=a.assetList[0];if(p){var y=this.getAssetPlayer(p.identifier);if(c.appendInPlace){var E=this.primaryMedia;y&&E&&this.bufferAssetPlayer(y,E);}else y&&y.loadSource();}}}},r.onError=function(e,t){if(this.schedule)switch(t.details){case k.ASSET_LIST_PARSING_ERROR:case k.ASSET_LIST_LOAD_ERROR:case k.ASSET_LIST_LOAD_TIMEOUT:var r=t.interstitial;r&&(this.updateSchedule(!0),this.primaryFallback(r));break;case k.BUFFER_STALLED_ERROR:var i=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(i)&&i.event.appendInPlace)return void this.handleInPlaceStall(i.event);this.log("Primary player stall @"+this.timelinePos+" bufferedPos: "+this.bufferedPos),this.onTimeupdate(),this.checkBuffer(!0);}},i(t,[{key:"interstitialsManager",get:function(){if(!this.hls)return null;if(this.manager)return this.manager;var e=this,t=function(){return e.bufferingItem||e.waitingItem},r=function(t){return t?e.getAssetPlayer(t.identifier):t},i=function(t,i,a,s,o){if(t){var l=t[i].start,u=t.event;if(u){if("playout"===i||u.timelineOccupancy!==js.Point){var d=r(a);(null==d?void 0:d.interstitial)===u&&(l+=d.assetItem.startOffset+d[o]);}}else l+=("bufferedPos"===s?n():e[s])-t.start;return l}return 0},n=function(){var t=e.bufferedPos;return t===Number.MAX_VALUE?a("primary"):Math.max(t,0)},a=function(t){var r,i;return null!=(r=e.primaryDetails)&&r.live?e.primaryDetails.edge:(null==(i=e.schedule)?void 0:i.durations[t])||0},s=function(t,n){var a,s,o=e.effectivePlayingItem;if((null==o||null==(a=o.event)||!a.restrictions.skip)&&e.schedule){e.log("seek to "+t+' "'+n+'"');var l=e.effectivePlayingItem,u=e.schedule.findItemIndexAtTime(t,n),d=null==(s=e.schedule.items)?void 0:s[u],h=e.getBufferingPlayer(),f=null==h?void 0:h.interstitial,c=null==f?void 0:f.appendInPlace,g=l&&e.itemsMatch(l,d);if(l&&(c||g)){var v=r(e.playingAsset),m=(null==v?void 0:v.media)||e.primaryMedia;if(m){var p="primary"===n?m.currentTime:i(l,n,e.playingAsset,"timelinePos","currentTime"),y=t-p,E=(c?p:m.currentTime)+y;if(E>=0&&(!v||c||E<=v.duration))return void(m.currentTime=E)}}if(d){var T=t;if("primary"!==n){var S=t-d[n].start;T=d.start+S;}var A=!e.isInterstitial(d);if(e.isInterstitial(l)&&!l.event.appendInPlace||!A&&!d.event.appendInPlace){if(l){var L=e.findItemIndex(l);if(u>L){var I=e.schedule.findJumpRestrictedIndex(L+1,u);if(I>L)return void e.setSchedulePosition(I)}var R=0;if(A)e.timelinePos=T,e.checkBuffer();else for(var k=d.event.assetList,b=t-(d[n]||d).start,D=k.length;D--;){var _=k[D];if(_.duration&&b>=_.startOffset&&b<_.startOffset+_.duration){R=D;break}}e.setSchedulePosition(u,R);}}else {var P=e.media||(c?null==h?void 0:h.media:null);P&&(P.currentTime=T);}}}},o=function(){var r=e.effectivePlayingItem;if(e.isInterstitial(r))return r;var i=t();return e.isInterstitial(i)?i:null},l={get bufferedEnd(){var r,n=t(),a=e.bufferingItem;return a&&a===n&&(i(a,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-a.playout.start||(null==(r=e.bufferingAsset)?void 0:r.startOffset))||0},get currentTime(){var t=o(),r=e.effectivePlayingItem;return r&&r===t?i(r,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-r.playout.start:0},set currentTime(t){var r=o(),i=e.effectivePlayingItem;i&&i===r&&s(t+i.playout.start,"playout");},get duration(){var e=o();return e?e.playout.end-e.playout.start:0},get assetPlayers(){var t,r=null==(t=o())?void 0:t.event.assetList;return r?r.map((function(t){return e.getAssetPlayer(t.identifier)})):[]},get playingIndex(){var t,r=null==(t=o())?void 0:t.event;return r&&e.effectivePlayingAsset?r.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return o()}};return this.manager={get events(){var t;return (null==(t=e.schedule)||null==(t=t.events)?void 0:t.slice(0))||[]},get schedule(){var t;return (null==(t=e.schedule)||null==(t=t.items)?void 0:t.slice(0))||[]},get interstitialPlayer(){return o()?l:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){var r=t();return e.findItemIndex(r)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){var t=e.effectivePlayingItem;return e.findItemIndex(t)},primary:{get bufferedEnd(){return n()},get currentTime(){var t=e.timelinePos;return t>0?t:0},set currentTime(e){s(e,"primary");},get duration(){return a("primary")},get seekableStart(){var t;return (null==(t=e.primaryDetails)?void 0:t.fragmentStart)||0}},integrated:{get bufferedEnd(){return i(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return i(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(e){s(e,"integrated");},get duration(){return a("integrated")},get seekableStart(){var t;return function(t,r){var i;if(0!==t&&"primary"!==r&&null!=(i=e.schedule)&&i.length){var n,a=e.schedule.findItemIndexAtTime(t),s=null==(n=e.schedule.items)?void 0:n[a];if(s)return t+(s[r].start-s.start)}return t}((null==(t=e.primaryDetails)?void 0:t.fragmentStart)||0,"integrated")}},skip:function(){var t=e.effectivePlayingItem,r=null==t?void 0:t.event;if(r&&!r.restrictions.skip){var i=e.findItemIndex(t);if(r.appendInPlace){var n=t.playout.start+t.event.duration;s(n+.001,"playout");}else e.advanceAfterAssetEnded(r,i,1/0);}}}}},{key:"effectivePlayingItem",get:function(){return this.waitingItem||this.playingItem||this.endedItem}},{key:"effectivePlayingAsset",get:function(){return this.playingAsset||this.endedAsset}},{key:"playingLastItem",get:function(){var e,t=this.playingItem,r=null==(e=this.schedule)?void 0:e.items;return !!(this.playbackStarted&&t&&r)&&this.findItemIndex(t)===r.length-1}},{key:"playbackStarted",get:function(){return null!==this.effectivePlayingItem}},{key:"currentTime",get:function(){var e,t;if(null!==this.mediaSelection){var r=this.waitingItem||this.playingItem;if(!this.isInterstitial(r)||r.event.appendInPlace){var i=this.media;!i&&null!=(e=this.bufferingItem)&&null!=(e=e.event)&&e.appendInPlace&&(i=this.primaryMedia);var n=null==(t=i)?void 0:t.currentTime;if(void 0!==n&&A(n))return n}}}},{key:"primaryMedia",get:function(){var e;return this.media||(null==(e=this.detachedData)?void 0:e.media)||null}},{key:"playbackDisabled",get:function(){return !1===this.hls.config.enableInterstitialPlayback}},{key:"primaryDetails",get:function(){var e;return null==(e=this.mediaSelection)?void 0:e.main.details}},{key:"primaryLive",get:function(){var e;return !(null==(e=this.primaryDetails)||!e.live)}}])}(N),so=function(e){function t(t,r,i){var n;return (n=e.call(this,t,r,i,"subtitle-stream-controller",x)||this).currentTrackId=-1,n.tracksBuffered=[],n.mainDetails=null,n.registerListeners(),n}o(t,e);var r=t.prototype;return r.onHandlerDestroying=function(){this.unregisterListeners(),e.prototype.onHandlerDestroying.call(this),this.mainDetails=null;},r.registerListeners=function(){e.prototype.registerListeners.call(this);var t=this.hls;t.on(b.LEVEL_LOADED,this.onLevelLoaded,this),t.on(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(b.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(b.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this);},r.unregisterListeners=function(){e.prototype.unregisterListeners.call(this);var t=this.hls;t.off(b.LEVEL_LOADED,this.onLevelLoaded,this),t.off(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(b.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(b.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this);},r.startLoad=function(e,t){this.stopLoad(),this.state=_i.IDLE,this.setInterval(500),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick();},r.onManifestLoading=function(){e.prototype.onManifestLoading.call(this),this.mainDetails=null;},r.onMediaDetaching=function(t,r){this.tracksBuffered=[],e.prototype.onMediaDetaching.call(this,t,r);},r.onLevelLoaded=function(e,t){this.mainDetails=t.details;},r.onSubtitleFragProcessed=function(e,t){var r=t.frag,i=t.success;if(this.fragContextChanged(r)||(te(r)&&(this.fragPrevious=r),this.state=_i.IDLE),i){var n=this.tracksBuffered[this.currentTrackId];if(n){for(var a,s=r.start,o=0;o<n.length;o++)if(s>=n[o].start&&s<=n[o].end){a=n[o];break}var l=r.start+r.duration;a?a.end=l:(a={start:s,end:l},n.push(a)),this.fragmentTracker.fragBuffered(r),this.fragBufferedComplete(r,null),this.media&&this.tick();}}},r.onBufferFlushing=function(e,t){var r=t.startOffset,i=t.endOffset;if(0===r&&i!==Number.POSITIVE_INFINITY){var n=i-1;if(n<=0)return;t.endOffsetSubtitles=Math.max(0,n),this.tracksBuffered.forEach((function(e){for(var t=0;t<e.length;)if(e[t].end<=n)e.shift();else {if(!(e[t].start<n))break;e[t].start=n,t++;}})),this.fragmentTracker.removeFragmentsInRange(r,n,x);}},r.onError=function(e,t){var r=t.frag;(null==r?void 0:r.type)===x&&(t.details===k.FRAG_GAP&&this.fragmentTracker.fragBuffered(r,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==_i.STOPPED&&(this.state=_i.IDLE));},r.onSubtitleTracksUpdated=function(e,t){var r=this,i=t.subtitleTracks;this.levels&&Ea(this.levels,i)?this.levels=i.map((function(e){return new st(e)})):(this.tracksBuffered=[],this.levels=i.map((function(e){var t=new st(e);return r.tracksBuffered[t.id]=[],t})),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,x),this.fragPrevious=null,this.mediaBuffer=null);},r.onSubtitleTrackSwitch=function(e,t){var r;if(this.currentTrackId=t.id,null!=(r=this.levels)&&r.length&&-1!==this.currentTrackId){var i=this.levels[this.currentTrackId];null!=i&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.state!==_i.STOPPED&&this.setInterval(500);}else this.clearInterval();},r.onSubtitleTrackLoaded=function(e,t){var r,i=this.currentTrackId,n=this.levels,a=t.details,s=t.id;if(n){var o=n[s];if(!(s>=n.length)&&o){this.log("Subtitle track "+s+" loaded ["+a.startSN+","+a.endSN+"]"+(a.lastPartSn?"[part-"+a.lastPartSn+"-"+a.lastPartIndex+"]":"")+",duration:"+a.totalduration),this.mediaBuffer=this.mediaBufferTimeRanges;var l=0;if(a.live||null!=(r=o.details)&&r.live){if(a.deltaUpdateFailed)return;var u=this.mainDetails;if(!u)return void(this.startFragRequested=!1);var d,h=u.fragments[0];o.details?0===(l=this.alignPlaylists(a,o.details,null==(d=this.levelLastLoaded)?void 0:d.details))&&h&&ci(a,l=h.start):a.hasProgramDateTime&&u.hasProgramDateTime?(Ri(a,u),l=a.fragmentStart):h&&ci(a,l=h.start),u&&!this.startFragRequested&&this.setStartPosition(u,l);}o.details=a,this.levelLastLoaded=o,s===i&&(this.hls.trigger(b.SUBTITLE_TRACK_UPDATED,{details:a,id:s,groupId:t.groupId}),this.tick(),a.live&&!this.fragCurrent&&this.media&&this.state===_i.IDLE&&(Tt(null,a.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),o.details=void 0)));}}else this.warn("Subtitle tracks were reset while loading level "+s);},r._handleFragmentLoadComplete=function(e){var t=this,r=e.frag,i=e.payload,n=r.decryptdata,a=this.hls;if(!this.fragContextChanged(r)&&i&&i.byteLength>0&&null!=n&&n.key&&n.iv&&Ir(n.method)){var s=performance.now();this.decrypter.decrypt(new Uint8Array(i),n.key.buffer,n.iv.buffer,Rr(n.method)).catch((function(e){throw a.trigger(b.ERROR,{type:R.MEDIA_ERROR,details:k.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:r}),e})).then((function(e){var t=performance.now();a.trigger(b.FRAG_DECRYPTED,{frag:r,payload:e,stats:{tstart:s,tdecrypt:t}});})).catch((function(e){t.warn(e.name+": "+e.message),t.state=_i.IDLE;}));}},r.doTick=function(){if(this.media){if(this.state===_i.IDLE){var e=this.currentTrackId,t=this.levels,r=null==t?void 0:t[e];if(!r||!t.length||!r.details)return;if(this.waitForLive(r))return;var i=this.config,n=this.getLoadPosition(),a=dr.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],n,i.maxBufferHole),s=a.end,o=a.len,l=r.details;if(o>this.hls.maxBufferLength+l.levelTargetDuration)return;var u=l.fragments,d=u.length,h=l.edge,f=null,c=this.fragPrevious;if(s<h){var g=i.maxFragLookUpTolerance,v=s>h-g?0:g;!(f=Tt(c,u,Math.max(u[0].start,s),v))&&c&&c.start<u[0].start&&(f=u[0]);}else f=u[d-1];if(!(f=this.filterReplacedPrimary(f,r.details)))return;var m=u[f.sn-l.startSN-1];if(m&&m.cc===f.cc&&this.fragmentTracker.getState(m)===Vt&&(f=m),this.fragmentTracker.getState(f)===Vt){var p=this.mapToInitFragWhenRequired(f);p&&this.loadFragment(p,r,s);}}}else this.state=_i.IDLE;},r.loadFragment=function(t,r,i){te(t)?e.prototype.loadFragment.call(this,t,r,i):this._loadInitSegment(t,r);},i(t,[{key:"mediaBufferTimeRanges",get:function(){return new oo(this.tracksBuffered[this.currentTrackId]||[])}}])}(Pi),oo=function(e){this.buffered=void 0;var t=function(t,r,i){if((r>>>=0)>i-1)throw new DOMException("Failed to execute '"+t+"' on 'TimeRanges': The index provided ("+r+") is greater than the maximum bound ("+i+")");return e[r][t]};this.buffered={get length(){return e.length},end:function(r){return t("end",r,e.length)},start:function(r){return t("start",r,e.length)}};};function lo(e,t){var r;try{r=new Event("addtrack");}catch(e){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1);}r.track=e,t.dispatchEvent(r);}function uo(e,t){var r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error("addCue is failed for: "+t)}catch(r){Y.debug("[texttrack-utils]: "+r);try{var i=new self.TextTrackCue(t.startTime,t.endTime,t.text);i.id=t.id,e.addCue(i);}catch(e){Y.debug("[texttrack-utils]: Legacy TextTrackCue fallback failed: "+e);}}"disabled"===r&&(e.mode=r);}function ho(e,t){var r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues)for(var i=e.cues.length;i--;)t&&e.cues[i].removeEventListener("enter",t),e.removeCue(e.cues[i]);"disabled"===r&&(e.mode=r);}function fo(e,t,r,i){var n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues&&e.cues.length>0)for(var a=function(e,t,r){var i=[],n=function(e,t){if(t<=e[0].startTime)return 0;var r=e.length-1;if(t>e[r].endTime)return -1;for(var i,n=0,a=r;n<=a;)if(t<e[i=Math.floor((a+n)/2)].startTime)a=i-1;else {if(!(t>e[i].startTime&&n<r))return i;n=i+1;}return e[n].startTime-t<t-e[a].startTime?n:a}(e,t);if(n>-1)for(var a=n,s=e.length;a<s;a++){var o=e[a];if(o.startTime>=t&&o.endTime<=r)i.push(o);else if(o.startTime>r)return i}return i}(e.cues,t,r),s=0;s<a.length;s++)i&&!i(a[s])||e.removeCue(a[s]);"disabled"===n&&(e.mode=n);}function co(e){for(var t=[],r=0;r<e.length;r++){var i=e[r];"subtitles"!==i.kind&&"captions"!==i.kind||!i.label||t.push(e[r]);}return t}var go=function(e){function t(t){var r;return (r=e.call(this,t,"subtitle-track-controller")||this).media=null,r.tracks=[],r.groupIds=null,r.tracksInGroup=[],r.trackId=-1,r.currentTrack=null,r.selectDefaultTrack=!0,r.queuedDefaultTrack=-1,r.useTextTrackPolling=!1,r.subtitlePollingInterval=-1,r._subtitleDisplay=!0,r.asyncPollTrackChange=function(){return r.pollTrackChange(0)},r.onTextTracksChanged=function(){if(r.useTextTrackPolling||self.clearInterval(r.subtitlePollingInterval),r.media&&r.hls.config.renderTextTracksNatively){for(var e=null,t=co(r.media.textTracks),i=0;i<t.length;i++)if("hidden"===t[i].mode)e=t[i];else if("showing"===t[i].mode){e=t[i];break}var n=r.findTrackForTextTrack(e);r.subtitleTrack!==n&&r.setSubtitleTrack(n);}},r.registerListeners(),r}o(t,e);var r=t.prototype;return r.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,e.prototype.destroy.call(this);},r.registerListeners=function(){var e=this.hls;e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_PARSED,this.onManifestParsed,this),e.on(b.LEVEL_LOADING,this.onLevelLoading,this),e.on(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(b.ERROR,this.onError,this);},r.unregisterListeners=function(){var e=this.hls;e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_PARSED,this.onManifestParsed,this),e.off(b.LEVEL_LOADING,this.onLevelLoading,this),e.off(b.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(b.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(b.ERROR,this.onError,this);},r.onMediaAttached=function(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange));},r.pollTrackChange=function(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e);},r.onMediaDetaching=function(e,t){var r=this.media;if(r){var i=!!t.transferMedia;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||r.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,i||co(r.textTracks).forEach((function(e){ho(e);}));}},r.onManifestLoading=function(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0;},r.onManifestParsed=function(e,t){this.tracks=t.subtitleTracks;},r.onSubtitleTrackLoaded=function(e,t){var r=t.id,i=t.groupId,n=t.details,a=this.tracksInGroup[r];if(a&&a.groupId===i){var s=a.details;a.details=t.details,this.log("Subtitle track "+r+' "'+a.name+'" lang:'+a.lang+" group:"+i+" loaded ["+n.startSN+"-"+n.endSN+"]"),r===this.trackId&&this.playlistLoaded(r,t,s);}else this.warn("Subtitle track with id:"+r+" and group:"+i+" not found in active group "+(null==a?void 0:a.groupId));},r.onLevelLoading=function(e,t){this.switchLevel(t.level);},r.onLevelSwitching=function(e,t){this.switchLevel(t.level);},r.switchLevel=function(e){var t=this.hls.levels[e];if(t){var r=t.subtitleGroups||null,i=this.groupIds,n=this.currentTrack;if(!r||(null==i?void 0:i.length)!==(null==r?void 0:r.length)||null!=r&&r.some((function(e){return -1===(null==i?void 0:i.indexOf(e))}))){this.groupIds=r,this.trackId=-1,this.currentTrack=null;var a=this.tracks.filter((function(e){return !r||-1!==r.indexOf(e.groupId)}));if(a.length)this.selectDefaultTrack&&!a.some((function(e){return e.default}))&&(this.selectDefaultTrack=!1),a.forEach((function(e,t){e.id=t;}));else if(!n&&!this.tracksInGroup.length)return;this.tracksInGroup=a;var s=this.hls.config.subtitlePreference;if(!n&&s){this.selectDefaultTrack=!1;var o=ct(s,a);if(o>-1)n=a[o];else {var l=ct(s,this.tracks);n=this.tracks[l];}}var u=this.findTrackId(n);-1===u&&n&&(u=this.findTrackId(null));var d={subtitleTracks:a};this.log("Updating subtitle tracks, "+a.length+' track(s) found in "'+(null==r?void 0:r.join(","))+'" group-id'),this.hls.trigger(b.SUBTITLE_TRACKS_UPDATED,d),-1!==u&&-1===this.trackId&&this.setSubtitleTrack(u);}}},r.findTrackId=function(e){for(var t=this.tracksInGroup,r=this.selectDefaultTrack,i=0;i<t.length;i++){var n=t[i];if((!r||n.default)&&(r||e)&&(!e||gt(n,e)))return i}if(e){for(var a=0;a<t.length;a++){var s=t[a];if(Ta(e.attrs,s.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return a}for(var o=0;o<t.length;o++){var l=t[o];if(Ta(e.attrs,l.attrs,["LANGUAGE"]))return o}}return -1},r.findTrackForTextTrack=function(e){if(e)for(var t=this.tracksInGroup,r=0;r<t.length;r++)if(Sa(t[r],e))return r;return -1},r.onError=function(e,t){!t.fatal&&t.context&&(t.context.type!==C||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t));},r.setSubtitleOption=function(e){if(this.hls.config.subtitlePreference=e,e){if(-1===e.id)return this.setSubtitleTrack(-1),null;var t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){var r=this.currentTrack;if(r&&gt(e,r))return r;var i=ct(e,this.tracksInGroup);if(i>-1){var n=this.tracksInGroup[i];return this.setSubtitleTrack(i),n}if(r)return null;var a=ct(e,t);if(a>-1)return t[a]}}return null},r.loadPlaylist=function(t){e.prototype.loadPlaylist.call(this),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,t);},r.loadingPlaylist=function(t,r){e.prototype.loadingPlaylist.call(this,t,r);var i=t.id,n=t.groupId,a=this.getUrlWithDirectives(t.url,r),s=t.details,o=null==s?void 0:s.age;this.log("Loading subtitle "+i+' "'+t.name+'" lang:'+t.lang+" group:"+n+(void 0!==(null==r?void 0:r.msn)?" at sn "+r.msn+" part "+r.part:"")+(o&&s.live?" age "+o.toFixed(1)+(s.type&&" "+s.type||""):"")+" "+a),this.hls.trigger(b.SUBTITLE_TRACK_LOADING,{url:a,id:i,groupId:n,deliveryDirectives:r||null,track:t});},r.toggleTrackModes=function(){var e=this.media;if(e){var t,r=co(e.textTracks),i=this.currentTrack;if(i&&((t=r.filter((function(e){return Sa(i,e)}))[0])||this.warn('Unable to find subtitle TextTrack with name "'+i.name+'" and language "'+i.lang+'"')),[].slice.call(r).forEach((function(e){"disabled"!==e.mode&&e!==t&&(e.mode="disabled");})),t){var n=this.subtitleDisplay?"showing":"hidden";t.mode!==n&&(t.mode=n);}}},r.setSubtitleTrack=function(e){var t=this.tracksInGroup;if(this.media)if(e<-1||e>=t.length||!A(e))this.warn("Invalid subtitle track id: "+e);else {this.selectDefaultTrack=!1;var r=this.currentTrack,i=t[e]||null;if(this.trackId=e,this.currentTrack=i,this.toggleTrackModes(),i){var n=!!i.details&&!i.details.live;if(e!==this.trackId||i!==r||!n){this.log("Switching to subtitle-track "+e+(i?' "'+i.name+'" lang:'+i.lang+" group:"+i.groupId:""));var a=i.id,s=i.groupId,o=void 0===s?"":s,l=i.name,u=i.type,d=i.url;this.hls.trigger(b.SUBTITLE_TRACK_SWITCH,{id:a,groupId:o,name:l,type:u,url:d});var h=this.switchParams(i.url,null==r?void 0:r.details,i.details);this.loadPlaylist(h);}}else this.hls.trigger(b.SUBTITLE_TRACK_SWITCH,{id:e});}else this.queuedDefaultTrack=e;},i(t,[{key:"subtitleDisplay",get:function(){return this._subtitleDisplay},set:function(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes();}},{key:"allSubtitleTracks",get:function(){return this.tracks}},{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e);}}])}(ya),vo={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},mo=function(e){return String.fromCharCode(vo[e]||e)},po=15,yo=100,Eo={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},To={17:2,18:4,21:6,22:8,23:10,19:13,20:15},So={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Ao={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Lo=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],Io=function(){function e(){this.time=null,this.verboseLevel=0;}return e.prototype.log=function(e,t){if(this.verboseLevel>=e){var r="function"==typeof t?t():t;Y.log(this.time+" ["+e+"] "+r);}},e}(),Ro=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t},ko=function(){function e(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1;}var t=e.prototype;return t.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1;},t.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],r=0;r<t.length;r++){var i=t[r];e.hasOwnProperty(i)&&(this[i]=e[i]);}},t.isDefault=function(){return "white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},t.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},t.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash;},t.toString=function(){return "color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),bo=function(){function e(){this.uchar=" ",this.penState=new ko;}var t=e.prototype;return t.reset=function(){this.uchar=" ",this.penState.reset();},t.setChar=function(e,t){this.uchar=e,this.penState.copy(t);},t.setPenState=function(e){this.penState.copy(e);},t.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},t.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState);},t.isEmpty=function(){return " "===this.uchar&&this.penState.isDefault()},e}(),Do=function(){function e(e){this.chars=[],this.pos=0,this.currPenState=new ko,this.cueStartTime=null,this.logger=void 0;for(var t=0;t<yo;t++)this.chars.push(new bo);this.logger=e;}var t=e.prototype;return t.equals=function(e){for(var t=0;t<yo;t++)if(!this.chars[t].equals(e.chars[t]))return !1;return !0},t.copy=function(e){for(var t=0;t<yo;t++)this.chars[t].copy(e.chars[t]);},t.isEmpty=function(){for(var e=!0,t=0;t<yo;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},t.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>yo&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=yo);},t.moveCursor=function(e){var t=this.pos+e;if(e>1)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t);},t.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState);},t.insertChar=function(e){var t=this;e>=144&&this.backSpace();var r=mo(e);this.pos>=yo?this.logger.log(0,(function(){return "Cannot insert "+e.toString(16)+" ("+r+") at position "+t.pos+". Skipping it!"})):(this.chars[this.pos].setChar(r,this.currPenState),this.moveCursor(1));},t.clearFromPos=function(e){var t;for(t=e;t<yo;t++)this.chars[t].reset();},t.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset();},t.clearToEndOfRow=function(){this.clearFromPos(this.pos);},t.getTextString=function(){for(var e=[],t=!0,r=0;r<yo;r++){var i=this.chars[r].uchar;" "!==i&&(t=!1),e.push(i);}return t?"":e.join("")},t.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState);},e}(),_o=function(){function e(e){this.rows=[],this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(var t=0;t<po;t++)this.rows.push(new Do(e));this.logger=e;}var t=e.prototype;return t.reset=function(){for(var e=0;e<po;e++)this.rows[e].clear();this.currRow=14;},t.equals=function(e){for(var t=!0,r=0;r<po;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<po;t++)this.rows[t].copy(e.rows[t]);},t.isEmpty=function(){for(var e=!0,t=0;t<po;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},t.backSpace=function(){this.rows[this.currRow].backSpace();},t.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow();},t.insertChar=function(e){this.rows[this.currRow].insertChar(e);},t.setPen=function(e){this.rows[this.currRow].setPenStyles(e);},t.moveCursor=function(e){this.rows[this.currRow].moveCursor(e);},t.setCursor=function(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e);},t.setPAC=function(e){this.logger.log(2,(function(){return "pacData = "+ut(e)}));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var r=0;r<po;r++)this.rows[r].clear();var i=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){var a=n.rows[i].cueStartTime,s=this.logger.time;if(null!==a&&null!==s&&a<s)for(var o=0;o<this.nrRollUpRows;o++)this.rows[t-this.nrRollUpRows+o+1].copy(n.rows[i+o]);}}this.currRow=t;var l=this.rows[this.currRow];if(null!==e.indent){var u=e.indent,d=Math.max(u-1,0);l.setCursor(e.indent),e.color=l.chars[d].penState.foreground;}var h={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(h);},t.setBkgData=function(e){this.logger.log(2,(function(){return "bkgData = "+ut(e)})),this.backSpace(),this.setPen(e),this.insertChar(32);},t.setRollUpRows=function(e){this.nrRollUpRows=e;},t.rollUp=function(){var e=this;if(null!==this.nrRollUpRows){this.logger.log(1,(function(){return e.getDisplayText()}));var t=this.currRow+1-this.nrRollUpRows,r=this.rows.splice(t,1)[0];r.clear(),this.rows.splice(this.currRow,0,r),this.logger.log(2,"Rolling up");}else this.logger.log(3,"roll_up but nrRollUpRows not set yet");},t.getDisplayText=function(e){e=e||!1;for(var t=[],r="",i=-1,n=0;n<po;n++){var a=this.rows[n].getTextString();a&&(i=n+1,e?t.push("Row "+i+": '"+a+"'"):t.push(a.trim()));}return t.length>0&&(r=e?"["+t.join(" | ")+"]":t.join("\n")),r},t.getTextAndFormat=function(){return this.rows},e}(),Po=function(){function e(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new _o(r),this.nonDisplayedMemory=new _o(r),this.lastOutputScreen=new _o(r),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r;}var t=e.prototype;return t.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null;},t.getHandler=function(){return this.outputFilter},t.setHandler=function(e){this.outputFilter=e;},t.setPAC=function(e){this.writeScreen.setPAC(e);},t.setBkgData=function(e){this.writeScreen.setBkgData(e);},t.setMode=function(e){e!==this.mode&&(this.mode=e,this.logger.log(2,(function(){return "MODE="+e})),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e);},t.insertChars=function(e){for(var t=this,r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);var i=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,(function(){return i+": "+t.writeScreen.getDisplayText(!0)})),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,(function(){return "DISPLAYED: "+t.displayedMemory.getDisplayText(!0)})),this.outputDataUpdate());},t.ccRCL=function(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON");},t.ccBS=function(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate());},t.ccAOF=function(){},t.ccAON=function(){},t.ccDER=function(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate();},t.ccRU=function(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e);},t.ccFON=function(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0});},t.ccRDC=function(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON");},t.ccTR=function(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT");},t.ccRTD=function(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT");},t.ccEDM=function(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0);},t.ccCR=function(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0);},t.ccENM=function(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset();},t.ccEOC=function(){var e=this;if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,(function(){return "DISP: "+e.displayedMemory.getDisplayText()}));}this.outputDataUpdate(!0);},t.ccTO=function(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e);},t.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else {var r=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][r];}this.logger.log(2,"MIDROW: "+ut(t)),this.writeScreen.setPen(t);},t.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory));},t.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e));},e}(),Co=function(){function e(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory={a:null,b:null},this.logger=void 0;var i=this.logger=new Io;this.channels=[null,new Po(e,t,i),new Po(e+1,r,i)];}var t=e.prototype;return t.getHandler=function(e){return this.channels[e].getHandler()},t.setHandler=function(e,t){this.channels[e].setHandler(t);},t.addData=function(e,t){var r=this;this.logger.time=e;for(var i=function(e){var i=127&t[e],n=127&t[e+1],a=!1,s=null;if(0===i&&0===n)return 0;r.logger.log(3,(function(){return "["+Ro([t[e],t[e+1]])+"] -> ("+Ro([i,n])+")"}));var o=r.cmdHistory;if(i>=16&&i<=31){if(function(e,t,r){return r.a===e&&r.b===t}(i,n,o))return wo(null,null,o),r.logger.log(3,(function(){return "Repeated command ("+Ro([i,n])+") is dropped"})),0;wo(i,n,r.cmdHistory),(a=r.parseCmd(i,n))||(a=r.parseMidrow(i,n)),a||(a=r.parsePAC(i,n)),a||(a=r.parseBackgroundAttributes(i,n));}else wo(null,null,o);if(!a&&(s=r.parseChars(i,n))){var l=r.currentChannel;l&&l>0?r.channels[l].insertChars(s):r.logger.log(2,"No channel found yet. TEXT-MODE?");}a||s||r.logger.log(2,(function(){return "Couldn't parse cleaned data "+Ro([i,n])+" orig: "+Ro([t[e],t[e+1]])}));},n=0;n<t.length;n+=2)i(n);},t.parseCmd=function(e,t){if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=33&&t<=35))return !1;var r=20===e||21===e||23===e?1:2,i=this.channels[r];return 20===e||21===e||28===e||29===e?32===t?i.ccRCL():33===t?i.ccBS():34===t?i.ccAOF():35===t?i.ccAON():36===t?i.ccDER():37===t?i.ccRU(2):38===t?i.ccRU(3):39===t?i.ccRU(4):40===t?i.ccFON():41===t?i.ccRDC():42===t?i.ccTR():43===t?i.ccRTD():44===t?i.ccEDM():45===t?i.ccCR():46===t?i.ccENM():47===t&&i.ccEOC():i.ccTO(t-32),this.currentChannel=r,!0},t.parseMidrow=function(e,t){var r=0;if((17===e||25===e)&&t>=32&&t<=47){if((r=17===e?1:2)!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;var i=this.channels[r];return !!i&&(i.ccMIDROW(t),this.logger.log(3,(function(){return "MIDROW ("+Ro([e,t])+")"})),!0)}return !1},t.parsePAC=function(e,t){var r;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127||(16===e||24===e)&&t>=64&&t<=95))return !1;var i=e<=23?1:2;r=t>=64&&t<=95?1===i?Eo[e]:So[e]:1===i?To[e]:Ao[e];var n=this.channels[i];return !!n&&(n.setPAC(this.interpretPAC(r,t)),this.currentChannel=i,!0)},t.interpretPAC=function(e,t){var r,i={color:null,italics:!1,indent:null,underline:!1,row:e};return r=t>95?t-96:t-64,i.underline=1==(1&r),r<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((r-16)/2),i},t.parseChars=function(e,t){var r,i,n=null,a=null;return e>=25?(r=2,a=e-8):(r=1,a=e),a>=17&&a<=19?(i=17===a?t+80:18===a?t+112:t+144,this.logger.log(2,(function(){return "Special char '"+mo(i)+"' in channel "+r})),n=[i]):e>=32&&e<=127&&(n=0===t?[e]:[e,t]),n&&this.logger.log(3,(function(){return "Char codes =  "+Ro(n).join(",")})),n},t.parseBackgroundAttributes=function(e,t){var r;if(!((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47))return !1;var i={};16===e||24===e?(r=Math.floor((t-32)/2),i.background=Lo[r],t%2==1&&(i.background=i.background+"_semi")):45===t?i.background="transparent":(i.foreground="black",47===t&&(i.underline=!0));var n=e<=23?1:2;return this.channels[n].setBkgData(i),!0},t.reset=function(){for(var e=0;e<Object.keys(this.channels).length;e++){var t=this.channels[e];t&&t.reset();}wo(null,null,this.cmdHistory);},t.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++){var r=this.channels[t];r&&r.cueSplitAtTime(e);}},e}();function wo(e,t,r){r.a=e,r.b=t;}var Oo=function(){if(null!=Pr&&Pr.VTTCue)return self.VTTCue;var e=["","lr","rl"],t=["start","middle","end","left","right"];function r(e,t){if("string"!=typeof t)return !1;if(!Array.isArray(e))return !1;var r=t.toLowerCase();return !!~e.indexOf(r)&&r}function i(e){return r(t,e)}function n(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var s in a)e[s]=a[s];}return e}function a(t,a,s){var o=this,l={enumerable:!0};o.hasBeenReset=!1;var u="",d=!1,h=t,f=a,c=s,g=null,v="",m=!0,p="auto",y="start",E=50,T="middle",S=50,A="middle";Object.defineProperty(o,"id",n({},l,{get:function(){return u},set:function(e){u=""+e;}})),Object.defineProperty(o,"pauseOnExit",n({},l,{get:function(){return d},set:function(e){d=!!e;}})),Object.defineProperty(o,"startTime",n({},l,{get:function(){return h},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");h=e,this.hasBeenReset=!0;}})),Object.defineProperty(o,"endTime",n({},l,{get:function(){return f},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");f=e,this.hasBeenReset=!0;}})),Object.defineProperty(o,"text",n({},l,{get:function(){return c},set:function(e){c=""+e,this.hasBeenReset=!0;}})),Object.defineProperty(o,"region",n({},l,{get:function(){return g},set:function(e){g=e,this.hasBeenReset=!0;}})),Object.defineProperty(o,"vertical",n({},l,{get:function(){return v},set:function(t){var i=function(t){return r(e,t)}(t);if(!1===i)throw new SyntaxError("An invalid or illegal string was specified.");v=i,this.hasBeenReset=!0;}})),Object.defineProperty(o,"snapToLines",n({},l,{get:function(){return m},set:function(e){m=!!e,this.hasBeenReset=!0;}})),Object.defineProperty(o,"line",n({},l,{get:function(){return p},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");p=e,this.hasBeenReset=!0;}})),Object.defineProperty(o,"lineAlign",n({},l,{get:function(){return y},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");y=t,this.hasBeenReset=!0;}})),Object.defineProperty(o,"position",n({},l,{get:function(){return E},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");E=e,this.hasBeenReset=!0;}})),Object.defineProperty(o,"positionAlign",n({},l,{get:function(){return T},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");T=t,this.hasBeenReset=!0;}})),Object.defineProperty(o,"size",n({},l,{get:function(){return S},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");S=e,this.hasBeenReset=!0;}})),Object.defineProperty(o,"align",n({},l,{get:function(){return A},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");A=t,this.hasBeenReset=!0;}})),o.displayState=void 0;}return a.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},a}(),xo=function(){function e(){}return e.prototype.decode=function(e,t){if(!e)return "";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))},e}();function Mo(e){function t(e,t,r,i){return 3600*(0|e)+60*(0|t)+(0|r)+parseFloat(i||0)}var r=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return r?parseFloat(r[2])>59?t(r[2],r[3],0,r[4]):t(r[1],r[2],r[3],r[4]):null}var Fo=function(){function e(){this.values=Object.create(null);}var t=e.prototype;return t.set=function(e,t){this.get(e)||""===t||(this.values[e]=t);},t.get=function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},t.has=function(e){return e in this.values},t.alt=function(e,t,r){for(var i=0;i<r.length;++i)if(t===r[i]){this.set(e,t);break}},t.integer=function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10));},t.percent=function(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){var r=parseFloat(t);if(r>=0&&r<=100)return this.set(e,r),!0}return !1},e}();function No(e,t,r,i){var n=i?e.split(i):[e];for(var a in n)if("string"==typeof n[a]){var s=n[a].split(r);2===s.length&&t(s[0],s[1]);}}var Uo=new Oo(0,0,""),Bo="middle"===Uo.align?"middle":"center";function Go(e,t,r){var i=e;function n(){var t=Mo(e);if(null===t)throw new Error("Malformed timestamp: "+i);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function a(){e=e.replace(/^\s+/,"");}if(a(),t.startTime=n(),a(),"--\x3e"!==e.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);e=e.slice(3),a(),t.endTime=n(),a(),function(e,t){var i=new Fo;No(e,(function(e,t){var n;switch(e){case"region":for(var a=r.length-1;a>=0;a--)if(r[a].id===t){i.set(e,r[a].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":n=t.split(","),i.integer(e,n[0]),i.percent(e,n[0])&&i.set("snapToLines",!1),i.alt(e,n[0],["auto"]),2===n.length&&i.alt("lineAlign",n[1],["start",Bo,"end"]);break;case"position":n=t.split(","),i.percent(e,n[0]),2===n.length&&i.alt("positionAlign",n[1],["start",Bo,"end","line-left","line-right","auto"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start",Bo,"end","left","right"]);}}),/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical","");var n=i.get("line","auto");"auto"===n&&-1===Uo.line&&(n=-1),t.line=n,t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100),t.align=i.get("align",Bo);var a=i.get("position","auto");"auto"===a&&50===Uo.position&&(a="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=a;}(e,t);}function Ko(e){return e.replace(/<br(?: \/)?>/gi,"\n")}var Vo=function(){function e(){this.state="INITIAL",this.buffer="",this.decoder=new xo,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0;}var t=e.prototype;return t.parse=function(e){var t=this;function r(){var e=t.buffer,r=0;for(e=Ko(e);r<e.length&&"\r"!==e[r]&&"\n"!==e[r];)++r;var i=e.slice(0,r);return "\r"===e[r]&&++r,"\n"===e[r]&&++r,t.buffer=e.slice(r),i}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var i="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var n=(i=r()).match(/^()?WEBVTT([ \t].*)?$/);if(null==n||!n[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER";}for(var a=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:i=r(),t.state){case"HEADER":/:/.test(i)?No(i,(function(e,t){}),/:/):i||(t.state="ID");continue;case"NOTE":i||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){t.state="NOTE";break}if(!i)continue;if(t.cue=new Oo(0,0,""),t.state="CUE",-1===i.indexOf("--\x3e")){t.cue.id=i;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{Go(i,t.cue,t.regionList);}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var s=-1!==i.indexOf("--\x3e");if(!i||s&&(a=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=i;continue;case"BADCUE":i||(t.state="ID");}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE";}return this},t.flush=function(){var e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t);}return e.onflush&&e.onflush(),this},e}(),Ho=/\r\n|\n\r|\n|\r/g,Yo=function(e,t,r){return void 0===r&&(r=0),e.slice(r,r+t.length)===t};function Wo(e,t,r){return Ys(e.toString())+Ys(t.toString())+Ys(r)}function jo(e,t,r,i,n,a,s){var o,l,u,d=new Vo,h=q(new Uint8Array(e)).trim().replace(Ho,"\n").split("\n"),f=[],c=t?(o=t.baseTime,void 0===(l=t.timescale)&&(l=1),Vn(o,Kn,1/l)):0,g="00:00.000",v=0,m=0,p=!0;d.oncue=function(e){var a=r[i],s=r.ccOffset,o=(v-c)/9e4;if(null!=a&&a.new&&(void 0!==m?s=r.ccOffset=a.start:function(e,t,r){var i=e[t],n=e[i.prevCC];if(!n||!n.new&&i.new)return e.ccOffset=e.presentationOffset=i.start,void(i.new=!1);for(;null!=(a=n)&&a.new;){var a;e.ccOffset+=i.start-n.start,i.new=!1,n=e[(i=n).prevCC];}e.presentationOffset=r;}(r,i,o)),o){if(!t)return void(u=new Error("Missing initPTS for VTT MPEGTS"));s=o-r.presentationOffset;}var l=e.endTime-e.startTime,d=Qn(9e4*(e.startTime+s-m),9e4*n)/9e4;e.startTime=Math.max(d,0),e.endTime=Math.max(d+l,0);var h=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(h)),e.id||(e.id=Wo(e.startTime,e.endTime,h)),e.endTime>0&&f.push(e);},d.onparsingerror=function(e){u=e;},d.onflush=function(){u?s(u):a(f);},h.forEach((function(e){if(p){if(Yo(e,"X-TIMESTAMP-MAP=")){p=!1,e.slice(16).split(",").forEach((function(e){Yo(e,"LOCAL:")?g=e.slice(6):Yo(e,"MPEGTS:")&&(v=parseInt(e.slice(7)));}));try{m=function(e){var t=parseInt(e.slice(-3)),r=parseInt(e.slice(-6,-4)),i=parseInt(e.slice(-9,-7)),n=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!(A(t)&&A(r)&&A(i)&&A(n)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+e);return t+=1e3*r,(t+=6e4*i)+36e5*n}(g)/1e3;}catch(e){u=e;}return}""===e&&(p=!1);}d.parse(e+"\n");})),d.flush();}var qo="stpp.ttml.im1t",Xo=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Qo=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,zo={left:"start",center:"center",right:"end",start:"start",end:"end"};function $o(e,t,r,i){var n=ce(new Uint8Array(e),["mdat"]);if(0!==n.length){var s,o,l,u,d=n.map((function(e){return q(e)})),h=(s=t.baseTime,o=1,void 0===(l=t.timescale)&&(l=1),void 0===u&&(u=!1),Vn(s,o,1/l,u));try{d.forEach((function(e){return r(function(e,t){var r=(new DOMParser).parseFromString(e,"text/xml"),i=r.getElementsByTagName("tt")[0];if(!i)throw new Error("Invalid ttml");var n={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},s=Object.keys(n).reduce((function(e,t){return e[t]=i.getAttribute("ttp:"+t)||n[t],e}),{}),o="preserve"!==i.getAttribute("xml:space"),l=Jo(Zo(i,"styling","style")),u=Jo(Zo(i,"layout","region")),d=Zo(i,"body","[begin]");return [].map.call(d,(function(e){var r=el(e,o);if(!r||!e.hasAttribute("begin"))return null;var i=il(e.getAttribute("begin"),s),n=il(e.getAttribute("dur"),s),d=il(e.getAttribute("end"),s);if(null===i)throw rl(e);if(null===d){if(null===n)throw rl(e);d=i+n;}var h=new Oo(i-t,d-t,r);h.id=Wo(h.startTime,h.endTime,h.text);var f=function(e,t,r){var i="http://www.w3.org/ns/ttml#styling",n=null,a=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],s=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;return s&&r.hasOwnProperty(s)&&(n=r[s]),a.reduce((function(r,a){var s=tl(t,i,a)||tl(e,i,a)||tl(n,i,a);return s&&(r[a]=s),r}),{})}(u[e.getAttribute("region")],l[e.getAttribute("style")],l),c=f.textAlign;if(c){var g=zo[c];g&&(h.lineAlign=g),h.align=c;}return a(h,f),h})).filter((function(e){return null!==e}))}(e,h))}));}catch(e){i(e);}}else i(new Error("Could not parse IMSC1 mdat"));}function Zo(e,t,r){var i=e.getElementsByTagName(t)[0];return i?[].slice.call(i.querySelectorAll(r)):[]}function Jo(e){return e.reduce((function(e,t){var r=t.getAttribute("xml:id");return r&&(e[r]=t),e}),{})}function el(e,t){return [].slice.call(e.childNodes).reduce((function(e,r,i){var n;return "br"===r.nodeName&&i?e+"\n":null!=(n=r.childNodes)&&n.length?el(r,t):t?e+r.textContent.trim().replace(/\s+/g," "):e+r.textContent}),"")}function tl(e,t,r){return e&&e.hasAttributeNS(t,r)?e.getAttributeNS(t,r):null}function rl(e){return new Error("Could not parse ttml timestamp "+e)}function il(e,t){if(!e)return null;var r=Mo(e);return null===r&&(Xo.test(e)?r=function(e,t){var r=Xo.exec(e),i=(0|r[4])+(0|r[5])/t.subFrameRate;return 3600*(0|r[1])+60*(0|r[2])+(0|r[3])+i/t.frameRate}(e,t):Qo.test(e)&&(r=function(e,t){var r=Qo.exec(e),i=Number(r[1]);switch(r[2]){case"h":return 3600*i;case"m":return 60*i;case"ms":return 1e3*i;case"f":return i/t.frameRate;case"t":return i/t.tickRate}return i}(e,t))),r}var nl=function(){function e(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t;}var t=e.prototype;return t.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null);},t.newCue=function(e,t,r){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName);},t.reset=function(){this.cueRanges=[],this.startTime=null;},e}(),al=function(){function e(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(b.FRAG_LOADING,this.onFragLoading,this),e.on(b.FRAG_LOADED,this.onFragLoaded,this),e.on(b.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(b.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(b.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(b.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this);}var t=e.prototype;return t.destroy=function(){var e=this.hls;e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(b.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(b.FRAG_LOADING,this.onFragLoading,this),e.off(b.FRAG_LOADED,this.onFragLoaded,this),e.off(b.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(b.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(b.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(b.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0;},t.initCea608Parsers=function(){var e=new nl(this,"textTrack1"),t=new nl(this,"textTrack2"),r=new nl(this,"textTrack3"),i=new nl(this,"textTrack4");this.cea608Parser1=new Co(1,e,t),this.cea608Parser2=new Co(3,r,i);},t.addCues=function(e,t,r,i,n){for(var a,s,o,l,u=!1,d=n.length;d--;){var h=n[d],f=(a=h[0],s=h[1],o=t,l=r,Math.min(s,l)-Math.max(a,o));if(f>=0&&(h[0]=Math.min(h[0],t),h[1]=Math.max(h[1],r),u=!0,f/(r-t)>.5))return}if(u||n.push([t,r]),this.config.renderTextTracksNatively){var c=this.captionsTracks[e];this.Cues.newCue(c,t,r,i);}else {var g=this.Cues.newCue(null,t,r,i);this.hls.trigger(b.CUES_PARSED,{type:"captions",cues:g,track:e});}},t.onInitPtsFound=function(e,t){var r=this,i=t.frag,n=t.id,a=t.initPTS,s=t.timescale,o=t.trackId,l=this.unparsedVttFrags;n===w&&(this.initPTS[i.cc]={baseTime:a,timescale:s,trackId:o}),l.length&&(this.unparsedVttFrags=[],l.forEach((function(e){r.initPTS[e.frag.cc]?r.onFragLoaded(b.FRAG_LOADED,e):r.hls.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e.frag,error:new Error("Subtitle discontinuity domain does not match main")});})));},t.getExistingTrack=function(e,t){var r=this.media;if(r)for(var i=0;i<r.textTracks.length;i++){var n=r.textTracks[i];if(ol(n,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return n}return null},t.createCaptionsTrack=function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e);},t.createNativeTrack=function(e){if(!this.captionsTracks[e]){var t=this.captionsProperties,r=this.captionsTracks,i=this.media,n=t[e],a=n.label,s=n.languageCode,o=this.getExistingTrack(a,s);if(o)r[e]=o,ho(r[e]),lo(r[e],i);else {var l=this.createTextTrack("captions",a,s);l&&(l[e]=!0,r[e]=l);}}},t.createNonNativeTrack=function(e){if(!this.nonNativeCaptionsTracks[e]){var t=this.captionsProperties[e];if(t){var r={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(b.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]});}}},t.createTextTrack=function(e,t,r){var i=this.media;if(i)return i.addTextTrack(e,t,r)},t.onMediaAttaching=function(e,t){this.media=t.media,t.mediaSource||this._cleanTracks();},t.onMediaDetaching=function(e,t){var r=!!t.transferMedia;if(this.media=null,!r){var i=this.captionsTracks;Object.keys(i).forEach((function(e){ho(i[e]),delete i[e];})),this.nonNativeCaptionsTracks={};}},t.onManifestLoading=function(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset());},t._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var r=0;r<t.length;r++)ho(t[r]);}},t.onSubtitleTracksUpdated=function(e,t){var r=this,i=t.subtitleTracks||[],n=i.some((function(e){return e.textCodec===qo}));if(this.config.enableWebVTT||n&&this.config.enableIMSC1){if(Ea(this.tracks,i))return void(this.tracks=i);if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){var a=this.media,s=a?co(a.textTracks):null;if(this.tracks.forEach((function(e,t){var i;if(s){for(var n=null,a=0;a<s.length;a++)if(s[a]&&ol(s[a],e)){n=s[a],s[a]=null;break}n&&(i=n);}if(i)ho(i);else {var o=sl(e);(i=r.createTextTrack(o,e.name,e.lang))&&(i.mode="disabled");}i&&r.textTracks.push(i);})),null!=s&&s.length){var o=s.filter((function(e){return null!==e})).map((function(e){return e.label}));o.length&&this.hls.logger.warn("Media element contains unused subtitle tracks: "+o.join(", ")+". Replace media element for each source to clear TextTracks and captions menu.");}}else if(this.tracks.length){var l=this.tracks.map((function(e){return {label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}}));this.hls.trigger(b.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:l});}}},t.onManifestLoaded=function(e,t){var r=this;this.config.enableCEA708Captions&&t.captions&&t.captions.forEach((function(e){var t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(t){var i="textTrack"+t[1],n=r.captionsProperties[i];n&&(n.label=e.name,e.lang&&(n.languageCode=e.lang),n.media=e);}}));},t.closedCaptionsForLevel=function(e){var t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]},t.onFragLoading=function(e,t){if(this.enabled&&t.frag.type===w){var r,i,n=this.cea608Parser1,a=this.cea608Parser2,s=this.lastSn,o=t.frag,l=o.cc,u=o.sn,d=null!=(r=null==(i=t.part)?void 0:i.index)?r:-1;n&&a&&(u!==s+1||u===s&&d!==this.lastPartIndex+1||l!==this.lastCc)&&(n.reset(),a.reset()),this.lastCc=l,this.lastSn=u,this.lastPartIndex=d;}},t.onFragLoaded=function(e,t){var r=t.frag,i=t.payload;if(r.type===x)if(i.byteLength){var n=r.decryptdata,a="stats"in t;if(null==n||!n.encrypted||a){var s=this.tracks[r.level],o=this.vttCCs;o[r.cc]||(o[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),s&&s.textCodec===qo?this._parseIMSC1(r,i):this._parseVTTs(t);}}else this.hls.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")});},t._parseIMSC1=function(e,t){var r=this,i=this.hls;$o(t,this.initPTS[e.cc],(function(t){r._appendCues(t,e.level),i.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e});}),(function(t){i.logger.log("Failed to parse IMSC1: "+t),i.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t});}));},t._parseVTTs=function(e){var t,r=this,i=e.frag,n=e.payload,a=this.initPTS,s=this.unparsedVttFrags,o=a.length-1;if(a[i.cc]||-1!==o){var l=this.hls;jo(null!=(t=i.initSegment)&&t.data?Le(i.initSegment.data,new Uint8Array(n)).buffer:n,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,(function(e){r._appendCues(e,i.level),l.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i});}),(function(t){var a="Missing initPTS for VTT MPEGTS"===t.message;a?s.push(e):r._fallbackToIMSC1(i,n),l.logger.log("Failed to parse VTT cue: "+t),a&&o>i.cc||l.trigger(b.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:t});}));}else s.push(e);},t._fallbackToIMSC1=function(e,t){var r=this,i=this.tracks[e.level];i.textCodec||$o(t,this.initPTS[e.cc],(function(){i.textCodec=qo,r._parseIMSC1(e,t);}),(function(){i.textCodec="wvtt";}));},t._appendCues=function(e,t){var r=this.hls;if(this.config.renderTextTracksNatively){var i=this.textTracks[t];if(!i||"disabled"===i.mode)return;e.forEach((function(e){return uo(i,e)}));}else {var n=this.tracks[t];if(!n)return;var a=n.default?"default":"subtitles"+t;r.trigger(b.CUES_PARSED,{type:"subtitles",cues:e,track:a});}},t.onFragDecrypted=function(e,t){t.frag.type===x&&this.onFragLoaded(b.FRAG_LOADED,t);},t.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={};},t.onFragParsingUserdata=function(e,t){if(this.enabled&&this.config.enableCEA708Captions){var r=t.frag,i=t.samples;if(r.type!==w||"NONE"!==this.closedCaptionsForLevel(r))for(var n=0;n<i.length;n++){var a=i[n].bytes;if(a){this.cea608Parser1||this.initCea608Parsers();var s=this.extractCea608Data(a);this.cea608Parser1.addData(i[n].pts,s[0]),this.cea608Parser2.addData(i[n].pts,s[1]);}}}},t.onBufferFlushing=function(e,t){var r=t.startOffset,i=t.endOffset,n=t.endOffsetSubtitles,a=t.type,s=this.media;if(s&&!(s.currentTime<i)){if(!a||"video"===a){var o=this.captionsTracks;Object.keys(o).forEach((function(e){return fo(o[e],r,i)}));}if(this.config.renderTextTracksNatively&&0===r&&void 0!==n){var l=this.textTracks;Object.keys(l).forEach((function(e){return fo(l[e],r,n)}));}}},t.extractCea608Data=function(e){for(var t=[[],[]],r=31&e[0],i=2,n=0;n<r;n++){var a=e[i++],s=127&e[i++],o=127&e[i++];if((0!==s||0!==o)&&0!=(4&a)){var l=3&a;0!==l&&1!==l||(t[l].push(s),t[l].push(o));}}return t},e}();function sl(e){return e.characteristics&&/transcribes-spoken-dialog/gi.test(e.characteristics)&&/describes-music-and-sound/gi.test(e.characteristics)?"captions":"subtitles"}function ol(e,t){return !!e&&e.kind===sl(t)&&Sa(t,e)}var ll=/\s/,ul={newCue:function(e,t,r,i){for(var n,a,s,o,l,u=[],d=self.VTTCue||self.TextTrackCue,h=0;h<i.rows.length;h++)if(s=!0,o=0,l="",!(n=i.rows[h]).isEmpty()){for(var f,c=0;c<n.chars.length;c++)ll.test(n.chars[c].uchar)&&s?o++:(l+=n.chars[c].uchar,s=!1);n.cueStartTime=t,t===r&&(r+=1e-4),o>=16?o--:o++;var g=Ko(l.trim()),v=Wo(t,r,g);null!=e&&null!=(f=e.cues)&&f.getCueById(v)||((a=new d(t,r,g)).id=v,a.line=h+1,a.align="left",a.position=10+Math.min(80,10*Math.floor(8*o/32)),u.push(a));}return e&&u.length&&(u.sort((function(e,t){return "auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line})),u.forEach((function(t){return uo(e,t)}))),u}},dl=/(\d+)-(\d+)\/(\d+)/,hl=function(){function e(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||fl,this.controller=new self.AbortController,this.stats=new z;}var t=e.prototype;return t.destroy=function(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null;},t.abortInternal=function(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort());},t.abort=function(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response);},t.load=function(e,t,r){var i=this,n=this.stats;if(n.loading.start)throw new Error("Loader can only be used once.");n.loading.start=self.performance.now();var s=function(e,t){var r={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(a({},e.headers))};return e.rangeEnd&&r.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)),r}(e,this.controller.signal),o="arraybuffer"===e.responseType,l=o?"byteLength":"length",u=t.loadPolicy,d=u.maxTimeToFirstByteMs,h=u.maxLoadTimeMs;this.context=e,this.config=t,this.callbacks=r,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=d&&A(d)?d:h,this.requestTimeout=self.setTimeout((function(){i.callbacks&&(i.abortInternal(),i.callbacks.onTimeout(n,e,i.response));}),t.timeout),(aa(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then((function(r){var a;i.response=i.loader=r;var s=Math.max(self.performance.now(),n.loading.start);if(self.clearTimeout(i.requestTimeout),t.timeout=h,i.requestTimeout=self.setTimeout((function(){i.callbacks&&(i.abortInternal(),i.callbacks.onTimeout(n,e,i.response));}),h-(s-n.loading.start)),!r.ok){var l=r.status,u=r.statusText;throw new cl(u||"fetch, bad network response",l,r)}n.loading.first=s,n.total=function(e){var t=e.get("Content-Range");if(t){var r=function(e){var t=dl.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}(t);if(A(r))return r}var i=e.get("Content-Length");if(i)return parseInt(i)}(r.headers)||n.total;var d=null==(a=i.callbacks)?void 0:a.onProgress;return d&&A(t.highWaterMark)?i.loadProgressively(r,n,e,t.highWaterMark,d):o?r.arrayBuffer():"json"===e.responseType?r.json():r.text()})).then((function(r){var a,s,o=i.response;if(!o)throw new Error("loader destroyed");self.clearTimeout(i.requestTimeout),n.loading.end=Math.max(self.performance.now(),n.loading.first);var u=r[l];u&&(n.loaded=n.total=u);var d={url:o.url,data:r,code:o.status},h=null==(a=i.callbacks)?void 0:a.onProgress;h&&!A(t.highWaterMark)&&h(n,e,r,o),null==(s=i.callbacks)||s.onSuccess(d,n,e,o);})).catch((function(t){var r;if(self.clearTimeout(i.requestTimeout),!n.aborted){var a=t&&t.code||0,s=t?t.message:null;null==(r=i.callbacks)||r.onError({code:a,text:s},e,t?t.details:null,n);}}));},t.getCacheAge=function(){var e=null;if(this.response){var t=this.response.headers.get("age");e=t?parseFloat(t):null;}return e},t.getResponseHeader=function(e){return this.response?this.response.headers.get(e):null},t.loadProgressively=function(e,t,r,i,n){void 0===i&&(i=0);var a=new wi,s=e.body.getReader(),o=function(){return s.read().then((function(s){if(s.done)return a.dataLength&&n(t,r,a.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));var l=s.value,u=l.length;return t.loaded+=u,u<i||a.dataLength?(a.push(l),a.dataLength>=i&&n(t,r,a.flush().buffer,e)):n(t,r,l.buffer,e),o()})).catch((function(){return Promise.reject()}))};return o()},e}();function fl(e,t){return new self.Request(e.url,t)}var cl=function(e){function t(t,r,i){var n;return (n=e.call(this,t)||this).code=void 0,n.details=void 0,n.code=r,n.details=i,n}return o(t,e),t}(c(Error)),gl=/^age:\s*[\d.]+\s*$/im,vl=function(){function e(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new z,this.retryDelay=0;}var t=e.prototype;return t.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null;},t.abortInternal=function(){var e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()));},t.abort=function(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader);},t.load=function(e,t,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=r,this.loadInternal();},t.loadInternal=function(){var e=this,t=this.config,r=this.context;if(t&&r){var i=this.loader=new self.XMLHttpRequest,n=this.stats;n.loading.first=0,n.loaded=0,n.aborted=!1;var a=this.xhrSetup;a?Promise.resolve().then((function(){if(e.loader===i&&!e.stats.aborted)return a(i,r.url)})).catch((function(t){if(e.loader===i&&!e.stats.aborted)return i.open("GET",r.url,!0),a(i,r.url)})).then((function(){e.loader!==i||e.stats.aborted||e.openAndSendXhr(i,r,t);})).catch((function(t){var a;null==(a=e.callbacks)||a.onError({code:i.status,text:t.message},r,i,n);})):this.openAndSendXhr(i,r,t);}},t.openAndSendXhr=function(e,t,r){e.readyState||e.open("GET",t.url,!0);var i=t.headers,n=r.loadPolicy,a=n.maxTimeToFirstByteMs,s=n.maxLoadTimeMs;if(i)for(var o in i)e.setRequestHeader(o,i[o]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),r.timeout=a&&A(a)?a:s,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send();},t.readystatechange=function(){var e=this.context,t=this.loader,r=this.stats;if(e&&t){var i=t.readyState,n=this.config;if(!r.aborted&&i>=2&&(0===r.loading.first&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),n.timeout!==n.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),n.timeout=n.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),4===i)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;var a=t.status,s="text"===t.responseType?t.responseText:null;if(a>=200&&a<300){var o=null!=s?s:t.response;if(null!=o){var l,u;r.loading.end=Math.max(self.performance.now(),r.loading.first);var d="arraybuffer"===t.responseType?o.byteLength:o.length;r.loaded=r.total=d,r.bwEstimate=8e3*r.total/(r.loading.end-r.loading.first);var h=null==(l=this.callbacks)?void 0:l.onProgress;h&&h(r,e,o,t);var f={url:t.responseURL,data:o,code:a};return void(null==(u=this.callbacks)||u.onSuccess(f,r,e,t))}}var c,g=n.loadPolicy.errorRetry;Pt(g,r.retry,!1,{url:e.url,data:void 0,code:a})?this.retry(g):(Y.error(a+" while loading "+e.url),null==(c=this.callbacks)||c.onError({code:a,text:t.statusText},e,t,r));}}},t.loadtimeout=function(){if(this.config){var e=this.config.loadPolicy.timeoutRetry;if(Pt(e,this.stats.retry,!0))this.retry(e);else {var t;Y.warn("timeout while loading "+(null==(t=this.context)?void 0:t.url));var r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader));}}},t.retry=function(e){var t=this.context,r=this.stats;this.retryDelay=Dt(e,r.retry),r.retry++,Y.warn((status?"HTTP Status "+status:"Timeout")+" while loading "+(null==t?void 0:t.url)+", retrying "+r.retry+"/"+e.maxNumRetry+" in "+this.retryDelay+"ms"),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay);},t.loadprogress=function(e){var t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total);},t.getCacheAge=function(){var e=null;if(this.loader&&gl.test(this.loader.getAllResponseHeaders())){var t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null;}return e},t.getResponseHeader=function(e){return this.loader&&new RegExp("^"+e+":\\s*[\\d.]+\\s*$","im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null},e}(),ml=d(d({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:6e7,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:vl,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:yt,bufferController:ba,capLevelController:Pa,errorController:Gt,fpsController:Hs,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Gr,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:ul,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:so,subtitleTrackController:go,timelineController:al,audioStreamController:pa,audioTrackController:Aa,emeController:Us,cmcdController:xs,contentSteeringController:Ms,interstitialsController:ao});function pl(e){return e&&"object"==typeof e?Array.isArray(e)?e.map(pl):Object.keys(e).reduce((function(t,r){return t[r]=pl(e[r]),t}),{}):e}function yl(e,t){var r=e.loader;r!==hl&&r!==vl?(t.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1):function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return !1}()&&(e.loader=hl,e.progressive=!0,e.enableSoftwareAES=!0,t.log("[config]: Progressive streaming enabled, using FetchLoader"));}var El=function(e){function t(t,r){var i;return (i=e.call(this,"gap-controller",t.logger)||this).hls=void 0,i.fragmentTracker=void 0,i.media=null,i.mediaSource=void 0,i.nudgeRetry=0,i.stallReported=!1,i.stalled=null,i.moved=!1,i.seeking=!1,i.buffered={},i.lastCurrentTime=0,i.ended=0,i.waiting=0,i.onMediaPlaying=function(){i.ended=0,i.waiting=0;},i.onMediaWaiting=function(){var e;null!=(e=i.media)&&e.seeking||(i.waiting=self.performance.now(),i.tick());},i.onMediaEnded=function(){var e;i.hls&&(i.ended=(null==(e=i.media)?void 0:e.currentTime)||1,i.hls.trigger(b.MEDIA_ENDED,{stalled:!1}));},i.hls=t,i.fragmentTracker=r,i.registerListeners(),i}o(t,e);var r=t.prototype;return r.registerListeners=function(){var e=this.hls;e&&(e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.BUFFER_APPENDED,this.onBufferAppended,this));},r.unregisterListeners=function(){var e=this.hls;e&&(e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.BUFFER_APPENDED,this.onBufferAppended,this));},r.destroy=function(){e.prototype.destroy.call(this),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0;},r.onMediaAttached=function(e,t){this.setInterval(100),this.mediaSource=t.mediaSource;var r=this.media=t.media;ki(r,"playing",this.onMediaPlaying),ki(r,"waiting",this.onMediaWaiting),ki(r,"ended",this.onMediaEnded);},r.onMediaDetaching=function(e,t){this.clearInterval();var r=this.media;r&&(bi(r,"playing",this.onMediaPlaying),bi(r,"waiting",this.onMediaWaiting),bi(r,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0;},r.onBufferAppended=function(e,t){this.buffered=t.timeRanges;},r.tick=function(){var e;if(null!=(e=this.media)&&e.readyState&&this.hasBuffered){var t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t;}},r.poll=function(e,t){var r,i,n=null==(r=this.hls)?void 0:r.config;if(n){var a=this.media;if(a){var s=a.seeking,o=this.seeking&&!s,l=!this.seeking&&s,u=a.paused&&!s||a.ended||0===a.playbackRate;if(this.seeking=s,e!==t)return t&&(this.ended=0),this.moved=!0,s||(this.nudgeRetry=0,n.nudgeOnVideoHole&&!u&&e>t&&this.nudgeOnVideoHole(e,t)),void(0===this.waiting&&this.stallResolved(e));if(l||o)o&&this.stallResolved(e);else {if(u)return this.nudgeRetry=0,this.stallResolved(e),void(!this.ended&&a.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(b.MEDIA_ENDED,{stalled:!1})));if(dr.getBuffered(a).length){var d=dr.bufferInfo(a,e,0),h=d.nextStart||0,f=this.fragmentTracker;if(s&&f&&this.hls){var c=Tl(this.hls.inFlightFragments,e),g=d.len>2,v=!h||c||h-e>2&&!f.getPartialFragment(e);if(g||v)return;this.moved=!1;}var m=null==(i=this.hls)?void 0:i.latestLevelDetails;if(!this.moved&&null!==this.stalled&&f){if(!(d.len>0||h))return;var p=Math.max(h,d.start||0)-e,y=null!=m&&m.live?2*m.targetduration:2,E=Al(e,f);if(p>0&&(p<=y||E))return void(a.paused||this._trySkipBufferHole(E))}var T=n.detectStallWithCurrentTimeMs,S=self.performance.now(),A=this.waiting,L=this.stalled;if(null===L){if(!(A>0&&S-A<T))return void(this.stalled=S);L=this.stalled=A;}var I=S-L;if(!s&&(I>=T||A)&&this.hls){var R;if("ended"===(null==(R=this.mediaSource)?void 0:R.readyState)&&(null==m||!m.live)&&Math.abs(e-((null==m?void 0:m.edge)||0))<1){if(this.ended)return;return this.ended=e||1,void this.hls.trigger(b.MEDIA_ENDED,{stalled:!0})}if(this._reportStall(d),!this.media||!this.hls)return}var k=dr.bufferInfo(a,e,n.maxBufferHole);this._tryFixBufferStall(k,I,e);}else this.nudgeRetry=0;}}}},r.stallResolved=function(e){var t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){var r=self.performance.now()-t;this.log("playback not stuck anymore @"+e+", after "+Math.round(r)+"ms"),this.stallReported=!1,this.waiting=0,this.hls.trigger(b.STALL_RESOLVED,{});}},r.nudgeOnVideoHole=function(e,t){var r,i=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&null!=(r=this.buffered.audio)&&r.length&&i&&i.length>1&&e>i.end(0)){var n=dr.bufferedInfo(dr.timeRangesToArray(this.buffered.audio),e,0);if(n.len>1&&t>=n.start){var a=dr.timeRangesToArray(i),s=dr.bufferedInfo(a,t,0).bufferedIndex;if(s>-1&&s<a.length-1){var o=dr.bufferedInfo(a,e,0).bufferedIndex,l=a[s].end,u=a[s+1].start;if((-1===o||o>s)&&u-l<1&&e-l<2){var d=new Error("nudging playhead to flush pipeline after video hole. currentTime: "+e+" hole: "+l+" -> "+u+" buffered index: "+o);this.warn(d.message),this.media.currentTime+=1e-6;var h=Al(e,this.fragmentTracker);h&&"fragment"in h?h=h.fragment:h||(h=void 0);var f=dr.bufferInfo(this.media,e,0);this.hls.trigger(b.ERROR,{type:R.MEDIA_ERROR,details:k.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:d,reason:d.message,frag:h,buffer:f.len,bufferInfo:f});}}}}},r._tryFixBufferStall=function(e,t,r){var i,n,a=this.fragmentTracker,s=this.media,o=null==(i=this.hls)?void 0:i.config;if(s&&a&&o){var l=null==(n=this.hls)?void 0:n.latestLevelDetails,u=Al(r,a);if((u||null!=l&&l.live&&r<l.fragmentStart)&&(this._trySkipBufferHole(u)||!this.media))return;var d=e.buffered,h=this.adjacentTraversal(e,r);(d&&d.length>1&&e.len>o.maxBufferHole||e.nextStart&&(e.nextStart-r<o.maxBufferHole||h))&&(t>1e3*o.highBufferWatchdogPeriod||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e));}},r.adjacentTraversal=function(e,t){var r=this.fragmentTracker,i=e.nextStart;if(r&&i){var n=r.getFragAtPos(t,w),a=r.getFragAtPos(i,w);if(n&&a)return a.sn-n.sn<2}return !1},r._reportStall=function(e){var t=this.hls,r=this.media,i=this.stallReported,n=this.stalled;if(!i&&null!==n&&r&&t){this.stallReported=!0;var a=new Error("Playback stalling at @"+r.currentTime+" due to low buffer ("+ut(e)+")");this.warn(a.message),t.trigger(b.ERROR,{type:R.MEDIA_ERROR,details:k.BUFFER_STALLED_ERROR,fatal:!1,error:a,buffer:e.len,bufferInfo:e,stalled:{start:n}});}},r._trySkipBufferHole=function(e){var t,r=this.fragmentTracker,i=this.media,n=null==(t=this.hls)?void 0:t.config;if(!i||!r||!n)return 0;var a=i.currentTime,s=dr.bufferInfo(i,a,0),o=a<s.start?s.start:s.nextStart;if(o&&this.hls){var l=s.len<=n.maxBufferHole,u=s.len>0&&s.len<1&&i.readyState<3,d=o-a;if(d>0&&(l||u)){if(d>n.maxBufferHole){var h=!1;if(0===a){var f=r.getAppendedFrag(0,w);f&&o<f.end&&(h=!0);}if(!h&&e){var c;if(null==(c=this.hls.loadLevelObj)||!c.details)return 0;if(Tl(this.hls.inFlightFragments,o))return 0;for(var g=!1,v=e.end;v<o;){var m=Al(v,r);if(!m){g=!0;break}v+=m.duration;}if(g)return 0}}var p=Math.max(o+.05,a+.1);if(this.warn("skipping hole, adjusting currentTime from "+a+" to "+p),this.moved=!0,i.currentTime=p,null==e||!e.gap){var y=new Error("fragment loaded with buffer holes, seeking from "+a+" to "+p),E={type:R.MEDIA_ERROR,details:k.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:y,reason:y.message,buffer:s.len,bufferInfo:s};e&&("fragment"in e?E.part=e:E.frag=e),this.hls.trigger(b.ERROR,E);}return p}}return 0},r._tryNudgeBuffer=function(e){var t=this.hls,r=this.media,i=this.nudgeRetry,n=null==t?void 0:t.config;if(!r||!n)return 0;var a=r.currentTime;if(this.nudgeRetry++,i<n.nudgeMaxRetry){var s=a+(i+1)*n.nudgeOffset,o=new Error("Nudging 'currentTime' from "+a+" to "+s);this.warn(o.message),r.currentTime=s,t.trigger(b.ERROR,{type:R.MEDIA_ERROR,details:k.BUFFER_NUDGE_ON_STALL,error:o,fatal:!1,buffer:e.len,bufferInfo:e});}else {var l=new Error("Playhead still not moving while enough data buffered @"+a+" after "+n.nudgeMaxRetry+" nudges");this.error(l.message),t.trigger(b.ERROR,{type:R.MEDIA_ERROR,details:k.BUFFER_STALLED_ERROR,error:l,fatal:!0,buffer:e.len,bufferInfo:e});}},i(t,[{key:"hasBuffered",get:function(){return Object.keys(this.buffered).length>0}}])}(or);function Tl(e,t){var r=Sl(e.main);if(r&&r.start<=t)return r;var i=Sl(e.audio);return i&&i.start<=t?i:null}function Sl(e){if(!e)return null;switch(e.state){case _i.IDLE:case _i.STOPPED:case _i.ENDED:case _i.ERROR:return null}return e.frag}function Al(e,t){return t.getAppendedFrag(e,w)||t.getPartialFragment(e)}function Ll(){if("undefined"!=typeof self)return self.VTTCue||self.TextTrackCue}function Il(e,t,r,i,n){var a=new e(t,r,"");try{a.value=i,n&&(a.type=n);}catch(s){a=new e(t,r,ut(n?d({type:n},i):i));}return a}var Rl=function(){var e=Ll();try{e&&new e(0,Number.POSITIVE_INFINITY,"");}catch(e){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY}(),kl=function(){function e(e){var t=this;this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=function(){t.hls&&t.hls.trigger(b.EVENT_CUE_ENTER,{});},this.hls=e,this._registerListeners();}var t=e.prototype;return t.destroy=function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null;},t._registerListeners=function(){var e=this.hls;e&&(e.on(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(b.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this));},t._unregisterListeners=function(){var e=this.hls;e&&(e.off(b.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(b.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(b.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this));},t.onMediaAttaching=function(e,t){var r;this.media=t.media,!1===(null==(r=t.overrides)?void 0:r.cueRemoval)&&(this.removeCues=!1);},t.onMediaAttached=function(){var e,t=null==(e=this.hls)?void 0:e.latestLevelDetails;t&&this.updateDateRangeCues(t);},t.onMediaDetaching=function(e,t){this.media=null,t.transferMedia||(this.id3Track&&(this.removeCues&&ho(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={});},t.onManifestLoading=function(){this.dateRangeCuesAppended={};},t.createTrack=function(e){var t=this.getID3Track(e.textTracks);return t.mode="hidden",t},t.getID3Track=function(e){if(this.media){for(var t=0;t<e.length;t++){var r=e[t];if("metadata"===r.kind&&"id3"===r.label)return lo(r,this.media),r}return this.media.addTextTrack("metadata","id3")}},t.onFragParsingMetadata=function(e,t){if(this.media&&this.hls){var r=this.hls.config,i=r.enableEmsgMetadataCues,n=r.enableID3MetadataCues;if(i||n){var a=t.samples;this.id3Track||(this.id3Track=this.createTrack(this.media));var s=Ll();if(s)for(var o=0;o<a.length;o++){var l=a[o].type;if((l!==rn.emsg||i)&&n){var u=Zi(a[o].data),d=a[o].pts,h=d+a[o].duration;h>Rl&&(h=Rl),h-d<=0&&(h=d+.25);for(var f=0;f<u.length;f++){var c=u[f];if(!Ji(c)){this.updateId3CueEnds(d,l);var g=Il(s,d,h,c,l);g&&this.id3Track.addCue(g);}}}}}}},t.updateId3CueEnds=function(e,t){var r,i=null==(r=this.id3Track)?void 0:r.cues;if(i)for(var n=i.length;n--;){var a=i[n];a.type===t&&a.startTime<e&&a.endTime===Rl&&(a.endTime=e);}},t.onBufferFlushing=function(e,t){var r=t.startOffset,i=t.endOffset,n=t.type,a=this.id3Track,s=this.hls;if(s){var o=s.config,l=o.enableEmsgMetadataCues,u=o.enableID3MetadataCues;a&&(l||u)&&fo(a,r,i,"audio"===n?function(e){return e.type===rn.audioId3&&u}:"video"===n?function(e){return e.type===rn.emsg&&l}:function(e){return e.type===rn.audioId3&&u||e.type===rn.emsg&&l});}},t.onLevelUpdated=function(e,t){var r=t.details;this.updateDateRangeCues(r,!0);},t.onLevelPtsUpdated=function(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details);},t.updateDateRangeCues=function(e,t){var r=this;if(this.hls&&this.media){var i=this.hls.config,n=i.assetPlayerId,a=i.timelineOffset,s=i.enableDateRangeMetadataCues,o=i.interstitialsController;if(s){var l=Ll();if(n&&a&&!o){var u=e.fragmentStart,d=e.fragmentEnd,h=this.assetCue;h?(h.startTime=u,h.endTime=d):l&&(h=this.assetCue=Il(l,u,d,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"))&&(h.id=n,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(h),h.addEventListener("enter",this.onEventCueEnter));}if(e.hasProgramDateTime){var f,c=this.id3Track,g=e.dateRanges,v=Object.keys(g),m=this.dateRangeCuesAppended;if(c&&t)if(null!=(f=c.cues)&&f.length)for(var p=Object.keys(m).filter((function(e){return !v.includes(e)})),y=function(){var e,t=p[E],i=null==(e=m[t])?void 0:e.cues;delete m[t],i&&Object.keys(i).forEach((function(e){var t=i[e];if(t){t.removeEventListener("enter",r.onEventCueEnter);try{c.removeCue(t);}catch(e){}}}));},E=p.length;E--;)y();else m=this.dateRangeCuesAppended={};var T=e.fragments[e.fragments.length-1];if(0!==v.length&&A(null==T?void 0:T.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var S=function(){var e=v[L],t=g[e],i=t.startTime,n=m[e],a=(null==n?void 0:n.cues)||{},s=(null==n?void 0:n.durationKnown)||!1,u=Rl,d=t.duration;if(t.endDate&&null!==d)u=i+d,s=!0;else if(t.endOnNext&&!s){var h=v.reduce((function(e,r){if(r!==t.id){var i=g[r];if(i.class===t.class&&i.startDate>t.startDate&&(!e||t.startDate<e.startDate))return i}return e}),null);h&&(u=h.startTime,s=!0);}for(var f,c=Object.keys(t.attr),p=0;p<c.length;p++){var y=c[p];if("ID"!==(f=y)&&"CLASS"!==f&&"CUE"!==f&&"START-DATE"!==f&&"DURATION"!==f&&"END-DATE"!==f&&"END-ON-NEXT"!==f){var E=a[y];if(E)!s||null!=n&&n.durationKnown?Math.abs(E.startTime-i)>.01&&(E.startTime=i,E.endTime=u):E.endTime=u;else if(l){var T=t.attr[y];Er(y)&&(T=Q(T));var S=Il(l,i,u,{key:y,data:T},rn.dateRange);S&&(S.id=e,r.id3Track.addCue(S),a[y]=S,o&&("X-ASSET-LIST"!==y&&"X-ASSET-URL"!==y||S.addEventListener("enter",r.onEventCueEnter)));}}}m[e]={cues:a,dateRange:t,durationKnown:s};},L=0;L<v.length;L++)S();}}}}},e}(),bl=function(){function e(e){var t=this;this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=function(){var e=t.media,r=t.levelDetails;if(e&&r){t.currentTime=e.currentTime;var i=t.computeLatency();if(null!==i){t._latency=i;var n=t.config,a=n.lowLatencyMode,s=n.maxLiveSyncPlaybackRate;if(a&&1!==s&&r.live){var o=t.targetLatency;if(null!==o){var l=i-o;if(l<Math.min(t.maxLatency,o+r.targetduration)&&l>.05&&t.forwardBufferLength>1){var u=Math.min(2,Math.max(1,s)),d=Math.round(2/(1+Math.exp(-.75*l-t.edgeStalled))*20)/20,h=Math.min(u,Math.max(1,d));t.changeMediaPlaybackRate(e,h);}else 1!==e.playbackRate&&0!==e.playbackRate&&t.changeMediaPlaybackRate(e,1);}}}}},this.hls=e,this.config=e.config,this.registerListeners();}var t=e.prototype;return t.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null;},t.registerListeners=function(){var e=this.hls;e&&(e.on(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(b.ERROR,this.onError,this));},t.unregisterListeners=function(){var e=this.hls;e&&(e.off(b.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(b.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(b.ERROR,this.onError,this));},t.onMediaAttached=function(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate);},t.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null);},t.onManifestLoading=function(){this._latency=null,this.stallCount=0;},t.onLevelUpdated=function(e,t){var r=t.details;r.advanced&&this.onTimeupdate(),!r.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate);},t.onError=function(e,t){var r;t.details===k.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&null!=(r=this.levelDetails)&&r.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"));},t.changeMediaPlaybackRate=function(e,t){var r,i;e.playbackRate!==t&&(null==(r=this.hls)||r.logger.debug("[latency-controller]: latency="+this.latency.toFixed(3)+", targetLatency="+(null==(i=this.targetLatency)?void 0:i.toFixed(3))+", forwardBufferLength="+this.forwardBufferLength.toFixed(3)+": adjusting playback rate from "+e.playbackRate+" to "+t),e.playbackRate=t);},t.estimateLiveEdge=function(){var e=this.levelDetails;return null===e?null:e.edge+e.age},t.computeLatency=function(){var e=this.estimateLiveEdge();return null===e?null:e-this.currentTime},i(e,[{key:"levelDetails",get:function(){var e;return (null==(e=this.hls)?void 0:e.latestLevelDetails)||null}},{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var e=this.config;if(void 0!==e.liveMaxLatencyDuration)return e.liveMaxLatencyDuration;var t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}},{key:"targetLatency",get:function(){var e=this.levelDetails;if(null===e||null===this.hls)return null;var t=e.holdBack,r=e.partHoldBack,i=e.targetduration,n=this.config,a=n.liveSyncDuration,s=n.liveSyncDurationCount,o=n.lowLatencyMode,l=this.hls.userConfig,u=o&&r||t;(this._targetLatencyUpdated||l.liveSyncDuration||l.liveSyncDurationCount||0===u)&&(u=void 0!==a?a:s*i);var d=i;return u+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,d)},set:function(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0;}},{key:"liveSyncPosition",get:function(){var e=this.estimateLiveEdge(),t=this.targetLatency;if(null===e||null===t)return null;var r=this.levelDetails;if(null===r)return null;var i=r.edge,n=e-t-this.edgeStalled,a=i-r.totalduration,s=i-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(a,n),s)}},{key:"drift",get:function(){var e=this.levelDetails;return null===e?1:e.drift}},{key:"edgeStalled",get:function(){var e=this.levelDetails;if(null===e)return 0;var t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}},{key:"forwardBufferLength",get:function(){var e=this.media,t=this.levelDetails;if(!e||!t)return 0;var r=e.buffered.length;return (r?e.buffered.end(r-1):t.edge)-this.currentTime}}])}(),Dl=function(e){function t(t,r){var i;return (i=e.call(this,t,"level-controller")||this)._levels=[],i._firstLevel=-1,i._maxAutoLevel=-1,i._startLevel=void 0,i.currentLevel=null,i.currentLevelIndex=-1,i.manualLevelIndex=-1,i.steering=void 0,i.onParsedComplete=void 0,i.steering=r,i._registerListeners(),i}o(t,e);var r=t.prototype;return r._registerListeners=function(){var e=this.hls;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(b.LEVEL_LOADED,this.onLevelLoaded,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(b.FRAG_BUFFERED,this.onFragBuffered,this),e.on(b.ERROR,this.onError,this);},r._unregisterListeners=function(){var e=this.hls;e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(b.LEVEL_LOADED,this.onLevelLoaded,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(b.FRAG_BUFFERED,this.onFragBuffered,this),e.off(b.ERROR,this.onError,this);},r.destroy=function(){this._unregisterListeners(),this.steering=null,this.resetLevels(),e.prototype.destroy.call(this);},r.stopLoad=function(){this._levels.forEach((function(e){e.loadError=0,e.fragmentError=0;})),e.prototype.stopLoad.call(this);},r.resetLevels=function(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1;},r.onManifestLoading=function(e,t){this.resetLevels();},r.onManifestLoaded=function(e,t){var r=this,i=this.hls.config.preferManagedMediaSource,n=[],a={},s={},o=!1,l=!1,u=!1;t.levels.forEach((function(e){var t=e.attrs,d=e.audioCodec,h=e.videoCodec;d&&(e.audioCodec=d=Ke(d,i)||void 0),h&&(h=e.videoCodec=function(e){for(var t=e.split(","),r=0;r<t.length;r++){var i=t[r].split(".");i.length>2&&"avc1"===i[0]&&(t[r]="avc1."+parseInt(i[1]).toString(16)+("000"+parseInt(i[2]).toString(16)).slice(-4));}return t.join(",")}(h));var f=e.width,c=e.height,g=e.unknownCodecs,v=(null==g?void 0:g.length)||0;if(o||(o=!(!f||!c)),l||(l=!!h),u||(u=!!d),v||d&&!r.isAudioSupported(d)||h&&!r.isVideoSupported(h))r.log('Some or all CODECS not supported "'+t.CODECS+'"');else {var m=t.CODECS,p=t["FRAME-RATE"],y=t["HDCP-LEVEL"],E=t["PATHWAY-ID"],T=t.RESOLUTION,S=t["VIDEO-RANGE"],A=(E||".")+"-"+e.bitrate+"-"+T+"-"+p+"-"+m+"-"+S+"-"+y;if(a[A])if(a[A].uri===e.url||e.attrs["PATHWAY-ID"])a[A].addGroupId("audio",t.AUDIO),a[A].addGroupId("text",t.SUBTITLES);else {var L=s[A]+=1;e.attrs["PATHWAY-ID"]=new Array(L+1).join(".");var I=r.createLevel(e);a[A]=I,n.push(I);}else {var R=r.createLevel(e);a[A]=R,s[A]=1,n.push(R);}}})),this.filterAndSortMediaOptions(n,t,o,l,u);},r.createLevel=function(e){var t=new st(e),r=e.supplemental;if(null!=r&&r.videoCodec&&!this.isVideoSupported(r.videoCodec)){var i=new Error('SUPPLEMENTAL-CODECS not supported "'+r.videoCodec+'"');this.log(i.message),t.supportedResult=Qe(i,[]);}return t},r.isAudioSupported=function(e){return xe(e,"audio",this.hls.config.preferManagedMediaSource)},r.isVideoSupported=function(e){return xe(e,"video",this.hls.config.preferManagedMediaSource)},r.filterAndSortMediaOptions=function(e,t,r,i,n){var a,s=this,o=[],l=[],u=e,d=(null==(a=t.stats)?void 0:a.parsing)||{};if((r||i)&&n&&(u=u.filter((function(e){var t,r=e.videoCodec,i=e.videoRange,n=e.width,a=e.height;return (!!r||!(!n||!a))&&!!(t=i)&&et.indexOf(t)>-1}))),0===u.length)return Promise.resolve().then((function(){if(s.hls){var e="no level with compatible codecs found in manifest",r=e;t.levels.length&&(r="one or more CODECS in variant not supported: "+ut(t.levels.map((function(e){return e.attrs.CODECS})).filter((function(e,t,r){return r.indexOf(e)===t}))),s.warn(r),e+=" ("+r+")");var i=new Error(e);s.hls.trigger(b.ERROR,{type:R.MEDIA_ERROR,details:k.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:i,reason:r});}})),void(d.end=performance.now());t.audioTracks&&_l(o=t.audioTracks.filter((function(e){return !e.audioCodec||s.isAudioSupported(e.audioCodec)}))),t.subtitles&&_l(l=t.subtitles);var h=u.slice(0);u.sort((function(e,t){if(e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"])return (e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1;if(r&&e.height!==t.height)return e.height-t.height;if(e.frameRate!==t.frameRate)return e.frameRate-t.frameRate;if(e.videoRange!==t.videoRange)return et.indexOf(e.videoRange)-et.indexOf(t.videoRange);if(e.videoCodec!==t.videoCodec){var i=Ne(e.videoCodec),n=Ne(t.videoCodec);if(i!==n)return n-i}if(e.uri===t.uri&&e.codecSet!==t.codecSet){var a=Ue(e.codecSet),s=Ue(t.codecSet);if(a!==s)return s-a}return e.averageBitrate!==t.averageBitrate?e.averageBitrate-t.averageBitrate:0}));var f=h[0];if(this.steering&&(u=this.steering.filterParsedLevels(u)).length!==h.length)for(var c=0;c<h.length;c++)if(h[c].pathwayId===u[0].pathwayId){f=h[c];break}this._levels=u;for(var g=0;g<u.length;g++)if(u[g]===f){var v;this._firstLevel=g;var m=f.bitrate,p=this.hls.bandwidthEstimate;if(this.log("manifest loaded, "+u.length+" level(s) found, first bitrate: "+m),void 0===(null==(v=this.hls.userConfig)?void 0:v.abrEwmaDefaultEstimate)){var y=Math.min(m,this.hls.config.abrEwmaDefaultEstimateMax);y>p&&p===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=y);}break}var E=n&&!i,T=this.hls.config,S=!(!T.audioStreamController||!T.audioTrackController),A={levels:u,audioTracks:o,subtitleTracks:l,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:n,video:i,altAudio:S&&!E&&o.some((function(e){return !!e.url}))};d.end=performance.now(),this.hls.trigger(b.MANIFEST_PARSED,A);},r.onError=function(e,t){!t.fatal&&t.context&&t.context.type===_&&t.context.level===this.level&&this.checkRetry(t);},r.onFragBuffered=function(e,t){var r=t.frag;if(void 0!==r&&r.type===w){var i=r.elementaryStreams;if(!Object.keys(i).some((function(e){return !!i[e]})))return;var n=this._levels[r.level];null!=n&&n.loadError&&(this.log("Resetting level error count of "+n.loadError+" on frag buffered"),n.loadError=0);}},r.onLevelLoaded=function(e,t){var r,i,n=t.level,a=t.details,s=t.levelInfo;if(!s)return this.warn("Invalid level index "+n),void(null!=(i=t.deliveryDirectives)&&i.skip&&(a.deltaUpdateFailed=!0));if(s===this.currentLevel||t.withoutMultiVariant){0===s.fragmentError&&(s.loadError=0);var o=s.details;o===t.details&&o.advanced&&(o=void 0),this.playlistLoaded(n,t,o);}else null!=(r=t.deliveryDirectives)&&r.skip&&(a.deltaUpdateFailed=!0);},r.loadPlaylist=function(t){e.prototype.loadPlaylist.call(this),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,t);},r.loadingPlaylist=function(t,r){e.prototype.loadingPlaylist.call(this,t,r);var i=this.getUrlWithDirectives(t.uri,r),n=this.currentLevelIndex,a=t.attrs["PATHWAY-ID"],s=t.details,o=null==s?void 0:s.age;this.log("Loading level index "+n+(void 0!==(null==r?void 0:r.msn)?" at sn "+r.msn+" part "+r.part:"")+(a?" Pathway "+a:"")+(o&&s.live?" age "+o.toFixed(1)+(s.type&&" "+s.type||""):"")+" "+i),this.hls.trigger(b.LEVEL_LOADING,{url:i,level:n,levelInfo:t,pathwayId:t.attrs["PATHWAY-ID"],id:0,deliveryDirectives:r||null});},r.removeLevel=function(e){var t,r=this;if(1!==this._levels.length){var i=this._levels.filter((function(t,i){return i!==e||(r.steering&&r.steering.removeLevel(t),t===r.currentLevel&&(r.currentLevel=null,r.currentLevelIndex=-1,t.details&&t.details.fragments.forEach((function(e){return e.level=-1}))),!1)}));yi(i),this._levels=i,this.currentLevelIndex>-1&&null!=(t=this.currentLevel)&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);var n=i.length-1;this._firstLevel=Math.min(this._firstLevel,n),this._startLevel&&(this._startLevel=Math.min(this._startLevel,n)),this.hls.trigger(b.LEVELS_UPDATED,{levels:i});}},r.onLevelsUpdated=function(e,t){var r=t.levels;this._levels=r;},r.checkMaxAutoUpdated=function(){var e=this.hls,t=e.autoLevelCapping,r=e.maxAutoLevel,i=e.maxHdcpLevel;this._maxAutoLevel!==r&&(this._maxAutoLevel=r,this.hls.trigger(b.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:t,levels:this.levels,maxAutoLevel:r,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:i}));},i(t,[{key:"levels",get:function(){return 0===this._levels.length?null:this._levels}},{key:"loadLevelObj",get:function(){return this.currentLevel}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;if(0!==t.length){if(e<0||e>=t.length){var r=new Error("invalid level idx"),i=e<0;if(this.hls.trigger(b.ERROR,{type:R.OTHER_ERROR,details:k.LEVEL_SWITCH_ERROR,level:e,fatal:i,error:r,reason:r.message}),i)return;e=Math.min(e,t.length-1);}var n=this.currentLevelIndex,a=this.currentLevel,s=a?a.attrs["PATHWAY-ID"]:void 0,o=t[e],l=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,n!==e||!a||s!==l){this.log("Switching to level "+e+" ("+(o.height?o.height+"p ":"")+(o.videoRange?o.videoRange+" ":"")+(o.codecSet?o.codecSet+" ":"")+"@"+o.bitrate+")"+(l?" with Pathway "+l:"")+" from level "+n+(s?" with Pathway "+s:""));var u={level:e,attrs:o.attrs,details:o.details,bitrate:o.bitrate,averageBitrate:o.averageBitrate,maxBitrate:o.maxBitrate,realBitrate:o.realBitrate,width:o.width,height:o.height,codecSet:o.codecSet,audioCodec:o.audioCodec,videoCodec:o.videoCodec,audioGroups:o.audioGroups,subtitleGroups:o.subtitleGroups,loaded:o.loaded,loadError:o.loadError,fragmentError:o.fragmentError,name:o.name,id:o.id,uri:o.uri,url:o.url,urlId:0,audioGroupIds:o.audioGroupIds,textGroupIds:o.textGroupIds};this.hls.trigger(b.LEVEL_SWITCHING,u);var d=o.details;if(!d||d.live){var h=this.switchParams(o.uri,null==a?void 0:a.details,d);this.loadPlaylist(h);}}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e);}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e;}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this.hls.firstAutoLevel}return this._startLevel},set:function(e){this._startLevel=e;}},{key:"pathways",get:function(){return this.steering?this.steering.pathways():[]}},{key:"pathwayPriority",get:function(){return this.steering?this.steering.pathwayPriority:null},set:function(e){if(this.steering){var t=this.steering.pathways(),r=e.filter((function(e){return -1!==t.indexOf(e)}));if(e.length<1)return void this.warn("pathwayPriority "+e+" should contain at least one pathway from list: "+t);this.steering.pathwayPriority=r;}}},{key:"nextLoadLevel",get:function(){return -1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e);}}])}(ya);function _l(e){var t={};e.forEach((function(e){var r=e.groupId||"";e.id=t[r]=t[r]||0,t[r]++;}));}function Pl(){return self.SourceBuffer||self.WebKitSourceBuffer}function Cl(){if(!W())return !1;var e=Pl();return !e||e.prototype&&"function"==typeof e.prototype.appendBuffer&&"function"==typeof e.prototype.remove}var wl=function(e){function t(t,r,i){var n;return (n=e.call(this,t,r,i,"stream-controller",w)||this).audioCodecSwap=!1,n.level=-1,n._forceStartLoad=!1,n._hasEnoughToStart=!1,n.altAudio=0,n.audioOnly=!1,n.fragPlaying=null,n.fragLastKbps=0,n.couldBacktrack=!1,n.backtrackFragment=null,n.audioCodecSwitch=!1,n.videoBuffer=null,n.onMediaPlaying=function(){n.tick();},n.onMediaSeeked=function(){var e=n.media,t=e?e.currentTime:null;if(null!==t&&A(t)&&(n.log("Media seeked to "+t.toFixed(3)),n.getBufferedFrag(t))){var r=n.getFwdBufferInfoAtPos(e,t,w,0);null!==r&&0!==r.len?n.tick():n.warn("Main forward buffer length at "+t+' on "seeked" event '+(r?r.len:"empty")+")");}},n.registerListeners(),n}o(t,e);var r=t.prototype;return r.registerListeners=function(){e.prototype.registerListeners.call(this);var t=this.hls;t.on(b.MANIFEST_PARSED,this.onManifestParsed,this),t.on(b.LEVEL_LOADING,this.onLevelLoading,this),t.on(b.LEVEL_LOADED,this.onLevelLoaded,this),t.on(b.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.on(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(b.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on(b.BUFFER_CREATED,this.onBufferCreated,this),t.on(b.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(b.FRAG_BUFFERED,this.onFragBuffered,this);},r.unregisterListeners=function(){e.prototype.unregisterListeners.call(this);var t=this.hls;t.off(b.MANIFEST_PARSED,this.onManifestParsed,this),t.off(b.LEVEL_LOADED,this.onLevelLoaded,this),t.off(b.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.off(b.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(b.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off(b.BUFFER_CREATED,this.onBufferCreated,this),t.off(b.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(b.FRAG_BUFFERED,this.onFragBuffered,this);},r.onHandlerDestroying=function(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),e.prototype.onHandlerDestroying.call(this);},r.startLoad=function(e,t){if(this.levels){var r=this.lastCurrentTime,i=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){var n=i.startLevel;-1===n&&(i.config.testBandwidth&&this.levels.length>1?(n=0,this.bitrateTest=!0):n=i.firstAutoLevel),i.nextLoadLevel=n,this.level=i.loadLevel,this._hasEnoughToStart=!!t;}r>0&&-1===e&&!t&&(this.log("Override startPosition with lastCurrentTime @"+r.toFixed(3)),e=r),this.state=_i.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick();}else this._forceStartLoad=!0,this.state=_i.STOPPED;},r.stopLoad=function(){this._forceStartLoad=!1,e.prototype.stopLoad.call(this);},r.doTick=function(){switch(this.state){case _i.WAITING_LEVEL:var e=this.levels,t=this.level,r=null==e?void 0:e[t],i=null==r?void 0:r.details;if(i&&(!i.live||this.levelLastLoaded===r&&!this.waitForLive(r))){if(this.waitForCdnTuneIn(i))break;this.state=_i.IDLE;break}if(this.hls.nextLoadLevel!==this.level){this.state=_i.IDLE;break}break;case _i.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();}this.state===_i.IDLE&&this.doTickIdle(),this.onTickEnd();},r.onTickEnd=function(){var t;e.prototype.onTickEnd.call(this),null!=(t=this.media)&&t.readyState&&!1===this.media.seeking&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged();},r.doTickIdle=function(){var e=this.hls,t=this.levelLastLoaded,r=this.levels,i=this.media;if(null!==t&&(i||this.primaryPrefetch||!this.startFragRequested&&e.config.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)){var n=this.buffering?e.nextLoadLevel:e.loadLevel;if(null!=r&&r[n]){var a=r[n],s=this.getMainFwdBufferInfo();if(null!==s){var o=this.getLevelDetails();if(o&&this._streamEnded(s,o)){var l={};return 2===this.altAudio&&(l.type="video"),this.hls.trigger(b.BUFFER_EOS,l),void(this.state=_i.ENDED)}if(this.buffering){e.loadLevel!==n&&-1===e.manualLevel&&this.log("Adapting to level "+n+" from level "+this.level),this.level=e.nextLoadLevel=n;var u=a.details;if(!u||this.state===_i.WAITING_LEVEL||this.waitForLive(a))return this.level=n,this.state=_i.WAITING_LEVEL,void(this.startFragRequested=!1);var d=s.len,h=this.getMaxBufferLength(a.maxBitrate);if(!(d>=h)){this.backtrackFragment&&this.backtrackFragment.start>s.end&&(this.backtrackFragment=null);var f=this.backtrackFragment?this.backtrackFragment.start:s.end,c=this.getNextFragment(f,u);if(this.couldBacktrack&&!this.fragPrevious&&c&&te(c)&&this.fragmentTracker.getState(c)!==Wt){var g,v=(null!=(g=this.backtrackFragment)?g:c).sn-u.startSN,m=u.fragments[v-1];m&&c.cc===m.cc&&(c=m,this.fragmentTracker.removeFragment(m));}else this.backtrackFragment&&s.len&&(this.backtrackFragment=null);if(c&&this.isLoopLoading(c,f)){if(!c.gap){var p=this.audioOnly&&!this.altAudio?$:Z,y=(p===Z?this.videoBuffer:this.mediaBuffer)||this.media;y&&this.afterBufferFlushed(y,p,w);}c=this.getNextFragmentLoopLoading(c,u,s,w,h);}c&&(!c.initSegment||c.initSegment.data||this.bitrateTest||(c=c.initSegment),this.loadFragment(c,a,f));}}}}}},r.loadFragment=function(t,r,i){var n=this.fragmentTracker.getState(t);n===Vt||n===Yt?te(t)?this.bitrateTest?(this.log("Fragment "+t.sn+" of level "+t.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(t,r)):e.prototype.loadFragment.call(this,t,r,i):this._loadInitSegment(t,r):this.clearTrackerIfNeeded(t);},r.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,w)},r.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.end+.5):null},r.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY);},r.nextLevelSwitch=function(){var e=this.levels,t=this.media;if(null!=t&&t.readyState){var r,i=this.getAppendedFrag(t.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);var n=this.getLevelDetails();if(null!=n&&n.live){var a=this.getMainFwdBufferInfo();if(!a||a.len<2*n.targetduration)return}if(!t.paused&&e){var s=e[this.hls.nextLoadLevel],o=this.fragLastKbps;r=o&&this.fragCurrent?this.fragCurrent.duration*s.maxBitrate/(1e3*o)+1:0;}else r=0;var l=this.getBufferedFrag(t.currentTime+r);if(l){var u=this.followingBufferedFrag(l);if(u){this.abortCurrentFrag();var d=u.maxStartPTS?u.maxStartPTS:u.start,h=u.duration,f=Math.max(l.end,d+Math.min(Math.max(h-this.config.maxFragLookUpTolerance,h*(this.couldBacktrack?.5:.125)),h*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(f,Number.POSITIVE_INFINITY);}}}},r.abortCurrentFrag=function(){var e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case _i.KEY_LOADING:case _i.FRAG_LOADING:case _i.FRAG_LOADING_WAITING_RETRY:case _i.PARSING:case _i.PARSED:this.state=_i.IDLE;}this.nextLoadPosition=this.getLoadPosition();},r.flushMainBuffer=function(t,r){e.prototype.flushMainBuffer.call(this,t,r,2===this.altAudio?"video":null);},r.onMediaAttached=function(t,r){e.prototype.onMediaAttached.call(this,t,r);var i=r.media;ki(i,"playing",this.onMediaPlaying),ki(i,"seeked",this.onMediaSeeked);},r.onMediaDetaching=function(t,r){var i=this.media;i&&(bi(i,"playing",this.onMediaPlaying),bi(i,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,e.prototype.onMediaDetaching.call(this,t,r),r.transferMedia||(this._hasEnoughToStart=!1);},r.onManifestLoading=function(){e.prototype.onManifestLoading.call(this),this.log("Trigger BUFFER_RESET"),this.hls.trigger(b.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1;},r.onManifestParsed=function(e,t){for(var r,i,n=!1,a=!1,s=0;s<t.levels.length;s++){var o=t.levels[s].audioCodec;o&&(n=n||-1!==o.indexOf("mp4a.40.2"),a=a||-1!==o.indexOf("mp4a.40.5"));}this.audioCodecSwitch=n&&a&&!("function"==typeof(null==(i=Pl())||null==(r=i.prototype)?void 0:r.changeType)),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1;},r.onLevelLoading=function(e,t){if(this.levels&&this.state===_i.IDLE){var r=t.levelInfo;(!r.details||r.details.live&&(this.levelLastLoaded!==r||r.details.expired)||this.waitForCdnTuneIn(r.details))&&(this.state=_i.WAITING_LEVEL);}},r.onLevelLoaded=function(e,t){var r,i=this.levels,n=this.startFragRequested,a=t.level,s=t.details,o=s.totalduration;if(i){this.log("Level "+a+" loaded ["+s.startSN+","+s.endSN+"]"+(s.lastPartSn?"[part-"+s.lastPartSn+"-"+s.lastPartIndex+"]":"")+", cc ["+s.startCC+", "+s.endCC+"] duration:"+o);var l=t.levelInfo,u=this.fragCurrent;!u||this.state!==_i.FRAG_LOADING&&this.state!==_i.FRAG_LOADING_WAITING_RETRY||u.level!==t.level&&u.loader&&this.abortCurrentFrag();var d=0;if(s.live||null!=(r=l.details)&&r.live){var h;if(this.checkLiveUpdate(s),s.deltaUpdateFailed)return;d=this.alignPlaylists(s,l.details,null==(h=this.levelLastLoaded)?void 0:h.details);}if(l.details=s,this.levelLastLoaded=l,n||this.setStartPosition(s,d),this.hls.trigger(b.LEVEL_UPDATED,{details:s,level:a}),this.state===_i.WAITING_LEVEL){if(this.waitForCdnTuneIn(s))return;this.state=_i.IDLE;}n&&s.live&&this.synchronizeToLiveEdge(s),this.tick();}else this.warn("Levels were reset while loading level "+a);},r.synchronizeToLiveEdge=function(e){var t=this.config,r=this.media;if(r){var i=this.hls.liveSyncPosition,n=this.getLoadPosition(),a=e.fragmentStart,s=e.edge,o=n>=a-t.maxFragLookUpTolerance&&n<=s;if(null!==i&&r.duration>i&&(n<i||!o)){var l=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!o&&r.readyState<4||n<s-l)&&(this._hasEnoughToStart||(this.nextLoadPosition=i),r.readyState))if(this.warn("Playback: "+n.toFixed(3)+" is located too far from the end of live sliding playlist: "+s+", reset currentTime to : "+i.toFixed(3)),"buffered"===this.config.liveSyncMode){var u,d=dr.bufferInfo(r,i,0);if(null==(u=d.buffered)||!u.length)return void(r.currentTime=i);if(d.start<=n)return void(r.currentTime=i);var h=dr.bufferedInfo(d.buffered,n,0).nextStart;h&&(r.currentTime=h);}else r.currentTime=i;}}},r._handleFragmentLoadProgress=function(e){var t,r=e.frag,i=e.part,n=e.payload,a=this.levels;if(a){var s=a[r.level];if(s){var o=s.details;if(!o)return this.warn("Dropping fragment "+r.sn+" of level "+r.level+" after level details were reset"),void this.fragmentTracker.removeFragment(r);var l=s.videoCodec,u=o.PTSKnown||!o.live,d=null==(t=r.initSegment)?void 0:t.data,h=this._getAudioCodec(s),f=this.transmuxer=this.transmuxer||new ma(this.hls,w,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),c=i?i.index:-1,g=-1!==c,v=new lr(r.level,r.sn,r.stats.chunkCount,n.byteLength,c,g),m=this.initPTS[r.cc];f.push(n,d,h,l,r,i,o.totalduration,u,v,m);}else this.warn("Level "+r.level+" not found on progress");}else this.warn("Levels were reset while fragment load was in progress. Fragment "+r.sn+" of level "+r.level+" will not be buffered");},r.onAudioTrackSwitching=function(e,t){var r=this,i=this.hls,n=2===this.altAudio;if(pt(t.url,i))this.altAudio=1;else {if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var a=this.fragCurrent;a&&(this.log("Switching to main audio track, cancel main fragment load"),a.abortRequests(),this.fragmentTracker.removeFragment(a)),this.resetTransmuxer(),this.resetLoadingState();}else this.audioOnly&&this.resetTransmuxer();if(n)return this.fragmentTracker.removeAllFragments(),i.once(b.BUFFER_FLUSHED,(function(){r.hls&&r.hls.trigger(b.AUDIO_TRACK_SWITCHED,t);})),void i.trigger(b.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});i.trigger(b.AUDIO_TRACK_SWITCHED,t);}},r.onAudioTrackSwitched=function(e,t){var r=pt(t.url,this.hls);if(r){var i=this.videoBuffer;i&&this.mediaBuffer!==i&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=i);}this.altAudio=r?2:0,this.tick();},r.onBufferCreated=function(e,t){var r,i,n=t.tracks,a=!1;for(var s in n){var o=n[s];if("main"===o.id){if(i=s,r=o,"video"===s){var l=n[s];l&&(this.videoBuffer=l.buffer);}}else a=!0;}a&&r?(this.log("Alternate track found, use "+i+".buffered to schedule main fragment loading"),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media;},r.onFragBuffered=function(e,t){var r=t.frag,i=t.part,n=r.type===w;if(n){if(this.fragContextChanged(r))return this.warn("Fragment "+r.sn+(i?" p: "+i.index:"")+" of level "+r.level+" finished buffering, but was aborted. state: "+this.state),void(this.state===_i.PARSED&&(this.state=_i.IDLE));var a=i?i.stats:r.stats;this.fragLastKbps=Math.round(8*a.total/(a.buffering.end-a.loading.first)),te(r)&&(this.fragPrevious=r),this.fragBufferedComplete(r,i);}var s=this.media;s&&(!this._hasEnoughToStart&&dr.getBuffered(s).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),n&&this.tick());},r.onError=function(e,t){var r;if(t.fatal)this.state=_i.ERROR;else switch(t.details){case k.FRAG_GAP:case k.FRAG_PARSING_ERROR:case k.FRAG_DECRYPT_ERROR:case k.FRAG_LOAD_ERROR:case k.FRAG_LOAD_TIMEOUT:case k.KEY_LOAD_ERROR:case k.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(w,t);break;case k.LEVEL_LOAD_ERROR:case k.LEVEL_LOAD_TIMEOUT:case k.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==_i.WAITING_LEVEL||(null==(r=t.context)?void 0:r.type)!==_||(this.state=_i.IDLE);break;case k.BUFFER_ADD_CODEC_ERROR:case k.BUFFER_APPEND_ERROR:if("main"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&this.resetLoadingState();break;case k.BUFFER_FULL_ERROR:if("main"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case k.INTERNAL_EXCEPTION:this.recoverWorkerError(t);}},r.onFragLoadEmergencyAborted=function(){this.state=_i.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate();},r.onBufferFlushed=function(e,t){var r=t.type;if(r!==$||!this.altAudio){var i=(r===Z?this.videoBuffer:this.mediaBuffer)||this.media;i&&(this.afterBufferFlushed(i,r,w),this.tick());}},r.onLevelsUpdated=function(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,-1===this.level&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels;},r.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap;},r.seekToStartPos=function(){var e=this.media;if(e){var t=e.currentTime,r=this.startPosition;if(r>=0&&t<r){if(e.seeking)return void this.log("could not seek to "+r+", already seeking at "+t);var i=this.timelineOffset;i&&r&&(r+=i);var n=this.getLevelDetails(),a=dr.getBuffered(e),s=a.length?a.start(0):0,o=s-r,l=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||o>0&&(o<l||this.loadingParts&&o<2*((null==n?void 0:n.partTarget)||0)))&&(this.log("adjusting start position by "+o+" to match buffer start"),r+=o,this.startPosition=r),t<r&&(this.log("seek to target start position "+r+" from current time "+t+" buffer start "+s),e.currentTime=r);}}},r._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t},r._loadBitrateTestFrag=function(e,t){var r=this;e.bitrateTest=!0,this._doFragLoad(e,t).then((function(e){var i=r.hls,n=null==e?void 0:e.frag;if(n&&!r.fragContextChanged(n)){t.fragmentError=0,r.state=_i.IDLE,r.startFragRequested=!1,r.bitrateTest=!1;var a=n.stats;a.parsing.start=a.parsing.end=a.buffering.start=a.buffering.end=self.performance.now(),i.trigger(b.FRAG_LOADED,e),n.bitrateTest=!1;}})).catch((function(t){r.state!==_i.STOPPED&&r.state!==_i.ERROR&&(r.warn(t),r.resetFragmentLoading(e));}));},r._handleTransmuxComplete=function(e){var t=this.playlistType,r=this.hls,i=e.remuxResult,n=e.chunkMeta,a=this.getCurrentContext(n);if(a){var s=a.frag,o=a.part,l=a.level,u=i.video,d=i.text,h=i.id3,f=i.initSegment,c=l.details,g=this.altAudio?void 0:i.audio;if(this.fragContextChanged(s))this.fragmentTracker.removeFragment(s);else {if(this.state=_i.PARSING,f){var v=f.tracks;if(v){var m=s.initSegment||s;if(this.unhandledEncryptionError(f,s))return;this._bufferInitSegment(l,v,m,n),r.trigger(b.FRAG_PARSING_INIT_SEGMENT,{frag:m,id:t,tracks:v});}var p=f.initPTS,y=f.timescale,E=this.initPTS[s.cc];if(A(p)&&(!E||E.baseTime!==p||E.timescale!==y)){var T=f.trackId;this.initPTS[s.cc]={baseTime:p,timescale:y,trackId:T},r.trigger(b.INIT_PTS_FOUND,{frag:s,id:t,initPTS:p,timescale:y,trackId:T});}}if(u&&c){g&&"audiovideo"===u.type&&this.logMuxedErr(s);var S=c.fragments[s.sn-1-c.startSN],L=s.sn===c.startSN,I=!S||s.cc>S.cc;if(!1!==i.independent){var R=u.startPTS,k=u.endPTS,D=u.startDTS,_=u.endDTS;if(o)o.elementaryStreams[u.type]={startPTS:R,endPTS:k,startDTS:D,endDTS:_};else if(u.firstKeyFrame&&u.independent&&1===n.id&&!I&&(this.couldBacktrack=!0),u.dropped&&u.independent){var P=this.getMainFwdBufferInfo(),C=(P?P.end:this.getLoadPosition())+this.config.maxBufferHole,w=u.firstKeyFramePTS?u.firstKeyFramePTS:R;if(!L&&C<w-this.config.maxBufferHole&&!I)return void this.backtrack(s);I&&(s.gap=!0),s.setElementaryStreamInfo(u.type,s.start,k,s.start,_,!0);}else L&&R-(c.appliedTimelineOffset||0)>2&&(s.gap=!0);s.setElementaryStreamInfo(u.type,R,k,D,_),this.backtrackFragment&&(this.backtrackFragment=s),this.bufferFragmentData(u,s,o,n,L||I);}else {if(!L&&!I)return void this.backtrack(s);s.gap=!0;}}if(g){var O=g.startPTS,x=g.endPTS,M=g.startDTS,F=g.endDTS;o&&(o.elementaryStreams[$]={startPTS:O,endPTS:x,startDTS:M,endDTS:F}),s.setElementaryStreamInfo($,O,x,M,F),this.bufferFragmentData(g,s,o,n);}if(c&&null!=h&&h.samples.length){var N={id:t,frag:s,details:c,samples:h.samples};r.trigger(b.FRAG_PARSING_METADATA,N);}if(c&&d){var U={id:t,frag:s,details:c,samples:d.samples};r.trigger(b.FRAG_PARSING_USERDATA,U);}}}else this.resetWhenMissingContext(n);},r.logMuxedErr=function(e){this.warn((te(e)?"Media":"Init")+" segment with muxed audiovideo where only video expected: "+e.url);},r._bufferInitSegment=function(e,t,r,i){var n=this;if(this.state===_i.PARSING){this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(r));var a=t.audio,s=t.video,o=t.audiovideo;if(a){var l=e.audioCodec,u=Ve(a.codec,l);"mp4a"===u&&(u="mp4a.40.5");var d=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){u&&(u=-1!==u.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");var h=a.metadata;h&&"channelCount"in h&&1!==(h.channelCount||1)&&-1===d.indexOf("firefox")&&(u="mp4a.40.5");}u&&-1!==u.indexOf("mp4a.40.5")&&-1!==d.indexOf("android")&&"audio/mpeg"!==a.container&&(u="mp4a.40.2",this.log("Android: force audio codec to "+u)),l&&l!==u&&this.log('Swapping manifest audio codec "'+l+'" for "'+u+'"'),a.levelCodec=u,a.id=w,this.log("Init audio buffer, container:"+a.container+", codecs[selected/level/parsed]=["+(u||"")+"/"+(l||"")+"/"+a.codec+"]"),delete t.audiovideo;}if(s){s.levelCodec=e.videoCodec,s.id=w;var f=s.codec;if(4===(null==f?void 0:f.length))switch(f){case"hvc1":case"hev1":s.codec="hvc1.1.6.L120.90";break;case"av01":s.codec="av01.0.04M.08";break;case"avc1":s.codec="avc1.42e01e";}this.log("Init video buffer, container:"+s.container+", codecs[level/parsed]=["+(e.videoCodec||"")+"/"+f+"]"+(s.codec!==f?" parsed-corrected="+s.codec:"")+(s.supplemental?" supplemental="+s.supplemental:"")),delete t.audiovideo;}o&&(this.log("Init audiovideo buffer, container:"+o.container+", codecs[level/parsed]=["+e.codecs+"/"+o.codec+"]"),delete t.video,delete t.audio);var c=Object.keys(t);if(c.length){if(this.hls.trigger(b.BUFFER_CODECS,t),!this.hls)return;c.forEach((function(e){var a=t[e].initSegment;null!=a&&a.byteLength&&n.hls.trigger(b.BUFFER_APPENDING,{type:e,data:a,frag:r,part:null,chunkMeta:i,parent:r.type});}));}this.tickImmediate();}},r.getMainFwdBufferInfo=function(){var e=this.mediaBuffer&&2===this.altAudio?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,w)},r.backtrack=function(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=_i.IDLE;},r.checkFragmentChanged=function(){var e=this.media,t=null;if(e&&e.readyState>1&&!1===e.seeking){var r=e.currentTime;if(dr.isBuffered(e,r)?t=this.getAppendedFrag(r):dr.isBuffered(e,r+.1)&&(t=this.getAppendedFrag(r+.1)),t){this.backtrackFragment=null;var i=this.fragPlaying,n=t.level;i&&t.sn===i.sn&&i.level===n||(this.fragPlaying=t,this.hls.trigger(b.FRAG_CHANGED,{frag:t}),i&&i.level===n||this.hls.trigger(b.LEVEL_SWITCHED,{level:n}));}}},i(t,[{key:"hasEnoughToStart",get:function(){return this._hasEnoughToStart}},{key:"maxBufferLength",get:function(){var e=this.levels,t=this.level,r=null==e?void 0:e[t];return r?this.getMaxBufferLength(r.maxBitrate):this.config.maxBufferLength}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"currentFrag",get:function(){var e;if(this.fragPlaying)return this.fragPlaying;var t=(null==(e=this.media)?void 0:e.currentTime)||this.lastCurrentTime;return A(t)?this.getAppendedFrag(t):null}},{key:"currentProgramDateTime",get:function(){var e,t=(null==(e=this.media)?void 0:e.currentTime)||this.lastCurrentTime;if(A(t)){var r=this.getLevelDetails(),i=this.currentFrag||(r?Tt(null,r.fragments,t):null);if(i){var n=i.programDateTime;if(null!==n){var a=n+1e3*(t-i.start);return new Date(a)}}}return null}},{key:"currentLevel",get:function(){var e=this.currentFrag;return e?e.level:-1}},{key:"nextBufferedFrag",get:function(){var e=this.currentFrag;return e?this.followingBufferedFrag(e):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}])}(Pi),Ol=function(e){function t(t,r){var i;return (i=e.call(this,"key-loader",r)||this).config=void 0,i.keyIdToKeyInfo={},i.emeController=null,i.config=t,i}o(t,e);var r=t.prototype;return r.abort=function(e){for(var t in this.keyIdToKeyInfo){var r=this.keyIdToKeyInfo[t].loader;if(r){var i;if(e&&e!==(null==(i=r.context)?void 0:i.frag.type))return;r.abort();}}},r.detach=function(){for(var e in this.keyIdToKeyInfo){var t=this.keyIdToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e];}},r.destroy=function(){for(var e in this.detach(),this.keyIdToKeyInfo){var t=this.keyIdToKeyInfo[e].loader;t&&t.destroy();}this.keyIdToKeyInfo={};},r.createKeyLoadError=function(e,t,r,i,n){return void 0===t&&(t=k.KEY_LOAD_ERROR),new sr({type:R.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:n,error:r,networkDetails:i})},r.loadClear=function(e,t,r){var i=this;if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length)for(var n,a=function(){var n=t[s];if(e.cc<=n.cc&&(!te(e)||!te(n)||e.sn<n.sn)||!r&&s==o-1)return {v:i.emeController.selectKeySystemFormat(n).then((function(e){if(i.emeController){n.setKeyFormat(e);var t=Fr(e);return t?i.emeController.getKeySystemAccess([t]):void 0}}))}},s=0,o=t.length;s<o;s++)if(n=a())return n.v;if(this.config.requireKeySystemAccessOnStart){var l=Ur(this.config);if(l.length)return this.emeController.getKeySystemAccess(l)}}return null},r.load=function(e){var t=this;return !e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then((function(r){return t.loadInternal(e,r)})):this.loadInternal(e)},r.loadInternal=function(e,t){var r,i;t&&e.setKeyFormat(t);var n=e.decryptdata;if(!n){var a=new Error(t?"Expected frag.decryptdata to be defined after setting format "+t:"Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: "+(this.emeController&&this.config.emeEnabled)+")");return Promise.reject(this.createKeyLoadError(e,k.KEY_LOAD_ERROR,a))}var s=n.uri;if(!s)return Promise.reject(this.createKeyLoadError(e,k.KEY_LOAD_ERROR,new Error('Invalid key URI: "'+s+'"')));var o=xl(n),l=this.keyIdToKeyInfo[o];if(null!=(r=l)&&r.decryptdata.key)return n.key=l.decryptdata.key,Promise.resolve({frag:e,keyInfo:l});if(this.emeController&&null!=(i=l)&&i.keyLoadPromise)switch(this.emeController.getKeyStatus(l.decryptdata)){case"usable":case"usable-in-future":return l.keyLoadPromise.then((function(t){var r=t.keyInfo;return n.key=r.decryptdata.key,{frag:e,keyInfo:r}}))}switch(this.log((this.keyIdToKeyInfo[o]?"Rel":"L")+"oading"+(n.keyId?" keyId: "+X(n.keyId):"")+" URI: "+n.uri+" from "+e.type+" "+e.level),l=this.keyIdToKeyInfo[o]={decryptdata:n,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},n.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return "identity"===n.keyFormat?this.loadKeyHTTP(l,e):this.loadKeyEME(l,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(l,e);default:return Promise.reject(this.createKeyLoadError(e,k.KEY_LOAD_ERROR,new Error('Key supplied with unsupported METHOD: "'+n.method+'"')))}},r.loadKeyEME=function(e,t){var r={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var i;if(!e.decryptdata.keyId&&null!=(i=t.initSegment)&&i.data){var n=function(e){var t=[];return Se(e,(function(e){return t.push(e.subarray(8,24))})),t}(t.initSegment.data);if(n.length){var a=n[0];a.some((function(e){return 0!==e}))&&(this.log("Using keyId found in init segment "+X(a)),e.decryptdata.keyId=a,Hr.setKeyIdForUri(e.decryptdata.uri,a));}}var s=this.emeController.loadKey(r);return (e.keyLoadPromise=s.then((function(t){return e.mediaKeySessionContext=t,r}))).catch((function(r){throw e.keyLoadPromise=null,"data"in r&&(r.data.frag=t),r}))}return Promise.resolve(r)},r.loadKeyHTTP=function(e,t){var r=this,i=this.config,n=new(i.loader)(i);return t.keyLoader=e.loader=n,e.keyLoadPromise=new Promise((function(a,s){var o={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},l=i.keyLoadPolicy.default,u={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:function(e,t,i,n){var o=i.frag,l=i.keyInfo,u=xl(l.decryptdata);if(!o.decryptdata||l!==r.keyIdToKeyInfo[u])return s(r.createKeyLoadError(o,k.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),n));l.decryptdata.key=o.decryptdata.key=new Uint8Array(e.data),o.keyLoader=null,l.loader=null,a({frag:o,keyInfo:l});},onError:function(e,i,n,a){r.resetLoader(i),s(r.createKeyLoadError(t,k.KEY_LOAD_ERROR,new Error("HTTP Error "+e.code+" loading key "+e.text),n,d({url:o.url,data:void 0},e)));},onTimeout:function(e,i,n){r.resetLoader(i),s(r.createKeyLoadError(t,k.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),n));},onAbort:function(e,i,n){r.resetLoader(i),s(r.createKeyLoadError(t,k.INTERNAL_ABORTED,new Error("key loading aborted"),n));}};n.load(o,u,h);}))},r.resetLoader=function(e){var t=e.frag,r=e.keyInfo,i=e.url,n=r.loader;t.keyLoader===n&&(t.keyLoader=null,r.loader=null);var a=xl(r.decryptdata)||i;delete this.keyIdToKeyInfo[a],n&&n.destroy();},t}(N);function xl(e){if(e.keyFormat!==Or){var t=e.keyId;if(t)return X(t)}return e.uri}function Ml(e){switch(e.type){case P:return O;case C:return x;default:return w}}function Fl(e,t){var r=e.url;return void 0!==r&&0!==r.indexOf("data:")||(r=t.url),r}var Nl=function(){function e(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners();}var t=e.prototype;return t.startLoad=function(e){},t.stopLoad=function(){this.destroyInternalLoaders();},t.registerListeners=function(){var e=this.hls;e.on(b.MANIFEST_LOADING,this.onManifestLoading,this),e.on(b.LEVEL_LOADING,this.onLevelLoading,this),e.on(b.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(b.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(b.LEVELS_UPDATED,this.onLevelsUpdated,this);},t.unregisterListeners=function(){var e=this.hls;e.off(b.MANIFEST_LOADING,this.onManifestLoading,this),e.off(b.LEVEL_LOADING,this.onLevelLoading,this),e.off(b.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(b.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(b.LEVELS_UPDATED,this.onLevelsUpdated,this);},t.createInternalLoader=function(e){var t=this.hls.config,r=t.pLoader,i=t.loader,n=new(r||i)(t);return this.loaders[e.type]=n,n},t.getInternalLoader=function(e){return this.loaders[e.type]},t.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e];},t.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e);}},t.destroy=function(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders();},t.onManifestLoading=function(e,t){var r=t.url;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:D,url:r,deliveryDirectives:null,levelOrTrack:null});},t.onLevelLoading=function(e,t){var r=t.id,i=t.level,n=t.pathwayId,a=t.url,s=t.deliveryDirectives,o=t.levelInfo;this.load({id:r,level:i,pathwayId:n,responseType:"text",type:_,url:a,deliveryDirectives:s,levelOrTrack:o});},t.onAudioTrackLoading=function(e,t){var r=t.id,i=t.groupId,n=t.url,a=t.deliveryDirectives,s=t.track;this.load({id:r,groupId:i,level:null,responseType:"text",type:P,url:n,deliveryDirectives:a,levelOrTrack:s});},t.onSubtitleTrackLoading=function(e,t){var r=t.id,i=t.groupId,n=t.url,a=t.deliveryDirectives,s=t.track;this.load({id:r,groupId:i,level:null,responseType:"text",type:C,url:n,deliveryDirectives:a,levelOrTrack:s});},t.onLevelsUpdated=function(e,t){var r=this.loaders[_];if(r){var i=r.context;i&&!t.levels.some((function(e){return e===i.levelOrTrack}))&&(r.abort(),delete this.loaders[_]);}},t.load=function(e){var t,r,i,n=this,s=this.hls.config,o=this.getInternalLoader(e);if(o){var l=this.hls.logger,u=o.context;if(u&&u.levelOrTrack===e.levelOrTrack&&(u.url===e.url||u.deliveryDirectives&&!e.deliveryDirectives))return void(u.url===e.url?l.log("[playlist-loader]: ignore "+e.url+" ongoing request"):l.log("[playlist-loader]: ignore "+e.url+" in favor of "+u.url));l.log("[playlist-loader]: aborting previous loader for type: "+e.type),o.abort();}if(r=e.type===D?s.manifestLoadPolicy.default:a({},s.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),o=this.createInternalLoader(e),A(null==(t=e.deliveryDirectives)?void 0:t.part)&&(e.type===_&&null!==e.level?i=this.hls.levels[e.level].details:e.type===P&&null!==e.id?i=this.hls.audioTracks[e.id].details:e.type===C&&null!==e.id&&(i=this.hls.subtitleTracks[e.id].details),i)){var d=i.partTarget,h=i.targetduration;if(d&&h){var f=1e3*Math.max(3*d,.8*h);r=a({},r,{maxTimeToFirstByteMs:Math.min(f,r.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(f,r.maxTimeToFirstByteMs)});}}var c=r.errorRetry||r.timeoutRetry||{},g={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:c.maxNumRetry||0,retryDelay:c.retryDelayMs||0,maxRetryDelay:c.maxRetryDelayMs||0},v={onSuccess:function(e,t,r,i){var a=n.getInternalLoader(r);n.resetInternalLoader(r.type);var s=e.data;t.parsing.start=performance.now(),zr.isMediaPlaylist(s)||r.type!==D?n.handleTrackOrLevelPlaylist(e,t,r,i||null,a):n.handleMasterPlaylist(e,t,r,i);},onError:function(e,t,r,i){n.handleNetworkError(t,r,!1,e,i);},onTimeout:function(e,t,r){n.handleNetworkError(t,r,!0,void 0,e);}};o.load(e,g,v);},t.checkAutostartLoad=function(){if(this.hls){var e=this.hls,t=e.config,r=t.autoStartLoad,i=t.startPosition,n=e.forceStartLoad;(r||n)&&(this.hls.logger.log((r?"auto":"force")+" startLoad with configured startPosition "+i),this.hls.startLoad(i));}},t.handleMasterPlaylist=function(e,t,r,i){var n=this,a=this.hls,s=e.data,o=Fl(e,r),l=zr.parseMasterPlaylist(s,o);if(l.playlistParsingError)return t.parsing.end=performance.now(),void this.handleManifestParsingError(e,r,l.playlistParsingError,i,t);var u=l.contentSteering,d=l.levels,h=l.sessionData,f=l.sessionKeys,c=l.startTimeOffset,g=l.variableList;this.variableList=g,d.forEach((function(e){var t=e.unknownCodecs;if(t)for(var r=n.hls.config.preferManagedMediaSource,i=e.audioCodec,a=e.videoCodec,s=t.length;s--;){var o=t[s];xe(o,"audio",r)?(e.audioCodec=i=i?i+","+o:o,we.audio[i.substring(0,4)]=2,t.splice(s,1)):xe(o,"video",r)&&(e.videoCodec=a=a?a+","+o:o,we.video[a.substring(0,4)]=2,t.splice(s,1));}}));var v=zr.parseMasterPlaylistMedia(s,o,l),m=v.AUDIO,p=void 0===m?[]:m,y=v.SUBTITLES,E=v["CLOSED-CAPTIONS"];p.length&&(p.some((function(e){return !e.url}))||!d[0].audioCodec||d[0].attrs.AUDIO||(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new yr({}),bitrate:0,url:""}))),a.trigger(b.MANIFEST_LOADED,{levels:d,audioTracks:p,subtitles:y,captions:E,contentSteering:u,url:o,stats:t,networkDetails:i,sessionData:h,sessionKeys:f,startTimeOffset:c,variableList:g});},t.handleTrackOrLevelPlaylist=function(e,t,r,i,n){var a=this.hls,s=r.id,o=r.level,l=r.type,u=Fl(e,r),d=A(o)?o:A(s)?s:0,h=Ml(r),f=zr.parseLevelPlaylist(e.data,u,d,h,0,this.variableList);if(l===D){var c={attrs:new yr({}),bitrate:0,details:f,name:"",url:u};f.requestScheduled=t.loading.start+gi(f,0),a.trigger(b.MANIFEST_LOADED,{levels:[c],audioTracks:[],url:u,stats:t,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null});}t.parsing.end=performance.now(),r.levelDetails=f,this.handlePlaylistLoaded(f,e,t,r,i,n);},t.handleManifestParsingError=function(e,t,r,i,n){this.hls.trigger(b.ERROR,{type:R.NETWORK_ERROR,details:k.MANIFEST_PARSING_ERROR,fatal:t.type===D,url:e.url,err:r,error:r,reason:r.message,response:e,context:t,networkDetails:i,stats:n});},t.handleNetworkError=function(e,t,r,i,n){void 0===r&&(r=!1);var a="A network "+(r?"timeout":"error"+(i?" (status "+i.code+")":""))+" occurred while loading "+e.type;e.type===_?a+=": "+e.level+" id: "+e.id:e.type!==P&&e.type!==C||(a+=" id: "+e.id+' group-id: "'+e.groupId+'"');var s=new Error(a);this.hls.logger.warn("[playlist-loader]: "+a);var o=k.UNKNOWN,l=!1,u=this.getInternalLoader(e);switch(e.type){case D:o=r?k.MANIFEST_LOAD_TIMEOUT:k.MANIFEST_LOAD_ERROR,l=!0;break;case _:o=r?k.LEVEL_LOAD_TIMEOUT:k.LEVEL_LOAD_ERROR,l=!1;break;case P:o=r?k.AUDIO_TRACK_LOAD_TIMEOUT:k.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case C:o=r?k.SUBTITLE_TRACK_LOAD_TIMEOUT:k.SUBTITLE_LOAD_ERROR,l=!1;}u&&this.resetInternalLoader(e.type);var h={type:R.NETWORK_ERROR,details:o,fatal:l,url:e.url,loader:u,context:e,error:s,networkDetails:t,stats:n};if(i){var f=(null==t?void 0:t.url)||e.url;h.response=d({url:f,data:void 0},i);}this.hls.trigger(b.ERROR,h);},t.handlePlaylistLoaded=function(e,t,r,i,n,a){var s=this.hls,o=i.type,l=i.level,u=i.levelOrTrack,d=i.id,h=i.groupId,f=i.deliveryDirectives,c=Fl(t,i),g=Ml(i),v="number"==typeof i.level&&g===w?l:void 0,m=e.playlistParsingError;if(m){if(this.hls.logger.warn(m+" "+e.url),!s.config.ignorePlaylistParsingErrors)return void s.trigger(b.ERROR,{type:R.NETWORK_ERROR,details:k.LEVEL_PARSING_ERROR,fatal:!1,url:c,error:m,reason:m.message,response:t,context:i,level:v,parent:g,networkDetails:n,stats:r});e.playlistParsingError=null;}if(e.fragments.length)switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),a.getCacheAge&&!isNaN(e.ageHeader)||(e.ageHeader=0)),o){case D:case _:if(v)if(u){if(u!==s.levels[v]){var p=s.levels.indexOf(u);p>-1&&(v=p);}}else v=0;s.trigger(b.LEVEL_LOADED,{details:e,levelInfo:u||s.levels[0],level:v||0,id:d||0,stats:r,networkDetails:n,deliveryDirectives:f,withoutMultiVariant:o===D});break;case P:s.trigger(b.AUDIO_TRACK_LOADED,{details:e,track:u,id:d||0,groupId:h||"",stats:r,networkDetails:n,deliveryDirectives:f});break;case C:s.trigger(b.SUBTITLE_TRACK_LOADED,{details:e,track:u,id:d||0,groupId:h||"",stats:r,networkDetails:n,deliveryDirectives:f});}else {var y=e.playlistParsingError=new Error("No Segments found in Playlist");s.trigger(b.ERROR,{type:R.NETWORK_ERROR,details:k.LEVEL_EMPTY_ERROR,fatal:!1,url:c,error:y,reason:y.message,response:t,context:i,level:v,parent:g,networkDetails:n,stats:r});}},e}(),Ul=function(){function e(t){void 0===t&&(t={}),this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new E,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;var r=this.logger=H(t.debug||!1,"Hls instance",t.assetPlayerId),i=this.config=function(e,t,r){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');var i=pl(e),n=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return ["manifest","level","frag"].forEach((function(e){var a=("level"===e?"playlist":e)+"LoadPolicy",s=void 0===t[a],o=[];n.forEach((function(r){var n=e+"Loading"+r,l=t[n];if(void 0!==l&&s){o.push(n);var u=i[a].default;switch(t[a]={default:u},r){case"TimeOut":u.maxLoadTimeMs=l,u.maxTimeToFirstByteMs=l;break;case"MaxRetry":u.errorRetry.maxNumRetry=l,u.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":u.errorRetry.retryDelayMs=l,u.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":u.errorRetry.maxRetryDelayMs=l,u.timeoutRetry.maxRetryDelayMs=l;}}})),o.length&&r.warn('hls.js config: "'+o.join('", "')+'" setting(s) are deprecated, use "'+a+'": '+ut(t[a]));})),d(d({},i),t)}(e.DefaultConfig,t,r);this.userConfig=t,i.progressive&&yl(i,r);var n=i.abrController,a=i.bufferController,s=i.capLevelController,o=i.errorController,l=i.fpsController,u=new o(this),h=this.abrController=new n(this),f=new jt(this),c=i.interstitialsController,g=c?this.interstitialsController=new c(this,e):null,v=this.bufferController=new a(this,f),m=this.capLevelController=new s(this),p=new l(this),y=new Nl(this),T=i.contentSteeringController,S=T?new T(this):null,A=this.levelController=new Dl(this,S),L=new kl(this),I=new Ol(this.config,this.logger),R=this.streamController=new wl(this,f,I),k=this.gapController=new El(this,f);m.setStreamController(R),p.setStreamController(R);var D=[y,A,R];g&&D.splice(1,0,g),S&&D.splice(1,0,S),this.networkControllers=D;var _=[h,v,k,m,p,L,f];this.audioTrackController=this.createController(i.audioTrackController,D);var P=i.audioStreamController;P&&D.push(this.audioStreamController=new P(this,f,I)),this.subtitleTrackController=this.createController(i.subtitleTrackController,D);var C=i.subtitleStreamController;C&&D.push(this.subtititleStreamController=new C(this,f,I)),this.createController(i.timelineController,_),I.emeController=this.emeController=this.createController(i.emeController,_),this.cmcdController=this.createController(i.cmcdController,_),this.latencyController=this.createController(bl,_),this.coreComponents=_,D.push(u);var w=u.onErrorOut;"function"==typeof w&&this.on(b.ERROR,w,u),this.on(b.MANIFEST_LOADED,y.onManifestLoaded,y);}e.isMSESupported=function(){return Cl()},e.isSupported=function(){return function(){if(!Cl())return !1;var e=W();return "function"==typeof(null==e?void 0:e.isTypeSupported)&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some((function(t){return e.isTypeSupported(Fe(t,"video"))}))||["mp4a.40.2","fLaC"].some((function(t){return e.isTypeSupported(Fe(t,"audio"))})))}()},e.getMediaSource=function(){return W()};var t=e.prototype;return t.createController=function(e,t){if(e){var r=new e(this);return t&&t.push(r),r}return null},t.on=function(e,t,r){void 0===r&&(r=this),this._emitter.on(e,t,r);},t.once=function(e,t,r){void 0===r&&(r=this),this._emitter.once(e,t,r);},t.removeAllListeners=function(e){this._emitter.removeAllListeners(e);},t.off=function(e,t,r,i){void 0===r&&(r=this),this._emitter.off(e,t,r,i);},t.listeners=function(e){return this._emitter.listeners(e)},t.emit=function(e,t,r){return this._emitter.emit(e,t,r)},t.trigger=function(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),!this.triggeringException){this.triggeringException=!0;var r=e===b.ERROR;this.trigger(b.ERROR,{type:R.OTHER_ERROR,details:k.INTERNAL_EXCEPTION,fatal:r,event:e,error:t}),this.triggeringException=!1;}}return !1},t.listenerCount=function(e){return this._emitter.listenerCount(e)},t.destroy=function(){this.logger.log("destroy"),this.trigger(b.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach((function(e){return e.destroy()})),this.networkControllers.length=0,this.coreComponents.forEach((function(e){return e.destroy()})),this.coreComponents.length=0;var e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null;},t.attachMedia=function(e){if(!e||"media"in e&&!e.media){var t=new Error("attachMedia failed: invalid argument ("+e+")");this.trigger(b.ERROR,{type:R.OTHER_ERROR,details:k.ATTACH_MEDIA_ERROR,fatal:!0,error:t});}else {this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());var r="media"in e,i=r?e.media:e,n=r?e:{media:i};this._media=i,this.trigger(b.MEDIA_ATTACHING,n);}},t.detachMedia=function(){this.logger.log("detachMedia"),this.trigger(b.MEDIA_DETACHING,{}),this._media=null;},t.transferMedia=function(){this._media=null;var e=this.bufferController.transferMedia();return this.trigger(b.MEDIA_DETACHING,{transferMedia:e}),e},t.loadSource=function(e){this.stopLoad();var t=this.media,r=this._url,i=this._url=S.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log("loadSource:"+i),t&&r&&(r!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(b.MANIFEST_LOADING,{url:e});},t.startLoad=function(e,t){void 0===e&&(e=-1),this.logger.log("startLoad("+e+(t?", <skip seek to start>":"")+")"),this.started=!0,this.resumeBuffering();for(var r=0;r<this.networkControllers.length&&(this.networkControllers[r].startLoad(e,t),this.started&&this.networkControllers);r++);},t.stopLoad=function(){this.logger.log("stopLoad"),this.started=!1;for(var e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!this.started&&this.networkControllers);e++);},t.resumeBuffering=function(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach((function(e){e.resumeBuffering&&e.resumeBuffering();})));},t.pauseBuffering=function(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach((function(e){e.pauseBuffering&&e.pauseBuffering();})));},t.swapAudioCodec=function(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec();},t.recoverMediaError=function(){this.logger.log("recoverMediaError");var e=this._media,t=null==e?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t));},t.removeLevel=function(e){this.levelController.removeLevel(e);},t.setAudioOption=function(e){var t;return (null==(t=this.audioTrackController)?void 0:t.setAudioOption(e))||null},t.setSubtitleOption=function(e){var t;return (null==(t=this.subtitleTrackController)?void 0:t.setSubtitleOption(e))||null},t.getMediaDecodingInfo=function(e,t){return void 0===t&&(t=this.allAudioTracks),ze(e,ht(t),navigator.mediaCapabilities)},i(e,[{key:"url",get:function(){return this._url}},{key:"hasEnoughToStart",get:function(){return this.streamController.hasEnoughToStart}},{key:"startPosition",get:function(){return this.streamController.startPositionValue}},{key:"loadingEnabled",get:function(){return this.started}},{key:"bufferingEnabled",get:function(){return this.streamController.bufferingEnabled}},{key:"inFlightFragments",get:function(){var e,t=((e={})[w]=this.streamController.inFlightFrag,e);return this.audioStreamController&&(t[O]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(t[x]=this.subtititleStreamController.inFlightFrag),t}},{key:"sessionId",get:function(){var e=this._sessionId;return e||(e=this._sessionId=function(){try{return crypto.randomUUID()}catch(i){try{var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch(e){var r=(new Date).getTime();return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=(r+16*Math.random())%16|0;return r=Math.floor(r/16),("x"==e?t:3&t|8).toString(16)}))}}}()),e}},{key:"levels",get:function(){var e=this.levelController.levels;return e||[]}},{key:"latestLevelDetails",get:function(){return this.streamController.getLevelDetails()||null}},{key:"loadLevelObj",get:function(){return this.levelController.loadLevelObj}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){this.logger.log("set currentLevel:"+e),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch();}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){this.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch();}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){this.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e;}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e;}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){this.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e;}},{key:"startLevel",get:function(){var e=this.levelController.startLevel;return -1===e&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e},set:function(e){this.logger.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e;}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t);}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){this._autoLevelCapping!==e&&(this.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated());}},{key:"bandwidthEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.getEstimate():NaN},set:function(e){this.abrController.resetEstimator(e);}},{key:"abrEwmaDefaultEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.defaultEstimate:NaN}},{key:"ttfbEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.getEstimateTTFB():NaN}},{key:"maxHdcpLevel",get:function(){return this._maxHdcpLevel},set:function(e){(function(e){return Je.indexOf(e)>-1})(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated());}},{key:"autoLevelEnabled",get:function(){return -1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var e=this.levels,t=this.config.minAutoBitrate;if(!e)return 0;for(var r=e.length,i=0;i<r;i++)if(e[i].maxBitrate>=t)return i;return 0}},{key:"maxAutoLevel",get:function(){var e,t=this.levels,r=this.autoLevelCapping,i=this.maxHdcpLevel;if(e=-1===r&&null!=t&&t.length?t.length-1:r,i)for(var n=e;n--;){var a=t[n].attrs["HDCP-LEVEL"];if(a&&a<=i)return n}return e}},{key:"firstAutoLevel",get:function(){return this.abrController.firstAutoLevel}},{key:"nextAutoLevel",get:function(){return this.abrController.nextAutoLevel},set:function(e){this.abrController.nextAutoLevel=e;}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",get:function(){return this.streamController.getMainFwdBufferInfo()}},{key:"maxBufferLength",get:function(){return this.streamController.maxBufferLength}},{key:"allAudioTracks",get:function(){var e=this.audioTrackController;return e?e.allAudioTracks:[]}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e);}},{key:"allSubtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e);}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return !!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e);}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(e){this.config.lowLatencyMode=e;}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency},set:function(e){this.latencyController.targetLatency=e;}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}},{key:"pathways",get:function(){return this.levelController.pathways}},{key:"pathwayPriority",get:function(){return this.levelController.pathwayPriority},set:function(e){this.levelController.pathwayPriority=e;}},{key:"bufferedToEnd",get:function(){var e;return !(null==(e=this.bufferController)||!e.bufferedToEnd)}},{key:"interstitialsManager",get:function(){var e;return (null==(e=this.interstitialsController)?void 0:e.interstitialsManager)||null}}],[{key:"version",get:function(){return ca}},{key:"Events",get:function(){return b}},{key:"MetadataSchema",get:function(){return rn}},{key:"ErrorTypes",get:function(){return R}},{key:"ErrorDetails",get:function(){return k}},{key:"DefaultConfig",get:function(){return e.defaultConfig?e.defaultConfig:ml},set:function(t){e.defaultConfig=t;}}])}();return Ul.defaultConfig=void 0,Ul},"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(r="undefined"!=typeof exports?exports:r||self).Hls=i();}(!1);
!function(e,t){e.bs=e.bs||{},e.bs.player=e.bs.player||{},e.bs.player.plugin=e.bs.player.plugin||{},e.bs.player.plugin.video=e.bs.player.plugin.video||{},e.bs.player.plugin.video.videoPlayer=e.bs.player.plugin.video.videoPlayer||{};var i=require("haxe.Lambda");Math.__name__="Math";var s=require("haxe.Reflect");class a{static string(e){return M.__string_rec(e,"")}static parseInt(e){let t=parseInt(e);return isNaN(t)?null:t}}a.__name__="Std";var r=require("bs.player.core.events.AdEvent"),n=require("bs.player.core.events.ControlEvent"),l=require("bs.player.core.events.DataProviderEvent"),o=require("bs.player.core.events.DataProviderEventScte35Tag"),d=require("bs.player.core.events.VideoEvent"),h=require("bs.player.core.model.Media"),u=require("bs.player.core.model.Live"),c=require("bs.player.core.model.LiveStream"),m=require("bs.player.core.model.VideoQualityEventData");class g{constructor(e,t,i,s,a){this.message=e,this.requestPayload=t,this.httpCode=i,this.responseText=s,this.errorCode=a;}}g.__name__="bs.player.core.model.DrmProxyHandlerLastErrorInfo",Object.assign(g.prototype,{__class__:g});class p{}p.__name__="bs.player.core.model.DrmCustomLicenseServerHandler",p.__isInterface__=!0,Object.assign(p.prototype,{__class__:p});var v=require("bs.player.core.model.Thumbnail");class f{constructor(e){null==e&&(e=5),this.pluginName="";let t=M.getClass(this);this.pluginName=t.__name__.split(".").pop(),this.initPriority=e;let i=this.pluginName,a=exports.configuration;this.pluginConfig=null!=a&&Object.prototype.hasOwnProperty.call(a,i)?s.field(a,i):Object.create(null);}create(){}destroy(){}activate(){}postActivate(){}deactivate(){}eventFilter(e){return !0}registerPlugin(e){}getPluginVersion(){return "v2.15.38"}getPluginName(){return this.pluginName}get_player(){return this.player}set_player(e){return this.player=e}get_variables(){return this.variables}set_variables(e){return this.variables=e}get_eventHub(){return this.eventHub}set_eventHub(e){return this.eventHub=e}get_parentDisplay(){return this.parentDisplay}set_parentDisplay(e){return this.parentDisplay=e}get_display(){return this.display}isCriticalForPlayback(){return !0}}f.__name__="bs.player.core.plugin.PluginBase",Object.assign(f.prototype,{__class__:f});var y=require("bs.player.core.plugin.VideoPlayerUtil");class S{constructor(e){if(this.saveBandwidthModeStore=null,this.hideVideoTag=!1,this.playbackRate=1,this.seekingOverGapRetry=0,this.initialAsAdvertisement=!1,this.isInStreamAdvertisement=!1,this.isAdvertisement=!1,this.isQuickFallbackPathForLiveEnabled=!0,this.minAudioTracksForInfo=2,null==S.instances.h[(e?"ad_":"")+this.context]){if(this.pluginConfig=y.readPluginConfig(this),this.isAdvertisement=e,this.initialAsAdvertisement=e,this.initialBandwidthSafetyFactor=null,this.isInStreamAdvertisement=!1,this.playbackRateMetter=new _(b.isSmartTV()?3:2),this.seekingOverVideoGapMeter=new w(9),this.videoWaitingCallsMeter=new w(40),this.videoStvBitrateOverloadMeterKbps=new k,b.isSmartTV()){let e=localStorage&&localStorage.getItem("bradmax_ovld_meter");this.videoStvBitrateOverloadMeterKbps.loadFromSerialized(e);}this.startTimeStatus=0,this.hasDashJsInitializedSource=!1,this.hasDashJsInitializedManifest=!1,this.hasAudioInitialized=!1,this.hasSubtitlesInitialized=!1,this.hasCodecInfoInitialized=!1,this.hasQualityInfoInitialized=!1,this.isQualitySelectionEnabled=!0,this.hasSeekingStartTriggeded=!1,this.hasProtectionData=!1,this.set_isBuffering(!1),this.shouldBePlaying=!1,this.isPlaybackNotAllowed=!1,this.hasPlaybackSuccStarted=!1,this.hasThumbnailsInitialized=!1,this.liveStreamNowOffset=null,this.liveStreamNowOffsetLastUpdate=0,this.videoRestartsOnError=0,this.prePlaybackSeekRelativePosition=null,this.seekingStartDate=null,this.seekDebouncerTimer=null,this.seekingTargetPos=null,this.seekingTargetTs=null,this.lastDvrWindowStart=null,this.lastDvrWindowEnd=null,this.currentTime=null,this.playbackRateMetter.reset(),this.cleanMediaSetsWaitingForSelection(),this.seekingAvgTime=6,this.scte35PendingEvents=[],this.saveBandwidthModeStore=null,this.unregisterThumbnailProvider();}}create(){n.add(this.context,"selectSubtitles",B(this,this.onSelectSubtitles)),n.add(this.context,"selectAudio",B(this,this.onSelectAudio)),n.add(this.context,"requestVideoQualityChange",B(this,this.onVideoQualityChange)),n.add(this.context,"selectVideoTrack",B(this,this.onSelectVideoTrack)),r.add(this.context,"adInStreamPlaying",B(this,this.onAdInStreamPlaying)),r.add(this.context,"adInStreamPlayingSilent",B(this,this.onAdInStreamPlaying)),r.add(this.context,"adInStreamEnd",B(this,this.onAdInStreamEnd)),r.add(this.context,"adInStreamEndSilent",B(this,this.onAdInStreamEnd)),r.add(this.context,"adInStreamClipPlaying",B(this,this.onAdClipInStreamPlaying)),r.add(this.context,"adInStreamClipPlayingSilent",B(this,this.onAdClipInStreamPlaying)),r.add(this.context,"adInStreamClipEnd",B(this,this.onAdClipInStreamEnd)),r.add(this.context,"adInStreamClipEndSilent",B(this,this.onAdClipInStreamEnd)),r.add(this.context,"adInStreamAdsBreaksInfo",B(this,this.onAdInStreamBreaksInfo));}destroy(){n.remove(this.context,"selectSubtitles",B(this,this.onSelectSubtitles)),n.remove(this.context,"selectAudio",B(this,this.onSelectAudio)),n.remove(this.context,"requestVideoQualityChange",B(this,this.onVideoQualityChange)),n.remove(this.context,"selectVideoTrack",B(this,this.onSelectVideoTrack)),r.remove(this.context,"adInStreamPlaying",B(this,this.onAdInStreamPlaying)),r.remove(this.context,"adInStreamPlayingSilent",B(this,this.onAdInStreamPlaying)),r.remove(this.context,"adInStreamEnd",B(this,this.onAdInStreamEnd)),r.remove(this.context,"adInStreamEndSilent",B(this,this.onAdInStreamEnd)),r.remove(this.context,"adInStreamClipPlaying",B(this,this.onAdClipInStreamPlaying)),r.remove(this.context,"adInStreamClipPlayingSilent",B(this,this.onAdClipInStreamPlaying)),r.remove(this.context,"adInStreamClipEnd",B(this,this.onAdClipInStreamEnd)),r.remove(this.context,"adInStreamClipEndSilent",B(this,this.onAdClipInStreamEnd)),r.remove(this.context,"adInStreamAdsBreaksInfo",B(this,this.onAdInStreamBreaksInfo)),null!=this.video&&this.video.muted!=this.initialVideoIsMuted&&(this.video.muted=this.initialVideoIsMuted),this.cleanVideoAndPlayer(),this.media=null,this.startTimeStatus=0,this.hasDashJsInitializedSource=null,this.hasDashJsInitializedManifest=null,this.hasAudioInitialized=null,this.hasSubtitlesInitialized=null,this.hasCodecInfoInitialized=null,this.hasQualityInfoInitialized=null,this.liveStreamNowOffset=null,this.liveStreamNowOffsetLastUpdate=0,this.videoRestartsOnError=0,this.hasSeekingStartTriggeded=!1,this.hasProtectionData=!1,this.set_isBuffering(!1),this.stopLiveStreamRestartTimeoutTimer(),this.stopLiveStreamRestartDelayTimer(),this.stopLiveEdgeUpdateTimer(),this.stopStreamCompleteWatchdogTimer(),this.stopStreamBufferingWatchdogTimer(),this.stopTokenisedMediaSourceRefreshWatchdogTimer(),this.stopAdsRestoreQualitySettingTimer(),this.unregisterThumbnailProvider(),this.shouldBePlaying=!1,this.isPlaybackNotAllowed=!1,this.hasPlaybackSuccStarted=!1,this.cleanMediaSetsWaitingForSelection(),this.seekingStartDate=null,this.stopSeekDebouncerTimer(),this.lastDvrWindowStart=null,this.lastDvrWindowEnd=null,this.currentTime=null,this.playbackRateMetter.reset(),this.adBreaksInfo=null;}cleanVideoAndPlayer(){if(this.hasProtectionData=!1,null!=this.player)try{this.hasDashJsInitializedSource&&this.player.pause(),this.player.reset();}catch(e){}this.cleanPlayer(),this.player=null,this.video=null,this.source=null,this.cleanMediaSetsWaitingForSelection(),this.hasPlaybackSuccStarted=!1,this.saveBandwidthModeStore=null;}cleanMediaSetsWaitingForSelection(){this.audioSetWaitingForSelection=null,this.subtitlesSetWaitingForSelection=null,this.videoSetWaitingForSelection=null;}set_isBuffering(e){return this.isBuffering=e,this.wasAdWhenBufferingStarted=this.isAdvertisement&&e,this.isBuffering}showHideVideoTag(e){null==e&&(e=!0),null!=this.video&&(this.video.style.display=e?"block":"none",this.video.style.opacity=e?"1":"0",this.video.style.visibility=e?"visible":"hidden");}stopSeekDebouncerTimer(){null!=this.seekDebouncerTimer&&(this.seekDebouncerTimer.stop(),this.seekDebouncerTimer=null);}onAdInStreamPlaying(e){this.isAdvertisement=!0,this.isInStreamAdvertisement=!0,null!=this.media&&null!=this.media.mediaPlaybackInfo&&(this.media.mediaPlaybackInfo.isInStreamAdvertisementPlaying=!0);let t=this.getAdsInStreamMaxQualityScalingRatio();if(null!=t){let e=this.player.getSettings();null!=e&&null!=e.streaming&&null!=e.streaming.abr&&null!=e.streaming.abr.bandwidthSafetyFactor&&(this.initialBandwidthSafetyFactor=e.streaming.abr.bandwidthSafetyFactor),null==this.initialBandwidthSafetyFactor&&(this.initialBandwidthSafetyFactor=.9),e.streaming.abr.bandwidthSafetyFactor=this.initialBandwidthSafetyFactor*t,this.player.updateSettings(e);}}getAdsInStreamMaxQualityScalingRatio(){let e=null;return Object.prototype.hasOwnProperty.call(this.pluginConfig,"daiAdsMaxQualityScalingRatio")&&null!=s.field(this.pluginConfig,"daiAdsMaxQualityScalingRatio")&&(e=s.field(this.pluginConfig,"daiAdsMaxQualityScalingRatio")),e}onAdInStreamEnd(e){this.isAdvertisement=this.initialAsAdvertisement,this.isInStreamAdvertisement=!1,null!=this.media&&null!=this.media.mediaPlaybackInfo&&(this.media.mediaPlaybackInfo.isInStreamAdvertisementPlaying=!1),this.stopAdsRestoreQualitySettingTimer(),this.adsRestoreQualitySettingTimer=D.delay(B(this,this.adsRestoreQualitySetting),8e3);}adsRestoreQualitySetting(){if(this.stopAdsRestoreQualitySettingTimer(),null!=this.getAdsInStreamMaxQualityScalingRatio()&&null!=this.initialBandwidthSafetyFactor){let e=this.player.getSettings();e.streaming.abr.bandwidthSafetyFactor=this.initialBandwidthSafetyFactor,this.player.updateSettings(e);}}stopAdsRestoreQualitySettingTimer(){null!=this.adsRestoreQualitySettingTimer&&(this.adsRestoreQualitySettingTimer.stop(),this.adsRestoreQualitySettingTimer=null);}onAdClipInStreamPlaying(e){null!=this.video&&null!=this.media&&(this.inStreamAdvertStartPos=this.video.currentTime,null!=e.data&&e.data.adStartTime>=0&&(this.inStreamAdvertStartPos=e.data.adStartTime),this.inStreamAdvertMedia=null,null!=e&&null!=e.data&&(this.inStreamAdvertMedia=e.data.media));}onAdClipInStreamEnd(e){this.inStreamAdvertStartPos=null,this.inStreamAdvertMedia=null;}onAdInStreamBreaksInfo(e){null!=e&&null!=e.data&&(this.adBreaksInfo=e.data);}updateMediaPlaybackInfo(){if(null!=this.media&&this.hasAudioInitialized){let e=this.media instanceof u;if(this.media.mediaPlaybackInfo.currentTime=this.currentTime,e&&(this.video.currentTime>86400&&null==this.seekingTargetTs?this.media.mediaPlaybackInfo.currentTime=this.video.currentTime:this.seekingTargetTs>0?this.media.mediaPlaybackInfo.currentTime=this.seekingTargetTs:this.media.mediaPlaybackInfo.currentTime=this.dvrWindowRelativeTimeToTs(this.currentTime)),this.media.mediaPlaybackInfo.isPlaying=!this.video.paused,this.media.mediaPlaybackInfo.currentTotalBitrateKpbs=this.getCurrentTotalBitrateKbps(),this.media.mediaPlaybackInfo.playbackRate=this.getPlaybackRate(),this.playbackRateMetter.setCurrentTime(this.media.mediaPlaybackInfo.currentTime,null,this.video.paused),e){let e=this.media,t=this.getDVRWindowRange();t.end<t.start&&(t=this.getSeekableRange(),this.media.mediaPlaybackInfo.currentTime=this.video.currentTime),e.dvrWindowLength=t.end-t.start,e.dvrWindowLiveEdge=t.end;}}}dispatchEvent(e,t){let i=0,s=null,a=this.currentTime;null!=this.video&&(i=this.video.duration,s=this.video.currentSrc,!isNaN(i)&&null!=i||null==this.media||(i=this.media.duration),this.updateMediaPlaybackInfo(),null!=this.media&&this.hasAudioInitialized&&this.media instanceof u&&(i=this.media.dvrWindowLength,null!=this.dvrWindowStartTimeTs&&null!=this.dvrWindowEndTimeTs&&(i=this.dvrWindowEndTimeTs-this.dvrWindowStartTimeTs))),this.isInStreamAdvertisement&&this.inStreamAdvertStartPos>=0&&(a=this.video.currentTime-this.inStreamAdvertStartPos,null!=this.inStreamAdvertMedia&&(i=this.inStreamAdvertMedia.duration),a>i&&(a=i),0==this.video.currentTime&&a<0&&(a=i,null!=this.media&&null!=this.media.mediaPlaybackInfo&&(this.media.mediaPlaybackInfo.currentTime=this.inStreamAdvertStartPos+i)),a<0&&this.currentTime-this.inStreamAdvertStartPos>=0&&(a=this.currentTime-this.inStreamAdvertStartPos)),null!=this.media&&null!=this.media.mediaPlaybackInfo&&this.scte35PendingEvents.length>0&&this.processPendingScte35Events(),e.data={duration:i,currentTime:a,source:s,media:this.media,additionalData:t},this.isPlaybackNotAllowed&&(null==e.data.additionalData&&(e.data.additionalData={}),e.data.additionalData.isPlaybackNotAllowed=!0);let r=this.getThroughput();null!=r&&(null==e.data.additionalData&&(e.data.additionalData={}),e.data.additionalData.throughput=r),e.dispatch(this.context);}attachSubtitlesRenderer(e){this.subtitlesRenderer=e;}attachVideo(e){if(this.video==e&&!this.hasProtectionData)return;this.cleanPlayer(),Object.prototype.hasOwnProperty.call(this.variables,"qualitySelectionEnabled")&&(this.isQualitySelectionEnabled=s.field(this.variables,"qualitySelectionEnabled")),this.video=e,null!=this.video&&1==this.video.muted&&1!=this.initialVideoIsMuted&&(this.initialVideoIsMuted=!0),this.player=exports.dashjs.MediaPlayer().create(),this.wrapPlayerWithSystam73(this.player),this.wrapPlayerWithQuanteec(this.player,this.media);let t=this;this.player.extend("RequestModifier",(function(){let e=null;return {modifyRequestURL:function(t){return e=t,e},modifyRequestHeader:function(i){return i instanceof XMLHttpRequest&&s.isFunction(i.addEventListener)&&(i.addEventListener("loadstart",(function(i){t.emitNetworkRequestStart(e);})),i.addEventListener("progress",(function(e){t.emitNetworkActivity(e);}))),i}}}),!1),this.player.initialize(e),this.initSubtitlesPlaceholder();let i=Object.prototype.hasOwnProperty.call(this.pluginConfig,"dashSettings")&&null!=s.field(this.pluginConfig,"dashSettings")?this.getDashJsCustomSettings():this.createDashJsSettings();this.player.updateSettings(i),this.updateAutoSwitchQuality(!0),this.player.setProtectionData(null),this.player.on("metricAdded",B(this,this.onDashJsMetricAdded)),this.player.on("qualityChangeRequested",B(this,this.onDashJsQualityChangeRequested)),this.player.on("public_keySessionCreated",B(this,this.onDashJsKeySessionCreated)),this.player.on("error",B(this,this.onDashJsError)),this.player.on("playbackStarted",B(this,this.onDashJsPlaybackStarted)),this.player.on("playbackNotAllowed",B(this,this.onDashJsPlaybackNotAllowed)),this.player.on("inbandEvents",B(this,this.onScte35InbandEvents)),this.player.on("urn:scte:scte35:2013:xml+bin",B(this,this.onScte35MpdEvent)),this.player.on("urn:scte:scte35:2014:xml+bin",B(this,this.onScte35MpdEvent)),this.player.on("gapCausedInternalSeek",B(this,this.onSeekingOverVideoGap)),this.player.on("gapCausedSeekToPeriodEnd",B(this,this.onSeekingOverVideoGap)),this.player.on("manifestUpdated",B(this,this.onManifestUpdated)),this.player.on("public_keyError",B(this,this.onDrmKeyError)),this.video.addEventListener("pause",B(this,this.onDashJsPause)),this.video.addEventListener("play",B(this,this.onDashJsPlay)),this.video.addEventListener("playing",B(this,this.onDashJsPlaying)),this.video.addEventListener("timeupdate",B(this,this.onDashJsTimeupdate)),this.video.addEventListener("durationchange",B(this,this.onDashJsDurationchange)),this.video.addEventListener("waiting",B(this,this.onDashJsWaiting)),this.video.addEventListener("ended",B(this,this.onDashJsEnded)),this.video.addEventListener("seeked",B(this,this.onDashJsSeeked)),null!=this.video.textTracks&&this.video.textTracks.addEventListener("addtrack",B(this,this.onAddTrack)),this.video.addEventListener("ratechange",B(this,this.onVideoRateChange)),this.checkPlaybackRate(),this.triggerVideoPlaybackRateEvent();}getDashJsCustomSettings(){let e=P.copy(s.field(this.pluginConfig,"dashSettings"));return this.updatePlayerConfigWithFastNetworkStalThreshold(e),e}createDashJsSettings(){let e={streaming:{fastSwitchEnabled:!b.isSmartTV(),lowLatencyEnabled:!1,lastMediaSettingsCachingInfo:{enabled:!1},fragmentRequestTimeout:3e4}};Object.prototype.hasOwnProperty.call(this.variables,"saveBandwidthMode")&&M.__cast(this.variables.saveBandwidthMode,L)&&(e.streaming.abr={limitBitrateByPortal:!0,usePixelRatioInLimitBitrateByPortal:!0});let t=this.getQualityInitialBandwidthKbs();return null!=t&&!isNaN(t)&&isFinite(t)&&(e.streaming.abr={initialBitrate:{video:t}}),this.updatePlayerConfigWithFastNetworkStalThreshold(e),e}updatePlayerConfigWithFastNetworkStalThreshold(e){let t=s.field(this.pluginConfig,"fastNetworkStallThreshold"),i=s.field(this.pluginConfig,"fastNetworkMinBitrateMbps");return null!=t&&null!=i&&this.isFastNetworkForStallThreshold(i)&&(null==e.streaming&&(e.streaming={}),e.streaming.stallThreshold=t),e}isFastNetworkForStallThreshold(e){let t=navigator&&navigator.connection&&navigator.connection.downlink,i=this.getDashJsRecentBitrateMbps(6e5),s=null!=i?i:t;return null!=s&&s>=e}getDashJsRecentBitrateMbps(e){let t=null;try{let i=localStorage&&localStorage.getItem("dashjs_video_bitrate");if(null!=i){let s=JSON.parse(i),a=null!=s.bitrate,r=s.timestamp+e>(new Date).getTime();a&&r&&(t=parseFloat(s.bitrate)/1e3);}}catch(e){let t=R.caught(e).unwrap();console.warn(t);}return t}setPlaybackRate(e){this.isAdvertisement||(this.playbackRate=e,this.checkPlaybackRate());}getPlaybackRate(){return null==this.player?1:this.player.getPlaybackRate()}onVideoRateChange(e){this.triggerVideoPlaybackRateEvent();}triggerVideoPlaybackRateEvent(){if(this.isAdvertisement)return;let e=new d("playbackRate");e.data=this.getPlaybackRate(),e.dispatch(this.context);}checkPlaybackRate(){let e;if(this.isAdvertisement)e=!0;else {let t=this.playbackRate;e=isNaN(t);}e||this.getPlaybackRate()==this.playbackRate||this.player.setPlaybackRate(this.playbackRate);}emitNetworkRequestStart(e){let t=new d("networkRequestStart");t.data={url:e},t.dispatch(this.context);}emitNetworkActivity(e){let t=new d("networkActivityUrl");t.data={url:s.field(e.target,"responseURL"),loaded:e.loaded},t.dispatch(this.context);}canUseSystam73Plugin(){if(this.isAdvertisement||0!=this.videoRestartsOnError)return !1;let e=this.plugins,t=i.exists(e,(function(e){return "System73Plugin"==e.getPluginName()}))?i.find(e,(function(e){return "System73Plugin"==e.getPluginName()})):null;return null!=t&&(!(!t.canBeUsed()||!t.hasValidConfig())&&t.hasDashWrapper())}wrapPlayerWithSystam73(e){if(!this.canUseSystam73Plugin()||null==e)return;let t=this.plugins,s=i.exists(t,(function(e){return "System73Plugin"==e.getPluginName()}))?i.find(t,(function(e){return "System73Plugin"==e.getPluginName()})):null;s.wrapDash(),s.wrapDashPlayer(e);}destroySystem73(){if(!this.canUseSystam73Plugin())return;let e=this.plugins;(i.exists(e,(function(e){return "System73Plugin"==e.getPluginName()}))?i.find(e,(function(e){return "System73Plugin"==e.getPluginName()})):null).destroyWrapper();}canUseQuanteecPlugin(){if(this.isAdvertisement||0!=this.videoRestartsOnError)return !1;let e=this.plugins,t=i.exists(e,(function(e){return "QuanteecPlugin"==e.getPluginName()}))?i.find(e,(function(e){return "QuanteecPlugin"==e.getPluginName()})):null;return null!=t&&(!!t.hasValidConfig()&&t.hasDashWrapper())}wrapPlayerWithQuanteec(e,t){if(!this.canUseQuanteecPlugin())return;let s=this.plugins;(i.exists(s,(function(e){return "QuanteecPlugin"==e.getPluginName()}))?i.find(s,(function(e){return "QuanteecPlugin"==e.getPluginName()})):null).wrapDashPlayer(e,t);}updateQuanteecWrapper(e){if(!this.canUseQuanteecPlugin())return;let t=this.plugins;(i.exists(t,(function(e){return "QuanteecPlugin"==e.getPluginName()}))?i.find(t,(function(e){return "QuanteecPlugin"==e.getPluginName()})):null).updateConfigFromMedia(e);}destroyQuanteec(){if(!this.canUseQuanteecPlugin())return;let e=this.plugins;(i.exists(e,(function(e){return "QuanteecPlugin"==e.getPluginName()}))?i.find(e,(function(e){return "QuanteecPlugin"==e.getPluginName()})):null).destroyWrapper();}cleanPlayer(){this.destroySystem73(),this.destroyQuanteec(),null!=this.video&&(this.video.removeEventListener("pause",B(this,this.onDashJsPause)),this.video.removeEventListener("play",B(this,this.onDashJsPlay)),this.video.removeEventListener("playing",B(this,this.onDashJsPlaying)),this.video.removeEventListener("timeupdate",B(this,this.onDashJsTimeupdate)),this.video.removeEventListener("durationchange",B(this,this.onDashJsDurationchange)),this.video.removeEventListener("waiting",B(this,this.onDashJsWaiting)),this.video.removeEventListener("ended",B(this,this.onDashJsEnded)),this.video.removeEventListener("seeked",B(this,this.onDashJsSeeked)),null!=this.video.textTracks&&this.video.textTracks.removeEventListener("addtrack",B(this,this.onAddTrack)),this.video.removeEventListener("ratechange",B(this,this.onVideoRateChange))),null!=this.player&&(this.player.off("metricAdded",B(this,this.onDashJsMetricAdded)),this.player.off("qualityChangeRequested",B(this,this.onDashJsQualityChangeRequested)),this.player.off("public_keySessionCreated",B(this,this.onDashJsKeySessionCreated)),this.player.off("error",B(this,this.onDashJsError)),this.player.off("playbackStarted",B(this,this.onDashJsPlaybackStarted)),this.player.off("playbackNotAllowed",B(this,this.onDashJsPlaybackNotAllowed)),this.player.off("inbandEvents",B(this,this.onScte35InbandEvents)),this.player.off("urn:scte:scte35:2013:xml+bin",B(this,this.onScte35MpdEvent)),this.player.off("urn:scte:scte35:2014:xml+bin",B(this,this.onScte35MpdEvent)),this.player.off("gapCausedInternalSeek",B(this,this.onSeekingOverVideoGap)),this.player.off("gapCausedSeekToPeriodEnd",B(this,this.onSeekingOverVideoGap)),this.player.off("manifestUpdated",B(this,this.onManifestUpdated)),this.player.off("public_keyError",B(this,this.onDrmKeyError)),this.reset(),this.player=null,this.video=null);}isPaused(){return null==this.video||this.video.paused}onDashJsPause(e){return this.media instanceof u&&this.isDrmSessionReused()&&!this.hasPlaybackSuccStarted||(null==this.seekDebouncerTimer&&this.dispatchEvent(this.isAdvertisement?new r("adPaused"):new d("paused")),this.media instanceof u||null==this.video||this.video.currentTime>0&&Math.abs(this.video.currentTime-this.video.duration)<.5&&(this.streamCompleteWatchdogTimer=D.delay(B(this,this.onStreamCompleteWatchdogTimeout),1e3))),null}onDashJsPlay(e){return this.isBrowserStillDecodingAfterBuffering()||this.hasSeekingStartTriggeded||this.isBuffering||(this.checkPlaybackRate(),this.dispatchEvent(this.isAdvertisement?new r("adPlaying"):new d("playing"))),null}isBrowserStillDecodingAfterBuffering(){return this.media instanceof u?!(this.media.dvrWindowLiveEdge>0):null!=this.video&&0==this.video.playbackRate}onDashJsPlaying(e){this.hasSeekingStartTriggeded&&this.onDashJsSeeked({dashFakeEventFix:!0});let t=b.isSmartTV()&&!this.playbackRateMetter.isPlayingNormal(!0);return this.isBrowserStillDecodingAfterBuffering()||t?("Firefox"==b.browserName&&(this.firefoxDrmDecodeLagTimerTs=this.getNowTs()),!this.isBuffering&&this.shouldBufferingBeVisible()&&(this.set_isBuffering(!0),this.dispatchEvent(this.isAdvertisement?new r("adBufferingStart"):new d("bufferingStart")))):(null!=this.firefoxDrmDecodeLagTimerTs&&(this.firefoxDrmDecodeLag=this.getNowTs()-this.firefoxDrmDecodeLagTimerTs,this.firefoxDrmDecodeLagTimerTs=null),this.isBuffering||this.dispatchEvent(this.isAdvertisement?new r("adPlaying"):new d("playing"))),this.initializePlaybackStartTimeIfNeeded(),this.stopLiveStreamRestartTimeoutTimer(),this.stopLiveStreamRestartDelayTimer(),this.stopStreamBufferingWatchdogTimer(),this.stopTokenisedMediaSourceRefreshWatchdogTimer(),!this.isBrowserStillDecodingAfterBuffering()&&this.isBuffering&&!t&&null!=this.video&&(this.video.playbackRate>0||null==this.video.playbackRate)&&(this.dispatchEvent(this.wasAdWhenBufferingStarted?new r("adBufferingEnd"):new d("bufferingEnd")),this.set_isBuffering(!1),this.shouldBePlaying&&this.dispatchEvent(this.isAdvertisement?new r("adPlaying"):new d("playing"))),null}initializePlaybackStartTimeIfNeeded(){if(0==this.startTimeStatus&&null!=this.video){let e=this.media instanceof u?4:1;if(b.isSmartTV()&&!b.isSamsungSmartTVTizen&&(e=4),this.video.readyState>=e){this.startTimeStatus=1,this.onDashJsDurationchange({});let e=this.getPlaybackStartTime(this.media),t=e;e>0&&this.hasDashJsInitializedSource?(this.media instanceof u&&(e=this.normalizeDvrTime(e),t=this.dvrTimestampToRelativeTime(e),t<=this.getLiveMinimalInitialOffsetForOldestPart()&&(t="Firefox"==b.browserName&&null!=this.firefoxDrmDecodeLag?1.25*this.firefoxDrmDecodeLag+this.getLiveMinimalInitialOffsetForOldestPart():this.getLiveMinimalInitialOffsetForOldestPart(),e=this.dvrWindowRelativeTimeToTs(t))),t<this.video.duration?(this.currentTime=t,this.updateMediaPlaybackInfo(),this.performPlayerSeek(e,!1)):(this.startTimeStatus=2,this.onStartTimeInitFinalized(),console.warn("Warning: Start time is ignored. Start time for video got invalid value (startTime: "+e+", duration:"+this.video.duration+")."))):(this.startTimeStatus=2,this.onStartTimeInitFinalized());}}if(null!=this.prePlaybackSeekRelativePosition&&this.video.readyState>=1){let e=this.prePlaybackSeekRelativePosition;this.prePlaybackSeekRelativePosition=null,this.video.duration>0&&Math.abs(this.video.duration-this.media.duration)>2&&(this.seek(e*this.video.duration),this.pause());}}onStartTimeInitFinalized(){this.media instanceof u&&null!=this.video&&!this.video.paused&&!this.shouldBePlaying&&this.player.pause();}checkIfVideoBlockedByBrowser(){if(!this.isPlaybackNotAllowed||this.isBuffering||null==this.video||this.video.paused||this.video.seeking||(this.isPlaybackNotAllowed=!1),2==this.startTimeStatus&&this.video.playbackRate>0&&1==this.hideVideoTag){this.hideVideoTag=!1,null!=this.video&&(this.video.style.display="block",this.video.style.opacity="1",this.video.style.visibility="visible");let e=!1,t=this.video.paused;try{this.video.muted=this.initialVideoIsMuted;let i=!this.initialVideoIsMuted&&this.video.muted!=this.initialVideoIsMuted,s=!t&&this.video.paused;e=i||s;}catch(t){e=!0;}e&&this.onDashJsPlaybackNotAllowed({});}}onDashJsTimeupdate(e){let t,i,s=this.media instanceof u,a=null!=this.dvrWindowStartTimeTs||null!=this.dvrWindowEndTimeTs,l=this.getNowTs();if(this.playbackRateMetter.isPlayingNormal()&&this.lastRestartTs>0&&l-this.lastRestartTs>3&&(this.videoRestartsOnError=0),this.stopStreamBufferingWatchdogTimer(),b.isSamsungSmartTVTizen&&this.initializePlaybackStartTimeIfNeeded(),this.hasPlaybackSuccStarted)t=!1;else {let e=this.video;t=(null!=e?e.readyState:null)>=4;}if(t&&this.currentTime>0&&(this.hasPlaybackSuccStarted=!0,this.selectMediaTrackSetsAfterInitialization()),s&&!a&&null==this.liveStreamNowOffset){let e=this.getDVRWindowRange();null==e||e.end<=0||(this.liveStreamNowOffset=l-e.end,null==this.dvrWindowStartTimeTs&&null==this.dvrWindowEndTimeTs&&0<this.liveStreamNowOffset&&this.liveStreamNowOffset<.025*(e.end-e.start)&&(this.liveStreamNowOffset=0),this.liveStreamNowOffsetLastUpdate=l);}if(s&&a&&l-this.liveStreamNowOffsetLastUpdate>1){let e=this.getDVRWindowRange();null==e||e.end<=0||(this.liveStreamNowOffset=l-e.end,null==this.dvrWindowStartTimeTs&&null==this.dvrWindowEndTimeTs&&0<this.liveStreamNowOffset&&this.liveStreamNowOffset<.025*(e.end-e.start)&&(this.liveStreamNowOffset=0),this.liveStreamNowOffsetLastUpdate=l);}if(s&&null==this.liveEdgeUpdateTimer&&(this.liveEdgeUpdateTimer=new D(1e3),this.liveEdgeUpdateTimer.run=B(this,this.onLiveEdgeUpdate),this.seekableInitialRange=this.getSeekableRange()),this.checkIfVideoBlockedByBrowser(),this.video.currentTime<=.1||null==this.video.currentTime){if(this.lastGapEnd>0&&Math.abs(this.currentTime-this.lastGapEnd)<3)return console.warn("bradmax.player.onDashJsTimeupdate Warning: Video discontinuity detected. Skipping time update."),null;let e=!1;try{let t=0,i=this.video.buffered.length;for(;t<i;){let i=t++;this.video.buffered.start(i)<=0&&0<=this.video.buffered.end(i)&&(e=!0);}}catch(e){console.warn("bradmax.player.onDashJsTimeupdate Warning: Cannot check video buffer level. Exception catched. Probably video/buffer detatched from DOM.");}if(!e)return console.warn("bradmax.player.onDashJsTimeupdate Warning: Video discontinuity detected[2]. Skipping time update."),null}if(null==this.seekDebouncerTimer){let t=this.video.currentTime;if(s&&(t=this.dvrWindowRelativeTimeFromTs(t)),null!=this.seekingTargetPos&&this.video.currentTime<this.seekingTargetPos&&this.seekingTargetPos-10<this.video.currentTime)return null;if(null!=this.currentTime&&null!=t&&t<this.currentTime&&t<=.1&&(null==e||!e.isPeriodicalUpdate))return null;this.seekingTargetPos=null,this.currentTime=t,this.updateMediaPlaybackInfo();}if(this.shouldCurrentTimeChangeBeTriggered()&&this.dispatchEvent(this.isAdvertisement?new r("adCurrentTimeChange"):new d("currentTimeChange")),this.isBuffering){let e=this.video;i=(null!=e?e.readyState:null)>=4;}else i=!1;return i&&!this.video.paused&&!this.video.seeking&&this.playbackRateMetter.isPlayingNormal()&&(this.video.playbackRate>0||null==this.video.playbackRate)&&(this.dispatchEvent(this.wasAdWhenBufferingStarted?new r("adBufferingEnd"):new d("bufferingEnd")),this.set_isBuffering(!1),this.shouldBePlaying&&this.dispatchEvent(this.isAdvertisement?new r("adPlaying"):new d("playing"))),s&&null!=this.dvrWindowEndTimeTs&&2==this.startTimeStatus&&this.media.mediaPlaybackInfo.currentTime>this.dvrWindowEndTimeTs&&(new n("skinPause").dispatch(this.context),this.stopStreamCompleteWatchdogTimer(),this.dispatchVideoComplete()),null}shouldCurrentTimeChangeBeTriggered(){let e=this.isDrmSessionReused()&&this.shouldBePlaying;return !(2!=this.startTimeStatus&&!this.hasPlaybackSuccStarted)&&!(e&&!this.media.mediaPlaybackInfo.isPlaying)}createScte35TagFromDashEvent(e){let t=new o;return t.presentationTime=e.calculatedPresentationTime,t.messageData=e.messageData,t}processPendingScte35Events(){let e=0,t=0,i=this.scte35PendingEvents;for(;t<i.length;){let s=i[t];if(++t,s.calculatedPresentationTime<=this.media.mediaPlaybackInfo.currentTime){let t=new l("scte35Tag");t.data=this.createScte35TagFromDashEvent(s),t.dispatch(this.context),++e;}}if(e>0){let e=[],t=0,i=this.scte35PendingEvents;for(;t<i.length;){let s=i[t];++t,s.calculatedPresentationTime>this.media.mediaPlaybackInfo.currentTime&&e.push(s);}this.scte35PendingEvents=e;}}updateLastStreamNowOffsetParam(e){let t=this.getDVRWindowRange();null==t||t.end<=0||(this.liveStreamNowOffset=e-t.end,null==this.dvrWindowStartTimeTs&&null==this.dvrWindowEndTimeTs&&0<this.liveStreamNowOffset&&this.liveStreamNowOffset<.025*(t.end-t.start)&&(this.liveStreamNowOffset=0),this.liveStreamNowOffsetLastUpdate=e);}onDashJsDurationchange(e){if(this.initializePlaybackStartTimeIfNeeded(),this.registerThumbnailProvider(),this.media instanceof h&&!(this.media instanceof u)&&this.video.duration==1/0){let e=new u;this.media.copyFieldsTo(e),this.media=e;let t=new l("mediaAfterPlaybackStartMetadata");t.data=e,t.dispatch(this.context);}if(this.media instanceof u&&this.video.duration!=1/0&&this.video.duration>0){let e=new h;this.media.copyFieldsTo(e),this.media=e;let t=new l("mediaAfterPlaybackStartMetadata");t.data=this.media,t.dispatch(this.context);}return this.media.duration=this.video.duration,this.dispatchEvent(this.isAdvertisement?new r("adDurationChange"):new d("durationChange")),null}getBufferLevel(){if(null!=this.video&&null!=this.video.buffered){let e=0,t=this.video.buffered.length;for(;e<t;){let t=e++;if(this.video.buffered.start(t)<=this.video.currentTime&&this.video.currentTime<=this.video.buffered.end(t)){return this.video.buffered.end(t)-this.video.currentTime}}}return null}onDashJsWaiting(e){if(this.androidVideoBufferFix(),!this.isBuffering&&this.shouldBufferingBeVisible()&&(this.set_isBuffering(!0),this.dispatchEvent(this.isAdvertisement?new r("adBufferingStart"):new d("bufferingStart")),this.videoWaitingCallsMeter.add(),this.isDevicePerformanceOverloading())){let e=this.player.getSettings(),t=this.player.getBitrateInfoListFor("video");if(null!=e&&null!=e.streaming&&null!=e.streaming.abr&&null!=e.streaming.abr.maxBitrate&&null!=t&&t.length>0){let i=this.player.getQualityFor("video");i>0&&(this.videoStvBitrateOverloadMeterKbps.addOverloadVal(t[i].bitrate/1e3),e.streaming.abr.maxBitrate.video=this.videoStvBitrateOverloadMeterKbps.getLoad(),this.player.updateSettings(e),this.storeVideoStvBitrateOverloadMeterKbps());}}return this.stopStreamBufferingWatchdogTimer(),this.streamBufferingWatchdogTimer=D.delay(B(this,this.onStreamBufferingWatchdogTimeout),22e3),null}isDevicePerformanceOverloading(){return !!(null!=this.player&&b.isSmartTV()&&this.videoWaitingCallsMeter.getLoad()>2.2)&&this.getBufferLevel()>20}storeVideoStvBitrateOverloadMeterKbps(){localStorage&&localStorage.setItem("bradmax_ovld_meter",this.videoStvBitrateOverloadMeterKbps.serialize());}androidVideoBufferFix(){b.isAndroid&&"Chrome"==b.browserName&&null!=this.video&&(this.video.style.transform="rotate(0.1deg)");}shouldBufferingBeVisible(){let e=null!=this.getAdsInStreamMaxQualityScalingRatio(),t=!1;try{if(e&&null!=this.player&&null!=this.player.getActiveStream()&&null!=this.video){let e=this.player.getActiveStream().getProcessors(),i=0;for(;i<e.length;){let s=e[i++].getBuffer().getBuffer().buffered;if(null==s)continue;let a=0,r=s.length;for(;a<r;)Math.abs(this.video.currentTime-s.end(a++))<.5&&(t=!0);}null!=this.lastGapEnd&&Math.abs(this.video.currentTime-this.lastGapEnd)<.5&&(t=!0);}}catch(e){console.warn("bradmax.player.bufferingInfo Warning: Cannot check video buffer level. Exception catched. Probably video/buffer detatched from DOM.");}return !this.isInStreamAdvertisement&&!t||!e}onAddTrack(e){let t=this.isAdvertisement?new r("addTrack"):new d("addTrack");t.data={track:e},t.dispatch(this.context);}onScte35InbandEvents(e){if(null!=e&&null!=e.events&&e.events.length>0){let t=e.events,i=0;for(;i<t.length;){let e=t[i];++i,e.calculatedPresentationTime>0&&this.scte35PendingEvents.push(e);}}}onScte35MpdEvent(e){if(null!=e&&null!=e.event){let t=new l("scte35Tag");(null==e.event.calculatedPresentationTime||e.event.duration>0||Math.abs(e.event.calculatedPresentationTime-this.currentTime)<100)&&(t.data=this.createScte35TagFromDashEvent(e.event),t.dispatch(this.context));}if(null!=e&&null!=e.availableEvents&&e.availableEvents.length>0){let t=new l("scte35AvailableTags"),i=[],s=e.availableEvents,a=0;for(;a<s.length;){let e=s[a];++a;let t=new o;t.duration=e.duration,t.presentationTime=e.calculatedPresentationTime,t.messageData=e.messageData,i.push(t);}t.data=i,t.dispatch(this.context);}}onSeekingOverVideoGap(e){if(null!=e&&e.seekTime>0&&(this.lastGapEnd=e.seekTime),this.isInStreamAdvertisement&&(this.currentTime=e.seekTime,this.dispatchEvent(this.isAdvertisement?new r("adCurrentTimeChange"):new d("currentTimeChange"))),this.isBuffering||(this.set_isBuffering(!0),this.dispatchEvent(this.isAdvertisement?new r("adBufferingStart"):new d("bufferingStart"))),this.seekingOverVideoGapMeter.add(),this.seekingOverVideoGapMeter.getLoad()>4){let e=this.prevLastGapEnd;this.prevLastGapEnd=this.lastGapEnd,e==this.lastGapEnd?this.seekingOverGapRetry+=1:this.seekingOverGapRetry=1;let t=this.currentTime+3*this.seekingOverGapRetry;console.warn("Warning: Part of video cannot be decoded and is still restarting. Jumping further over it to: "+t);let i=3*this.seekingOverGapRetry;if(this.dispatchEvent(new d("videoBufferGap"),{gapSize:i}),this.media.duration>0&&!(this.media instanceof u))this.seek(t);else {let e=this.media;if(!(this.videoRestartsOnError<(null!=e?e.getLimitOfRestartsOnError():null)))return void this.handleDecodeErrorOnMultipleRestarts();this.player.pause(),this.handleVideoRestart(),this.seek(t);}}if(null!=e&&e.duration>10){let e=this.currentTime+1;this.player.pause(),this.media.mediaUserSettings.resumePostion=e;let t=this.media;if(!(this.videoRestartsOnError<(null!=t?t.getLimitOfRestartsOnError():null)))return void this.handleDecodeErrorOnMultipleRestarts();this.handleVideoRestart();}}onManifestUpdated(e){return null!=e&&null!=e.manifest&&null!=e.manifest.url&&this.source!=e.manifest.url&&null!=this.media&&null!=this.media.source&&this.media.source.length>0&&null!=this.media.source[0]&&this.source==this.media.source[0].url&&(this.source=e.manifest.url,this.media.source[0].url=this.source),null}onDrmKeyError(e){return this.onDashJsError({data:{message:"DRM error. Cannot decode video with provided license key. License key is invalid."},error:{message:"DRM error. Cannot decode video with provided license key. License key is invalid."}}),null}onDashJsEnded(e){return this.stopStreamCompleteWatchdogTimer(),this.dispatchVideoComplete(),null}onDashJsSeeked(e){this.androidVideoBufferFix();let t=this.hasSeekingStartTriggeded;this.hasSeekingStartTriggeded=!1,1==this.startTimeStatus&&(this.startTimeStatus=2,this.onStartTimeInitFinalized(),this.shouldBePlaying&&this.play());let i=0;if(null!=this.seekingStartDate&&(i=((new Date).getTime()-this.seekingStartDate.getTime())/1e3,this.seekingAvgTime<i?this.seekingAvgTime=i:this.seekingAvgTime=.5*this.seekingAvgTime+.5*i),this.media instanceof u){let e=this.getDVRWindowRange(),t=this.getSeekableRange();if(null!=this.seekableInitialRange&&Math.abs(this.seekableInitialRange.start-t.start)>1&&!this.isDVRRecordedForStartOver(t)&&this.video.currentTime<e.start)return this.seek(3*this.getLiveMinimalInitialOffsetForOldestPart()),null}return t&&this.dispatchEvent(this.isAdvertisement?new r("seekingEnd"):new d("seekingEnd"),Object.prototype.hasOwnProperty.call(e,"dashFakeEventFix")?{dashFakeEventFix:!0}:null),this.stopStreamBufferingWatchdogTimer(),this.seekingTargetTs=null,!this.shouldBePlaying&&this.isBuffering&&(this.dispatchEvent(this.wasAdWhenBufferingStarted?new r("adBufferingEnd"):new d("bufferingEnd")),this.set_isBuffering(!1),this.dispatchEvent(this.isAdvertisement?new r("adPaused"):new d("paused"))),null}getLiveMinimalInitialOffsetForOldestPart(){return null!=this.dvrWindowStartTimeTs?0:1.5*this.seekingAvgTime}onDashJsPlaybackStarted(e){return this.shouldBePlaying||this.pause(),null}onDashJsPlaybackNotAllowed(e){return this.log("BRADMAX PLAYER NOTICE:\nBrowser doesn't allow for autoplaying video without user interaction.\nPlayer is waiting for user 'play' click. You can autoplay muted video (mute=true).\n\nMode details about browser autoplay policy: https://developers.google.com/web/updates/2017/09/autoplay-policy-changes","warn"),this.isPlaybackNotAllowed=!0,null!=this.player&&this.player.pause(),this.dispatchEvent(this.isAdvertisement?new r("adCurrentTimeChange"):new d("currentTimeChange")),this.dispatchEvent(this.isAdvertisement?new r("adPaused"):new d("paused")),this.shouldBePlaying=!1,null}onDashJsError(e){if(this.isAdvertisement&&!this.isInStreamAdvertisement)return this.dispatchEvent(new r("adMediaError"),this.prepareErrorMessage(e)),null;if(!(null==e||null!=e.data||null!=this.video.getAttribute("src")&&""!=this.video.getAttribute("src")||this.hasProtectionData||this.isNetworkConnectionProblem(e)))return null;if(null!=this.video&&(this.hideVideoTag=!1,null!=this.video&&(this.video.style.display="block",this.video.style.opacity="1",this.video.style.visibility="visible"),this.video.muted=this.initialVideoIsMuted),null!=e&&null!=e.error&&null!=e.error.message){let t="bradmax.player.error: "+a.string(e.error.message);console.error(t),console.error(e);}let t,i=!0,s=this.media instanceof u,n=b.isAndroid&&"Chrome"==b.browserName&&null!=e&&null!=e.error&&(112==e.error.code||113==e.error.code)&&"MediaKeys"in window||"WebKitMediaKeys"in window||"MSMediaKeys"in window&&null!=this.media&&null!=this.media.drmCustomLicenseServerHandler,l=s&&110==e.error.code,o=null!=e&&e.isTokenisedMediaSourceError,h=!(null==e||null==e.error||null==e.error.message||-1==e.error.message.indexOf("DRM err")&&-1==e.error.message.indexOf("DRM:")||l||this.isDrmCustomHanlerBrokenConnectionError()),c=this.isQuickFallbackPathForLiveEnabled&&s&&this.media.hasFallbackSources(),m=!n&&(!h||b.isSamsungSmartTVTizen)&&!c&&(s||Object.prototype.hasOwnProperty.call(this.media.customParams.h,"maxRestartsNumOnPlaybackError"))&&!o,g=this;if(m){let e=this.media;t=this.videoRestartsOnError<(null!=e?e.getLimitOfRestartsOnError():null);}else t=!1;if(t){i=!1;let t=this.isDrmSessionReused()&&h;this.stopLiveStreamRestartTimeoutTimer(),this.stopLiveStreamRestartDelayTimer(),this.stopStreamCompleteWatchdogTimer(),this.stopStreamBufferingWatchdogTimer(),this.liveStreamRestartDelayTimer=D.delay((function(){g.handleVideoRestartOnError(e);}),s&&!t?5e3:0);}if(i)if(this.stopLiveStreamRestartTimeoutTimer(),this.stopLiveStreamRestartDelayTimer(),this.stopStreamCompleteWatchdogTimer(),this.stopStreamBufferingWatchdogTimer(),n)this.dispatchEvent(new d("drmModuleCrush"),this.prepareErrorMessage(e)),this.reset();else if(null!=this.media&&null!=this.media.drmCustomLicenseServerHandler&&null!=this.media.drmCustomLicenseServerHandler.getLastError())this.dispatchEvent(new d("drmAuthenticationError"),this.prepareErrorMessage(this.media.drmCustomLicenseServerHandler.getLastError())),this.reset();else if(h)if(c){console.warn("bradmax.player Warning: There were problems with DRM module. Trying to use available fallback stream.");let t=this.prepareErrorMessage(e);t.isTemporaryNetworkIssue=!0,this.dispatchEvent(this.isAdvertisement?new r("adMediaError"):new d("loadError"),t),this.reset();}else this.dispatchEvent(new d("drmAuthenticationError"),this.prepareErrorMessage(e)),this.reset();else if(this.isNetworkConnectionProblem(e))if(this.hasPlaybackSuccStarted){this.dispatchEvent(this.isAdvertisement?new r("adConnectionError"):new d("connectionError"),this.prepareErrorMessage(e));try{null!=this.player&&this.player.pause();}catch(e){}}else {let t=this.prepareErrorMessage(e);t.isTemporaryNetworkIssue=!1,this.dispatchEvent(this.isAdvertisement?new r("adMediaError"):new d("loadError"),t),this.reset();}else this.dispatchEvent(this.isAdvertisement?new r("adMediaError"):new d("mediaError"),this.prepareErrorMessage(e)),this.reset();return null}isDrmCustomHanlerBrokenConnectionError(){let e=this.media,t=null!=e?e.drmCustomLicenseServerHandler:null,i=null!=t?t.getLastError():null;return null!=i&&(null==i.httpCode||0==i.httpCode)}prepareErrorMessage(e){let t=this.isNetworkConnectionProblem(e)&&(this.media instanceof c||this.video.currentTime>0||null!=e&&null!=e.error&&null!=e.error.data&&null!=e.error.data.response&&e.error.data.response.status>=500||null!=this.media.mediaUserSettings&&this.media.mediaUserSettings.resumePostion>0),i="";return null!=e&&null!=e.error&&null!=e.error.message&&(i=""+a.string(e.error.message)),{errObj:e,isTemporaryNetworkIssue:t,message:i}}isNetworkConnectionProblem(e){return null!=e&&null!=e.error&&25<=e.error.code&&e.error.code<=29}handleVideoRestartOnError(e){this.media instanceof u||null==this.media||null==this.media.mediaUserSettings||(this.media.mediaUserSettings.resumePostion=this.currentTime);let t=this;if(null!=this.media&&null!=this.media.source&&this.media.source.length>0&&null!=this.media.source[0]&&this.media.source[0].isTokenised){this.stopTokenisedMediaSourceRefreshWatchdogTimer(),this.tokenisedMediaSourceRefreshWatchdogTimer=D.delay(B(this,this.onTokenisedMediaSourceRefreshTimeout),5e3),l.addOnce(this.context,"tokenisedMediaSourceRefresgDone",(function(e){null!=e&&null!=e.data&&e.data.success?t.handleVideoRestartOnErrorFinalize(e.errorEvent):t.onDashJsError({data:{message:"Tokenised MediaSource refresh failed. Cannot handle safe player restart without new URL."},error:{message:"Tokenised MediaSource refresh failed. Cannot handle safe player restart without new URL."},isTokenisedMediaSourceError:!0});}));let i=new l("tokenisedMediaSourceRefresgReq");i.data={mediaSource:this.media.source[0],errorEvent:e},i.dispatch(this.context);}else this.handleVideoRestartOnErrorFinalize(e);}handleVideoRestartOnErrorFinalize(e){this.handleVideoRestart();let t=this.prepareErrorMessage(e);t.currTry=this.videoRestartsOnError,this.dispatchEvent(this.isAdvertisement?new r("adMediaErrorFallbackTry"):new d("mediaErrorFallbackTry"),t);}handleVideoRestart(){this.videoRestartsOnError++,this.lastRestartTs=this.getNowTs(),null!=this.media&&null!=this.media.drmCustomLicenseServerHandler&&this.media.drmCustomLicenseServerHandler.clearCertCache(),this.stopLiveStreamRestartTimeoutTimer(),this.stopLiveStreamRestartDelayTimer(),this.stopStreamBufferingWatchdogTimer(),this.playbackRateMetter.reset(),this.startTimeStatus=0,this.isBuffering||(this.set_isBuffering(!0),this.dispatchEvent(this.isAdvertisement?new r("adBufferingStart"):new d("bufferingStart")));let e=this.video;e.muted&&!this.initialVideoIsMuted&&(e.muted=this.initialVideoIsMuted),this.cleanVideoAndPlayer(),this.hasDashJsInitializedSource=!1,null!=e&&null!=e._bp&&null!=e._bp.videoElementInfo&&e._bp.videoElementInfo.cleanVideoElementAndDrmSession(),this.attachVideo(e),null!=this.subtitlesSelected&&(this.subtitlesSetWaitingForSelection=this.subtitlesSelected),this.play(),this.media instanceof u&&(this.liveStreamRestartTimeoutTimer=D.delay(B(this,this.onDashJsLivestreamRestartTimeout),5e3*(1+(this.videoRestartsOnError-1)/4)|0));}onDashJsLivestreamRestartTimeout(){let e=this.media;this.videoRestartsOnError<(null!=e?e.getLimitOfRestartsOnError():null)?this.handleVideoRestart():this.dispatchEvent(this.isAdvertisement?new r("adConnectionError"):new d("connectionError"),{message:"Livestream restart all tries failed.",isTemporaryNetworkIssue:!0});}isDrmSessionReused(){let e=this.video;return null!=e&&null!=e._bp&&null!=e._bp.isDrmSessionReused&&e._bp.isDrmSessionReused}onDashJsMetricAdded(e){if(null!=e&&null!=e.metric){if("ManifestUpdate"==e.metric&&(this.hasDashJsInitializedManifest=!0),!this.hasAudioInitialized&&this.hasDashJsInitializedManifest&&"SchedulingInfo"==e.metric){let e=this.player,t=null!=e?e.getTracksFor("video"):null,i=this.player,s=null!=i?i.getTracksFor("audio"):null;null!=t&&t.length>0&&null!=s&&s.length>0&&(this.hasAudioInitialized=!0,this.updateAudioSets(),this.updateVideoSets());}if(!this.hasSubtitlesInitialized&&null!=this.video.textTracks&&this.video.textTracks.length>0&&(this.hasSubtitlesInitialized=!0,this.updateSubtitlesSets()),!this.hasCodecInfoInitialized&&"RepSwitchList"==e.metric){let e=this.player.getCurrentTrackFor("video"),t=this.player.getCurrentTrackFor("audio");if(null!=e&&Object.prototype.hasOwnProperty.call(e,"codec")&&null!=t&&Object.prototype.hasOwnProperty.call(t,"codec")){let i=new l("codecData"),s=function(e){let t=e.split(";"),i=0;for(;i<t.length;){let e=t[i];if(++i,0==e.indexOf("codecs")){let t=e.split("=");if(t.length>0)return t[1].split('"').join("")}}return ""};i.data={videoCodec:s(e.codec),audioCodec:s(t.codec)},i.dispatch(this.context),this.hasCodecInfoInitialized=!0;}}if(this.isQualitySelectionEnabled&&!this.hasQualityInfoInitialized&&"RepSwitchList"==e.metric){let e=this.player.getBitrateInfoListFor("video");if(null!=e&&e.length>1){this.hasQualityInfoInitialized=!0;let e=new l("videoQualityData"),t=this.getQualityLevels();e.data=t,e.dispatch(this.context);let i=this.player.getQualityFor("video");if(null!=i){let e=new l("videoQualityPlaybackLevelChange");e.data=i,e.dispatch(this.context);}let s=this.videoStvBitrateOverloadMeterKbps.nextTry();if(t.length>1&&b.isSmartTV()){let e=this.player.getSettings();null!=e&&null!=e.streaming&&null!=e.streaming.abr&&null!=e.streaming.abr.maxBitrate&&(e.streaming.abr.maxBitrate.video=s,this.player.updateSettings(e),this.storeVideoStvBitrateOverloadMeterKbps(),this.dispatchEvent(new d("videoDecodeOverload"),{overloadVal:s}));}let a=new n("videoQualityHasChanged"),r=this.getQualityInitialBandwidthKbs();null!=r&&!isNaN(r)&&isFinite(r)?a.data=i:a.data="-1",a.dispatch(this.context);}}}return null}registerThumbnailProvider(){if(1!=this.hasThumbnailsInitialized){this.unregisterThumbnailProvider();try{let e=this.player,t=null!=e?e.getTracksFor("image"):null;(null!=t?t.length:null)>0&&(exports.thumbnailProvider=B(this,this.thumbnailProvider),this.hasThumbnailsInitialized=!0);}catch(e){let t="bradmax.player Warning: Problem with registering thumbnail profider. Exception catched: "+a.string(R.caught(e).unwrap());console.warn(t);}}}thumbnailProvider(e,t){null==this.player&&t(null),this.player.provideThumbnail(e,(function(e){t(new v(e.url,e.width,e.height,e.x,e.y));}));}unregisterThumbnailProvider(){0!=this.hasThumbnailsInitialized&&(delete exports.thumbnailProvider,this.hasThumbnailsInitialized=!1);}onDashJsQualityChangeRequested(e){if(this.hasQualityInfoInitialized&&null!=e&&"video"==e.mediaType&&null!=e.newQuality){let t=new l("videoQualityPlaybackLevelChange");t.data=e.newQuality,t.dispatch(this.context);}return null}stopLiveStreamRestartTimeoutTimer(){null!=this.liveStreamRestartTimeoutTimer&&(this.liveStreamRestartTimeoutTimer.stop(),this.liveStreamRestartTimeoutTimer=null);}stopStreamCompleteWatchdogTimer(){null!=this.streamCompleteWatchdogTimer&&(this.streamCompleteWatchdogTimer.stop(),this.streamCompleteWatchdogTimer=null);}onStreamCompleteWatchdogTimeout(){this.stopStreamCompleteWatchdogTimer(),this.dispatchVideoComplete();}dispatchVideoComplete(){this.dispatchEvent(this.isAdvertisement?new r("adComplete"):new d("complete")),this.isAdvertisement&&this.isInStreamAdvertisement&&this.dispatchEvent(new d("complete"));}stopStreamBufferingWatchdogTimer(){null!=this.streamBufferingWatchdogTimer&&(this.streamBufferingWatchdogTimer.stop(),this.streamBufferingWatchdogTimer=null);}stopTokenisedMediaSourceRefreshWatchdogTimer(){null!=this.tokenisedMediaSourceRefreshWatchdogTimer&&(this.tokenisedMediaSourceRefreshWatchdogTimer.stop(),this.tokenisedMediaSourceRefreshWatchdogTimer=null);}onStreamBufferingWatchdogTimeout(){this.stopStreamBufferingWatchdogTimer();let e=this.media;this.videoRestartsOnError<(null!=e?e.getLimitOfRestartsOnError():null)?(console.warn("bradmax.player Warning: Buffering is taking too long. Probably problem with video decoding. Restarting stream."),null!=this.media&&null!=this.media.mediaUserSettings&&null!=this.media.mediaPlaybackInfo&&(this.media.mediaUserSettings.resumePostion=this.media.mediaPlaybackInfo.currentTime+.1),this.handleVideoRestart()):this.handleDecodeErrorOnMultipleRestarts();}handleDecodeErrorOnMultipleRestarts(){null!=this.video&&null!=this.video.mediaKeys?this.onDrmKeyError(null):this.dispatchEvent(this.isAdvertisement?new r("adMediaError"):new d("mediaError"),this.prepareErrorMessage({data:{message:"Cannot start playback. Media decode issue."},error:{message:"Cannot start playback. Media decode issue."}})),this.reset();}stopLiveStreamRestartDelayTimer(){null!=this.liveStreamRestartDelayTimer&&(this.liveStreamRestartDelayTimer.stop(),this.liveStreamRestartDelayTimer=null);}stopLiveEdgeUpdateTimer(){null!=this.liveEdgeUpdateTimer&&(this.liveEdgeUpdateTimer.stop(),this.liveEdgeUpdateTimer=null);}onLiveEdgeUpdate(){null!=this.player&&this.hasDashJsInitializedSource&&!this.shouldBePlaying&&this.onDashJsTimeupdate({isPeriodicalUpdate:!0});}onTokenisedMediaSourceRefreshTimeout(){this.stopTokenisedMediaSourceRefreshWatchdogTimer(),this.onDashJsError({data:{message:"Tokenised MediaSource refresh timeouted. Cannot handle safe player restart without new URL."},error:{message:"Tokenised MediaSource refresh timeouted. Cannot handle safe player restart without new URL."},isTokenisedMediaSourceError:!0});}getQualityLevels(){let e="resolution";Object.prototype.hasOwnProperty.call(this.variables,"qualityLabelType")&&(e=s.field(this.variables,"qualityLabelType"),e=e.toLowerCase());let t=this.player.getBitrateInfoListFor("video");if(null==t&&(t=[]),"resolution"==e){let i=0;for(;i<t.length;){let s=t[i];if(++i,0==s.width||0==s.height){e="bitrate";break}}}let i=[];i.push(new m("Auto","-1"));let a=0,r=t.length;for(;a<r;){let s=a++,r="resolution"==e?t[s].height+"p":this.mapBitrateToLabel(t[s].bitrate),n=new m(r,null==s?"null":""+s);n.height=t[s].height,n.width=t[s].width,n.bitrateKbps=t[s].bitrate>0?t[s].bitrate/1e3:null,i.push(n);}return i.reverse(),i}mapBitrateToLabel(e){return Math.floor(e/1e3)+"k"}getCurrentTotalBitrateKbps(){if(null==this.player)return null;try{let e=this.player.getQualityFor("video"),t=this.player.getBitrateInfoListFor("video"),i=this.player.getQualityFor("audio"),s=this.player.getBitrateInfoListFor("audio");if(null==t||null==s||null==e||null==i||e<0||t.length<=e||i<0||s.length<=i)return null;let a=t[e].bitrate+s[i].bitrate;return a=Math.round(a/1e3),a}catch(e){return null}}getQualityInitialBandwidthKbs(){if(Object.prototype.hasOwnProperty.call(this.variables,"qualityInitialBandwidthKbs")){let e=s.field(this.variables,"qualityInitialBandwidthKbs");if(null!=e)return a.parseInt(e)}return null}isAutoSwitchQualityEnabled(){if(null==this.player.getSettings()||null==this.player.getSettings().streaming)return !1;let e=this.player.getSettings().streaming.abr;return null!=e&&null!=e.autoSwitchBitrate&&null!=e.autoSwitchBitrate.video&&1==e.autoSwitchBitrate.video}updateAutoSwitchQuality(e){let t=this.player.getSettings();t.streaming.abr.autoSwitchBitrate={video:e,audio:e},this.player.updateSettings(t);}onVideoQualityChange(e){null!=e&&null!=e.data&&"string"==typeof e.data&&null!=this.player&&this.changeVideoQuality(a.string(e.data),!0);}changeVideoQuality(e,t){let i="-1";if(this.isAutoSwitchQualityEnabled()||(i=a.string(this.player.getQualityFor("video"))),e==i)return;let s="-1"==e;if(s)this.updateAutoSwitchQuality(!0);else {let t=a.parseInt(e);this.updateAutoSwitchQuality(!1),this.player.setQualityFor("video",t);let i=this.player.getBitrateInfoListFor("video"),s=this.player.getBitrateInfoListFor("audio");null!=i&&null!=s&&s.length>1&&i.length>0&&this.player.setQualityFor("audio",Math.floor(s.length*t/i.length));}if(Object.prototype.hasOwnProperty.call(this.variables,"saveBandwidthMode")&&M.__cast(this.variables.saveBandwidthMode,L)){let e=this.player.getSettings();e.streaming.abr.limitBitrateByPortal=s,e.streaming.abr.usePixelRatioInLimitBitrateByPortal=s,this.player.updateSettings(e);}if(!t)return;let r=new n("videoQualityHasChanged");r.data=e,r.dispatch(this.context);}updateVideoSets(){if(null==this.player)return;let e=this.player.getTracksFor("video");if(e.length<=1)return;let t=this.player.getCurrentTrackFor("video"),i=this.mediaTrackParsers.dashjs.videoTracksToVideoSets(e,t);if(i.length<=1)return;let s=this.context,a=new l("videoTrackData");a.data=i,a.dispatch(s);}onSelectVideoTrack(e){null!=(null!=e?e.data:null)&&null!=this.player&&(this.hasPlaybackSuccStarted?this.performVideoTrackSelection(e.data):this.videoSetWaitingForSelection=e.data);}performVideoTrackSelection(e){if(null==(null!=e?e.id:null)||0==e.id.length||null==this.player)return;let t=this.player.getTracksFor("video"),s=null!=t?i.find(t,(function(t){return t.id==e.id})):null;if(null==s)return;let r=a.string(this.player.getQualityFor("video"));this.player.setCurrentTrack(s),this.changeVideoQuality(r,!1);}onDashJsKeySessionCreated(e){return new d("drmAuthenticationComplete").dispatch(this.context),null}updateSubtitlesSets(){if(null==this.video)return;let e=this.video.textTracks;if(null==e||0==e.length)return;let t=this.mediaTrackParsers.dashjs.textTracksToSubtitlesSets(e);if(0==t.length)return;let i=this.context,s=new l("subtitleData");s.data=t,s.dispatch(i);}onSelectSubtitles(e){null!=e&&null!=this.video&&(this.hasPlaybackSuccStarted?this.performSubtitlesSelection(e.data):this.subtitlesSetWaitingForSelection=e.data);}performSubtitlesSelection(e){if(this.subtitlesSelected=null,null!=e){this.player.enableText(!0);let t=0,i=this.video.textTracks.length;for(;t<i;){let i=t++;(null==i?"null":""+i)==e.id&&(this.subtitlesSelected=e,this.player.setTextTrack(i));}}else this.player.enableText(!1);}initSubtitlesPlaceholder(){let e=this.context+"-subtitles-placeholder",t=this.findSubtitlesPlaceholderElement(e),i=null!=t?t:this.createSubtitlesPlaceholderElement(e,this.video.parentElement),s=this.player;if((null!=s?s.getTTMLRenderingDiv():null)==i)return;let a=this.player;null!=a&&a.attachTTMLRenderingDiv(i);}findSubtitlesPlaceholderElement(e){let t=T.getElementById(e);return null!=t&&(t.innerHTML=""),t}createSubtitlesPlaceholderElement(e,t){let i=T.createElement("div");i.id=e,i.classList.add("htmlSubtitlesPlaceholder"),i.style.position="absolute",i.style.top="0",i.style.left="0",i.style.width="100%",i.style.height="100%";let s,a=this.video,r=-1,n=a.parentElement,l=null!=n?n.childNodes:null;if(0==(null!=l?l.length:null))s=-1;else {let e=0,t=a.parentElement.childNodes.length;for(;e<t;){let t=e++;if(a.parentElement.childNodes.item(t)==a){r=t;break}}s=r;}let o=t.childNodes;if(s<(null!=o?o.length:null)-1){let e=s+1,a=t.childNodes;t.insertBefore(i,null!=(null!=a?a.item(e):null)?M.__cast(t.childNodes.item(e),HTMLElement):null);}else t.appendChild(i);return i}updateAudioSets(){if(null==this.player)return;let e=this.player.getTracksFor("audio");if(e.length<this.minAudioTracksForInfo)return;let t=this.player.getCurrentTrackFor("audio"),i=this.mediaTrackParsers.dashjs.audioTracksToAudioSets(e,t);if(i.length<this.minAudioTracksForInfo)return;let s=this.context,a=new l("audioData");a.data=i,a.dispatch(s);}onSelectAudio(e){null!=e&&null!=this.player&&(this.hasPlaybackSuccStarted?this.performAudioSelection(e.data):this.audioSetWaitingForSelection=e.data);}performAudioSelection(e){if(null==e||null==e.id||""==e.id||null==this.player)return;let t=this.player.getTracksFor("audio");this.player.setCurrentTrack(t[a.parseInt(e.id)]);}selectMediaTrackSetsAfterInitialization(){null!=this.audioSetWaitingForSelection&&(this.performAudioSelection(this.audioSetWaitingForSelection),this.audioSetWaitingForSelection=null),null!=this.subtitlesSetWaitingForSelection&&(this.performSubtitlesSelection(this.subtitlesSetWaitingForSelection),this.subtitlesSetWaitingForSelection=null),null!=this.videoSetWaitingForSelection&&(this.performVideoTrackSelection(this.videoSetWaitingForSelection),this.videoSetWaitingForSelection=null);}reset(){if(null!=this.player){this.hasProtectionData=!1,this.stopLiveEdgeUpdateTimer();try{this.player.reset();}catch(e){console.warn("bradmax.player.reset() Warning: Exception occured during DASH player reset.");}this.hasPlaybackSuccStarted=!1;}}pause(){null==this.player||!this.hasDashJsInitializedSource||this.media instanceof u&&2!=this.startTimeStatus||this.player.pause(),this.shouldBePlaying=!1;}initSource(){if(null==this.media||null==this.media.source||0==this.media.source.length)return void this.dispatchEvent(this.isAdvertisement?new r("adMediaError"):new d("mediaError"),{message:"No video could be played. All video with fallback sources has failed."});let e=this;if(this.source!=this.media.source[0].url){null!=this.source&&this.reset();let t=this.media.source[0];if(null!=t.drm&&"playready"==t.drm.selectedDrmSystem)this.setPlayReadyDrmSupportPlayback();else if(null!=t.drm&&"widevine"==t.drm.selectedDrmSystem)this.setWidevineDrmSupportPlayback();else switch(b.browserName){case"Chrome":case"EdgeChromium":case"Firefox":case"Opera":this.setWidevineDrmSupportPlayback();break;case"Edge":case"Microsoft Internet Explorer":this.setPlayReadyDrmSupportPlayback();break;default:this.setDefaultPlayback();}this.source=this.media.source[0].url,D.delay((function(){e.isBuffering||(e.set_isBuffering(!0),e.dispatchEvent(e.isAdvertisement?new r("adBufferingStart"):new d("bufferingStart")));}),0);}}play(){if(2!=this.startTimeStatus&&null!=this.video&&(this.hideVideoTag=!0,null!=this.video&&(this.video.style.display="none",this.video.style.opacity="0",this.video.style.visibility="hidden"),this.video.muted=!0),this.initSource(),null!=this.player){if(this.media instanceof u){let e=this.getDVRWindowRange();if(this.video.currentTime<e.start)this.dispatchEvent(new d("videoOutsideDvrWindow")),this.seek(0);else if(this.video.currentTime>e.end){let t=e.end-e.start;this.dispatchEvent(new d("videoOutsideDvrWindow")),this.seek(t);}}try{this.hasDashJsInitializedSource&&this.player.play(),this.shouldBePlaying=!0;}catch(e){let t=R.caught(e).unwrap();this.onDashJsError({data:t,error:{message:a.string(t)}});}}}getMediaSource(e,t){let i=t;null==t&&(i=[".mpd"]);let s=0;for(;s<e.length;){let t=e[s];++s;let a=0;for(;a<i.length;)if(-1!=t.url.toLowerCase().indexOf(i[a++]))return t}null==t&&(i=[".ism/manifest",".isml/manifest"]);let a=0;for(;a<e.length;){let t=e[a];++a;let s=0;for(;s<i.length;)if(-1!=t.url.toLowerCase().indexOf(i[s++]))return t}return null}playPause(){this.isPaused()?this.play():this.pause();}setDefaultPlayback(){this.attachPlayerSourceUrl(this.media.source[0].url);}attachPlayerSourceUrl(e){if(null!=this.media&&this.media instanceof u&&1==this.media.lowLatencyMode){let e=this.player.getSettings();e.streaming.lowLatencyEnabled=!0,this.player.updateSettings(e);}this.player.attachSource(e),this.player.isReady()||this.player.attachView(this.video),this.hasDashJsInitializedSource=!0;}getPlaybackStartTime(e){let t=null;return null!=this.dvrWindowStartTimeTs&&null!=this.dvrWindowEndTimeTs&&this.dvrWindowEndTimeTs<this.getNowTs()&&(t=this.dvrWindowStartTimeTs),null!=e&&null!=e.mediaUserSettings&&null!=e.mediaUserSettings.resumePostion&&(t=e.mediaUserSettings.resumePostion),null!=this.prePlaybackSeekRelativePosition&&null!=e&&e.duration>0&&(t=this.prePlaybackSeekRelativePosition*e.duration),null!=t&&null!=this.dvrWindowStartTimeTs&&t<this.dvrWindowStartTimeTs&&(t=this.dvrWindowStartTimeTs),null!=t&&null!=this.dvrWindowEndTimeTs&&this.dvrWindowEndTimeTs<t&&(t=this.dvrWindowEndTimeTs),t}setWidevineDrmSupportPlayback(){let e=this.getMediaSource(this.media.source),t=null,i=null,s=null,a=null;if(null!=e){try{a=e.drm.provider;}catch(e){}try{t=e.customParams.h.laUrl,i=e.customParams.h.laCertHex;}catch(e){console.log("plugins/VideoDashJs/src/bs/player/plugin/video/videoPlayer/VideoDashJs.hx:2788:",R.caught(e).unwrap());}try{null==t&&(t=e.drm.widevine.laUrl);}catch(e){}try{null!=e.drm&&null!=e.drm.widevine&&null!=e.drm.widevine.customData&&(s=e.drm.widevine.customData);}catch(e){console.log("plugins/VideoDashJs/src/bs/player/plugin/video/videoPlayer/VideoDashJs.hx:2801:",R.caught(e).unwrap());}if(null!=this.media.drmCustomLicenseServerHandler)this.media.drmCustomLicenseServerHandler.initContext(this.media,e,this.variables),this.hasProtectionData=!0,this.player.setProtectionData({"com.widevine.alpha":{customData:"B2C99B73-CA41-4003-84A3AA16CE92B304",customLicenseRequestHandler:(A=this.media.drmCustomLicenseServerHandler,B(A,A.customWidevineLicenseRequestHandler)),audioRobustness:null!=e.drm&&null!=e.drm.widevine&&null!=e.drm.widevine.audioRobustness?e.drm.widevine.audioRobustness:"SW_SECURE_CRYPTO",videoRobustness:null!=e.drm&&null!=e.drm.widevine&&null!=e.drm.widevine.videoRobustness?e.drm.widevine.videoRobustness:"SW_SECURE_CRYPTO"}}),this.attachPlayerSourceUrl(e.url);else if(null!=t){let r={laURL:t,customData:"B2C99B73-CA41-4003-84A3AA16CE92B304",canGeneratePsshBox:!0,audioRobustness:null!=e.drm&&null!=e.drm.widevine&&null!=e.drm.widevine.audioRobustness?e.drm.widevine.audioRobustness:"SW_SECURE_CRYPTO",videoRobustness:null!=e.drm&&null!=e.drm.widevine&&null!=e.drm.widevine.videoRobustness?e.drm.widevine.videoRobustness:"SW_SECURE_CRYPTO"};null!=s&&"keyos"==a.toLowerCase()&&(r.httpRequestHeaders={"x-keyos-authorization":s}),null!=i&&(r.laCertHex=i),this.hasProtectionData=!0,this.player.setProtectionData({"com.widevine.alpha":r}),this.attachPlayerSourceUrl(e.url);}else this.attachPlayerSourceUrl(e.url);}else this.onDashJsError({data:{message:"Cannot play defined media. Invalid media source."}});}setPlayReadyDrmSupportPlayback(){let e=this.getMediaSource(this.media.source),t=null,i=null;try{t=e.drm.provider;}catch(e){}let s=null;try{s=e.drm.playready.laUrl;}catch(e){}try{i=e.drm.playready.customData;}catch(e){}if(null!=this.media.drmCustomLicenseServerHandler)this.media.drmCustomLicenseServerHandler.initContext(this.media,e,this.variables),this.hasProtectionData=!0,this.player.setProtectionData({"com.microsoft.playready":{customLicenseRequestHandler:(A=this.media.drmCustomLicenseServerHandler,B(A,A.customPlayReadyLicenseRequestHandler)),audioRobustness:null!=e.drm&&null!=e.drm.playready&&null!=e.drm.playready.audioRobustness?e.drm.playready.audioRobustness:"SW_SECURE_CRYPTO",videoRobustness:null!=e.drm&&null!=e.drm.playready&&null!=e.drm.playready.videoRobustness?e.drm.playready.videoRobustness:"SW_SECURE_CRYPTO"}}),this.attachPlayerSourceUrl(e.url);else if(null!=s){let e={laURL:s,canGeneratePsshBox:!0};null!=i&&"keyos"==t.toLowerCase()&&(e.httpRequestHeaders={"x-keyos-authorization":i}),this.player.setProtectionData({"com.microsoft.playready":e}),this.attachPlayerSourceUrl(this.media.source[0].url);}else this.attachPlayerSourceUrl(this.media.source[0].url);}seek(e){let t=this.isPaused()&&null==this.source;this.androidVideoBufferFix(),this.seekingTargetTs=null;let i=this.media instanceof u;if(i){if(e=this.dvrWindowRelativeTimeToTs(e),e=this.normalizeDvrTime(e),this.media.mediaPlaybackInfo.currentTime=e,e>0&&(this.seekingTargetTs=e),(e=this.dvrWindowRelativeTimeFromTs(e))<this.getLiveMinimalInitialOffsetForOldestPart()&&(e=this.getLiveMinimalInitialOffsetForOldestPart()),2!=this.startTimeStatus&&!t)return;t&&this.initSource();}else e<0?(console.warn('bradmax.player.seek Warning: Trying to seek to negative position. Fallback - setting to "0" position.'),e=0):null!=this.video&&e>this.video.duration&&(console.warn("bradmax.player.seek Warning: Trying to seek to position bigger than duration of media. Fallback - setting to end position of media."),e=this.video.duration),e>this.video.duration-1&&(e=this.video.duration-1),t&&(this.media.duration>0&&(this.prePlaybackSeekRelativePosition=e/this.media.duration),this.initSource());let s=this;this.isPaused()&&!t&&D.delay((function(){s.isBuffering||(s.set_isBuffering(!0),s.dispatchEvent(s.isAdvertisement?new r("adBufferingStart"):new d("bufferingStart")));}),0),this.currentTime=e,b.isSmartTV()&&(this.seekingTargetPos=i?this.dvrWindowRelativeTimeToTs(e):e),this.player.pause(),this.hasSeekingStartTriggeded=!0,this.dispatchEvent(this.isAdvertisement?new r("seekingStart"):new d("seekingStart")),this.seekingStartDate=new Date,this.dispatchEvent(this.isAdvertisement?new r("adCurrentTimeChange"):new d("currentTimeChange")),null!=this.seekDebouncerTimer&&this.seekDebouncerTimer.stop(),this.seekDebouncerTimer=D.delay(B(this,this.onSeekingDebouncerTimout),this.getSeekingDebouncerTimeout());}onSeekingDebouncerTimout(){if(null!=this.seekingTargetTs)this.performPlayerSeek(this.seekingTargetTs),this.seekingTargetTs=null;else {let e=this.currentTime;this.media instanceof u&&(e=this.dvrWindowRelativeTimeToTs(e),e=this.normalizeDvrTime(e)),this.performPlayerSeek(e);}this.stopSeekDebouncerTimer();}getSeekingDebouncerTimeout(){let e=500;return b.isSmartTV()&&(e=1e3),e}performPlayerSeek(e,t){if(null==t&&(t=!0),!this.hasDashJsInitializedSource||null==this.video)return;this.androidVideoBufferFix();let i,s=this;if(0==this.video.readyState){let e=this.media;i=this.videoRestartsOnError<(null!=e?e.getLimitOfRestartsOnError():null);}else i=!1;i&&D.delay((function(){s.performPlayerSeek(e,t);}),100);let a=this.getSeekableRange(),r=this.media instanceof u,n=e;if(r&&(n=this.normalizeDvrTime(n),n=this.dvrWindowRelativeTimeFromTs(n),n<this.getLiveMinimalInitialOffsetForOldestPart()&&(n=this.getLiveMinimalInitialOffsetForOldestPart())),r){let e=this.player.getSettings().streaming.liveDelay;null==e&&(e=0),n>a.end-1.2*e&&(n=a.end-1.2*e);}if(this.shouldBePlaying&&t&&this.player.play(),0==this.currentTime&&0==n&&(n=.1,null!=this.adBreaksInfo))return null!=this.media&&null!=this.media.mediaUserSettings&&this.media.mediaUserSettings.resumePostion>0&&(this.media.mediaUserSettings.resumePostion=0),void this.handleVideoRestart();this.player.seek(n);}dvrWindowRelativeTimeFromTs(e){let t=this.player.getDashMetrics().getCurrentDVRInfo(),i=0;return null!=t&&null!=t.range&&null!=t.time&&(i=e-t.range.start),i<0&&(i=0),i}dvrWindowRelativeTimeToTs(e){let t=this.player.getDashMetrics().getCurrentDVRInfo(),i=0;return null!=t&&null!=t.range&&null!=t.time&&(i=t.range.start+e),i}normalizeDvrTime(e){let t=this.getDVRWindowRange();return e>t.end?e=t.end:e<t.start&&(e=t.start),e}dvrTimestampToRelativeTime(e){return e-this.getDVRWindowRange().start}getDvrWindowEndTimeOffset(){let e=0;if(null!=this.dvrWindowEndTimeTs){let t=this.getDVRWindowRange();this.dvrWindowEndTimeTs<t.end&&(e=t.end-this.dvrWindowEndTimeTs);}return e}getDVRWindowRange(){let e=this.getSeekableRange();return null!=this.dvrWindowStartTimeTs&&e.start<this.dvrWindowStartTimeTs&&!this.isDVRRecordedForStartOver(e)&&(e.start=this.dvrWindowStartTimeTs),null!=this.dvrWindowEndTimeTs&&this.dvrWindowEndTimeTs<e.end&&(e.end=this.dvrWindowEndTimeTs),e}isDVRRecordedForStartOver(e){return 0==e.start&&e.end-e.start<86400}getDashStreamPeriodsNum(){let e=0,t=this.player,i=null!=t?t.getActiveStream():null,s=null!=i?i.getProcessors():null;if((null!=s?s.length:null)>0){let t=s[0],i=null!=t?t.getRepresentationController():null,a=null!=i?i.getCurrentRepresentation():null,r=null!=a?a.adaptation:null,n=null!=r?r.period:null,l=null!=n?n.mpd:null,o=null!=l?l.manifest:null,d=null!=o?o.Period_asArray:null;0!=(null!=d?d.length:null)&&(e=a.adaptation.period.mpd.manifest.Period_asArray.length);}return e}getSeekableRange(){if(null!=this.player){let e=this.player.getDashMetrics().getCurrentDVRInfo();if(null!=e&&null!=e.range){let t={start:e.range.start,end:e.range.end};if(this.media instanceof u){let i=this.player.getDVRSeekOffset(864e5);i>0&&i>e.range.start&&(t.end=i),this.getDashStreamPeriodsNum()>1&&this.liveStreamNowOffset>0&&(t.end=this.getNowTs()-this.liveStreamNowOffset),t.end<this.media.mediaPlaybackInfo.currentTime&&(t.end=this.media.mediaPlaybackInfo.currentTime);}return this.lastDvrWindowStart=t.start,this.lastDvrWindowEnd=t.end,t}if(null!=this.lastDvrWindowEnd&&null!=this.lastDvrWindowStart)return {start:this.lastDvrWindowStart,end:this.lastDvrWindowEnd}}return null!=this.video&&null==this.video.seekable&&0==this.video.seekable.length?{start:this.video.seekable.start(0),end:this.video.seekable.end(0)}:{start:0,end:0}}getDVRWindowSize(){let e=this.getDVRWindowRange();return e.end-e.start}getNowTs(){return (new Date).getTime()/1e3}selectAudio(e){}selectSubtitles(e){}volume(e){this.initialVideoIsMuted=e<=0,null!=this.player&&this.hasDashJsInitializedSource?this.player.setVolume(e):this.video.volume=e;}setData(e){this.media=e,this.startTimeStatus=0,this.hasDashJsInitializedSource=!1,this.hasDashJsInitializedManifest=!1,this.hasAudioInitialized=!1,this.hasSubtitlesInitialized=!1,this.hasCodecInfoInitialized=!1,this.hasQualityInfoInitialized=!1,this.hasSeekingStartTriggeded=!1,this.hasProtectionData=!1,this.set_isBuffering(!1),this.shouldBePlaying=!1,this.isPlaybackNotAllowed=!1,this.initialVideoIsMuted=!1,null!=this.video&&(this.initialVideoIsMuted=this.video.muted),this.hasPlaybackSuccStarted=!1,this.hasThumbnailsInitialized=!1,this.liveStreamNowOffset=null,this.liveStreamNowOffsetLastUpdate=0,this.videoRestartsOnError=0,this.seekingStartDate=null,this.seekingTargetPos=null,this.seekingTargetTs=null,this.stopSeekDebouncerTimer(),this.lastDvrWindowStart=null,this.lastDvrWindowEnd=null,this.currentTime=null,this.playbackRateMetter.reset(),this.adBreaksInfo=null,this.unregisterThumbnailProvider(),Object.prototype.hasOwnProperty.call(this.variables,"dvrWindowStartTime")?(this.dvrWindowStartTimeTs=s.field(this.variables,"dvrWindowStartTime"),this.getNowTs()<this.dvrWindowStartTimeTs&&(console.warn("Warning: dvrWindowStartTime player setting was ignored, because it is starting in the future."),this.dvrWindowStartTimeTs=null),s.deleteField(this.variables,"dvrWindowStartTime")):this.dvrWindowStartTimeTs=null,Object.prototype.hasOwnProperty.call(this.variables,"dvrWindowEndTime")?(this.dvrWindowEndTimeTs=s.field(this.variables,"dvrWindowEndTime"),s.deleteField(this.variables,"dvrWindowEndTime")):this.dvrWindowEndTimeTs=null,this.updateQuanteecWrapper(e),1==this.variables.autoplay&&this.play();}log(e,t){null==t&&(t="log"),console&&("error"==t?console.error(e):"warn"==t?console.warn(e):console.log(e));}playerResize(e){}videoReady(){}onDurationChange(e){}saveBandwidthModeVisibilityChange(e){if(null!=this.player)if(e){let e=this.player.getSettings();this.saveBandwidthModeStore={level:this.player.getQualityFor("video"),trackSwitchMode:e.streaming.abr.trackSwitchMode,maxRepresentationRatio:e.streaming.abr.maxRepresentationRatio,autoSwitchBitrate:e.streaming.abr.autoSwitchBitrate},e.streaming.abr.trackSwitchMode={video:"alwaysReplace"},e.streaming.abr.maxRepresentationRatio={video:0},e.streaming.abr.autoSwitchBitrate={video:!1},this.player.updateSettings(e),this.player.setQualityFor("video",0);}else if(null!=this.saveBandwidthModeStore){let e=this.player.getSettings();e.streaming.abr.trackSwitchMode=this.saveBandwidthModeStore.trackSwitchMode,e.streaming.abr.maxRepresentationRatio=this.saveBandwidthModeStore.maxRepresentationRatio,e.streaming.abr.autoSwitchBitrate=this.saveBandwidthModeStore.autoSwitchBitrate,this.player.updateSettings(e),this.player.setQualityFor("video",this.saveBandwidthModeStore.level),this.saveBandwidthModeStore=null;}}getThroughput(){if(null!=this.player){return 1e3*(this.player.getAverageThroughput("video")+this.player.getAverageThroughput("audio"))}return null}static canPlay(e){return !("Microsoft Internet Explorer"==b.browserName&&b.majorVersion<11)&&(0!=b.isMediaSourceExtensionSupported()&&(null!=e.url&&(e.url.toLowerCase().indexOf(".ism/manifest")>1||e.url.toLowerCase().indexOf(".isml/manifest")>1||e.url.toLowerCase().indexOf(".mpd")>1)))}static getInstance(e,t){let i=t?"ad_":"";if(Object.prototype.hasOwnProperty.call(S.instances.h,i+e))return S.instances.h[i+e];{let s=new S(t);return S.instances.h[i+e]=s,s.context=e,s.create(),s}}}e.bs.player.plugin.video.videoPlayer.VideoDashJs=S,S.__name__="bs.player.plugin.video.videoPlayer.VideoDashJs",Object.assign(S.prototype,{__class__:S});var T=require("bs.ui.Ui"),b=require("bs.util.BrowserTools");class w{constructor(e,t){this.reset(t),this.avgPeriod=e;}add(e){e=this.initNowTs(e),this.load=this.getLoadForTime(e)+1,this.lastEventTs=e;}getLoadForTime(e){return this.load*Math.exp(-(e-this.lastEventTs)/this.avgPeriod)}initNowTs(e){return null==e&&(e=(new Date).getTime()/1e3),e}getLoad(e){return this.getLoadForTime(this.initNowTs(e))}reset(e){this.lastEventTs=this.initNowTs(e),this.load=0;}}w.__name__="bs.util.EventLoadMeter",Object.assign(w.prototype,{__class__:w});var P=require("bs.util.ObjectTools");class k{constructor(){this.reset();}nextTry(){return this.load*=1.2,this.load>1073741824&&(this.load=1073741824),this.load}reset(){this.load=1073741824;}getLoad(){return this.load}addOverloadVal(e){e>0&&(this.load=.7*e);}serialize(){return JSON.stringify({load:this.load})}loadFromSerialized(e){null!=e&&""!=e&&(this.load=JSON.parse(e).load);}}k.__name__="bs.util.OverloadValueMeter",Object.assign(k.prototype,{__class__:k});class _{constructor(e,t){null==t&&(t=2),null==e&&(e=2),this.expectedSamplesPerSec=t,this.playbackPosition=[],this.sampleTime=[];let i=0;for(;i<e;)++i,this.playbackPosition.push(null),this.sampleTime.push(null);this.lastSamplePos=0;}setCurrentTime(e,t,i){null==i&&(i=!1),null==t&&(t=(new Date).getTime()/1e3),t-this.sampleTime[this.lastSamplePos]<.05||i||(this.lastSamplePos=(this.lastSamplePos+1)%this.playbackPosition.length,this.playbackPosition[this.lastSamplePos]=e,this.sampleTime[this.lastSamplePos]=t);}reset(){let e=0,t=this.playbackPosition.length;for(;e<t;){let t=e++;this.playbackPosition[t]=null,this.sampleTime[t]=null;}this.lastSamplePos=0;}getPlaybackRate(e){null==e&&(e=!1);let t=this.lastSamplePos,i=(t+1)%this.playbackPosition.length,s=this.sampleTime[t],a=this.sampleTime[i],r=s-a;return null==r||0==r||null==s||null==a?null:r>1.5*(this.playbackPosition.length-1)/this.expectedSamplesPerSec&&!e?1:(this.playbackPosition[t]-this.playbackPosition[i])/r}isPlayingNormal(e){null==e&&(e=!1);let t=this.getPlaybackRate(e);return .5<t&&t<1.5}}_.__name__="bs.util.PlaybackRateMetter",Object.assign(_.prototype,{__class__:_});class R extends Error{constructor(e,t,i){super(e),this.message=e,this.__previousException=t,this.__nativeException=null!=i?i:this;}unwrap(){return this.__nativeException}get_native(){return this.__nativeException}static caught(e){return e instanceof R?e:e instanceof Error?new R(e.message,null,e):new I(e,null,e)}static thrown(e){if(e instanceof R)return e.get_native();if(e instanceof Error)return e;return new I(e)}}R.__name__="haxe.Exception",R.__super__=Error,Object.assign(R.prototype,{__class__:R});var D=require("haxe.Timer");class I extends R{constructor(e,t,i){super(String(e),t,i),this.value=e;}unwrap(){return this.value}}I.__name__="haxe.ValueException",I.__super__=R,Object.assign(I.prototype,{__class__:I});var A,C=require("haxe.ds.StringMap");class M{static getClass(e){if(null==e)return null;if(e instanceof Array)return Array;{let t=e.__class__;if(null!=t)return t;let i=M.__nativeClassName(e);return null!=i?M.__resolveNativeClass(i):null}}static __string_rec(e,t){if(null==e)return "null";if(t.length>=5)return "<...>";let i=typeof e;switch("function"==i&&(e.__name__||e.__ename__)&&(i="object"),i){case"function":return "<function>";case"object":if(e instanceof Array){let i="[";t+="\t";let s=0,a=e.length;for(;s<a;){let a=s++;i+=(a>0?",":"")+M.__string_rec(e[a],t);}return i+="]",i}let i;try{i=e.toString;}catch(e){return "???"}if(null!=i&&i!=Object.toString&&"function"==typeof i){let t=e.toString();if("[object Object]"!=t)return t}let s="{\n";t+="\t";let a=null!=e.hasOwnProperty,r=null;for(r in e)a&&!e.hasOwnProperty(r)||"prototype"!=r&&"__class__"!=r&&"__super__"!=r&&"__interfaces__"!=r&&"__properties__"!=r&&(2!=s.length&&(s+=", \n"),s+=t+r+" : "+M.__string_rec(e[r],t));return s+="\n"+(t=t.substring(1))+"}",s;case"string":return e;default:return String(e)}}static __interfLoop(e,t){for(;;){if(null==e)return !1;if(e==t)return !0;let i=e.__interfaces__;if(null!=i&&(null==e.__super__||e.__super__.__interfaces__!=i)){let e=0,s=i.length;for(;e<s;){let s=i[e++];if(s==t||M.__interfLoop(s,t))return !0}}e=e.__super__;}}static __instanceof(e,t){if(null==t)return !1;switch(t){case Array:return e instanceof Array;case L:return "boolean"==typeof e;case O:return null!=e;case x:return "number"==typeof e;case W:return "number"==typeof e&&(0|e)===e;case String:return "string"==typeof e;default:if(null==e)return !1;if("function"==typeof t){if(M.__downcastCheck(e,t))return !0}else if("object"==typeof t&&M.__isNativeObj(t)&&e instanceof t)return !0;return t==V&&null!=e.__name__||t==N&&null!=e.__ename__}}static __downcastCheck(e,t){return e instanceof t||!!t.__isInterface__&&M.__interfLoop(M.getClass(e),t)}static __cast(e,t){if(null==e||M.__instanceof(e,t))return e;throw R.thrown("Cannot cast "+a.string(e)+" to "+a.string(t))}static __nativeClassName(e){let t=M.__toStr.call(e).slice(8,-1);return "Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t}static __isNativeObj(e){return null!=M.__nativeClassName(e)}static __resolveNativeClass(e){return t[e]}}function B(e,i){return null==i?null:(null==i.__id__&&(i.__id__=t.$haxeUID++),null==e.hx__closures__?e.hx__closures__={}:s=e.hx__closures__[i.__id__],null==s&&(s=i.bind(e),e.hx__closures__[i.__id__]=s),s);var s;}M.__name__="js.Boot",t.$haxeUID|=0,Object.defineProperty(String.prototype,"__class__",{value:String,enumerable:!1,writable:!0}),String.__name__="String",Array.__name__="Array",Date.prototype.__class__=Date,Date.__name__="Date";var W={},O={},x=Number,L=Boolean,V={},N={};M.__toStr={}.toString,S.instances=new C,S.__plugfaces__="ICanPlay,INoPlayerPlugin,IVideoPlayer";}(exports,window);
(function(window) {
var orgdash = window.dashjs;
var dashjs = { skipAutoCreate: true };
window.dashjs = dashjs;

/*! v3.1.2-0054d7eb, 2020-07-24T09:05:25Z */
!function a(o,s,u){function l(t,e){if(!s[t]){if(!o[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(d)return d(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var i=s[t]={exports:{}};o[t][0].call(i.exports,function(e){return l(o[t][1][e]||e)},i,i.exports,a,o,s,u);}return s[t].exports}for(var d="function"==typeof require&&require,e=0;e<u.length;e++)l(u[e]);return l}({1:[function(e,t,n){var o,u,r,i={encode:function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):(r<2048?t.push(192|r>>6):(r<65536?t.push(224|r>>12):(t.push(240|r>>18),t.push(128|63&r>>12)),t.push(128|63&r>>6)),t.push(128|63&r));}return t},decode:function(e){for(var t=[],n=0;n<e.length;){var r=e[n++];r<128||(r<224?r=(31&r)<<6:(r<240?r=(15&r)<<12:(r=(7&r)<<18,r|=(63&e[n++])<<12),r|=(63&e[n++])<<6),r|=63&e[n++]),t.push(String.fromCharCode(r));}return t.join("")}},l={};function d(e){for(var t=0,n=[],r=0|e.length/3;0<r--;){var i=(e[t]<<16)+(e[t+1]<<8)+e[t+2];t+=3,n.push(o.charAt(63&i>>18)),n.push(o.charAt(63&i>>12)),n.push(o.charAt(63&i>>6)),n.push(o.charAt(63&i));}return 2==e.length-t?(i=(e[t]<<16)+(e[t+1]<<8),n.push(o.charAt(63&i>>18)),n.push(o.charAt(63&i>>12)),n.push(o.charAt(63&i>>6)),n.push("=")):1==e.length-t&&(i=e[t]<<16,n.push(o.charAt(63&i>>18)),n.push(o.charAt(63&i>>12)),n.push("==")),n.join("")}function f(e){for(var t=0,n=[],r=0|e.length/4;0<r--;){var i=(u[e.charCodeAt(t)]<<18)+(u[e.charCodeAt(t+1)]<<12)+(u[e.charCodeAt(t+2)]<<6)+u[e.charCodeAt(t+3)];n.push(255&i>>16),n.push(255&i>>8),n.push(255&i),t+=4;}return n&&("="==e.charAt(t-2)?(n.pop(),n.pop()):"="==e.charAt(t-1)&&n.pop()),n}o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=function(){for(var e=[],t=0;t<o.length;++t)e[o.charCodeAt(t)]=t;return e["=".charCodeAt(0)]=0,e}(),r={encode:function(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t},decode:function(e){for(var t=0;t<s.length;++t)a[t]=String.fromCharCode(a[t]);return a.join("")}},l.decodeArray=function(e){var t=f(e);return new Uint8Array(t)},l.encodeASCII=function(e){var t=r.encode(e);return d(t)},l.decodeASCII=function(e){var t=f(e);return r.decode(t)},l.encode=function(e){var t=i.encode(e);return d(t)},l.decode=function(e){var t=f(e);return i.decode(t)},void 0!==n&&(n.decode=l.decode,n.decodeArray=l.decodeArray,n.encode=l.encode,n.encodeASCII=l.encodeASCII);},{}],2:[function(e,t,n){!function(e){function s(e){var t=e;return n.hasOwnProperty(e)&&(t=n[e]),String.fromCharCode(t)}function u(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t}function o(e,t,n,r,i){this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=r||"black",this.flash=i||!1;}var n={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},a={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},l={17:2,18:4,21:6,22:8,23:10,19:13,20:15},d={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},f={25:2,26:4,29:6,30:8,31:10,27:13,28:15},c=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],h={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e;},log:function(e,t){var n=this.verboseFilter[e];this.verboseLevel>=n&&console.log(this.time+" ["+e+"] "+t);}};o.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1;},setStyles:function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r]);}},isDefault:function(){return "white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},equals:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},copy:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash;},toString:function(){return "color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};function t(e,t,n,r,i,a){this.uchar=e||" ",this.penState=new o(t,n,r,i,a);}t.prototype={reset:function(){this.uchar=" ",this.penState.reset();},setChar:function(e,t){this.uchar=e,this.penState.copy(t);},setPenState:function(e){this.penState.copy(e);},equals:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},copy:function(e){this.uchar=e.uchar,this.penState.copy(e.penState);},isEmpty:function(){return " "===this.uchar&&this.penState.isDefault()}};function r(){this.chars=[];for(var e=0;e<32;e++)this.chars.push(new t);this.pos=0,this.currPenState=new o;}r.prototype={equals:function(e){for(var t=!0,n=0;n<32;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<32;t++)this.chars[t].copy(e.chars[t]);},isEmpty:function(){for(var e=!0,t=0;t<32;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},setCursor:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(h.log("ERROR","Negative cursor position "+this.pos),this.pos=0):32<this.pos&&(h.log("ERROR","Too large cursor position "+this.pos),this.pos=32);},moveCursor:function(e){var t=this.pos+e;if(1<e)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t);},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState);},insertChar:function(e){144<=e&&this.backSpace();var t=s(e);32<=this.pos?h.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1));},clearFromPos:function(e){for(var t=e;t<32;t++)this.chars[t].reset();},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset();},clearToEndOfRow:function(){this.clearFromPos(this.pos);},getTextString:function(){for(var e=[],t=!0,n=0;n<32;n++){var r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r);}return t?"":e.join("")},setPenStyles:function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState);}};function i(){this.rows=[];for(var e=0;e<15;e++)this.rows.push(new r);this.currRow=14,this.nrRollUpRows=null,this.reset();}i.prototype={reset:function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14;},equals:function(e){for(var t=!0,n=0;n<15;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t]);},isEmpty:function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},backSpace:function(){this.rows[this.currRow].backSpace();},clearToEndOfRow:function(){this.rows[this.currRow].clearToEndOfRow();},insertChar:function(e){this.rows[this.currRow].insertChar(e);},setPen:function(e){this.rows[this.currRow].setPenStyles(e);},moveCursor:function(e){this.rows[this.currRow].moveCursor(e);},setCursor:function(e){h.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e);},setPAC:function(e){h.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.currRow=t;var n,r,i=this.rows[this.currRow];null!==e.indent&&(n=e.indent,r=Math.max(n-1,0),i.setCursor(e.indent),e.color=i.chars[r].penState.foreground);var a={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(a);},setBkgData:function(e){h.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32);},setRollUpRows:function(e){this.nrRollUpRows=e;},rollUp:function(){var e,t;null!==this.nrRollUpRows?(h.log("TEXT",this.getDisplayText()),e=this.currRow+1-this.nrRollUpRows,(t=this.rows.splice(e,1)[0]).clear(),this.rows.splice(this.currRow,0,t),h.log("INFO","Rolling up")):h.log("DEBUG","roll_up but nrRollUpRows not set yet");},getDisplayText:function(e){e=e||!1;for(var t=[],n="",r=-1,i=0;i<15;i++){var a=this.rows[i].getTextString();a&&(r=i+1,e?t.push("Row "+r+': "'+a+'"'):t.push(a.trim()));}return 0<t.length&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n},getTextAndFormat:function(){return this.rows}};function p(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new i,this.nonDisplayedMemory=new i,this.lastOutputScreen=new i,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null;}p.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null;},getHandler:function(){return this.outputFilter},setHandler:function(e){this.outputFilter=e;},setPAC:function(e){this.writeScreen.setPAC(e);},setBkgData:function(e){this.writeScreen.setBkgData(e);},setMode:function(e){e!==this.mode&&(this.mode=e,h.log("INFO","MODE="+e),"MODE_POP-ON"==this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e);},insertChars:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";h.log("INFO",n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(h.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate());},cc_RCL:function(){h.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON");},cc_BS:function(){h.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate());},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){h.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate();},cc_RU:function(e){h.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e);},cc_FON:function(){h.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0});},cc_RDC:function(){h.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON");},cc_TR:function(){h.log("INFO","TR"),this.setMode("MODE_TEXT");},cc_RTD:function(){h.log("INFO","RTD"),this.setMode("MODE_TEXT");},cc_EDM:function(){h.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate();},cc_CR:function(){h.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate();},cc_ENM:function(){h.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset();},cc_EOC:function(){var e;h.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode&&(e=this.displayedMemory,this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,h.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())),this.outputDataUpdate();},cc_TO:function(e){h.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e);},cc_MIDROW:function(e){var t,n={flash:!1};n.underline=e%2==1,n.italics=46<=e,n.italics?n.foreground="white":(t=Math.floor(e/2)-16,n.foreground=["white","green","blue","cyan","red","yellow","magenta"][t]),h.log("INFO","MIDROW: "+JSON.stringify(n)),this.writeScreen.setPen(n);},outputDataUpdate:function(){var e=h.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory));},cueSplitAtTime:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e));}};function g(e,t,n){this.field=e||1,this.outputs=[t,n],this.channels=[new p(1,t),new p(2,n)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0};}g.prototype={getHandler:function(e){return this.channels[e].getHandler()},setHandler:function(e,t){this.channels[e].setHandler(t);},addData:function(e,t){var n,r=!1;this.lastTime=e,h.setTime(e);for(var i=0;i<t.length;i+=2){var a=127&t[i],o=127&t[i+1];16<=a&&a<=31&&a===this.lastCmdA&&o===this.lastCmdB?(this.lastCmdA=null,this.lastCmdB=null,h.log("DEBUG","Repeated command ("+u([a,o])+") is dropped")):0!=a||0!=o?(h.log("DATA","["+u([t[i],t[i+1]])+"] -> ("+u([a,o])+")"),(n=(n=(n=(n=this.parseCmd(a,o))||this.parseMidrow(a,o))||this.parsePAC(a,o))||this.parseBackgroundAttributes(a,o))||(r=this.parseChars(a,o))&&(this.currChNr&&0<=this.currChNr?this.channels[this.currChNr-1].insertChars(r):h.log("WARNING","No channel found yet. TEXT-MODE?")),n?this.dataCounters.cmd+=2:r?this.dataCounters.char+=2:(this.dataCounters.other+=2,h.log("WARNING","Couldn't parse cleaned data "+u([a,o])+" orig: "+u([t[i],t[i+1]])))):this.dataCounters.padding+=2;}},parseCmd:function(e,t){var n=null;if(!((20===e||21===e||28===e||29===e)&&32<=t&&t<=47)&&!((23===e||31===e)&&33<=t&&t<=35))return !1;n=20===e||21===e||23===e?1:2;var r=this.channels[n-1];return 20===e||21===e||28===e||29===e?32===t?r.cc_RCL():33===t?r.cc_BS():34===t?r.cc_AOF():35===t?r.cc_AON():36===t?r.cc_DER():37===t?r.cc_RU(2):38===t?r.cc_RU(3):39===t?r.cc_RU(4):40===t?r.cc_FON():41===t?r.cc_RDC():42===t?r.cc_TR():43===t?r.cc_RTD():44===t?r.cc_EDM():45===t?r.cc_CR():46===t?r.cc_ENM():47===t&&r.cc_EOC():r.cc_TO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},parseMidrow:function(e,t){var n=null;if((17===e||25===e)&&32<=t&&t<=47){if((n=17===e?1:2)!==this.currChNr)return h.log("ERROR","Mismatch channel in midrow parsing"),!1;var r=this.channels[n-1];return r.insertChars([32]),r.cc_MIDROW(t),h.log("DEBUG","MIDROW ("+u([e,t])+")"),this.lastCmdA=e,this.lastCmdB=t,!0}return !1},parsePAC:function(e,t){var n,r=null;if(!((17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127)&&!((16===e||24===e)&&64<=t&&t<=95))return !1;n=e<=23?1:2,r=64<=t&&t<=95?1==n?a[e]:d[e]:1==n?l[e]:f[e];var i=this.interpretPAC(r,t);return this.channels[n-1].setPAC(i),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},interpretPAC:function(e,t){var n=t,r={color:null,italics:!1,indent:null,underline:!1,row:e},n=95<t?t-96:t-64;return r.underline=1==(1&n),n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((n-16)/2),r},parseChars:function(e,t){var n,r,i=null,a=null,o=null;return 17<=(o=25<=e?(i=2,e-8):(i=1,e))&&o<=19?(n=t,n=17===o?t+80:18===o?t+112:t+144,h.log("INFO","Special char '"+s(n)+"' in channel "+i),a=[n],this.lastCmdA=e,this.lastCmdB=t):32<=e&&e<=127&&(a=0===t?[e]:[e,t],this.lastCmdA=null,this.lastCmdB=null),a&&(r=u(a),h.log("DEBUG","Char codes =  "+r.join(","))),a},parseBackgroundAttributes:function(e,t){var n,r,i;return ((16===e||24===e)&&32<=t&&t<=47||(23===e||31===e)&&45<=t&&t<=47)&&(n={},16===e||24===e?(r=Math.floor((t-32)/2),n.background=c[r],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0)),i=e<24?1:2,this.channels[i-1].setBkgData(n),this.lastCmdA=e,this.lastCmdB=t,!0)},reset:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null;},cueSplitAtTime:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e);}};e.logger=h,e.PenState=o,e.CaptionScreen=i,e.Cea608Parser=g,e.findCea608Nalus=function(e,t,n){for(var r=0,i=t,a=[];i<t+n;){if(r=e.getUint32(i),6===(31&e.getUint8(i+4)))for(var o=i+5,s=-1;o<i+4+r-1;){s=0;for(var u=255;255===u;)s+=u=e.getUint8(o),o++;for(var l=0,u=255;255===u;)l+=u=e.getUint8(o),o++;!function(e,t,n,r){if(4!==e||t<8)return null;var i=n.getUint8(r),a=n.getUint16(r+1),o=n.getUint32(r+3),s=n.getUint8(r+7);return 181==i&&49==a&&1195456820==o&&3==s}(s,l,e,o)||a.push([o,l]),o+=l;}i+=r+4;}return a},e.extractCea608DataFromRange=function(e,t){var n=t[0],r=[[],[]];n+=8;var i=31&e.getUint8(n);n+=2;for(var a=0;a<i;a++){var o=e.getUint8(n),s=4&o,u=3&o;n++;var l=e.getUint8(n);n++;var d=e.getUint8(n);n++,s&&(127&l)+(127&d)!=0&&(0==u?(r[0].push(l),r[0].push(d)):1==u&&(r[1].push(l),r[1].push(d)));}return r};}(void 0===n?(void 0).cea608parser={}:n);},{}],3:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(A){A=A||{},function(){void 0===A.escapeMode&&(A.escapeMode=!0);void 0===A.attributePrefix&&(A.attributePrefix="_");A.arrayAccessForm=A.arrayAccessForm||"none",A.emptyNodeForm=A.emptyNodeForm||"text",void 0===A.enableToStringFunc&&(A.enableToStringFunc=!0);A.arrayAccessFormPaths=A.arrayAccessFormPaths||[],void 0===A.skipEmptyTextNodesForObj&&(A.skipEmptyTextNodesForObj=!0);void 0===A.stripWhitespaces&&(A.stripWhitespaces=!0);A.datetimeAccessFormPaths=A.datetimeAccessFormPaths||[],void 0===A.useDoubleQuotes&&(A.useDoubleQuotes=!1);A.xmlElementsFilter=A.xmlElementsFilter||[],A.jsonPropertiesFilter=A.jsonPropertiesFilter||[],void 0===A.keepCData&&(A.keepCData=!1);void 0===A.ignoreRoot&&(A.ignoreRoot=!1);}();var I={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function R(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function u(e){return "string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function b(e,t,n,r){for(var i=0;i<e.length;i++){var a=e[i];if("string"==typeof a){if(a==r)break}else if(a instanceof RegExp){if(a.test(r))break}else if("function"==typeof a&&a(t,n,r))break}return i!=e.length}function D(e,t,n){switch(A.arrayAccessForm){case"property":e[t]instanceof Array?e[t+"_asArray"]=e[t]:e[t+"_asArray"]=[e[t]];}!(e[t]instanceof Array)&&0<A.arrayAccessFormPaths.length&&b(A.arrayAccessFormPaths,e,t,n)&&(e[t]=[e[t]]);}function M(e){var t,n=e.split(/[-T:+Z]/g),r=new Date(n[0],n[1]-1,n[2]),i=n[5].split(".");return r.setHours(n[3],n[4],i[0]),1<i.length&&r.setMilliseconds(i[1]),n[6]&&n[7]?(t=60*n[6]+Number(n[7]),t=0+("-"==(/\d\d-\d\d:\d\d$/.test(e)?"-":"+")?-1*t:t),r.setMinutes(r.getMinutes()-t-r.getTimezoneOffset())):-1!==e.indexOf("Z",e.length-1)&&(r=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()))),r}function N(e,t){if(e.nodeType==I.DOCUMENT_NODE){for(var n=new Object,r=e.childNodes,i=0;i<r.length;i++){(o=r[i]).nodeType==I.ELEMENT_NODE&&(A.ignoreRoot?n=N(o):(n={})[d=R(o)]=N(o));}return n}if(e.nodeType==I.ELEMENT_NODE){(n=new Object).__cnt=0;for(var a=[],r=e.childNodes,i=0;i<r.length;i++){var o,s,u,l,d=R(o=r[i]);o.nodeType!=I.COMMENT_NODE&&(s=t+"."+d,v=n,y=o.nodeType,T=d,S=s,y==I.ELEMENT_NODE&&0<A.xmlElementsFilter.length&&!b(A.xmlElementsFilter,v,T,S)||(n.__cnt++,null==n[d]?(u=N(o,s),"#text"==d&&!/[^\s]/.test(u)||((l={})[d]=u,a.push(l)),n[d]=u,D(n,d,s)):(null!=n[d]&&(n[d]instanceof Array||(n[d]=[n[d]],D(n,d,s))),u=N(o,s),"#text"==d&&!/[^\s]/.test(u)||((l={})[d]=u,a.push(l)),n[d][n[d].length]=u)));}n.__children=a;for(var f=R(e),c=0;c<e.attributes.length;c++){var h=e.attributes[c];n.__cnt++;for(var p=h.value,g=0,_=A.matchers.length;g<_;g++){var E=A.matchers[g];E.test(h,f)&&(p=E.converter(h.value));}n[A.attributePrefix+h.name]=p;}var m=e.prefix;return null!=m&&""!=m&&(n.__cnt++,n.__prefix=m),null!=n["#text"]&&(n.__text=n["#text"],n.__text instanceof Array&&(n.__text=n.__text.join("\n")),A.stripWhitespaces&&(n.__text=n.__text.trim()),delete n["#text"],"property"==A.arrayAccessForm&&delete n["#text_asArray"],n.__text=function(e,t,n){if(0<A.datetimeAccessFormPaths.length){var r=n.split(".#")[0];return b(A.datetimeAccessFormPaths,e,t,r)?M(e):e}return e}(n.__text,d,t+"."+d)),null!=n["#cdata-section"]&&(n.__cdata=n["#cdata-section"],delete n["#cdata-section"],"property"==A.arrayAccessForm&&delete n["#cdata-section_asArray"]),0==n.__cnt&&"text"==A.emptyNodeForm?n="":1==n.__cnt&&null!=n.__text?n=n.__text:1!=n.__cnt||null==n.__cdata||A.keepCData?1<n.__cnt&&null!=n.__text&&A.skipEmptyTextNodesForObj&&(A.stripWhitespaces&&""==n.__text||""==n.__text.trim())&&delete n.__text:n=n.__cdata,delete n.__cnt,!A.enableToStringFunc||null==n.__text&&null==n.__cdata||(n.toString=function(){return (null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),n}if(e.nodeType==I.TEXT_NODE||e.nodeType==I.CDATA_SECTION_NODE)return e.nodeValue;var v,y,T,S;}function l(e,t,n,r){var i="<"+(null!=e&&null!=e.__prefix?e.__prefix+":":"")+t;if(null!=n)for(var a=0;a<n.length;a++){var o=n[a],s=e[o];A.escapeMode&&(s=u(s)),i+=" "+o.substr(A.attributePrefix.length)+"=",A.useDoubleQuotes?i+='"'+s+'"':i+="'"+s+"'";}return i+=r?"/>":">"}function d(e,t){return "</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function f(e,t){return "property"==A.arrayAccessForm&&(n=t.toString(),r="_asArray",-1!==n.indexOf(r,n.length-r.length))||0==t.toString().indexOf(A.attributePrefix)||0==t.toString().indexOf("__")||e[t]instanceof Function;var n,r;}function c(e){var t=0;if(e instanceof Object)for(var n in e)f(e,n)||t++;return t}function h(e){var t=[];if(e instanceof Object)for(var n in e)-1==n.toString().indexOf("__")&&0==n.toString().indexOf(A.attributePrefix)&&t.push(n);return t}function p(e){var t,n,r="";return e instanceof Object?r+=(n="",null!=(t=e).__cdata&&(n+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(A.escapeMode?n+=u(t.__text):n+=t.__text),n):null!=e&&(A.escapeMode?r+=u(e):r+=e),r}function g(e,t){return ""===e?t:e+"."+t}function _(e,t){var n,r,i,a,o,s="";if(0<c(e))for(var u in e){f(e,u)||""!=t&&(i=e,o=g(t,a=u),0!=A.jsonPropertiesFilter.length&&""!=o&&!b(A.jsonPropertiesFilter,i,a,o))||(r=h(n=e[u]),null==n||null==n?s+=l(n,u,r,!0):n instanceof Object?n instanceof Array?s+=function(e,t,n,r){var i="";if(0==e.length)i+=l(e,t,n,!0);else for(var a=0;a<e.length;a++)i+=l(e[a],t,h(e[a]),!1),i+=_(e[a],g(r,t)),i+=d(e[a],t);return i}(n,u,r,t):n instanceof Date?(s+=l(n,u,r,!1),s+=n.toISOString(),s+=d(n,u)):0<c(n)||null!=n.__text||null!=n.__cdata?(s+=l(n,u,r,!1),s+=_(n,g(t,u)),s+=d(n,u)):s+=l(n,u,r,!0):(s+=l(n,u,r,!1),s+=p(n),s+=d(n,u)));}return s+=p(e)}this.parseXmlString=function(e){var t;if(void 0===e)return null;if(window.DOMParser){var n=new window.DOMParser;try{0<(t=n.parseFromString(e,"text/xml")).getElementsByTagNameNS("*","parsererror").length&&(t=null);}catch(e){t=null;}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),(t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e);return t},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return "string"==typeof e?M(e):e},this.xml2json=function(e){return N(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return _(e,"")},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return "1.2.0"};},t.exports=n.default;},{}],4:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=e(5),a=r(e(124)),o=r(e(161)),s=r(e(102)),u=r(e(45));dashjs.Protection=o.default,dashjs.MetricsReporting=a.default,dashjs.MediaPlayerFactory=s.default,dashjs.Debug=u.default,n.default=dashjs,n.MediaPlayer=i.MediaPlayer,n.Protection=o.default,n.MetricsReporting=a.default,n.MediaPlayerFactory=s.default,n.Debug=u.default;},{102:102,124:124,161:161,45:45,5:5}],5:[function(u,e,l){(function(e){function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(l,"__esModule",{value:!0});var n=t(u(100)),r=t(u(47)),i=t(u(45)),a=u(50),o="undefined"!=typeof window&&window||e,s=o.dashjs;(s=s||(o.dashjs={})).MediaPlayer=n.default,s.FactoryMaker=r.default,s.Debug=i.default,s.Version=(0, a.getVersionString)(),l.default=s,l.MediaPlayer=n.default,l.FactoryMaker=r.default,l.Debug=i.default;}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});},{100:100,45:45,47:47,50:50}],6:[function(e,t,n){n.byteLength=function(e){var t=f(e),n=t[0],r=t[1];return 3*(n+r)/4-r},n.toByteArray=function(e){for(var t,n=f(e),r=n[0],i=n[1],a=new d(function(e,t){return 3*(e+t)/4-t}(r,i)),o=0,s=0<i?r-4:r,u=0;u<s;u+=4)t=l[e.charCodeAt(u)]<<18|l[e.charCodeAt(u+1)]<<12|l[e.charCodeAt(u+2)]<<6|l[e.charCodeAt(u+3)],a[o++]=t>>16&255,a[o++]=t>>8&255,a[o++]=255&t;2===i&&(t=l[e.charCodeAt(u)]<<2|l[e.charCodeAt(u+1)]>>4,a[o++]=255&t);1===i&&(t=l[e.charCodeAt(u)]<<10|l[e.charCodeAt(u+1)]<<4|l[e.charCodeAt(u+2)]>>2,a[o++]=t>>8&255,a[o++]=255&t);return a},n.fromByteArray=function(e){for(var t,n=e.length,r=n%3,i=[],a=0,o=n-r;a<o;a+=16383)i.push(function(e,t,n){for(var r,i=[],a=t;a<n;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),i.push(function(e){return s[e>>18&63]+s[e>>12&63]+s[e>>6&63]+s[63&e]}(r));return i.join("")}(e,a,o<a+16383?o:a+16383));1==r?(t=e[n-1],i.push(s[t>>2]+s[t<<4&63]+"==")):2==r&&(t=(e[n-2]<<8)+e[n-1],i.push(s[t>>10]+s[t>>4&63]+s[t<<2&63]+"="));return i.join("")};for(var s=[],l=[],d="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,a=r.length;i<a;++i)s[i]=r[i],l[r.charCodeAt(i)]=i;function f(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return -1===n&&(n=t),[n,n===t?0:4-n%4]}l["-".charCodeAt(0)]=62,l["_".charCodeAt(0)]=63;},{}],7:[function(e,t,n){},{}],8:[function(e,t,n){var s=e(6),a=e(13);n.Buffer=f,n.SlowBuffer=function(e){+e!=e&&(e=0);return f.alloc(+e)},n.INSPECT_MAX_BYTES=50;var r=2147483647;function o(e){if(r<e)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__=f.prototype,t}function f(e,t,n){if("number"!=typeof e)return i(e,t,n);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return l(e)}function i(e,t,n){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!f.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|h(e,t),r=o(n),i=r.write(e,t);i!==n&&(r=r.slice(0,i));return r}(e,t);if(ArrayBuffer.isView(e))return d(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(O(e,ArrayBuffer)||e&&O(e.buffer,ArrayBuffer))return function(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n);return r.__proto__=f.prototype,r}(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return f.from(r,t,n);var i=function(e){if(f.isBuffer(e)){var t=0|c(e.length),n=o(t);return 0===n.length?n:(e.copy(n,0,0,t),n)}if(void 0!==e.length)return "number"!=typeof e.length||w(e.length)?o(0):d(e);if("Buffer"===e.type&&Array.isArray(e.data))return d(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return f.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function l(e){return u(e),o(e<0?0:0|c(e))}function d(e){for(var t=e.length<0?0:0|c(e.length),n=o(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function c(e){if(r<=e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return 0|e}function h(e,t){if(f.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||O(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=2<arguments.length&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return M(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return N(e).length;default:if(i)return r?-1:M(e).length;t=(""+t).toLowerCase(),i=!0;}}function p(e,t,n){var r,i,a,o=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return "";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return "";if((n>>>=0)<=(t>>>=0))return "";for(e=e||"utf8";;)switch(e){case"hex":return function(e,t,n){var r=e.length;(!t||t<0)&&(t=0);(!n||n<0||r<n)&&(n=r);for(var i="",a=t;a<n;++a)i+=function(e){return e<16?"0"+e.toString(16):e.toString(16)}(e[a]);return i}(this,t,n);case"utf8":case"utf-8":return y(this,t,n);case"ascii":return function(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}(this,t,n);case"latin1":case"binary":return function(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}(this,t,n);case"base64":return r=this,a=n,0===(i=t)&&a===r.length?s.fromByteArray(r):s.fromByteArray(r.slice(i,a));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,n){for(var r=e.slice(t,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}(this,t,n);default:if(o)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0;}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r;}function _(e,t,n,r,i){if(0===e.length)return -1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),w(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return -1;n=e.length-1;}else if(n<0){if(!i)return -1;n=0;}if("string"==typeof t&&(t=f.from(t,r)),f.isBuffer(t))return 0===t.length?-1:E(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):E(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function E(e,t,n,r,i){var a=1,o=e.length,s=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return -1;o/=a=2,s/=2,n/=2;}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i)for(var l=-1,d=n;d<o;d++)if(u(e,d)===u(t,-1===l?0:d-l)){if(-1===l&&(l=d),d-l+1===s)return l*a}else -1!==l&&(d-=d-l),l=-1;else for(o<n+s&&(n=o-s),d=n;0<=d;d--){for(var f=!0,c=0;c<s;c++)if(u(e,d+c)!==u(t,c)){f=!1;break}if(f)return d}return -1}function m(e,t,n,r){return C(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function v(e,t,n,r){return C(function(e,t){for(var n,r,i,a=[],o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),r=n>>8,i=n%256,a.push(i),a.push(r);return a}(t,e.length-n),e,n,r)}function y(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var a,o,s,u,l=e[i],d=null,f=239<l?4:223<l?3:191<l?2:1;if(i+f<=n)switch(f){case 1:l<128&&(d=l);break;case 2:128==(192&(a=e[i+1]))&&127<(u=(31&l)<<6|63&a)&&(d=u);break;case 3:a=e[i+1],o=e[i+2],128==(192&a)&&128==(192&o)&&2047<(u=(15&l)<<12|(63&a)<<6|63&o)&&(u<55296||57343<u)&&(d=u);break;case 4:a=e[i+1],o=e[i+2],s=e[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&65535<(u=(15&l)<<18|(63&a)<<12|(63&o)<<6|63&s)&&u<1114112&&(d=u);}null===d?(d=65533,f=1):65535<d&&(d-=65536,r.push(d>>>10&1023|55296),d=56320|1023&d),r.push(d),i+=f;}return function(e){var t=e.length;if(t<=T)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=T));return n}(r)}n.kMaxLength=r,(f.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return !1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(f.prototype,"parent",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.buffer}}),Object.defineProperty(f.prototype,"offset",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),f.poolSize=8192,f.from=i,f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,f.alloc=function(e,t,n){return i=t,a=n,u(r=e),r<=0||void 0===i?o(r):"string"==typeof a?o(r).fill(i,a):o(r).fill(i);var r,i,a;},f.allocUnsafe=l,f.allocUnsafeSlow=l,f.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==f.prototype},f.compare=function(e,t){if(O(e,Uint8Array)&&(e=f.from(e,e.offset,e.byteLength)),O(t,Uint8Array)&&(t=f.from(t,t.offset,t.byteLength)),!f.isBuffer(e)||!f.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},f.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return !0;default:return !1}},f.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return f.alloc(0);if(void 0===t)for(i=t=0;i<e.length;++i)t+=e[i].length;for(var n=f.allocUnsafe(t),r=0,i=0;i<e.length;++i){var a=e[i];if(O(a,Uint8Array)&&(a=f.from(a)),!f.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,r),r+=a.length;}return n},f.byteLength=h,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},f.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},f.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},f.prototype.toLocaleString=f.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?y(this,0,e):p.apply(this,arguments)},f.prototype.equals=function(e){if(!f.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===f.compare(this,e)},f.prototype.inspect=function(){var e="",t=n.INSPECT_MAX_BYTES,e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim();return this.length>t&&(e+=" ... "),"<Buffer "+e+">"},f.prototype.compare=function(e,t,n,r,i){if(O(e,Uint8Array)&&(e=f.from(e,e.offset,e.byteLength)),!f.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(i<=r&&n<=t)return 0;if(i<=r)return -1;if(n<=t)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0),s=Math.min(a,o),u=this.slice(r,i),l=e.slice(t,n),d=0;d<s;++d)if(u[d]!==l[d]){a=u[d],o=l[d];break}return a<o?-1:o<a?1:0},f.prototype.includes=function(e,t,n){return -1!==this.indexOf(e,t,n)},f.prototype.indexOf=function(e,t,n){return _(this,e,t,n,!0)},f.prototype.lastIndexOf=function(e,t,n){return _(this,e,t,n,!1)},f.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else {if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0);}var i=this.length-t;if((void 0===n||i<n)&&(n=i),0<e.length&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var a,o,s,u,l,d,f=!1;;)switch(r){case"hex":return function(e,t,n,r){n=Number(n)||0;var i=e.length-n;(!r||i<(r=Number(r)))&&(r=i);var a=t.length;a/2<r&&(r=a/2);for(var o=0;o<r;++o){var s=parseInt(t.substr(2*o,2),16);if(w(s))return o;e[n+o]=s;}return o}(this,e,t,n);case"utf8":case"utf-8":return l=t,d=n,C(M(e,(u=this).length-l),u,l,d);case"ascii":return m(this,e,t,n);case"latin1":case"binary":return m(this,e,t,n);case"base64":return a=this,o=t,s=n,C(N(e),a,o,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v(this,e,t,n);default:if(f)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),f=!0;}},f.prototype.toJSON=function(){return {type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var T=4096;function S(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(n<e+t)throw new RangeError("Trying to access beyond buffer length")}function A(e,t,n,r,i,a){if(!f.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<t||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function I(e,t,n,r){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function R(e,t,n,r,i){return t=+t,n>>>=0,i||I(e,0,n,4),a.write(e,t,n,r,23,4),n+4}function b(e,t,n,r,i){return t=+t,n>>>=0,i||I(e,0,n,8),a.write(e,t,n,r,52,8),n+8}f.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return r.__proto__=f.prototype,r},f.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||S(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r},f.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||S(e,t,this.length);for(var r=this[e+--t],i=1;0<t&&(i*=256);)r+=this[e+--t]*i;return r},f.prototype.readUInt8=function(e,t){return e>>>=0,t||S(e,1,this.length),this[e]},f.prototype.readUInt16LE=function(e,t){return e>>>=0,t||S(e,2,this.length),this[e]|this[e+1]<<8},f.prototype.readUInt16BE=function(e,t){return e>>>=0,t||S(e,2,this.length),this[e]<<8|this[e+1]},f.prototype.readUInt32LE=function(e,t){return e>>>=0,t||S(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},f.prototype.readUInt32BE=function(e,t){return e>>>=0,t||S(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},f.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||S(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return (i*=128)<=r&&(r-=Math.pow(2,8*t)),r},f.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||S(e,t,this.length);for(var r=t,i=1,a=this[e+--r];0<r&&(i*=256);)a+=this[e+--r]*i;return (i*=128)<=a&&(a-=Math.pow(2,8*t)),a},f.prototype.readInt8=function(e,t){return e>>>=0,t||S(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},f.prototype.readInt16LE=function(e,t){e>>>=0,t||S(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},f.prototype.readInt16BE=function(e,t){e>>>=0,t||S(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},f.prototype.readInt32LE=function(e,t){return e>>>=0,t||S(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},f.prototype.readInt32BE=function(e,t){return e>>>=0,t||S(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},f.prototype.readFloatLE=function(e,t){return e>>>=0,t||S(e,4,this.length),a.read(this,e,!0,23,4)},f.prototype.readFloatBE=function(e,t){return e>>>=0,t||S(e,4,this.length),a.read(this,e,!1,23,4)},f.prototype.readDoubleLE=function(e,t){return e>>>=0,t||S(e,8,this.length),a.read(this,e,!0,52,8)},f.prototype.readDoubleBE=function(e,t){return e>>>=0,t||S(e,8,this.length),a.read(this,e,!1,52,8)},f.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||A(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},f.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||A(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[t+i]=255&e;0<=--i&&(a*=256);)this[t+i]=e/a&255;return t+n},f.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,1,255,0),this[t]=255&e,t+1},f.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},f.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},f.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},f.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},f.prototype.writeIntLE=function(e,t,n,r){var i;e=+e,t>>>=0,r||A(this,e,t,n,(i=Math.pow(2,8*n-1))-1,-i);var a=0,o=1,s=0;for(this[t]=255&e;++a<n&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},f.prototype.writeIntBE=function(e,t,n,r){var i;e=+e,t>>>=0,r||A(this,e,t,n,(i=Math.pow(2,8*n-1))-1,-i);var a=n-1,o=1,s=0;for(this[t+a]=255&e;0<=--a&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},f.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},f.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},f.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},f.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},f.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},f.prototype.writeFloatLE=function(e,t,n){return R(this,e,t,!0,n)},f.prototype.writeFloatBE=function(e,t,n){return R(this,e,t,!1,n)},f.prototype.writeDoubleLE=function(e,t,n){return b(this,e,t,!0,n)},f.prototype.writeDoubleBE=function(e,t,n){return b(this,e,t,!1,n)},f.prototype.copy=function(e,t,n,r){if(!f.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n=n||0,r||0===r||(r=this.length),t>=e.length&&(t=e.length),t=t||0,0<r&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i=r-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,n,r);else if(this===e&&n<t&&t<r)for(var a=i-1;0<=a;--a)e[a+t]=this[a+n];else Uint8Array.prototype.set.call(e,this.subarray(n,r),t);return i},f.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!f.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var i;1===e.length&&(i=e.charCodeAt(0),("utf8"===r&&i<128||"latin1"===r)&&(e=i));}else "number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(e=e||0))for(a=t;a<n;++a)this[a]=e;else {var o=f.isBuffer(e)?e:f.from(e,r),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<n-t;++a)this[a+t]=o[a%s];}return this};var D=/[^+/0-9A-Za-z-_]/g;function M(e,t){var n;t=t||1/0;for(var r=e.length,i=null,a=[],o=0;o<r;++o){if(55295<(n=e.charCodeAt(o))&&n<57344){if(!i){if(56319<n){-1<(t-=3)&&a.push(239,191,189);continue}if(o+1===r){-1<(t-=3)&&a.push(239,191,189);continue}i=n;continue}if(n<56320){-1<(t-=3)&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320);}else i&&-1<(t-=3)&&a.push(239,191,189);if(i=null,n<128){if(--t<0)break;a.push(n);}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128);}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128);}else {if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128);}}return a}function N(e){return s.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(D,"")).length<2)return "";for(;e.length%4!=0;)e+="=";return e}(e))}function C(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function O(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function w(e){return e!=e}},{13:13,6:6}],9:[function(e,t,n){var i={parseBuffer:function(e){return new a(e).parse()},addBoxProcessor:function(e,t){"string"==typeof e&&"function"==typeof t&&(o.prototype._boxProcessors[e]=t);},createFile:function(){return new a},createBox:function(e,t,n){var r=o.create(e);return t&&t.append(r,n),r},createFullBox:function(e,t,n){var r=i.createBox(e,t,n);return r.version=0,r.flags=0,r},Utils:{}};i.Utils.dataViewToString=function(e,t){var n=t||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(n).decode(e);var r=[],i=0;if("utf-8"===n)for(;i<e.byteLength;){var a=e.getUint8(i++);a<128||(a<224?a=(31&a)<<6:(a<240?a=(15&a)<<12:(a=(7&a)<<18,a|=(63&e.getUint8(i++))<<12),a|=(63&e.getUint8(i++))<<6),a|=63&e.getUint8(i++)),r.push(String.fromCharCode(a));}else for(;i<e.byteLength;)r.push(String.fromCharCode(e.getUint8(i++)));return r.join("")},i.Utils.utf8ToByteArray=function(e){var t,n;if("undefined"!=typeof TextEncoder)t=(new TextEncoder).encode(e);else for(t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):(r<2048?t.push(192|r>>6):(r<65536?t.push(224|r>>12):(t.push(240|r>>18),t.push(128|63&r>>12)),t.push(128|63&r>>6)),t.push(128|63&r));}return t},i.Utils.appendBox=function(e,t,n){if(t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,-1!==n)if(null!=n){var r,i=-1;if("number"==typeof n)i=n;else {if("string"==typeof n)r=n;else {if("object"!=typeof n||!n.type)return void e.boxes.push(t);r=n.type;}for(var a=0;a<e.boxes.length;a++)if(r===e.boxes[a].type){i=a+1;break}}e.boxes.splice(i,0,t);}else e.boxes.push(t);},void 0!==n&&(n.parseBuffer=i.parseBuffer,n.addBoxProcessor=i.addBoxProcessor,n.createFile=i.createFile,n.createBox=i.createBox,n.createFullBox=i.createFullBox,n.Utils=i.Utils),i.Cursor=function(e){this.offset=void 0===e?0:e;};var a=function(e){this._cursor=new i.Cursor,this.boxes=[],e&&(this._raw=new DataView(e));};a.prototype.fetch=function(e){var t=this.fetchAll(e,!0);return t.length?t[0]:null},a.prototype.fetchAll=function(e,t){var n=[];return a._sweep.call(this,e,n,t),n},a.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var e=o.parse(this);if(void 0===e.type)break;this.boxes.push(e);}return this},a._sweep=function(e,t,n){for(var r in this.type&&this.type==e&&t.push(this),this.boxes){if(t.length&&n)return;a._sweep.call(this.boxes[r],e,t,n);}},a.prototype.write=function(){for(var e=0,t=0;t<this.boxes.length;t++)e+=this.boxes[t].getLength(!1);var n=new Uint8Array(e);for(this._rawo=new DataView(n.buffer),this.bytes=n,t=this._cursor.offset=0;t<this.boxes.length;t++)this.boxes[t].write();return n.buffer},a.prototype.append=function(e,t){i.Utils.appendBox(this,e,t);};var o=function(){this._cursor=new i.Cursor;};o.parse=function(e){var t=new o;return t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,t._parseBox(),e._cursor.offset=t._raw.byteOffset+t._raw.byteLength,t},o.create=function(e){var t=new o;return t.type=e,t.boxes=[],t},o.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],o.prototype._boxProcessors={},o.prototype._procField=function(e,t,n){this._parsing?this[e]=this._readField(t,n):this._writeField(t,n,this[e]);},o.prototype._procFieldArray=function(e,t,n,r){var i;if(this._parsing)for(this[e]=[],i=0;i<t;i++)this[e][i]=this._readField(n,r);else for(i=0;i<this[e].length;i++)this._writeField(n,r,this[e][i]);},o.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24);},o.prototype._procEntries=function(e,t,n){var r;if(this._parsing)for(this[e]=[],r=0;r<t;r++)this[e].push({}),n.call(this,this[e][r]);else for(r=0;r<t;r++)n.call(this,this[e][r]);},o.prototype._procSubEntries=function(e,t,n,r){var i;if(this._parsing)for(e[t]=[],i=0;i<n;i++)e[t].push({}),r.call(this,e[t][i]);else for(i=0;i<n;i++)r.call(this,e[t][i]);},o.prototype._procEntryField=function(e,t,n,r){this._parsing?e[t]=this._readField(n,r):this._writeField(n,r,e[t]);},o.prototype._procSubBoxes=function(e,t){var n;if(this._parsing)for(this[e]=[],n=0;n<t;n++)this[e].push(o.parse(this));else for(n=0;n<t;n++)this._rawo?this[e][n].write():this.size+=this[e][n].getLength();},o.prototype._readField=function(e,t){switch(e){case"uint":return this._readUint(t);case"int":return this._readInt(t);case"template":return this._readTemplate(t);case"string":return -1===t?this._readTerminatedString():this._readString(t);case"data":return this._readData(t);case"utf8":return this._readUTF8String();default:return -1}},o.prototype._readInt=function(e){var t=null,n=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:t=this._raw.getInt8(n);break;case 16:t=this._raw.getInt16(n);break;case 32:t=this._raw.getInt32(n);break;case 64:var r=this._raw.getInt32(n),i=this._raw.getInt32(4+n),t=r*Math.pow(2,32)+i;}return this._cursor.offset+=e>>3,t},o.prototype._readUint=function(e){var t,n,r=null,i=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:r=this._raw.getUint8(i);break;case 16:r=this._raw.getUint16(i);break;case 24:r=((t=this._raw.getUint16(i))<<8)+(n=this._raw.getUint8(2+i));break;case 32:r=this._raw.getUint32(i);break;case 64:t=this._raw.getUint32(i),n=this._raw.getUint32(4+i),r=t*Math.pow(2,32)+n;}return this._cursor.offset+=e>>3,r},o.prototype._readString=function(e){for(var t="",n=0;n<e;n++){var r=this._readUint(8);t+=String.fromCharCode(r);}return t},o.prototype._readTemplate=function(e){return this._readUint(e/2)+this._readUint(e/2)/Math.pow(2,e/2)},o.prototype._readTerminatedString=function(){for(var e="";this._cursor.offset-this._offset<this._raw.byteLength;){var t=this._readUint(8);if(0===t)break;e+=String.fromCharCode(t);}return e},o.prototype._readData=function(e){var t=0<e?e:this._raw.byteLength-(this._cursor.offset-this._offset);if(0<t){var n=new Uint8Array(this._raw.buffer,this._cursor.offset,t);return this._cursor.offset+=t,n}return null},o.prototype._readUTF8String=function(){var e=this._raw.byteLength-(this._cursor.offset-this._offset),t=null;return 0<e&&(t=new DataView(this._raw.buffer,this._cursor.offset,e),this._cursor.offset+=e),t?i.Utils.dataViewToString(t):t},o.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)this._root._incomplete=!0;else {switch(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset+8);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size);}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type)?this._parseContainerBox():this._data=this._readData());}},o.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24);},o.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(o.parse(this));},o.prototype.append=function(e,t){i.Utils.appendBox(this,e,t);},o.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.size+=this.boxes[e].getLength();return this._data&&this._writeData(this._data),this.size},o.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size);}if(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.boxes[e].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},o.prototype._writeInt=function(e,t){if(this._rawo){var n=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setInt8(n,t);break;case 16:this._rawo.setInt16(n,t);break;case 32:this._rawo.setInt32(n,t);break;case 64:var r=Math.floor(t/Math.pow(2,32)),i=t-r*Math.pow(2,32);this._rawo.setUint32(n,r),this._rawo.setUint32(4+n,i);}this._cursor.offset+=e>>3;}else this.size+=e>>3;},o.prototype._writeUint=function(e,t){if(this._rawo){var n,r,i=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setUint8(i,t);break;case 16:this._rawo.setUint16(i,t);break;case 24:n=(16776960&t)>>8,r=255&t,this._rawo.setUint16(i,n),this._rawo.setUint8(2+i,r);break;case 32:this._rawo.setUint32(i,t);break;case 64:r=t-(n=Math.floor(t/Math.pow(2,32)))*Math.pow(2,32),this._rawo.setUint32(i,n),this._rawo.setUint32(4+i,r);}this._cursor.offset+=e>>3;}else this.size+=e>>3;},o.prototype._writeString=function(e,t){for(var n=0;n<e;n++)this._writeUint(8,t.charCodeAt(n));},o.prototype._writeTerminatedString=function(e){if(0!==e.length){for(var t=0;t<e.length;t++)this._writeUint(8,e.charCodeAt(t));this._writeUint(8,0);}},o.prototype._writeTemplate=function(e,t){var n=Math.floor(t),r=(t-n)*Math.pow(2,e/2);this._writeUint(e/2,n),this._writeUint(e/2,r);},o.prototype._writeData=function(e){if(e)if(this._rawo){if(e instanceof Array){for(var t=this._cursor.offset-this._rawo.byteOffset,n=0;n<e.length;n++)this._rawo.setInt8(t+n,e[n]);this._cursor.offset+=e.length;}e instanceof Uint8Array&&(this._root.bytes.set(e,this._cursor.offset),this._cursor.offset+=e.length);}else this.size+=e.length;},o.prototype._writeUTF8String=function(e){var t=i.Utils.utf8ToByteArray(e);if(this._rawo)for(var n=new DataView(this._rawo.buffer,this._cursor.offset,t.length),r=0;r<t.length;r++)n.setUint8(r,t[r]);else this.size+=t.length;},o.prototype._writeField=function(e,t,n){switch(e){case"uint":this._writeUint(t,n);break;case"int":this._writeInt(t,n);break;case"template":this._writeTemplate(t,n);break;case"string":-1==t?this._writeTerminatedString(n):this._writeString(t,n);break;case"data":this._writeData(n);break;case"utf8":this._writeUTF8String(n);}},o.prototype._boxProcessors.avc1=o.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1);},o.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count);},o.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"segment_duration","uint",1===this.version?64:32),this._procEntryField(e,"media_time","int",1===this.version?64:32),this._procEntryField(e,"media_rate_integer","int",16),this._procEntryField(e,"media_rate_fraction","int",16);});},o.prototype._boxProcessors.emsg=function(){this._procFullBox(),1==this.version?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1);},o.prototype._boxProcessors.free=o.prototype._boxProcessors.skip=function(){this._procField("data","data",-1);},o.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32);},o.prototype._boxProcessors.ftyp=o.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var e=-1;this._parsing&&(e=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",e,"string",4);},o.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1);},o.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1);},o.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._parsing||"string"!=typeof this.language||(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode(96+(this.language>>10&31),96+(this.language>>5&31),96+(31&this.language))),this._procField("pre_defined","uint",16);},o.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",1==this.version?64:32);},o.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32);},o.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32);},o.prototype._boxProcessors.mp4a=o.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1);},o.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32);},o.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8");},o.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8);},o.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),1&this.flags&&this._procField("scheme_uri","string",-1);},o.prototype._boxProcessors.sdtp=function(){this._procFullBox();var e=-1;this._parsing&&(e=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",e,"uint",8);},o.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",1==this.version?64:32),this._procField("first_offset","uint",1==this.version?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,function(e){this._parsing||(e.reference=(1&e.reference_type)<<31,e.reference|=2147483647&e.referenced_size,e.sap=(1&e.starts_with_SAP)<<31,e.sap|=(3&e.SAP_type)<<28,e.sap|=268435455&e.SAP_delta_time),this._procEntryField(e,"reference","uint",32),this._procEntryField(e,"subsegment_duration","uint",32),this._procEntryField(e,"sap","uint",32),this._parsing&&(e.reference_type=e.reference>>31&1,e.referenced_size=2147483647&e.reference,e.starts_with_SAP=e.sap>>31&1,e.SAP_type=e.sap>>28&7,e.SAP_delta_time=268435455&e.sap);});},o.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16);},o.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,function(e){this._procEntryField(e,"ranges_count","uint",32),this._procSubEntries(e,"ranges",e.ranges_count,function(e){this._procEntryField(e,"level","uint",8),this._procEntryField(e,"range_size","uint",24);});});},o.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count);},o.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"sample_delta","uint",32),this._procEntryField(e,"subsample_count","uint",16),this._procSubEntries(e,"subsamples",e.subsample_count,function(e){this._procEntryField(e,"subsample_size","uint",1===this.version?32:16),this._procEntryField(e,"subsample_priority","uint",8),this._procEntryField(e,"discardable","uint",8),this._procEntryField(e,"codec_specific_parameters","uint",32);});});},o.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8);},o.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",1==this.version?64:32);},o.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),1&this.flags&&this._procField("base_data_offset","uint",64),2&this.flags&&this._procField("sample_description_offset","uint",32),8&this.flags&&this._procField("default_sample_duration","uint",32),16&this.flags&&this._procField("default_sample_size","uint",32),32&this.flags&&this._procField("default_sample_flags","uint",32);},o.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(48&this.length_size_of_traf_num)<<4,this.reserved|=(12&this.length_size_of_trun_num)<<2,this.reserved|=3&this.length_size_of_sample_num),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(48&this.reserved)>>4,this.length_size_of_trun_num=(12&this.reserved)>>2,this.length_size_of_sample_num=3&this.reserved),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,function(e){this._procEntryField(e,"time","uint",1===this.version?64:32),this._procEntryField(e,"moof_offset","uint",1===this.version?64:32),this._procEntryField(e,"traf_number","uint",8*(this.length_size_of_traf_num+1)),this._procEntryField(e,"trun_number","uint",8*(this.length_size_of_trun_num+1)),this._procEntryField(e,"sample_number","uint",8*(this.length_size_of_sample_num+1));});},o.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32);},o.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32);},o.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("data_offset","int",32),4&this.flags&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,function(e){256&this.flags&&this._procEntryField(e,"sample_duration","uint",32),512&this.flags&&this._procEntryField(e,"sample_size","uint",32),1024&this.flags&&this._procEntryField(e,"sample_flags","uint",32),2048&this.flags&&this._procEntryField(e,"sample_composition_time_offset",1===this.version?"int":"uint",32);});},o.prototype._boxProcessors["url "]=o.prototype._boxProcessors["urn "]=function(){this._procFullBox(),"urn "===this.type&&this._procField("name","string",-1),this._procField("location","string",-1);},o.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8");},o.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16);},o.prototype._boxProcessors.vttC=function(){this._procField("config","utf8");},o.prototype._boxProcessors.vtte=function(){};},{}],10:[function(e,t,n){(function(e){function t(e){return Object.prototype.toString.call(e)}n.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===t(e)},n.isBoolean=function(e){return "boolean"==typeof e},n.isNull=function(e){return null===e},n.isNullOrUndefined=function(e){return null==e},n.isNumber=function(e){return "number"==typeof e},n.isString=function(e){return "string"==typeof e},n.isSymbol=function(e){return "symbol"==typeof e},n.isUndefined=function(e){return void 0===e},n.isRegExp=function(e){return "[object RegExp]"===t(e)},n.isObject=function(e){return "object"==typeof e&&null!==e},n.isDate=function(e){return "[object Date]"===t(e)},n.isError=function(e){return "[object Error]"===t(e)||e instanceof Error},n.isFunction=function(e){return "function"==typeof e},n.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},n.isBuffer=e.isBuffer;}).call(this,{isBuffer:e(22)});},{22:22}],11:[function(e,t,n){var u=Object.create||function(e){function t(){}return t.prototype=e,new t},o=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return n},a=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function r(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=u(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0;}((t.exports=r).EventEmitter=r).prototype._events=void 0,r.prototype._maxListeners=void 0;var i,s=10;try{var l={};Object.defineProperty&&Object.defineProperty(l,"x",{value:0}),i=0===l.x;}catch(e){i=!1;}function d(e){return void 0===e._maxListeners?r.defaultMaxListeners:e._maxListeners}function f(e,t,n,r){var i,a,o,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');return (i=e._events)?(i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),a=i[t]):(i=e._events=u(null),e._eventsCount=0),a?("function"==typeof a?a=i[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),a.warned||(s=d(e))&&0<s&&a.length>s&&(a.warned=!0,(o=new Error("Possible EventEmitter memory leak detected. "+a.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.')).name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=a.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",o.name,o.message))):(a=i[t]=n,++e._eventsCount),e}function c(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e);}}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=a.call(c,r);return i.listener=n,r.wrapFn=i}function p(e,t,n){var r=e._events;if(!r)return [];var i=r[t];return i?"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):_(i,i.length):[]}function g(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function _(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}i?Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');s=e;}}):r.defaultMaxListeners=s,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},r.prototype.getMaxListeners=function(){return d(this)},r.prototype.emit=function(e,t,n,r){var i,a,o,s,u="error"===e,l=this._events;if(l)u=u&&null==l.error;else if(!u)return !1;if(u){if(1<arguments.length&&(i=t),i instanceof Error)throw i;var d=new Error('Unhandled "error" event. ('+i+")");throw d.context=i,d}if(!(a=l[e]))return !1;var f,c="function"==typeof a;switch(f=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var r=e.length,i=_(e,r),a=0;a<r;++a)i[a].call(n);}(a,c,this);break;case 2:!function(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,a=_(e,i),o=0;o<i;++o)a[o].call(n,r);}(a,c,this,t);break;case 3:!function(e,t,n,r,i){if(t)e.call(n,r,i);else for(var a=e.length,o=_(e,a),s=0;s<a;++s)o[s].call(n,r,i);}(a,c,this,t,n);break;case 4:!function(e,t,n,r,i,a){if(t)e.call(n,r,i,a);else for(var o=e.length,s=_(e,o),u=0;u<o;++u)s[u].call(n,r,i,a);}(a,c,this,t,n,r);break;default:for(o=new Array(f-1),s=1;s<f;s++)o[s-1]=arguments[s];!function(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,a=_(e,i),o=0;o<i;++o)a[o].apply(n,r);}(a,c,this,o);}return !0},r.prototype.on=r.prototype.addListener=function(e,t){return f(this,e,t,!1)},r.prototype.prependListener=function(e,t){return f(this,e,t,!0)},r.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,h(this,e,t)),this},r.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,h(this,e,t)),this},r.prototype.removeListener=function(e,t){var n,r,i,a,o;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=u(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,a=n.length-1;0<=a;a--)if(n[a]===t||n[a].listener===t){o=n[a].listener,i=a;break}if(i<0)return this;0===i?n.shift():function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop();}(n,i),1===n.length&&(r[e]=n[0]),r.removeListener&&this.emit("removeListener",e,o||t);}return this},r.prototype.removeAllListeners=function(e){var t,n=this._events;if(!n)return this;if(!n.removeListener)return 0===arguments.length?(this._events=u(null),this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=u(null):delete n[e]),this;if(0===arguments.length){for(var r,i=o(n),a=0;a<i.length;++a)"removeListener"!==(r=i[a])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=u(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)for(a=t.length-1;0<=a;a--)this.removeListener(e,t[a]);return this},r.prototype.listeners=function(e){return p(this,e,!0)},r.prototype.rawListeners=function(e){return p(this,e,!1)},r.listenerCount=function(e,t){return "function"==typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},r.prototype.listenerCount=g,r.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]};},{}],12:[function(e,t,n){var h=Array.isArray,p=Object.keys,g=Object.prototype.hasOwnProperty;t.exports=function e(t,n){if(t===n)return !0;if(t&&n&&"object"==typeof t&&"object"==typeof n){var r,i,a=h(t),o=h(n);if(a&&o){if((f=t.length)!=n.length)return !1;for(r=f;0!=r--;)if(!e(t[r],n[r]))return !1;return !0}if(a!=o)return !1;var s=t instanceof Date,u=n instanceof Date;if(s!=u)return !1;if(s&&u)return t.getTime()==n.getTime();var l=t instanceof RegExp,d=n instanceof RegExp;if(l!=d)return !1;if(l&&d)return t.toString()==n.toString();var f,c=p(t);if((f=c.length)!==p(n).length)return !1;for(r=f;0!=r--;)if(!g.call(n,c[r]))return !1;for(r=f;0!=r--;)if(!e(t[i=c[r]],n[i]))return !1;return !0}return t!=t&&n!=n};},{}],13:[function(e,t,n){n.read=function(e,t,n,r,i){var a,o,s=8*i-r-1,u=(1<<s)-1,l=u>>1,d=-7,f=n?i-1:0,c=n?-1:1,h=e[t+f];for(f+=c,a=h&(1<<-d)-1,h>>=-d,d+=s;0<d;a=256*a+e[t+f],f+=c,d-=8);for(o=a&(1<<-d)-1,a>>=-d,d+=r;0<d;o=256*o+e[t+f],f+=c,d-=8);if(0===a)a=1-l;else {if(a===u)return o?NaN:1/0*(h?-1:1);o+=Math.pow(2,r),a-=l;}return (h?-1:1)*o*Math.pow(2,a-r)},n.write=function(e,t,n,r,i,a){var o,s,u,l=8*a-i-1,d=(1<<l)-1,f=d>>1,c=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:a-1,p=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=d):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),2<=(t+=1<=o+f?c/u:c*Math.pow(2,1-f))*u&&(o++,u/=2),d<=o+f?(s=0,o=d):1<=o+f?(s=(t*u-1)*Math.pow(2,i),o+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),o=0));8<=i;e[n+h]=255&s,h+=p,s/=256,i-=8);for(o=o<<i|s,l+=i;0<l;e[n+h]=255&o,h+=p,o/=256,l-=8);e[n+h-p]|=128*g;};},{}],14:[function(e,t,n){function d(e,t,n,r){var i=r&&"seq"===r.timeContainer,a=0;r&&(a=i&&n?n.end:r.begin),t.begin=t.explicit_begin?t.explicit_begin+a:a;var o=t.begin,s=null;for(var u in t.sets)d(e,t.sets[u],s,t),o="seq"===t.timeContainer?t.sets[u].end:Math.max(o,t.sets[u].end),s=t.sets[u];if("contents"in t)for(var l in t.contents)d(e,t.contents[l],s,t),o="seq"===t.timeContainer?t.contents[l].end:Math.max(o,t.contents[l].end),s=t.contents[l];else o=i?t.begin:Number.POSITIVE_INFINITY;null!==t.explicit_end&&null!==t.explicit_dur?t.end=Math.min(t.begin+t.explicit_dur,a+t.explicit_end):null===t.explicit_end&&null!==t.explicit_dur?t.end=t.begin+t.explicit_dur:null!==t.explicit_end&&null===t.explicit_dur?t.end=a+t.explicit_end:t.end=o,delete t.explicit_begin,delete t.explicit_dur,delete t.explicit_end,e._registerEvent(t);}function y(e){this.node=e;}function T(){this.events=[],this.head=null,this.body=null;}function S(){this.styling=null,this.layout=null;}function A(){this.styles={};}function I(){this.id=null,this.styleAttrs=null,this.styleRefs=null;}function R(){this.regions={};}function r(e){this.kind=e;}function i(e){this.id=e;}function a(e){this.regionID=e;}function o(e){this.styleAttrs=e;}function s(e){this.sets=e;}function u(e){this.contents=e;}function l(e,t,n){this.explicit_begin=e,this.explicit_end=t,this.explicit_dur=n;}function b(){r.call(this,"body");}function D(){r.call(this,"div");}function M(){r.call(this,"p");}function N(){r.call(this,"span");}function f(){r.call(this,"span");}function C(){r.call(this,"br");}function O(){}function w(){}function c(e){return e&&"xml:id"in e.attributes&&e.attributes["xml:id"].value||null}function h(e){return e&&"style"in e.attributes?e.attributes.style.value.split(" "):[]}function p(e,t){var n={};if(null!==e)for(var r in e.attributes){var i,a=e.attributes[r].uri+" "+e.attributes[r].local,o=B.byQName[a];void 0!==o&&(null!==(i=o.parse(e.attributes[r].value))?(n[a]=i,o===B.byName.zIndex&&m(t,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):L(t,"Cannot parse styling attribute "+a+" --\x3e "+e.attributes[r].value));}return n}function g(e,t,n){for(var r in e.attributes)if(e.attributes[r].uri===t&&e.attributes[r].local===n)return e.attributes[r].value;return null}function _(e,t,n){var r,i=null;return null!==(r=/^(\d+(?:\.\d+)?)f$/.exec(n))?null!==t&&(i=parseFloat(r[1])/t):null!==(r=/^(\d+(?:\.\d+)?)t$/.exec(n))?null!==e&&(i=parseFloat(r[1])/e):null!==(r=/^(\d+(?:\.\d+)?)ms$/.exec(n))?i=parseFloat(r[1])/1e3:null!==(r=/^(\d+(?:\.\d+)?)s$/.exec(n))?i=parseFloat(r[1]):null!==(r=/^(\d+(?:\.\d+)?)h$/.exec(n))?i=3600*parseFloat(r[1]):null!==(r=/^(\d+(?:\.\d+)?)m$/.exec(n))?i=60*parseFloat(r[1]):null!==(r=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/.exec(n))?i=3600*parseInt(r[1])+60*parseInt(r[2])+parseFloat(r[3]):null!==(r=/^(\d{2,}):(\d\d):(\d\d)\:(\d{2,})$/.exec(n))&&null!==t&&(i=3600*parseInt(r[1])+60*parseInt(r[2])+parseInt(r[3])+(null===r[4]?0:parseInt(r[4])/t)),i}function E(e,t,n,r){for(var i=t.length-1;0<=i;i--){var a=t[i];a in e.styles?P(e.styles[a].styleAttrs,n):L(r,"Non-existant style id referenced");}}function P(e,t){for(var n in e)n in t||(t[n]=e[n]);}function m(e,t){if(e&&e.warn&&e.warn(t))throw t}function L(e,t){if(e&&e.error&&e.error(t))throw t}function x(e,t){throw e&&e.fatal&&e.fatal(t),t}function v(e,t){for(var n,r=0,i=e.length-1;r<=i;){var a=e[n=Math.floor((r+i)/2)];if(a<t)r=n+1;else {if(!(t<a))return {found:!0,index:n};i=n-1;}}return {found:!1,index:r}}var F,U,k,B,G;F=void 0===n?this.imscDoc={}:n,U="undefined"==typeof sax?e(40):sax,k="undefined"==typeof imscNames?e(18):imscNames,B="undefined"==typeof imscStyles?e(19):imscStyles,G="undefined"==typeof imscUtils?e(20):imscUtils,F.fromXML=function(e,h,p){var t=U.parser(!0,{xmlns:!0}),g=[],_=[],E=[],m=0,v=null;t.onclosetag=function(e){if(g[0]instanceof A)for(var t in g[0].styles)!function e(t,n,r){for(;0<n.styleRefs.length;){var i=n.styleRefs.pop();i in t.styles?(e(t,t.styles[i],r),P(t.styles[i].styleAttrs,n.styleAttrs)):L(r,"Non-existant style id referenced");}}(g[0],g[0].styles[t],h);else if(g[0]instanceof M||g[0]instanceof N){if(1<g[0].contents.length){for(var n=[g[0].contents[0]],r=1;r<g[0].contents.length;r++)g[0].contents[r]instanceof f&&n[n.length-1]instanceof f?n[n.length-1].text+=g[0].contents[r].text:n.push(g[0].contents[r]);g[0].contents=n;}g[0]instanceof N&&1===g[0].contents.length&&g[0].contents[0]instanceof f&&(g[0].text=g[0].contents[0].text,delete g[0].contents);}else g[0]instanceof y&&(g[0].node.uri===k.ns_tt&&"metadata"===g[0].node.local?m--:0<m&&p&&"onCloseTag"in p&&p.onCloseTag());E.shift(),_.shift(),g.shift();},t.ontext=function(e){var t;void 0===g[0]||(g[0]instanceof N||g[0]instanceof M?((t=new f).initFromText(v,g[0],e,E[0],h),g[0].contents.push(t)):g[0]instanceof y&&0<m&&p&&"onText"in p&&p.onText(e));},t.onopentag=function(e){var t=e.attributes["xml:space"];t?E.unshift(t.value):0===E.length?E.unshift("default"):E.unshift(E[0]);var n,r,i,a,o,s,u,l,d=e.attributes["xml:lang"];if(d?_.unshift(d.value):0===_.length?_.unshift(""):_.unshift(_[0]),e.uri===k.ns_tt?"tt"===e.local?(null!==v&&x(h,"Two <tt> elements at ("+this.line+","+this.column+")"),(v=new T).initFromNode(e,h),g.unshift(v)):"head"===e.local?(g[0]instanceof T||x(h,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),null!==v.head&&x("Second <head> element at ("+this.line+","+this.column+")"),v.head=new S,g.unshift(v.head)):"styling"===e.local?(g[0]instanceof S||x(h,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),null!==v.head.styling&&x("Second <styling> element at ("+this.line+","+this.column+")"),v.head.styling=new A,g.unshift(v.head.styling)):"style"===e.local?g[0]instanceof A?((n=new I).initFromNode(e,h),n.id?v.head.styling.styles[n.id]=n:L(h,"<style> element missing @id attribute"),g.unshift(n)):g[0]instanceof O?((n=new I).initFromNode(e,h),P(n.styleAttrs,g[0].styleAttrs),g.unshift(n)):x(h,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")"):"layout"===e.local?(g[0]instanceof S||x(h,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),null!==v.head.layout&&x(h,"Second <layout> element at "+this.line+","+this.column+")"),v.head.layout=new R,g.unshift(v.head.layout)):"region"===e.local?(g[0]instanceof R||x(h,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")"),(r=new O).initFromNode(v,e,h),!r.id||r.id in v.head.layout.regions?L(h,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):v.head.layout.regions[r.id]=r,g.unshift(r)):"body"===e.local?(g[0]instanceof T||x(h,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),null!==v.body&&x(h,"Second <body> element at "+this.line+","+this.column+")"),(i=new b).initFromNode(v,e,h),v.body=i,g.unshift(i)):"div"===e.local?(g[0]instanceof D||g[0]instanceof b||x(h,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")"),(a=new D).initFromNode(v,g[0],e,h),g[0].contents.push(a),g.unshift(a)):"p"===e.local?(g[0]instanceof D||x(h,"Parent of <p> element is not <div> at "+this.line+","+this.column+")"),(o=new M).initFromNode(v,g[0],e,h),g[0].contents.push(o),g.unshift(o)):"span"===e.local?(g[0]instanceof N||g[0]instanceof M||x(h,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")"),(s=new N).initFromNode(v,g[0],e,E[0],h),g[0].contents.push(s),g.unshift(s)):"br"===e.local?(g[0]instanceof N||g[0]instanceof M||x(h,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")"),(u=new C).initFromNode(v,g[0],e,h),g[0].contents.push(u),g.unshift(u)):"set"===e.local?(g[0]instanceof N||g[0]instanceof M||g[0]instanceof D||g[0]instanceof b||g[0]instanceof O||g[0]instanceof C||x(h,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")"),(l=new w).initFromNode(v,g[0],e,h),g[0].sets.push(l),g.unshift(l)):g.unshift(new y(e)):g.unshift(new y(e)),g[0]instanceof y)if(e.uri===k.ns_tt&&"metadata"===e.local)m++;else if(0<m&&p&&"onOpenTag"in p){var f=[];for(var c in e.attributes)f[e.attributes[c].uri+" "+e.attributes[c].local]={uri:e.attributes[c].uri,local:e.attributes[c].local,value:e.attributes[c].value};p.onOpenTag(e.uri,e.local,f);}},t.write(e).close(),null!==v.head?delete v.head.styling:v.head=new S,null===v.head.layout&&(v.head.layout=new R);var n,r=!1;for(var i in v.head.layout.regions){r=!0;break}for(var a in r||(n=O.prototype.createDefaultRegion(),v.head.layout.regions[n.id]=n),v.head.layout.regions)d(v,v.head.layout.regions[a],null,null);return v.body&&d(v,v.body,null,null),v},T.prototype.initFromNode=function(e,t){this.cellResolution=function(e,t){var n=g(e,k.ns_ttp,"cellResolution"),r=15,i=32;{var a;null!==n&&(null!==(a=/(\d+) (\d+)/.exec(n))?(i=parseInt(a[1]),r=parseInt(a[2])):m(t,"Malformed cellResolution value (using initial value instead)"));}return {w:i,h:r}}(e,t);var n=function(e,t){var n,r=g(e,k.ns_ttp,"frameRate"),i=30;{null!==r&&(null!==(n=/(\d+)/.exec(r))?i=parseInt(n[1]):m(t,"Malformed frame rate attribute (using initial value instead)"));}var a=g(e,k.ns_ttp,"frameRateMultiplier"),o=1;{null!==a&&(null!==(n=/(\d+) (\d+)/.exec(a))?o=parseInt(n[1])/parseInt(n[2]):m(t,"Malformed frame rate multiplier attribute (using initial value instead)"));}var s=o*i,u=1,l=g(e,k.ns_ttp,"tickRate");{null===l?null!==r&&(u=s):null!==(n=/(\d+)/.exec(l))?u=parseInt(n[1]):m(t,"Malformed tick rate attribute (using initial value instead)");}return {effectiveFrameRate:s,tickRate:u}}(e,t);this.effectiveFrameRate=n.effectiveFrameRate,this.tickRate=n.tickRate,this.aspectRatio=function(e,t){var n=g(e,k.ns_ittp,"aspectRatio"),r=null;{var i,a,o;null!==n&&(null!==(i=/(\d+) (\d+)/.exec(n))?(a=parseInt(i[1]),o=parseInt(i[2]),0!==a&&0!==o?r=a/o:L(t,"Illegal aspectRatio values (ignoring)")):L(t,"Malformed aspectRatio attribute (ignoring)"));}return r}(e,t);var r=g(e,k.ns_ttp,"timeBase");null!==r&&"media"!==r&&x(t,"Unsupported time base");var i=function(e,t){var n=g(e,k.ns_tts,"extent");if(null===n)return null;var r=n.split(" ");if(2!==r.length)return m(t,"Malformed extent (ignoring)"),null;var i=G.parseLength(r[0]),a=G.parseLength(r[1]);return a&&i?{h:a,w:i}:(m(t,"Malformed extent values (ignoring)"),null)}(e,t);null===i?this.pxDimensions={h:480,w:640}:("px"===i.h.unit&&"px"===i.w.unit||x(t,"Extent on TT must be in px or absent"),this.pxDimensions={h:i.h.value,w:i.w.value});},T.prototype._registerEvent=function(e){var t,n;e.end<=e.begin||((t=v(this.events,e.begin)).found||this.events.splice(t.index,0,e.begin),e.end!==Number.POSITIVE_INFINITY&&((n=v(this.events,e.end)).found||this.events.splice(n.index,0,e.end)));},T.prototype.getMediaTimeRange=function(){return [this.events[0],this.events[this.events.length-1]]},T.prototype.getMediaTimeEvents=function(){return this.events},I.prototype.initFromNode=function(e,t){this.id=c(e),this.styleAttrs=p(e,t),this.styleRefs=h(e);},i.prototype.initFromNode=function(e,t,n,r){this.id=c(n);},a.prototype.initFromNode=function(e,t,n,r){var i;this.regionID=(i=n)&&"region"in i.attributes?i.attributes.region.value:"";},o.prototype.initFromNode=function(e,t,n,r){this.styleAttrs=p(n,r),null!==e.head&&null!==e.head.styling&&E(e.head.styling,h(n),this.styleAttrs,r);},s.prototype.initFromNode=function(e,t,n,r){this.sets=[];},u.prototype.initFromNode=function(e,t,n,r){this.contents=[];},l.prototype.initFromNode=function(e,t,n,r){var i,a,o,s=function(e,t,n){var r=null;t&&"begin"in t.attributes&&null===(r=_(e.tickRate,e.effectiveFrameRate,t.attributes.begin.value))&&m(n,"Malformed begin value "+t.attributes.begin.value+" (using 0)");var i=null;t&&"dur"in t.attributes&&null===(i=_(e.tickRate,e.effectiveFrameRate,t.attributes.dur.value))&&m(n,"Malformed dur value "+t.attributes.dur.value+" (ignoring)");var a=null;t&&"end"in t.attributes&&null===(a=_(e.tickRate,e.effectiveFrameRate,t.attributes.end.value))&&m(n,"Malformed end value (ignoring)");return {explicit_begin:r,explicit_end:a,explicit_dur:i}}(e,n,r);this.explicit_begin=s.explicit_begin,this.explicit_end=s.explicit_end,this.explicit_dur=s.explicit_dur,this.timeContainer=(a=r,(o=(i=n)&&"timeContainer"in i.attributes?i.attributes.timeContainer.value:null)&&"par"!==o?"seq"===o?"seq":(L(a,"Illegal value of timeContainer (assuming 'par')"),"par"):"par");},b.prototype.initFromNode=function(e,t,n){o.prototype.initFromNode.call(this,e,null,t,n),l.prototype.initFromNode.call(this,e,null,t,n),s.prototype.initFromNode.call(this,e,null,t,n),a.prototype.initFromNode.call(this,e,null,t,n),u.prototype.initFromNode.call(this,e,null,t,n);},D.prototype.initFromNode=function(e,t,n,r){o.prototype.initFromNode.call(this,e,t,n,r),l.prototype.initFromNode.call(this,e,t,n,r),s.prototype.initFromNode.call(this,e,t,n,r),a.prototype.initFromNode.call(this,e,t,n,r),u.prototype.initFromNode.call(this,e,t,n,r);},M.prototype.initFromNode=function(e,t,n,r){o.prototype.initFromNode.call(this,e,t,n,r),l.prototype.initFromNode.call(this,e,t,n,r),s.prototype.initFromNode.call(this,e,t,n,r),a.prototype.initFromNode.call(this,e,t,n,r),u.prototype.initFromNode.call(this,e,t,n,r);},N.prototype.initFromNode=function(e,t,n,r,i){o.prototype.initFromNode.call(this,e,t,n,i),l.prototype.initFromNode.call(this,e,t,n,i),s.prototype.initFromNode.call(this,e,t,n,i),a.prototype.initFromNode.call(this,e,t,n,i),u.prototype.initFromNode.call(this,e,t,n,i),this.space=r;},f.prototype.initFromText=function(e,t,n,r,i){l.prototype.initFromNode.call(this,e,t,null,i),this.text=n,this.space=r;},C.prototype.initFromNode=function(e,t,n,r){a.prototype.initFromNode.call(this,e,t,n,r),l.prototype.initFromNode.call(this,e,t,n,r);},O.prototype.createDefaultRegion=function(){var e=new O;return i.call(e,""),o.call(e,{}),s.call(e,[]),l.call(e,0,Number.POSITIVE_INFINITY,null),e},O.prototype.initFromNode=function(e,t,n){i.prototype.initFromNode.call(this,e,null,t,n),o.prototype.initFromNode.call(this,e,null,t,n),l.prototype.initFromNode.call(this,e,null,t,n),s.prototype.initFromNode.call(this,e,null,t,n),null!==e.head&&null!==e.head.styling&&E(e.head.styling,h(t),this.styleAttrs,n);},w.prototype.initFromNode=function(e,t,n,r){l.prototype.initFromNode.call(this,e,t,n,r);var i=p(n,r);for(var a in this.qname=null,this.value=null,i){if(this.qname){L(r,"More than one style specified on set");break}this.qname=a,this.value=i[a];}};},{18:18,19:19,20:20,40:40}],15:[function(e,t,n){!function(e,R){function b(e,t,n){for(var r in e){var i=e[r].elements.length,a=e[r].elements[e[r].start_elem],o=e[r].elements[e[r].end_elem],s=Math.ceil(t)+"px",u="-"+Math.ceil(t)+"px";0!==i&&("lr"===n.ipd?(a.node.style.borderLeftColor=a.bgcolor||"#00000000",a.node.style.borderLeftStyle="solid",a.node.style.borderLeftWidth=s,a.node.style.marginLeft=u):"rl"===n.ipd?(a.node.style.borderRightColor=a.bgcolor||"#00000000",a.node.style.borderRightStyle="solid",a.node.style.borderRightWidth=s,a.node.style.marginRight=u):"tb"===n.ipd&&(a.node.style.borderTopColor=a.bgcolor||"#00000000",a.node.style.borderTopStyle="solid",a.node.style.borderTopWidth=s,a.node.style.marginTop=u),"lr"===n.ipd?(o.node.style.borderRightColor=o.bgcolor||"#00000000",o.node.style.borderRightStyle="solid",o.node.style.borderRightWidth=s,o.node.style.marginRight=u):"rl"===n.ipd?(o.node.style.borderLeftColor=o.bgcolor||"#00000000",o.node.style.borderLeftStyle="solid",o.node.style.borderLeftWidth=s,o.node.style.marginLeft=u):"tb"===n.ipd&&(o.node.style.borderBottomColor=o.bgcolor||"#00000000",o.node.style.borderBottomStyle="solid",o.node.style.borderBottomWidth=s,o.node.style.marginBottom=u));}}function D(e){for(var t=0;t<e.length-1;t++){var n,r,i=e[t].elements.length;0!==i&&!1===e[t].br&&(n=document.createElement("br"),(r=e[t].elements[i-1].node).parentElement.insertBefore(n,r.nextSibling));}}function M(e,t,n,r){for(var i=Math.sign(n-t),a=0;a<=e.length;a++){var o,s,u=0===a?t:a===e.length?n:(e[a].before+e[a-1].after)/2;if(0<a)for(var l=0;l<e[a-1].elements.length;l++)null!==e[a-1].elements[l].bgcolor&&i*((s=e[a-1].elements[l]).after-u)<0&&(o=Math.ceil(Math.abs(u-s.after))+"px",s.node.style.backgroundColor=s.bgcolor,"lr"===r.bpd?s.node.style.paddingRight=o:"rl"===r.bpd?s.node.style.paddingLeft=o:"tb"===r.bpd&&(s.node.style.paddingBottom=o));if(a<e.length)for(var d=0;d<e[a].elements.length;d++)null!==(s=e[a].elements[d]).bgcolor&&0<i*(s.before-u)&&(o=Math.ceil(Math.abs(s.before-u))+"px",s.node.style.backgroundColor=s.bgcolor,"lr"===r.bpd?s.node.style.paddingLeft=o:"rl"===r.bpd?s.node.style.paddingRight=o:"tb"===r.bpd&&(s.node.style.paddingTop=o));}}function N(e,t){this.id=e,this.plist=t;}function C(e,t){var n={before:null,after:null,start:null,end:null};return "tb"===t.bpd?(n.before=e.top,n.after=e.bottom,"lr"===t.ipd?(n.start=e.left,n.end=e.right):(n.start=e.right,n.end=e.left)):"lr"===t.bpd?(n.before=e.left,n.after=e.right,n.start=e.top,n.end=e.bottom):"rl"===t.bpd&&(n.before=e.right,n.after=e.left,n.start=e.top,n.end=e.bottom),n}function O(e,t,n,r){var i,a,o,s,u=t.style.backgroundColor||r;if(0===t.childElementCount)if("span"===t.localName){var l=t.getBoundingClientRect();if(0===l.height||0===l.width)return;var d,f,c=C(l,e);0!==n.length&&(i=c.before,a=c.after,o=n[n.length-1].before,s=n[n.length-1].after,a<s&&o<i||s<=a&&i<=o)?(d=Math.sign(c.after-c.before),f=Math.sign(c.end-c.start),d*(c.before-n[n.length-1].before)<0&&(n[n.length-1].before=c.before),0<d*(c.after-n[n.length-1].after)&&(n[n.length-1].after=c.after),f*(c.start-n[n.length-1].start)<0&&(n[n.length-1].start=c.start,n[n.length-1].start_elem=n[n.length-1].elements.length),0<f*(c.end-n[n.length-1].end)&&(n[n.length-1].end=c.end,n[n.length-1].end_elem=n[n.length-1].elements.length)):n.push({before:c.before,after:c.after,start:c.start,end:c.end,start_elem:0,end_elem:0,elements:[],text:"",br:!1}),n[n.length-1].text+=t.textContent,n[n.length-1].elements.push({node:t,bgcolor:u,before:c.before,after:c.after});}else "br"===t.localName&&0!==n.length&&(n[n.length-1].br=!0);else for(var h=t.firstChild;h;)h.nodeType===Node.ELEMENT_NODE&&O(e,h,n,u),h=h.nextSibling;}function t(e,t){this.qname=e,this.map=t;}e.render=function(e,t,n,r,i,a,o,s,u){var l,d=r||t.clientHeight,f=i||t.clientWidth;null!==e.aspectRatio&&(f<(l=d*e.aspectRatio)?d=Math.round(f/e.aspectRatio):f=l);var c=document.createElement("div");c.style.position="relative",c.style.width=f+"px",c.style.height=d+"px",c.style.margin="auto",c.style.top=0,c.style.bottom=0,c.style.left=0,c.style.right=0,c.style.zIndex=0;var h={h:d,w:f,regionH:null,regionW:null,imgResolver:n,displayForcedOnlyMode:a||!1,isd:e,errorHandler:o,previousISDState:s,enableRollUp:u||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null};for(var p in t.appendChild(c),e.contents)!function e(t,n,r){var i;"region"===r.kind?(i=document.createElement("div")).style.position="absolute":"body"===r.kind||"div"===r.kind?i=document.createElement("div"):"p"===r.kind?i=document.createElement("p"):"span"===r.kind?i=document.createElement("span"):"br"===r.kind&&(i=document.createElement("br"));if(!i)return void P(t.errorHandler,"Error processing ISD element kind: "+r.kind);i.style.margin="0";for(var a in w){var o=w[a],s=r.styleAttrs[o.qname];void 0!==s&&null!==o.map&&o.map(t,i,r,s);}var u=i;{var l;"region"===r.kind&&("lrtb"===(l=r.styleAttrs[R.byName.writingMode.qname])||"lr"===l?(t.ipd="lr",t.bpd="tb"):"rltb"===l||"rl"===l?(t.ipd="rl",t.bpd="tb"):"tblr"===l?(t.ipd="tb",t.bpd="lr"):"tbrl"!==l&&"tb"!==l||(t.ipd="tb",t.bpd="rl"));}var d=r.styleAttrs[R.byName.linePadding.qname];{var f;d&&0<d&&(f=Math.ceil(d*t.h)+"px","tb"===t.bpd?(u.style.paddingLeft=f,u.style.paddingRight=f):(u.style.paddingTop=f,u.style.paddingBottom=f),t.lp=d);}var c=r.styleAttrs[R.byName.multiRowAlign.qname];{var h;c&&"auto"!==c&&((h=document.createElement("span")).style.display="inline-block",h.style.textAlign=c,i.appendChild(h),u=h,t.mra=c);}r.styleAttrs[R.byName.fillLineGap.qname]&&(t.flg=!0);if("span"===r.kind&&r.text)if(t.lp||t.mra||t.flg)for(var p="",g=0;g<r.text.length;g++){p+=r.text.charAt(g);var _,E=r.text.charCodeAt(g);(E<55296||56319<E||g===r.text.length)&&((_=document.createElement("span")).textContent=p,i.appendChild(_),p="");}else i.textContent=r.text;n.appendChild(i);for(var m in r.contents)e(t,u,r.contents[m]);var v=[];{var y;(t.lp||t.mra||t.flg)&&"p"===r.kind&&(O(t,u,v,null),t.mra&&(D(v),t.mra=null),t.lp&&(b(v,t.lp*t.h,t),t.lp=null),t.flg&&(y=C(u.getBoundingClientRect(),t),M(v,y.before,y.after,t),t.flg=null));}{var T,S,A,I;"region"===r.kind&&(O(t,u,v),"tb"===t.bpd&&t.enableRollUp&&0<r.contents.length&&"after"===r.styleAttrs[R.byName.displayAlign.qname]&&(T=""===r.id?"_":r.id,S=new N(T,v),t.currentISDState[S.id]=S,t.previousISDState&&S.id in t.previousISDState&&0<t.previousISDState[S.id].plist.length&&1<S.plist.length&&S.plist[S.plist.length-2].text===t.previousISDState[S.id].plist[t.previousISDState[S.id].plist.length-1].text&&(A=i.firstElementChild,I=S.plist[S.plist.length-1].after-S.plist[S.plist.length-1].before,A.style.bottom="-"+I+"px",A.style.transition="transform 0.4s",A.style.position="relative",A.style.transform="translateY(-"+I+"px)")));}}(h,c,e.contents[p]);return h.currentISDState};var w=[new t("http://www.w3.org/ns/ttml#styling backgroundColor",function(e,t,n,r){0!==r[3]&&(t.style.backgroundColor="rgba("+r[0].toString()+","+r[1].toString()+","+r[2].toString()+","+(r[3]/255).toString()+")");}),new t("http://www.w3.org/ns/ttml#styling color",function(e,t,n,r){t.style.color="rgba("+r[0].toString()+","+r[1].toString()+","+r[2].toString()+","+(r[3]/255).toString()+")";}),new t("http://www.w3.org/ns/ttml#styling direction",function(e,t,n,r){t.style.direction=r;}),new t("http://www.w3.org/ns/ttml#styling display",function(e,t,n,r){}),new t("http://www.w3.org/ns/ttml#styling displayAlign",function(e,t,n,r){t.style.display="flex",t.style.flexDirection="column","before"===r?t.style.justifyContent="flex-start":"center"===r?t.style.justifyContent="center":"after"===r&&(t.style.justifyContent="flex-end");}),new t("http://www.w3.org/ns/ttml#styling extent",function(e,t,n,r){e.regionH=r.h*e.h,e.regionW=r.w*e.w;var i=0,a=0,o=n.styleAttrs["http://www.w3.org/ns/ttml#styling padding"];o&&(i=(o[0]+o[2])*e.h,a=(o[1]+o[3])*e.w),t.style.height=e.regionH-i+"px",t.style.width=e.regionW-a+"px";}),new t("http://www.w3.org/ns/ttml#styling fontFamily",function(e,t,n,r){var i=[];for(var a in r)"monospaceSerif"===r[a]?(i.push("Courier New"),i.push('"Liberation Mono"'),i.push("Courier"),i.push("monospace")):"proportionalSansSerif"===r[a]?(i.push("Arial"),i.push("Helvetica"),i.push('"Liberation Sans"'),i.push("sans-serif")):"monospace"===r[a]?i.push("monospace"):"sansSerif"===r[a]?i.push("sans-serif"):"serif"===r[a]?i.push("serif"):"monospaceSansSerif"===r[a]?(i.push("Consolas"),i.push("monospace")):"proportionalSerif"===r[a]?i.push("serif"):i.push(r[a]);t.style.fontFamily=i.join(",");}),new t("http://www.w3.org/ns/ttml#styling fontSize",function(e,t,n,r){t.style.fontSize=r*e.h+"px";}),new t("http://www.w3.org/ns/ttml#styling fontStyle",function(e,t,n,r){t.style.fontStyle=r;}),new t("http://www.w3.org/ns/ttml#styling fontWeight",function(e,t,n,r){t.style.fontWeight=r;}),new t("http://www.w3.org/ns/ttml#styling lineHeight",function(e,t,n,r){t.style.lineHeight="normal"===r?"normal":r*e.h+"px";}),new t("http://www.w3.org/ns/ttml#styling opacity",function(e,t,n,r){t.style.opacity=r;}),new t("http://www.w3.org/ns/ttml#styling origin",function(e,t,n,r){t.style.top=r.h*e.h+"px",t.style.left=r.w*e.w+"px";}),new t("http://www.w3.org/ns/ttml#styling overflow",function(e,t,n,r){t.style.overflow=r;}),new t("http://www.w3.org/ns/ttml#styling padding",function(e,t,n,r){var i=[];i[0]=r[0]*e.h+"px",i[1]=r[3]*e.w+"px",i[2]=r[2]*e.h+"px",i[3]=r[1]*e.w+"px",t.style.padding=i.join(" ");}),new t("http://www.w3.org/ns/ttml#styling showBackground",null),new t("http://www.w3.org/ns/ttml#styling textAlign",function(e,t,n,r){var i=n.styleAttrs[R.byName.direction.qname],a="start"===r?"rtl"===i?"right":"left":"end"===r?"rtl"===i?"left":"right":r;t.style.textAlign=a;}),new t("http://www.w3.org/ns/ttml#styling textDecoration",function(e,t,n,r){t.style.textDecoration=r.join(" ").replace("lineThrough","line-through");}),new t("http://www.w3.org/ns/ttml#styling textOutline",function(e,t,n,r){t.style.textShadow="none"===r?"":"rgba("+r.color[0].toString()+","+r.color[1].toString()+","+r.color[2].toString()+","+(r.color[3]/255).toString()+") 0px 0px "+r.thickness*e.h+"px";}),new t("http://www.w3.org/ns/ttml#styling unicodeBidi",function(e,t,n,r){var i="bidiOverride"===r?"bidi-override":r;t.style.unicodeBidi=i;}),new t("http://www.w3.org/ns/ttml#styling visibility",function(e,t,n,r){t.style.visibility=r;}),new t("http://www.w3.org/ns/ttml#styling wrapOption",function(e,t,n,r){"wrap"===r?"preserve"===n.space?t.style.whiteSpace="pre-wrap":t.style.whiteSpace="normal":"preserve"===n.space?t.style.whiteSpace="pre":t.style.whiteSpace="noWrap";}),new t("http://www.w3.org/ns/ttml#styling writingMode",function(e,t,n,r){"lrtb"===r||"lr"===r||"rltb"===r||"rl"===r?t.style.writingMode="horizontal-tb":"tblr"===r?t.style.writingMode="vertical-lr":"tbrl"!==r&&"tb"!==r||(t.style.writingMode="vertical-rl");}),new t("http://www.w3.org/ns/ttml#styling zIndex",function(e,t,n,r){t.style.zIndex=r;}),new t("http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt backgroundImage",function(e,t,n,r){var i,a;null!==e.imgResolver&&null!==r&&(i=document.createElement("img"),(a=e.imgResolver(r,i))&&(i.src=a),i.height=e.regionH,i.width=e.regionW,t.appendChild(i));}),new t("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",function(e,t,n,r){e.displayForcedOnlyMode&&!1===r&&(t.style.visibility="hidden");})],n={};for(var r in w)n[w[r].qname]=w[r];function P(e,t){if(e&&e.error&&e.error(t))throw t}}(void 0===n?this.imscHTML={}:n,("undefined"==typeof imscNames&&e(18),"undefined"==typeof imscStyles?e(19):imscStyles));},{18:18,19:19}],16:[function(e,t,n){function F(e,t){if("contents"in e)for(var n in e.contents)F(e.contents[n],t);else t.push(e);}function U(e){if("br"!==e.kind){if("text"in e)return 0===e.text.length;if("contents"in e){for(var t=e.contents.length;t--;)U(e.contents[t])&&e.contents.splice(t,1);return 0===e.contents.length}}}function s(e){this.contents=[],this.aspectRatio=e.aspectRatio;}function k(e){for(var t in this.kind=e.kind||"region",e.id&&(this.id=e.id),this.styleAttrs={},e.styleAttrs)this.styleAttrs[t]=e.styleAttrs[t];"text"in e?this.text=e.text:"br"!==e.kind&&(this.contents=[]),"space"in e&&(this.space=e.space);}function B(e,t){if(e&&e.error&&e.error(t))throw t}var r,G;r=void 0===n?this.imscISD={}:n,"undefined"==typeof imscNames&&e(18),G="undefined"==typeof imscStyles?e(19):imscStyles,r.generateISD=function(e,t,n){var r=new s(e),i={};for(var a in e.head.layout.regions){var o=function e(t,n,r,i,a,o,s,u,l){if(n<s.begin||n>=s.end)return null;var d="regionID"in s&&""!==s.regionID?s.regionID:o;if(null!==a&&d!==r.id&&(!("contents"in s)||"contents"in s&&0===s.contents.length||""!==d))return null;var f=new k(s);for(var c in s.sets)n<s.sets[c].begin||n>=s.sets[c].end||(f.styleAttrs[s.sets[c].qname]=s.sets[c].value);var h={};for(var p in f.styleAttrs){var g;h[p]=!0,p!==G.byName.writingMode.qname||G.byName.direction.qname in f.styleAttrs||("lrtb"===(g=f.styleAttrs[p])||"lr"===g?f.styleAttrs[G.byName.direction.qname]="ltr":"rltb"!==g&&"rl"!==g||(f.styleAttrs[G.byName.direction.qname]="rtl"));}if(null!==a)for(var _ in G.all){var E,m,v,y=G.all[_];y.qname===G.byName.textDecoration.qname?(E=a.styleAttrs[y.qname],m=f.styleAttrs[y.qname],v=[],void 0===m?v=E:-1===m.indexOf("none")?((-1===m.indexOf("noUnderline")&&-1!==E.indexOf("underline")||-1!==m.indexOf("underline"))&&v.push("underline"),(-1===m.indexOf("noLineThrough")&&-1!==E.indexOf("lineThrough")||-1!==m.indexOf("lineThrough"))&&v.push("lineThrough"),(-1===m.indexOf("noOverline")&&-1!==E.indexOf("overline")||-1!==m.indexOf("overline"))&&v.push("overline")):v.push("none"),f.styleAttrs[y.qname]=v):y.inherit&&y.qname in a.styleAttrs&&!(y.qname in f.styleAttrs)&&(f.styleAttrs[y.qname]=a.styleAttrs[y.qname]);}for(var T in G.all){var S=G.all[T];S.qname in f.styleAttrs||("region"===f.kind||!1===S.inherit&&null!==S.initial)&&(f.styleAttrs[S.qname]=S.parse(S.initial),h[S.qname]=!0);}for(var A in G.all){var I,R=G.all[A];R.qname in h&&null!==R.compute&&(null!==(I=R.compute(t,a,f,f.styleAttrs[R.qname],l))?f.styleAttrs[R.qname]=I:B(u,"Style '"+R.qname+"' on element '"+f.kind+"' cannot be computed"));}if("none"===f.styleAttrs[G.byName.display.qname])return null;var b;null===a?b=null===i?[]:[i]:"contents"in s&&(b=s.contents);for(var D in b){var M=e(t,n,r,i,f,d,b[D],u,l);null!==M&&f.contents.push(M.element);}for(var N in f.styleAttrs){var C=G.byQName[N];-1===C.applies.indexOf(f.kind)&&delete f.styleAttrs[N];}{var O;"span"===f.kind&&f.text&&"default"===f.space&&(O=f.text.replace(/\s+/g," "),f.text=O);}if("p"===f.kind){var w=[];F(f,w);for(var P=0,L="after_br",x=0;;)if("after_br"===L)P>=w.length||"br"===w[P].kind?(L="before_br",x=P,P--):("preserve"!==w[P].space&&(w[P].text=w[P].text.replace(/^\s+/g,"")),0<w[P].text.length?(L="looking_br",P++):w.splice(P,1));else if("before_br"===L)if(P<0||"br"===w[P].kind){if(L="after_br",(P=x+1)>=w.length)break}else if("preserve"!==w[P].space&&(w[P].text=w[P].text.replace(/\s+$/g,"")),0<w[P].text.length){if(L="after_br",(P=x+1)>=w.length)break}else w.splice(P,1),P--;else P>=w.length||"br"===w[P].kind?(L="before_br",x=P,P--):P++;U(f);}if("div"===f.kind&&G.byName.backgroundImage.qname in f.styleAttrs||"br"===f.kind||"contents"in f&&0<f.contents.length||"span"===f.kind&&null!==f.text||"region"===f.kind&&"always"===f.styleAttrs[G.byName.showBackground.qname])return {region_id:d,element:f};return null}(e,t,e.head.layout.regions[a],e.body,null,"",e.head.layout.regions[a],n,i);null!==o&&r.contents.push(o.element);}return r};},{18:18,19:19}],17:[function(e,t,n){n.generateISD=e(16).generateISD,n.fromXML=e(14).fromXML,n.renderHTML=e(15).render;},{14:14,15:15,16:16}],18:[function(e,t,n){var r;(r=void 0===n?this.imscNames={}:n).ns_tt="http://www.w3.org/ns/ttml",r.ns_tts="http://www.w3.org/ns/ttml#styling",r.ns_ttp="http://www.w3.org/ns/ttml#parameter",r.ns_xml="http://www.w3.org/XML/1998/namespace",r.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling",r.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter",r.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",r.ns_ebutts="urn:ebu:tt:style";},{}],19:[function(e,t,n){!function(l,e,a){function t(e,t,n,r,i,a,o,s){this.name=t,this.ns=e,this.qname=e+" "+t,this.inherit=i,this.animatable=a,this.initial=n,this.applies=r,this.parse=o,this.compute=s;}for(var n in l.all=[new t(e.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,a.parseColor,null),new t(e.ns_tts,"color","white",["span"],!0,!0,a.parseColor,null),new t(e.ns_tts,"direction","ltr",["p","span"],!0,!0,function(e){return e},null),new t(e.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,function(e){return e},null),new t(e.ns_tts,"displayAlign","before",["region"],!1,!0,function(e){return e},null),new t(e.ns_tts,"extent","auto",["tt","region"],!1,!0,function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var n=a.parseLength(t[0]),r=a.parseLength(t[1]);return r&&n?{h:r,w:n}:null},function(e,t,n,r,i){var a,o;if("auto"===r)a=1;else if("%"===r.h.unit)a=r.h.value/100;else {if("px"!==r.h.unit)return null;a=r.h.value/e.pxDimensions.h;}if("auto"===r)o=1;else if("%"===r.w.unit)o=r.w.value/100;else {if("px"!==r.w.unit)return null;o=r.w.value/e.pxDimensions.w;}return {h:a,w:o}}),new t(e.ns_tts,"fontFamily","default",["span"],!0,!0,function(e){var t=e.split(","),n=[];for(var r in t)"'"!==t[r].charAt(0)&&'"'!==t[r].charAt(0)&&"default"===t[r]?n.push("monospaceSerif"):n.push(t[r]);return n},null),new t(e.ns_tts,"fontSize","1c",["span"],!0,!0,a.parseLength,function(e,t,n,r,i){var a;if("%"===r.unit)a=null!==t?t.styleAttrs[l.byName.fontSize.qname]*r.value/100:r.value/100/e.cellResolution.h;else if("em"===r.unit)a=null!==t?t.styleAttrs[l.byName.fontSize.qname]*r.value:r.value/e.cellResolution.h;else if("c"===r.unit)a=r.value/e.cellResolution.h;else {if("px"!==r.unit)return null;a=r.value/e.pxDimensions.h;}return a}),new t(e.ns_tts,"fontStyle","normal",["span"],!0,!0,function(e){return e},null),new t(e.ns_tts,"fontWeight","normal",["span"],!0,!0,function(e){return e},null),new t(e.ns_tts,"lineHeight","normal",["p"],!0,!0,function(e){return "normal"===e?e:a.parseLength(e)},function(e,t,n,r,i){var a;if("normal"===r)a=r;else if("%"===r.unit)a=n.styleAttrs[l.byName.fontSize.qname]*r.value/100;else if("em"===r.unit)a=n.styleAttrs[l.byName.fontSize.qname]*r.value;else if("c"===r.unit)a=r.value/e.cellResolution.h;else {if("px"!==r.unit)return null;a=r.value/e.pxDimensions.h;}return a}),new t(e.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new t(e.ns_tts,"origin","auto",["region"],!1,!0,function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var n=a.parseLength(t[0]),r=a.parseLength(t[1]);return r&&n?{h:r,w:n}:null},function(e,t,n,r,i){var a,o;if("auto"===r)a=0;else if("%"===r.h.unit)a=r.h.value/100;else {if("px"!==r.h.unit)return null;a=r.h.value/e.pxDimensions.h;}if("auto"===r)o=0;else if("%"===r.w.unit)o=r.w.value/100;else {if("px"!==r.w.unit)return null;o=r.w.value/e.pxDimensions.w;}return {h:a,w:o}}),new t(e.ns_tts,"overflow","hidden",["region"],!1,!0,function(e){return e},null),new t(e.ns_tts,"padding","0px",["region"],!1,!0,function(e){var t=e.split(" ");if(4<t.length)return null;var n=[];for(var r in t){var i=a.parseLength(t[r]);if(!i)return null;n.push(i);}return n},function(e,t,n,r,i){var a;if(1===r.length)a=[r[0],r[0],r[0],r[0]];else if(2===r.length)a=[r[0],r[1],r[0],r[1]];else if(3===r.length)a=[r[0],r[1],r[2],r[1]];else {if(4!==r.length)return null;a=[r[0],r[1],r[2],r[3]];}var o=n.styleAttrs[l.byName.writingMode.qname];if("lrtb"===o||"lr"===o)a=[a[0],a[3],a[2],a[1]];else if("rltb"===o||"rl"===o)a=[a[0],a[1],a[2],a[3]];else if("tblr"===o)a=[a[3],a[0],a[1],a[2]];else {if("tbrl"!==o&&"tb"!==o)return null;a=[a[3],a[2],a[1],a[0]];}var s=[];for(var u in a)if(0===a[u].value)s[u]=0;else if("%"===a[u].unit)s[u]="0"===u||"2"===u?n.styleAttrs[l.byName.extent.qname].h*a[u].value/100:n.styleAttrs[l.byName.extent.qname].w*a[u].value/100;else if("em"===a[u].unit)s[u]=n.styleAttrs[l.byName.fontSize.qname]*a[u].value;else if("c"===a[u].unit)s[u]=a[u].value/e.cellResolution.h;else {if("px"!==a[u].unit)return null;s[u]="0"===u||"2"===u?a[u].value/e.pxDimensions.h:a[u].value/e.pxDimensions.w;}return s}),new t(e.ns_tts,"showBackground","always",["region"],!1,!0,function(e){return e},null),new t(e.ns_tts,"textAlign","start",["p"],!0,!0,function(e){return e},function(e,t,n,r,i){return "left"===r?"start":"right"===r?"end":r}),new t(e.ns_tts,"textDecoration","none",["span"],!0,!0,function(e){return e.split(" ")},null),new t(e.ns_tts,"textOutline","none",["span"],!0,!0,function(e){if("none"===e)return e;var t={},n=e.split(" ");if(0===n.length||2<n.length)return null;var r=a.parseColor(n[0]);if(null!==(t.color=r)&&n.shift(),1!==n.length)return null;var i=a.parseLength(n[0]);return i?(t.thickness=i,t):null},function(e,t,n,r,i){if("none"===r)return r;var a={};if(null===r.color?a.color=n.styleAttrs[l.byName.color.qname]:a.color=r.color,"%"===r.thickness.unit)a.thickness=n.styleAttrs[l.byName.fontSize.qname]*r.thickness.value/100;else if("em"===r.thickness.unit)a.thickness=n.styleAttrs[l.byName.fontSize.qname]*r.thickness.value;else if("c"===r.thickness.unit)a.thickness=r.thickness.value/e.cellResolution.h;else {if("px"!==r.thickness.unit)return null;a.thickness=r.thickness.value/e.pxDimensions.h;}return a}),new t(e.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,function(e){return e},null),new t(e.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,function(e){return e},null),new t(e.ns_tts,"wrapOption","wrap",["span"],!0,!0,function(e){return e},null),new t(e.ns_tts,"writingMode","lrtb",["region"],!1,!0,function(e){return e},null),new t(e.ns_tts,"zIndex","auto",["region"],!1,!0,function(e){var t;return "auto"===e?t=e:(t=parseInt(e),isNaN(t)&&(t=null)),t},null),new t(e.ns_ebutts,"linePadding","0c",["p"],!0,!1,a.parseLength,function(e,t,n,r,i){return "c"===r.unit?r.value/e.cellResolution.h:null}),new t(e.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,function(e){return e},null),new t(e.ns_smpte,"backgroundImage",null,["div"],!1,!1,function(e){return e},null),new t(e.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,function(e){return "true"===e},null),new t(e.ns_itts,"fillLineGap","false",["p"],!0,!0,function(e){return "true"===e},null)],l.byQName={},l.all)l.byQName[l.all[n].qname]=l.all[n];for(var r in l.byName={},l.all)l.byName[l.all[r].name]=l.all[r];}(void 0===n?this.imscStyles={}:n,"undefined"==typeof imscNames?e(18):imscNames,"undefined"==typeof imscUtils?e(20):imscUtils);},{18:18,20:20}],20:[function(e,t,n){!function(e){var i=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,a=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,o=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,s={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};e.parseColor=function(e){var t,n=null,r=s[e.toLowerCase()];return void 0!==r?n=r:null!==(t=i.exec(e))?n=[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),void 0!==t[4]?parseInt(t[4],16):255]:null!==(t=a.exec(e))?n=[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),255]:null!==(t=o.exec(e))&&(n=[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),parseInt(t[4])]),n};var r=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%)$/;e.parseLength=function(e){var t,n=null;return null!==(t=r.exec(e))&&(n={value:parseFloat(t[1]),unit:t[2]}),n};}(void 0===n?this.imscUtils={}:n);},{}],21:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}});}:t.exports=function(e,t){e.super_=t;function n(){}n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e;};},{}],22:[function(e,t,n){function r(e){return !!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}t.exports=function(e){return null!=e&&(r(e)||"function"==typeof(t=e).readFloatLE&&"function"==typeof t.slice&&r(t.slice(0,0))||!!e._isBuffer);var t;};},{}],23:[function(e,t,n){var r={}.toString;t.exports=Array.isArray||function(e){return "[object Array]"==r.call(e)};},{}],24:[function(e,t,n){(function(s){!s.version||0===s.version.indexOf("v0.")||0===s.version.indexOf("v1.")&&0!==s.version.indexOf("v1.8.")?t.exports={nextTick:function(e,t,n,r){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var i,a,o=arguments.length;switch(o){case 0:case 1:return s.nextTick(e);case 2:return s.nextTick(function(){e.call(null,t);});case 3:return s.nextTick(function(){e.call(null,t,n);});case 4:return s.nextTick(function(){e.call(null,t,n,r);});default:for(i=new Array(o-1),a=0;a<i.length;)i[a++]=arguments[a];return s.nextTick(function(){e.apply(null,i);})}}}:t.exports=s;}).call(this,e(25));},{25:25}],25:[function(e,t,n){var r,i,a=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function u(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o;}catch(e){r=o;}try{i="function"==typeof clearTimeout?clearTimeout:s;}catch(e){i=s;}}();var l,d=[],f=!1,c=-1;function h(){f&&l&&(f=!1,l.length?d=l.concat(d):c=-1,d.length&&p());}function p(){if(!f){var e=u(h);f=!0;for(var t=d.length;t;){for(l=d,d=[];++c<t;)l&&l[c].run();c=-1,t=d.length;}l=null,f=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t);}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e);}}function g(e,t){this.fun=e,this.array=t;}function _(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new g(e,t)),1!==d.length||f||u(p);},g.prototype.run=function(){this.fun.apply(null,this.array);},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=_,a.addListener=_,a.once=_,a.off=_,a.removeListener=_,a.removeAllListeners=_,a.emit=_,a.prependListener=_,a.prependOnceListener=_,a.listeners=function(e){return []},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return "/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0};},{}],26:[function(e,t,n){t.exports=e(27);},{27:27}],27:[function(e,t,n){var r=e(24),i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};t.exports=f;var a=e(10);a.inherits=e(21);var o=e(29),s=e(31);a.inherits(f,o);for(var u=i(s.prototype),l=0;l<u.length;l++){var d=u[l];f.prototype[d]||(f.prototype[d]=s.prototype[d]);}function f(e){if(!(this instanceof f))return new f(e);o.call(this,e),s.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",c);}function c(){this.allowHalfOpen||this._writableState.ended||r.nextTick(h,this);}function h(e){e.end();}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e);}}),f.prototype._destroy=function(e,t){this.push(null),this.end(),r.nextTick(t,e);};},{10:10,21:21,24:24,29:29,31:31}],28:[function(e,t,n){t.exports=a;var r=e(30),i=e(10);function a(e){if(!(this instanceof a))return new a(e);r.call(this,e);}i.inherits=e(21),i.inherits(a,r),a.prototype._transform=function(e,t,n){n(null,e);};},{10:10,21:21,30:30}],29:[function(P,L,e){(function(_,e){var E=P(24);L.exports=c;var o,m=P(23);c.ReadableState=a;function v(e,t){return e.listeners(t).length}P(11).EventEmitter;var i=P(34),l=P(39).Buffer,d=e.Uint8Array||function(){};var t=P(10);t.inherits=P(21);var s,n=P(7),y=void 0,y=n&&n.debuglog?n.debuglog("stream"):function(){},u=P(32),r=P(33);t.inherits(c,i);var f=["error","close","destroy","pause","resume"];function a(e,t){e=e||{};var n=t instanceof(o=o||P(27));this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,i=e.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n&&(i||0===i)?i:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new u,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(s=s||P(42).StringDecoder,this.decoder=new s(e.encoding),this.encoding=e.encoding);}function c(e){if(o=o||P(27),!(this instanceof c))return new c(e);this._readableState=new a(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),i.call(this);}function h(e,t,n,r,i){var a,o,s,u=e._readableState;return null===t?(u.reading=!1,function(e,t){if(t.ended)return;{var n;!t.decoder||(n=t.decoder.end())&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length);}t.ended=!0,S(e);}(e,u)):(i||(a=function(e,t){var n;(function(e){return l.isBuffer(e)||e instanceof d})(t)||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));return n}(u,t)),a?e.emit("error",a):u.objectMode||t&&0<t.length?("string"==typeof t||u.objectMode||Object.getPrototypeOf(t)===l.prototype||(o=t,t=l.from(o)),r?u.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):p(e,u,t,!0):u.ended?e.emit("error",new Error("stream.push() after EOF")):(u.reading=!1,u.decoder&&!n?(t=u.decoder.write(t),u.objectMode||0!==t.length?p(e,u,t,!1):I(e,u)):p(e,u,t,!1))):r||(u.reading=!1)),!(s=u).ended&&(s.needReadable||s.length<s.highWaterMark||0===s.length)}function p(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&S(e)),I(e,t);}Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e);}}),c.prototype.destroy=r.destroy,c.prototype._undestroy=r.undestroy,c.prototype._destroy=function(e,t){this.push(null),t(e);},c.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=l.from(e,t),t=""),n=!0),h(this,e,t,!1,n)},c.prototype.unshift=function(e){return h(this,e,null,!0,!1)},c.prototype.isPaused=function(){return !1===this._readableState.flowing},c.prototype.setEncoding=function(e){return s=s||P(42).StringDecoder,this._readableState.decoder=new s(e),this._readableState.encoding=e,this};var g=8388608;function T(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=(g<=(n=e)?n=g:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0));var n;}function S(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(y("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?E.nextTick(A,e):A(e));}function A(e){y("emit readable"),e.emit("readable"),M(e);}function I(e,t){t.readingMore||(t.readingMore=!0,E.nextTick(R,e,t));}function R(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(y("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1;}function b(e){y("readable nexttick read 0"),e.read(0);}function D(e,t){t.reading||(y("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),M(e),t.flowing&&!t.reading&&e.read(0);}function M(e){var t=e._readableState;for(y("flow",t.flowing);t.flowing&&null!==e.read(););}function N(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var r;e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():(n?function(e,t){var n=t.head,r=1,i=n.data;e-=i.length;for(;n=n.next;){var a=n.data,o=e>a.length?a.length:e;if(o===a.length?i+=a:i+=a.slice(0,e),0===(e-=o)){o===a.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n).data=a.slice(o);break}++r;}return t.length-=r,i}:function(e,t){var n=l.allocUnsafe(e),r=t.head,i=1;r.data.copy(n),e-=r.data.length;for(;r=r.next;){var a=r.data,o=e>a.length?a.length:e;if(a.copy(n,n.length-e,0,o),0===(e-=o)){o===a.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r).data=a.slice(o);break}++i;}return t.length-=i,n})(e,t);return r}(e,t.buffer,t.decoder),n);var n;}function C(e){var t=e._readableState;if(0<t.length)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,E.nextTick(O,t,e));}function O(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"));}function w(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return -1}c.prototype.read=function(e){y("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return y("read: emitReadable",t.length,t.ended),(0===t.length&&t.ended?C:S)(this),null;if(0===(e=T(e,t))&&t.ended)return 0===t.length&&C(this),null;var r,i=t.needReadable;return y("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&y("length less than watermark",i=!0),t.ended||t.reading?y("reading or ended",i=!1):i&&(y("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=T(n,t))),null===(r=0<e?N(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&C(this)),null!==r&&this.emit("data",r),r},c.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"));},c.prototype.pipe=function(n,e){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=n;break;case 1:i.pipes=[i.pipes,n];break;default:i.pipes.push(n);}i.pipesCount+=1,y("pipe count=%d opts=%j",i.pipesCount,e);var t=(!e||!1!==e.end)&&n!==_.stdout&&n!==_.stderr?o:g;function a(e,t){y("onunpipe"),e===r&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,y("cleanup"),n.removeListener("close",h),n.removeListener("finish",p),n.removeListener("drain",u),n.removeListener("error",c),n.removeListener("unpipe",a),r.removeListener("end",o),r.removeListener("end",g),r.removeListener("data",f),l=!0,!i.awaitDrain||n._writableState&&!n._writableState.needDrain||u());}function o(){y("onend"),n.end();}i.endEmitted?E.nextTick(t):r.once("end",t),n.on("unpipe",a);var s,u=(s=r,function(){var e=s._readableState;y("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&v(s,"data")&&(e.flowing=!0,M(s));});n.on("drain",u);var l=!1;var d=!1;function f(e){y("ondata"),(d=!1)!==n.write(e)||d||((1===i.pipesCount&&i.pipes===n||1<i.pipesCount&&-1!==w(i.pipes,n))&&!l&&(y("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,d=!0),r.pause());}function c(e){y("onerror",e),g(),n.removeListener("error",c),0===v(n,"error")&&n.emit("error",e);}function h(){n.removeListener("finish",p),g();}function p(){y("onfinish"),n.removeListener("close",h),g();}function g(){y("unpipe"),r.unpipe(n);}return r.on("data",f),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?m(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n);}(n,"error",c),n.once("close",h),n.once("finish",p),n.emit("pipe",r),i.flowing||(y("pipe resume"),r.resume()),n},c.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e=e||t.pipes,t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)r[a].emit("unpipe",this,n);return this}var o=w(t.pipes,e);return -1===o||(t.pipes.splice(o,1),--t.pipesCount,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},c.prototype.addListener=c.prototype.on=function(e,t){var n,r=i.prototype.on.call(this,e,t);return "data"===e?!1!==this._readableState.flowing&&this.resume():"readable"===e&&((n=this._readableState).endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&S(this):E.nextTick(b,this))),r},c.prototype.resume=function(){var e,t,n=this._readableState;return n.flowing||(y("resume"),n.flowing=!0,e=this,(t=n).resumeScheduled||(t.resumeScheduled=!0,E.nextTick(D,e,t))),this},c.prototype.pause=function(){return y("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(y("pause"),this._readableState.flowing=!1,this.emit("pause")),this},c.prototype.wrap=function(t){var n=this,r=this._readableState,i=!1;for(var e in t.on("end",function(){var e;y("wrapped end"),!r.decoder||r.ended||(e=r.decoder.end())&&e.length&&n.push(e),n.push(null);}),t.on("data",function(e){y("wrapped data"),r.decoder&&(e=r.decoder.write(e)),r.objectMode&&null==e||(r.objectMode||e&&e.length)&&(n.push(e)||(i=!0,t.pause()));}),t)void 0===this[e]&&"function"==typeof t[e]&&(this[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e));for(var a=0;a<f.length;a++)t.on(f[a],this.emit.bind(this,f[a]));return this._read=function(e){y("wrapped _read",e),i&&(i=!1,t.resume());},this},Object.defineProperty(c.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),c._fromList=N;}).call(this,P(25),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});},{10:10,11:11,21:21,23:23,24:24,25:25,27:27,32:32,33:33,34:34,39:39,42:42,7:7}],30:[function(e,t,n){t.exports=a;var r=e(27),i=e(10);function a(e){if(!(this instanceof a))return new a(e);r.call(this,e),this._transformState={afterTransform:function(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,(n.writecb=null)!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark);}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",o);}function o(){var n=this;"function"==typeof this._flush?this._flush(function(e,t){s(n,e,t);}):s(this,null,null);}function s(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}i.inherits=e(21),i.inherits(a,r),a.prototype.push=function(e,t){return this._transformState.needTransform=!1,r.prototype.push.call(this,e,t)},a.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},a.prototype._write=function(e,t,n){var r,i=this._transformState;i.writecb=n,i.writechunk=e,i.writeencoding=t,i.transforming||(r=this._readableState,(i.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark));},a.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0;},a.prototype._destroy=function(e,t){var n=this;r.prototype._destroy.call(this,e,function(e){t(e),n.emit("close");});};},{10:10,21:21,27:27}],31:[function(A,I,e){(function(e,t,n){var E=A(24);function f(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next;}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e;}(t,e);};}I.exports=c;var s,u=!e.browser&&-1<["v0.10","v0.9."].indexOf(e.version.slice(0,5))?n:E.nextTick;c.WritableState=d;var r=A(10);r.inherits=A(21);var i={deprecate:A(44)},a=A(34),m=A(39).Buffer,v=t.Uint8Array||function(){};var o,l=A(33);function y(){}function d(e,t){s=s||A(27),e=e||{};var n=t instanceof s;this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,i=e.writableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n&&(i||0===i)?i:a,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var o=(this.destroyed=!1)===e.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,i=n.writecb;{var a;(((function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0;})))(n),t?function(e,t,n,r,i){--t.pendingcb,n?(E.nextTick(i,r),E.nextTick(S,e,t),e._writableState.errorEmitted=!0,e.emit("error",r)):(i(r),e._writableState.errorEmitted=!0,e.emit("error",r),S(e,t));}(e,n,r,t,i):((a=g(n))||n.corked||n.bufferProcessing||!n.bufferedRequest||p(e,n),r?u(h,e,n,a,i):h(e,n,a,i));}}(t,e);},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new f(this);}function c(e){if(s=s||A(27),!(o.call(c,this)||this instanceof s))return new c(e);this._writableState=new d(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),a.call(this);}function T(e,t,n,r,i,a,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1;}function h(e,t,n,r){var i,a;n||(i=e,0===(a=t).length&&a.needDrain&&(a.needDrain=!1,i.emit("drain"))),t.pendingcb--,r(),S(e,t);}function p(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),a=t.corkedRequestsFree;a.entry=n;for(var o=0,s=!0;n;)(i[o]=n).isBuf||(s=!1),n=n.next,o+=1;i.allBuffers=s,T(e,t,!0,t.length,i,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new f(t),t.bufferedRequestCount=0;}else {for(;n;){var u=n.chunk,l=n.encoding,d=n.callback;if(T(e,t,!1,t.objectMode?1:u.length,u,l,d),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null);}t.bufferedRequest=n,t.bufferProcessing=!1;}function g(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function _(t,n){t._final(function(e){n.pendingcb--,e&&t.emit("error",e),n.prefinished=!0,t.emit("prefinish"),S(t,n);});}function S(e,t){var n,r,i=g(t);return i&&(n=e,(r=t).prefinished||r.finalCalled||("function"==typeof n._final?(r.pendingcb++,r.finalCalled=!0,E.nextTick(_,n,r)):(r.prefinished=!0,n.emit("prefinish"))),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),i}r.inherits(c,a),d.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(d.prototype,"buffer",{get:i.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")});}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(o=Function.prototype[Symbol.hasInstance],Object.defineProperty(c,Symbol.hasInstance,{value:function(e){return !!o.call(this,e)||this===c&&(e&&e._writableState instanceof d)}})):o=function(e){return e instanceof this},c.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"));},c.prototype.write=function(e,t,n){var r,i,a,o,s,u,l,d,f,c,h,p=this._writableState,g=!1,_=!p.objectMode&&(r=e,m.isBuffer(r)||r instanceof v);return _&&!m.isBuffer(e)&&(i=e,e=m.from(i)),"function"==typeof t&&(n=t,t=null),t=_?"buffer":t||p.defaultEncoding,"function"!=typeof n&&(n=y),p.ended?(f=this,c=n,h=new Error("write after end"),f.emit("error",h),E.nextTick(c,h)):(_||(a=this,o=p,u=n,d=!(l=!0),null===(s=e)?d=new TypeError("May not write null values to stream"):"string"==typeof s||void 0===s||o.objectMode||(d=new TypeError("Invalid non-string/buffer chunk")),d&&(a.emit("error",d),E.nextTick(u,d),l=!1),l))&&(p.pendingcb++,g=function(e,t,n,r,i,a){{var o;n||(o=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=m.from(t,n));return t}(t,r,i),r!==o&&(n=!0,i="buffer",r=o));}var s=t.objectMode?1:r.length;t.length+=s;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);{var l;t.writing||t.corked?(l=t.lastBufferedRequest,t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:a,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1):T(e,t,!1,s,r,i,a);}return u}(this,p,_,e,t,n)),g},c.prototype.cork=function(){this._writableState.corked++;},c.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||p(this,e));},c.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),c.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"));},c.prototype._writev=null,c.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,t=e=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(e,t,n){t.ending=!0,S(e,t),n&&(t.finished?E.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1;}(this,r,n);},Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e);}}),c.prototype.destroy=l.destroy,c.prototype._undestroy=l.undestroy,c.prototype._destroy=function(e,t){this.end(),t(e);};}).call(this,A(25),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},A(43).setImmediate);},{10:10,21:21,24:24,25:25,27:27,33:33,34:34,39:39,43:43,44:44}],32:[function(e,t,n){var s=e(39).Buffer,r=e(7);function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.head=null,this.tail=null,this.length=0;}t.exports=(i.prototype.push=function(e){var t={data:e,next:null};0<this.length?this.tail.next=t:this.head=t,this.tail=t,++this.length;},i.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length;},i.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},i.prototype.clear=function(){this.head=this.tail=null,this.length=0;},i.prototype.join=function(e){if(0===this.length)return "";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},i.prototype.concat=function(e){if(0===this.length)return s.alloc(0);if(1===this.length)return this.head.data;for(var t,n,r,i=s.allocUnsafe(e>>>0),a=this.head,o=0;a;)t=a.data,n=i,r=o,t.copy(n,r),o+=a.data.length,a=a.next;return i},i),r&&r.inspect&&r.inspect.custom&&(t.exports.prototype[r.inspect.custom]=function(){var e=r.inspect({length:this.length});return this.constructor.name+" "+e});},{39:39,7:7}],33:[function(e,t,n){var a=e(24);function o(e,t){e.emit("error",t);}t.exports={destroy:function(e,t){var n=this,r=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return r||i?t?t(e):!e||this._writableState&&this._writableState.errorEmitted||a.nextTick(o,this,e):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(a.nextTick(o,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e);})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1);}};},{24:24}],34:[function(e,t,n){t.exports=e(11).EventEmitter;},{11:11}],35:[function(e,t,n){t.exports=e(36).PassThrough;},{36:36}],36:[function(e,t,n){(((n=t.exports=e(29)).Stream=n).Readable=n).Writable=e(31),n.Duplex=e(27),n.Transform=e(30),n.PassThrough=e(28);},{27:27,28:28,29:29,30:30,31:31}],37:[function(e,t,n){t.exports=e(36).Transform;},{36:36}],38:[function(e,t,n){t.exports=e(31);},{31:31}],39:[function(e,t,n){var r=e(8),i=r.Buffer;function a(e,t){for(var n in e)t[n]=e[n];}function o(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(a(r,n),n.Buffer=o),a(i,o),o.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},o.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)};},{8:8}],40:[function(Y,e,t){(function(j){!function(u){u.parser=function(e,t){return new i(e,t)},u.SAXParser=i,u.SAXStream=o,u.createStream=function(e,t){return new o(e,t)},u.MAX_BUFFER_LENGTH=65536;var r,l=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function i(e,t){if(!(this instanceof i))return new i(e,t);var n=this;!function(e){for(var t=0,n=l.length;t<n;t++)e[l[t]]="";}(n),n.q=n.c="",n.bufferCheckPosition=u.MAX_BUFFER_LENGTH,n.opt=t||{},n.opt.lowercase=n.opt.lowercase||n.opt.lowercasetags,n.looseCase=n.opt.lowercase?"toLowerCase":"toUpperCase",n.tags=[],n.closed=n.closedRoot=n.sawRoot=!1,n.tag=n.error=null,n.strict=!!e,n.noscript=!(!e&&!n.opt.noscript),n.state=R.BEGIN,n.strictEntities=n.opt.strictEntities,n.ENTITIES=n.strictEntities?Object.create(u.XML_ENTITIES):Object.create(u.ENTITIES),n.attribList=[],n.opt.xmlns&&(n.ns=Object.create(g)),n.trackPosition=!1!==n.opt.position,n.trackPosition&&(n.position=n.line=n.column=0),D(n,"onready");}u.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),i.prototype={end:function(){w(this);},write:function(e){var t=this;if(this.error)throw this.error;if(t.closed)return O(t,"Cannot write after close. Assign an onready handler.");if(null===e)return w(t);"object"==typeof e&&(e=e.toString());var n,r,i=0,a="";for(;a=B(e,i++),t.c=a;)switch(t.trackPosition&&(t.position++,"\n"===a?(t.line++,t.column=0):t.column++),t.state){case R.BEGIN:if(t.state=R.BEGIN_WHITESPACE,"\ufeff"===a)continue;k(t,a);continue;case R.BEGIN_WHITESPACE:k(t,a);continue;case R.TEXT:if(t.sawRoot&&!t.closedRoot){for(var o=i-1;a&&"<"!==a&&"&"!==a;)(a=B(e,i++))&&t.trackPosition&&(t.position++,"\n"===a?(t.line++,t.column=0):t.column++);t.textNode+=e.substring(o,i-1);}"<"!==a||t.sawRoot&&t.closedRoot&&!t.strict?(!S(_,a)||t.sawRoot&&!t.closedRoot||P(t,"Text data outside of root node."),"&"===a?t.state=R.TEXT_ENTITY:t.textNode+=a):(t.state=R.OPEN_WAKA,t.startTagPosition=t.position);continue;case R.SCRIPT:"<"===a?t.state=R.SCRIPT_ENDING:t.script+=a;continue;case R.SCRIPT_ENDING:"/"===a?t.state=R.CLOSE_TAG:(t.script+="<"+a,t.state=R.SCRIPT);continue;case R.OPEN_WAKA:var s;"!"===a?(t.state=R.SGML_DECL,t.sgmlDecl=""):T(_,a)||(T(E,a)?(t.state=R.OPEN_TAG,t.tagName=a):"/"===a?(t.state=R.CLOSE_TAG,t.tagName=""):"?"===a?(t.state=R.PROC_INST,t.procInstName=t.procInstBody=""):(P(t,"Unencoded <"),t.startTagPosition+1<t.position&&(s=t.position-t.startTagPosition,a=new Array(s).join(" ")+a),t.textNode+="<"+a,t.state=R.TEXT));continue;case R.SGML_DECL:(t.sgmlDecl+a).toUpperCase()===c?(M(t,"onopencdata"),t.state=R.CDATA,t.sgmlDecl="",t.cdata=""):t.sgmlDecl+a==="--"?(t.state=R.COMMENT,t.comment="",t.sgmlDecl=""):(t.sgmlDecl+a).toUpperCase()===h?(t.state=R.DOCTYPE,(t.doctype||t.sawRoot)&&P(t,"Inappropriately located doctype declaration"),t.doctype="",t.sgmlDecl=""):">"===a?(M(t,"onsgmldeclaration",t.sgmlDecl),t.sgmlDecl="",t.state=R.TEXT):(T(d,a)&&(t.state=R.SGML_DECL_QUOTED),t.sgmlDecl+=a);continue;case R.SGML_DECL_QUOTED:a===t.q&&(t.state=R.SGML_DECL,t.q=""),t.sgmlDecl+=a;continue;case R.DOCTYPE:">"===a?(t.state=R.TEXT,M(t,"ondoctype",t.doctype),t.doctype=!0):(t.doctype+=a,"["===a?t.state=R.DOCTYPE_DTD:T(d,a)&&(t.state=R.DOCTYPE_QUOTED,t.q=a));continue;case R.DOCTYPE_QUOTED:t.doctype+=a,a===t.q&&(t.q="",t.state=R.DOCTYPE);continue;case R.DOCTYPE_DTD:t.doctype+=a,"]"===a?t.state=R.DOCTYPE:T(d,a)&&(t.state=R.DOCTYPE_DTD_QUOTED,t.q=a);continue;case R.DOCTYPE_DTD_QUOTED:t.doctype+=a,a===t.q&&(t.state=R.DOCTYPE_DTD,t.q="");continue;case R.COMMENT:"-"===a?t.state=R.COMMENT_ENDING:t.comment+=a;continue;case R.COMMENT_ENDING:"-"===a?(t.state=R.COMMENT_ENDED,t.comment=C(t.opt,t.comment),t.comment&&M(t,"oncomment",t.comment),t.comment=""):(t.comment+="-"+a,t.state=R.COMMENT);continue;case R.COMMENT_ENDED:">"!==a?(P(t,"Malformed comment"),t.comment+="--"+a,t.state=R.COMMENT):t.state=R.TEXT;continue;case R.CDATA:"]"===a?t.state=R.CDATA_ENDING:t.cdata+=a;continue;case R.CDATA_ENDING:"]"===a?t.state=R.CDATA_ENDING_2:(t.cdata+="]"+a,t.state=R.CDATA);continue;case R.CDATA_ENDING_2:">"===a?(t.cdata&&M(t,"oncdata",t.cdata),M(t,"onclosecdata"),t.cdata="",t.state=R.TEXT):"]"===a?t.cdata+="]":(t.cdata+="]]"+a,t.state=R.CDATA);continue;case R.PROC_INST:"?"===a?t.state=R.PROC_INST_ENDING:T(_,a)?t.state=R.PROC_INST_BODY:t.procInstName+=a;continue;case R.PROC_INST_BODY:if(!t.procInstBody&&T(_,a))continue;"?"===a?t.state=R.PROC_INST_ENDING:t.procInstBody+=a;continue;case R.PROC_INST_ENDING:">"===a?(M(t,"onprocessinginstruction",{name:t.procInstName,body:t.procInstBody}),t.procInstName=t.procInstBody="",t.state=R.TEXT):(t.procInstBody+="?"+a,t.state=R.PROC_INST_BODY);continue;case R.OPEN_TAG:T(m,a)?t.tagName+=a:(function(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,n=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(n.ns=t.ns);e.attribList.length=0,M(e,"onopentagstart",n);}(t),">"===a?F(t):"/"===a?t.state=R.OPEN_TAG_SLASH:(S(_,a)&&P(t,"Invalid character in tag name"),t.state=R.ATTRIB));continue;case R.OPEN_TAG_SLASH:">"===a?(F(t,!0),U(t)):(P(t,"Forward-slash in opening tag not followed by >"),t.state=R.ATTRIB);continue;case R.ATTRIB:if(T(_,a))continue;">"===a?F(t):"/"===a?t.state=R.OPEN_TAG_SLASH:T(E,a)?(t.attribName=a,t.attribValue="",t.state=R.ATTRIB_NAME):P(t,"Invalid attribute name");continue;case R.ATTRIB_NAME:"="===a?t.state=R.ATTRIB_VALUE:">"===a?(P(t,"Attribute without value"),t.attribValue=t.attribName,x(t),F(t)):T(_,a)?t.state=R.ATTRIB_NAME_SAW_WHITE:T(m,a)?t.attribName+=a:P(t,"Invalid attribute name");continue;case R.ATTRIB_NAME_SAW_WHITE:if("="===a)t.state=R.ATTRIB_VALUE;else {if(T(_,a))continue;P(t,"Attribute without value"),t.tag.attributes[t.attribName]="",t.attribValue="",M(t,"onattribute",{name:t.attribName,value:""}),t.attribName="",">"===a?F(t):T(E,a)?(t.attribName=a,t.state=R.ATTRIB_NAME):(P(t,"Invalid attribute name"),t.state=R.ATTRIB);}continue;case R.ATTRIB_VALUE:if(T(_,a))continue;T(d,a)?(t.q=a,t.state=R.ATTRIB_VALUE_QUOTED):(P(t,"Unquoted attribute value"),t.state=R.ATTRIB_VALUE_UNQUOTED,t.attribValue=a);continue;case R.ATTRIB_VALUE_QUOTED:if(a!==t.q){"&"===a?t.state=R.ATTRIB_VALUE_ENTITY_Q:t.attribValue+=a;continue}x(t),t.q="",t.state=R.ATTRIB_VALUE_CLOSED;continue;case R.ATTRIB_VALUE_CLOSED:T(_,a)?t.state=R.ATTRIB:">"===a?F(t):"/"===a?t.state=R.OPEN_TAG_SLASH:T(E,a)?(P(t,"No whitespace between attributes"),t.attribName=a,t.attribValue="",t.state=R.ATTRIB_NAME):P(t,"Invalid attribute name");continue;case R.ATTRIB_VALUE_UNQUOTED:if(S(f,a)){"&"===a?t.state=R.ATTRIB_VALUE_ENTITY_U:t.attribValue+=a;continue}x(t),">"===a?F(t):t.state=R.ATTRIB;continue;case R.CLOSE_TAG:if(t.tagName)">"===a?U(t):T(m,a)?t.tagName+=a:t.script?(t.script+="</"+t.tagName,t.tagName="",t.state=R.SCRIPT):(S(_,a)&&P(t,"Invalid tagname in closing tag"),t.state=R.CLOSE_TAG_SAW_WHITE);else {if(T(_,a))continue;S(E,a)?t.script?(t.script+="</"+a,t.state=R.SCRIPT):P(t,"Invalid tagname in closing tag."):t.tagName=a;}continue;case R.CLOSE_TAG_SAW_WHITE:if(T(_,a))continue;">"===a?U(t):P(t,"Invalid characters in closing tag");continue;case R.TEXT_ENTITY:case R.ATTRIB_VALUE_ENTITY_Q:case R.ATTRIB_VALUE_ENTITY_U:switch(t.state){case R.TEXT_ENTITY:n=R.TEXT,r="textNode";break;case R.ATTRIB_VALUE_ENTITY_Q:n=R.ATTRIB_VALUE_QUOTED,r="attribValue";break;case R.ATTRIB_VALUE_ENTITY_U:n=R.ATTRIB_VALUE_UNQUOTED,r="attribValue";}";"===a?(t[r]+=function(e){var t,n=e.entity,r=n.toLowerCase(),i="";if(e.ENTITIES[n])return e.ENTITIES[n];if(e.ENTITIES[r])return e.ENTITIES[r];"#"===(n=r).charAt(0)&&(i="x"===n.charAt(1)?(n=n.slice(2),(t=parseInt(n,16)).toString(16)):(n=n.slice(1),(t=parseInt(n,10)).toString(10)));return n=n.replace(/^0+/,""),i.toLowerCase()===n?String.fromCodePoint(t):(P(e,"Invalid character entity"),"&"+e.entity+";")}(t),t.entity="",t.state=n):T(t.entity.length?y:v,a)?t.entity+=a:(P(t,"Invalid character in entity name"),t[r]+="&"+t.entity+a,t.entity="",t.state=n);continue;default:throw new Error(t,"Unknown state: "+t.state)}t.position>=t.bufferCheckPosition&&function(e){for(var t=Math.max(u.MAX_BUFFER_LENGTH,10),n=0,r=0,i=l.length;r<i;r++){var a=e[l[r]].length;if(t<a)switch(l[r]){case"textNode":N(e);break;case"cdata":M(e,"oncdata",e.cdata),e.cdata="";break;case"script":M(e,"onscript",e.script),e.script="";break;default:O(e,"Max buffer length exceeded: "+l[r]);}n=Math.max(n,a);}var o=u.MAX_BUFFER_LENGTH-n;e.bufferCheckPosition=o+e.position;}(t);return t},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;N(e=this),""!==e.cdata&&(M(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(M(e,"onscript",e.script),e.script="");}};try{r=Y(41).Stream;}catch(e){r=function(){};}var a=u.EVENTS.filter(function(e){return "error"!==e&&"end"!==e});function o(e,t){if(!(this instanceof o))return new o(e,t);r.apply(this),this._parser=new i(e,t),this.writable=!0,this.readable=!0;var n=this;this._parser.onend=function(){n.emit("end");},this._parser.onerror=function(e){n.emit("error",e),n._parser.error=null;},this._decoder=null,a.forEach(function(t){Object.defineProperty(n,"on"+t,{get:function(){return n._parser["on"+t]},set:function(e){if(!e)return n.removeAllListeners(t),n._parser["on"+t]=e;n.on(t,e);},enumerable:!0,configurable:!1});});}(o.prototype=Object.create(r.prototype,{constructor:{value:o}})).write=function(e){var t;return "function"==typeof j&&"function"==typeof j.isBuffer&&j.isBuffer(e)&&(this._decoder||(t=Y(42).StringDecoder,this._decoder=new t("utf8")),e=this._decoder.write(e)),this._parser.write(e.toString()),this.emit("data",e),!0},o.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},o.prototype.on=function(t,e){var n=this;return n._parser["on"+t]||-1===a.indexOf(t)||(n._parser["on"+t]=function(){var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);e.splice(0,0,t),n.emit.apply(n,e);}),r.prototype.on.call(n,t,e)};var e="0124356789",t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",d="'\"",f=(_="\r\n\t ")+">",c="[CDATA[",h="DOCTYPE",s="http://www.w3.org/XML/1998/namespace",p="http://www.w3.org/2000/xmlns/",g={xml:s,xmlns:p},_=n(_),e=n(e),t=n(t),E=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,m=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,v=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,y=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;function n(e){return e.split("").reduce(function(e,t){return e[t]=!0,e},{})}function T(e,t){return n=e,"[object RegExp]"===Object.prototype.toString.call(n)?t.match(e):e[t];var n;}function S(e,t){return !T(e,t)}d=n(d),f=n(f);var A,I,R=0;for(var b in u.STATE={BEGIN:R++,BEGIN_WHITESPACE:R++,TEXT:R++,TEXT_ENTITY:R++,OPEN_WAKA:R++,SGML_DECL:R++,SGML_DECL_QUOTED:R++,DOCTYPE:R++,DOCTYPE_QUOTED:R++,DOCTYPE_DTD:R++,DOCTYPE_DTD_QUOTED:R++,COMMENT_STARTING:R++,COMMENT:R++,COMMENT_ENDING:R++,COMMENT_ENDED:R++,CDATA:R++,CDATA_ENDING:R++,CDATA_ENDING_2:R++,PROC_INST:R++,PROC_INST_BODY:R++,PROC_INST_ENDING:R++,OPEN_TAG:R++,OPEN_TAG_SLASH:R++,ATTRIB:R++,ATTRIB_NAME:R++,ATTRIB_NAME_SAW_WHITE:R++,ATTRIB_VALUE:R++,ATTRIB_VALUE_QUOTED:R++,ATTRIB_VALUE_CLOSED:R++,ATTRIB_VALUE_UNQUOTED:R++,ATTRIB_VALUE_ENTITY_Q:R++,ATTRIB_VALUE_ENTITY_U:R++,CLOSE_TAG:R++,CLOSE_TAG_SAW_WHITE:R++,SCRIPT:R++,SCRIPT_ENDING:R++},u.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},u.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(u.ENTITIES).forEach(function(e){var t=u.ENTITIES[e],n="number"==typeof t?String.fromCharCode(t):t;u.ENTITIES[e]=n;}),u.STATE)u.STATE[u.STATE[b]]=b;function D(e,t,n){e[t]&&e[t](n);}function M(e,t,n){e.textNode&&N(e),D(e,t,n);}function N(e){e.textNode=C(e.opt,e.textNode),e.textNode&&D(e,"ontext",e.textNode),e.textNode="";}function C(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function O(e,t){return N(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,D(e,"onerror",t),e}function w(e){return e.sawRoot&&!e.closedRoot&&P(e,"Unclosed root tag"),e.state!==R.BEGIN&&e.state!==R.BEGIN_WHITESPACE&&e.state!==R.TEXT&&O(e,"Unexpected end"),N(e),e.c="",e.closed=!0,D(e,"onend"),i.call(e,e.strict,e.opt),e}function P(e,t){if("object"!=typeof e||!(e instanceof i))throw new Error("bad call to strictFail");e.strict&&O(e,t);}function L(e,t){var n=e.indexOf(":")<0?["",e]:e.split(":"),r=n[0],i=n[1];return t&&"xmlns"===e&&(r="xmlns",i=""),{prefix:r,local:i}}function x(e){var t,n,r,i,a;e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName)||(e.opt.xmlns?(n=(t=L(e.attribName,!0)).prefix,r=t.local,"xmlns"===n&&("xml"===r&&e.attribValue!==s?P(e,"xml: prefix must be bound to "+s+"\nActual: "+e.attribValue):"xmlns"===r&&e.attribValue!==p?P(e,"xmlns: prefix must be bound to "+p+"\nActual: "+e.attribValue):(i=e.tag,a=e.tags[e.tags.length-1]||e,i.ns===a.ns&&(i.ns=Object.create(a.ns)),i.ns[r]=e.attribValue)),e.attribList.push([e.attribName,e.attribValue])):(e.tag.attributes[e.attribName]=e.attribValue,M(e,"onattribute",{name:e.attribName,value:e.attribValue}))),e.attribName=e.attribValue="";}function F(t,e){if(t.opt.xmlns){var n=t.tag,r=L(t.tagName);n.prefix=r.prefix,n.local=r.local,n.uri=n.ns[r.prefix]||"",n.prefix&&!n.uri&&(P(t,"Unbound namespace prefix: "+JSON.stringify(t.tagName)),n.uri=r.prefix);var i=t.tags[t.tags.length-1]||t;n.ns&&i.ns!==n.ns&&Object.keys(n.ns).forEach(function(e){M(t,"onopennamespace",{prefix:e,uri:n.ns[e]});});for(var a=0,o=t.attribList.length;a<o;a++){var s=t.attribList[a],u=s[0],l=s[1],d=L(u,!0),f=d.prefix,c=d.local,h=""!==f&&n.ns[f]||"",p={name:u,value:l,prefix:f,local:c,uri:h};f&&"xmlns"!==f&&!h&&(P(t,"Unbound namespace prefix: "+JSON.stringify(f)),p.uri=f),t.tag.attributes[u]=p,M(t,"onattribute",p);}t.attribList.length=0;}t.tag.isSelfClosing=!!e,t.sawRoot=!0,t.tags.push(t.tag),M(t,"onopentag",t.tag),e||(t.noscript||"script"!==t.tagName.toLowerCase()?t.state=R.TEXT:t.state=R.SCRIPT,t.tag=null,t.tagName=""),t.attribName=t.attribValue="",t.attribList.length=0;}function U(n){if(!n.tagName)return P(n,"Weird empty close tag."),n.textNode+="</>",void(n.state=R.TEXT);if(n.script){if("script"!==n.tagName)return n.script+="</"+n.tagName+">",n.tagName="",void(n.state=R.SCRIPT);M(n,"onscript",n.script),n.script="";}var e=n.tags.length,t=n.tagName;n.strict||(t=t[n.looseCase]());for(var r=t;e--;){if(n.tags[e].name===r)break;P(n,"Unexpected close tag");}if(e<0)return P(n,"Unmatched closing tag: "+n.tagName),n.textNode+="</"+n.tagName+">",void(n.state=R.TEXT);n.tagName=t;for(var i=n.tags.length;i-- >e;){var a=n.tag=n.tags.pop();n.tagName=n.tag.name,M(n,"onclosetag",n.tagName);var o={};for(var s in a.ns)o[s]=a.ns[s];var u=n.tags[n.tags.length-1]||n;n.opt.xmlns&&a.ns!==u.ns&&Object.keys(a.ns).forEach(function(e){var t=a.ns[e];M(n,"onclosenamespace",{prefix:e,uri:t});});}0===e&&(n.closedRoot=!0),n.tagName=n.attribValue=n.attribName="",n.attribList.length=0,n.state=R.TEXT;}function k(e,t){"<"===t?(e.state=R.OPEN_WAKA,e.startTagPosition=e.position):S(_,t)&&(P(e,"Non-whitespace before first tag."),e.textNode=t,e.state=R.TEXT);}function B(e,t){var n="";return t<e.length&&(n=e.charAt(t)),n}function G(){var e,t,n=[],r=-1,i=arguments.length;if(!i)return "";for(var a="";++r<i;){var o=Number(arguments[r]);if(!isFinite(o)||o<0||1114111<o||I(o)!==o)throw RangeError("Invalid code point: "+o);o<=65535?n.push(o):(e=55296+((o-=65536)>>10),t=o%1024+56320,n.push(e,t)),(r+1===i||16384<n.length)&&(a+=A.apply(null,n),n.length=0);}return a}R=u.STATE,String.fromCodePoint||(A=String.fromCharCode,I=Math.floor,Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:G,configurable:!0,writable:!0}):String.fromCodePoint=G);}(void 0===t?this.sax={}:t);}).call(this,Y(8).Buffer);},{41:41,42:42,8:8}],41:[function(e,t,n){t.exports=r;var d=e(11).EventEmitter;function r(){d.call(this);}e(21)(r,d),r.Readable=e(36),r.Writable=e(38),r.Duplex=e(26),r.Transform=e(37),r.PassThrough=e(35),(r.Stream=r).prototype.pipe=function(t,e){var n=this;function r(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause();}function i(){n.readable&&n.resume&&n.resume();}n.on("data",r),t.on("drain",i),t._isStdio||e&&!1===e.end||(n.on("end",o),n.on("close",s));var a=!1;function o(){a||(a=!0,t.end());}function s(){a||(a=!0,"function"==typeof t.destroy&&t.destroy());}function u(e){if(l(),0===d.listenerCount(this,"error"))throw e}function l(){n.removeListener("data",r),t.removeListener("drain",i),n.removeListener("end",o),n.removeListener("close",s),n.removeListener("error",u),t.removeListener("error",u),n.removeListener("end",l),n.removeListener("close",l),t.removeListener("close",l);}return n.on("error",u),t.on("error",u),n.on("end",l),n.on("close",l),t.on("close",l),t.emit("pipe",n),t};},{11:11,21:21,26:26,35:35,36:36,37:37,38:38}],42:[function(e,t,n){var r=e(39).Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return !0;default:return !1}};function a(e){var t=function(e){if(!e)return "utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return "utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return "utf16le";case"latin1":case"binary":return "latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0;}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}function o(e){var t;switch(this.encoding=a(e),this.encoding){case"utf16le":this.text=l,this.end=d,t=4;break;case"utf8":this.fillLast=u,t=4;break;case"base64":this.text=f,this.end=c,t=3;break;default:return this.write=h,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t);}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function u(e){var t=this.lastTotal-this.lastNeed,n=function(e,t){if(128!=(192&t[0]))return e.lastNeed=0,"";if(1<e.lastNeed&&1<t.length){if(128!=(192&t[1]))return e.lastNeed=1,"";if(2<e.lastNeed&&2<t.length&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1);var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(55296<=r&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}function d(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function f(e,t){var n=(e.length-t)%3;return 0==n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1==n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function c(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function h(e){return e.toString(this.encoding)}function p(e){return e&&e.length?this.write(e):""}(n.StringDecoder=o).prototype.write=function(e){if(0===e.length)return "";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return "";n=this.lastNeed,this.lastNeed=0;}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},o.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=s(t[r]);if(0<=i)return 0<i&&(e.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if(0<=(i=s(t[r])))return 0<i&&(e.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if(0<=(i=s(t[r])))return 0<i&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length;};},{39:39}],43:[function(u,e,l){(function(e,t){var r=u(25).nextTick,n=Function.prototype.apply,i=Array.prototype.slice,a={},o=0;function s(e,t){this._id=e,this._clearFn=t;}l.setTimeout=function(){return new s(n.call(setTimeout,window,arguments),clearTimeout)},l.setInterval=function(){return new s(n.call(setInterval,window,arguments),clearInterval)},l.clearTimeout=l.clearInterval=function(e){e.close();},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id);},l.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t;},l.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1;},l._unrefActive=l.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout();},t));},l.setImmediate="function"==typeof e?e:function(e){var t=o++,n=!(arguments.length<2)&&i.call(arguments,1);return a[t]=!0,r(function(){a[t]&&(n?e.apply(null,n):e.call(null),l.clearImmediate(t));}),t},l.clearImmediate="function"==typeof t?t:function(e){delete a[e];};}).call(this,u(43).setImmediate,u(43).clearImmediate);},{25:25,43:43}],44:[function(e,t,n){(function(n){function r(e){try{if(!n.localStorage)return}catch(e){return}var t=n.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}t.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0;}return e.apply(this,arguments)}};}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});},{}],45:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var a=r(e(46)),h=r(e(54)),i=r(e(47)),o=1,p=2,g=3,_=4,E=5;function s(e){e=e||{};var t,n=this.context,s=(0, a.default)(n).getInstance(),u=e.settings,l=[],d=void 0,f=void 0,c=void 0;function r(e){return e&&e.bind?e.bind(window.console):window.console.log.bind(window.console)}function i(e,t){var n="",r=null;d&&(r=(new Date).getTime(),n+="["+(r-c)+"]"),f&&t&&t.getClassName&&(n+="["+t.getClassName()+"]",t.getType&&(n+="["+t.getType()+"]")),0<n.length&&(n+=" ");for(var i=arguments.length,a=Array(2<i?i-2:0),o=2;o<i;o++)a[o-2]=arguments[o];Array.apply(null,a).forEach(function(e){n+=e+" ";}),l[e]&&u.get().debug.logLevel>=e&&l[e](n),s.trigger(h.default.LOG,{message:n,level:e});}return t={getLogger:function(e){return {fatal:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];i.apply(void 0,[o,this].concat(t));}.bind(e),error:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];i.apply(void 0,[p,this].concat(t));}.bind(e),warn:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];i.apply(void 0,[g,this].concat(t));}.bind(e),info:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];i.apply(void 0,[_,this].concat(t));}.bind(e),debug:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];i.apply(void 0,[E,this].concat(t));}.bind(e)}},setLogTimestampVisible:function(e){d=e;},setCalleeNameVisible:function(e){f=e;}},f=d=!0,c=(new Date).getTime(),"undefined"!=typeof window&&window.console&&(l[o]=r(window.console.error),l[p]=r(window.console.error),l[g]=r(window.console.warn),l[_]=r(window.console.info),l[E]=r(window.console.debug)),t}s.__dashjs_factory_name="Debug";var u=i.default.getSingletonFactory(s);u.LOG_LEVEL_NONE=0,u.LOG_LEVEL_FATAL=o,u.LOG_LEVEL_ERROR=p,u.LOG_LEVEL_WARNING=g,u.LOG_LEVEL_INFO=_,u.LOG_LEVEL_DEBUG=E,i.default.updateSingletonFactory(s.__dashjs_factory_name,u),n.default=u,t.exports=n.default;},{46:46,47:47,54:54}],46:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(47),a=(r=i)&&r.__esModule?r:{default:r};function o(){var a={};function o(e,n,r){var i=-1;return a[e]&&a[e].some(function(e,t){if(e&&e.callback===n&&(!r||r===e.scope))return i=t,!0}),i}return {on:function(n,e,t){var r,i=arguments.length<=3||void 0===arguments[3]?0:arguments[3];if(!n)throw new Error("event type cannot be null or undefined");if(!e||"function"!=typeof e)throw new Error("listener must be a function: "+e);0<=o(n,e,t)||(a[n]=a[n]||[],r={callback:e,scope:t,priority:i},a[n].some(function(e,t){if(e&&i>e.priority)return a[n].splice(t,0,r),!0})||a[n].push(r));},off:function(e,t,n){var r;e&&t&&a[e]&&((r=o(e,t,n))<0||(a[e][r]=null));},trigger:function(e,t){if(e&&a[e]){if((t=t||{}).hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");t.type=e,a[e]=a[e].filter(function(e){return e}),a[e].forEach(function(e){return e&&e.callback.call(e.scope,t)});}},reset:function(){a={};}}}o.__dashjs_factory_name="EventBus";var s=a.default.getSingletonFactory(o);s.EVENT_PRIORITY_LOW=0,s.EVENT_PRIORITY_HIGH=5e3,a.default.updateSingletonFactory(o.__dashjs_factory_name,s),n.default=s,t.exports=n.default;},{47:47}],47:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var u,a,r,i,o=(u=void 0,a=[],r={},i={},u={extend:function(e,t,n,r){!r[e]&&t&&(r[e]={instance:t,override:n});},getSingletonInstance:s,setSingletonInstance:function(e,t,n){for(var r in a){var i=a[r];if(i.context===e&&i.name===t)return void(a[r].instance=n)}a.push({name:t,context:e,instance:n});},getSingletonFactory:function(n){var e=l(n.__dashjs_factory_name,r);return e||(e=function(e){var t=void 0;return void 0===e&&(e={}),{getInstance:function(){return (t=t||s(e,n.__dashjs_factory_name))||(t=f(n,e,arguments),a.push({name:n.__dashjs_factory_name,context:e,instance:t})),t}}},r[n.__dashjs_factory_name]=e),e},getSingletonFactoryByName:function(e){return l(e,r)},updateSingletonFactory:function(e,t){d(e,t,r);},getClassFactory:function(t){var e=l(t.__dashjs_factory_name,i);return e||(e=function(e){return void 0===e&&(e={}),{create:function(){return f(t,e,arguments)}}},i[t.__dashjs_factory_name]=e),e},getClassFactoryByName:function(e){return l(e,i)},updateClassFactory:function(e,t){d(e,t,i);}});function s(e,t){for(var n in a){var r=a[n];if(r.context===e&&r.name===t)return r.instance}return null}function l(e,t){return t[e]}function d(e,t,n){e in n&&(n[e]=t);}function f(e,t,n){var r=void 0,i=e.__dashjs_factory_name,a=t[i];if(a){var o=a.instance;if(!a.override)return o.apply({context:t,factory:u},n);for(var s in r=e.apply({context:t},n),o=o.apply({context:t,factory:u,parent:r},n))r.hasOwnProperty(s)&&(r[s]=o[s]);}else r=e.apply({context:t},n);return r.getClassName=function(){return i},r}n.default=o,t.exports=n.default;},{}],48:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0});var a=r(e(47)),o=r(e(49)),s=r(e(45)),u=r(e(108)),l=e(241);function d(){var e,t,n={debug:{logLevel:s.default.LOG_LEVEL_WARNING},streaming:{metricsMaxListDepth:1e3,abandonLoadTimeout:1e4,liveDelayFragmentCount:NaN,liveDelay:null,scheduleWhilePaused:!0,fastSwitchEnabled:!1,bufferPruningInterval:10,bufferToKeep:20,bufferAheadToKeep:80,jumpGaps:!0,smallGapLimit:1.5,stableBufferTime:12,bufferTimeAtTopQuality:30,bufferTimeAtTopQualityLongForm:60,longFormContentDurationThreshold:600,wallclockTimeUpdateInterval:50,lowLatencyEnabled:!1,keepProtectionMediaKeys:!1,useManifestDateHeaderTimeSource:!0,useSuggestedPresentationDelay:!0,useAppendWindowEnd:!0,manifestUpdateRetryInterval:100,liveCatchUpMinDrift:.02,liveCatchUpMaxDrift:0,liveCatchUpPlaybackRate:.5,liveCatchupLatencyThreshold:NaN,lastBitrateCachingInfo:{enabled:!0,ttl:36e4},lastMediaSettingsCachingInfo:{enabled:!0,ttl:36e4},cacheLoadThresholds:{video:50,audio:5},retryIntervals:(i(e={},l.HTTPRequest.MPD_TYPE,500),i(e,l.HTTPRequest.XLINK_EXPANSION_TYPE,500),i(e,l.HTTPRequest.MEDIA_SEGMENT_TYPE,1e3),i(e,l.HTTPRequest.INIT_SEGMENT_TYPE,1e3),i(e,l.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,1e3),i(e,l.HTTPRequest.INDEX_SEGMENT_TYPE,1e3),i(e,l.HTTPRequest.OTHER_TYPE,1e3),i(e,"lowLatencyReductionFactor",10),e),retryAttempts:(i(t={},l.HTTPRequest.MPD_TYPE,3),i(t,l.HTTPRequest.XLINK_EXPANSION_TYPE,1),i(t,l.HTTPRequest.MEDIA_SEGMENT_TYPE,3),i(t,l.HTTPRequest.INIT_SEGMENT_TYPE,3),i(t,l.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,3),i(t,l.HTTPRequest.INDEX_SEGMENT_TYPE,3),i(t,l.HTTPRequest.OTHER_TYPE,3),i(t,"lowLatencyMultiplyFactor",5),t),abr:{movingAverageMethod:u.default.MOVING_AVERAGE_SLIDING_WINDOW,ABRStrategy:u.default.ABR_STRATEGY_DYNAMIC,bandwidthSafetyFactor:.9,useDefaultABRRules:!0,useBufferOccupancyABR:!1,useDeadTimeLatency:!0,limitBitrateByPortal:!1,usePixelRatioInLimitBitrateByPortal:!1,maxBitrate:{audio:-1,video:-1},minBitrate:{audio:-1,video:-1},maxRepresentationRatio:{audio:1,video:1},initialBitrate:{audio:-1,video:-1},initialRepresentationRatio:{audio:-1,video:-1},autoSwitchBitrate:{audio:!0,video:!0}},cmcd:{enabled:!1,sid:null,cid:null,did:null}}},r=o.default.clone(n);return {get:function(){return r},update:function(e){"object"==typeof e&&!function e(t,n,r){for(var i in t)t.hasOwnProperty(i)&&n.hasOwnProperty(i)&&("object"==typeof t[i]&&null!==t[i]?e(t[i],n[i],r.slice()+i+"."):n[i]=o.default.clone(t[i]));}(e,r,"");},reset:function(){r=o.default.clone(n);}}}d.__dashjs_factory_name="Settings";var f=a.default.getSingletonFactory(d);n.default=f,t.exports=n.default;},{108:108,241:241,45:45,47:47,49:49}],49:[function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}Object.defineProperty(n,"__esModule",{value:!0});var i=(function(e,t,n){return n&&r(e,n),e}(o,null,[{key:"mixin",value:function(e,t,n){var r=void 0,i={};if(e)for(var a in t)t.hasOwnProperty(a)&&(r=t[a],a in e&&(e[a]===r||a in i&&i[a]===r)||("object"==typeof e[a]&&null!==e[a]?e[a]=o.mixin(e[a],r,n):e[a]=n(r)));return e}},{key:"clone",value:function(e){if(!e||"object"!=typeof e)return e;var t=void 0;if(e instanceof Array){t=[];for(var n=0,r=e.length;n<r;++n)n in e&&t.push(o.clone(e[n]));}else t={};return o.mixin(t,e,o.clone)}},{key:"addAditionalQueryParameterToUrl",value:function(n,e){try{var t=function(){if(!e||0===e.length)return {v:n};var t=new URL(n);return e.forEach(function(e){e.key&&e.value&&t.searchParams.set(e.key,e.value);}),{v:t.href}}();if("object"==typeof t)return t.v}catch(e){return n}}},{key:"generateUuid",value:function(){var n=(new Date).getTime();return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"==e?t:3&t|8).toString(16)})}},{key:"generateHashCode",value:function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t}}]),o);function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);}n.default=i,t.exports=n.default;},{}],50:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getVersionString=function(){return r};var r="3.1.2";},{}],51:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n,r=!1;null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0;}};var i,a=e(52);function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r(Object.getPrototypeOf(o.prototype),"constructor",this).call(this),this.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE=10,this.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE=11,this.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE=12,this.SEGMENTS_UPDATE_FAILED_ERROR_CODE=13,this.SEGMENTS_UNAVAILABLE_ERROR_CODE=14,this.SEGMENT_BASE_LOADER_ERROR_CODE=15,this.TIME_SYNC_FAILED_ERROR_CODE=16,this.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE=17,this.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE=18,this.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=19,this.APPEND_ERROR_CODE=20,this.REMOVE_ERROR_CODE=21,this.DATA_UPDATE_FAILED_ERROR_CODE=22,this.CAPABILITY_MEDIASOURCE_ERROR_CODE=23,this.CAPABILITY_MEDIAKEYS_ERROR_CODE=24,this.DOWNLOAD_ERROR_ID_MANIFEST_CODE=25,this.DOWNLOAD_ERROR_ID_SIDX_CODE=26,this.DOWNLOAD_ERROR_ID_CONTENT_CODE=27,this.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE=28,this.DOWNLOAD_ERROR_ID_XLINK_CODE=29,this.MANIFEST_ERROR_ID_CODEC_CODE=30,this.MANIFEST_ERROR_ID_PARSE_CODE=31,this.MANIFEST_ERROR_ID_NOSTREAMS_CODE=32,this.TIMED_TEXT_ERROR_ID_PARSE_CODE=33,this.MANIFEST_ERROR_ID_MULTIPLEXED_CODE=34,this.MEDIASOURCE_TYPE_UNSUPPORTED_CODE=35,this.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE="parsing failed for ",this.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading manifest: ",this.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading Xlink element: ",this.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE="Segments update failed",this.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE="no segments are available yet",this.SEGMENT_BASE_LOADER_ERROR_MESSAGE="error loading segments",this.TIME_SYNC_FAILED_ERROR_MESSAGE="Failed to synchronize time",this.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE="request is null",this.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL",this.APPEND_ERROR_MESSAGE="chunk is not defined",this.REMOVE_ERROR_MESSAGE="buffer is not defined",this.DATA_UPDATE_FAILED_ERROR_MESSAGE="Data update failed",this.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE="mediasource is not supported",this.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE="mediakeys is not supported",this.TIMED_TEXT_ERROR_MESSAGE_PARSE="parsing error :",this.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE="Error creating source buffer of type : ";}var s=new(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);}(o,((i=a)&&i.__esModule?i:{default:i}).default),o);n.default=s,t.exports=n.default;},{52:52}],52:[function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}Object.defineProperty(n,"__esModule",{value:!0});var i=(function(e,t,n){return t&&r(e.prototype,t),e}(a,[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!n||r&&-1===e[i].indexOf("public_")||(this[i]=e[i]);}}}]),a);function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);}n.default=i,t.exports=n.default;},{}],53:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n,r=!1;null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0;}};var i,a=e(55),o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);}(s,((i=a)&&i.__esModule?i:{default:i}).default),s);function s(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),r(Object.getPrototypeOf(s.prototype),"constructor",this).call(this),this.BUFFERING_COMPLETED="bufferingCompleted",this.BUFFER_CLEARED="bufferCleared",this.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",this.BYTES_APPENDED="bytesAppended",this.BYTES_APPENDED_END_FRAGMENT="bytesAppendedEndFragment",this.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",this.CURRENT_TRACK_CHANGED="currentTrackChanged",this.DATA_UPDATE_COMPLETED="dataUpdateCompleted",this.DATA_UPDATE_STARTED="dataUpdateStarted",this.INBAND_EVENTS="inbandEvents",this.INITIALIZATION_LOADED="initializationLoaded",this.INIT_FRAGMENT_LOADED="initFragmentLoaded",this.INIT_FRAGMENT_NEEDED="initFragmentNeeded",this.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",this.ORIGINAL_MANIFEST_LOADED="originalManifestLoaded",this.LIVE_EDGE_SEARCH_COMPLETED="liveEdgeSearchCompleted",this.LOADING_COMPLETED="loadingCompleted",this.LOADING_PROGRESS="loadingProgress",this.LOADING_DATA_PROGRESS="loadingDataProgress",this.LOADING_ABANDONED="loadingAborted",this.MANIFEST_UPDATED="manifestUpdated",this.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",this.MEDIA_FRAGMENT_NEEDED="mediaFragmentNeeded",this.QUOTA_EXCEEDED="quotaExceeded",this.REPRESENTATION_UPDATE_STARTED="representationUpdateStarted",this.REPRESENTATION_UPDATE_COMPLETED="representationUpdateCompleted",this.SEGMENTS_LOADED="segmentsLoaded",this.SERVICE_LOCATION_BLACKLIST_ADD="serviceLocationBlacklistAdd",this.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",this.SOURCEBUFFER_REMOVE_COMPLETED="sourceBufferRemoveCompleted",this.STREAMS_COMPOSED="streamsComposed",this.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",this.STREAM_COMPLETED="streamCompleted",this.TEXT_TRACKS_QUEUE_INITIALIZED="textTracksQueueInitialized",this.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",this.URL_RESOLUTION_FAILED="urlResolutionFailed",this.VIDEO_CHUNK_RECEIVED="videoChunkReceived",this.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",this.XLINK_ELEMENT_LOADED="xlinkElementLoaded",this.XLINK_READY="xlinkReady",this.SEGMENTBASE_INIT_REQUEST_NEEDED="segmentBaseInitRequestNeeded",this.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED="segmentBaseSegmentsListRequestNeeded",this.SEEK_TARGET="seekTarget",this.DYNAMIC_STREAM_COMPLETED="dynamicStreamCompleted";}n.default=o,t.exports=n.default;},{55:55}],54:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n,r=!1;null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0;}};var i,a=e(53);function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r(Object.getPrototypeOf(o.prototype),"constructor",this).apply(this,arguments);}var s=new(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);}(o,((i=a)&&i.__esModule?i:{default:i}).default),o);n.default=s,t.exports=n.default;},{53:53}],55:[function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}Object.defineProperty(n,"__esModule",{value:!0});var i=(function(e,t,n){return t&&r(e.prototype,t),e}(a,[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!n||r&&-1===e[i].indexOf("public_")||(this[i]=e[i]);}}}]),a);function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);}n.default=i,t.exports=n.default;},{}],56:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var h=r(e(61)),p=r(e(93)),g=r(e(89)),_=r(e(95)),E=r(e(88)),D=r(e(86)),i=r(e(47)),M=r(e(65));function a(){var e,m=void 0,v=void 0,y=void 0,u=void 0,T=void 0,i=void 0,t=this.context;function o(e,t,n){var r,i=m.getAdaptationsForType(v[0].mpd.manifest,e,t);if(!i||0===i.length)return null;if(1<i.length&&n){var a=l(n,t);if(u[n.id]&&u[n.id][t])for(var o=0,s=i.length;o<s;o++)if(u[n.id][t].isMediaInfoEqual(a[o]))return i[o];for(o=0,s=i.length;o<s;o++)if(r=i[o],m.getRolesForAdaptation(r).filter(function(e){return e.value===h.default.MAIN})[0])return i[o]}return i[0]}function l(e,t,n){var r,i=v,a=n,o=[],s=void 0,u=void 0,l=void 0,d=void 0,f=void 0,c=void 0;if(a)b(),i=S(a);else {if(!(0<v.length))return o;a=v[0].mpd.manifest;}var h=A(e,i);h&&(c=h.id);var p=m.getAdaptationsForType(a,e?e.index:null,t!==T.EMBEDDED_TEXT?t:T.VIDEO);if(!p||0===p.length)return o;for(y[c]=y[c]||m.getAdaptationsForPeriod(h),d=0,r=p.length;d<r;d++)if(s=p[d],l=m.getIndexForAdaptation(s,a,e.index),u=I(y[c][l]),t===T.EMBEDDED_TEXT){for(var g=u.accessibility.length,f=0;f<g;f++)if(u){var _=u.accessibility[f];if(0===_.indexOf("cea-608:")){var E=_.substring(8).split(";");if("CC"===E[0].substring(0,2))for(f=0;f<E.length;f++)R(u=u||I.call(this,y[c][l]),E[f].substring(0,3),E[f].substring(4)),o.push(u),u=null;else for(f=0;f<E.length;f++)R(u=u||I.call(this,y[c][l]),"CC"+(f+1),E[f]),o.push(u),u=null;}else 0===_.indexOf("cea-608")&&(R(u,T.CC1,"eng"),o.push(u),u=null);}}else t===T.IMAGE?(u.type=T.IMAGE,o.push(u),u=null):u&&o.push(u);return o}function S(e){var t=n(e);return m.getRegularPeriods(t)}function n(e){var t=a(e);return m.getMpd(t)}function r(){v=[],y={},u={};}function a(e){return e||(0<v.length?v[0].mpd.manifest:null)}function s(e){return e&&e.streamInfo&&void 0!==e.streamInfo.id&&y[e.streamInfo.id]?y[e.streamInfo.id][e.index]:null}function A(e,t){for(var n=t.length,r=0;r<n;r++){var i=t[r];if(e&&e.id===i.id)return i}return null}function I(e){if(!e)return null;var t,r=new g.default,n=e.period.mpd.manifest.Period_asArray[e.period.index].AdaptationSet_asArray[e.index];return r.id=e.id,r.index=e.index,r.type=e.type,r.streamInfo=d(e.period),r.representationCount=m.getRepresentationCount(n),r.labels=m.getLabelsForAdaptation(n),r.lang=m.getLanguageForAdaptation(n),t=m.getViewpointForAdaptation(n),r.viewpoint=t?t.value:void 0,r.accessibility=m.getAccessibilityForAdaptation(n).map(function(e){var t=e.value,n=t;return e.schemeIdUri&&0<=e.schemeIdUri.search("cea-608")&&void 0!==i&&(n=t?"cea-608:"+t:"cea-608",r.embeddedCaptions=!0),n}),r.audioChannelConfiguration=m.getAudioChannelConfigurationForAdaptation(n).map(function(e){return e.value}),0===r.audioChannelConfiguration.length&&Array.isArray(n.Representation_asArray)&&0<n.Representation_asArray.length&&(r.audioChannelConfiguration=m.getAudioChannelConfigurationForRepresentation(n.Representation_asArray[0]).map(function(e){return e.value})),r.roles=m.getRolesForAdaptation(n).map(function(e){return e.value}),r.codec=m.getCodec(n),r.mimeType=m.getMimeType(n),r.contentProtection=m.getContentProtectionData(n),r.bitrateList=m.getBitrateListForAdaptation(n),r.contentProtection&&r.contentProtection.forEach(function(e){e.KID=m.getKID(e);}),r.isText=m.getIsTextTrack(r.mimeType),r.supplementalProperties=m.getSupplementalPropperties(n),r}function R(e,t,n){e.id=t,e.index=100+parseInt(t.substring(2,3)),e.type=T.EMBEDDED_TEXT,e.codec="cea-608-in-SEI",e.isText=!0,e.isEmbedded=!0,e.lang=n,e.roles=["caption"];}function d(e){var t,n,r=new _.default;return r.id=e.id,r.index=e.index,r.start=e.start,r.duration=e.duration,r.manifestInfo=(t=e.mpd,(n=new E.default).DVRWindowSize=t.timeShiftBufferDepth,n.loadedTime=t.manifest.loadedTime,n.availableFrom=t.availabilityStartTime,n.minBufferTime=t.manifest.minBufferTime,n.maxFragmentDuration=t.maxSegmentDuration,n.duration=m.getDuration(t.manifest),n.isDynamic=m.getIsDynamic(t.manifest),n.serviceDescriptions=m.getServiceDescriptions(t.manifest),n.protocol=t.manifest.protocol,n),r.isLast=1===e.mpd.manifest.Period_asArray.length||Math.abs(r.start+r.duration-r.manifestInfo.duration)<1,r}function b(){if(!T)throw new Error("setConfig function has to be called previously")}function f(e){return 0<v.length?v[0].mpd.manifest.Period_asArray[e]:null}function c(e,t,n){var r=void 0,i=void 0,a=void 0,o=void 0,s=void 0;if(e)for(r=e.AdaptationSet_asArray,o=0;o<r.length;o+=1)for(a=r[o].Representation_asArray,s=0;s<a.length;s+=1)if(t===(i=a[s]).id)return n?s:i;return null}return e={getBandwidthForRepresentation:function(e,t){var n;return (n=c(f(t),e))?n.bandwidth:null},getIndexForRepresentation:function(e,t){var n,r=f(t);return null!==(n=c(r,e,!0))?n:-1},getMaxIndexForBufferType:function(e,t){return function(e,t){var n,r=void 0,i=void 0,a=void 0;if(!e||!t)return -1;for(n=e.AdaptationSet_asArray,a=0;a<n.length;a+=1)if(r=n[a],i=r.Representation_asArray,m.getIsTypeOf(r,t))return i.length;return -1}(f(t),e)},convertDataToRepresentationInfo:function(e){if(e){var t=new p.default,n=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],r=m.getRepresentationFor(e.index,n);return t.id=e.id,t.quality=e.index,t.bandwidth=m.getBandwidth(r),t.DVRWindow=e.segmentAvailabilityRange,t.fragmentDuration=e.segmentDuration||(e.segments&&0<e.segments.length?e.segments[0].duration:NaN),t.MSETimeOffset=e.MSETimeOffset,t.useCalculatedLiveEdgeTime=e.useCalculatedLiveEdgeTime,t.mediaInfo=I(e.adaptation),t}return null},getDataForMedia:s,getStreamsInfo:function(e,t){var n=[],r=v;if(e&&(b(),r=S(e)),0<r.length){(!t||t>r.length)&&(t=r.length);for(var i=0;i<t;i++)n.push(d(r[i]));}return n},getMediaInfoForType:function(e,t){if(0===v.length||!e)return null;var n=A(e,v);if(!n)return null;var r=n.id;y[r]=y[r]||m.getAdaptationsForPeriod(n);var i=o(e.index,t,e);if(!i)return null;var a=m.getIndexForAdaptation(i,v[0].mpd.manifest,e.index);return I(y[r][a])},getAllMediaInfoForType:l,getAdaptationForType:o,getRealAdaptation:function(e,t){var n=void 0,r=A(e,v),i=t?t.id:null;return 0<v.length&&r&&(n=i?m.getAdaptationForId(i,v[0].mpd.manifest,r.index):m.getAdaptationForIndex(t?t.index:null,v[0].mpd.manifest,r.index)),n},getVoRepresentations:function(e){var t=s(e);return m.getRepresentationsForAdaptation(t)},getEventsFor:function(e,t){var n,r=[];return 0<v.length&&(n=v[0].mpd.manifest,e instanceof _.default?r=m.getEventsForPeriod(A(e,v)):e instanceof g.default?r=m.getEventStreamForAdaptationSet(n,s(e)):e instanceof p.default&&(r=m.getEventStreamForRepresentation(n,t))),r},getEvent:function(e,t,n){if(!e||!t)return null;var r=new D.default,i=e.scheme_id_uri,a=e.value,o=e.timescale,s=e.presentation_time_delta,u=e.event_duration,l=e.id,d=e.message_data,f=n*o+s;return t[i+"/"+a]?(r.eventStream=t[i+"/"+a],r.eventStream.value=a,r.eventStream.timescale=o,r.duration=u,r.id=l,r.calculatedPresentationTime=f,r.messageData=d,r.presentationTimeDelta=s,r):null},setConfig:function(e){e&&(e.constants&&(T=e.constants),e.cea608parser&&(i=e.cea608parser),e.errHandler&&m.setConfig({errHandler:e.errHandler}),e.BASE64&&m.setConfig({BASE64:e.BASE64}));},updatePeriods:function(e){if(!e)return null;b(),v=S(e),y={};},getUseCalculatedLiveEdgeTimeForMediaInfo:function(e){var t=s(e);return m.getUseCalculatedLiveEdgeTimeForAdaptation(t)},getIsTextTrack:function(e){return m.getIsTextTrack(e)},getUTCTimingSources:function(){var e=a();return m.getUTCTimingSources(e)},getSuggestedPresentationDelay:function(){var e=0<v.length?v[0].mpd:null;return m.getSuggestedPresentationDelay(e)},getAvailabilityStartTime:function(e){var t=n(e);return m.getAvailabilityStartTime(t)},getIsDynamic:function(e){var t=a(e);return m.getIsDynamic(t)},getDuration:function(e){var t=a(e);return m.getDuration(t)},getRegularPeriods:S,getLocation:function(e){return m.getLocation(e)},getManifestUpdatePeriod:function(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return m.getManifestUpdatePeriod(e,t)},getIsDVB:function(e){return m.hasProfile(e,"urn:dvb:dash:profile:dvb-dash:2014")},getBaseURLsFromElement:function(e){return m.getBaseURLsFromElement(e)},getRepresentationSortFunction:function(){return m.getRepresentationSortFunction()},getCodec:function(e,t,n){return m.getCodec(e,t,n)},getVoAdaptations:function(){return y},getVoPeriods:function(){return v},setCurrentMediaInfo:function(e,t,n){u[e]=u[e]||{},u[e][t]=u[e][t]||{},u[e][t]=n;},reset:r},m=(0, M.default)(t).getInstance(),r(),e}a.__dashjs_factory_name="DashAdapter",n.default=i.default.getSingletonFactory(a),t.exports=n.default;},{47:47,61:61,65:65,86:86,88:88,89:89,93:93,95:95}],57:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var w=r(e(227)),P=e(241),i=r(e(47)),L=e(80),x=r(e(64));function a(e){e=e||{};var t=this.context,f=e.eventBus,c=e.events,n=e.debug,l=e.dashConstants,o=e.urlUtils,h=e.type,r=e.streamInfo,p=e.timelineConverter,g=e.dashMetrics,s=e.baseURLController,i=void 0,d=void 0,_=void 0,E=void 0,m=void 0,a=void 0,v=void 0,u=void 0,y=void 0,T=void 0;function S(){return h}function A(){_=-1,E=null;}function I(){A(),a=0,y=T=m=null;}function R(e,t,n){var r=s.resolve(n.path),i=void 0,a=void 0;return r&&t!==r.url&&o.isRelative(t)?(i=r.url,a=r.serviceLocation,t&&(i=o.resolve(t,i))):i=t,!o.isRelative(i)&&(e.url=i,e.serviceLocation=a,1)}function b(e){var t,n,r;e.sender.getType()===h&&(t=e.representation,n=t.hasInitialization(),r=t.hasSegments(),n&&r?f.trigger(c.REPRESENTATION_UPDATE_COMPLETED,{sender:i,representation:t}):T.update(t,h,y,n,r));}function D(e,t){if(null==t)return null;var n=new w.default,r=t.representation,i=r.adaptation.period.mpd.manifest.Period_asArray[r.adaptation.period.index].AdaptationSet_asArray[r.adaptation.index].Representation_asArray[r.index].bandwidth,a=t.media,a=(0, L.replaceTokenForTemplate)(a,"Number",t.replacementNumber);return a=(0, L.replaceTokenForTemplate)(a,"Time",t.replacementTime),a=(0, L.replaceTokenForTemplate)(a,"Bandwidth",i),a=(0, L.replaceIDForTemplate)(a,r.id),a=(0, L.unescapeDollarsInTemplate)(a),n.mediaType=h,n.type=P.HTTPRequest.MEDIA_SEGMENT_TYPE,n.range=t.mediaRange,n.startTime=t.presentationStartTime,n.duration=t.duration,n.timescale=r.timescale,n.availabilityStartTime=t.availabilityStartTime,n.availabilityEndTime=t.availabilityEndTime,n.wallStartTime=t.wallStartTime,n.quality=r.index,n.index=t.availabilityIdx,n.mediaInfo=e,n.adaptationIndex=r.adaptation.index,n.representationId=r.id,R(n,a,r)?n:void 0}function M(e){var t,n,r=!1;return e&&(v?u?r=!0:E&&(t=parseFloat((E.presentationStartTime-e.adaptation.period.start).toFixed(5)),n=0<E.duration?t+1.5*E.duration:t,r=e.adaptation.period.duration<=n):_>=e.availableSegmentsNumber&&(r=!0)),r}function N(e){var t=e.representation;t.segments&&f.trigger(c.REPRESENTATION_UPDATE_COMPLETED,{sender:this,representation:t});}function C(e){if(!e.error&&h===e.mediaType){for(var t,n,r=e.segments,i=e.representation,a=[],o=0,s=void 0,u=void 0,l=void 0,s=0,d=r?r.length:0;s<d;s++)u=r[s],(l=(0, L.getTimeBasedSegment)(p,v,i,u.startTime,u.duration,u.timescale,u.media,u.mediaRange,o))&&(a.push(l),l=null,o++);0<a.length&&(i.segmentAvailabilityRange={start:a[0].presentationStartTime,end:a[a.length-1].presentationStartTime},i.availableSegmentsNumber=a.length,i.segments=a,v&&(t=a[a.length-1].presentationStartTime-8,n=t,p.setExpectedLiveEdge(n),g.updateManifestUpdateInfo({presentationStartTime:n}))),i.hasInitialization()&&f.trigger(c.REPRESENTATION_UPDATE_COMPLETED,{sender:this,representation:i});}}function O(){d.debug("Dynamic stream complete"),u=!0;}return i={initialize:function(e){v=e,u=!1,T.initialize(e);},getType:S,getStreamInfo:function(){return r},getInitRequest:function(e,t){return t?function(e,t,n){var r=new w.default,i=t.adaptation.period,a=i.start;if(r.mediaType=n,r.type=P.HTTPRequest.INIT_SEGMENT_TYPE,r.range=t.range,r.availabilityStartTime=p.calcAvailabilityStartTimeFromPresentationTime(a,i.mpd,v),r.availabilityEndTime=p.calcAvailabilityEndTimeFromPresentationTime(a+i.duration,i.mpd,v),r.quality=t.index,r.mediaInfo=e,r.representationId=t.id,R(r,t.initialization,t))return r.url=(0, L.replaceTokenForTemplate)(r.url,"Bandwidth",t.bandwidth),r}(e,t,h):null},getRequestForSegment:D,getSegmentRequestForTime:function(e,t,n,r){var i=null;if(!t||!t.segmentInfoType)return i;var a=_,o=!!r&&r.keepIdx,s=!(!r||!r.ignoreIsFinished);m!==n&&(m=n,d.debug("Getting the request for time : "+n));var u=T.getSegmentByTime(t,n);return u?(_=u.availabilityIdx,E=u,d.debug("Index for time "+n+" is "+_),i=D(e,u)):!s&&M(t)&&((i=new w.default).action=w.default.ACTION_COMPLETE,i.index=_-1,i.mediaType=h,i.mediaInfo=e,d.debug("Signal complete in getSegmentRequestForTime")),o&&0<=a&&(_=t.segmentInfoType===l.SEGMENT_TIMELINE&&v?_:a),i},getNextSegmentRequest:function(e,t){var n=null;if(!t||!t.segmentInfoType)return null;m=null;var r=_+1;d.debug("Getting the next request at index: "+r);var i=T.getSegmentByIndex(t,r,E?E.mediaStartTime:-1);return i||isFinite(t.adaptation.period.duration)||u?(_=i?(n=D(e,i),i.availabilityIdx):v?r-1:r,i?E=i:M(t)&&((n=new w.default).action=w.default.ACTION_COMPLETE,n.index=_-1,n.mediaType=h,n.mediaInfo=e,d.debug("Signal complete")),n):(d.debug("No segment found at index: "+r+". Wait for next loop"),null)},setCurrentTime:function(e){a=e;},getCurrentTime:function(){return a},setCurrentIndex:function(e){_=e;},getCurrentIndex:function(){return _},isMediaFinished:M,reset:function(){I(),f.off(c.INITIALIZATION_LOADED,N,i),f.off(c.SEGMENTS_LOADED,C,i),f.off(c.REPRESENTATION_UPDATE_STARTED,b,i),f.off(c.DYNAMIC_STREAM_COMPLETED,O,i);},resetIndex:A,setMimeType:function(e){y=e;}},d=n.getLogger(i),I(),T=(0, x.default)(t).create(e),f.on(c.INITIALIZATION_LOADED,N,i),f.on(c.SEGMENTS_LOADED,C,i),f.on(c.REPRESENTATION_UPDATE_STARTED,b,i),f.on(c.DYNAMIC_STREAM_COMPLETED,O,i),i}a.__dashjs_factory_name="DashHandler",n.default=i.default.getClassFactory(a),t.exports=n.default;},{227:227,241:241,47:47,64:64,80:80}],58:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var f=r(e(108)),c=e(241),i=r(e(47)),h=r(e(109)),p=r(e(78)),g=r(e(152)),_=e(243);function a(e){e=e||{};var t,n=this.context,i=void 0,a=void 0,o=void 0,s=e.metricsModel;function u(e){var t=s.getMetricsFor(e,!0);if(!t)return null;var n=t.HttpList,r=null,i=void 0;if(!n||n.length<=0)return null;for(i=n.length-1;0<=i;){if(n[i].responsecode){r=n[i];break}i--;}return r}function l(e){var t=s.getMetricsFor(e,!0);return t&&t.HttpList?t.HttpList:[]}function r(e,t){if(!e)return null;var n=e[t];return n&&0!==n.length?n[n.length-1]:null}function d(e){var t={};if(!e)return t;for(var n=e.trim().split("\r\n"),r=0,i=n.length;r<i;r++){var a=n[r],o=a.indexOf(": ");0<o&&(t[a.substring(0,o)]=a.substring(o+2));}return t}return t={getCurrentRepresentationSwitch:function(e){return r(s.getMetricsFor(e,!0),h.default.TRACK_SWITCH)},getCurrentBufferState:function(e){return r(s.getMetricsFor(e,!0),h.default.BUFFER_STATE)},getCurrentBufferLevel:function(e){var t=r(s.getMetricsFor(e,!0),h.default.BUFFER_LEVEL);return t?p.default.round10(t.level/1e3,-3):0},getCurrentHttpRequest:u,getHttpRequests:l,getCurrentDroppedFrames:function(){return r(s.getMetricsFor(f.default.VIDEO,!0),h.default.DROPPED_FRAMES)},getCurrentSchedulingInfo:function(e){return r(s.getMetricsFor(e,!0),h.default.SCHEDULING_INFO)},getCurrentDVRInfo:function(e){return r(e?s.getMetricsFor(e,!0):s.getMetricsFor(f.default.VIDEO,!0)||s.getMetricsFor(f.default.AUDIO,!0),h.default.DVR_INFO)},getCurrentManifestUpdate:function(){return r(s.getMetricsFor(f.default.STREAM),h.default.MANIFEST_UPDATE)},getLatestFragmentRequestHeaderValueByID:function(e,t){var n={},r=u(e);return r&&(n=d(r._responseHeaders)),void 0===n[t]?null:n[t]},getLatestMPDRequestHeaderValueByID:function(e){for(var t,n={},r=void 0,i=void 0,i=(t=l(f.default.STREAM)).length-1;0<=i;i--)if((r=t[i]).type===c.HTTPRequest.MPD_TYPE){n=d(r._responseHeaders);break}return void 0===n[e]?null:n[e]},addRepresentationSwitch:function(e,t,n,r,i){s.addRepresentationSwitch(e,t,n,r,i);},addDVRInfo:function(e,t,n,r){s.addDVRInfo(e,t,n,r);},updateManifestUpdateInfo:function(e){var t=this.getCurrentManifestUpdate();s.updateManifestUpdateInfo(t,e);},addManifestUpdateStreamInfo:function(e){var t;e&&(t=this.getCurrentManifestUpdate(),s.addManifestUpdateStreamInfo(t,e.id,e.index,e.start,e.duration));},addManifestUpdateRepresentationInfo:function(e,t){var n;e&&(n=this.getCurrentManifestUpdate(),s.addManifestUpdateRepresentationInfo(n,e.id,e.index,e.streamIndex,t,e.presentationTimeOffset,e.startNumber,e.fragmentInfoType));},addManifestUpdate:function(e){s.addManifestUpdate(f.default.STREAM,e.type,e.requestStartDate,e.requestEndDate);},addHttpRequest:function(e,t,n,r,i){s.addHttpRequest(e.mediaType,null,e.type,e.url,e.quality,t,e.serviceLocation||null,e.range||null,e.requestStartDate,e.firstByteDate,e.requestEndDate,n,e.duration,r,i);},addSchedulingInfo:function(e,t){s.addSchedulingInfo(e.mediaType,new Date,e.type,e.startTime,e.availabilityStartTime,e.duration,e.quality,e.range,t);},addRequestsQueue:function(e,t,n){s.addRequestsQueue(e,t,n);},addBufferLevel:function(e,t,n){s.addBufferLevel(e,t,n);},addBufferState:function(e,t,n){s.addBufferState(e,t,n);},addDroppedFrames:function(e){s.addDroppedFrames(f.default.VIDEO,e);},addPlayList:function(){o&&(s.addPlayList(o),o=null);},addDVBErrors:function(e){s.addDVBErrors(e);},createPlaylistMetrics:function(e,t){(o=new _.PlayList).start=new Date,o.mstart=e,o.starttype=t;},createPlaylistTraceMetrics:function(e,t,n){!0===i&&(i=!1,(a=new _.PlayListTrace).representationid=e,a.start=new Date,a.mstart=t,a.playbackspeed=null!==n?n.toString():null);},updatePlayListTraceMetrics:function(e){if(a)for(var t in a)a[t]=e[t];},pushPlayListTraceMetrics:function(e,t){var n,r;!1===i&&o&&a&&a.start&&(n=a.start,r=e.getTime()-n.getTime(),a.duration=r,a.stopreason=t,o.trace.push(a),i=!0);},clearAllCurrentMetrics:function(){s.clearAllCurrentMetrics();}},s=s||(0, g.default)(n).getInstance({settings:e.settings}),i=!0,o=a=null,t}a.__dashjs_factory_name="DashMetrics",n.default=i.default.getSingletonFactory(a),t.exports=n.default;},{108:108,109:109,152:152,241:241,243:243,47:47,78:78}],59:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var y=r(e(94)),T=r(e(225)),i=r(e(47)),S=r(e(227)),A=r(e(158));function a(){var e=this.context,t=void 0,g=void 0,n=void 0,s=void 0,r=void 0,i=void 0,a=void 0,o=void 0,u=void 0,l=void 0,d=void 0,f=void 0,c=void 0,h=void 0,p=void 0,_=void 0;function E(){if(!_||!_.hasOwnProperty("resolve"))throw new Error("setConfig function has to be called previously")}function m(e){if(e.url){var t=new S.default;return t.setInfo(e),t}}function v(e,t,n){e?d.trigger(l.SEGMENTS_LOADED,{segments:e,representation:t,mediaType:n}):d.trigger(l.SEGMENTS_LOADED,{segments:null,representation:t,mediaType:n,error:new T.default(f.SEGMENT_BASE_LOADER_ERROR_CODE,f.SEGMENT_BASE_LOADER_ERROR_MESSAGE)});}return t={setConfig:function(e){e.baseURLController&&(_=e.baseURLController),e.dashMetrics&&(i=e.dashMetrics),e.mediaPlayerModel&&(o=e.mediaPlayerModel),e.errHandler&&(n=e.errHandler),e.settings&&(a=e.settings),e.boxParser&&(s=e.boxParser),e.events&&(l=e.events),e.eventBus&&(d=e.eventBus),e.debug&&(g=e.debug.getLogger(t)),e.requestModifier&&(r=e.requestModifier),e.errors&&(f=e.errors),e.urlUtils&&(p=e.urlUtils),e.constants&&(c=e.constants),e.dashConstants&&(h=e.dashConstants);},initialize:function(){u=(0, A.default)(e).create({errHandler:n,dashMetrics:i,mediaPlayerModel:o,requestModifier:r,useFetch:a?a.get().streaming.lowLatencyEnabled:null,boxParser:s,errors:f,urlUtils:p,constants:c,dashConstants:h});},loadInitialization:function t(n,e){E();var r=null,i=n?_.resolve(n.path):null,a=e||{init:!0,url:i?i.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500,mediaType:n&&n.adaptation?n.adaptation.type:null};g.debug("Start searching for initialization.");var o=m(a);u.load({request:o,success:function(e){a.bytesLoaded=a.range.end,(r=s.findInitRange(e))?(n.range=r,d.trigger(l.INITIALIZATION_LOADED,{representation:n})):(a.range.end=a.bytesLoaded+a.bytesToLoad,t(n,a));},error:function(){d.trigger(l.INITIALIZATION_LOADED,{representation:n});}}),g.debug("Perform init search: "+a.url);},loadSegments:function l(d,f,e,c,t){var n;E(),!e||void 0!==e.start&&void 0!==e.end||(e=(n=e?e.toString().split("-"):null)?{start:parseFloat(n[0]),end:parseFloat(n[1])}:null),c=c||v;var o=null,h=null,r=!!e,i=d?_.resolve(d.path):null,p={init:!1,url:i?i.url:void 0,range:r?e:{start:0,end:1500},searching:!r,bytesLoaded:t?t.bytesLoaded:0,bytesToLoad:1500,mediaType:d&&d.adaptation?d.adaptation.type:null},a=m(p);u.load({request:a,success:function(e){var t=p.bytesToLoad,n=e.byteLength;if(p.bytesLoaded=p.range.end-p.range.start,o=s.parse(e),(h=o.getBox("sidx"))&&h.isComplete){var u=h.references,r=void 0,i=void 0;null!=u&&0<u.length&&(r=1===u[0].reference_type),r?function(){g.debug("Initiate multiple SIDX load."),p.range.end=p.range.start+h.size;for(var e=void 0,t=void 0,n=void 0,r=void 0,i=[],a=0,o=(h.offset||p.range.start)+h.size,s=function(e){e?(i=i.concat(e),t<=++a&&(i.sort(function(e,t){return e.startTime-t.startTime<0?-1:0}),c(i,d,f))):c(null,d,f);},e=0,t=u.length;e<t;e++)r=(n=o)+u[e].referenced_size-1,o+=u[e].referenced_size,l(d,null,{start:n,end:r},s,p);}():(g.debug("Parsing segments from SIDX. representation "+d.adaptation.type+" - id: "+d.id+" for range : "+p.range.start+" - "+p.range.end),i=function(e,t){for(var n=e.references,r=n.length,i=e.timescale,a=e.earliest_presentation_time,o=t.range.start+e.offset+e.first_offset+e.size,s=[],u=void 0,l=void 0,d=void 0,f=void 0,c=0;c<r;c++)d=n[c].subsegment_duration,f=n[c].referenced_size,(u=new y.default).duration=d,u.startTime=a,u.timescale=i,l=o+f-1,u.mediaRange=o+"-"+l,s.push(u),a+=d,o+=f;return s}(h,p),c(i,d,f));}else {if(h)p.range.start=h.offset||p.range.start,p.range.end=p.range.start+(h.size||t);else {if(n<p.bytesLoaded)return void c(null,d,f);var a=o.getLastBox();a&&a.size?(p.range.start=a.offset+a.size,p.range.end=p.range.start+t):p.range.end+=t;}l(d,f,p.range,c,p);}},error:function(){c(null,d,f);}}),g.debug("Perform SIDX load: "+p.url+" with range : "+p.range.start+" - "+p.range.end);},reset:function(){u.abort(),r=s=n=u=null;}}}a.__dashjs_factory_name="SegmentBaseLoader",n.default=i.default.getSingletonFactory(a),t.exports=n.default;},{158:158,225:225,227:227,47:47,94:94}],60:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var y=r(e(211)),h=r(e(108)),i=r(e(47)),T=r(e(94)),S=r(e(227)),A=r(e(158)),I=r(e(225));function a(){var p=this.context,t=void 0,g=void 0,_=void 0,n=void 0,r=void 0,i=void 0,a=void 0,E=void 0,o=void 0,s=void 0,u=void 0,l=void 0,d=void 0;function m(e,t,n,r){for(var i,a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,d=void 0,o=[],u=0,f=(i=function(e){var t=[],n=(0, y.default)(p).create({data:e}),r=void 0,i=void 0;for(n.consumeTagAndSize(_.Segment.Cues);n.moreData()&&n.consumeTagAndSize(_.Segment.Cues.CuePoint,!0);){for((r={}).CueTime=n.parseTag(_.Segment.Cues.CuePoint.CueTime),r.CueTracks=[];n.moreData()&&n.consumeTag(_.Segment.Cues.CuePoint.CueTrackPositions,!0);){var a=n.getMatroskaCodedNum(),o=n.getPos();if((i={}).Track=n.parseTag(_.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),0===i.Track)throw new Error("Cue track cannot be 0");i.ClusterPosition=n.parseTag(_.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),r.CueTracks.push(i),n.setPos(o+a);}if(0===r.CueTracks.length)throw new Error("Mandatory cuetrack not found");t.push(r);}if(0===t.length)throw new Error("mandatory cuepoint not found");return t}(e)).length;u<f;u+=1)s=new T.default,a=0,a=u<i.length-1?i[u+1].CueTime-i[u].CueTime:r-i[u].CueTime,s.duration=a,s.startTime=i[u].CueTime,s.timescale=1e3,l=i[u].CueTracks[0].ClusterPosition+t,d=u<i.length-1?i[u+1].CueTracks[0].ClusterPosition+t-1:n-1,s.mediaRange=l+"-"+d,o.push(s);return g.debug("Parsed cues: "+o.length+" cues."),o}function f(){if(!d||!d.hasOwnProperty("resolve"))throw new Error("setConfig function has to be called previously")}function c(e,t,n){e?s.trigger(u.SEGMENTS_LOADED,{segments:e,representation:t,mediaType:n}):s.trigger(u.SEGMENTS_LOADED,{segments:null,representation:t,mediaType:n,error:new I.default(l.SEGMENT_BASE_LOADER_ERROR_CODE,l.SEGMENT_BASE_LOADER_ERROR_MESSAGE)});}function v(e){var t=new S.default;return t.setInfo(e),t}return t={setConfig:function(e){if(!(e.baseURLController&&e.dashMetrics&&e.mediaPlayerModel&&e.errHandler))throw new Error(h.default.MISSING_CONFIG_ERROR);d=e.baseURLController,i=e.dashMetrics,a=e.mediaPlayerModel,n=e.errHandler,o=e.settings,u=e.events,s=e.eventBus,l=e.errors,g=e.debug.getLogger(t),r=e.requestModifier;},initialize:function(){E=(0, A.default)(p).create({errHandler:n,dashMetrics:i,mediaPlayerModel:a,requestModifier:r,useFetch:o?o.get().streaming.lowLatencyEnabled:null,errors:l});},loadInitialization:function(e,t){f();var n=null,r=e?d.resolve(e.path):null,i=e?e.range.split("-"):null,a=t||{range:{start:i?parseFloat(i[0]):null,end:i?parseFloat(i[1]):null},request:n,url:r?r.url:void 0,init:!0,mediaType:e&&e.adaptation?e.adaptation.type:null};g.info("Start loading initialization."),n=v(a),E.load({request:n,success:function(){s.trigger(u.INITIALIZATION_LOADED,{representation:e});},error:function(){s.trigger(u.INITIALIZATION_LOADED,{representation:e});}}),g.debug("Perform init load: "+a.url);},loadSegments:function(t,n,r,i){f();var e=null,a=t?d.resolve(t.path):null,o=a?a.url:void 0,s={bytesLoaded:0,bytesToLoad:8192,range:{start:0,end:8192},request:e,url:o,init:!1,mediaType:t&&t.adaptation?t.adaptation.type:null};i=i||c,e=v(s),g.debug("Parsing ebml header"),E.load({request:e,success:function(e){!function(e,t,n,r){if(e&&0!==e.byteLength){var i,a,o=(0, y.default)(p).create({data:e}),s=void 0,u=void 0,l=n?n.split("-"):null,d=null,f={url:t,range:{start:l?parseFloat(l[0]):null,end:l?parseFloat(l[1]):null},request:d};for(g.debug("Parse EBML header: "+f.url),o.skipOverElement(_.EBML),o.consumeTag(_.Segment),i=o.getMatroskaCodedNum(),i+=o.getPos(),a=o.getPos();o.moreData()&&!o.consumeTagAndSize(_.Segment.Info,!0);)if(!(o.skipOverElement(_.Segment.SeekHead,!0)||o.skipOverElement(_.Segment.Tracks,!0)||o.skipOverElement(_.Segment.Cues,!0)||o.skipOverElement(_.Void,!0)))throw new Error("no valid top level element found");for(;void 0===s;){var c=o.getMatroskaCodedNum(!0),h=o.getMatroskaCodedNum();switch(c){case _.Segment.Info.Duration.tag:s=o[_.Segment.Info.Duration.parse](h);break;default:o.setPos(o.getPos()+h);}}d=v(f);E.load({request:d,success:function(e){u=m(e,a,i,s),r(u);},error:function(){g.error("Download Error: Cues "+f.url),r(null);}}),g.debug("Perform cues load: "+f.url+" bytes="+f.range.start+"-"+f.range.end);}else r(null);}(e,o,r,function(e){i(e,t,n);});},error:function(){i(null,t,n);}});},reset:function(){r=n=null;}},_={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"}}}}},Void:{tag:236,required:!0}},t}a.__dashjs_factory_name="WebmSegmentBaseLoader",n.default=i.default.getSingletonFactory(a),t.exports=n.default;},{108:108,158:158,211:211,225:225,227:227,47:47,94:94}],61:[function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.init();}Object.defineProperty(n,"__esModule",{value:!0});var a=new(function(e,t,n){return t&&r(e.prototype,t),e}(i,[{key:"init",value:function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.INBAND_EVENT_STREAM="InbandEventStream",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.ROLE_ASARRAY="Role_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.STATIC="static",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.AVAILABILITY_TIME_OFFSET="availabilityTimeOffset",this.AVAILABILITY_TIME_COMPLETE="availabilityTimeComplete",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SERVICE_DESCRIPTION="ServiceDescription",this.SERVICE_DESCRIPTION_SCOPE="Scope",this.SERVICE_DESCRIPTION_LATENCY="Latency",this.SERVICE_DESCRIPTION_PLAYBACK_RATE="PlaybackRate";}}]),i);n.default=a,t.exports=n.default;},{}],62:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var w=r(e(108)),P=r(e(225)),i=r(e(47));function a(e){var i=(e=e||{}).eventBus,a=e.events,l=e.errors,d=e.abrController,f=e.dashMetrics,c=e.playbackController,r=e.timelineConverter,h=e.type,p=e.streamId,g=e.dashConstants,o=void 0,s=void 0,_=void 0,E=void 0,m=void 0;function u(){if(!(d&&f&&c&&r))throw new Error(w.default.MISSING_CONFIG_ERROR)}function t(){return _}function n(){return m}function v(){_=!(s=null),E=[];}function y(){return h}function T(){u();var e=new Date,t=m,n=1e3*c.getTime();t&&f.addRepresentationSwitch(t.adaptation.type,e,n,t.id);}function S(e){return null==e||e>=E.length?null:E[e]}function A(e,t){var n;e.segmentAvailabilityRange=r.calcSegmentAvailabilityRange(e,t),e.segmentAvailabilityRange.end<e.segmentAvailabilityRange.start&&!e.useCalculatedLiveEdgeTime?b(new P.default(l.SEGMENTS_UNAVAILABLE_ERROR_CODE,l.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE,{availabilityDelay:e.segmentAvailabilityRange.start-e.segmentAvailabilityRange.end})):t&&(n=e.segmentAvailabilityRange.end,r.setExpectedLiveEdge(n),f.updateManifestUpdateInfo({presentationStartTime:n}));}function I(e,t){u();for(var n=0,r=E.length;n<r;n++)A(E[n],e),t&&i.trigger(a.REPRESENTATION_UPDATE_STARTED,{sender:o,representation:E[n]});}function R(){_=!0,i.trigger(a.DATA_UPDATE_STARTED,{sender:o});}function b(e){_=!1;var t={sender:o,data:s,currentRepresentation:m};e&&(t.error=e),i.trigger(a.DATA_UPDATE_COMPLETED,t);}function D(e){var t=e;i.trigger(a.AST_IN_FUTURE,{delay:t}),setTimeout(function(){_||(R(),E.forEach(function(e){e.segmentAvailabilityRange=null;}),I(c.getIsDynamic(),!0));},t);}function M(e){if(e.sender.getType()===h&&e.sender.getStreamInfo().id===p&&_)if(e.error)b(e.error);else {var t,n=e.sender.getStreamInfo(),r=e.representation,i=f.getCurrentManifestUpdate(),a=!1,o=0,s=void 0;if(r.adaptation.period.mpd.manifest.type!==g.DYNAMIC||r.adaptation.period.mpd.manifest.ignorePostponeTimePeriod||(o=function(e,t){try{var n=c.getStreamController().getActiveStreamInfo(),r=e.segmentAvailabilityRange.start;n&&n.id&&n.id!==t.id&&(r=Math.min(c.getTime(),r));var i=e.segmentAvailabilityRange.end-r;return 1e3*(c.getLiveDelay()-i)}catch(e){return 0}}(r,n)),0<o)return D(o),void b(new P.default(l.SEGMENTS_UPDATE_FAILED_ERROR_CODE,l.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE));if(i){for(var u=0;u<i.representationInfo.length;u++)if((s=i.representationInfo[u]).index===r.index&&s.mediaType===h){a=!0;break}a||f.addManifestUpdateRepresentationInfo(r,h);}!function(){for(var e=0,t=E.length;e<t;e++){var n=E[e].segmentInfoType;if(null===E[e].segmentAvailabilityRange||!E[e].hasInitialization()||(n===g.SEGMENT_BASE||n===g.BASE_URL)&&!E[e].segments)return}return 1}()||(d.setPlaybackQuality(h,n,(t=m,E.indexOf(t))),f.updateManifestUpdateInfo({latency:m.segmentAvailabilityRange.end-c.getTime()}),f.getCurrentRepresentationSwitch(m.adaptation.type)||T(),b());}}function N(e){e.isDynamic&&I(e.isDynamic);}function C(e){e.mediaType===h&&p===e.streamInfo.id&&(m=S(e.newQuality),T());}function O(e){e.newDuration&&m&&m.adaptation.period&&(m.adaptation.period.duration=e.newDuration);}return o={getData:function(){return s},isUpdating:t,updateData:function(e,t,n,r){u(),R(),E=t,m=S(r),s=e,n===w.default.VIDEO||n===w.default.AUDIO||n===w.default.FRAGMENTED_TEXT?I(c.getIsDynamic(),!0):b();},updateRepresentation:A,getCurrentRepresentation:n,getRepresentationForQuality:S,getType:y,getStreamId:function(){return p},reset:function(){i.off(a.QUALITY_CHANGE_REQUESTED,C,o),i.off(a.REPRESENTATION_UPDATE_COMPLETED,M,o),i.off(a.WALLCLOCK_TIME_UPDATED,N,o),i.off(a.MANIFEST_VALIDITY_CHANGED,O,o),v();}},v(),i.on(a.QUALITY_CHANGE_REQUESTED,C,o),i.on(a.REPRESENTATION_UPDATE_COMPLETED,M,o),i.on(a.WALLCLOCK_TIME_UPDATED,N,o),i.on(a.MANIFEST_VALIDITY_CHANGED,O,o),o}a.__dashjs_factory_name="RepresentationController",n.default=i.default.getClassFactory(a),t.exports=n.default;},{108:108,225:225,47:47}],63:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),m=r(e(59)),v=r(e(60));function a(e){e=e||{};var t=this.context,n=e.eventBus,r=e.events,i=e.dashMetrics,a=e.mediaPlayerModel,o=e.errHandler,s=e.baseURLController,u=e.debug,l=e.boxParser,d=e.requestModifier,f=e.errors,c=void 0,h=void 0,p=void 0;function g(e){return "webm"===(e?e.split("/")[1]:"").toLowerCase()}function _(e){g(e.mimeType)?p.loadInitialization(e.representation):h.loadInitialization(e.representation);}function E(e){g(e.mimeType)?p.loadSegments(e.representation,e.mediaType,e.representation?e.representation.indexRange:null,e.callback):h.loadSegments(e.representation,e.mediaType,e.representation?e.representation.indexRange:null,e.callback);}return c={initialize:function(){n.on(r.SEGMENTBASE_INIT_REQUEST_NEEDED,_,c),n.on(r.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,E,c),h.initialize(),p.initialize();},reset:function(){n.off(r.SEGMENTBASE_INIT_REQUEST_NEEDED,_,c),n.off(r.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,E,c);}},h=(0, m.default)(t).getInstance(),p=(0, v.default)(t).getInstance(),h.setConfig({baseURLController:s,dashMetrics:i,mediaPlayerModel:a,errHandler:o,eventBus:n,events:r,errors:f,debug:u,boxParser:l,requestModifier:d}),p.setConfig({baseURLController:s,dashMetrics:i,mediaPlayerModel:a,errHandler:o,eventBus:n,events:r,errors:f,debug:u,requestModifier:d}),c}a.__dashjs_factory_name="SegmentBaseController";var o=i.default.getSingletonFactory(a);n.default=o,t.exports=n.default;},{47:47,59:59,60:60}],64:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),u=r(e(83)),l=r(e(81)),d=r(e(77)),f=r(e(79));function a(t){t=t||{};var e,n=this.context,a=t.events,o=t.eventBus,r=t.dashConstants,i=void 0;function s(e){return e?e.segments?i[r.SEGMENT_BASE]:i[e.segmentInfoType]:null}return e={initialize:function(e){i[r.SEGMENT_TIMELINE]=(0, u.default)(n).create(t,e),i[r.SEGMENT_TEMPLATE]=(0, l.default)(n).create(t,e),i[r.SEGMENT_LIST]=(0, d.default)(n).create(t,e),i[r.SEGMENT_BASE]=(0, f.default)(n).create(t,e);},update:function(e,t,n,r,i){r||o.trigger(a.SEGMENTBASE_INIT_REQUEST_NEEDED,{mimeType:n,representation:e}),i||o.trigger(a.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,{mimeType:n,mediaType:t,representation:e});},getSegmentByIndex:function(e,t,n){var r=s(e);return r?r.getSegmentByIndex(e,t,n):null},getSegmentByTime:function(e,t){var n=s(e);return n?n.getSegmentByTime(e,t):null}},i={},e}a.__dashjs_factory_name="SegmentsController";var o=i.default.getClassFactory(a);n.default=o,t.exports=n.default;},{47:47,77:77,79:79,81:81,83:83}],65:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var g=r(e(108)),S=r(e(61)),A=r(e(92)),I=r(e(84)),R=r(e(91)),i=r(e(90)),b=r(e(96)),D=r(e(86)),M=r(e(85)),N=r(e(87)),C=r(e(216)),O=r(e(220)),a=r(e(47)),w=r(e(45)),P=r(e(225)),L=r(e(51)),x=e(204);function o(){var e=void 0,l=void 0,d=void 0,f=void 0,a=this.context,o=(0, O.default)(a).getInstance(),_=Number.isInteger||function(e){return "number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function s(e,t){var n=void 0,r=void 0,i=void 0,a=void 0,o=void 0,s=void 0,u=!1,l=!1;if(!e)throw new Error("adaptation is not defined");if(!t)throw new Error("type is not defined");if(e.hasOwnProperty("ContentComponent_asArray")&&(a=e.ContentComponent_asArray),o=t!==g.default.TEXT?new RegExp(t):new RegExp("(vtt|ttml)"),e.Representation_asArray&&e.Representation_asArray.length&&0<e.Representation_asArray.length){var d=m(e.Representation_asArray[0]);if(d&&0<d.length&&0<=x.THUMBNAILS_SCHEME_ID_URIS.indexOf(d[0].schemeIdUri))return t===g.default.IMAGE;if(e.Representation_asArray[0].hasOwnProperty(S.default.CODECS)&&(0===(s=e.Representation_asArray[0].codecs).search(g.default.STPP)||0===s.search(g.default.WVTT)))return t===g.default.FRAGMENTED_TEXT}if(a){if(1<a.length)return t===g.default.MUXED;a[0]&&a[0].contentType===t&&(l=u=!0);}if(e.hasOwnProperty(S.default.MIME_TYPE)&&(u=o.test(e.mimeType),l=!0),!l)for(n=0,r=e.Representation_asArray&&e.Representation_asArray.length?e.Representation_asArray.length:0;!l&&n<r;)(i=e.Representation_asArray[n]).hasOwnProperty(S.default.MIME_TYPE)&&(u=o.test(i.mimeType),l=!0),n++;return u}function E(e){return "text/vtt"===e||"application/ttml+xml"===e}function t(){return function(e,t){return e.bandwidth-t.bandwidth}}function u(e){return e&&Array.isArray(e.Representation_asArray)&&e.Representation_asArray.sort(t()),e}function c(e,t){return e&&e.Period_asArray&&_(t)&&e.Period_asArray[t]?e.Period_asArray[t].AdaptationSet_asArray:[]}function h(e){var t=!1;return e&&e.hasOwnProperty("type")&&(t=e.type===S.default.DYNAMIC),t}function m(e){return e&&e.EssentialProperty_asArray&&e.EssentialProperty_asArray.length?e.EssentialProperty_asArray.map(function(e){return {schemeIdUri:e.schemeIdUri,value:e.value}}):null}function v(e){if(e&&e.period&&_(e.period.index)){var t=e.period.mpd.manifest.Period_asArray[e.period.index];if(t&&t.AdaptationSet_asArray&&_(e.index))return u(t.AdaptationSet_asArray[e.index])}}function y(e){var t=e.S_asArray[e.S_asArray.length-1];return !t.hasOwnProperty("r")||0<=t.r}function p(e,t){var n=[],r=void 0;if(!e)return n;for(r=0;r<e.length;r++){var i=new N.default;if(i.timescale=1,i.representation=t,!e[r].hasOwnProperty(g.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");i.schemeIdUri=e[r].schemeIdUri,e[r].hasOwnProperty(S.default.TIMESCALE)&&(i.timescale=e[r].timescale),e[r].hasOwnProperty(S.default.VALUE)&&(i.value=e[r].value),n.push(i);}return n}function T(r){var i=[],e=r.BaseURL_asArray||[r.baseUri],a=!1;return e.some(function(e){if(e){var t=new M.default,n=e.__text||e;return o.isRelative(n)&&(a=!0,r.baseUri&&(n=o.resolve(n,r.baseUri))),t.url=n,e.hasOwnProperty(S.default.SERVICE_LOCATION)&&e.serviceLocation.length?t.serviceLocation=e.serviceLocation:t.serviceLocation=n,e.hasOwnProperty(S.default.DVB_PRIORITY)&&(t.dvb_priority=e[S.default.DVB_PRIORITY]),e.hasOwnProperty(S.default.DVB_WEIGHT)&&(t.dvb_weight=e[S.default.DVB_WEIGHT]),e.hasOwnProperty(S.default.AVAILABILITY_TIME_OFFSET)&&(t.availabilityTimeOffset=e[S.default.AVAILABILITY_TIME_OFFSET]),e.hasOwnProperty(S.default.AVAILABILITY_TIME_COMPLETE)&&(t.availabilityTimeComplete="false"!==e[S.default.AVAILABILITY_TIME_COMPLETE]),i.push(t),a}}),i}return e={getIsTypeOf:s,getIsTextTrack:E,getLanguageForAdaptation:function(e){var t="";return e&&e.hasOwnProperty(S.default.LANG)&&(t=e.lang.replace(/[^A-Za-z0-9-]/g,"")),t},getViewpointForAdaptation:function(e){return e&&e.hasOwnProperty(S.default.VIEWPOINT)?e.Viewpoint:null},getRolesForAdaptation:function(e){return e&&e.hasOwnProperty(S.default.ROLE_ASARRAY)?e.Role_asArray:[]},getAccessibilityForAdaptation:function(e){return e&&e.hasOwnProperty(S.default.ACCESSIBILITY_ASARRAY)?e.Accessibility_asArray:[]},getAudioChannelConfigurationForAdaptation:function(e){return e&&e.hasOwnProperty(S.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?e.AudioChannelConfiguration_asArray:[]},getAudioChannelConfigurationForRepresentation:function(e){return e&&e.hasOwnProperty(S.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?e.AudioChannelConfiguration_asArray:[]},getAdaptationForIndex:function(e,t,n){var r=c(t,n);return 0<r.length&&_(e)?r[e]:null},getIndexForAdaptation:function(e,t,n){if(!e)return -1;for(var r=c(t,n),i=0;i<r.length;i++){if((0, C.default)(a).getInstance().areEqual(r[i],e))return i}return -1},getAdaptationForId:function(e,t,n){for(var r=c(t,n),i=void 0,i=0,a=r.length;i<a;i++)if(r[i].hasOwnProperty(S.default.ID)&&r[i].id===e)return r[i];return null},getAdaptationsForType:function(e,t,n){for(var r=c(e,t),i=void 0,a=[],i=0,o=r.length;i<o;i++)s(r[i],n)&&a.push(u(r[i]));return a},getCodec:function(e,t,n){var r,i=null;return e&&e.Representation_asArray&&0<e.Representation_asArray.length&&((r=_(t)&&0<=t&&t<e.Representation_asArray.length?e.Representation_asArray[t]:e.Representation_asArray[0])&&(i=r.mimeType+';codecs="'+r.codecs+'"',n&&void 0!==r.width&&(i+=';width="'+r.width+'";height="'+r.height+'"'))),i=i&&i.replace(/\sprofiles=[^;]*/g,"")},getMimeType:function(e){return e&&e.Representation_asArray&&0<e.Representation_asArray.length?e.Representation_asArray[0].mimeType:null},getKID:function(e){return e&&e.hasOwnProperty(S.default.CENC_DEFAULT_KID)?e[S.default.CENC_DEFAULT_KID]:null},getLabelsForAdaptation:function(e){if(!e||!Array.isArray(e.Label_asArray))return [];for(var t=[],n=0;n<e.Label_asArray.length;n++)t.push({lang:e.Label_asArray[n].lang,text:e.Label_asArray[n].__text||e.Label_asArray[n]});return t},getContentProtectionData:function(e){return e&&e.hasOwnProperty(S.default.CONTENTPROTECTION_ASARRAY)&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null},getIsDynamic:h,hasProfile:function(e,t){var n=!1;return e&&e.profiles&&0<e.profiles.length&&(n=-1!==e.profiles.indexOf(t)),n},getDuration:function(e){return e&&e.hasOwnProperty(S.default.MEDIA_PRESENTATION_DURATION)?e.mediaPresentationDuration:e&&"dynamic"==e.type?Number.POSITIVE_INFINITY:Number.MAX_SAFE_INTEGER||Number.MAX_VALUE},getBandwidth:function(e){return e&&e.bandwidth?e.bandwidth:NaN},getManifestUpdatePeriod:function(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=NaN;return e&&e.hasOwnProperty(S.default.MINIMUM_UPDATE_PERIOD)&&(n=e.minimumUpdatePeriod),isNaN(n)?n:Math.max(n-t,1)},getRepresentationCount:function(e){return e&&Array.isArray(e.Representation_asArray)?e.Representation_asArray.length:0},getBitrateListForAdaptation:function(e){var t=u(e);return (t&&Array.isArray(t.Representation_asArray)?t.Representation_asArray:[]).map(function(e){return {bandwidth:e.bandwidth,width:e.width||0,height:e.height||0,scanType:e.scanType||null,id:e.id||null}})},getRepresentationFor:function(e,t){return t&&t.Representation_asArray&&0<t.Representation_asArray.length&&_(e)?t.Representation_asArray[e]:null},getRepresentationsForAdaptation:function(e){var t,n,r,i,a,o,s=[],u=v(e),l=void 0,d=void 0;if(u&&u.Representation_asArray){e&&e.period&&_(e.period.index)&&((t=T(e.period.mpd.manifest))&&(d=t[0]));for(var f=0,c=u.Representation_asArray.length;f<c;++f){var h,p=u.Representation_asArray[f],g=new A.default;g.index=f,g.adaptation=e,p.hasOwnProperty(S.default.ID)&&(g.id=p.id),p.hasOwnProperty(S.default.CODECS)&&(g.codecs=p.codecs),p.hasOwnProperty(S.default.CODEC_PRIVATE_DATA)&&(g.codecPrivateData=p.codecPrivateData),p.hasOwnProperty(S.default.BANDWITH)&&(g.bandwidth=p.bandwidth),p.hasOwnProperty(S.default.WIDTH)&&(g.width=p.width),p.hasOwnProperty(S.default.HEIGHT)&&(g.height=p.height),p.hasOwnProperty(S.default.SCAN_TYPE)&&(g.scanType=p.scanType),p.hasOwnProperty(S.default.MAX_PLAYOUT_RATE)&&(g.maxPlayoutRate=p.maxPlayoutRate),p.hasOwnProperty(S.default.SEGMENT_BASE)?(l=p.SegmentBase,g.segmentInfoType=S.default.SEGMENT_BASE):p.hasOwnProperty(S.default.SEGMENT_LIST)?(l=p.SegmentList).hasOwnProperty(S.default.SEGMENT_TIMELINE)?(g.segmentInfoType=S.default.SEGMENT_TIMELINE,g.useCalculatedLiveEdgeTime=y(l.SegmentTimeline)):(g.segmentInfoType=S.default.SEGMENT_LIST,g.useCalculatedLiveEdgeTime=!0):p.hasOwnProperty(S.default.SEGMENT_TEMPLATE)?((l=p.SegmentTemplate).hasOwnProperty(S.default.SEGMENT_TIMELINE)?(g.segmentInfoType=S.default.SEGMENT_TIMELINE,g.useCalculatedLiveEdgeTime=y(l.SegmentTimeline)):g.segmentInfoType=S.default.SEGMENT_TEMPLATE,l.hasOwnProperty(S.default.INITIALIZATION_MINUS)&&(g.initialization=l.initialization.split("$Bandwidth$").join(p.bandwidth).split("$RepresentationID$").join(p.id))):g.segmentInfoType=S.default.BASE_URL,g.essentialProperties=m(p),l&&(l.hasOwnProperty(S.default.INITIALIZATION)?((h=l.Initialization).hasOwnProperty(S.default.SOURCE_URL)&&(g.initialization=h.sourceURL),h.hasOwnProperty(S.default.RANGE)&&(g.range=h.range)):p.hasOwnProperty(S.default.MIME_TYPE)&&E(p.mimeType)&&(g.range=0),l.hasOwnProperty(S.default.TIMESCALE)&&(g.timescale=l.timescale),l.hasOwnProperty(S.default.DURATION)?g.segmentDuration=l.duration/g.timescale:p.hasOwnProperty(S.default.SEGMENT_TEMPLATE)&&(l=p.SegmentTemplate).hasOwnProperty(S.default.SEGMENT_TIMELINE)&&(g.segmentDuration=(i=l.SegmentTimeline,a=void 0,a=i.S_asArray[0],o=i.S_asArray[1],(a.hasOwnProperty("d")?a.d:o.t-a.t)/g.timescale)),l.hasOwnProperty(S.default.MEDIA)&&(g.media=l.media),l.hasOwnProperty(S.default.START_NUMBER)&&(g.startNumber=l.startNumber),l.hasOwnProperty(S.default.INDEX_RANGE)&&(g.indexRange=l.indexRange),l.hasOwnProperty(S.default.PRESENTATION_TIME_OFFSET)&&(g.presentationTimeOffset=l.presentationTimeOffset/g.timescale),l.hasOwnProperty(S.default.AVAILABILITY_TIME_OFFSET)?g.availabilityTimeOffset=l.availabilityTimeOffset:d&&void 0!==d.availabilityTimeOffset&&(g.availabilityTimeOffset=d.availabilityTimeOffset),l.hasOwnProperty(S.default.AVAILABILITY_TIME_COMPLETE)?g.availabilityTimeComplete="false"!==l.availabilityTimeComplete:d&&void 0!==d.availabilityTimeComplete&&(g.availabilityTimeComplete=d.availabilityTimeComplete)),g.MSETimeOffset=(r=(n=g).presentationTimeOffset,n.adaptation.period.start-r),g.path=[e.period.index,e.index,f],s.push(g);}}return s},getAdaptationsForPeriod:function(e){var t=e&&_(e.index)?e.mpd.manifest.Period_asArray[e.index]:null,n=[],r=void 0,i=void 0,a=void 0;if(t&&t.AdaptationSet_asArray)for(a=0;a<t.AdaptationSet_asArray.length;a++)i=t.AdaptationSet_asArray[a],r=new I.default,i.hasOwnProperty(S.default.ID)&&(r.id=i.id),r.index=a,r.period=e,s(i,g.default.MUXED)?r.type=g.default.MUXED:s(i,g.default.AUDIO)?r.type=g.default.AUDIO:s(i,g.default.VIDEO)?r.type=g.default.VIDEO:s(i,g.default.FRAGMENTED_TEXT)?r.type=g.default.FRAGMENTED_TEXT:s(i,g.default.IMAGE)?r.type=g.default.IMAGE:r.type=g.default.TEXT,n.push(r);return n},getRegularPeriods:function(e){for(var t=!!e&&h(e.manifest),n=[],r=null,i=null,a=null,o=null,s=void 0,s=0,u=e&&e.manifest&&e.manifest.Period_asArray?e.manifest.Period_asArray.length:0;s<u;s++)(i=e.manifest.Period_asArray[s]).hasOwnProperty(S.default.START)?(o=new R.default).start=i.start:null!==r&&r.hasOwnProperty(S.default.DURATION)&&null!==a?(o=new R.default).start=parseFloat((a.start+a.duration).toFixed(5)):0!==s||t||((o=new R.default).start=0),null!==a&&isNaN(a.duration)&&(null!==o?a.duration=parseFloat((o.start-a.start).toFixed(5)):l.warn("First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback")),null!==o&&(o.id=function(e,t){if(!e)throw new Error("Period cannot be null or undefined");var n=R.default.DEFAULT_ID+"_"+t;e.hasOwnProperty(S.default.ID)&&0<e.id.length&&"__proto__"!==e.id&&(n=e.id);return n}(i,s),o.index=s,o.mpd=e,i.hasOwnProperty(S.default.DURATION)&&(o.duration=i.duration),n.push(o),r=i,a=o),o=i=null;return 0===n.length||null!==a&&isNaN(a.duration)&&(a.duration=parseFloat((function(e){!function(){if(!d||!d.hasOwnProperty("error"))throw new Error(g.default.MISSING_CONFIG_ERROR)}();var t=h(e.mpd.manifest),n=void 0;e.mpd.manifest.mediaPresentationDuration?n=e.mpd.manifest.mediaPresentationDuration:e.duration?n=e.duration:t?n=Number.POSITIVE_INFINITY:d.error(new P.default(L.default.MANIFEST_ERROR_ID_PARSE_CODE,"Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.",e));return n}(a)-a.start).toFixed(5))),n},getMpd:function(e){var t=new i.default;return e&&((t.manifest=e).hasOwnProperty(S.default.AVAILABILITY_START_TIME)?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):e.loadedTime&&(t.availabilityStartTime=new Date(e.loadedTime.getTime())),e.hasOwnProperty(S.default.AVAILABILITY_END_TIME)&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty(S.default.MINIMUM_UPDATE_PERIOD)&&(t.minimumUpdatePeriod=e.minimumUpdatePeriod),e.hasOwnProperty(S.default.MEDIA_PRESENTATION_DURATION)&&(t.mediaPresentationDuration=e.mediaPresentationDuration),e.hasOwnProperty(S.default.SUGGESTED_PRESENTATION_DELAY)&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty(S.default.TIMESHIFT_BUFFER_DEPTH)&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty(S.default.MAX_SEGMENT_DURATION)&&(t.maxSegmentDuration=e.maxSegmentDuration)),t},getEventsForPeriod:function(e){var t=e&&e.mpd&&e.mpd.manifest?e.mpd.manifest:null,n=t?t.Period_asArray:null,r=n&&e&&_(e.index)?n[e.index].EventStream_asArray:null,i=[],a=void 0,o=void 0;if(r)for(a=0;a<r.length;a++){var s=new N.default;if(s.period=e,s.timescale=1,!r[a].hasOwnProperty(g.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(s.schemeIdUri=r[a].schemeIdUri,r[a].hasOwnProperty(S.default.TIMESCALE)&&(s.timescale=r[a].timescale),r[a].hasOwnProperty(S.default.VALUE)&&(s.value=r[a].value),o=0;r[a].Event_asArray&&o<r[a].Event_asArray.length;o++){var u,l=new D.default;l.presentationTime=0,l.eventStream=s,r[a].Event_asArray[o].hasOwnProperty(S.default.PRESENTATION_TIME)&&(l.presentationTime=r[a].Event_asArray[o].presentationTime,u=s.presentationTimeOffset?s.presentationTimeOffset*s.timescale:0,l.calculatedPresentationTime=l.presentationTime+e.start*s.timescale+u),r[a].Event_asArray[o].hasOwnProperty(S.default.DURATION)&&(l.duration=r[a].Event_asArray[o].duration),r[a].Event_asArray[o].hasOwnProperty(S.default.ID)&&(l.id=r[a].Event_asArray[o].id),r[a].Event_asArray[o].Signal&&r[a].Event_asArray[o].Signal.Binary?l.messageData=f.decodeArray(r[a].Event_asArray[o].Signal.Binary.toString()):l.messageData=r[a].Event_asArray[o].messageData||r[a].Event_asArray[o].__text,i.push(l);}}return i},getEventStreamForAdaptationSet:function(e,t){var n=void 0,r=void 0,i=void 0;return e&&e.Period_asArray&&t&&t.period&&_(t.period.index)&&(r=e.Period_asArray[t.period.index])&&r.AdaptationSet_asArray&&_(t.index)&&(i=r.AdaptationSet_asArray[t.index])&&(n=i.InbandEventStream_asArray),p(n,null)},getEventStreamForRepresentation:function(e,t){var n=void 0,r=void 0,i=void 0,a=void 0;return e&&e.Period_asArray&&t&&t.adaptation&&t.adaptation.period&&_(t.adaptation.period.index)&&(r=e.Period_asArray[t.adaptation.period.index])&&r.AdaptationSet_asArray&&_(t.adaptation.index)&&(i=r.AdaptationSet_asArray[t.adaptation.index])&&i.Representation_asArray&&_(t.index)&&(a=i.Representation_asArray[t.index])&&(n=a.InbandEventStream_asArray),p(n,t)},getUTCTimingSources:function(e){var t=h(e),n=!!e&&e.hasOwnProperty(S.default.AVAILABILITY_START_TIME),r=e?e.UTCTiming_asArray:null,i=[];return (t||n)&&r&&r.forEach(function(e){var t=new b.default;e.hasOwnProperty(g.default.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty(S.default.VALUE)&&(t.value=e.value.toString(),i.push(t)));}),i},getBaseURLsFromElement:T,getRepresentationSortFunction:t,getLocation:function(e){if(e&&e.hasOwnProperty(g.default.LOCATION))return e.Location=e.Location_asArray[0],e.Location},getUseCalculatedLiveEdgeTimeForAdaptation:function(e){var t=v(e),n=t&&Array.isArray(t.Representation_asArray)?t.Representation_asArray[0]:null,r=void 0;if(n){if(n.hasOwnProperty(S.default.SEGMENT_LIST))return !(r=n.SegmentList).hasOwnProperty(S.default.SEGMENT_TIMELINE)||y(r.SegmentTimeline);if(n.hasOwnProperty(S.default.SEGMENT_TEMPLATE)&&(r=n.SegmentTemplate).hasOwnProperty(S.default.SEGMENT_TIMELINE))return y(r.SegmentTimeline)}return !1},getSuggestedPresentationDelay:function(e){return e&&e.hasOwnProperty(S.default.SUGGESTED_PRESENTATION_DELAY)?e.suggestedPresentationDelay:null},getAvailabilityStartTime:function(e){return e&&e.hasOwnProperty(S.default.AVAILABILITY_START_TIME)&&null!==e.availabilityStartTime?e.availabilityStartTime.getTime():null},getServiceDescriptions:function(e){var t=[];if(e&&e.hasOwnProperty(S.default.SERVICE_DESCRIPTION)){var n=!0,r=!1,i=void 0;try{for(var a,o=e.ServiceDescription_asArray[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value,u=void 0,l=void 0,d=void 0,f=void 0;for(var c in s)s.hasOwnProperty(c)&&(c===S.default.ID?u=s[c]:c===S.default.SERVICE_DESCRIPTION_SCOPE?l=s[c].schemeIdUri:c===S.default.SERVICE_DESCRIPTION_LATENCY?d={target:s[c].target,max:s[c].max,min:s[c].min}:c===S.default.SERVICE_DESCRIPTION_PLAYBACK_RATE&&(f={max:s[c].max,min:s[c].min}));l===g.default.SERVICE_DESCRIPTION_LL_SCHEME&&(d||f)&&t.push({id:u,schemeIdUri:l,latency:d,playbackRate:f});}}catch(e){r=!0,i=e;}finally{try{!n&&o.return&&o.return();}finally{if(r)throw i}}}return t},getSupplementalPropperties:function(e){var t={};if(e&&e.hasOwnProperty(S.default.SUPPLEMENTAL_PROPERTY)){var n=!0,r=!1,i=void 0;try{for(var a,o=e.SupplementalProperty_asArray[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;s.hasOwnProperty(g.default.SCHEME_ID_URI)&&s.hasOwnProperty(S.default.VALUE)&&(t[s[g.default.SCHEME_ID_URI]]=s[S.default.VALUE]);}}catch(e){r=!0,i=e;}finally{try{!n&&o.return&&o.return();}finally{if(r)throw i}}}return t},setConfig:function(e){e&&(e.errHandler&&(d=e.errHandler),e.BASE64&&(f=e.BASE64));}},l=(0, w.default)(a).getInstance().getLogger(e),e}o.__dashjs_factory_name="DashManifestModel",n.default=a.default.getSingletonFactory(o),t.exports=n.default;},{108:108,204:204,216:216,220:220,225:225,45:45,47:47,51:51,61:61,84:84,85:85,86:86,87:87,90:90,91:91,92:92,96:96}],66:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),u=r(e(76)),l=r(e(3)),d=r(e(75)),f=r(e(73)),c=r(e(72)),h=r(e(74)),p=r(e(69)),g=r(e(70));function a(e){e=e||{};var t=this.context,n=e.debug,r=void 0,a=void 0,i=void 0,o=void 0,s=void 0;return r={parse:function(e){var t=void 0,n=window.performance.now();if(!(t=o.xml_str2json(e)))throw new Error("parsing the manifest failed");var r=window.performance.now();s.run(t);var i=window.performance.now();return a.info("Parsing complete: ( xml2json: "+(r-n).toPrecision(3)+"ms, objectiron: "+(i-r).toPrecision(3)+"ms, total: "+((i-n)/1e3).toPrecision(3)+"s)"),t.protocol="DASH",t},getMatchers:function(){return i},getIron:function(){return s}},a=n.getLogger(r),i=[new f.default,new c.default,new h.default,new d.default],o=new l.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!0,ignoreRoot:!0,matchers:i}),s=(0, u.default)(t).create({adaptationset:new p.default,period:new g.default}),r}a.__dashjs_factory_name="DashParser",n.default=i.default.getClassFactory(a),t.exports=n.default;},{3:3,47:47,69:69,70:70,72:72,73:73,74:74,75:75,76:76}],67:[function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}Object.defineProperty(n,"__esModule",{value:!0});var i=(function(e,t,n){return t&&r(e.prototype,t),e}(a,[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}]),a);function a(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var t;this._name=e,this._merge=(t=e)&&t.length&&t.charAt(0)===t.charAt(0).toUpperCase();}n.default=i,t.exports=n.default;},{}],68:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){return t&&i(e.prototype,t),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}var a,o=e(67),s=(a=o)&&a.__esModule?a:{default:a},u=(r(l,[{key:"name",get:function(){return this._name}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}]),l);function l(e,t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),this._name=e||"",this._properties=[],this._children=n||[],Array.isArray(t)&&t.forEach(function(e){r._properties.push(new s.default(e));});}n.default=u,t.exports=n.default;},{67:67}],69:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n,r=!1;null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0;}};function i(e){return e&&e.__esModule?e:{default:e}}var a=i(e(68)),o=i(e(61)),s=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);}(u,a.default),u);function u(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);var e=[o.default.PROFILES,o.default.WIDTH,o.default.HEIGHT,o.default.SAR,o.default.FRAMERATE,o.default.AUDIO_SAMPLING_RATE,o.default.MIME_TYPE,o.default.SEGMENT_PROFILES,o.default.CODECS,o.default.MAXIMUM_SAP_PERIOD,o.default.START_WITH_SAP,o.default.MAX_PLAYOUT_RATE,o.default.CODING_DEPENDENCY,o.default.SCAN_TYPE,o.default.FRAME_PACKING,o.default.AUDIO_CHANNEL_CONFIGURATION,o.default.CONTENT_PROTECTION,o.default.ESSENTIAL_PROPERTY,o.default.SUPPLEMENTAL_PROPERTY,o.default.INBAND_EVENT_STREAM];r(Object.getPrototypeOf(u.prototype),"constructor",this).call(this,o.default.ADAPTATION_SET,e,[new a.default(o.default.REPRESENTATION,e,[new a.default(o.default.SUB_REPRESENTATION,e)])]);}n.default=s,t.exports=n.default;},{61:61,68:68}],70:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n,r=!1;null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0;}};function i(e){return e&&e.__esModule?e:{default:e}}var a=i(e(68)),o=i(e(61)),s=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);}(u,a.default),u);function u(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);var e=[o.default.SEGMENT_BASE,o.default.SEGMENT_TEMPLATE,o.default.SEGMENT_LIST];r(Object.getPrototypeOf(u.prototype),"constructor",this).call(this,o.default.PERIOD,e,[new a.default(o.default.ADAPTATION_SET,e,[new a.default(o.default.REPRESENTATION,e)])]);}n.default=s,t.exports=n.default;},{61:61,68:68}],71:[function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}Object.defineProperty(n,"__esModule",{value:!0});var i=(function(e,t,n){return t&&r(e.prototype,t),e}(a,[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}]),a);function a(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this._test=e,this._converter=t;}n.default=i,t.exports=n.default;},{}],72:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n,r=!1;null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0;}};var i,a=e(71),o=(i=a)&&i.__esModule?i:{default:i},s=60,u=60,l=1e3,d=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,f=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);}(c,o.default),c);function c(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),r(Object.getPrototypeOf(c.prototype),"constructor",this).call(this,function(e){return d.test(e.value)},function(e){var t,n=d.exec(e),r=void 0,r=Date.UTC(parseInt(n[1],10),parseInt(n[2],10)-1,parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5],10),n[6]&&parseInt(n[6],10)||0,n[7]&&parseFloat(n[7])*l||0);return n[9]&&n[10]&&(t=parseInt(n[9],10)*u+parseInt(n[10],10),r+=("+"===n[8]?-1:1)*t*s*l),new Date(r)});}n.default=f,t.exports=n.default;},{71:71}],73:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n,r=!1;null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0;}};function i(e){return e&&e.__esModule?e:{default:e}}var a=i(e(71)),o=i(e(108)),s=i(e(61)),u=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,l=31536e3,d=2592e3,f=86400,c=3600,h=60,p=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);}(g,a.default),g);function g(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g),r(Object.getPrototypeOf(g.prototype),"constructor",this).call(this,function(e){for(var t=[s.default.MIN_BUFFER_TIME,s.default.MEDIA_PRESENTATION_DURATION,s.default.MINIMUM_UPDATE_PERIOD,s.default.TIMESHIFT_BUFFER_DEPTH,s.default.MAX_SEGMENT_DURATION,s.default.MAX_SUBSEGMENT_DURATION,s.default.SUGGESTED_PRESENTATION_DELAY,s.default.START,o.default.START_TIME,s.default.DURATION],n=t.length,r=0;r<n;r++)if(e.nodeName===t[r])return u.test(e.value);return !1},function(e){var t=u.exec(e),n=parseFloat(t[3]||0)*l+parseFloat(t[5]||0)*d+parseFloat(t[7]||0)*f+parseFloat(t[9]||0)*c+parseFloat(t[11]||0)*h+parseFloat(t[13]||0);return void 0!==t[1]&&(n=-n),n});}n.default=p,t.exports=n.default;},{108:108,61:61,71:71}],74:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n,r=!1;null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0;}};var i,a=e(71),o=(i=a)&&i.__esModule?i:{default:i},s=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);}(l,o.default),l);function l(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),r(Object.getPrototypeOf(l.prototype),"constructor",this).call(this,function(e){return s.test(e.value)},function(e){return parseFloat(e)});}n.default=u,t.exports=n.default;},{71:71}],75:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n,r=!1;null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0;}};function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=i(e(71)),s=i(e(61)),u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);}(l,o.default),l);function l(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),r(Object.getPrototypeOf(l.prototype),"constructor",this).call(this,function(e,t){var n,r=(a(n={},s.default.MPD,[s.default.ID,s.default.PROFILES]),a(n,s.default.PERIOD,[s.default.ID]),a(n,s.default.BASE_URL,[s.default.SERVICE_LOCATION,s.default.BYTE_RANGE]),a(n,s.default.SEGMENT_BASE,[s.default.INDEX_RANGE]),a(n,s.default.INITIALIZATION,[s.default.RANGE]),a(n,s.default.REPRESENTATION_INDEX,[s.default.RANGE]),a(n,s.default.SEGMENT_LIST,[s.default.INDEX_RANGE]),a(n,s.default.BITSTREAM_SWITCHING,[s.default.RANGE]),a(n,s.default.SEGMENT_URL,[s.default.MEDIA_RANGE,s.default.INDEX_RANGE]),a(n,s.default.SEGMENT_TEMPLATE,[s.default.INDEX_RANGE,s.default.MEDIA,s.default.INDEX,s.default.INITIALIZATION_MINUS,s.default.BITSTREAM_SWITCHING_MINUS]),a(n,s.default.ASSET_IDENTIFIER,[s.default.VALUE,s.default.ID]),a(n,s.default.EVENT_STREAM,[s.default.VALUE]),a(n,s.default.ADAPTATION_SET,[s.default.PROFILES,s.default.MIME_TYPE,s.default.SEGMENT_PROFILES,s.default.CODECS,s.default.CONTENT_TYPE]),a(n,s.default.FRAME_PACKING,[s.default.VALUE,s.default.ID]),a(n,s.default.AUDIO_CHANNEL_CONFIGURATION,[s.default.VALUE,s.default.ID]),a(n,s.default.CONTENT_PROTECTION,[s.default.VALUE,s.default.ID]),a(n,s.default.ESSENTIAL_PROPERTY,[s.default.VALUE,s.default.ID]),a(n,s.default.SUPPLEMENTAL_PROPERTY,[s.default.VALUE,s.default.ID]),a(n,s.default.INBAND_EVENT_STREAM,[s.default.VALUE,s.default.ID]),a(n,s.default.ACCESSIBILITY,[s.default.VALUE,s.default.ID]),a(n,s.default.ROLE,[s.default.VALUE,s.default.ID]),a(n,s.default.RATING,[s.default.VALUE,s.default.ID]),a(n,s.default.VIEWPOINT,[s.default.VALUE,s.default.ID]),a(n,s.default.CONTENT_COMPONENT,[s.default.CONTENT_TYPE]),a(n,s.default.REPRESENTATION,[s.default.ID,s.default.DEPENDENCY_ID,s.default.MEDIA_STREAM_STRUCTURE_ID]),a(n,s.default.SUBSET,[s.default.ID]),a(n,s.default.METRICS,[s.default.METRICS_MINUS]),a(n,s.default.REPORTING,[s.default.VALUE,s.default.ID]),n);if(r.hasOwnProperty(t)){var i=r[t];return void 0!==i&&0<=i.indexOf(e.name)}return !1},function(e){return String(e)});}n.default=u,t.exports=n.default;},{61:61,71:71}],76:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(47),a=(r=i)&&r.__esModule?r:{default:r};function o(d){function l(e,t,n){for(var r=0,i=e.length;r<i;++r){var a,o,s=e[r];t[s.name]&&(n[s.name]?s.merge&&(a=t[s.name],o=n[s.name],"object"==typeof a&&"object"==typeof o?function(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n]);}(a,o):n[s.name]=a+o):n[s.name]=t[s.name]);}}function f(e,t){for(var n=0,r=e.children.length;n<r;++n){var i=e.children[n],a=t[i.name+"_asArray"];if(a)for(var o=0,s=a.length;o<s;++o){var u=a[o];l(e.properties,t,u),f(i,u);}}}return {run:function(e){if(null===e||"object"!=typeof e)return e;if("period"in d)for(var t=d.period,n=e.Period_asArray,r=0,i=n.length;r<i;++r){var a=n[r];if(f(t,a),"adaptationset"in d){var o=a.AdaptationSet_asArray;if(o)for(var s=d.adaptationset,u=0,l=o.length;u<l;++u)f(s,o[u]);}}return e}}}o.__dashjs_factory_name="ObjectIron";var s=a.default.getClassFactory(o);n.default=s,t.exports=n.default;},{47:47}],77:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),a=r(e(108)),d=e(80);function o(e,s){var u=(e=e||{}).timelineConverter;function l(){if(!u||!u.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(a.default.MISSING_CONFIG_ERROR)}function i(e,t){if(l(),!e)return null;var n,r=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,i=r.SegmentURL_asArray.length,a=e.startNumber,o=null;return t<i&&(n=r.SegmentURL_asArray[t],(o=(0, d.getIndexBasedSegment)(u,s,e,t))&&(o.replacementTime=(a+t-1)*e.segmentDuration,o.media=n.media?n.media:"",o.mediaRange=n.mediaRange,o.index=t,o.indexRange=n.indexRange)),e.availableSegmentsNumber=i,o}return {getSegmentByIndex:i,getSegmentByTime:function(e,t){if(l(),!e)return null;var n=e.segmentDuration;if(isNaN(n))return null;var r=u.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return i(e,Math.floor(r/n))}}}o.__dashjs_factory_name="ListSegmentsGetter";var s=i.default.getClassFactory(o);n.default=s,t.exports=n.default;},{108:108,47:47,80:80}],78:[function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}Object.defineProperty(n,"__esModule",{value:!0});var i=(function(e,t,n){return n&&r(e,n),e}(a,null,[{key:"round10",value:function(e,t){return n="round",r=e,void 0!==(i=t)&&0!=+i?(i=+i,null===(r=+r)||isNaN(r)||"number"!=typeof i||i%1!=0?NaN:(r=r.toString().split("e"),+((r=(r=Math[n](+(r[0]+"e"+(r[1]?r[1]-i:-i)))).toString().split("e"))[0]+"e"+(r[1]?+r[1]+i:i)))):Math[n](r);var n,r,i;}}]),a);function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);}n.default=i,t.exports=n.default;},{}],79:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),o=r(e(108));function a(e){var n=(e=e||{}).timelineConverter;function a(){if(!n||!n.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(o.default.MISSING_CONFIG_ERROR)}function r(e,t){if(a(),!e)return null;var n=e.segments?e.segments.length:-1,r=void 0;if(t<n&&(r=e.segments[t])&&r.availabilityIdx===t)return r;for(var i=0;i<n;i++)if((r=e.segments[i])&&r.availabilityIdx===t)return r;return null}return {getSegmentByIndex:r,getSegmentByTime:function(e,t){return a(),r(e,function(e,t){if(!e)return -1;var n=e.segments,r=n?n.length:null,i=-1,a=void 0,o=void 0,s=void 0,u=void 0,l=void 0;if(n&&0<r)for(l=0;l<r;l++)if(o=n[l],s=o.presentationStartTime,u=o.duration,s<=t+(a=u/2)&&t-a<s+u){i=o.availabilityIdx;break}return i}(e,n.calcPeriodRelativeTimeFromMpdRelativeTime(e,t)))}}}a.__dashjs_factory_name="SegmentBaseGetter";var s=i.default.getClassFactory(a);n.default=s,t.exports=n.default;},{108:108,47:47}],80:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.unescapeDollarsInTemplate=function(e){return e?e.split("$$").join("$"):e},n.replaceIDForTemplate=function(e,t){if(!t||!e||-1===e.indexOf("$RepresentationID$"))return e;var n=t.toString();return e.split("$RepresentationID$").join(n)},n.replaceTokenForTemplate=g,n.getIndexBasedSegment=function(e,t,n,r){var i,a,o=void 0;o=n.segmentDuration,isNaN(o)&&(o=n.adaptation.period.duration);i=parseFloat((n.adaptation.period.start+r*o).toFixed(5)),a=parseFloat((i+o).toFixed(5));var s=_(n,o,i,e.calcMediaTimeFromPresentationTime(i,n),e.calcAvailabilityStartTimeFromPresentationTime(i,n.adaptation.period.mpd,t),e,a,t,r);return E(e,n,s,t)?s:null},n.getTimeBasedSegment=function(e,t,n,r,i,a,o,s,u,l){var d,f,c=r/a,h=Math.min(i/a,n.adaptation.period.mpd.maxSegmentDuration),p=void 0;return d=e.calcPresentationTimeFromMediaTime(c,n),f=d+h,p=_(n,h,d,c,n.adaptation.period.mpd.manifest.loadedTime,e,f,t,u),E(e,n,p,t)?(p.replacementTime=l||r,o=g(o,"Number",p.replacementNumber),o=g(o,"Time",p.replacementTime),p.media=o,p.mediaRange=s,p):null};var r,i=e(94),f=(r=i)&&r.__esModule?r:{default:r};function c(e,t){for(;e.length<t;)e="0"+e;return e}function g(e,t,n){var r=void 0,i=void 0,a=void 0,o=void 0,s=void 0,u=void 0,l=t.length,d="%0".length;if(!e)return e;for(;;){if((r=e.indexOf("$"+t))<0)return e;if((i=e.indexOf("$",r+l))<0)return e;if(r<(a=e.indexOf("%0",r+l))&&a<i)switch(o=e.charAt(i-1),s=parseInt(e.substring(a+d,i-1),10),o){case"d":case"i":case"u":u=c(n.toString(),s);break;case"x":u=c(n.toString(16),s);break;case"X":u=c(n.toString(16),s).toUpperCase();break;case"o":u=c(n.toString(8),s);break;default:return e}else u=n;e=e.substring(0,r)+u+e.substring(i+1);}}function _(e,t,n,r,i,a,o,s,u){var l,d=new f.default;return d.representation=e,d.duration=t,d.presentationStartTime=n,d.mediaStartTime=r,d.availabilityStartTime=i,d.availabilityEndTime=a.calcAvailabilityEndTimeFromPresentationTime(o,e.adaptation.period.mpd,s),d.wallStartTime=a.calcWallTimeForSegment(d,s),d.replacementNumber=(l=u,d.representation.startNumber+l),d.availabilityIdx=u,d}function E(e,t,n,r){var i=e.getPeriodEnd(t,r);if(e.calcPeriodRelativeTimeFromMpdRelativeTime(t,i)<=e.calcPeriodRelativeTimeFromMpdRelativeTime(t,n.presentationStartTime)){if(!r)return;if(t.segmentAvailabilityRange&&n.presentationStartTime>=t.segmentAvailabilityRange.end)return}return 1}},{94:94}],81:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),a=r(e(108)),d=e(80);function o(e,s){var u=(e=e||{}).timelineConverter;function l(){if(!u||!u.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(a.default.MISSING_CONFIG_ERROR)}function i(e,t){if(l(),!e)return null;var n=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate;t=Math.max(t,0);var r,i=(0, d.getIndexBasedSegment)(u,s,e,t);i&&(i.replacementTime=(t-1)*e.segmentDuration,r=n.media,r=(0, d.replaceTokenForTemplate)(r,"Number",i.replacementNumber),r=(0, d.replaceTokenForTemplate)(r,"Time",i.replacementTime),i.media=r);var a=e.segmentDuration,o=e.segmentAvailabilityRange;return isNaN(a)?e.availableSegmentsNumber=1:e.availableSegmentsNumber=Math.ceil((o.end-o.start)/a),i}return {getSegmentByIndex:i,getSegmentByTime:function(e,t){if(l(),!e)return null;var n=e.segmentDuration;if(isNaN(n))return null;var r=u.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return i(e,Math.floor(r/n))}}}o.__dashjs_factory_name="TemplateSegmentsGetter";var s=i.default.getClassFactory(o);n.default=s,t.exports=n.default;},{108:108,47:47,80:80}],82:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var h=r(e(46)),p=r(e(54)),i=r(e(47)),g=r(e(61)),_=r(e(65));function a(){var e,t=this.context,n=(0, h.default)(t).getInstance(),c=void 0,i=void 0,u=void 0,r=void 0;function a(e){i=e;}function o(e,t,n,r){return r?n&&t.timeShiftBufferDepth!=Number.POSITIVE_INFINITY?new Date(t.availabilityStartTime.getTime()+1e3*(e+t.timeShiftBufferDepth)):t.availabilityEndTime:n?new Date(t.availabilityStartTime.getTime()+1e3*(e-i)):t.availabilityStartTime}function l(e,t){return (e.getTime()-t.mpd.availabilityStartTime.getTime()+1e3*i)/1e3}function s(e){u||void 0!==e.offset&&(a(e.offset/1e3),u=!0);}function d(){i=0,u=!1,r=NaN;}function f(){n.off(p.default.TIME_SYNCHRONIZATION_COMPLETED,s,this),d();}return e={initialize:function(){d(),n.on(p.default.TIME_SYNCHRONIZATION_COMPLETED,s,this);},isTimeSyncCompleted:function(){return u},setTimeSyncCompleted:function(e){u=e;},getClientTimeOffset:function(){return i},setClientTimeOffset:a,getExpectedLiveEdge:function(){return r},setExpectedLiveEdge:function(e){r=e;},calcAvailabilityStartTimeFromPresentationTime:function(e,t,n){return o.call(this,e,t,n)},calcAvailabilityEndTimeFromPresentationTime:function(e,t,n){return o.call(this,e,t,n,!0)},calcPresentationTimeFromWallTime:l,calcPresentationTimeFromMediaTime:function(e,t){return e+(t.adaptation.period.start-t.presentationTimeOffset)},calcPeriodRelativeTimeFromMpdRelativeTime:function(e,t){return t-e.adaptation.period.start},calcMediaTimeFromPresentationTime:function(e,t){return e-t.adaptation.period.start+t.presentationTimeOffset},calcSegmentAvailabilityRange:function(e,t){var n=e.adaptation.period,r={start:n.start,end:n.start+n.duration};if(!t)return r;if(!u&&e.segmentAvailabilityRange)return e.segmentAvailabilityRange;var i=e.segmentDuration||(e.segments&&e.segments.length?e.segments[e.segments.length-1].duration:0);if(e.segmentInfoType===g.default.SEGMENT_TIMELINE&&n.mpd.timeShiftBufferDepth===Number.POSITIVE_INFINITY)return function(e){var t,n=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],r=c.getRepresentationFor(e.index,n),i=r.SegmentTemplate.SegmentTimeline,a=r.SegmentTemplate.timescale,o=i.S_asArray,s={start:0,end:0},u=0,l=void 0,d=void 0,f=void 0;for(s.start=o[0].t/a,f=0,t=o.length;f<t;f++)l=o[f],d=0,l.hasOwnProperty("r")&&(d=l.r),u+=l.d/a*(1+d);return s.end=s.start+u,s}(e);var a=l(new Date,n),o=n.start+n.duration;r.start=Math.max(a-n.mpd.timeShiftBufferDepth,n.start);var s=void 0!==e.availabilityTimeOffset&&e.availabilityTimeOffset<i?i-e.availabilityTimeOffset:i;return r.end=o<=a&&a-s<o?o:a-s,r},getPeriodEnd:function(e,t){var n=e.adaptation.period;if(!t)return n.start+n.duration;if(!u&&e.segmentAvailabilityRange)return e.segmentAvailabilityRange;var r=e.segmentDuration||(e.segments&&e.segments.length?e.segments[e.segments.length-1].duration:0),i=l(new Date,n),a=n.start+n.duration,o=void 0!==e.availabilityTimeOffset&&e.availabilityTimeOffset<r?r-e.availabilityTimeOffset:r;return Math.min(i-o,a)},calcWallTimeForSegment:function(e,t){var n=void 0,r=void 0,i=void 0;return t&&(n=e.representation.adaptation.period.mpd.suggestedPresentationDelay,r=e.presentationStartTime+n,i=new Date(e.availabilityStartTime.getTime()+1e3*r)),i},reset:f},c=(0, _.default)(t).getInstance(),f(),e}a.__dashjs_factory_name="TimelineConverter",n.default=i.default.getSingletonFactory(a),t.exports=n.default;},{46:46,47:47,54:54,61:61,65:65}],83:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),a=r(e(108)),p=e(80);function o(e,v){var y=(e=e||{}).timelineConverter;function t(){if(!y||!y.hasOwnProperty("calcMediaTimeFromPresentationTime")||!y.hasOwnProperty("calcSegmentAvailabilityRange"))throw new Error(a.default.MISSING_CONFIG_ERROR)}function n(e,t){for(var n,r=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,i=r.SegmentTimeline,a=r.SegmentURL_asArray,o=0,s=0,u=-1,l=void 0,d=void 0,f=void 0,c=void 0,h=void 0,p=void 0,g=e.timescale,_=!1,d=0,E=(n=i.S_asArray).length;d<E&&!_;d++){var m,c=0;for((l=n[d]).hasOwnProperty("r")&&(c=l.r),l.hasOwnProperty("t")&&(s=(o=l.t)/g),c<0&&((p=n[d+1])&&p.hasOwnProperty("t")?h=p.t/g:(m=e.segmentAvailabilityRange?e.segmentAvailabilityRange.end:y.calcSegmentAvailabilityRange(e,v).end,h=y.calcMediaTimeFromPresentationTime(m,e),e.segmentDuration=l.d/g),c=Math.ceil((h-s)/(l.d/g))-1),f=0;f<=c&&!_;f++)(_=t(o,s,r,a,l,g,++u,d))&&(e.segmentDuration=l.d/g,(f<c-1||d<E-1)&&u++),s=(o+=l.d)/g;}e.availableSegmentsNumber=u;}return {getSegmentByIndex:function(d,e,f){if(t(),!d)return null;var c=null,h=!1;return n(d,function(e,t,n,r,i,a,o,s){if(h||f<0){var u=n.media,l=i.mediaRange;return r&&(u=r[s].media||"",l=r[s].mediaRange),c=(0, p.getTimeBasedSegment)(y,v,d,e,i.d,a,u,l,o,i.tManifest),!0}return t>=f-.5*i.d/a&&(h=!0),!1}),c},getSegmentByTime:function(d,e){if(t(),!d)return null;void 0===e&&(e=null);var f=null,c=y.calcMediaTimeFromPresentationTime(e,d);return n(d,function(e,t,n,r,i,a,o,s){if(c<t+i.d/a){var u=n.media,l=i.mediaRange;return r&&(u=r[s].media||"",l=r[s].mediaRange),f=(0, p.getTimeBasedSegment)(y,v,d,e,i.d,a,u,l,o,i.tManifest),!0}return !1}),f}}}o.__dashjs_factory_name="TimelineSegmentsGetter";var s=i.default.getClassFactory(o);n.default=s,t.exports=n.default;},{108:108,47:47,80:80}],84:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.period=null,this.index=-1,this.type=null;},t.exports=n.default;},{}],85:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});function i(e,t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.url=e||"",this.serviceLocation=t||e||"",this.dvb_priority=n||1,this.dvb_weight=r||1,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0;}i.DEFAULT_DVB_PRIORITY=1,i.DEFAULT_DVB_WEIGHT=1,n.default=i,t.exports=n.default;},{}],86:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN;},t.exports=n.default;},{}],87:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri="";},t.exports=n.default;},{}],88:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.DVRWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null;},t.exports=n.default;},{}],89:[function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}Object.defineProperty(n,"__esModule",{value:!0});var i=(function(e,t,n){return t&&r(e.prototype,t),e}(a,[{key:"isMediaInfoEqual",value:function(e){if(!e)return !1;var t=this.id===e.id,n=this.viewpoint===e.viewpoint,r=this.lang===e.lang,i=this.roles.toString()===e.roles.toString(),a=this.accessibility.toString()===e.accessibility.toString(),o=this.audioChannelConfiguration.toString()===e.audioChannelConfiguration.toString();return t&&n&&r&&i&&a&&o}}]),a);function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.lang=null,this.viewpoint=null,this.accessibility=null,this.audioChannelConfiguration=null,this.roles=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null;}n.default=i,t.exports=n.default;},{}],90:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN;},t.exports=n.default;},{}],91:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});function r(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null;}r.DEFAULT_ID="defaultId",n.default=r,t.exports=n.default;},{}],92:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){return t&&i(e.prototype,t),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}var a,o=e(61),s=(a=o)&&a.__esModule?a:{default:a},u=(r(l,[{key:"hasInitialization",value:function(){return null!==this.initialization||null!==this.range}},{key:"hasSegments",value:function(){return this.segmentInfoType!==s.default.BASE_URL&&this.segmentInfoType!==s.default.SEGMENT_BASE&&!this.indexRange}}]),l);function l(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.segmentAvailabilityRange=null,this.availableSegmentsNumber=0,this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0;}n.default=u,t.exports=n.default;},{61:61}],93:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.quality=null,this.DVRWindow=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null;},t.exports=n.default;},{}],94:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.availabilityIdx=NaN,this.wallStartTime=NaN,this.representation=null;},t.exports=n.default;},{}],95:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0;},t.exports=n.default;},{}],96:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri="",this.value="";},t.exports=n.default;},{}],97:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var l=r(e(108)),d=r(e(158)),f=r(e(228)),c=r(e(225)),i=r(e(47));function a(e){e=e||{};var t=this.context,i=e.eventBus,a=e.events,n=e.urlUtils,o=e.errors,s=void 0,u=void 0;return s={checkForExistence:function(t){function e(e){i.trigger(a.CHECK_FOR_EXISTENCE_COMPLETED,{request:t,exists:e});}var n;t?(n=new f.default(t.url),u.load({request:n,success:function(){e(!0);},error:function(){e(!1);}})):e(!1);},load:function(n){function r(e,t){i.trigger(a.LOADING_COMPLETED,{request:n,response:e||null,error:t||null,sender:s});}n?u.load({request:n,progress:function(e){i.trigger(a.LOADING_PROGRESS,{request:n,stream:e.stream}),e.data&&i.trigger(a.LOADING_DATA_PROGRESS,{request:n,response:e.data||null,error:null,sender:s});},success:function(e){r(e);},error:function(e,t,n){r(void 0,new c.default(o.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE,n,t));},abort:function(e){e&&i.trigger(a.LOADING_ABANDONED,{request:e,mediaType:e.mediaType,sender:s});}}):r(void 0,new c.default(o.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE,o.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE));},abort:function(){u&&u.abort();},reset:function(){u&&(u.abort(),u=null);}},u=(0, d.default)(t).create({errHandler:e.errHandler,errors:o,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,useFetch:e.settings.get().streaming.lowLatencyEnabled,urlUtils:n,constants:l.default,boxParser:e.boxParser,dashConstants:e.dashConstants}),s}a.__dashjs_factory_name="FragmentLoader",n.default=i.default.getClassFactory(a),t.exports=n.default;},{108:108,158:158,225:225,228:228,47:47}],98:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var E=r(e(108)),a=r(e(61)),o=r(e(123)),s=r(e(158)),u=r(e(220)),m=r(e(232)),v=r(e(225)),y=e(241),T=r(e(46)),S=r(e(54)),A=r(e(51)),i=r(e(47)),I=r(e(66));function l(e){e=e||{};var l=this.context,d=e.debug,f=(0, T.default)(l).getInstance(),c=(0, u.default)(l).getInstance(),t=void 0,h=void 0,n=void 0,p=void 0,g=void 0,_=e.mssHandler,r=e.errHandler;function i(e){f.trigger(S.default.INTERNAL_MANIFEST_LOADED,{manifest:e.manifest});}return t={load:function(u){var e=new m.default(u,y.HTTPRequest.MPD_TYPE);n.load({request:e,success:function(e,t,n){if(p){var r,i,a=void 0,o=void 0,s=void 0;if(n&&n!==u?(o=c.parseBaseUrl(n),a=n):(c.isRelative(u)&&(u=c.resolve(u,window.location.href)),o=c.parseBaseUrl(u)),null===g&&(i=null,g=-1<(r=e).indexOf("SmoothStreamingMedia")?(_&&(i=_.createMssParser(),_.registerEvents()),i):-1<r.indexOf("MPD")?(0, I.default)(l).create({debug:d}):i),null!==g){p.setMatchers(g.getMatchers()),p.setIron(g.getIron());try{s=g.parse(e);}catch(e){return void f.trigger(S.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new v.default(A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+u)})}s?(s.url=a||u,s.originalUrl||(s.originalUrl=s.url),s.hasOwnProperty(E.default.LOCATION)&&(o=c.parseBaseUrl(s.Location_asArray[0]),h.debug("BaseURI set by Location to: "+o)),s.baseUri=o,s.loadedTime=new Date,p.resolveManifestOnLoad(s),f.trigger(S.default.ORIGINAL_MANIFEST_LOADED,{originalManifest:e})):f.trigger(S.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new v.default(A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+u)});}else f.trigger(S.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new v.default(A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+u)});}},error:function(e,t,n){f.trigger(S.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new v.default(A.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE,A.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE+(u+", ")+n)});}});},reset:function(){f.off(S.default.XLINK_READY,i,t),p&&(p.reset(),p=null),n&&(n.abort(),n=null),_&&_.reset();}},h=d.getLogger(t),f.on(S.default.XLINK_READY,i,t),n=(0, s.default)(l).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,useFetch:e.settings.get().streaming.lowLatencyEnabled,urlUtils:c,constants:E.default,dashConstants:a.default,errors:A.default}),p=(0, o.default)(l).create({errHandler:r,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),g=null,t}l.__dashjs_factory_name="ManifestLoader";var d=i.default.getClassFactory(l);n.default=d,t.exports=n.default;},{108:108,123:123,158:158,220:220,225:225,232:232,241:241,46:46,47:47,51:51,54:54,61:61,66:66}],99:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var A=r(e(46)),I=r(e(54)),i=r(e(47)),R=r(e(45)),b=r(e(51)),D=r(e(61));function a(){var e=this.context,r=(0, A.default)(e).getInstance(),t=void 0,i=void 0,a=void 0,n=void 0,o=void 0,s=void 0,u=void 0,l=void 0,d=void 0,f=void 0,c=void 0;function h(){a=NaN,o=!(s=!1),p();}function p(){null!==n&&(clearTimeout(n),n=null);}function g(e){p(),isNaN(e)&&!isNaN(a)&&(e=1e3*a),isNaN(e)||(i.debug("Refresh manifest in "+e+" milliseconds."),n=setTimeout(m,e));}function _(){s=!0;var e=l.getValue(),t=e.url,n=d.getLocation(e);n&&(t=n),u.load(t);}function E(e){var t,n;l.getValue()&&l.getValue().type===D.default.DYNAMIC&&e.type===D.default.STATIC?r.trigger(I.default.DYNAMIC_STREAM_COMPLETED):(l.setValue(e),n=((t=new Date).getTime()-e.loadedTime.getTime())/1e3,2147483647<1e3*(a=d.getManifestUpdatePeriod(e,n))&&(a=2147483.647),r.trigger(I.default.MANIFEST_UPDATED,{manifest:e}),i.info("Manifest has been refreshed at "+t+"["+t.getTime()/1e3+"] "),o||g());}function m(){o&&!c.get().streaming.scheduleWhilePaused||(s?g(c.get().streaming.manifestUpdateRetryInterval):_());}function v(e){e.error?e.error.code===b.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE&&f.error(e.error):E(e.manifest);}function y(){o=!1,g();}function T(){o=!0,p();}function S(){s=!1;}return t={initialize:function(){h(),r.on(I.default.STREAMS_COMPOSED,S,this),r.on(I.default.PLAYBACK_STARTED,y,this),r.on(I.default.PLAYBACK_PAUSED,T,this),r.on(I.default.INTERNAL_MANIFEST_LOADED,v,this);},setManifest:function(e){E(e);},refreshManifest:_,setConfig:function(e){e&&(e.manifestModel&&(l=e.manifestModel),e.adapter&&(d=e.adapter),e.manifestLoader&&(u=e.manifestLoader),e.errHandler&&(f=e.errHandler),e.settings&&(c=e.settings));},reset:function(){r.off(I.default.PLAYBACK_STARTED,y,this),r.off(I.default.PLAYBACK_PAUSED,T,this),r.off(I.default.STREAMS_COMPOSED,S,this),r.off(I.default.INTERNAL_MANIFEST_LOADED,v,this),h();}},i=(0, R.default)(e).getInstance().getLogger(t),t}a.__dashjs_factory_name="ManifestUpdater",n.default=i.default.getClassFactory(a),t.exports=n.default;},{45:45,46:46,47:47,51:51,54:54,61:61}],100:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var oe=r(e(2)),se=r(e(108)),ue=r(e(61)),le=r(e(109)),de=r(e(119)),fe=r(e(121)),ce=r(e(117)),he=r(e(112)),pe=r(e(98)),ge=r(e(212)),_e=r(e(207)),Ee=r(e(202)),me=r(e(217)),ve=r(e(200)),ye=r(e(153)),Te=r(e(150)),Se=r(e(151)),Ae=r(e(111)),Ie=r(e(157)),Re=r(e(154)),be=r(e(148)),De=r(e(209)),Me=r(e(45)),Ne=r(e(51)),Ce=r(e(46)),Oe=r(e(54)),we=r(e(101)),Pe=r(e(47)),Le=r(e(48)),xe=e(50),Fe=r(e(63)),Ue=r(e(56)),ke=r(e(58)),Be=r(e(82)),Ge=e(241),je=r(e(1)),Ye=r(e(9)),Ke=r(e(225)),qe=e(218),He=r(e(99)),Ve=r(e(220)),ze=r(e(206));function i(){var i="You must first call initialize() and set a source before calling this method",r="You must first call initialize() and set a valid source and view before calling this method",t="You must first call attachView() to set the video element before calling this method",e="You must first call attachSource() with a valid source before calling this method",a="MediaPlayer not initialized!",o=this.context,s=(0, Ce.default)(o).getInstance(),u=(0, Le.default)(o).getInstance(),l=(0, Me.default)(o).getInstance({settings:u}),n=void 0,d=void 0,f=void 0,c=void 0,h=void 0,p=void 0,g=void 0,_=void 0,E=void 0,m=void 0,v=void 0,y=void 0,T=void 0,S=void 0,A=void 0,I=void 0,R=void 0,b=void 0,D=void 0,M=void 0,N=void 0,C=void 0,O=void 0,w=void 0,P=void 0,L=void 0,x=void 0,F=void 0,U=void 0,k=void 0,B=void 0;function G(){return !!f&&!!x.getElement()}function j(){return (0, xe.getVersionString)()}function Y(){if(!g)throw r;return O.isPaused()}function K(e){var t=w.getCurrentDVRInfo();if(!t)return 0;var n=O.getLiveDelay(),r=t.range.start+e;return r>t.range.end-n&&(r=t.range.end-n),r}function q(e){if(!g)throw r;var t,n=X().currentTime;return void 0!==e?n=C.getTimeRelativeToStreamId(n,e):O.getIsDynamic()&&(n=null===(t=w.getCurrentDVRInfo())?0:H()-(t.range.end-t.time)),n}function H(){if(!g)throw r;var e=X().duration;if(O.getIsDynamic()){var t,n=w.getCurrentDVRInfo();if(!n)return 0;e=(t=n.range.end-n.range.start)<n.manifestInfo.DVRWindowSize?t:n.manifestInfo.DVRWindowSize;}return e}function V(e){(0, qe.checkParameterType)(e,"boolean"),_=e;}function z(){b.restoreDefaultUTCTimingSources();}function W(){return w}function X(){if(!x.getElement())throw t;return x.getElement()}function Q(e){if(!h)throw a;x.setElement(e),e&&(ne(),function(){if(S)return;var e=dashjs.MetricsReporting;{var t;"function"==typeof e&&(t=e(o).create(),S=t.createMetricsReporting({debug:l,eventBus:s,mediaElement:X(),adapter:R,dashMetrics:w,events:Oe.default,constants:se.default,metricsConstants:le.default}));}}(),function(){if(A)return;var e=dashjs.MssHandler;"function"==typeof e&&(Ne.default.extend(e.errors),A=e(o).create({eventBus:s,mediaPlayerModel:b,dashMetrics:w,manifestModel:P,playbackController:O,streamController:C,protectionController:T,baseURLController:M,errHandler:D,events:Oe.default,constants:se.default,debug:l,initSegmentType:Ge.HTTPRequest.INIT_SEGMENT_TYPE,BASE64:je.default,ISOBoxer:Ye.default,settings:u}));}(),C&&C.switchToVideoElement()),g&&ee(),ae();}function Z(e){if(!p)throw i;var t=C.getActiveStreamInfo();return y.getTracksFor(e,t)}function $(e){if(!h)throw a;"string"==typeof e&&U.initialize(e),f=e,(p||g)&&ee(),G()&&ae();}function J(){if(!p)throw i;var e=C.getActiveStreamInfo();return e?C.getStreamById(e.id):null}function ee(){p=g=!1,R.reset(),C.reset(),O.reset(),E.reset(),y.reset(),F.reset(),T&&(u.get().streaming.keepProtectionMediaKeys?T.stop():(T.reset(),T=null,ne())),L.reset();}function te(){return (0, pe.default)(o).create({debug:l,errHandler:D,dashMetrics:w,mediaPlayerModel:b,requestModifier:(0, me.default)(o).getInstance(),mssHandler:A,settings:u})}function ne(){if(T)return T;var e=dashjs.Protection;if("function"!=typeof e)return null;var t=e(o).create();return Oe.default.extend(e.events),we.default.extend(e.events,{publicOnly:!0}),Ne.default.extend(e.errors),N=N||(0, _e.default)(o).getInstance(),T=t.createProtectionSystem({debug:l,errHandler:D,videoModel:x,capabilities:N,eventBus:s,events:Oe.default,BASE64:je.default,constants:se.default})}function re(){if(!h)throw a;if(I)return I;var e=dashjs.OfflineController;if("function"!=typeof e)return null;Oe.default.extend(e.events),we.default.extend(e.events,{publicOnly:!0}),Ne.default.extend(e.errors);var t=te(),n=(0, He.default)(o).create();return n.setConfig({manifestModel:P,adapter:R,manifestLoader:t,errHandler:D}),I=e(o).create({debug:l,manifestUpdater:n,baseURLController:M,manifestLoader:t,manifestModel:P,mediaPlayerModel:b,abrController:E,playbackController:O,adapter:R,errHandler:D,dashMetrics:w,timelineConverter:v,schemeLoaderFactory:m,eventBus:s,events:Oe.default,errors:Ne.default,constants:se.default,settings:u,dashConstants:ue.default,urlUtils:(0, Ve.default)(o).getInstance()})}function ie(e){var t=w.getCurrentDVRInfo();return t?e+(t.manifestInfo.availableFrom.getTime()/1e3+t.range.start):0}function ae(){var e;I&&I.resetRecords(),!p&&f&&(p=!0,d.info("Streaming Initialized"),e=te(),C=C||(0, fe.default)(o).getInstance(),y.setConfig({domStorage:k}),C.setConfig({capabilities:N,manifestLoader:e,manifestModel:P,mediaPlayerModel:b,protectionController:T,adapter:R,dashMetrics:w,errHandler:D,timelineConverter:v,videoModel:x,playbackController:O,abrController:E,mediaController:y,textController:F,settings:u,baseURLController:M}),O.setConfig({streamController:C,dashMetrics:w,mediaPlayerModel:b,adapter:R,videoModel:x,timelineConverter:v,uriFragmentModel:U,settings:u}),E.setConfig({streamController:C,domStorage:k,mediaPlayerModel:b,dashMetrics:w,adapter:R,videoModel:x,settings:u}),E.createAbrRulesCollection(),F.setConfig({errHandler:D,manifestModel:P,adapter:R,mediaController:y,streamController:C,videoModel:x}),L.setConfig({abrController:E,dashMetrics:w,playbackController:O}),C.initialize(_,c),L.initialize(),"string"==typeof f?C.load(f):C.loadWithManifest(f)),!g&&G()&&(g=!0,d.info("Playback Initialized"));}return n={initialize:function(e,t,n){N=N||(0, _e.default)(o).getInstance(),D=(0, ge.default)(o).getInstance(),N.supportsMediaSource()?h||(h=!0,v=(0, Be.default)(o).getInstance(),E||(E=(0, Ae.default)(o).getInstance()).setConfig({settings:u}),m=m||(0, Ie.default)(o).getInstance(),O=O||(0, de.default)(o).getInstance(),y=y||(0, ce.default)(o).getInstance(),C=C||(0, fe.default)(o).getInstance(),R=(0, Ue.default)(o).getInstance(),P=(0, Te.default)(o).getInstance(),L=(0, be.default)(o).getInstance(),w=(0, ke.default)(o).getInstance({settings:u}),F=(0, ve.default)(o).getInstance(),k=(0, De.default)(o).getInstance({settings:u}),R.setConfig({constants:se.default,cea608parser:oe.default,errHandler:D,BASE64:je.default}),(M=M||(0, he.default)(o).create()).setConfig({adapter:R}),(B=(0, Fe.default)(o).getInstance({dashMetrics:w,mediaPlayerModel:b,errHandler:D,baseURLController:M,events:Oe.default,eventBus:s,debug:l,boxParser:(0, ze.default)(o).getInstance(),requestModifier:(0, me.default)(o).getInstance(),errors:Ne.default})).initialize(),z(),V(void 0===n||n),re(),e&&Q(e),t&&$(t),d.info("[dash.js "+j()+"] MediaPlayer has been initialized")):D.error(new Ke.default(Ne.default.CAPABILITY_MEDIASOURCE_ERROR_CODE,Ne.default.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE));},setConfig:function(e){e&&(e.capabilities&&(N=e.capabilities),e.streamController&&(C=e.streamController),e.playbackController&&(O=e.playbackController),e.mediaPlayerModel&&(b=e.mediaPlayerModel),e.abrController&&(E=e.abrController),e.schemeLoaderFactory&&(m=e.schemeLoaderFactory),e.mediaController&&(y=e.mediaController),e.settings&&(u=e.settings));},on:function(e,t,n){s.on(e,t,n);},off:function(e,t,n){s.off(e,t,n);},extend:function(e,t,n){Pe.default.extend(e,t,n,o);},attachView:Q,attachSource:$,isReady:G,preload:function(){if(x.getElement()||p)return !1;if(!f)throw e;ae();},play:function(){if(!g)throw r;(!_||Y()&&g)&&O.play();},isPaused:Y,pause:function(){if(!g)throw r;O.pause();},isSeeking:function(){if(!g)throw r;return O.isSeeking()},isDynamic:function(){if(!g)throw r;return O.getIsDynamic()},seek:function(e){if(!g)throw r;if((0, qe.checkParameterType)(e,"number"),isNaN(e))throw se.default.BAD_ARGUMENT_ERROR;var t=O.getIsDynamic()?K(e):e;O.seek(t);},setPlaybackRate:function(e){X().playbackRate=e;},getPlaybackRate:function(){return X().playbackRate},setMute:function(e){(0, qe.checkParameterType)(e,"boolean"),X().muted=e;},isMuted:function(){return X().muted},setVolume:function(e){if("number"!=typeof e||isNaN(e)||e<0||1<e)throw se.default.BAD_ARGUMENT_ERROR;X().volume=e;},getVolume:function(){return X().volume},time:q,duration:H,timeAsUTC:function(){if(!g)throw r;return q()<0?NaN:ie(q())},durationAsUTC:function(){if(!g)throw r;return ie(H())},getActiveStream:J,getDVRWindowSize:function(){var e=w.getCurrentDVRInfo();return e?e.manifestInfo.DVRWindowSize:0},getDVRSeekOffset:K,convertToTimeCode:function(e){e=Math.max(e,0);var t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%3600%60);return (0===t?"":t<10?"0"+t.toString()+":":t.toString()+":")+(n<10?"0"+n.toString():n.toString())+":"+(r<10?"0"+r.toString():r.toString())},formatUTC:function(e,t,n){var r=!(arguments.length<=3||void 0===arguments[3])&&arguments[3],i=new Date(1e3*e),a=i.toLocaleDateString(t),o=i.toLocaleTimeString(t,{hour12:n});return r?o+" "+a:o},getVersion:j,getDebug:function(){return l},getBufferLength:function(e){var t,n=[se.default.VIDEO,se.default.AUDIO,se.default.FRAGMENTED_TEXT];return e?-1===n.indexOf(e)?(d.warn("getBufferLength requested for invalid type"),NaN):(t=w.getCurrentBufferLevel(e))||NaN:(t=n.map(function(e){return 0<Z(e).length?w.getCurrentBufferLevel(e):Number.MAX_VALUE}).reduce(function(e,t){return Math.min(e,t)}))===Number.MAX_VALUE?NaN:t},getTTMLRenderingDiv:function(){return x?x.getTTMLRenderingDiv():null},getVideoElement:X,getSource:function(){if(!f)throw e;return f},getCurrentLiveLatency:function(){if(!h)throw a;return g?O.getCurrentLiveLatency():NaN},getTopBitrateInfoFor:function(e){if(!p)throw i;return E.getTopBitrateInfoFor(e)},setAutoPlay:V,getAutoPlay:function(){return _},getDashMetrics:W,getQualityFor:function(e){if(!p)throw i;if(e!==se.default.IMAGE)return E.getQualityFor(e);var t=J();if(!t)return -1;var n=t.getThumbnailController();return n?n.getCurrentTrackIndex():-1},setQualityFor:function(e,t){if(!p)throw i;if(e===se.default.IMAGE){var n=J();if(!n)return;var r=n.getThumbnailController();r&&r.setTrackByIndex(t);}E.setPlaybackQuality(e,C.getActiveStreamInfo(),t);},updatePortalSize:function(){E.setElementSize(),E.setWindowResizeEventCalled(!0);},setTextDefaultLanguage:function(e){d.warn('setTextDefaultLanguage is deprecated and will be removed in version 3.2.0. Please use setInitialMediaSettingsFor("fragmentedText", { lang: lang }) instead'),void 0===F&&(F=(0, ve.default)(o).getInstance()),F.setTextDefaultLanguage(e);},getTextDefaultLanguage:function(){return d.warn('getTextDefaultLanguage is deprecated and will be removed in version 3.2.0. Please use getInitialMediaSettingsFor("fragmentedText").lang instead'),void 0===F&&(F=(0, ve.default)(o).getInstance()),F.getTextDefaultLanguage()},setTextDefaultEnabled:function(e){void 0===F&&(F=(0, ve.default)(o).getInstance()),F.setTextDefaultEnabled(e);},getTextDefaultEnabled:function(){return void 0===F&&(F=(0, ve.default)(o).getInstance()),F.getTextDefaultEnabled()},enableText:function(e){void 0===F&&(F=(0, ve.default)(o).getInstance()),F.enableText(e);},enableForcedTextStreaming:function(e){void 0===F&&(F=(0, ve.default)(o).getInstance()),F.enableForcedTextStreaming(e);},isTextEnabled:function(){return void 0===F&&(F=(0, ve.default)(o).getInstance()),F.isTextEnabled()},setTextTrack:function(e){if(!g)throw r;void 0===F&&(F=(0, ve.default)(o).getInstance()),F.setTextTrack(e);},getBitrateInfoListFor:function(e){if(!p)throw i;var t=J();return t?t.getBitrateListFor(e):[]},getStreamsFromManifest:function(e){if(!p)throw i;return R.getStreamsInfo(e)},getTracksFor:Z,getTracksForTypeFromManifest:function(e,t,n){if(!p)throw i;return (n=n||R.getStreamsInfo(t,1)[0])?R.getAllMediaInfoForType(n,e,t):[]},getCurrentTrackFor:function(e){if(!p)throw i;var t=C.getActiveStreamInfo();return y.getCurrentTrackFor(e,t)},setInitialMediaSettingsFor:function(e,t){if(!h)throw a;y.setInitialSettings(e,t),e===se.default.FRAGMENTED_TEXT&&F.setInitialSettings(t);},getInitialMediaSettingsFor:function(e){if(!h)throw a;return y.getInitialSettings(e)},setCurrentTrack:function(e){if(!p)throw i;y.setTrack(e);},getTrackSwitchModeFor:function(e){if(!h)throw a;return y.getSwitchMode(e)},setTrackSwitchModeFor:function(e,t){if(!h)throw a;y.setSwitchMode(e,t);},setSelectionModeForInitialTrack:function(e){if(!h)throw a;y.setSelectionModeForInitialTrack(e);},getSelectionModeForInitialTrack:function(){if(!h)throw a;return y.getSelectionModeForInitialTrack()},addABRCustomRule:function(e,t,n){b.addABRCustomRule(e,t,n);},removeABRCustomRule:function(e){b.removeABRCustomRule(e);},removeAllABRCustomRule:function(){b.removeABRCustomRule();},getAverageThroughput:function(e){var t=E.getThroughputHistory();return t?t.getAverageThroughput(e):0},retrieveManifest:function(e,n){var r=te(),i=this;s.on(Oe.default.INTERNAL_MANIFEST_LOADED,function e(t){t.error?n(null,t.error):n(t.manifest),s.off(Oe.default.INTERNAL_MANIFEST_LOADED,e,i),r.reset();},i),U.initialize(e),r.load(e);},addUTCTimingSource:function(e,t){b.addUTCTimingSource(e,t);},removeUTCTimingSource:function(e,t){b.removeUTCTimingSource(e,t);},clearDefaultUTCTimingSources:function(){b.clearDefaultUTCTimingSources();},restoreDefaultUTCTimingSources:z,setXHRWithCredentialsForType:function(e,t){b.setXHRWithCredentialsForType(e,t);},getXHRWithCredentialsForType:function(e){return b.getXHRWithCredentialsForType(e)},getProtectionController:ne,attachProtectionController:function(e){T=e;},setProtectionData:function(e){c=e,C&&C.setProtectionData(c);},displayCaptionsOnTop:function(e){var t=(0, Ee.default)(o).getInstance();t.setConfig({videoModel:x}),t.initialize(),t.setDisplayCConTop(e);},attachTTMLRenderingDiv:function(e){if(!x.getElement())throw t;x.setTTMLRenderingDiv(e);},getCurrentTextTrackIndex:function(){var e=NaN;return F&&(e=F.getCurrentTrackIdx()),e},provideThumbnail:function(e,t){if("function"==typeof t)if(e<0)t(null);else {var n=O.getIsDynamic()?K(e):e,r=C.getStreamForTime(n);if(null!==r){var i=r.getThumbnailController();if(i){var a=C.getTimeRelativeToStreamId(n,r.getId());return i.provide(a,t)}t(null);}else t(null);}},getDashAdapter:function(){return R},getOfflineController:re,getSettings:function(){return u.get()},updateSettings:function(e){u.update(e);},resetSettings:function(){u.reset();},reset:function(){$(null),Q(null),c=null,T&&(T.reset(),T=null),S&&(S.reset(),S=null),B.reset(),u.reset(),I&&(I.reset(),I=null);}},d=l.getLogger(n),_=!(p=g=h=!1),B=R=c=I=T=null,Oe.default.extend(we.default),b=(0, Se.default)(o).getInstance(),x=(0, Re.default)(o).getInstance(),U=(0, ye.default)(o).getInstance(),n}i.__dashjs_factory_name="MediaPlayer";var a=Pe.default.getClassFactory(i);a.events=we.default,a.errors=Ne.default,Pe.default.updateClassFactory(i.__dashjs_factory_name,a),n.default=a,t.exports=n.default;},{1:1,101:101,108:108,109:109,111:111,112:112,117:117,119:119,121:121,148:148,150:150,151:151,153:153,154:154,157:157,2:2,200:200,202:202,206:206,207:207,209:209,212:212,217:217,218:218,220:220,225:225,241:241,45:45,46:46,47:47,48:48,50:50,51:51,54:54,56:56,58:58,61:61,63:63,82:82,9:9,98:98,99:99}],101:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n,r=!1;null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0;}};var i,a=e(55);function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r(Object.getPrototypeOf(o.prototype),"constructor",this).call(this),this.AST_IN_FUTURE="astInFuture",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_LOADED="bufferLoaded",this.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",this.ERROR="error",this.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",this.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",this.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",this.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",this.LOG="log",this.MANIFEST_LOADED="manifestLoaded",this.METRICS_CHANGED="metricsChanged",this.METRIC_CHANGED="metricChanged",this.METRIC_ADDED="metricAdded",this.METRIC_UPDATED="metricUpdated",this.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",this.PERIOD_SWITCH_STARTED="periodSwitchStarted",this.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",this.QUALITY_CHANGE_RENDERED="qualityChangeRendered",this.TRACK_CHANGE_RENDERED="trackChangeRendered",this.SOURCE_INITIALIZED="sourceInitialized",this.STREAM_INITIALIZING="streamInitializing",this.STREAM_INITIALIZED="streamInitialized",this.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",this.TEXT_TRACKS_ADDED="allTextTracksAdded",this.TEXT_TRACK_ADDED="textTrackAdded",this.TTML_PARSED="ttmlParsed",this.TTML_TO_PARSE="ttmlToParse",this.CAPTION_RENDERED="captionRendered",this.CAPTION_CONTAINER_RESIZE="captionContainerResize",this.CAN_PLAY="canPlay",this.PLAYBACK_ENDED="playbackEnded",this.PLAYBACK_ERROR="playbackError",this.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",this.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",this.PLAYBACK_PAUSED="playbackPaused",this.PLAYBACK_PLAYING="playbackPlaying",this.PLAYBACK_PROGRESS="playbackProgress",this.PLAYBACK_RATE_CHANGED="playbackRateChanged",this.PLAYBACK_SEEKED="playbackSeeked",this.PLAYBACK_SEEKING="playbackSeeking",this.PLAYBACK_SEEK_ASKED="playbackSeekAsked",this.PLAYBACK_STALLED="playbackStalled",this.PLAYBACK_STARTED="playbackStarted",this.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",this.PLAYBACK_WAITING="playbackWaiting",this.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged";}var s=new(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);}(o,((i=a)&&i.__esModule?i:{default:i}).default),o);n.default=s,t.exports=n.default;},{55:55}],102:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(100),a=(r=i)&&r.__esModule?r:{default:r};var s,o,u=(s="application/dash+xml",{create:l,createAll:function(e,t){var n=[];e=e||"[data-dashjs-player]";for(var r=(t=t||document).querySelectorAll(e),i=0;i<r.length;i++){var a=l(r[i],null);n.push(a);}for(var o=t.querySelectorAll('source[type="'+s+'"]'),i=0;i<o.length;i++)a=l(function(e){for(var t=!0;t;){var n=e;if(t=!1,/^VIDEO$/i.test(n.nodeName))return n;e=n.parentNode,t=!0;}}(o[i]),null),n.push(a);return n}});function l(e,t,n){if(!e||!/^VIDEO$/i.test(e.nodeName))return null;if(e._dashjs_player)return e._dashjs_player;var r=void 0,i=e.id||e.name||"video element";if(!(t=t||[].slice.call(e.querySelectorAll("source")).filter(function(e){return e.type==s})[0])&&e.src)(t=document.createElement("source")).src=e.src;else if(!t&&!e.src)return null;return n=n||{},(r=(0, a.default)(n).create()).initialize(e,t.src,e.autoplay),(o=o||r.getDebug().getLogger()).debug("Converted "+i+" to dash.js player and added content: "+t.src),e._dashjs_player=r}var d=o=void 0;"undefined"!=typeof window&&window&&window.dashjs&&window.dashjs.skipAutoCreate||"undefined"==typeof window||!window||!window.addEventListener||("complete"===window.document.readyState?window.dashjs?u.createAll():d=window.setInterval(function(){window.dashjs&&(window.clearInterval(d),u.createAll());},500):window.addEventListener("load",function e(){window.removeEventListener("load",e),u.createAll();})),n.default=u,t.exports=n.default;},{100:100}],103:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var u=r(e(45)),i=r(e(47));function a(e){var t=this.context,n=void 0,r=void 0,a=void 0,o=[],i=e;function s(t,n){o=o.filter(function(e){return !((isNaN(n)||e.start<n)&&(isNaN(t)||e.end>t))});}return n={getAllBufferRanges:function(){for(var t=[],e=0;e<o.length;e++){var n=o[e];0===t.length||n.start>t[t.length-1].end?t.push({start:n.start,end:n.end}):t[t.length-1].end=n.end;}var r={start:function(e){return t[e].start},end:function(e){return t[e].end}};return Object.defineProperty(r,"length",{get:function(){return t.length}}),r},append:function(e){a="InitializationSegment"!==e.segmentType?(o.push(e),o.sort(function(e,t){return e.start-t.start}),null):e,r.debug("PreBufferSink appended chunk s: "+e.start+"; e: "+e.end),i&&i({chunk:e});},remove:s,abort:function(){},discharge:function(e,t){var n,r,i=(n=e,r=t,o.filter(function(e){return (isNaN(r)||e.start<r)&&(isNaN(n)||e.end>n)}));return a&&(i.push(a),a=null),s(e,t),i},reset:function(){o=[],i=a=null;},updateTimestampOffset:function(){},hasDiscontinuitiesAfter:function(){return !1},waitForUpdateEnd:function(e){e();},getBuffer:function(){return this}},r=(0, u.default)(t).getInstance().getLogger(n),n}a.__dashjs_factory_name="PreBufferSink";var o=i.default.getClassFactory(a);n.default=o,t.exports=n.default;},{45:45,47:47}],104:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var A=r(e(45)),I=r(e(225)),R=r(e(46)),b=r(e(54)),i=r(e(47)),D=r(e(200)),M=r(e(51));function a(i,r,e,t,a){var o=this.context,u=(0, R.default)(o).getInstance(),s=void 0,l=void 0,d=void 0,f=void 0,c=void 0,n=[],h=[],p=e,g=!1!==t;function _(){try{return d.buffered}catch(e){return l.error("getAllBufferRanges exception: "+e.message),null}}function E(){var t=this,s=this;0<h.length&&function(){f=!0;var a=h[0];h.splice(0,1);function e(){var e,t,n,r,i=_();e=s,n=i,r=a,(t=o)&&0<t.length&&t.length<n.length&&function(e,t){for(var n=0;n<e.length;n++){var r=Math.round(e.start(n)),i=Math.round(e.end(n));if(i===t.start||r===t.end||t.start>=r&&t.end<=i)return !0}return !1}(t,r)&&u.trigger(b.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:e,from:n.end(n.length-2),to:n.start(n.length-1),unintended:!0}),0<h.length?E.call(this):(f=!1,p&&p({chunk:a}));}var o=[];try{0===a.bytes.length?e.call(t):(o=_(),d.appendBuffer?d.appendBuffer(a.bytes):d.append(a.bytes,a),S(e.bind(t)));}catch(e){l.fatal('SourceBuffer append failed "'+e+'"'),0<h.length?E():f=!1,p&&p({chunk:a,error:new I.default(e.code,e.message)});}}();}function m(){var e;0<n.length&&(e=n.shift(),d.updating?S(e):(e(),m()));}function v(){d.updating||m();}function y(){d.updating||m();}function T(){l.error("SourceBufferSink error",r.type);}function S(e){n.push(e),d.updating||m();}return s={getAllBufferRanges:_,getBuffer:function(){return d},append:function(e){e?(h.push(e),f||S(E.bind(this))):p({chunk:e,error:new I.default(M.default.APPEND_ERROR_CODE,M.default.APPEND_ERROR_MESSAGE)});},remove:function(t,n,e){var r=this;S(function(){try{0<=t&&t<n&&(e||"ended"!==i.readyState)&&d.remove(t,n),S(function(){u.trigger(b.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:r,from:t,to:n,unintended:!1});});}catch(e){u.trigger(b.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:r,from:t,to:n,unintended:!1,error:new I.default(e.code,e.message)});}});},abort:function(){try{("open"===i.readyState||d.setTextTrack&&"ended"===i.readyState)&&d.abort();}catch(e){l.error('SourceBuffer append abort failed: "'+e+'"');}h=[];},reset:function(e){if(d){if("function"==typeof d.removeEventListener&&(d.removeEventListener("updateend",y,!1),d.removeEventListener("error",T,!1),d.removeEventListener("abort",T,!1)),clearInterval(c),d.appendWindowEnd=1/0,!e){try{d.getClassName&&"TextSourceBuffer"===d.getClassName()||i.removeSourceBuffer(d);}catch(e){l.error("Failed to remove source buffer from media source.");}d=null;}f=!1;}h=[],p=null;},updateTimestampOffset:function(e){d.timestampOffset===e||isNaN(e)||S(function(){d.timestampOffset=e;});},hasDiscontinuitiesAfter:function(e){try{var t=_();if(t&&1<t.length)for(var n=0,r=t.length;n<r;n++)if(0<n&&e<t.start(n)&&t.start(n)>t.end(n-1)+.1)return !0}catch(e){l.error("hasDiscontinuities exception: "+e.message);}return !1},waitForUpdateEnd:S},function(){l=(0, A.default)(o).getInstance().getLogger(s),f=!1;var t=r.codec;try{if(t.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))throw new Error("not really supported");(d=a||i.addSourceBuffer(t)).changeType&&a&&(l.debug("Doing period transition with changeType"),d.changeType(t)),g&&d&&(d.appendWindowEnd=i.duration);if("function"==typeof d.addEventListener)try{d.addEventListener("updateend",y,!1),d.addEventListener("error",T,!1),d.addEventListener("abort",T,!1);}catch(e){c=setInterval(v,50);}else c=setInterval(v,50);}catch(e){if(!r.isText&&-1===t.indexOf('codecs="stpp')&&-1===t.indexOf('codecs="wvtt'))throw e;var n=(0, D.default)(o).getInstance();d=n.getTextSourceBuffer();}}(),s}a.__dashjs_factory_name="SourceBufferSink";var o=i.default.getClassFactory(a);n.default=o,t.exports=n.default;},{200:200,225:225,45:45,46:46,47:47,51:51,54:54}],105:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var le=r(e(108)),de=r(e(61)),fe=r(e(106)),ce=r(e(116)),he=r(e(203)),pe=r(e(46)),ge=r(e(54)),_e=r(e(45)),Ee=r(e(51)),i=r(e(47)),me=r(e(225)),ve=r(e(206)),ye=r(e(220));function a(u){u=u||{};var l=this.context,s=(0, pe.default)(l).getInstance(),e=(0, ye.default)(l).getInstance(),d=u.manifestModel,f=u.mediaPlayerModel,a=u.manifestUpdater,c=u.adapter,i=u.capabilities,h=u.errHandler,p=u.timelineConverter,t=u.dashMetrics,g=u.abrController,_=u.playbackController,o=u.eventController,E=u.mediaController,m=u.textController,v=u.videoModel,y=u.settings,r=void 0,T=void 0,S=void 0,A=void 0,I=void 0,R=void 0,b=void 0,D=void 0,M=void 0,N=void 0,C=void 0,O=void 0,w=void 0,P=void 0,L=void 0,x=void 0,F=void 0,U=void 0,k=[{codec:"avc1",compatibleCodecs:["avc3"]},{codec:"avc3",compatibleCodecs:["avc1"]}];function n(e){for(var t=A?A.length:0,n=0;n<t;n++){A[n].getFragmentModel().removeExecutedRequestsBeforeTime(Y()+j()),A[n].reset(!1,e);}se(b=R=!(A=[])),s.off(ge.default.CURRENT_TRACK_CHANGED,W,r);}function B(){n(),S=null,M=D=I=!1,C=!(N={});}function G(){_&&_.pause(),w&&(w.reset(),w=null),B(),s.off(ge.default.DATA_UPDATE_COMPLETED,te,r),s.off(ge.default.BUFFERING_COMPLETED,ee,r),s.off(ge.default.INBAND_EVENTS,ne,r),O&&(s.off(ge.default.KEY_ERROR,V,r),s.off(ge.default.SERVER_CERTIFICATE_UPDATED,V,r),s.off(ge.default.LICENSE_REQUEST_COMPLETE,V,r),s.off(ge.default.KEY_SYSTEM_SELECTED,V,r),s.off(ge.default.KEY_SESSION_CREATED,V,r),s.off(ge.default.KEY_STATUSES_CHANGED,V,r)),se(!1);}function j(){return S?S.duration:NaN}function Y(){return S?S.start:NaN}function K(){return S?S.id:null}function q(){return S}function H(){if(!(v&&g&&g.hasOwnProperty("getBitrateList")&&c&&c.hasOwnProperty("getAllMediaInfoForType")&&c.hasOwnProperty("getEventsFor")))throw new Error(le.default.MISSING_CONFIG_ERROR)}function V(e){e.error&&(h.error(e.error),T.fatal(e.error.message),G());}function z(e){var t,n=e?e.type:null,r=void 0;if(n===le.default.MUXED)return r="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",T.fatal(r),void h.error(new me.default(Ee.default.MANIFEST_ERROR_ID_MULTIPLEXED_CODE,r,d.getValue()));if(n===le.default.TEXT||n===le.default.FRAGMENTED_TEXT||n===le.default.EMBEDDED_TEXT||n===le.default.IMAGE)return 1;if(t=e.codec,T.debug(n+" codec: "+t),e.contentProtection&&!i.supportsEncryptedMedia())h.error(new me.default(Ee.default.CAPABILITY_MEDIAKEYS_ERROR_CODE,Ee.default.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE));else if(!i.supportsCodec(t))return r=n+"Codec ("+t+") is not supported.",void T.error(r);return 1}function W(e){var t,n,r,i;S&&e.newMediaInfo.streamInfo.id===S.id&&(t=e.newMediaInfo,n=d.getValue(),c.setCurrentMediaInfo(S.id,t.type,t),(r=re(t))&&(i=_.getTime(),T.info("Stream -  Process track changed at current time "+i),T.debug("Stream -  Update stream controller"),n.refreshManifestOnSwitchTrack?(T.debug("Stream -  Refreshing manifest for switch track"),U=e,a.refreshManifest()):(r.selectMediaInfo(t),t.type!==le.default.FRAGMENTED_TEXT?(g.updateTopQualityIndex(t),r.switchTrackAsked(),r.getFragmentModel().abortRequests()):(r.getScheduleController().setSeekTarget(i),r.setIndexHandlerTime(i),r.resetIndexHandler()))));}function X(e,t){var n,r=c.getAllMediaInfoForType(S,e),i=null;if(r&&0!==r.length){e===le.default.VIDEO&&(D=!0),e===le.default.AUDIO&&(M=!0);for(var a=0,o=r.length;a<o;a++)if(i=r[a],e===le.default.EMBEDDED_TEXT)m.addEmbeddedTrack(i);else {if(!z(i))continue;E.addTrack(i);}e!==le.default.EMBEDDED_TEXT&&0!==E.getTracksFor(e,S).length&&(e!==le.default.IMAGE?(E.checkInitialMediaSettingsForType(e,S),n=E.getCurrentTrackFor(e,S),s.trigger(ge.default.STREAM_INITIALIZING,{streamInfo:S,mediaInfo:i}),function(e,t,n,r){var i=w.getModel(K(),e?e.type:null),a=(0, fe.default)(l).create({streamInfo:S,type:e?e.type:null,mimeType:e?e.mimeType:null,timelineConverter:p,adapter:c,manifestModel:d,mediaPlayerModel:f,fragmentModel:i,dashMetrics:u.dashMetrics,baseURLController:u.baseURLController,abrController:g,playbackController:_,mediaController:E,textController:m,errHandler:h,settings:y,boxParser:x});if(a.initialize(n,D),g.updateTopQualityIndex(e),A.push(a),!r)if(!e||e.type!==le.default.TEXT&&e.type!==le.default.FRAGMENTED_TEXT)a.addMediaInfo(e,!0);else {for(var o=void 0,s=0;s<t.length;s++)t[s].index===e.index&&(o=s),a.addMediaInfo(t[s]);a.selectMediaInfo(t[o]);}}(n,r,t)):P=(0, he.default)(l).create({streamInfo:S,adapter:c,baseURLController:u.baseURLController,timelineConverter:u.timelineConverter,debug:F,eventBus:s,events:ge.default,dashConstants:de.default}));}else T.info("No "+e+" data.");}function Q(){var e;o&&(e=c.getEventsFor(S),o.addInlineEvents(e));}function Z(e){var r=c.getAdaptationForType(S?S.index:null,e,S);r&&Array.isArray(r.Representation_asArray)&&(r.Representation_asArray=r.Representation_asArray.filter(function(e,t){if(0===t)return !0;var n=c.getCodec(r,t,!0);return !!i.supportsCodec(n)||(T.error("[Stream] codec not supported: "+n),!1)}));}function $(){for(var e=A.length,t=!!N.audio||!!N.video?new me.default(Ee.default.DATA_UPDATE_FAILED_ERROR_CODE,Ee.default.DATA_UPDATE_FAILED_ERROR_MESSAGE):null,n=0;n<e;n++)if(A[n].isUpdating()||C)return;if(b){if(O)for(n=0;n<e&&A[n];n++)A[n].getType()!==le.default.AUDIO&&A[n].getType()!==le.default.VIDEO&&A[n].getType()!==le.default.FRAGMENTED_TEXT||O.initializeForMedia(A[n].getMediaInfo());t?h.error(t):I||(I=!0,p.setTimeSyncCompleted(!0),s.trigger(ge.default.STREAM_INITIALIZED,{streamInfo:S,liveStartTime:function(){if(!S.manifestInfo.isDynamic)return NaN;for(var e=0;e<A.length;e++)if(A[e].getType()===le.default.AUDIO||A[e].getType()===le.default.VIDEO)return A[e].getLiveStartTime();return NaN}()}));for(n=0;n<e&&A[n];n++)A[n].getScheduleController().start();}}function J(e){for(var t={},n=0,r=A.length;n<r;n++){var i=A[n].createBuffer(e);i&&(t[A[n].getType()]=i.getBuffer());}return t}function ee(e){if(e.streamId===S.id){var t=ie(),n=t.length;if(0!==n){for(var r=0;r<n;r++)if(!t[r].isBufferingCompleted()&&(t[r].getType()===le.default.AUDIO||t[r].getType()===le.default.VIDEO))return void T.warn("onBufferingCompleted - One streamProcessor has finished but",t[r].getType(),"one is not buffering completed");T.debug("onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED"),s.trigger(ge.default.STREAM_BUFFERING_COMPLETED,{streamInfo:S});}else T.warn("onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined");}}function te(e){S&&e.sender.getStreamId()===S.id&&(N[e.sender.getType()]=e.error,$());}function ne(e){var t;S&&e.sender.getStreamInfo().id===S.id&&(t=e.events,o&&o.addInbandEvents(t));}function re(t){return t?ie().filter(function(e){return e.getType()===t.type})[0]:null}function ie(){for(var e=[],t=void 0,n=void 0,r=0;r<A.length;r++)(t=(n=A[r]).getType())!==le.default.AUDIO&&t!==le.default.VIDEO&&t!==le.default.FRAGMENTED_TEXT&&t!==le.default.TEXT||e.push(n);return e}function ae(e,t){if(!e)return !1;var n=e.getStreamInfo(),r=S;if(!n||!r)return !1;var i=c.getAdaptationForType(n.index,t,n),a=c.getAdaptationForType(r.index,t,r);return i&&a?!i.ContentProtection&&!a.ContentProtection:!i&&!a}function oe(e,t){if(!e||!e.hasOwnProperty("getStreamInfo"))return !1;var n=e.getStreamInfo(),r=S;if(!n||!r)return !1;var i=c.getAdaptationForType(n.index,t,n),a=c.getAdaptationForType(r.index,t,r);if(!i||!a)return !i&&!a;var o=i&&a&&i.mimeType===a.mimeType,s=a.Representation_asArray.map(function(e){return e.codecs}),u=i.Representation_asArray.map(function(e){return e.codecs}),l=u.some(function(e){return -1<s.indexOf(e)}),d=u.some(function(t){return s.some(function(e){return function(e,t){for(var n=e.split(".")[0],r=0===t.indexOf(n),i=void 0,a=0;a<k.length;a++)if(k[a].codec===n){i=k[a];break}if(i)return r||i.compatibleCodecs.some(function(e){return 0===t.indexOf(e)});return r}(e,t)})});return l||d&&o}function se(e){L=e;}function ue(){return L}return r={initialize:function(e,t){S=e,(O=t)&&(s.on(ge.default.KEY_ERROR,V,r),s.on(ge.default.SERVER_CERTIFICATE_UPDATED,V,r),s.on(ge.default.LICENSE_REQUEST_COMPLETE,V,r),s.on(ge.default.KEY_SYSTEM_SELECTED,V,r),s.on(ge.default.KEY_SESSION_CREATED,V,r),s.on(ge.default.KEY_STATUSES_CHANGED,V,r));},activate:function(e,t){if(R)return t;var n=void 0;return s.on(ge.default.CURRENT_TRACK_CHANGED,W,r),n=L?(function(){{var e;C=!0,H(),Z(le.default.VIDEO),Z(le.default.AUDIO),C=!(b=!0),0===A.length?(e="No streams to play.",h.error(new me.default(Ee.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,e,d.getValue())),T.debug(e)):$();}}(),t):function(e,t){H();var n=v.getElement();Q(),C=!0,Z(le.default.VIDEO),Z(le.default.AUDIO),(!n||n&&/^VIDEO$/i.test(n.nodeName))&&X(le.default.VIDEO,e);X(le.default.AUDIO,e),X(le.default.TEXT,e),X(le.default.FRAGMENTED_TEXT,e),X(le.default.EMBEDDED_TEXT,e),X(le.default.MUXED,e),X(le.default.IMAGE,e);var r=J(t);{var i;C=!(b=!0),0===A.length?(i="No streams to play.",h.error(new me.default(Ee.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,i,d.getValue())),T.fatal(i)):$();}return r}(e,t),R=!0,n},deactivate:n,isActive:function(){return R},getDuration:j,getStartTime:Y,getId:K,getStreamInfo:q,getHasAudioTrack:function(){return M},getHasVideoTrack:function(){return D},preload:function(e,t){Q(),X(le.default.VIDEO,e),X(le.default.AUDIO,e),X(le.default.TEXT,e),X(le.default.FRAGMENTED_TEXT,e),X(le.default.EMBEDDED_TEXT,e),X(le.default.MUXED,e),X(le.default.IMAGE,e),J(t),s.on(ge.default.CURRENT_TRACK_CHANGED,W,r);for(var n=0;n<A.length&&A[n];n++)A[n].getScheduleController().start();se(!0);},getThumbnailController:function(){return P},getBitrateListFor:function(e){if(H(),e===le.default.IMAGE)return P?P.getBitrateList():[];var t=function(e){for(var t=null,n=0;n<A.length;n++)if((t=A[n]).getType()===e)return t.getMediaInfo();return null}(e);return g.getBitrateList(t)},updateData:function(e){T.info("Manifest updated... updating data system wide."),C=!(R=!1),S=e,o&&Q(),Z(le.default.VIDEO),Z(le.default.AUDIO);for(var t=0,n=A.length;t<n;t++){var r=A[t];r.updateStreamInfo(S);var i=c.getMediaInfoForType(S,r.getType());g.updateTopQualityIndex(i),r.addMediaInfo(i,!0);}if(U&&(i=U.newMediaInfo).type!==le.default.FRAGMENTED_TEXT){var a=re(U.oldMediaInfo);if(!a)return;a.switchTrackAsked(),U=void 0;}C=!1,$();},reset:G,getProcessors:ie,setMediaSource:function(e){for(var t=0;t<A.length;)z(A[t].getMediaInfo())?(A[t].setMediaSource(e),t++):(A[t].reset(),A.splice(t,1));for(var n,t=0;t<A.length;t++)A[t].dischargePreBuffer();0===A.length&&(n="No streams to play.",h.error(new me.default(Ee.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,n+"nostreams",d.getValue())),T.fatal(n));},isMediaCodecCompatible:function(e){return oe(e,le.default.VIDEO)&&oe(e,le.default.AUDIO)},isProtectionCompatible:function(e){return ae(e,le.default.VIDEO)&&ae(e,le.default.AUDIO)},getPreloaded:ue},F=(0, _e.default)(l).getInstance(),T=F.getLogger(r),B(),x=(0, ve.default)(l).getInstance(),w=(0, ce.default)(l).create({mediaPlayerModel:f,dashMetrics:t,errHandler:h,settings:y,boxParser:x,dashConstants:de.default,urlUtils:e}),s.on(ge.default.BUFFERING_COMPLETED,ee,r),s.on(ge.default.DATA_UPDATE_COMPLETED,te,r),s.on(ge.default.INBAND_EVENTS,ne,r),r}a.__dashjs_factory_name="Stream",n.default=i.default.getClassFactory(a),t.exports=n.default;},{106:106,108:108,116:116,203:203,206:206,220:220,225:225,45:45,46:46,47:47,51:51,54:54,61:61}],106:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var W=r(e(108)),X=r(e(61)),Q=r(e(109)),Z=r(e(149)),$=r(e(114)),J=r(e(199)),ee=r(e(120)),te=r(e(62)),ne=r(e(215)),i=r(e(47)),re=e(218),ie=r(e(46)),ae=r(e(54)),oe=r(e(57)),se=r(e(51)),ue=r(e(225)),le=r(e(45)),de=r(e(217)),fe=r(e(220)),ce=r(e(206)),he=r(e(227)),pe=e(243);function a(n){n=n||{};var c=this.context,l=(0, ie.default)(c).getInstance(),d=n.streamInfo,f=n.type,r=n.errHandler,i=n.mimeType,a=n.timelineConverter,h=n.adapter,o=n.manifestModel,s=n.mediaPlayerModel,p=n.fragmentModel,u=n.abrController,g=n.playbackController,_=n.mediaController,E=n.textController,m=n.dashMetrics,v=n.settings,y=n.boxParser,T=void 0,S=void 0,A=void 0,I=void 0,R=void 0,b=void 0,D=void 0,M=void 0,N=void 0,C=void 0;function O(){R=[],I=null;}function w(e){e.sender.getType()===f&&e.sender.getStreamId()===d.id&&(e.error||D.setCurrentRepresentation(h.convertDataToRepresentationInfo(e.currentRepresentation)),e.error&&e.error.code!==se.default.SEGMENTS_UPDATE_FAILED_ERROR_CODE||t());}function P(e){var t;f===e.mediaType&&d.id===e.streamInfo.id&&(t=G(e.newQuality),D.setCurrentRepresentation(t),m.pushPlayListTraceMetrics(new Date,pe.PlayListTrace.REPRESENTATION_SWITCH_STOP_REASON),m.createPlaylistTraceMetrics(t.id,1e3*g.getTime(),g.getPlaybackRate()));}function L(e){e.streamId===d.id&&e.mediaType===f&&(m.addBufferLevel(f,new Date,1e3*e.bufferLevel),o.getValue().doNotUpdateDVRWindowOnBufferUpdated||t());}function x(e){e.streamId===d.id&&e.mediaType===f&&(m.addBufferState(f,e.state,D.getBufferTarget()),e.state!==Q.default.BUFFER_EMPTY||g.isSeeking()||m.pushPlayListTraceMetrics(new Date,pe.PlayListTrace.REBUFFERING_REASON));}function F(e){e.streamId===d.id&&e.mediaType===f&&(e.unintended?p.removeExecutedRequestsAfterTime(e.from):p.syncExecutedRequestsWithBufferedRange(b.getBuffer().getAllBufferRanges(),d.duration));}function t(){var e=d.manifestInfo,t=e.isDynamic,n=a.calcSegmentAvailabilityRange(M.getCurrentRepresentation(),t);m.addDVRInfo(f,g.getTime(),e,n);}function e(){return f}function U(){return b?b.getBuffer():null}function k(){return R}function B(){return I}function G(e){var t=void 0,t=void 0!==e?((0, re.checkInteger)(e),M?M.getRepresentationForQuality(e):null):M?M.getCurrentRepresentation():null;return h.convertDataToRepresentationInfo(t)}function j(e){var t;e.sender&&e.mediaType===f&&e.streamId===d.id&&(h.getIsTextTrack(i)&&!E.isTextEnabled()||b&&e.representationId&&(b.appendInitSegment(e.representationId)||(t=C?C.getInitRequest(I,M.getCurrentRepresentation()):null,D.processInitRequest(t))));}function Y(e){var t;e.sender&&e.mediaType===f&&e.streamId===d.id&&(t=void 0,b.getIsPruningInProgress()||(t=function(e,t){var n=G(),r=!isNaN(e),i=g.getNormalizedTime(),a=r?e:V(),o=!1,s=void 0;if(isNaN(a)||f===W.default.FRAGMENTED_TEXT&&!E.isTextEnabled())return null;{var u,l;b&&(u=b.getRangeAt(a),l=b.getRangeAt(i),null===u&&null===l||r||(!u||l&&l.start!=u.start&&l.end!=u.end)&&b.getBuffer().hasDiscontinuitiesAfter(i)&&f!==W.default.FRAGMENTED_TEXT&&(p.removeExecutedRequestsAfterTime(l.end),o=!0));}if(t)a=t.startTime+t.duration/2,s=z(n,a,{timeThreshold:0,ignoreIsFinished:!0});else for(s=z(n,r||o?a:void 0,{keepIdx:!r&&!o});s&&s.action!==he.default.ACTION_COMPLETE&&p.isFragmentLoaded(s);)s=z(n);return s}(e.seekTarget,e.replacement))&&(D.setSeekTarget(NaN),e.replacement||(isNaN(t.startTime+t.duration)||H(t.startTime+t.duration),t.delayLoadingTime=(new Date).getTime()+D.getTimeToLoadDelay(),D.setTimeToLoadDelay(0))),D.processMediaRequest(t));}function K(e){var t,n,r,i,a,o,s,u=e.chunk;u.streamId===d.id&&u.mediaInfo.type==f&&(t=u.bytes,r=G(n=u.quality),i=M&&r?M.getRepresentationForQuality(r.quality):null,a=h.getEventsFor(r.mediaInfo),o=h.getEventsFor(r,i),(a&&0<a.length||o&&0<o.length)&&(s=function(e,t,n,r){for(var i=Math.max(!t||isNaN(t.startTime)?0:t.startTime,0),a=[],o=[],s=n.concat(r),u=0,l=s.length;u<l;u++)a[s[u].schemeIdUri+"/"+s[u].value]=s[u];for(var d=(0, ce.default)(c).getInstance().parse(e).getBoxes("emsg"),u=0,l=d.length;u<l;u++){var f=h.getEvent(d[u],a,i);f&&o.push(f);}return o}(t,p.getRequests({state:Z.default.FRAGMENT_MODEL_EXECUTED,quality:n,index:u.index})[0],a,o),l.trigger(ae.default.INBAND_EVENTS,{sender:T,events:s})));}function q(e){e.mediaType===f&&e.streamId===d.id&&(H(e.time),D.setSeekTarget(e.time));}function H(e){C&&C.setCurrentTime(e);}function V(){return C?C.getCurrentTime():NaN}function z(e,t,n){var r,i=null;return C&&(r=M&&e?M.getRepresentationForQuality(e.quality):null,i=void 0!==t&&void 0!==n?C.getSegmentRequestForTime(I,r,t,n):C.getNextSegmentRequest(I,r)),i}return T={initialize:function(e,t){C=(0, oe.default)(c).create({streamInfo:d,type:f,timelineConverter:a,dashMetrics:m,mediaPlayerModel:s,baseURLController:n.baseURLController,errHandler:r,settings:v,boxParser:y,events:ae.default,eventBus:l,errors:se.default,debug:(0, le.default)(c).getInstance(),requestModifier:(0, de.default)(c).getInstance(),dashConstants:X.default,constants:W.default,urlUtils:(0, fe.default)(c).getInstance()}),(A=d.manifestInfo.isDynamic)&&(N=(0, ne.default)(c).create({timelineConverter:a})),C.initialize(A),u.registerStreamType(f,T),M=(0, te.default)(c).create({streamId:d.id,type:f,abrController:u,dashMetrics:m,playbackController:g,timelineConverter:a,dashConstants:X.default,events:ae.default,eventBus:l,errors:se.default}),(b=function(e){var t=null;if(!e)return r.error(new ue.default(se.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,se.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+"not properly defined")),null;t=e===W.default.VIDEO||e===W.default.AUDIO?(0, $.default)(c).create({streamInfo:d,type:e,mediaPlayerModel:s,manifestModel:o,fragmentModel:p,errHandler:r,mediaController:_,representationController:M,adapter:h,textController:E,abrController:u,playbackController:g,settings:v}):(0, J.default)(c).create({streamInfo:d,type:e,mimeType:i,mediaPlayerModel:s,manifestModel:o,fragmentModel:p,errHandler:r,mediaController:_,representationController:M,adapter:h,textController:E,abrController:u,playbackController:g,settings:v});return t}(f))&&b.initialize(e),(D=(0, ee.default)(c).create({streamId:d.id,type:f,mimeType:i,adapter:h,dashMetrics:m,mediaPlayerModel:s,fragmentModel:p,abrController:u,playbackController:g,textController:E,mediaController:_,bufferController:b,settings:v})).initialize(t);},isUpdating:function(){return !!M&&M.isUpdating()},getType:e,getBufferController:function(){return b},getFragmentModel:function(){return p},getScheduleController:function(){return D},getRepresentationController:function(){return M},getRepresentationInfo:G,getBufferLevel:function(){return b?b.getBufferLevel():0},isBufferingCompleted:function(){return !!b&&b.getIsBufferingCompleted()},createBuffer:function(e){return U()||b?b.createBuffer(R,e):null},updateStreamInfo:function(e){d=e;},getStreamInfo:function(){return d},selectMediaInfo:function(e){e===I||e&&I&&e.type!==I.type||(I=e);var t,n,r,i,a,o=h.getRealAdaptation(d,I),s=h.getVoRepresentations(I);M&&(t=M.getData(),n=u.getTopQualityIndexFor(f,d.id),r=u.getMinAllowedIndexFor(f),a=void 0,a=(i=null)!==t&&t.id==o.id||f===W.default.FRAGMENTED_TEXT?u.getQualityFor(f):(i=u.getThroughputHistory().getAverageThroughput(f)||u.getInitialBitrateFor(f),u.getQualityForBitrate(I,i)),void 0!==r&&a<r&&(a=r),n<a&&(a=n),C.setMimeType(I?I.mimeType:null),M.updateData(o,s,f,a));},addMediaInfo:function(e,t){-1===R.indexOf(e)&&R.push(e),t&&this.selectMediaInfo(e);},getLiveStartTime:function(){if(!A)return NaN;if(!N)return NaN;var e=NaN,t=G(),n=function(e,t){try{var n=null,r=g.getLiveDelay(),i=isNaN(d.manifestInfo.DVRWindowSize)?r:d.manifestInfo.DVRWindowSize,a=.1*i,o=void 0;if(!isFinite(i)||z(t,e-i+a,{ignoreIsFinished:!0}))for(;!n&&r<=i;)(n=z(t,o=e-r,{ignoreIsFinished:!0}))||(r+=1);return n&&g.setLiveDelay(r,!0),S.debug("live edge: "+e+", live delay: "+r+", live target: "+o),n}catch(e){return null}}(N.getLiveEdge(t),t);return n&&(e=!v.get().streaming.lowLatencyEnabled||n.duration<s.getLiveDelay()?n.startTime:n.startTime+n.duration-s.getLiveDelay()),e},switchTrackAsked:function(){D.switchTrackAsked();},getMediaInfoArr:k,getMediaInfo:B,getMediaSource:function(){return b.getMediaSource()},setMediaSource:function(e){b.setMediaSource(e,R);},dischargePreBuffer:function(){b.dischargePreBuffer();},getBuffer:U,setBuffer:function(e){b.setBuffer(e);},setIndexHandlerTime:H,getIndexHandlerTime:V,resetIndexHandler:function(){C&&C.resetIndex();},getInitRequest:function(e){(0, re.checkInteger)(e);var t=M?M.getRepresentationForQuality(e):null;return C?C.getInitRequest(I,t):null},getFragmentRequest:z,finalisePlayList:function(e,t){m.pushPlayListTraceMetrics(e,t);},reset:function(e,t){C&&C.reset(),b&&(b.reset(e,t),b=null),D&&(D.reset(),D=null),M&&(M.reset(),M=null),N&&(N.reset(),N=null),u&&u.unRegisterStreamType(f),l.off(ae.default.DATA_UPDATE_COMPLETED,w,T),l.off(ae.default.QUALITY_CHANGE_REQUESTED,P,T),l.off(ae.default.INIT_FRAGMENT_NEEDED,j,T),l.off(ae.default.MEDIA_FRAGMENT_NEEDED,Y,T),l.off(ae.default.MEDIA_FRAGMENT_LOADED,K,T),l.off(ae.default.BUFFER_LEVEL_UPDATED,L,T),l.off(ae.default.BUFFER_LEVEL_STATE_CHANGED,x,T),l.off(ae.default.BUFFER_CLEARED,F,T),l.off(ae.default.SEEK_TARGET,q,T),O(),d=f=null;}},S=(0, le.default)(c).getInstance().getLogger(T),O(),l.on(ae.default.DATA_UPDATE_COMPLETED,w,T,ie.default.EVENT_PRIORITY_HIGH),l.on(ae.default.QUALITY_CHANGE_REQUESTED,P,T),l.on(ae.default.INIT_FRAGMENT_NEEDED,j,T),l.on(ae.default.MEDIA_FRAGMENT_NEEDED,Y,T),l.on(ae.default.MEDIA_FRAGMENT_LOADED,K,T),l.on(ae.default.BUFFER_LEVEL_UPDATED,L,T),l.on(ae.default.BUFFER_LEVEL_STATE_CHANGED,x,T),l.on(ae.default.BUFFER_CLEARED,F,T),l.on(ae.default.SEEK_TARGET,q,T),T}a.__dashjs_factory_name="StreamProcessor",n.default=i.default.getClassFactory(a),t.exports=n.default;},{108:108,109:109,114:114,120:120,149:149,199:199,206:206,215:215,217:217,218:218,220:220,225:225,227:227,243:243,45:45,46:46,47:47,51:51,54:54,57:57,61:61,62:62}],107:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var u=r(e(225)),i=r(e(158)),l=e(241),d=r(e(232)),f=r(e(46)),c=r(e(54)),a=r(e(47)),h=r(e(51));function o(e){e=e||{};var a="urn:mpeg:dash:resolve-to-zero:2013",t=this.context,o=(0, f.default)(t).getInstance(),s=(0, i.default)(t).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,useFetch:e.settings?e.settings.get().streaming.lowLatencyEnabled:null,errors:h.default});return {load:function(n,r,i){function t(e,t){r.resolved=!0,r.resolvedContent=e||null,o.trigger(c.default.XLINK_ELEMENT_LOADED,{element:r,resolveObject:i,error:e||t?null:new u.default(h.default.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE,h.default.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE+n)});}var e;n===a?t(null,!0):(e=new d.default(n,l.HTTPRequest.XLINK_EXPANSION_TYPE),s.load({request:e,success:function(e){t(e);},error:function(){t(null);}}));},reset:function(){s&&(s.abort(),s=null);}}}o.__dashjs_factory_name="XlinkLoader",n.default=a.default.getClassFactory(o),t.exports=n.default;},{158:158,225:225,232:232,241:241,46:46,47:47,51:51,54:54}],108:[function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.init();}Object.defineProperty(n,"__esModule",{value:!0});var a=new(function(e,t,n){return t&&r(e.prototype,t),e}(i,[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.FRAGMENTED_TEXT="fragmentedText",this.EMBEDDED_TEXT="embeddedText",this.MUXED="muxed",this.IMAGE="image",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma",this.BAD_ARGUMENT_ERROR="Invalid Arguments",this.MISSING_CONFIG_ERROR="Missing config parameter(s)",this.LOCATION="Location",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.CC1="CC1",this.CC3="CC3",this.UTF8="utf-8",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.SERVICE_DESCRIPTION_LL_SCHEME="urn:dvb:dash:lowlatency:scope:2019",this.SUPPLEMENTAL_PROPERTY_LL_SCHEME="urn:dvb:dash:lowlatency:critical:2019",this.XML="XML",this.ARRAY_BUFFER="ArrayBuffer";}}]),i);n.default=a,t.exports=n.default;},{}],109:[function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.init();}Object.defineProperty(n,"__esModule",{value:!0});var a=new(function(e,t,n){return t&&r(e.prototype,t),e}(i,[{key:"init",value:function(){this.TCP_CONNECTION="TcpList",this.HTTP_REQUEST="HttpList",this.TRACK_SWITCH="RepSwitchList",this.BUFFER_LEVEL="BufferLevel",this.BUFFER_LOADED="bufferLoaded",this.ABANDON_LOAD="abandonload",this.ALLOW_LOAD="allowload",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_STATE="BufferState",this.DVR_INFO="DVRInfo",this.DROPPED_FRAMES="DroppedFrames",this.SCHEDULING_INFO="SchedulingInfo",this.REQUESTS_QUEUE="RequestsQueue",this.MANIFEST_UPDATE="ManifestUpdate",this.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",this.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",this.PLAY_LIST="PlayList",this.DVB_ERRORS="DVBErrors";}}]),i);n.default=a,t.exports=n.default;},{}],110:[function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.init();}Object.defineProperty(n,"__esModule",{value:!0});var a=new(function(e,t,n){return t&&r(e.prototype,t),e}(i,[{key:"init",value:function(){this.CLEARKEY_KEYSTEM_STRING="org.w3.clearkey",this.WIDEVINE_KEYSTEM_STRING="com.widevine.alpha",this.PLAYREADY_KEYSTEM_STRING="com.microsoft.playready";}}]),i);n.default=a,t.exports=n.default;},{}],111:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var Y=r(e(189)),K=r(e(108)),q=r(e(109)),H=r(e(224)),V=r(e(149)),z=r(e(46)),W=r(e(54)),i=r(e(47)),X=r(e(185)),Q=r(e(186)),Z=r(e(187)),$=r(e(184)),J=r(e(188)),ee=r(e(45)),te=e(241),ne=e(218);function a(){var f=this.context,e=(0, ee.default)(f).getInstance(),c=(0, z.default)(f).getInstance(),h=void 0,p=void 0,g=void 0,o=void 0,s=void 0,_=void 0,E=void 0,m=void 0,u=void 0,i=void 0,a=void 0,l=void 0,d=void 0,v=void 0,y=void 0,T=void 0,S=void 0,A=void 0,I=void 0,R=void 0,b=void 0,D=void 0,M=void 0;function n(){(g=(0, Y.default)(f).create({dashMetrics:D,mediaPlayerModel:y,settings:M})).initialize();}function t(){s={},_={},m={},E={},A={},b={},void 0===i&&(i=!1),R=I=S=void 0,clearTimeout(u),u=null;}function r(e){e.mediaType===K.default.VIDEO&&(S=e.oldQuality,I.push(S,v.getPlaybackQuality()));}function N(e){e.metric!==q.default.HTTP_REQUEST||!e.value||e.value.type!==te.HTTPRequest.MEDIA_SEGMENT_TYPE||e.mediaType!==K.default.AUDIO&&e.mediaType!==K.default.VIDEO||R.push(e.mediaType,e.value,M.get().streaming.abr.useDeadTimeLatency),e.metric!==q.default.BUFFER_LEVEL||e.mediaType!==K.default.AUDIO&&e.mediaType!==K.default.VIDEO||function(e,t){var n=M.get().streaming.abr.ABRStrategy;{if(n===K.default.ABR_STRATEGY_BOLA)return b[e]=!0;if(n===K.default.ABR_STRATEGY_THROUGHPUT)return b[e]=!1}var r=y.getStableBufferTime(),i=r,a=.5*r,o=b[e],s=(o?a:i)<t;(b[e]=s)!==o&&(s?p.info("["+e+"] switching from throughput to buffer occupancy ABR rule (buffer: "+t.toFixed(3)+")."):p.info("["+e+"] switching from buffer occupancy to throughput ABR rule (buffer: "+t.toFixed(3)+")."));}(e.mediaType,.001*e.value.level);}function C(e,t){return s[t]=s[t]||{},s[t].hasOwnProperty(e)||(s[t][e]=0),function(e,t){if(t!==K.default.VIDEO||!M.get().streaming.abr.limitBitrateByPortal||!E[t])return e;i||G();var n=d.getAdaptationForType(0,t).Representation,r=e;if(0<a&&0<l){for(;0<r&&n[r]&&a<n[r].width&&a-n[r-1].width<n[r].width-a;)--r;for(;r<n.length-1&&n[r].width===n[r+1].width;)r+=1;}return r}(function(e,t,n){var r=M.get().streaming.abr.maxRepresentationRatio[t];if(isNaN(r)||1<=r||r<0)return e;return Math.min(e,Math.round(n*r))}(function(e,t){var n=e;if(!E[t])return n;var r=w(t);void 0!==r&&(n=Math.max(e,r));var i=O(t);void 0!==i&&(n=Math.min(n,i));return n}(s[t][e],e),e,s[t][e]),e)}function O(e){var t,n=(t=e,M.get().streaming.abr.maxBitrate[t]);return -1<n?F(E[e].getMediaInfo(),n):void 0}function w(e){var t,n=(t=e,M.get().streaming.abr.minBitrate[t]);if(-1<n){var r=E[e].getMediaInfo(),i=U(r),a=F(r,n);return i[a]&&a<i.length-1&&i[a].bitrate<1e3*n&&a++,a}}function P(e,t,n,r){var i=t.id,a=B(e);(0, ne.checkInteger)(n);var o=C(e,i);n!==a&&0<=n&&n<=o&&L(e,a,n,o,r);}function L(e,t,n,r,i){var a,o,s,u,l,d,f;e&&E[e]&&(o=(a=E[e].getStreamInfo())?a.id:null,M.get().debug.logLevel===ee.default.LOG_LEVEL_DEBUG&&(s=D.getCurrentBufferLevel(e),p.info("["+e+"] switch from "+t+" to "+n+"/"+r+" (buffer: "+s+") "+(i?JSON.stringify(i):"."))),l=e,f=n,_[d=o]=_[d]||{},_[d][l]=f,c.trigger(W.default.QUALITY_CHANGE_REQUESTED,{mediaType:e,streamInfo:a,oldQuality:t,newQuality:n,reason:i}),u=R.getAverageThroughput(e),isNaN(u)||T.setSavedBitrateSettings(e,u));}function x(e,t){m[e].state=t;}function F(e,t,n){var r=e&&e.type?E[e.type].getRepresentationInfo():null;if(M.get().streaming.abr.useDeadTimeLatency&&n&&r&&r.fragmentDuration){n/=1e3;var i=r.fragmentDuration;if(i<n)return 0;t*=1-n/i;}for(var a=U(e),o=a.length-1;0<=o;o--){if(1e3*t>=a[o].bitrate)return o}return 0}function U(e){var t=[];if(!e||!e.bitrateList)return t;for(var n=e.bitrateList,r=e.type,i=void 0,a=0,o=n.length;a<o;a++)(i=new H.default).mediaType=r,i.qualityIndex=a,i.bitrate=n[a].bandwidth,i.width=n[a].width,i.height=n[a].height,i.scanType=n[a].scanType,t.push(i);return t}function k(e){return b[e]}function B(e){if(e&&E[e]){var t=E[e].getStreamInfo(),n=t?t.id:null;if(n)return _[n]=_[n]||{},_[n].hasOwnProperty(e)||(_[n][e]=0),_[n][e]}return 0}function G(){var e;v&&(e=M.get().streaming.abr.usePixelRatioInLimitBitrateByPortal&&window.hasOwnProperty("devicePixelRatio")?window.devicePixelRatio:1,a=v.getClientWidth()*e,l=v.getClientHeight()*e);}function j(e){var t=e.request.mediaType;if(M.get().streaming.abr.autoSwitchBitrate[t]){var n=E[t];if(!n)return;var r,i=(0, X.default)(f).create({abrController:h,streamProcessor:n,currentRequest:e.request,useBufferOccupancyABR:k(t)}),a=g.shouldAbandonFragment(i);a.quality>Q.default.NO_CHANGE&&((r=n.getFragmentModel()).getRequests({state:V.default.FRAGMENT_MODEL_LOADING,index:e.request.index})[0]&&(r.abortRequests(),x(t,q.default.ABANDON_LOAD),A[t].reset(),A[t].push({oldValue:B(t),newValue:a.quality,confidence:1,reason:a.reason}),P(t,o.getActiveStreamInfo(),a.quality,a.reason),clearTimeout(u),u=setTimeout(function(){x(t,q.default.ALLOW_LOAD),u=null;},M.get().streaming.abandonLoadTimeout)));}}return h={isPlayingAtTopQuality:function(e){var t=e?e.id:null,n=B(K.default.AUDIO),r=B(K.default.VIDEO);return n===C(K.default.AUDIO,t)&&r===C(K.default.VIDEO,t)},updateTopQualityIndex:function(e){if(e){var t=e.type,n=e.streamInfo.id,r=e.representationCount-1;return i=t,o=r,s[a=n]=s[a]||{},s[a][i]=o,r}var i,a,o;},getThroughputHistory:function(){return R},getBitrateList:U,getQualityForBitrate:F,getTopBitrateInfoFor:function(e){if(e&&E&&E[e]){var t=E[e].getStreamInfo();if(t&&t.id){var n=C(e,t.id),r=U(E[e].getMediaInfo());return r[n]?r[n]:null}}return null},getMaxAllowedIndexFor:O,getMinAllowedIndexFor:w,getInitialBitrateFor:function(e){if(!function(){if(!T||!T.hasOwnProperty("getSavedBitrateSettings"))throw new Error(K.default.MISSING_CONFIG_ERROR)}(),e===K.default.TEXT||e===K.default.FRAGMENTED_TEXT)return NaN;var t,n=T.getSavedBitrateSettings(e),r=M.get().streaming.abr.initialBitrate[e],i=M.get().streaming.abr.initialRepresentationRatio[e];return -1===r&&(r=-1<i?(t=d.getAdaptationForType(0,e).Representation,Array.isArray(t)?t[Math.max(Math.round(t.length*i)-1,0)].bandwidth:0):isNaN(n)?e===K.default.VIDEO?1e3:100:n),r},getQualityFor:B,getAbandonmentStateFor:function(e){return m[e]?m[e].state:null},setPlaybackQuality:P,checkPlaybackQuality:function(e){var t,n,r,i,a,o,s,u,l,d;e&&E&&E[e]&&(n=(t=E[e].getStreamInfo())?t.id:null,r=B(e),i=(0, X.default)(f).create({abrController:h,streamProcessor:E[e],currentValue:r,switchHistory:A[e],droppedFramesHistory:I,useBufferOccupancyABR:k(e)}),!I||(a=v.getPlaybackQuality())&&I.push(S,a),M.get().streaming.abr.autoSwitchBitrate[e]&&(o=w(e),s=C(e,n),l=(u=g.getMaxQuality(i)).quality,void 0!==o&&(l>Q.default.NO_CHANGE?l:r)<o&&(l=o),s<l&&(l=s),A[e].push({oldValue:r,newValue:l}),l>Q.default.NO_CHANGE&&l!=r?(m[e].state===q.default.ALLOW_LOAD||r<l)&&L(e,r,l,s,u.reason):M.get().debug.logLevel===ee.default.LOG_LEVEL_DEBUG&&(d=D.getCurrentBufferLevel(e),p.debug("["+e+"] stay on "+r+"/"+s+" (buffer: "+d+")"))));},getTopQualityIndexFor:C,setElementSize:G,setWindowResizeEventCalled:function(e){i=e;},createAbrRulesCollection:n,registerStreamType:function(e,t){A[e]=A[e]||(0, Z.default)(f).create(),E[e]=t,m[e]=m[e]||{},m[e].state=q.default.ALLOW_LOAD,b[e]=!1,c.on(W.default.LOADING_PROGRESS,j,this),e==K.default.VIDEO&&(c.on(W.default.QUALITY_CHANGE_RENDERED,r,this),I=I||(0, $.default)(f).create(),G()),c.on(W.default.METRIC_ADDED,N,this),c.on(W.default.PERIOD_SWITCH_COMPLETED,n,this),R=R||(0, J.default)(f).create({settings:M});},unRegisterStreamType:function(e){delete E[e];},setConfig:function(e){e&&(e.streamController&&(o=e.streamController),e.domStorage&&(T=e.domStorage),e.mediaPlayerModel&&(y=e.mediaPlayerModel),e.dashMetrics&&(D=e.dashMetrics),e.adapter&&(d=e.adapter),e.videoModel&&(v=e.videoModel),e.settings&&(M=e.settings));},reset:function(){t(),c.off(W.default.LOADING_PROGRESS,j,this),c.off(W.default.QUALITY_CHANGE_RENDERED,r,this),c.off(W.default.METRIC_ADDED,N,this),c.off(W.default.PERIOD_SWITCH_COMPLETED,n,this),g&&g.reset();}},p=e.getLogger(h),t(),h}a.__dashjs_factory_name="AbrController";var o=i.default.getSingletonFactory(a);o.QUALITY_DEFAULT=0,i.default.updateSingletonFactory(a.__dashjs_factory_name,o),n.default=o,t.exports=n.default;},{108:108,109:109,149:149,184:184,185:185,186:186,187:187,188:188,189:189,218:218,224:224,241:241,45:45,46:46,47:47,54:54}],112:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var u=r(e(147)),l=r(e(205)),d=r(e(220)),f=r(e(85)),i=r(e(47)),c=r(e(46)),h=r(e(54));function a(){var e=void 0,n=void 0,t=this.context,r=(0, c.default)(t).getInstance(),i=(0, d.default)(t).getInstance(),a=void 0,o=void 0;function s(e){a.invalidateSelectedIndexes(e.entry);}return e={reset:function(){a.reset(),o.reset();},initialize:function(e){var t;a.setConfig({adapter:n}),t=e,a.update(t),o.chooseSelector(n.getIsDVB(t));},resolve:function(e){var t=a.getForPath(e).reduce(function(e,t){var n=o.select(t);return n?(i.isRelative(n.url)?e.url=i.resolve(n.url,e.url):(e.url=n.url,e.serviceLocation=n.serviceLocation),e.availabilityTimeOffset=n.availabilityTimeOffset,e.availabilityTimeComplete=n.availabilityTimeComplete,e):new f.default},new f.default);if(!i.isRelative(t.url))return t},setConfig:function(e){e.baseURLTreeModel&&(a=e.baseURLTreeModel),e.baseURLSelector&&(o=e.baseURLSelector),e.adapter&&(n=e.adapter);}},a=(0, u.default)(t).create(),o=(0, l.default)(t).create(),r.on(h.default.SERVICE_LOCATION_BLACKLIST_CHANGED,s,e),e}a.__dashjs_factory_name="BaseURLController",n.default=i.default.getClassFactory(a),t.exports=n.default;},{147:147,205:205,220:220,46:46,47:47,54:54,85:85}],113:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),s=r(e(46));function a(e){e=e||{};var t=[],n=(0, s.default)(this.context).getInstance(),r=e.updateEventName,i=e.addBlacklistEventName;function a(e){-1===t.indexOf(e)&&(t.push(e),n.trigger(r,{entry:e}));}function o(e){a(e.entry);}return function(){i&&n.on(i,o,this);}(),{add:a,contains:function(e){return !!(t.length&&e&&e.length)&&-1!==t.indexOf(e)},reset:function(){t=[];}}}a.__dashjs_factory_name="BlackListController",n.default=i.default.getClassFactory(a),t.exports=n.default;},{46:46,47:47}],114:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var ge=r(e(108)),_e=r(e(109)),Ee=r(e(149)),me=r(e(104)),ve=r(e(103)),ye=r(e(111)),Te=r(e(117)),Se=r(e(46)),Ae=r(e(54)),i=r(e(47)),Ie=r(e(45)),Re=r(e(213)),be=r(e(225)),De=r(e(51)),Me=e(241),Ne="BufferController";function a(e){e=e||{};var r=this.context,i=(0, Se.default)(r).getInstance(),a=e.errHandler,l=e.fragmentModel,o=e.representationController,n=e.mediaController,t=e.adapter,s=e.textController,u=e.abrController,d=e.playbackController,f=e.streamInfo,c=e.type,h=e.settings,p=void 0,g=void 0,_=void 0,E=void 0,m=void 0,v=void 0,y=void 0,T=void 0,S=void 0,A=void 0,I=void 0,R=void 0,b=void 0,D=void 0,M=void 0,N=void 0,C=void 0,O=void 0,w=void 0,P=void 0,L=void 0,x=void 0;function F(e,t){if(!C||!e)return null;var n=e[0];if(y)try{"function"==typeof(A=t&&t[c]?(0,me.default)(r).create(y,n,j.bind(this),h.get().streaming.useAppendWindowEnd,t[c]):(0,me.default)(r).create(y,n,j.bind(this),h.get().streaming.useAppendWindowEnd)).getBuffer().initialize&&A.getBuffer().initialize(c,f,e,l);}catch(e){g.fatal("Caught error on create SourceBuffer: "+e),a.error(new be.default(De.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,De.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+c));}else A=(0, ve.default)(r).create(j.bind(this));return ie(this.getRepresentationInfo(_)),A}function U(e){e.chunk.streamId===f.id&&e.chunk.mediaInfo.type===c&&(g.info("Init fragment finished loading saving to",c+"'s init cache"),C.save(e.chunk),g.debug("Append Init fragment",c," with representationId:",e.chunk.representationId," and quality:",e.chunk.quality,", data size:",e.chunk.bytes.byteLength),B(e.chunk));}function k(e){var t,n=e.chunk;n.streamId===f.id&&n.mediaInfo.type==c&&(L?(x=n,(t=A&&A.getAllBufferRanges())&&0<t.length&&.5<d.getTimeToStreamEnd()&&(g.debug("Clearing buffer because track changed - "+(t.end(t.length-1)+.5)),te([{start:0,end:t.end(t.length-1)+.5,force:!0}]))):B(n));}function B(e){A.append(e),e.mediaInfo.type===ge.default.VIDEO&&he(Ae.default.VIDEO_CHUNK_RECEIVED,{chunk:e});}function G(e){if(e&&0<e.length)for(var t=0,n=e.length;t<n;t++)g.debug("Buffered range: "+e.start(t)+" - "+e.end(t)+", currentTime = ",d.getTime());}function j(e){var t,n,r;if(e.error)return 22===e.error.code&&(N=!0,v=.8*fe(),g.warn("Quota exceeded, Critical Buffer: "+v),0<v&&(t=Math.max(.2*v,1),n=v-t,r={streaming:{bufferToKeep:parseFloat(t.toFixed(5)),bufferAheadToKeep:parseFloat(n.toFixed(5))}},h.update(r))),void(22!==e.error.code&&ce()||(g.warn("Clearing playback buffer to overcome quota exceed situation"),he(Ae.default.QUOTA_EXCEEDED,{criticalBufferLevel:v}),H()));N=!1,(b=e.chunk)&&!isNaN(b.index)&&(T=Math.max(b.index,T),Z());var i,a=A.getAllBufferRanges();b.segmentType===Me.HTTPRequest.MEDIA_SEGMENT_TYPE?(G(a),V(),function(){if(c!==ge.default.AUDIO&&c!==ge.default.VIDEO)return;if(isNaN(O))return;var e=d.getTime(),t=X(O,0);if(e===O&&t)return;var n=o.getCurrentRepresentation().segmentDuration;if(!(t=X(O,n)))return;Math.abs(e-O)>n?O<=t.end&&(d.seek(Math.max(O,t.start),!1,!0),O=NaN):e<t.start&&(d.seek(t.start,!1,!0),O=NaN);}()):L&&(i=d.getTime(),g.debug("AppendToBuffer seek target should be "+i),he(Ae.default.SEEK_TARGET,{time:i})),b&&he(b.endFragment?Ae.default.BYTES_APPENDED_END_FRAGMENT:Ae.default.BYTES_APPENDED,{quality:b.quality,startTime:b.start,index:b.index,bufferedRanges:a,mediaType:c});}function Y(e){e.streamInfo.id==f.id&&e.mediaType===c&&_!==e.newQuality&&(ie(this.getRepresentationInfo(e.newQuality)),_=e.newQuality);}function K(e){O=e.seekTime,E&&(E=!(w=!0),S=Number.POSITIVE_INFINITY),(c!==ge.default.FRAGMENTED_TEXT?H:V)();}function q(){O=NaN;}function H(){A.waitForUpdateEnd(function(){var e=function(){var e=[],t=A.getAllBufferRanges();if(!t||0===t.length)return e;var n=d.getTime(),r=t.end(t.length-1)+.5,i=l.getRequests({state:Ee.default.FRAGMENT_MODEL_EXECUTED,time:n,threshold:.01})[0];{var a,o,s,u;i?(a={start:0,end:i.startTime-.5},(o=l.getRequests({state:Ee.default.FRAGMENT_MODEL_EXECUTED,time:i.startTime-i.duration/2,threshold:.01})[0])&&o.startTime!=i.startTime&&(a.end=o.startTime),a.start<a.end&&a.end>t.start(0)&&e.push(a),s={start:i.startTime+i.duration+.5,end:r},(u=l.getRequests({state:Ee.default.FRAGMENT_MODEL_EXECUTED,time:i.startTime+i.duration+.5,threshold:.01})[0])&&u.startTime!==i.startTime&&(s.start=u.startTime+u.duration+.5),s.start<s.end&&s.start<r&&e.push(s)):(g.debug("getAllRangesWithSafetyFactor - No request found in current time position, removing full buffer 0 -",r),e.push({start:0,end:r}));}return e}();e&&0!==e.length||V(),te(e);});}function V(){(!L||c===ge.default.FRAGMENTED_TEXT&&s.isTextEnabled())&&Q();}function z(){$();}function W(){O=NaN,$();}function X(e,t){var n=A.getAllBufferRanges(),r=0,i=0,a=null,o=null,s=0,u=void 0,l=void 0,d=isNaN(t)?.15:t;if(null!=n){for(l=0,u=n.length;l<u;l++)if(r=n.start(l),i=n.end(l),null===a)s=Math.abs(r-e),(r<=e&&e<i||s<=d)&&(a=r,o=i);else {if(!((s=r-o)<=d))break;o=i;}if(null!==a)return {start:a,end:o}}return null}function Q(){var e,t,n;d&&(e=(isNaN(O)?d.getTime():O)||0,m=null===(n=X(e,t))?0:n.end-e,he(Ae.default.BUFFER_LEVEL_UPDATED,{bufferLevel:m}),$());}function Z(){S-1<=T&&!E&&void 0===A.discharge&&(E=!0,g.debug("checkIfBufferingCompleted trigger BUFFERING_COMPLETED"),he(Ae.default.BUFFERING_COMPLETED));}function $(){c!==ge.default.AUDIO&&c!==ge.default.VIDEO||(w&&!E&&0<m&&d&&d.getTimeToStreamEnd()-m<.5&&(E=!(w=!1),g.debug("checkIfSufficientBuffer trigger BUFFERING_COMPLETED"),he(Ae.default.BUFFERING_COMPLETED)),(!h.get().streaming.lowLatencyEnabled&&m<.5||0===m)&&!E?J(_e.default.BUFFER_EMPTY):(E||m>=f.manifestInfo.minBufferTime)&&J(_e.default.BUFFER_LOADED));}function J(e){R===e||e===_e.default.BUFFER_EMPTY&&0===d.getTime()||c===ge.default.FRAGMENTED_TEXT&&!s.isTextEnabled()||(R=e,he(Ae.default.BUFFER_LEVEL_STATE_CHANGED,{state:e}),he(e===_e.default.BUFFER_LOADED?Ae.default.BUFFER_LOADED:Ae.default.BUFFER_EMPTY),g.debug(e===_e.default.BUFFER_LOADED?"Got enough buffer to start":"Waiting for more buffer before starting playback"));}function ee(){A&&c!==ge.default.FRAGMENTED_TEXT&&(E||te(function(){var e=[],t=A.getAllBufferRanges();if(!t||0===t.length)return e;var n=d.getTime(),r={start:Math.max(0,n-h.get().streaming.bufferToKeep),end:n+h.get().streaming.bufferAheadToKeep},i=l.getRequests({state:Ee.default.FRAGMENT_MODEL_EXECUTED,time:n,threshold:.01})[0];if(i)r.start=Math.min(i.startTime,r.start),r.end=Math.max(i.startTime+i.duration,r.end);else if(0===n&&d.getIsDynamic())return [];if(t.start(0)<=r.start){for(var a={start:0,end:r.start},o=0;o<t.length&&t.end(o)<=r.start;o++)a.end=t.end(o);a.start<a.end&&e.push(a);}{var s;t.end(t.length-1)>=r.end&&((s={start:r.end,end:t.end(t.length-1)+.01}).start<s.end&&e.push(s));}return e}()));}function te(e){e&&A&&0!==e.length&&(P.push.apply(P,e),M||ne());}function ne(){if(0===P.length||!A)return g.debug("Nothing to prune, halt pruning"),void(M=!(P=[]));var e=A.getBuffer();if(!e||!e.buffered||0===e.buffered.length)return g.debug("SourceBuffer is empty (or does not exist), halt pruning"),void(M=!(P=[]));var t=P.shift();g.debug("Removing buffer from:",t.start,"to",t.end),M=!0,d.getTime()<t.end&&(E=!1,T=0),A.remove(t.start,t.end,t.force);}function re(e){A===e.buffer&&(g.debug("onRemoved buffer from:",e.from,"to",e.to),G(A.getAllBufferRanges()),0===P.length&&(M=!1),e.unintended&&(g.warn("Detected unintended removal from:",e.from,"to",e.to,"setting index handler time to",e.from),he(Ae.default.SEEK_TARGET,{time:e.from})),M?ne():(L?(L=!1,x&&B(x)):Q(),he(Ae.default.BUFFER_CLEARED,{from:e.from,to:e.to,unintended:e.unintended,hasEnoughSpaceToAppend:ce(),quotaExceeded:N})));}function ie(e){e&&void 0!==e.MSETimeOffset&&A&&A.updateTimestampOffset&&A.updateTimestampOffset(e.MSETimeOffset);}function ae(e){e.sender.getStreamId()===f.id&&e.sender.getType()===c&&(e.error||ie(e.currentRepresentation));}function oe(e){e.request.mediaInfo.streamInfo.id===f.id&&e.request.mediaType===c&&(S=e.request.index,Z());}function se(e){var t;e.newMediaInfo.streamInfo.id!==f.id||e.newMediaInfo.type!==c||(t=A&&A.getAllBufferRanges())&&(g.info("Track change asked"),n.getSwitchMode(c)===Te.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&t&&0<t.length&&.5<d.getTimeToStreamEnd()&&(E=!1,S=Number.POSITIVE_INFINITY));}function ue(){++D*(h.get().streaming.wallclockTimeUpdateInterval/1e3)>=h.get().streaming.bufferPruningInterval&&(D=0,ee());}function le(){$();}function de(e,t){y=e,A&&t&&"function"==typeof A.discharge&&(I=A,F(t));}function fe(){var e,t=A.getAllBufferRanges(),n=0,r=void 0;if(!t)return n;for(r=0,e=t.length;r<e;r++)n+=t.end(r)-t.start(r);return n}function ce(){return fe()<v}function he(e,t){var n=t||{};n.sender=p,n.mediaType=c,n.streamId=f.id,i.trigger(e,n);}function pe(e,t){v=Number.POSITIVE_INFINITY,R=void 0,_=ye.default.QUALITY_DEFAULT,S=Number.POSITIVE_INFINITY,b=null,w=N=M=E=!1,D=m=T=0,P=[],O=NaN,A&&(e||A.abort(),A.reset(t),A=null),L=!1;}return p={getBufferControllerType:function(){return Ne},getRepresentationInfo:function(e){return t.convertDataToRepresentationInfo(o.getRepresentationForQuality(e))},initialize:function(e){de(e),_=u.getQualityFor(c),i.on(Ae.default.DATA_UPDATE_COMPLETED,ae,this),i.on(Ae.default.INIT_FRAGMENT_LOADED,U,this),i.on(Ae.default.MEDIA_FRAGMENT_LOADED,k,this),i.on(Ae.default.QUALITY_CHANGE_REQUESTED,Y,this),i.on(Ae.default.STREAM_COMPLETED,oe,this),i.on(Ae.default.PLAYBACK_PLAYING,W,this),i.on(Ae.default.PLAYBACK_PROGRESS,V,this),i.on(Ae.default.PLAYBACK_TIME_UPDATED,V,this),i.on(Ae.default.PLAYBACK_RATE_CHANGED,le,this),i.on(Ae.default.PLAYBACK_SEEKING,K,this),i.on(Ae.default.PLAYBACK_SEEKED,q,this),i.on(Ae.default.PLAYBACK_STALLED,z,this),i.on(Ae.default.WALLCLOCK_TIME_UPDATED,ue,this),i.on(Ae.default.CURRENT_TRACK_CHANGED,se,this,Se.default.EVENT_PRIORITY_HIGH),i.on(Ae.default.SOURCEBUFFER_REMOVE_COMPLETED,re,this);},createBuffer:F,dischargePreBuffer:function(){if(A&&I&&"function"==typeof I.discharge){var e=I.getAllBufferRanges();if(0<e.length){for(var t="Beginning "+c+"PreBuffer discharge, adding buffer for:",n=0;n<e.length;n++)t+=" start: "+e.start(n)+", end: "+e.end(n)+";";g.debug(t);}else g.debug("PreBuffer discharge requested, but there were no media segments in the PreBuffer.");for(var r=I.discharge(),i=null,a=0;a<r.length;a++){var o=r[a],s=C.extract(o.streamId,o.representationId);s&&(i!==s&&(A.append(s),i=s),A.append(o));}I.reset(),I=null;}},getType:function(){return c},getBuffer:function(){return A},setBuffer:function(e){A=e;},getBufferLevel:function(){return m},getRangeAt:X,setMediaSource:de,getMediaSource:function(){return y},appendInitSegment:function(e){var t=C.extract(f.id,e);return !!t&&(g.info("Append Init fragment",c," with representationId:",t.representationId," and quality:",t.quality,", data size:",t.bytes.byteLength),B(t),!0)},replaceBuffer:function(){L=!0;},getIsBufferingCompleted:function(){return E},getIsPruningInProgress:function(){return M},reset:function(e,t){i.off(Ae.default.DATA_UPDATE_COMPLETED,ae,this),i.off(Ae.default.INIT_FRAGMENT_LOADED,U,this),i.off(Ae.default.MEDIA_FRAGMENT_LOADED,k,this),i.off(Ae.default.QUALITY_CHANGE_REQUESTED,Y,this),i.off(Ae.default.STREAM_COMPLETED,oe,this),i.off(Ae.default.PLAYBACK_PLAYING,W,this),i.off(Ae.default.PLAYBACK_PROGRESS,V,this),i.off(Ae.default.PLAYBACK_TIME_UPDATED,V,this),i.off(Ae.default.PLAYBACK_RATE_CHANGED,le,this),i.off(Ae.default.PLAYBACK_SEEKING,K,this),i.off(Ae.default.PLAYBACK_SEEKED,q,this),i.off(Ae.default.PLAYBACK_STALLED,z,this),i.off(Ae.default.WALLCLOCK_TIME_UPDATED,ue,this),i.off(Ae.default.CURRENT_TRACK_CHANGED,se,this),i.off(Ae.default.SOURCEBUFFER_REMOVE_COMPLETED,re,this),pe(e,t);}},g=(0, Ie.default)(r).getInstance().getLogger(p),C=(0, Re.default)(r).getInstance(),pe(),p}a.__dashjs_factory_name=Ne,n.default=i.default.getClassFactory(a),t.exports=n.default;},{103:103,104:104,108:108,109:109,111:111,117:117,149:149,213:213,225:225,241:241,45:45,46:46,47:47,51:51,54:54}],115:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),b=r(e(45)),D=r(e(46)),M=r(e(54)),N=r(e(159));function a(){var i="urn:mpeg:dash:event:2012",a=1,o="urn:mpeg:dash:event:callback:2015",s=1,e=100,u=300,l=this.context,d=(0, D.default)(l).getInstance(),t=void 0,f=void 0,r=void 0,c=void 0,h=void 0,n=void 0,p=void 0,g=void 0,_=void 0,E=void 0,m=void 0;function v(){if(!g||!_)throw new Error("setConfig function has to be called previously")}function y(){m=!1,r={},c={},n=null,E=!(h={}),p=Date.now()/1e3;}function T(){try{null!==n&&m&&(clearInterval(n),n=null,m=!1,function(){try{I(c),I(r);}catch(e){}}());}catch(e){throw e}}function S(){try{var e,t;E||(t=(e=_.getTime())-p,t=0<p?Math.max(0,t):0,A(c,t,e),A(r,t,e),function(){try{if(h)for(var e=_.getTime(),t=Object.keys(h),n=0;n<t.length;n++){var r=t[n],i=h[r];null!==i&&(i.duration+i.calculatedPresentationTime)/i.eventStream.timescale<e&&(f.debug("Remove Event "+r+" at time "+e),i=null,delete h[r]);}}catch(e){}}(),p=e),E=!1;}catch(e){E=!1;}}function A(e,t,n){try{if(e)for(var r=Object.keys(e),i=0;i<r.length;i++){var a,o=r[i],s=e[o];void 0!==s&&((a=s.calculatedPresentationTime/s.eventStream.timescale)<=n&&n<=a+t?R(o,s,e):(function(e,t,n){try{return n<e-t}catch(e){return !1}}(n,t,a)||function(e){try{var t=e.eventStream.period.start+e.eventStream.period.duration;return e.calculatedPresentationTime/1e3>t}catch(e){return !1}}(s))&&(f.debug("Deleting event "+o+" as it is expired or invalid"),delete e[o]));}}catch(e){}}function I(i){try{var e=function(){var e=Object.keys(i),r=_.getTime();if(!e||0===e.length)return {v:void 0};var t=i[e[0]].eventStream&&i[e[0]].eventStream.period&&!isNaN(i[e[0]].eventStream.period.duration)?i[e[0]].eventStream.period.duration:NaN,n=i[e[0]].eventStream&&i[e[0]].eventStream.period&&!isNaN(i[e[0]].eventStream.period.start)?i[e[0]].eventStream.period.start:NaN;if(isNaN(t)||isNaN(n))return {v:void 0};e.forEach(function(e){var t=i[e],n=t.calculatedPresentationTime/t.eventStream.timescale;Math.abs(n-r)<u&&R(e,t,i);});}();if("object"==typeof e)return e.v}catch(e){}}function R(e,t,n){try{var r=_.getTime();0<t.duration&&(h[e]=t),t.eventStream.schemeIdUri===i&&t.eventStream.value==a?0===t.duration&&0===t.presentationTimeDelta||(f.debug("Starting manifest refresh event "+e+" at "+r),function(){try{v(),g.refreshManifest();}catch(e){}}()):t.eventStream.schemeIdUri===o&&t.eventStream.value==s?(f.debug("Starting callback event "+e+" at "+r),function(e){try{(0,N.default)(l).create({}).load({method:"get",url:e,request:{responseType:"arraybuffer"}});}catch(e){throw e}}(t.messageData)):(f.debug("Starting event "+e+" at "+r),d.trigger(t.eventStream.schemeIdUri,{event:t})),delete n[e];}catch(e){}}return t={addInlineEvents:function(e){try{if(v(),e)for(var t=0;t<e.length;t++){var n=e[t];r[n.id]=n,f.debug("Add inline event with id "+n.id);}f.debug("Added "+e.length+" inline events");}catch(e){throw e}},addInbandEvents:function(e){try{v();for(var t=0;t<e.length;t++){var n=e[t];n.id in c?f.debug("Repeated event with id "+n.id):(n.eventStream.schemeIdUri===i&&void 0===c[n.id]&&function(e){try{var t,n,r;e.eventStream.value==a&&(t=e.eventStream.timescale||1,n=e.calculatedPresentationTime/t,r=void 0,r=4294967295==e.calculatedPresentationTime?NaN:(e.calculatedPresentationTime+e.duration)/t,f.info("Manifest validity changed: Valid until: "+n+"; remaining duration: "+r),d.trigger(M.default.MANIFEST_VALIDITY_CHANGED,{id:e.id,validUntil:n,newDuration:r,newManifestValidAfter:NaN}));}catch(e){}}(n),c[n.id]=n,f.debug("Add inband event with id "+n.id));}S();}catch(e){throw e}},start:function(){try{v(),f.debug("Start Event Controller"),m||isNaN(e)||(m=!0,n=setInterval(S,e));}catch(e){throw e}},setConfig:function(e){try{if(!e)return;e.manifestUpdater&&(g=e.manifestUpdater),e.playbackController&&(_=e.playbackController);}catch(e){throw e}},reset:function(){T(),y();}},f=(0, b.default)(l).getInstance().getLogger(t),y(),t}a.__dashjs_factory_name="EventController",n.default=i.default.getSingletonFactory(a),t.exports=n.default;},{159:159,45:45,46:46,47:47,54:54}],116:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var h=r(e(108)),p=r(e(226)),d=r(e(149)),g=r(e(97)),_=r(e(217)),E=r(e(46)),m=r(e(54)),v=r(e(51)),i=r(e(47)),y=r(e(45));function a(r){r=r||{};var i=this.context,f=(0, E.default)(i).getInstance(),a=r.errHandler,o=r.mediaPlayerModel,s=r.dashMetrics,u=(0, y.default)(i).getInstance(),e=void 0,c=void 0,l=void 0;function t(){for(var e in l)l[e].reset();l={};}function n(e){var t,n,r,i,a,o,s,u,l,d;e.sender&&(t=e.request,n=e.response,r=t.isInitializationRequest(),i=t.mediaInfo.streamInfo,e.error&&(e.request.mediaType!==h.default.AUDIO&&e.request.mediaType!==h.default.VIDEO&&e.request.mediaType!==h.default.FRAGMENTED_TEXT||f.trigger(m.default.SERVICE_LOCATION_BLACKLIST_ADD,{entry:e.request.serviceLocation})),n&&i?(o=n,s=t,u=i.id,l=e.type!==m.default.FRAGMENT_LOADING_PROGRESS,(d=new p.default).streamId=u,d.mediaInfo=s.mediaInfo,d.segmentType=s.type,d.start=s.startTime,d.duration=s.duration,d.end=d.start+d.duration,d.bytes=o,d.index=s.index,d.quality=s.quality,d.representationId=s.representationId,d.endFragment=l,a=d,f.trigger(r?m.default.INIT_FRAGMENT_LOADED:m.default.MEDIA_FRAGMENT_LOADED,{chunk:a,request:t})):c.warn("No "+t.mediaType+" bytes to push or stream is inactive."));}return e={getModel:function(e,t){var n=l[t];return n||(n=(0, d.default)(i).create({streamId:e,dashMetrics:s,fragmentLoader:(0, g.default)(i).create({dashMetrics:s,mediaPlayerModel:o,errHandler:a,requestModifier:(0, _.default)(i).getInstance(),settings:r.settings,boxParser:r.boxParser,eventBus:f,events:m.default,errors:v.default,dashConstants:r.dashConstants,urlUtils:r.urlUtils}),debug:u,eventBus:f,events:m.default}),l[t]=n),n},reset:function(){f.off(m.default.FRAGMENT_LOADING_COMPLETED,n,this),f.off(m.default.FRAGMENT_LOADING_PROGRESS,n,this),t();}},c=u.getLogger(e),t(),f.on(m.default.FRAGMENT_LOADING_COMPLETED,n,e),f.on(m.default.FRAGMENT_LOADING_PROGRESS,n,e),e}a.__dashjs_factory_name="FragmentController",n.default=i.default.getClassFactory(a),t.exports=n.default;},{108:108,149:149,217:217,226:226,45:45,46:46,47:47,51:51,54:54,97:97}],117:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var S=r(e(108)),A=r(e(54)),I=r(e(46)),i=r(e(47)),R=r(e(45)),b="neverReplace",D="alwaysReplace",M="highestBitrate",N="widestRange",C=M;function a(){var e=this.context,l=(0, I.default)(e).getInstance(),t=void 0,o=void 0,d=void 0,n=void 0,r=void 0,f=void 0,c=void 0,i=[D,b],a=[M,N];function s(e,t){if(!e||!t)return [];var n=t.id;return d[n]&&d[n][e]?d[n][e].list:[]}function h(e,t){return !e||!t||t&&!d[t.id]?null:d[t.id][e].current}function u(e,t){if(e&&e.streamInfo){var n,r,i=e.type,a=e.streamInfo,o=a.id,s=h(i,a);if(d[o]&&d[o][i]&&!m(e,s))if(d[o][i].current=e,!d[o][i].current||t&&i===S.default.FRAGMENTED_TEXT||l.trigger(A.default.CURRENT_TRACK_CHANGED,{oldMediaInfo:s,newMediaInfo:e,switchMode:f[i]}),!t){var u=(r={lang:(n=e).lang,viewpoint:n.viewpoint,roles:n.roles,accessibility:n.accessibility,audioChannelConfiguration:n.audioChannelConfiguration}).lang||r.viewpoint||r.role&&0<r.role.length||r.accessibility&&0<r.accessibility.length||r.audioChannelConfiguration&&0<r.audioChannelConfiguration.length?r:null;if(!u||!d[o][i].storeLastSettings)return;u.roles&&(u.role=u.roles[0],delete u.roles),u.accessibility&&(u.accessibility=u.accessibility[0]),u.audioChannelConfiguration&&(u.audioChannelConfiguration=u.audioChannelConfiguration[0]),c.setSavedMediaSettings(i,u);}}}function p(e,t){e&&t&&(n[e]=t);}function g(e){return e?n[e]:null}function _(){return r||C}function E(e){return e===S.default.AUDIO||e===S.default.VIDEO||e===S.default.TEXT||e===S.default.FRAGMENTED_TEXT||e===S.default.IMAGE}function m(e,t){if(!e&&!t)return !0;if(!e||!t)return !1;var n=e.id===t.id,r=e.viewpoint===t.viewpoint,i=e.lang===t.lang,a=e.roles.toString()===t.roles.toString(),o=e.accessibility.toString()===t.accessibility.toString(),s=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString();return n&&r&&i&&a&&o&&s}function v(){d={},n={audio:null,video:null,fragmentedText:null},f={audio:D,video:b};}function y(t,e){var n=!t.lang||e.lang.match(t.lang),r=!t.viewpoint||t.viewpoint===e.viewpoint,i=!t.role||!!e.roles.filter(function(e){return e===t.role})[0],a=!t.accessibility||!!e.accessibility.filter(function(e){return e===t.accessibility})[0],o=!t.audioChannelConfiguration||!!e.audioChannelConfiguration.filter(function(e){return e===t.audioChannelConfiguration})[0];return n&&r&&i&&a&&o}function T(e,t){if(e===S.default.FRAGMENTED_TEXT)return t[0];function n(e){var t=0,n=[],r=void 0;return e.forEach(function(e){r=Math.max.apply(Math,e.bitrateList.map(function(e){return e.bandwidth})),t<r?(t=r,n=[e]):r===t&&n.push(e);}),n}function r(e){var t=0,n=[],r=void 0;return e.forEach(function(e){r=e.representationCount,t<r?(t=r,n=[e]):r===t&&n.push(e);}),n}var i=_(),a=[];switch(i){case M:1<(a=n(t)).length&&(a=r(a));break;case N:1<(a=r(t)).length&&(a=n(t));break;default:o.warn("Track selection mode is not supported: "+i);}return a[0]}return t={checkInitialMediaSettingsForType:function(e,t){var n=g(e),r=s(e,t),i=[];n||p(e,n=c.getSavedMediaSettings(e)),r&&0!==r.length&&(n&&r.forEach(function(e){y(n,e)&&i.push(e);}),0===i.length?u(T(e,r),!0):1<i.length?u(T(e,i)):u(i[0]));},addTrack:function(e){if(e){var t=e.type;if(E(t)){var n=e.streamInfo.id;d[n]||(d[n]={audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},fragmentedText:{list:[],storeLastSettings:!0,current:null},image:{list:[],storeLastSettings:!0,current:null}});for(var r=d[n][t].list,i=0,a=r.length;i<a;++i)if(m(r[i],e))return;r.push(e);var o=g(t);o&&y(o,e)&&!h(t,e.streamInfo)&&u(e);}}},getTracksFor:s,getCurrentTrackFor:h,isCurrentTrack:function(e){if(!e)return !1;var t=e.type,n=e.streamInfo.id;return d[n]&&d[n][t]&&m(d[n][t].current,e)},setTrack:u,setInitialSettings:p,getInitialSettings:g,setSwitchMode:function(e,t){-1!==i.indexOf(t)?f[e]=t:o.warn("Track switch mode is not supported: "+t);},getSwitchMode:function(e){return f[e]},setSelectionModeForInitialTrack:function(e){-1!==a.indexOf(e)?r=e:o.warn("Track selection mode is not supported: "+e);},getSelectionModeForInitialTrack:_,isMultiTrackSupportedByType:E,isTracksEqual:m,matchSettings:y,saveTextSettingsDisabled:function(){c.setSavedMediaSettings(S.default.FRAGMENTED_TEXT,null);},setConfig:function(e){e&&e.domStorage&&(c=e.domStorage);},reset:v},o=(0, R.default)(e).getInstance().getLogger(t),v(),t}a.__dashjs_factory_name="MediaController";var o=i.default.getSingletonFactory(a);o.TRACK_SWITCH_MODE_NEVER_REPLACE=b,o.TRACK_SWITCH_MODE_ALWAYS_REPLACE=D,o.TRACK_SELECTION_MODE_HIGHEST_BITRATE=M,o.TRACK_SELECTION_MODE_WIDEST_RANGE=N,o.DEFAULT_INIT_TRACK_SELECTION_MODE=C,i.default.updateSingletonFactory(a.__dashjs_factory_name,o),n.default=o,t.exports=n.default;},{108:108,45:45,46:46,47:47,54:54}],118:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),a=r(e(45));function o(){var e=void 0,r=void 0,t=this.context;return e={createMediaSource:function(){var e="WebKitMediaSource"in window;return "MediaSource"in window?new MediaSource:e?new WebKitMediaSource:null},attachMediaSource:function(e,t){var n=window.URL.createObjectURL(e);return t.setSource(n),n},detachMediaSource:function(e){e.setSource(null);},setDuration:function(e,t){return e.duration!=t&&(e.duration=t),e.duration},setSeekable:function(e,t,n){e&&"function"==typeof e.setLiveSeekableRange&&"function"==typeof e.clearLiveSeekableRange&&"open"===e.readyState&&0<=t&&t<n&&(e.clearLiveSeekableRange(),e.setLiveSeekableRange(t,n));},signalEndOfStream:function(e){if(e&&"open"===e.readyState){for(var t=e.sourceBuffers,n=0;n<t.length;n++){if(t[n].updating)return;if(0===t[n].buffered.length)return}r.info("call to mediaSource endOfStream"),e.endOfStream();}}},r=(0, a.default)(t).getInstance().getLogger(e),e}o.__dashjs_factory_name="MediaSourceController",n.default=i.default.getSingletonFactory(o),t.exports=n.default;},{45:45,47:47}],119:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var fe=r(e(108)),ce=r(e(109)),he=r(e(46)),pe=r(e(54)),i=r(e(47)),ge=r(e(45));function a(){var e=this.context,a=(0, he.default)(e).getInstance(),t=void 0,s=void 0,u=void 0,l=void 0,d=void 0,f=void 0,n=void 0,o=void 0,c=void 0,r=void 0,h=void 0,p=void 0,g=void 0,_=void 0,E=void 0,i=void 0,m=void 0,v=void 0,y=void 0,T=void 0,S=void 0,A=void 0,I=void 0;function R(e){var t,n,r,i;o&&isNaN(c)||(t=c,isNaN(t)&&(g?(t=e.liveStartTime,(r=(n=l.getCurrentDVRInfo())?n.range:null)&&(i=G(p.start,!0),isNaN(i)||(s.info("Start time from URI parameters: "+i),t=Math.max(Math.min(t,i),r.start)))):(t=p.start,i=G(p.start,!1),!isNaN(i)&&i<t+p.duration&&(s.info("Start time from URI parameters: "+i),t=Math.max(t,i)))),isNaN(t)||t===f.getTime()||(a.trigger(pe.default.PLAYBACK_SEEKING,{seekTime:t}),w(t,!1,!0)));}function b(){return parseFloat((D()-P()).toFixed(5))}function D(){return p.start+p.duration}function M(){p&&f&&f.getElement()?f.play():E=!0;}function N(){return p&&f?f.isPaused():null}function C(){p&&f&&f.pause();}function O(){return p&&f?f.isSeeking():null}function w(e,t,n){p&&f&&e!==(isNaN(v)?f.getTime():v)&&(!0===n?(f.removeEventListener("seeking",Q),s.info("Requesting internal seek to time: "+e)):(v=e,a.trigger(pe.default.PLAYBACK_SEEK_ASKED),s.info("Requesting seek to time: "+e)),f.setCurrentTime(e,t));}function P(){return p&&f?f.getTime():null}function L(){var e,t=P();return !g||isNaN(m)||(e=m/1e3)<t&&(t-=e),t}function x(){return p&&f?f.getPlaybackRate():null}function F(){return p&&f?f.getEnded():null}function U(){return g}function k(){if(!g||isNaN(m))return NaN;var e=L();if(isNaN(e)||0===e)return 0;var t=(new Date).getTime()+1e3*n.getClientTimeOffset();return Math.max(((t-m-1e3*e)/1e3).toFixed(3),0)}function B(){o=E=!1,m=h=0,v=c=NaN,f&&(a.off(pe.default.STREAM_INITIALIZED,R,this),a.off(pe.default.DATA_UPDATE_COMPLETED,q,this),a.off(pe.default.BUFFER_LEVEL_STATE_CHANGED,ue,this),a.off(pe.default.LOADING_PROGRESS,se,this),a.off(pe.default.PLAYBACK_PROGRESS,ae,this),a.off(pe.default.PLAYBACK_TIME_UPDATED,ae,this),a.off(pe.default.PLAYBACK_ENDED,re,this),a.off(pe.default.STREAM_INITIALIZING,de,this),Y(),f.removeEventListener("canplay",H),f.removeEventListener("play",V),f.removeEventListener("waiting",z),f.removeEventListener("playing",W),f.removeEventListener("pause",X),f.removeEventListener("error",ie),f.removeEventListener("seeking",Q),f.removeEventListener("seeked",Z),f.removeEventListener("timeupdate",$),f.removeEventListener("progress",J),f.removeEventListener("ratechange",ee),f.removeEventListener("loadedmetadata",te),f.removeEventListener("stalled",le),f.removeEventListener("ended",ne)),g=p=f=r=null;}function G(e,t){var n=A.getURIFragmentData();if(!n||!n.t)return NaN;return n.t=n.t.split(",")[0],t&&-1!==n.t.indexOf("posix:")?parseInt(n.t.substring(6)):e+parseInt(n.t)}function j(){null===r&&(r=setInterval(function(){a.trigger(pe.default.WALLCLOCK_TIME_UPDATED,{isDynamic:g,time:new Date}),g&&N()&&function(){var e=Date.now();(!i||i+500<e)&&(i=e,$());}();},I.get().streaming.wallclockTimeUpdateInterval));}function Y(){clearInterval(r),r=null;}function K(){var e,t,n,r,i;!N()&&g&&0!==f.getReadyState()&&(e=L(),n=e,r=l.getCurrentDVRInfo(),t=(i=r?r.range:null)?n>i.end?Math.max(i.end-2*p.manifestInfo.minBufferTime,i.start):0<n&&n+.25<i.start&&Math.abs(n-i.start)<31536e4?i.start:n:NaN,isNaN(t)||t===e||w(t));}function q(e){var t,n;e.error||null!==(n=(t=d.convertDataToRepresentationInfo(e.currentRepresentation))?t.mediaInfo.streamInfo:null)&&p.id===n.id&&(p=n,K());}function H(){a.trigger(pe.default.CAN_PLAY);}function V(){s.info("Native video element event: play"),K(),j(),a.trigger(pe.default.PLAYBACK_STARTED,{startTime:P()});}function z(){s.info("Native video element event: waiting"),a.trigger(pe.default.PLAYBACK_WAITING,{playingTime:P()});}function W(){s.info("Native video element event: playing"),a.trigger(pe.default.PLAYBACK_PLAYING,{playingTime:P()});}function X(){s.info("Native video element event: pause"),a.trigger(pe.default.PLAYBACK_PAUSED,{ended:F()});}function Q(){var e=P();isNaN(v)||v===e||(e=v),v=NaN,s.info("Seeking to: "+e),j(),a.trigger(pe.default.PLAYBACK_SEEKING,{seekTime:e});}function Z(){s.info("Native video element event: seeked"),a.trigger(pe.default.PLAYBACK_SEEKED),f.addEventListener("seeking",Q);}function $(){p&&a.trigger(pe.default.PLAYBACK_TIME_UPDATED,{timeToEnd:b(),time:P()});}function J(){a.trigger(pe.default.PLAYBACK_PROGRESS);}function ee(){var e=x();s.info("Native video element event: ratechange: ",e),a.trigger(pe.default.PLAYBACK_RATE_CHANGED,{playbackRate:e});}function te(){s.info("Native video element event: loadedmetadata"),a.trigger(pe.default.PLAYBACK_METADATA_LOADED),j();}function ne(){s.info("Native video element event: ended"),C(),Y(),a.trigger(pe.default.PLAYBACK_ENDED,{isLast:u.getActiveStreamInfo().isLast});}function re(e){r&&e.isLast&&(s.info("onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended"),f.setCurrentTime(D()),C(),Y());}function ie(e){var t=e.target||e.srcElement;a.trigger(pe.default.PLAYBACK_ERROR,{error:t.error});}function ae(){var e,t,n;g&&I.get().streaming.lowLatencyEnabled&&0<I.get().streaming.liveCatchUpPlaybackRate&&!N()&&!O()&&(e=k(),t=Math.abs(e-_.getLiveDelay()),n=_.getLiveCatchupLatencyThreshold(),(I.get().streaming.lowLatencyEnabled&&0<I.get().streaming.liveCatchUpPlaybackRate&&0<P()&&t>I.get().streaming.liveCatchUpMinDrift&&(isNaN(n)||e<=n)?function(){{var e,t,n,r,i,a,o;f&&(e=I.get().streaming.liveCatchUpPlaybackRate,t=_.getLiveDelay(),n=k()-t,r=5*n,i=2*e/(1+Math.pow(Math.E,-r)),a=1-e+i,T&&(o=function(){var n=null;return u.getActiveStreamProcessors().forEach(function(e){var t=e.getBufferLevel();n=null===n?t:Math.min(n,t);}),n}(),t/2<o?T=!1:0<n&&(a=1)),Math.abs(f.getPlaybackRate()-a)>S&&f.setPlaybackRate(a),0<I.get().streaming.liveCatchUpMaxDrift&&!y&&n>I.get().streaming.liveCatchUpMaxDrift?(s.info("Low Latency catchup mechanism. Latency too high, doing a seek to live point"),y=!0,function(){var e=l.getCurrentDVRInfo();w((e?e.range:null).end-_.getLiveDelay(),!0,!1);}()):y=!1);}}:oe)());}function oe(){f&&f.setPlaybackRate(1);}function se(e){var t,n;!1!==e.stream||!I.get().streaming.lowLatencyEnabled||isNaN(e.request.duration)||(t=1.2*e.request.duration)>_.getLiveDelay()&&(s.warn("Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:",t.toFixed(2)),n={streaming:{liveDelay:t}},I.update(n));}function ue(e){e.streamId===p.id&&(I.get().streaming.lowLatencyEnabled?e.state!==ce.default.BUFFER_EMPTY||O()||T||(T=!0,oe()):f.setStallState(e.mediaType,e.state===ce.default.BUFFER_EMPTY));}function le(e){a.trigger(pe.default.PLAYBACK_STALLED,{e:e});}function de(e){!function(e,t){if(e&&e.manifestInfo&&e.manifestInfo.serviceDescriptions){for(var n=void 0,r=0;r<e.manifestInfo.serviceDescriptions.length;r++){var i=e.manifestInfo.serviceDescriptions[r];if(i.schemeIdUri===fe.default.SERVICE_DESCRIPTION_LL_SCHEME){n=i;break}}n&&t&&t.supplementalProperties&&"true"===t.supplementalProperties[fe.default.SUPPLEMENTAL_PROPERTY_LL_SCHEME]&&(n.latency&&0<n.latency.target&&(s.debug("Apply LL properties coming from service description. Target Latency (ms):",n.latency.target),I.update({streaming:{lowLatencyEnabled:!0,liveDelay:n.latency.target/1e3,liveCatchUpMinDrift:n.latency.max>n.latency.target?(n.latency.max-n.latency.target)/1e3:void 0}})),n.playbackRate&&1<n.playbackRate.max&&(s.debug("Apply LL properties coming from service description. Max PlaybackRate:",n.playbackRate.max),I.update({streaming:{lowLatencyEnabled:!0,liveCatchUpPlaybackRate:n.playbackRate.max-1}})));}}(e.streamInfo,e.mediaInfo);}return t={initialize:function(e,t,n){p=e,f.addEventListener("canplay",H),f.addEventListener("play",V),f.addEventListener("waiting",z),f.addEventListener("playing",W),f.addEventListener("pause",X),f.addEventListener("error",ie),f.addEventListener("seeking",Q),f.addEventListener("seeked",Z),f.addEventListener("timeupdate",$),f.addEventListener("progress",J),f.addEventListener("ratechange",ee),f.addEventListener("loadedmetadata",te),f.addEventListener("stalled",le),f.addEventListener("ended",ne),g=p.manifestInfo.isDynamic,o=!(T=y=!1)===t,c=n;var r="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",i=/safari/.test(r)&&!/chrome/.test(r);S=i?.25:.02,a.on(pe.default.STREAM_INITIALIZED,R,this),a.on(pe.default.DATA_UPDATE_COMPLETED,q,this),a.on(pe.default.LOADING_PROGRESS,se,this),a.on(pe.default.BUFFER_LEVEL_STATE_CHANGED,ue,this),a.on(pe.default.PLAYBACK_PROGRESS,ae,this),a.on(pe.default.PLAYBACK_TIME_UPDATED,ae,this),a.on(pe.default.PLAYBACK_ENDED,re,this),a.on(pe.default.STREAM_INITIALIZING,de,this),E&&(E=!1,M());},setConfig:function(e){e&&(e.streamController&&(u=e.streamController),e.dashMetrics&&(l=e.dashMetrics),e.mediaPlayerModel&&(_=e.mediaPlayerModel),e.adapter&&(d=e.adapter),e.videoModel&&(f=e.videoModel),e.timelineConverter&&(n=e.timelineConverter),e.uriFragmentModel&&(A=e.uriFragmentModel),e.settings&&(I=e.settings));},getStartTimeFromUriParameters:G,getTimeToStreamEnd:b,getTime:P,getNormalizedTime:L,getPlaybackRate:x,getPlayedRanges:function(){return p&&f?f.getPlayedRanges():null},getEnded:F,getIsDynamic:U,getStreamController:function(){return u},computeAndSetLiveDelay:function(e,t,n){var r,i,a=void 0,o=void 0,s=!isNaN(e)&&isFinite(e)?e:NaN,u=d.getSuggestedPresentationDelay(),a=I.get().streaming.lowLatencyEnabled?0:_.getLiveDelay()?_.getLiveDelay():null===I.get().streaming.liveDelayFragmentCount||isNaN(I.get().streaming.liveDelayFragmentCount)||isNaN(s)?!0===I.get().streaming.useSuggestedPresentationDelay&&null!==u&&!isNaN(u)&&0<u?u:isNaN(s)?isNaN(n)?4*p.manifestInfo.minBufferTime:4*n:4*s:s*I.get().streaming.liveDelayFragmentCount;return null!==(i=d.getAvailabilityStartTime())&&(m=i),o=0<t?(r=Math.max(t-10,t/2),Math.min(a,r)):a,h=o},getLiveDelay:function(){return h},setLiveDelay:function(e){!(arguments.length<=1||void 0===arguments[1])&&arguments[1]&&e<h||(h=e);},getCurrentLiveLatency:k,play:M,isPaused:N,pause:C,isSeeking:O,seek:w,reset:B},s=(0, ge.default)(e).getInstance().getLogger(t),B(),t}a.__dashjs_factory_name="PlaybackController",n.default=i.default.getSingletonFactory(a),t.exports=n.default;},{108:108,109:109,45:45,46:46,47:47,54:54}],120:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var ae=r(e(108)),oe=r(e(109)),se=r(e(196)),ue=r(e(149)),le=r(e(46)),de=r(e(54)),i=r(e(47)),fe=r(e(45)),ce=r(e(117));function a(e){e=e||{};var t=this.context,n=(0, le.default)(t).getInstance(),l=e.adapter,d=e.dashMetrics,r=e.mediaPlayerModel,f=e.fragmentModel,c=e.abrController,h=e.playbackController,i=e.textController,a=e.streamId,p=e.type,g=e.mimeType,_=e.mediaController,E=e.bufferController,m=e.settings,o=void 0,v=void 0,y=void 0,s=void 0,u=void 0,T=void 0,S=void 0,A=void 0,I=void 0,R=void 0,b=void 0,D=void 0,M=void 0,N=void 0,C=void 0,O=void 0,w=void 0,P=void 0,L=void 0;function x(){return !1===s}function F(){x()||y&&!E.getIsBufferingCompleted()&&(v.debug("Schedule Controller starts"),s=!1,d.createPlaylistTraceMetrics(y.id,1e3*h.getTime(),h.getPlaybackRate()),B(0));}function U(){s||(v.debug("Schedule Controller stops"),s=!0,clearTimeout(S));}function k(){var e,t;s||u||h.isPaused()&&!m.get().streaming.scheduleWhilePaused||(p===ae.default.FRAGMENTED_TEXT||p===ae.default.TEXT)&&!i.isTextEnabled()||E.getIsBufferingCompleted()?U():(function(){var e=h.getTime(),t=1.5;{var n;isNaN(y.fragmentDuration)&&(n=d.getCurrentSchedulingInfo(y.mediaInfo.type),t=n?1.5*n.duration:1.5);}var r=f.getRequests({state:ue.default.FRAGMENT_MODEL_EXECUTED,time:e+t,threshold:0})[0];{var i,a,o,s,u;r&&-1===N.indexOf(r)&&!l.getIsTextTrack(g)&&(i=m.get().streaming.fastSwitchEnabled,a=E.getBufferLevel(),o=c.getAbandonmentStateFor(p),s=!_.isCurrentTrack(r.mediaInfo)&&_.getSwitchMode(r.mediaInfo.type)===ce.default.TRACK_SWITCH_MODE_NEVER_REPLACE,u=r.quality<y.quality,i&&(s||u)&&t<=a&&o!==oe.default.ABANDON_LOAD?(j(r),L=!0,v.debug("Reloading outdated fragment at index: ",r.index)):r.quality>y.quality&&!O&&ne(h.getTime()+a));}}(),e=0<N.length,O||isNaN(M)||C||e||function(e,t){D[t]=D[t]||{};var n=c.getTopQualityIndexFor(e,t);return D[t][e]!=n&&(v.info("Top quality "+e+" index has changed from "+D[t][e]+" to "+n),D[t][e]=n,1)}(p,a)||R.execute(p,y,I)?(G(!0),!e&&P&&c.checkPlaybackQuality(p),P=y.quality===M&&!C||O?(t=N.shift())&&t.isInitializationRequest()?(n.trigger(de.default.INIT_FRAGMENT_NEEDED,{sender:o,streamId:a,mediaType:p,representationId:t.representationId}),!1):(n.trigger(de.default.MEDIA_FRAGMENT_NEEDED,{sender:o,streamId:a,mediaType:p,seekTarget:A,replacement:t}),!0):(C?(v.debug("Switch track for "+p+", representation id = "+y.id),(O=_.getSwitchMode(p)===ce.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE)&&E.replaceBuffer&&E.replaceBuffer(),C=!1):v.debug("Quality has changed, get init request for representationid = "+y.id),n.trigger(de.default.INIT_FRAGMENT_NEEDED,{sender:o,streamId:a,mediaType:p,representationId:y.id}),M=y.quality,!1)):B(500));}function B(e){clearTimeout(S),S=setTimeout(k,e);}function G(e){u!==e?u=e:v.debug("isFragmentProcessingInProgress is already equal to",e);}function j(e){N.push(e);}function Y(e){var t;h&&f&&((t=f.getRequests({state:ue.default.FRAGMENT_MODEL_EXECUTED,time:h.getTime(),threshold:0})[0])&&h.getTime()>=t.startTime&&((!b.mediaInfo||t.mediaInfo.type===b.mediaInfo.type&&t.mediaInfo.id!==b.mediaInfo.id)&&e&&n.trigger(de.default.TRACK_CHANGE_RENDERED,{mediaType:p,oldMediaInfo:b.mediaInfo,newMediaInfo:t.mediaInfo}),t.quality===b.quality&&t.adaptationIndex===b.adaptationIndex||!e||n.trigger(de.default.QUALITY_CHANGE_RENDERED,{mediaType:p,oldQuality:b.quality,newQuality:t.quality}),b={mediaInfo:t.mediaInfo,quality:t.quality,adaptationIndex:t.adaptationIndex}));}function K(e){e.request.mediaInfo.streamInfo.id===a&&e.request.mediaType===p&&(U(),G(!1),v.info("Stream is complete"));}function q(e){e.request.mediaInfo.streamInfo.id===a&&e.request.mediaType===p&&(v.info("OnFragmentLoadingCompleted - Url:",e.request?e.request.url:"undefined",e.request.range?", Range:"+e.request.range:""),l.getIsTextTrack(g)&&G(!1),e.error&&e.request.serviceLocation&&!s&&(j(e.request),G(!1),B(0)),O&&(w=e.request));}function H(){Y(!0);}function V(e){var t,n,r;e.streamId===a&&e.mediaType===p&&(O&&!isNaN(e.startTime)&&(O=!1,f.addExecutedRequest(w)),G(!1),L&&!isNaN(e.startTime)?(t=h.getTime(),B((n=e.startTime+y.fragmentDuration)<=t+(r=1.5*y.fragmentDuration)?0:1e3*(n-(t+r))),L=!1):B(0));}function z(e){e.streamId===a&&e.mediaType===p&&(v.info("onFragmentLoadingAbandoned request: "+e.request.url+" has been aborted"),h.isSeeking()||C||(v.info("onFragmentLoadingAbandoned request: "+e.request.url+" has to be downloaded again, origin is not seeking process or switch track call"),j(e.request)),G(!1),B(0));}function W(e){e.sender.getType()===p&&e.sender.getStreamId();}function X(e){p===e.mediaType&&a===e.streamId&&U();}function Q(e){e.streamId===a&&e.mediaType===p&&e.hasEnoughSpaceToAppend&&e.quotaExceeded&&s&&F();}function Z(e){e.streamId===a&&e.mediaType===p&&(U(),G(!1));}function $(){f.abortRequests(),U();}function J(){!s&&m.get().streaming.scheduleWhilePaused||F();}function ee(e){ne(e.seekTime),re(0),s&&F();var t=y.DVRWindow&&h?y.DVRWindow.end-h.getTime():NaN;d.updateManifestUpdateInfo({latency:t}),u?(v.debug("Abort requests"),f.abortRequests()):B(0);}function te(e){d.updatePlayListTraceMetrics({playbackspeed:e.playbackRate.toString()});}function ne(e){A=e;}function re(e){T=e;}function ie(){b={mediaInfo:void(T=0),quality:M=A=NaN,adaptationIndex:NaN},D={},N=[],L=O=C=!(s=!(u=!(P=!(w=null))));}return o={initialize:function(e){I=e,R=(0, se.default)(t).create({abrController:c,dashMetrics:d,mediaPlayerModel:r,textController:i,settings:m}),n.on(de.default.DATA_UPDATE_STARTED,W,this),n.on(de.default.FRAGMENT_LOADING_COMPLETED,q,this),n.on(de.default.STREAM_COMPLETED,K,this),n.on(de.default.BUFFER_CLEARED,Q,this),n.on(de.default.BYTES_APPENDED_END_FRAGMENT,V,this),n.on(de.default.QUOTA_EXCEEDED,Z,this),n.on(de.default.PLAYBACK_SEEKING,ee,this),n.on(de.default.PLAYBACK_STARTED,J,this),n.on(de.default.PLAYBACK_RATE_CHANGED,te,this),n.on(de.default.PLAYBACK_TIME_UPDATED,H,this),n.on(de.default.URL_RESOLUTION_FAILED,$,this),n.on(de.default.FRAGMENT_LOADING_ABANDONED,z,this),n.on(de.default.BUFFERING_COMPLETED,X,this);},getType:function(){return p},getStreamId:function(){return a},setCurrentRepresentation:function(e){y=e;},setSeekTarget:ne,setTimeToLoadDelay:re,getTimeToLoadDelay:function(){return T},switchTrackAsked:function(){C=!0;},isStarted:x,start:F,stop:U,reset:function(){n.off(de.default.DATA_UPDATE_STARTED,W,this),n.off(de.default.FRAGMENT_LOADING_COMPLETED,q,this),n.off(de.default.STREAM_COMPLETED,K,this),n.off(de.default.BUFFER_CLEARED,Q,this),n.off(de.default.BYTES_APPENDED_END_FRAGMENT,V,this),n.off(de.default.QUOTA_EXCEEDED,Z,this),n.off(de.default.PLAYBACK_SEEKING,ee,this),n.off(de.default.PLAYBACK_STARTED,J,this),n.off(de.default.PLAYBACK_RATE_CHANGED,te,this),n.off(de.default.PLAYBACK_TIME_UPDATED,H,this),n.off(de.default.URL_RESOLUTION_FAILED,$,this),n.off(de.default.FRAGMENT_LOADING_ABANDONED,z,this),n.off(de.default.BUFFERING_COMPLETED,X,this),U(),Y(!1),ie();},getBufferTarget:function(){return R.getBufferTarget(p,y,I)},processInitRequest:function(e){e&&(G(!0),f.executeRequest(e));},processMediaRequest:function(e){e?(v.debug("Next fragment request url is "+e.url),f.executeRequest(e)):(h.getIsDynamic()&&v.debug("Next fragment seems to be at the bleeding live edge and is not available yet. Rescheduling."),G(!1),B(m.get().streaming.lowLatencyEnabled?100:500));}},v=(0, fe.default)(t).getInstance().getLogger(o),ie(),o}a.__dashjs_factory_name="ScheduleController",n.default=i.default.getClassFactory(a),t.exports=n.default;},{108:108,109:109,117:117,149:149,196:196,45:45,46:46,47:47,54:54}],121:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var Ie=r(e(108)),Re=r(e(109)),be=r(e(105)),De=r(e(99)),Me=r(e(46)),Ne=r(e(54)),i=r(e(47)),Ce=e(243),Oe=r(e(45)),we=r(e(213)),Pe=r(e(220)),Le=r(e(101)),xe=r(e(122)),Fe=r(e(118)),Ue=r(e(225)),ke=r(e(51)),Be=r(e(115));function a(){var t=40,r=2e3,l=this.context,d=(0, Me.default)(l).getInstance(),e=void 0,f=void 0,c=void 0,h=void 0,n=void 0,p=void 0,g=void 0,_=void 0,o=void 0,u=void 0,E=void 0,m=void 0,v=void 0,y=void 0,T=void 0,i=void 0,S=void 0,A=void 0,I=void 0,R=void 0,b=void 0,D=void 0,a=void 0,s=void 0,M=void 0,N=void 0,C=void 0,O=void 0,w=void 0,P=void 0,L=void 0,x=void 0,F=void 0,U=void 0,k=void 0,B=void 0,G=void 0,j=void 0,Y=void 0,K=void 0,q=void 0,H=void 0;function V(){var e;!he()||(e=w.getPlaybackQuality())&&_.addDroppedFrames(e);}function z(){var e;!H.get().streaming.jumpGaps||0===re()||P.isSeeking()||x||M||N||C||t<=++G&&(e=P.getTime(),K===e?function(e){for(var t=re(),n=H.get().streaming.smallGapLimit,r=void 0,i=0;i<t.length;i++){var a=t[i].getBuffer().getAllBufferRanges(),o=void 0;if(a&&!(a.length<=1)){for(var s,u=0;u<a.length;u++)if(e<a.start(u)){o=a.start(u);break}0<o&&(0<(s=o-e)&&s<=n&&(void 0===r||r<o)&&(r=o));}}var l=P.getTimeToStreamEnd();void 0===r&&!isNaN(l)&&l<n&&(r=e+l);0<r&&(!isNaN(l)&&e+l<=r?(f.info("Jumping media gap (discontinuity) at time ",e,". Jumping to end of the stream"),d.trigger(Ne.default.PLAYBACK_ENDED,{isLast:me().isLast})):(f.info("Jumping media gap (discontinuity) at time ",e,". Jumping to time position",r),P.seek(r,!0,!0)));}(e):K=e,G=0);}function W(e){var t=ne(e.seekTime);k&&(Z(),U=!1),B&&(f.debug("[PreloadTimer] stop period preload timer."),clearTimeout(B),B=void 0),t===b&&Y&&Y.deactivate(!0),t&&(t!==b||Y&&!b.isActive())?(ge(Ce.PlayListTrace.END_OF_PERIOD_STOP_REASON),oe(t,b,e.seekTime)):ge(Ce.PlayListTrace.USER_REQUEST_STOP_REASON),_e(Ce.PlayList.SEEK_START_REASON);}function X(){f.debug("[onPlaybackStarted]"),F?(F=!1,_e(Ce.PlayList.INITIAL_PLAYOUT_START_REASON)):x&&(x=!1,_e(Ce.PlayList.RESUME_FROM_PAUSE_START_REASON),$());}function Q(e){f.debug("[onPlaybackPaused]"),e.ended||(x=!0,ge(Ce.PlayListTrace.USER_REQUEST_STOP_REASON),$());}function Z(){f.debug("[toggleEndPeriodTimer] stop end period timer."),clearTimeout(k),k=void 0;}function $(){var e,t,n;U&&(k?Z():(n=(t=0<(e=P.getTimeToStreamEnd())?1e3*e:0)<r?t/4:t-r,f.debug("[toggleEndPeriodTimer] Going to fire preload in",n,"milliseconds"),B=setTimeout(te,n),f.debug("[toggleEndPeriodTimer] start-up of timer to notify PLAYBACK_ENDED event. It will be triggered in",t,"milliseconds"),k=setTimeout(function(){d.trigger(Ne.default.PLAYBACK_ENDED,{isLast:me().isLast});},t)));}function J(e){var t;e.mediaType!==Ie.default.AUDIO&&e.mediaType!==Ie.default.VIDEO||(t=me().isLast,O&&!t&&void 0===k&&(f.info("[onTrackBufferingCompleted] end of period detected. Track",e.mediaType,"has finished"),!(U=!0)===x&&$()));}function ee(){var e=me().isLast;O&&e&&(f.info("[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController."),o.signalEndOfStream(O));}function te(){var t,e=me().isLast;O&&!e&&(t=ae(),b.isProtectionCompatible(t)&&(q||b.isMediaCodecCompatible(t))&&(f.info("[onStreamCanLoadNext] Preloading next stream"),b.deactivate(!0),t.preload(O,j),(Y=t).getProcessors().forEach(function(e){e.setIndexHandlerTime(t.getStartTime());})));}function ne(e){var t=0,n=null,r=R.length;0<r&&(t+=R[0].getStartTime());for(var i=0;i<r;i++)if(n=R[i],e<(t=parseFloat((t+n.getDuration()).toFixed(5))))return n;return null}function re(){return b?b.getProcessors():[]}function ie(){var e=ae();e?oe(e,b,NaN):f.debug("StreamController no next stream found"),ge(e?Ce.PlayListTrace.END_OF_PERIOD_STOP_REASON:Ce.PlayListTrace.END_OF_CONTENT_STOP_REASON),k=void 0,U=!1;}function ae(){if(b){var e=(t=me().start,n=me().duration,{v:R.filter(function(e){return e.getStreamInfo().start===parseFloat((t+n).toFixed(5))})[0]});if("object"==typeof e)return e.v}var t,n;}function oe(e,t,n){var r;f.info("Switch stream to "+e.getId()+" at t="+n),M||!e||t===e&&e.isActive()||(M=!0,d.trigger(Ne.default.PERIOD_SWITCH_STARTED,{fromStreamInfo:t?t.getStreamInfo():null,toStreamInfo:e.getStreamInfo()}),r=!1,t&&(r=b.isProtectionCompatible(e)&&(q||b.isMediaCodecCompatible(e))&&!n||e.getPreloaded(),t.deactivate(r)),n=isNaN(n)?!r&&t?e.getStreamInfo().start:NaN:n,b=e,Y=!1,P.initialize(me(),!!t,n),w.getElement()?se(n,null===t,!1,r):ue(n,r));}function se(e,t,n,r){var i=void 0;function a(){O&&"open"==O.readyState&&(f.debug("MediaSource is open!"),window.URL.revokeObjectURL(i),O.removeEventListener("sourceopen",a),O.removeEventListener("webkitsourceopen",a),le(),t||d.trigger(Ne.default.SOURCE_INITIALIZED),n?b.setMediaSource(O):ue(e,r));}O?r?(ue(e,r),t||d.trigger(Ne.default.SOURCE_INITIALIZED)):(o.detachMediaSource(w),O.addEventListener("sourceopen",a,!1),O.addEventListener("webkitsourceopen",a,!1),i=o.attachMediaSource(O,w),f.debug("MediaSource attached to element.  Waiting on open...")):((O=o.createMediaSource()).addEventListener("sourceopen",a,!1),O.addEventListener("webkitsourceopen",a,!1),i=o.attachMediaSource(O,w),f.debug("MediaSource attached to element.  Waiting on open..."));}function ue(e,t){var n;!(j=b.activate(O,t?j:void 0))||0<(n=Object.keys(j)).length&&j[n[0]].changeType&&(f.debug("SourceBuffer changeType method supported. Use it to switch codecs in periods transitions"),q=!0),F||isNaN(e)||P.seek(e),!s&&F||P.play(),M=!1,d.trigger(Ne.default.PERIOD_SWITCH_COMPLETED,{toStreamInfo:me()});}function le(e){var t=e||me().manifestInfo.duration,n=o.setDuration(O,t);f.debug("Duration successfully set to: "+n);}function de(){try{var e=g.getStreamsInfo();if(0===e.length)throw new Error("There are no streams");_.updateManifestUpdateInfo({currentTime:P.getTime(),buffered:w.getBufferRange(),presentationStartTime:e[0].start,clientTimeOffset:I.getClientTimeOffset()});for(var t,n,r,i,a=0,o=e.length;a<o;a++){var s=e[a],u=function(e){for(var t=0,n=R.length;t<n;t++)if(R[t].getId()===e.id)return R[t];return null}(s);u?u.updateData(s):(u=(0,be.default)(l).create({manifestModel:p,mediaPlayerModel:L,dashMetrics:_,manifestUpdater:h,adapter:g,timelineConverter:I,capabilities:c,errHandler:A,baseURLController:E,abrController:m,playbackController:P,eventController:y,mediaController:v,textController:T,videoModel:w,settings:H}),R.push(u),u.initialize(s,D)),_.addManifestUpdateStreamInfo(s);}b||(g.getIsDynamic()&&R.length&&(n=function(t,e){try{var n=NaN;return e&&!isNaN(e.maxFragmentDuration)&&isFinite(e.maxFragmentDuration)?e.maxFragmentDuration:(t&&1===t.length&&function(){var r=t[0],e=[Ie.default.VIDEO,Ie.default.AUDIO,Ie.default.FRAGMENTED_TEXT].reduce(function(e,t){var n=g.getMediaInfoForType(r,t);return n&&e.push(n),e},[]).reduce(function(t,e){var n=g.getVoRepresentations(e);return n&&0<n.length&&n.forEach(function(e){e&&t.push(e);}),t},[]).reduce(function(e,t){var n=g.convertDataToRepresentationInfo(t);return n&&n.fragmentDuration&&!isNaN(n.fragmentDuration)&&e.push(n.fragmentDuration),e},[]);n=Math.max.apply(Math,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e));}(),isFinite(n)?n:NaN)}catch(e){return NaN}}(e,t=e[0].manifestInfo),P.computeAndSetLiveDelay(n,t.DVRWindowSize,t.minBufferTime)),r=null,i=P.getStartTimeFromUriParameters(e[0].start,g.getIsDynamic()),isNaN(i)||(r=ne(i)),!r&&g.getIsDynamic()&&R.length&&(f.debug("Dynamic stream: Trying to find the correct starting period"),r=function(){try{var e=I.calcPresentationTimeFromWallTime(new Date,g.getRegularPeriods()[0]),t=P.getLiveDelay();return ne(e-t)}catch(e){return null}}()),oe(null!==r?r:R[0],null,NaN)),d.trigger(Ne.default.STREAMS_COMPOSED);}catch(e){A.error(new Ue.default(ke.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,e.message+"nostreamscomposed",p.getValue())),C=!0,Se();}}function fe(){var e=p.getValue();D&&(d.trigger(Ne.default.PROTECTION_CREATED,{controller:D,manifest:e}),D.setMediaElement(w.getElement()),a&&D.setProtectionData(a)),de();}function ce(s){s.error?(C=!0,Se()):function(){var e=s.manifest;g.updatePeriods(e);var t=g.getStreamsInfo(void 0,1)[0],n=g.getMediaInfoForType(t,Ie.default.VIDEO)||g.getMediaInfoForType(t,Ie.default.AUDIO),r=void 0;n&&(r=g.getUseCalculatedLiveEdgeTimeForMediaInfo(n))&&(f.debug("SegmentTimeline detected using calculated Live Edge Time"),H.update({streaming:{useManifestDateHeaderTimeSource:!1}}));var i=g.getUTCTimingSources(),a=!g.getIsDynamic()||r?i:i.concat(L.getUTCTimingSources()),o=S.isHTTPS(s.manifest.url);a.forEach(function(e){e.value.replace(/.*?:\/\//g,"")===L.getDefaultUtcTimingSource().value.replace(/.*?:\/\//g,"")&&(e.value=e.value.replace(o?new RegExp(/^(http:)?\/\//i):new RegExp(/^(https:)?\/\//i),o?"https://":"http://"),f.debug("Matching default timing source protocol to manifest protocol: ",e.value));}),E.initialize(e),u.setConfig({dashMetrics:_,baseURLController:E}),u.initialize(a,H.get().streaming.useManifestDateHeaderTimeSource);}();}function he(){return !!b&&b.getHasVideoTrack()}function pe(){return !!b&&b.getHasAudioTrack()}function ge(t,n){n=n||new Date,re().forEach(function(e){e.finalisePlayList(n,t);}),_.addPlayList();}function _e(e){_.createPlaylistMetrics(1e3*P.getTime(),e);}function Ee(e){if(e.error){var t="";switch(e.error.code){case 1:t="MEDIA_ERR_ABORTED";break;case 2:t="MEDIA_ERR_NETWORK";break;case 3:t="MEDIA_ERR_DECODE";break;case 4:t="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:t="MEDIA_ERR_ENCRYPTED";break;default:t="UNKNOWN";}N=!0,e.error.message&&(t+=" ("+e.error.message+")"),e.error.msExtendedCode&&(t+=" (0x"+(e.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),f.fatal("Video Element Error: "+t),e.error&&f.fatal(e.error),A.error(new Ue.default(e.error.code,t)),Se();}}function me(){return b?b.getStreamInfo():null}function ve(){if(!(n&&n.hasOwnProperty("load")&&I&&I.hasOwnProperty("initialize")&&I.hasOwnProperty("reset")&&I.hasOwnProperty("getClientTimeOffset")&&p&&A&&_&&P))throw new Error(Ie.default.MISSING_CONFIG_ERROR)}function ye(e){isNaN(e.newDuration)||le(e.newDuration);}function Te(){b=D=null,k=void 0,U=!(s=!(x=!(F=!(C=N=M=!(R=[]))))),G=0;}function Se(){ve(),u.reset(),ge(N||C?Ce.PlayListTrace.FAILURE_STOP_REASON:Ce.PlayListTrace.USER_REQUEST_STOP_REASON);for(var e=0,t=R?R.length:0;e<t;e++){R[e].reset(N);}!function(){d.off(Ne.default.PLAYBACK_TIME_UPDATED,V,this),d.off(Ne.default.PLAYBACK_SEEKING,W,this),d.off(Ne.default.PLAYBACK_ERROR,Ee,this),d.off(Ne.default.PLAYBACK_STARTED,X,this),d.off(Ne.default.PLAYBACK_PAUSED,Q,this),d.off(Ne.default.PLAYBACK_ENDED,ie,this),d.off(Ne.default.MANIFEST_UPDATED,ce,this),d.off(Ne.default.BUFFERING_COMPLETED,J,this),d.off(Ne.default.STREAM_BUFFERING_COMPLETED,ee,this),d.off(Ne.default.MANIFEST_VALIDITY_CHANGED,ye,this),d.off(Ne.default.TIME_SYNCHRONIZATION_COMPLETED,fe,this),d.off(Ne.default.WALLCLOCK_TIME_UPDATED,z,this),d.off(Le.default.METRIC_ADDED,Ae,this);}(),E.reset(),h.reset(),y.reset(),_.clearAllCurrentMetrics(),p.setValue(null),n.reset(),I.reset(),i.reset(),O&&(o.detachMediaSource(w),O=null),w=null,D&&(D.setMediaElement(null),a=D=null,p.getValue()&&d.trigger(Ne.default.PROTECTION_DESTROYED,{data:p.getValue().url})),d.trigger(Ne.default.STREAM_TEARDOWN_COMPLETE),Te();}function Ae(e){var t;e.metric===Re.default.DVR_INFO&&(t=pe()?Ie.default.AUDIO:Ie.default.VIDEO,e.mediaType===t&&o.setSeekable(O,e.value.range.start,e.value.range.end));}return e={initialize:function(e,t){ve(),s=e,a=t,I.initialize(),(h=(0, De.default)(l).create()).setConfig({manifestModel:p,adapter:g,manifestLoader:n,errHandler:A,settings:H}),h.initialize(),(y=(0, Be.default)(l).getInstance()).setConfig({manifestUpdater:h,playbackController:P}),y.start(),function(){d.on(Ne.default.PLAYBACK_TIME_UPDATED,V,this),d.on(Ne.default.PLAYBACK_SEEKING,W,this),d.on(Ne.default.PLAYBACK_ERROR,Ee,this),d.on(Ne.default.PLAYBACK_STARTED,X,this),d.on(Ne.default.PLAYBACK_PAUSED,Q,this),d.on(Ne.default.PLAYBACK_ENDED,ie,this),d.on(Ne.default.MANIFEST_UPDATED,ce,this),d.on(Ne.default.BUFFERING_COMPLETED,J,this),d.on(Ne.default.STREAM_BUFFERING_COMPLETED,ee,this),d.on(Ne.default.MANIFEST_VALIDITY_CHANGED,ye,this),d.on(Ne.default.TIME_SYNCHRONIZATION_COMPLETED,fe,this),d.on(Ne.default.WALLCLOCK_TIME_UPDATED,z,this),d.on(Le.default.METRIC_ADDED,Ae,this);}();},getActiveStreamInfo:me,hasVideoTrack:he,hasAudioTrack:pe,switchToVideoElement:function(e){b&&(P.initialize(me()),se(e,!1,!0,!1));},getStreamById:function(t){return R.filter(function(e){return e.getId()===t})[0]},getStreamForTime:ne,getTimeRelativeToStreamId:function(e,t){for(var n=null,r=0,i=0,a=null,o=0;o<R.length;o++){if(i=(n=R[o]).getStartTime(),a=n.getDuration(),Number.isFinite(i)&&(r=i),n.getId()===t)return e-r;Number.isFinite(a)&&(r+=a);}return null},load:function(e){ve(),n.load(e);},loadWithManifest:function(e){!function(){if(!h||!h.hasOwnProperty("setManifest"))throw new Error("initialize function has to be called previously")}(),h.setManifest(e);},getActiveStreamProcessors:re,setConfig:function(e){e&&(e.capabilities&&(c=e.capabilities),e.manifestLoader&&(n=e.manifestLoader),e.manifestModel&&(p=e.manifestModel),e.mediaPlayerModel&&(L=e.mediaPlayerModel),e.protectionController&&(D=e.protectionController),e.adapter&&(g=e.adapter),e.dashMetrics&&(_=e.dashMetrics),e.errHandler&&(A=e.errHandler),e.timelineConverter&&(I=e.timelineConverter),e.videoModel&&(w=e.videoModel),e.playbackController&&(P=e.playbackController),e.abrController&&(m=e.abrController),e.mediaController&&(v=e.mediaController),e.textController&&(T=e.textController),e.settings&&(H=e.settings),e.baseURLController&&(E=e.baseURLController));},setProtectionData:function(e){a=e;},reset:Se},f=(0, Oe.default)(l).getInstance().getLogger(e),u=(0, xe.default)(l).getInstance(),o=(0, Fe.default)(l).getInstance(),i=(0, we.default)(l).getInstance(),S=(0, Pe.default)(l).getInstance(),Te(),e}a.__dashjs_factory_name="StreamController",n.default=i.default.getSingletonFactory(a),t.exports=n.default;},{101:101,105:105,108:108,109:109,115:115,118:118,122:122,213:213,220:220,225:225,243:243,45:45,46:46,47:47,51:51,54:54,99:99}],122:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var S=r(e(225)),A=e(241),I=r(e(46)),R=r(e(54)),b=r(e(51)),i=r(e(47)),D=r(e(45)),M=r(e(220));function a(){var e=this.context,r=(0, I.default)(e).getInstance(),c=(0, M.default)(e).getInstance(),t=void 0,o=void 0,n=void 0,i=void 0,s=void 0,u=void 0,a=void 0,h=void 0;function l(e){i=e;}function d(e){n=e;}function f(e){var t,n,r,i=Date.parse(e);return isNaN(i)&&(n=t=void 0,r=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/.exec(e),t=Date.UTC(parseInt(r[1],10),parseInt(r[2],10)-1,parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10),r[6]&&(parseInt(r[6],10)||0),r[7]&&1e3*parseFloat(r[7])||0),r[9]&&r[10]&&(n=60*parseInt(r[9],10)+parseInt(r[10],10),t+=("+"===r[8]?-1:1)*n*60*1e3),i=new Date(t).getTime()),i}function p(e){return Date.parse(e)}function g(e){return Date.parse(e)}function _(e,t,n){n();}function E(e,t,n){var r=f(e);isNaN(r)?n():t(r);}function m(n,e,r,t,i){var a,o,s,u=!1,l=new XMLHttpRequest,d=i?A.HTTPRequest.HEAD:A.HTTPRequest.GET,f=e.match(/\S+/g);e=f.shift(),a=function(){u||(u=!0,f.length?m(n,f.join(" "),r,t,i):t());},o=function(){var e=void 0,t=void 0;200===l.status&&(e=i?l.getResponseHeader("Date"):l.response,t=n(e),isNaN(t)||(r(t),u=!0));},!c.isRelative(e)||(s=h.resolve())&&(e=c.resolve(e,s.url)),l.open(d,e),l.timeout=5e3,l.onload=o,l.onloadend=a,l.send();}function v(e,t,n){m(g,e,t,n,!0);}function y(){var e=a.getLatestMPDRequestHeaderValueByID("Date"),t=null!==e?new Date(e).getTime():Number.NaN;isNaN(t)?T(!0):(d(t-(new Date).getTime()),T(!1,t/1e3,n));}function T(e,t,n){l(!1),r.trigger(R.default.TIME_SYNCHRONIZATION_COMPLETED,{time:t,offset:n,error:e?new S.default(b.default.TIME_SYNC_FAILED_ERROR_CODE,b.default.TIME_SYNC_FAILED_ERROR_MESSAGE):null});}return t={initialize:function(e,t){s=t,n=0,i=!1,u={"urn:mpeg:dash:utc:http-head:2014":v,"urn:mpeg:dash:utc:http-xsdate:2014":m.bind(null,f),"urn:mpeg:dash:utc:http-iso:2014":m.bind(null,p),"urn:mpeg:dash:utc:direct:2014":E,"urn:mpeg:dash:utc:http-head:2012":v,"urn:mpeg:dash:utc:http-xsdate:2012":m.bind(null,f),"urn:mpeg:dash:utc:http-iso:2012":m.bind(null,p),"urn:mpeg:dash:utc:direct:2012":E,"urn:mpeg:dash:utc:http-ntp:2014":_,"urn:mpeg:dash:utc:ntp:2014":_,"urn:mpeg:dash:utc:sntp:2014":_},i||function e(t,n){var r=n||0;var i=t[r];var a=function(e,t){var n=!e||!t;n&&s?y():T(n,e,t);};l(!0);i?u.hasOwnProperty(i.schemeIdUri)?u[i.schemeIdUri](i.value,function(e){var t=(new Date).getTime(),n=e-t;d(n),o.info("Local time: "+new Date(t)),o.info("Server time: "+new Date(e)),o.info("Server Time - Local Time (ms): "+n),a(e,n);},function(){e(t,r+1);}):e(t,r+1):(d(0),a());}(e);},getOffsetToDeviceTimeMs:function(){return n},setConfig:function(e){e&&(e.dashMetrics&&(a=e.dashMetrics),e.baseURLController&&(h=e.baseURLController));},reset:function(){l(!1);}},o=(0, D.default)(e).getInstance().getLogger(t),t}a.__dashjs_factory_name="TimeSyncController";var o=i.default.getSingletonFactory(a);o.HTTP_TIMEOUT_MS=5e3,i.default.updateSingletonFactory(a.__dashjs_factory_name,o),n.default=o,t.exports=n.default;},{220:220,225:225,241:241,45:45,46:46,47:47,51:51,54:54}],123:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var p=r(e(107)),g=r(e(46)),_=r(e(54)),i=r(e(47)),E=r(e(3)),m=r(e(220)),v=r(e(61)),y="onLoad";function a(e){e=e||{};var t=this.context,i=(0, g.default)(t).getInstance(),s=(0, m.default)(t).getInstance(),n=void 0,r=void 0,u=void 0,l=void 0,a=void 0,d=void 0;function o(e,t,n){var r={},i=void 0,a=void 0;r.elements=e,r.type=t,r.resolveType=n,0===r.elements.length&&c(r);for(var o=0;o<r.elements.length;o++)i=r.elements[o],a=s.isHTTPURL(i.url)?i.url:i.originalContent.BaseURL+i.url,d.load(a,i,r);}function f(e){var t,n=void 0,r="",n=e.element,i=e.resolveObject;n.resolvedContent&&((t=0)===n.resolvedContent.indexOf("<?xml")&&(t=n.resolvedContent.indexOf("?>")+2),r=n.resolvedContent.substr(0,t)+"<response>"+n.resolvedContent.substr(t)+"</response>",n.resolvedContent=a.xml_str2json(r)),function(e){var t=void 0;for(t=0;t<e.elements.length;t++)if(!1===e.elements[t].resolved)return !1;return !0}(i)&&c(i);}function c(e){var t=[],n=void 0,r=void 0;if(!function(e){var t=[],n=void 0,r=void 0,i=void 0,a=void 0,o=void 0,s=void 0;for(a=e.elements.length-1;0<=a;a--){if(n=e.elements[a],r=n.type+"_asArray",n.resolvedContent){if(n.resolvedContent)for(o=0;o<n.resolvedContent[r].length;o++)i=n.resolvedContent[r][o],t.push(i);}else delete n.originalContent["xlink:actuate"],delete n.originalContent["xlink:href"],t.push(n.originalContent);for(n.parentElement[r].splice(n.index,1),s=0;s<t.length;s++)n.parentElement[r].splice(n.index+s,0,t[s]);t=[];}0<e.elements.length&&u.run(l);}(e),"onActuate"===e.resolveType&&i.trigger(_.default.XLINK_READY,{manifest:l}),e.resolveType===y)switch(e.type){case v.default.PERIOD:for(n=0;n<l[v.default.PERIOD+"_asArray"].length;n++)(r=l[v.default.PERIOD+"_asArray"][n]).hasOwnProperty(v.default.ADAPTATION_SET+"_asArray")&&(t=t.concat(h(r[v.default.ADAPTATION_SET+"_asArray"],r,v.default.ADAPTATION_SET,y))),r.hasOwnProperty(v.default.EVENT_STREAM+"_asArray")&&(t=t.concat(h(r[v.default.EVENT_STREAM+"_asArray"],r,v.default.EVENT_STREAM,y)));o(t,v.default.ADAPTATION_SET,y);break;case v.default.ADAPTATION_SET:i.trigger(_.default.XLINK_READY,{manifest:l});}}function h(e,t,n,r){for(var i=[],a=void 0,o=void 0,s=void 0,o=e.length-1;0<=o;o--)(a=e[o]).hasOwnProperty("xlink:href")&&"urn:mpeg:dash:resolve-to-zero:2013"===a["xlink:href"]&&e.splice(o,1);for(o=0;o<e.length;o++)(a=e[o]).hasOwnProperty("xlink:href")&&a.hasOwnProperty("xlink:actuate")&&a["xlink:actuate"]===r&&(s={url:a["xlink:href"],parentElement:t,type:n,index:o,resolveType:r,originalContent:a,resolvedContent:null,resolved:!1},i.push(s));return i}return n={resolveManifestOnLoad:function(e){a=new E.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:r}),o(h((l=e).Period_asArray,l,v.default.PERIOD,y),v.default.PERIOD,y);},setMatchers:function(e){e&&(r=e);},setIron:function(e){e&&(u=e);},reset:function(){i.off(_.default.XLINK_ELEMENT_LOADED,f,n),d&&(d.reset(),d=null);}},i.on(_.default.XLINK_ELEMENT_LOADED,f,n),d=(0, p.default)(t).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),n}a.__dashjs_factory_name="XlinkController",n.default=i.default.getClassFactory(a),t.exports=n.default;},{107:107,220:220,3:3,46:46,47:47,54:54,61:61}],124:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(138)),a=r(e(125)),o=r(e(126)),s=r(e(131)),u=r(e(136));function l(){var t=this.context;return {createMetricsReporting:function(e){return (0, i.default)(t).getInstance({eventBus:e.eventBus,dashMetrics:e.dashMetrics,metricsConstants:e.metricsConstants,events:e.events}),(0, o.default)(t).create(e)},getReportingFactory:function(){return (0, u.default)(t).getInstance()},getMetricsHandlerFactory:function(){return (0, s.default)(t).getInstance()}}}l.__dashjs_factory_name="MetricsReporting";var d=dashjs.FactoryMaker.getClassFactory(l);d.events=a.default,dashjs.FactoryMaker.updateClassFactory(l.__dashjs_factory_name,d),n.default=d,t.exports=n.default;},{125:125,126:126,131:131,136:136,138:138}],125:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n,r=!1;null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0;}};var i,a=e(55);function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r(Object.getPrototypeOf(o.prototype),"constructor",this).call(this),this.METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",this.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer";}var s=new(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);}(o,((i=a)&&i.__esModule?i:{default:i}).default),o);n.default=s,t.exports=n.default;},{55:55}],126:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var s=r(e(127)),u=r(e(140)),l=r(e(125));function i(i){i=i||{};var a={},o=this.context,t=i.eventBus,e=i.events;function n(e){var r;e.error||(r=Object.keys(a),(0, u.default)(o).getInstance({adapter:i.adapter,constants:i.constants}).getMetrics(e.manifest).forEach(function(e){var t=JSON.stringify(e);if(a.hasOwnProperty(t))r.splice(t,1);else try{var n=(0,s.default)(o).create(i);n.initialize(e),a[t]=n;}catch(e){}}),r.forEach(function(e){a[e].reset(),delete a[e];}),t.trigger(l.default.METRICS_INITIALISATION_COMPLETE));}function r(){Object.keys(a).forEach(function(e){a[e].reset();}),a={};}return t.on(e.MANIFEST_UPDATED,n),t.on(e.STREAM_TEARDOWN_COMPLETE,r),{reset:function(){t.off(e.MANIFEST_UPDATED,n),t.off(e.STREAM_TEARDOWN_COMPLETE,r);}}}i.__dashjs_factory_name="MetricsCollectionController",n.default=dashjs.FactoryMaker.getClassFactory(i),t.exports=n.default;},{125:125,127:127,140:140}],127:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var s=r(e(129)),u=r(e(130)),l=r(e(128));function i(t){t=t||{};var n=void 0,r=void 0,i=void 0,a=this.context;function o(){n&&n.reset(),r&&r.reset(),i&&i.reset();}return {initialize:function(e){try{(i=(0,s.default)(a).create({mediaElement:t.mediaElement})).initialize(e.Range),(r=(0,u.default)(a).create({debug:t.debug,metricsConstants:t.metricsConstants})).initialize(e.Reporting,i),(n=(0,l.default)(a).create({debug:t.debug,eventBus:t.eventBus,metricsConstants:t.metricsConstants,events:t.events})).initialize(e.metrics,r);}catch(e){throw o(),e}},reset:o}}i.__dashjs_factory_name="MetricsController",n.default=dashjs.FactoryMaker.getClassFactory(i),t.exports=n.default;},{128:128,129:129,130:130}],128:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(131),a=(r=i)&&r.__esModule?r:{default:r};function o(e){e=e||{};var o=[],t=void 0,n=this.context,r=e.eventBus,i=e.events,s=(0, a.default)(n).getInstance({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants});function u(t){o.forEach(function(e){e.handleNewMetric(t.metric,t.value,t.mediaType);});}return t={initialize:function(e,a){e.split(",").forEach(function(e,t,n){var r,i;-1===e.indexOf("(")||-1!==e.indexOf(")")||(i=n[t+1])&&-1===i.indexOf("(")&&-1!==i.indexOf(")")&&(e+=","+i,delete n[t+1]),(r=s.create(e,a))&&o.push(r);}),r.on(i.METRIC_ADDED,u,t),r.on(i.METRIC_UPDATED,u,t);},reset:function(){r.off(i.METRIC_ADDED,u,t),r.off(i.METRIC_UPDATED,u,t),o.forEach(function(e){return e.reset()}),o=[];}}}o.__dashjs_factory_name="MetricsHandlersController",n.default=dashjs.FactoryMaker.getClassFactory(o),t.exports=n.default;},{131:131}],129:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(208),u=(r=i)&&r.__esModule?r:{default:r};function a(e){e=e||{};var t,a=!1,n=this.context,o=void 0,s=e.mediaElement;return t={initialize:function(e){e&&e.length&&(e.forEach(function(e){var t=e.starttime,n=t+e.duration;o.add(t,n);}),a=!!e[0]._useWallClockTime);},reset:function(){o.clear();},isEnabled:function(){var e,t=o.length;if(!t)return !0;e=a?(new Date).getTime()/1e3:s.currentTime;for(var n=0;n<t;n+=1){var r=o.start(n),i=o.end(n);if(r<=e&&e<i)return !0}return !1}},o=(0, u.default)(n).create(),t}a.__dashjs_factory_name="RangeController",n.default=dashjs.FactoryMaker.getClassFactory(a),t.exports=n.default;},{208:208}],130:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(136),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var r=[],i=(0, a.default)(this.context).getInstance(e);return {initialize:function(e,n){e.some(function(e){var t=i.create(e,n);if(t)return r.push(t),!0});},reset:function(){r.forEach(function(e){return e.reset()}),r=[];},report:function(t,n){r.forEach(function(e){return e.report(t,n)});}}}o.__dashjs_factory_name="ReportingController",n.default=dashjs.FactoryMaker.getClassFactory(o),t.exports=n.default;},{136:136}],131:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var l=r(e(132)),d=r(e(133)),f=r(e(135)),c=r(e(134));function i(i){var e=void 0,a=(i=i||{}).debug?i.debug.getLogger(e):{},o=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,s=this.context,u={BufferLevel:l.default,DVBErrors:d.default,HttpList:f.default,PlayList:c.default,RepSwitchList:c.default,TcpList:c.default};return e={create:function(e,t){var n,r=e.match(o);if(r){try{(n=u[r[1]](s).create({eventBus:i.eventBus,metricsConstants:i.metricsConstants})).initialize(r[1],t,r[3],r[5]);}catch(e){n=null,a.error("MetricsHandlerFactory: Could not create handler for type "+r[1]+" with args "+r[3]+", "+r[5]+" ("+e.message+")");}return n}},register:function(e,t){u[e]=t;},unregister:function(e){delete u[e];}}}i.__dashjs_factory_name="MetricsHandlerFactory",n.default=dashjs.FactoryMaker.getSingletonFactory(i),t.exports=n.default;},{132:132,133:133,134:134,135:135}],132:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(139),f=(r=i)&&r.__esModule?r:{default:r};function a(e){e=e||{};var r=void 0,i=void 0,a=void 0,o=void 0,t=void 0,n=this.context,s=(0, f.default)(n).getInstance(),u=[],l=e.metricsConstants;function d(){var e=function(){try{return Object.keys(u).map(function(e){return u[e]}).reduce(function(e,t){return e.level<t.level?e:t})}catch(e){return}}();e&&t!==e.t&&(t=e.t,r.report(a,e));}return {initialize:function(e,t,n){t&&(i=s.validateN(n),r=t,a=s.reconstructFullMetricName(e,n),o=setInterval(d,i));},reset:function(){clearInterval(o),i=0,t=r=o=null;},handleNewMetric:function(e,t,n){e===l.BUFFER_LEVEL&&(u[n]=t);}}}a.__dashjs_factory_name="BufferLevelHandler",n.default=dashjs.FactoryMaker.getClassFactory(a),t.exports=n.default;},{139:139}],133:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(125),o=(r=i)&&r.__esModule?r:{default:r};n.default=dashjs.FactoryMaker.getClassFactory(function(e){var n=void 0,r=(e=e||{}).eventBus,i=e.metricsConstants;function a(){r.off(o.default.METRICS_INITIALISATION_COMPLETE,a,this),r.trigger(o.default.BECAME_REPORTING_PLAYER);}return {initialize:function(e,t){t&&(n=t,r.on(o.default.METRICS_INITIALISATION_COMPLETE,a,this));},reset:function(){n=null;},handleNewMetric:function(e,t){e===i.DVB_ERRORS&&n&&n.report(e,t);}}}),t.exports=n.default;},{125:125}],134:[function(e,t,n){function r(){var n=void 0,r=void 0;return {initialize:function(e,t){n=e,r=t;},reset:function(){r=null,n=void 0;},handleNewMetric:function(e,t){e===n&&r&&r.report(n,t);}}}Object.defineProperty(n,"__esModule",{value:!0}),r.__dashjs_factory_name="GenericMetricHandler",n.default=dashjs.FactoryMaker.getClassFactory(r),t.exports=n.default;},{}],135:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(139),f=(r=i)&&r.__esModule?r:{default:r};function a(e){e=e||{};var i=void 0,a=void 0,o=void 0,s=void 0,u=void 0,n=[],l=(0, f.default)(this.context).getInstance(),r=e.metricsConstants;function d(){n.length&&i&&i.report(s,n),n=[];}return {initialize:function(e,t,n,r){t&&(a=l.validateN(n),i=t,r&&r.length&&(o=r),s=l.reconstructFullMetricName(e,n,r),u=setInterval(d,a));},reset:function(){clearInterval(u),n=[],i=o=a=u=null;},handleNewMetric:function(e,t){e===r.HTTP_REQUEST&&(o&&o!==t.type||n.push(t));}}}a.__dashjs_factory_name="HttpListHandler",n.default=dashjs.FactoryMaker.getClassFactory(a),t.exports=n.default;},{139:139}],136:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(137),s=(r=i)&&r.__esModule?r:{default:r};function a(e){e=e||{};var r={"urn:dvb:dash:reporting:2014":s.default},i=this.context,t=void 0,a=e.debug?e.debug.getLogger(t):{},o=e.metricsConstants;return t={create:function(t,e){var n=void 0;try{(n=r[t.schemeIdUri](i).create({metricsConstants:o})).initialize(t,e);}catch(e){n=null,a.error("ReportingFactory: could not create Reporting with schemeIdUri "+t.schemeIdUri+" ("+e.message+")");}return n},register:function(e,t){r[e]=t;},unregister:function(e){delete r[e];}}}a.__dashjs_factory_name="ReportingFactory",n.default=dashjs.FactoryMaker.getSingletonFactory(a),t.exports=n.default;},{137:137}],137:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var h=r(e(141)),p=r(e(142));function i(e){e=e||{};var t,n=this.context,r=void 0,i=void 0,a=void 0,o=void 0,s=void 0,u=void 0,l=[],d=e.metricsConstants;function f(e,t,n){function r(){var e=l.indexOf(i);-1!==e&&(l.splice(e,1),200<=i.status&&i.status<300?t:n&&n());}var i=new XMLHttpRequest;l.push(i);try{i.open("GET",e),i.onloadend=r,i.onerror=r,i.send();}catch(e){i.onerror();}}function c(){o=a=!1,u=s=null;}return t={report:function(n,e){Array.isArray(e)||(e=[e]),o&&u.isEnabled()&&e.forEach(function(e){var t=r.serialise(e);n!==d.DVB_ERRORS&&(t="metricname="+n+"&"+t),f(t=s+"?"+t,null,function(){o=!1;});});},initialize:function(e,t){var n=void 0;if(u=t,!(s=e["dvb:reportingUrl"]))throw new Error("required parameter missing (dvb:reportingUrl)");a||((n=e["dvb:probability"]||e["dvb:priority"]||0)&&(1e3===n||n/1e3>=i.random())&&(o=!0),a=!0);},reset:function(){c();}},r=(0, h.default)(n).getInstance(),i=(0, p.default)(n).getInstance(),c(),t}i.__dashjs_factory_name="DVBReporting",n.default=dashjs.FactoryMaker.getClassFactory(i),t.exports=n.default;},{141:141,142:142}],138:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var p=r(e(143)),g=r(e(125));function i(e){var t=void 0,r=void 0,n=(e=e||{}).eventBus,i=e.dashMetrics,a=e.metricsConstants,o=e.events;function s(e){var t=new p.default;if(r){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.mpdurl||(t.mpdurl=r.originalUrl||r.url),t.terror||(t.terror=new Date),i.addDVBErrors(t);}}function u(e){e.error||(r=e.manifest);}function l(e){s({errorcode:p.default.BASE_URL_CHANGED,servicelocation:e.entry});}function d(){s({errorcode:p.default.BECAME_REPORTER});}function f(e){switch(e.metric){case a.HTTP_REQUEST:(0===(t=e.value).responsecode||400<=t.responsecode||t.responsecode<100||600<=t.responsecode)&&s({errorcode:t.responsecode||p.default.CONNECTION_ERROR,url:t.url,terror:t.tresponse,servicelocation:t._serviceLocation});}var t;}function c(e){var t=void 0;switch(e.error?e.error.code:0){case MediaError.MEDIA_ERR_NETWORK:t=p.default.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:t=p.default.CORRUPT_MEDIA_OTHER;break;default:return}s({errorcode:t});}function h(){n.on(o.MANIFEST_UPDATED,u,t),n.on(o.SERVICE_LOCATION_BLACKLIST_CHANGED,l,t),n.on(o.METRIC_ADDED,f,t),n.on(o.METRIC_UPDATED,f,t),n.on(o.PLAYBACK_ERROR,c,t),n.on(g.default.BECAME_REPORTING_PLAYER,d,t);}return t={initialise:h,reset:function(){n.off(o.MANIFEST_UPDATED,u,t),n.off(o.SERVICE_LOCATION_BLACKLIST_CHANGED,l,t),n.off(o.METRIC_ADDED,f,t),n.off(o.METRIC_UPDATED,f,t),n.off(o.PLAYBACK_ERROR,c,t),n.off(g.default.BECAME_REPORTING_PLAYER,d,t);}},h(),t}i.__dashjs_factory_name="DVBErrorsTranslator",n.default=dashjs.FactoryMaker.getSingletonFactory(i),t.exports=n.default;},{125:125,143:143}],139:[function(e,t,n){function r(){return {reconstructFullMetricName:function(e,t,n){var r=e;return t&&(r+="("+t,n&&n.length&&(r+=","+n),r+=")"),r},validateN:function(e){if(!e)throw new Error("missing n");if(isNaN(e))throw new Error("n is NaN");if(e<0)throw new Error("n must be positive");return e}}}Object.defineProperty(n,"__esModule",{value:!0}),r.__dashjs_factory_name="HandlerHelpers",n.default=dashjs.FactoryMaker.getSingletonFactory(r),t.exports=n.default;},{}],140:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(144)),c=r(e(145)),a=r(e(146));function o(e){var d=(e=e||{}).adapter,f=e.constants;return {getMetrics:function(l){var t=[];return l&&l.Metrics_asArray&&l.Metrics_asArray.forEach(function(e){var s=new i.default,u=d.getIsDynamic(l);e.hasOwnProperty("metrics")&&(s.metrics=e.metrics,e.Range_asArray&&e.Range_asArray.forEach(function(e){var t,n,r,i,a,o=new c.default;o.starttime=(t=l,n=e,i=r=void 0,a=0,u?a=d.getAvailabilityStartTime(t)/1e3:(r=d.getRegularPeriods(t)).length&&(a=r[0].start),i=a,n&&n.hasOwnProperty(f.START_TIME)&&(i+=n.starttime),i),e.hasOwnProperty("duration")?o.duration=e.duration:o.duration=d.getDuration(l),o._useWallClockTime=u,s.Range.push(o);}),e.Reporting_asArray&&(e.Reporting_asArray.forEach(function(e){var t=new a.default;if(e.hasOwnProperty(f.SCHEME_ID_URI)){for(var n in t.schemeIdUri=e.schemeIdUri,e)e.hasOwnProperty(n)&&(t[n]=e[n]);s.Reporting.push(t);}}),t.push(s)));}),t}}}o.__dashjs_factory_name="ManifestParsing",n.default=dashjs.FactoryMaker.getSingletonFactory(o),t.exports=n.default;},{144:144,145:145,146:146}],141:[function(e,t,n){function r(){return {serialise:function n(e){var t=[],r=[],i=void 0,a=void 0;for(i in e)if(e.hasOwnProperty(i)&&0!==i.indexOf("_")){if(null==(a=e[i])&&(a=""),Array.isArray(a)){if(!a.length)continue;r=[],a.forEach(function(e){var t="Object"!==Object.prototype.toString.call(e).slice(8,-1);r.push(t?e:n(e));}),a=r.map(encodeURIComponent).join(",");}else "string"==typeof a?a=encodeURIComponent(a):a instanceof Date?a=a.toISOString():"number"==typeof a&&(a=Math.round(a));t.push(i+"="+a);}return t.join("&")}}}Object.defineProperty(n,"__esModule",{value:!0}),r.__dashjs_factory_name="MetricSerialiser",n.default=dashjs.FactoryMaker.getSingletonFactory(r),t.exports=n.default;},{}],142:[function(e,t,n){function r(){var e,r=window.crypto||window.msCrypto,t=Uint32Array,i=Math.pow(2,8*t.BYTES_PER_ELEMENT)-1,n=10,a=void 0,o=void 0;function s(){r&&(a=a||new t(n),r.getRandomValues(a),o=0);}return e={random:function(e,t){var n=void 0;return e=e||0,t=t||1,r?(o===a.length&&s(),n=a[o]/i,o+=1):n=Math.random(),n*(t-e)+e}},s(),e}Object.defineProperty(n,"__esModule",{value:!0}),r.__dashjs_factory_name="RNG",n.default=dashjs.FactoryMaker.getSingletonFactory(r),t.exports=n.default;},{}],143:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});function r(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null;}r.SSL_CONNECTION_FAILED_PREFIX="SSL",r.DNS_RESOLUTION_FAILED="C00",r.HOST_UNREACHABLE="C01",r.CONNECTION_REFUSED="C02",r.CONNECTION_ERROR="C03",r.CORRUPT_MEDIA_ISOBMFF="M00",r.CORRUPT_MEDIA_OTHER="M01",r.BASE_URL_CHANGED="F00",r.BECAME_REPORTER="S00",n.default=r,t.exports=n.default;},{}],144:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metrics="",this.Range=[],this.Reporting=[];},t.exports=n.default;},{}],145:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1;},t.exports=n.default;},{}],146:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri="",this.value="";},t.exports=n.default;},{}],147:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});function u(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),this.data={baseUrls:e||null,selectedIdx:t||NaN},this.children=[];}var l=r(e(216)),i=r(e(47));function a(){var e,i=void 0,a=void 0,t=this.context,o=(0, l.default)(t).getInstance();function s(e,t,n){var r=a.getBaseURLsFromElement(n);e[t]?o.areEqual(r,e[t].data.baseUrls)||(e[t].data.baseUrls=r,e[t].data.selectedIdx=NaN):e[t]=new u(r);}function n(e){!function(){if(!a||!a.hasOwnProperty("getBaseURLsFromElement")||!a.hasOwnProperty("getRepresentationSortFunction"))throw new Error("setConfig function has to be called previously")}();var t=a.getBaseURLsFromElement(e);o.areEqual(t,i.data.baseUrls)||(i.data.baseUrls=t,i.data.selectedIdx=NaN),e&&e.Period_asArray&&e.Period_asArray.forEach(function(e,r){s(i.children,r,e),e.AdaptationSet_asArray&&e.AdaptationSet_asArray.forEach(function(e,n){s(i.children[r].children,n,e),e.Representation_asArray&&e.Representation_asArray.sort(a.getRepresentationSortFunction()).forEach(function(e,t){s(i.children[r].children[n].children,t,e);});});});}function r(){i=new u;}return e={reset:r,update:function(e){n(e);},getForPath:function(e){var t=i,n=[t.data];return e&&e.forEach(function(e){(t=t.children[e])&&n.push(t.data);}),n.filter(function(e){return e.baseUrls.length})},invalidateSelectedIndexes:function(t){!function t(n,e){var r=e||i;n(r.data),r.children&&r.children.forEach(function(e){return t(n,e)});}(function(e){isNaN(e.selectedIdx)||t===e.baseUrls[e.selectedIdx].serviceLocation&&(e.selectedIdx=NaN);});},setConfig:function(e){e.adapter&&(a=e.adapter);}},r(),e}a.__dashjs_factory_name="BaseURLTreeModel",n.default=i.default.getClassFactory(a),t.exports=n.default;},{216:216,47:47}],148:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var p=r(e(46)),g=r(e(101)),i=r(e(47)),_=r(e(45)),E=r(e(48)),m=e(241),v=r(e(65)),y=r(e(49)),a=e(50),T="dash.js-v"+(0, a.getVersionString)(),S=null,A=1,I=2,R=3,b=4,D="m",M="a",N="v",C="i",O="c",w="d",P="s",L="v",x="l";function o(){var r=void 0,e=void 0,u=void 0,l=void 0,d=void 0,n=void 0,t=this.context,i=(0, p.default)(t).getInstance(),a=(0, E.default)(t).getInstance();function o(){u={pr:1,nor:null,st:null,sf:null,sid:""+y.default.generateUuid(),bs:{audio:A,video:A},cid:null,did:T};}function f(){var e={v:1};return e.sid=a.get().streaming.cmcd.sid?a.get().streaming.cmcd.sid:u.sid,e.cid=a.get().streaming.cmcd.cid?a.get().streaming.cmcd.cid:u.cid,e.did=a.get().streaming.cmcd.did?a.get().streaming.cmcd.did:u.did,e.sid='"'+e.sid+'"',e.cid='"'+e.cid+'"',e.did='"'+e.did+'"',isNaN(u.pr)||1===u.pr||null===u.pr||(e.pr=u.pr),u.st&&(e.st=u.st),u.sf&&(e.sf=u.sf),e}function s(e){try{u.pr=e.playbackRate;}catch(e){}}function c(e){try{var t=r.getIsDynamic(e.data)?""+x:""+L,n=e.protocol&&"MSS"===e.protocol?""+P:""+w;u.st=t,u.sf=n;}catch(e){}}function h(e){try{if(e.state&&e.mediaType){var t=null;switch(e.state){case g.default.BUFFER_LOADED:t=S;break;case g.default.BUFFER_EMPTY:n.isSeeking()&&(t=I),t=b;}u.bs[e.mediaType]=t;}}catch(e){}}return e={getQueryParameter:function(e){try{return a.get().streaming.cmcd&&a.get().streaming.cmcd.enabled?{key:"Common-Media-Client-Data",value:function(i){try{var e=function(){if(!i)return {v:null};var e=Object.keys(i),r=e.length;return {v:e.reduce(function(e,t,n){return e+=t+"="+i[t],n<r-1&&(e+=","),e},"")}}();if("object"==typeof e)return e.v}catch(e){return null}}(function(e){try{return e.type===m.HTTPRequest.MPD_TYPE?(function(e){try{u.cid=""+y.default.generateHashCode(e.url);}catch(e){}}(e),function(){var e=f();return e.ot=""+D,e}()):e.type===m.HTTPRequest.MEDIA_SEGMENT_TYPE?function(e){var t=f(),n=function(e){try{var t=e.quality,n=e.mediaInfo.bitrateList;return parseInt(n[t].bandwidth/1e3)}catch(e){return null}}(e),r=function(e){try{return isNaN(e.duration)?null:Math.round(1e3*e.duration)}catch(e){return null}}(e),i="video"===e.mediaType?""+N:"audio"===e.mediaType?""+M:"fragmentedText"===e.mediaType?""+O:null,a=function(e){try{return Math.round(l.getThroughputHistory().getSafeAverageThroughput(e))}catch(e){return null}}(e.mediaType),o=function(e){try{var t=u.pr,n=d.getCurrentBufferLevel(e);return isNaN(t)||isNaN(n)?null:parseInt(n/t*1e3)}catch(e){return null}}(e.mediaType),s=function(e){try{var t=e.mediaType;if(null!==u.bs[t])return u.bs[t];var n=d.getCurrentBufferLevel(t),r=e.duration;return n<r?R:S}catch(e){}}(e);n&&(t.br=n);i&&(t.ot=i);isNaN(r)||(t.d=r);isNaN(a)||(t.mtp=a);isNaN(o)||(t.dl=o);isNaN(s)||null===s||(t.bs=s);return t}(e):e.type===m.HTTPRequest.INIT_SEGMENT_TYPE?function(){var e=f();return e.ot=""+C,e}():null}catch(e){return null}}(e))}:null}catch(e){return null}},setConfig:function(e){e&&(e.abrController&&(l=e.abrController),e.dashMetrics&&(d=e.dashMetrics),e.playbackController&&(n=e.playbackController));},reset:function(){i.off(g.default.PLAYBACK_RATE_CHANGED,s,this),i.off(g.default.MANIFEST_LOADED,c,this),i.off(g.default.BUFFER_LEVEL_STATE_CHANGED,h,e),o();},initialize:function(){i.on(g.default.PLAYBACK_RATE_CHANGED,s,e),i.on(g.default.MANIFEST_LOADED,c,e),i.on(g.default.BUFFER_LEVEL_STATE_CHANGED,h,e);}},(0, _.default)(t).getInstance().getLogger(e),r=(0, v.default)(t).getInstance(),o(),e}o.__dashjs_factory_name="CmcdModel",n.default=i.default.getSingletonFactory(o),t.exports=n.default;},{101:101,241:241,45:45,46:46,47:47,48:48,49:49,50:50,65:65}],149:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),y=r(e(227)),T="loading",S="executed";function a(e){var t,n=(e=e||{}).eventBus,r=e.events,i=e.dashMetrics,a=e.fragmentLoader,o=e.debug,s=e.streamId,u=void 0,l=void 0,d=void 0;function f(s){var u;return !!s&&(u=!1,l.some(function(e){if(a=s,o=e,!isNaN(a.index)&&a.startTime===o.startTime&&a.adaptationIndex===o.adaptationIndex&&a.type===o.type||(r=s,i=e,isNaN(r.index)&&isNaN(i.index)&&r.quality===i.quality)||(n=e,(t=s).action===y.default.ACTION_COMPLETE&&t.action===n.action))return u=!0;var t,n,r,i,a,o;}),u)}function c(e){return isNaN(e.duration)?.25:Math.min(e.duration/8,.5)}function h(n){l=l.filter(function(e){var t=c(e);return isNaN(e.startTime)||void 0!==n&&e.startTime>=n-t});}function p(n,r){r<=n+.5||(l=l.filter(function(e){var t=c(e);return isNaN(e.startTime)||e.startTime>=r-t||isNaN(e.duration)||e.startTime+e.duration<=n+t}));}function g(e,t){i.addSchedulingInfo(e,t),i.addRequestsQueue(e.mediaType,d,l);}function _(e){e.sender===a&&(d.splice(d.indexOf(e.request),1),e.response&&!e.error&&l.push(e.request),g(e.request,e.error?"failed":S),n.trigger(r.FRAGMENT_LOADING_COMPLETED,{request:e.request,response:e.response,error:e.error,sender:this}));}function E(e){e.sender===a&&n.trigger(r.FRAGMENT_LOADING_PROGRESS,{request:e.request,response:e.response,error:e.error,sender:this});}function m(e){e.sender===a&&n.trigger(r.FRAGMENT_LOADING_ABANDONED,{streamId:s,request:e.request,mediaType:e.mediaType});}function v(){l=[],d=[];}return t={getRequests:function(n){var e=n?n.state instanceof Array?n.state:[n.state]:[],r=[];return e.forEach(function(e){var t=function(e){var t=void 0;switch(e){case T:t=d;break;case S:t=l;break;default:t=[];}return t}(e);r=r.concat(function(e,n){if(n.hasOwnProperty("time"))return [function(e,t,n){for(var r=e.length-1;0<=r;r--){var i=e[r],a=i.startTime,o=a+i.duration;if(n=isNaN(n)?c(i):n,!isNaN(a)&&!isNaN(o)&&a<=t+n&&t-n<o||isNaN(a)&&isNaN(t))return i}return null}(e,n.time,n.threshold)];return e.filter(function(e){for(var t in n)if("state"!==t&&n.hasOwnProperty(t)&&e[t]!=n[t])return !1;return !0})}(t,n));}),r},isFragmentLoaded:f,isFragmentLoadedOrPending:function(e){var t=!1,n=0,r=void 0;if(!(t=f(e)))for(n=0;n<d.length;n++)r=d[n],e.url===r.url&&e.startTime===r.startTime&&(t=!0);return t},removeExecutedRequestsBeforeTime:h,removeExecutedRequestsAfterTime:function(t){l=l.filter(function(e){return isNaN(e.startTime)||void 0!==t&&e.startTime<t});},syncExecutedRequestsWithBufferedRange:function(e,t){if(e&&0!==e.length){for(var n=0,r=0,i=e.length;r<i;r++)p(n,e.start(r)),n=e.end(r);0<t&&p(n,t);}else h();},abortRequests:function(){a.abort(),d=[];},executeRequest:function(e){switch(e.action){case y.default.ACTION_COMPLETE:l.push(e),g(e,S),u.debug("STREAM_COMPLETED"),n.trigger(r.STREAM_COMPLETED,{request:e});break;case y.default.ACTION_DOWNLOAD:g(e,T),d.push(e),t=e,n.trigger(r.FRAGMENT_LOADING_STARTED,{streamId:s,request:t}),a.load(t);break;default:u.warn("Unknown request action.");}var t;},reset:function(){n.off(r.LOADING_COMPLETED,_,this),n.off(r.LOADING_DATA_PROGRESS,E,this),n.off(r.LOADING_ABANDONED,m,this),a&&a.reset(),v();},addExecutedRequest:function(e){l.push(e);}},u=o.getLogger(t),v(),n.on(r.LOADING_COMPLETED,_,t),n.on(r.LOADING_DATA_PROGRESS,E,t),n.on(r.LOADING_ABANDONED,m,t),t}a.__dashjs_factory_name="FragmentModel";var o=i.default.getClassFactory(a);o.FRAGMENT_MODEL_LOADING=T,o.FRAGMENT_MODEL_EXECUTED=S,o.FRAGMENT_MODEL_CANCELED="canceled",o.FRAGMENT_MODEL_FAILED="failed",i.default.updateClassFactory(a.__dashjs_factory_name,o),n.default=o,t.exports=n.default;},{227:227,47:47}],150:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(46)),a=r(e(54)),o=r(e(47));function s(){var e=this.context,t=(0, i.default)(e).getInstance(),n=void 0;return {getValue:function(){return n},setValue:function(e){(n=e)&&t.trigger(a.default.MANIFEST_LOADED,{data:e});}}}s.__dashjs_factory_name="ManifestModel",n.default=o.default.getSingletonFactory(s),t.exports=n.default;},{46:46,47:47,54:54}],151:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var f=r(e(96)),i=r(e(47)),c=r(e(108)),h=r(e(189)),p=r(e(48)),g=e(218);function a(){var e,i=void 0,r=void 0,a=void 0,t={scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"http://time.akamai.com/?iso&ms"},n=this.context,o=(0, p.default)(n).getInstance();function s(e){for(var t=void 0,t=0;t<a.length;t++)if(a[t].rulename===e)return t;return -1}function u(){return o.get().streaming.lowLatencyEnabled?o.get().streaming.liveDelay||3:o.get().streaming.liveDelay}function l(e,t){d(e,t);var n=new f.default;n.schemeIdUri=e,n.value=t,i.push(n);}function d(n,r){(0, g.checkParameterType)(n,"string"),(0, g.checkParameterType)(r,"string"),i.forEach(function(e,t){e.schemeIdUri===n&&e.value===r&&i.splice(t,1);});}return e={getABRCustomRules:function(){return a},addABRCustomRule:function(e,t,n){if("string"!=typeof e||e!==h.default.ABANDON_FRAGMENT_RULES&&e!==h.default.QUALITY_SWITCH_RULES||"string"!=typeof t)throw c.default.BAD_ARGUMENT_ERROR;var r=s(t);-1===r?a.push({type:e,rulename:t,rule:n}):(a[r].type=e,a[r].rule=n);},removeABRCustomRule:function(e){var t;e?-1!==(t=s(e))&&a.splice(t,1):a=[];},getStableBufferTime:function(){if(o.get().streaming.lowLatencyEnabled)return .6*u();var e=o.get().streaming.stableBufferTime;return -1<e?e:o.get().streaming.fastSwitchEnabled?20:12},getRetryAttemptsForType:function(e){var t=isNaN(o.get().streaming.retryAttempts.lowLatencyMultiplyFactor)?5:o.get().streaming.retryAttempts.lowLatencyMultiplyFactor;return o.get().streaming.lowLatencyEnabled?o.get().streaming.retryAttempts[e]*t:o.get().streaming.retryAttempts[e]},getRetryIntervalsForType:function(e){var t=isNaN(o.get().streaming.retryIntervals.lowLatencyReductionFactor)?10:o.get().streaming.retryIntervals.lowLatencyReductionFactor;return o.get().streaming.lowLatencyEnabled?o.get().streaming.retryIntervals[e]/t:o.get().streaming.retryIntervals[e]},getLiveDelay:u,getLiveCatchupLatencyThreshold:function(){try{var e=o.get().streaming.liveCatchupLatencyThreshold,t=u();if(null!==e&&!isNaN(e))return Math.max(e,t);var n=o.get().streaming.liveCatchUpMinDrift,r=!isNaN(t)&&t?isNaN(n)?u():o.get().streaming.liveCatchUpMinDrift+u():NaN;return r&&!isNaN(r)?2*r:NaN}catch(e){return NaN}},addUTCTimingSource:l,removeUTCTimingSource:d,getUTCTimingSources:function(){return i},clearDefaultUTCTimingSources:function(){i=[];},restoreDefaultUTCTimingSources:function(){l(t.scheme,t.value);},setXHRWithCredentialsForType:function t(e,n){e?r[e]=!!n:Object.keys(r).forEach(function(e){t(e,n);});},getXHRWithCredentialsForType:function(e){var t=r[e];return void 0===t?r.default:t},getDefaultUtcTimingSource:function(){return t},reset:function(){}},r={default:!(i=[])},a=[],e}a.__dashjs_factory_name="MediaPlayerModel",n.default=i.default.getSingletonFactory(a),t.exports=n.default;},{108:108,189:189,218:218,47:47,48:48,96:96}],152:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var h=r(e(108)),m=r(e(109)),d=r(e(231)),v=e(241),p=r(e(244)),g=r(e(237)),_=r(e(238)),y=r(e(239)),T=r(e(240)),S=e(242),A=r(e(246)),I=r(e(46)),R=r(e(245)),b=r(e(54)),i=r(e(47));function a(e){var t,i=(e=e||{}).settings,n=this.context,r=(0, I.default)(n).getInstance(),a=void 0;function o(){r.trigger(b.default.METRICS_CHANGED);}function s(e){r.trigger(b.default.METRIC_CHANGED,{mediaType:e}),o();}function l(e,t,n){r.trigger(b.default.METRIC_UPDATED,{mediaType:e,metric:t,value:n}),s(e);}function f(e,t,n){r.trigger(b.default.METRIC_ADDED,{mediaType:e,metric:t,value:n}),s(e);}function u(e,t){var n=null;return e&&(a.hasOwnProperty(e)?n=a[e]:t||(n=new d.default,a[e]=n)),n}function c(e,t,n){var r=u(e);null!==r&&(r[t].push(n),r[t].length>i.get().streaming.metricsMaxListDepth&&r[t].shift());}function E(e,t,n){c(e,t,n),f(e,t,n);}return t={clearCurrentMetricsForType:function(e){delete a[e],s(e);},clearAllCurrentMetrics:function(){a={},o();},getMetricsFor:u,addHttpRequest:function e(t,n,r,i,a,o,s,u,l,d,f,c,h,p,g){var _=new v.HTTPRequest;o&&o!==i&&(e(t,null,r,i,a,null,null,u,l,null,null,null,h,null,null),_.actualurl=o),_.tcpid=n,_.type=r,_.url=i,_.range=u,_.trequest=l,_.tresponse=d,_.responsecode=c,_._tfinish=f,_._stream=t,_._mediaduration=h,_._quality=a,_._responseHeaders=p,_._serviceLocation=s,g?g.forEach(function(e){var t,n,r,i,a;t=_,n=e.s,r=e.d,i=e.b,(a=new v.HTTPRequestTrace).s=n,a.d=r,a.b=i,t.trace.push(a),t.interval||(t.interval=0),t.interval+=r;}):(delete _.interval,delete _.trace),E(t,m.default.HTTP_REQUEST,_);},addRepresentationSwitch:function(e,t,n,r,i){var a=new p.default;a.t=t,a.mt=n,a.to=r,i?a.lto=i:delete a.lto,E(e,m.default.TRACK_SWITCH,a);},addBufferLevel:function(e,t,n){var r=new g.default;r.t=t,r.level=n,E(e,m.default.BUFFER_LEVEL,r);},addBufferState:function(e,t,n){var r=new _.default;r.target=n,r.state=t,E(e,m.default.BUFFER_STATE,r);},addDVRInfo:function(e,t,n,r){var i=new y.default;i.time=t,i.range=r,i.manifestInfo=n,E(e,m.default.DVR_INFO,i);},addDroppedFrames:function(e,t){var n=new T.default,r=u(e).DroppedFrames;t&&(n.time=t.creationTime,n.droppedFrames=t.droppedVideoFrames,0<r.length&&r[r.length-1]==n||E(e,m.default.DROPPED_FRAMES,n));},addSchedulingInfo:function(e,t,n,r,i,a,o,s,u){var l=new A.default;l.mediaType=e,l.t=t,l.type=n,l.startTime=r,l.availabilityStartTime=i,l.duration=a,l.quality=o,l.range=s,l.state=u,E(e,m.default.SCHEDULING_INFO,l);},addRequestsQueue:function(e,t,n){var r=new R.default;r.loadingRequests=t,r.executedRequests=n,u(e).RequestsQueue=r,f(e,m.default.REQUESTS_QUEUE,r);},addManifestUpdate:function(e,t,n,r,i,a,o,s,u,l){var d=new S.ManifestUpdate;d.mediaType=e,d.type=t,d.requestTime=n,d.fetchTime=r,d.availabilityStartTime=i,d.presentationStartTime=a,d.clientTimeOffset=o,d.currentTime=s,d.buffered=u,d.latency=l,c(h.default.STREAM,m.default.MANIFEST_UPDATE,d),f(e,m.default.MANIFEST_UPDATE,d);},updateManifestUpdateInfo:function(e,t){if(e){for(var n in t)e[n]=t[n];l(e.mediaType,m.default.MANIFEST_UPDATE,e);}},addManifestUpdateStreamInfo:function(e,t,n,r,i){var a;e&&((a=new S.ManifestUpdateStreamInfo).id=t,a.index=n,a.start=r,a.duration=i,e.streamInfo.push(a),l(e.mediaType,m.default.MANIFEST_UPDATE_STREAM_INFO,e));},addManifestUpdateRepresentationInfo:function(e,t,n,r,i,a,o,s){var u;e&&e.representationInfo&&((u=new S.ManifestUpdateRepresentationInfo).id=t,u.index=n,u.streamIndex=r,u.mediaType=i,u.startNumber=o,u.fragmentInfoType=s,u.presentationTimeOffset=a,e.representationInfo.push(u),l(e.mediaType,m.default.MANIFEST_UPDATE_TRACK_INFO,e));},addPlayList:function(e){e.trace&&Array.isArray(e.trace)?e.trace.forEach(function(e){e.hasOwnProperty("subreplevel")&&!e.subreplevel&&delete e.subreplevel;}):delete e.trace,E(h.default.STREAM,m.default.PLAY_LIST,e);},addDVBErrors:function(e){E(h.default.STREAM,m.default.DVB_ERRORS,e);}},a={},t}a.__dashjs_factory_name="MetricsModel",n.default=i.default.getSingletonFactory(a),t.exports=n.default;},{108:108,109:109,231:231,237:237,238:238,239:239,240:240,241:241,242:242,244:244,245:245,246:246,46:46,47:47,54:54}],153:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var l=r(e(236)),i=r(e(47));function a(){var u=void 0;return {initialize:function(e){if(u=new l.default,!e)return null;var t=e.indexOf("#");if(-1!==t)for(var n=e.substr(t+1).split("&"),r=0,i=n.length;r<i;++r){var a,o=n[r],s=o.indexOf("=");-1!==s&&(a=o.substring(0,s),u.hasOwnProperty(a)&&(u[a]=o.substr(s+1)));}},getURIFragmentData:function(){return u}}}a.__dashjs_factory_name="URIFragmentModel",n.default=i.default.getSingletonFactory(a),t.exports=n.default;},{236:236,47:47}],154:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),g=r(e(46)),_=r(e(54)),E=r(e(45));function a(){var e=void 0,t=void 0,o=void 0,n=void 0,r=void 0,i="element is not video or audio DOM type!",a=this.context,s=(0, g.default)(a).getInstance(),u=[];function l(){o&&(o.playbackRate=r||1,o.removeEventListener("canplay",l));}function d(e){o&&(o.readyState<=2&&0<e?o.addEventListener("canplay",l):o.playbackRate=e);}function f(){return 0<u.length}function c(){var e;o&&f()&&0===o.playbackRate&&((e=document.createEvent("Event")).initEvent("waiting",!0,!1),o.dispatchEvent(e));}function h(){return o?o.buffered:null}function p(e,t,n,r,i){if(o)for(var a=0;a<o.textTracks.length;a++)if(o.textTracks[a].kind===e&&(!t||o.textTracks[a].label==t)&&o.textTracks[a].language===n&&o.textTracks[a].isTTML===r&&o.textTracks[a].isEmbedded===i)return o.textTracks[a];return null}return e={initialize:function(){s.on(_.default.PLAYBACK_PLAYING,c,this);},setCurrentTime:function(t,e){if(o){if(o.currentTime==t)return;try{t=e?function(e){var t=h(),n=e,r=9999999999;if(t)for(var i=0;i<t.length;i++){var a=t.start(i),o=t.end(i),s=Math.abs(a-e),u=Math.abs(o-e);if(a<=e&&e<=o)return e;s<r&&(r=s,n=a),u<r&&(r=u,n=o);}return n}(t):t,o.currentTime=t;}catch(e){0===o.readyState&&e.code===e.INVALID_STATE_ERR&&setTimeout(function(){o.currentTime=t;},400);}}},play:function(){var e;o&&(o.autoplay=!0,(e=o.play())&&e.catch&&"undefined"!=typeof Promise&&e.catch(function(e){"NotAllowedError"===e.name&&s.trigger(_.default.PLAYBACK_NOT_ALLOWED),t.warn("Caught pending play exception - continuing ("+e+")");}));},isPaused:function(){return o?o.paused:null},pause:function(){o&&(o.pause(),o.autoplay=!1);},isSeeking:function(){return o?o.seeking:null},getTime:function(){return o?o.currentTime:null},getPlaybackRate:function(){return o?o.playbackRate:null},setPlaybackRate:d,getPlayedRanges:function(){return o?o.played:null},getEnded:function(){return o?o.ended:null},setStallState:function(e,t){(t?function(e){var t=void 0;if(null===e||o.seeking||-1!==u.indexOf(e))return;u.push(e),o&&1===u.length&&((t=document.createEvent("Event")).initEvent("waiting",!0,!1),r=o.playbackRate,d(0),o.dispatchEvent(t));}:function(e){var t=u.indexOf(e),n=void 0;if(null===e)return;-1!==t&&u.splice(t,1);o&&!1===f()&&0===o.playbackRate&&(d(r||1),o.paused||((n=document.createEvent("Event")).initEvent("playing",!0,!1),o.dispatchEvent(n)));})(e);},getElement:function(){return o},setElement:function(e){if(!(null==e||e&&/^(VIDEO|AUDIO)$/i.test(e.nodeName)))throw i;(o=e)&&(o.preload="auto");},setSource:function(e){o&&(e?o.src=e:(o.removeAttribute("src"),o.load()));},getSource:function(){return o?o.src:null},getTTMLRenderingDiv:function(){return n},setTTMLRenderingDiv:function(e){(n=e).style.position="absolute",n.style.display="flex",n.style.overflow="hidden",n.style.pointerEvents="none",n.style.top=0,n.style.left=0;},getPlaybackQuality:function(){if(!o)return null;var e="webkitDroppedFrameCount"in o&&"webkitDecodedFrameCount"in o,t=null;return "getVideoPlaybackQuality"in o?t=o.getVideoPlaybackQuality():e&&(t={droppedVideoFrames:o.webkitDroppedFrameCount,totalVideoFrames:o.webkitDroppedFrameCount+o.webkitDecodedFrameCount,creationTime:new Date}),t},addEventListener:function(e,t){o&&o.addEventListener(e,t);},removeEventListener:function(e,t){o&&o.removeEventListener(e,t);},getReadyState:function(){return o?o.readyState:NaN},getBufferRange:h,getClientWidth:function(){return o?o.clientWidth:NaN},getClientHeight:function(){return o?o.clientHeight:NaN},getTextTracks:function(){return o?o.textTracks:[]},getTextTrack:p,addTextTrack:function(e,t,n,r,i){if(!o)return null;var a=p(e,t,n,r,i);return a||((a=o.addTextTrack(e,t,n)).isEmbedded=i,a.isTTML=r),a},appendChild:function(e){o&&(o.appendChild(e),void 0!==e.isTTML&&(o.textTracks[o.textTracks.length-1].isTTML=e.isTTML,o.textTracks[o.textTracks.length-1].isEmbedded=e.isEmbedded));},removeChild:function(e){o&&o.removeChild(e);},getVideoWidth:function(){return o?o.videoWidth:NaN},getVideoHeight:function(){return o?o.videoHeight:NaN},getVideoRelativeOffsetTop:function(){var e=o.parentNode.host||o.parentNode;return e?o.getBoundingClientRect().top-e.parentNode.getBoundingClientRect().top:NaN},getVideoRelativeOffsetLeft:function(){var e=o.parentNode.host||o.parentNode;return e?o.getBoundingClientRect().left-e.getBoundingClientRect().left:NaN},reset:function(){s.off(_.default.PLAYBACK_PLAYING,c,this);}},t=(0, E.default)(a).getInstance().getLogger(e),e}a.__dashjs_factory_name="VideoModel",n.default=i.default.getSingletonFactory(a),t.exports=n.default;},{45:45,46:46,47:47,54:54}],155:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(47),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var a=(e=e||{}).requestModifier,g=e.boxParser;function _(t,e){t.reader.read().then(e).catch(function(e){t.onerror&&200===t.response.status&&t.onerror(e);});}function E(i,t){if(1<(i=i.filter(function(e){return e.bytes>t/4/i.length})).length){var e=(a=0,o=(i[i.length-1].ts-i[0].ts)/i.length,i.forEach(function(e,t){var n,r=i[t+1];r&&(n=r.ts-e.ts,a+=n<o?n:0);}),{v:a});if("object"==typeof e)return e.v}var a,o;return null}return {load:function(p){var e=new Date,t=p.request,n=new Headers;t.range&&n.append("Range","bytes="+t.range),t.requestStartDate||(t.requestStartDate=e),a&&a.modifyRequestHeader({setRequestHeader:function(e,t){n.append(e,t);}});var r=void 0;"function"==typeof window.AbortController&&(r=new AbortController,(p.abortController=r).signal.onabort=p.onabort);var i={method:p.method,headers:n,credentials:p.withCredentials?"include":void 0,signal:r?r.signal:void 0};fetch(p.url,i).then(function(e){p.response||(p.response={}),p.response.status=e.status,p.response.statusText=e.statusText,p.response.responseURL=e.url,e.ok||p.onerror();var t="",n=!0,r=!1,i=void 0;try{for(var a,o=e.headers.keys()[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;t+=s+": "+e.headers.get(s)+"\r\n";}}catch(e){r=!0,i=e;}finally{try{!n&&o.return&&o.return();}finally{if(r)throw i}}if(p.response.responseHeaders=t,!e.body)return e.arrayBuffer().then(function(e){var t={loaded:(p.response.response=e).byteLength,total:e.byteLength,stream:!1};p.progress(t),p.onload(),p.onend();});var u=parseInt(e.headers.get("Content-Length"),10),l=0,d=!1,f=new Uint8Array,c=0;p.reader=e.body.getReader();var h=[];_(p,function e(t){var n,r,i,a=t.value;if(t.done)return f&&(p.progress({loaded:l,total:isNaN(u)?l:u,lengthComputable:!0,time:E(h,l),stream:!0}),p.response.response=f.buffer),p.onload(),void p.onend();a&&0<a.length&&(f=function(e,t){if(0===e.length)return t;var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(f,a),l+=a.length,h.push({ts:Date.now(),bytes:a.length}),(n=g.findLastTopIsoBoxCompleted(["moov","mdat"],f,c)).found?(r=n.lastCompletedOffset+n.size,i=void 0,f=r===f.length?(i=f,new Uint8Array):(i=new Uint8Array(f.subarray(0,r)),f.subarray(r)),p.progress({data:i.buffer,lengthComputable:!1,noTrace:!0}),c=0):(c=n.lastCompletedOffset,d||(p.progress({lengthComputable:!1,noTrace:!0}),d=!0))),_(p,e);});}).catch(function(e){p.onerror&&p.onerror(e);});},abort:function(e){if(e.abortController)e.abortController.abort();else if(e.reader)try{e.reader.cancel(),e.onabort();}catch(e){}},calculateDownloadedTime:E}}o.__dashjs_factory_name="FetchLoader";var s=a.default.getClassFactory(o);n.default=s,t.exports=n.default;},{47:47}],156:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0});var C=r(e(159)),O=r(e(155)),w=e(241),a=r(e(47)),P=r(e(225)),o=r(e(148)),L=r(e(49));function s(e){e=e||{};var t,n,E=this.context,m=e.errHandler,v=e.dashMetrics,y=e.mediaPlayerModel,T=e.requestModifier,S=e.boxParser,A=e.useFetch||!1,r=e.errors,I=void 0,R=void 0,b=void 0,D=void 0,M=void 0;function N(n,t){var r=n.request,i=[],a=!0,o=!0,s=new Date,u=s,l=0,d=void 0;if(!T||!v||!m)throw new Error("config object is not correct or missing");function e(e){o=!1,r.requestStartDate=s,r.requestEndDate=new Date,r.firstByteDate=r.firstByteDate||s,r.checkExistenceOnly||(v.addHttpRequest(r,d.response?d.response.responseURL:null,d.response?d.response.status:null,d.response&&d.response.getAllResponseHeaders?d.response.getAllResponseHeaders():d.response?d.response.responseHeaders:[],e?i:null),r.type===w.HTTPRequest.MPD_TYPE&&v.addManifestUpdate(r.type,r.requestStartDate,r.requestEndDate));}function f(){-1!==I.indexOf(d)&&(I.splice(I.indexOf(d),1),o&&(e(!1),0<t?function(){t--;var e={config:n};b.push(e),e.timeout=setTimeout(function(){-1!==b.indexOf(e)&&(b.splice(b.indexOf(e),1),N(n,t));},y.getRetryIntervalsForType(r.type));}():(m.error(new P.default(D[r.type],r.url+" is not available",{request:r,response:d.response})),n.error&&n.error(r,"error",d.response.statusText),n.complete&&n.complete(r,d.response.statusText))));}var c,h=void 0,h=A&&window.fetch&&"arraybuffer"===r.responseType&&r.type===w.HTTPRequest.MEDIA_SEGMENT_TYPE?(0, O.default)(E).create({requestModifier:T,boxParser:S}):(0, C.default)(E).create({requestModifier:T}),p=T.modifyRequestURL(r.url),g=function(e){try{var t=[],n=M.getQueryParameter(e);return n&&t.push(n),t}catch(e){return []}}(r),d={url:p=L.default.addAditionalQueryParameterToUrl(p,g),method:r.checkExistenceOnly?w.HTTPRequest.HEAD:w.HTTPRequest.GET,withCredentials:y.getXHRWithCredentialsForType(r.type),request:r,onload:function(){200<=d.response.status&&d.response.status<=299&&(e(!0),n.success&&n.success(d.response.response,d.response.statusText,d.response.responseURL),n.complete&&n.complete(r,d.response.statusText));},onend:f,onerror:f,progress:function(e){var t=new Date;a&&(a=!1,(!e.lengthComputable||e.lengthComputable&&e.total!==e.loaded)&&(r.firstByteDate=t)),e.lengthComputable&&(r.bytesLoaded=e.loaded,r.bytesTotal=e.total),e.noTrace||(i.push({s:u,d:e.time?e.time:t.getTime()-u.getTime(),b:[e.loaded?e.loaded-l:0]}),u=t,l=e.loaded),n.progress&&e&&n.progress(e);},onabort:function(){n.abort&&n.abort(r);},loader:h},_=(new Date).getTime();isNaN(r.delayLoadingTime)||_>=r.delayLoadingTime?(I.push(d),h.load(d)):(c={httpRequest:d},R.push(c),c.delayTimeout=setTimeout(function(){if(-1!==R.indexOf(c)){R.splice(R.indexOf(c),1);try{s=new Date,u=s,I.push(c.httpRequest),h.load(c.httpRequest);}catch(e){c.httpRequest.onerror();}}},r.delayLoadingTime-_));}return t={load:function(e){e.request?N(e,y.getRetryAttemptsForType(e.request.type)):e.error&&e.error(e.request,"error");},abort:function(){b.forEach(function(e){clearTimeout(e.timeout),e.config.request&&e.config.abort&&e.config.abort(e.config.request);}),b=[],R.forEach(function(e){return clearTimeout(e.delayTimeout)}),R=[],I.forEach(function(e){e.onloadend=e.onerror=e.onprogress=void 0,e.loader.abort(e);}),I=[];}},I=[],R=[],b=[],M=(0, o.default)(E).getInstance(),i(n={},w.HTTPRequest.MPD_TYPE,r.DOWNLOAD_ERROR_ID_MANIFEST_CODE),i(n,w.HTTPRequest.XLINK_EXPANSION_TYPE,r.DOWNLOAD_ERROR_ID_XLINK_CODE),i(n,w.HTTPRequest.INIT_SEGMENT_TYPE,r.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE),i(n,w.HTTPRequest.MEDIA_SEGMENT_TYPE,r.DOWNLOAD_ERROR_ID_CONTENT_CODE),i(n,w.HTTPRequest.INDEX_SEGMENT_TYPE,r.DOWNLOAD_ERROR_ID_CONTENT_CODE),i(n,w.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,r.DOWNLOAD_ERROR_ID_CONTENT_CODE),i(n,w.HTTPRequest.OTHER_TYPE,r.DOWNLOAD_ERROR_ID_CONTENT_CODE),D=n,t}s.__dashjs_factory_name="HTTPLoader";var u=a.default.getClassFactory(s);n.default=u,t.exports=n.default;},{148:148,155:155,159:159,225:225,241:241,47:47,49:49}],157:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),a=r(e(156));function o(){var n=void 0;function e(){n={};}function t(){e();}return t(),{getLoader:function(e){for(var t in n)if(n.hasOwnProperty(t)&&e.startsWith(t))return n[t];return a.default},registerLoader:function(e,t){n[e]=t;},unregisterLoader:function(e){n[e]&&delete n[e];},unregisterAllLoader:e,reset:t}}o.__dashjs_factory_name="SchemeLoaderFactory";var s=i.default.getSingletonFactory(o);n.default=s,t.exports=n.default;},{156:156,47:47}],158:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),o=r(e(157));function a(n){n=n||{};var r=this.context,i=void 0,a=void 0;return i=(0, o.default)(r).getInstance(),{load:function(e){var t=i.getLoader(e&&e.request?e.request.url:null);(a=t(r).create({errHandler:n.errHandler,mediaPlayerModel:n.mediaPlayerModel,requestModifier:n.requestModifier,useFetch:n.useFetch||null,dashMetrics:n.dashMetrics,boxParser:n.boxParser?n.boxParser:null,constants:n.constants?n.constants:null,dashConstants:n.dashConstants?n.dashConstants:null,urlUtils:n.urlUtils?n.urlUtils:null,errors:n.errors})).load(e);},abort:function(){a&&a.abort();}}}a.__dashjs_factory_name="URLLoader";var s=i.default.getClassFactory(a);n.default=s,t.exports=n.default;},{157:157,47:47}],159:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(47),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var i=(e=e||{}).requestModifier;return {load:function(e){var t=new Date,n=e.request,r=new XMLHttpRequest;r.open(e.method,e.url,!0),n.responseType&&(r.responseType=n.responseType),n.range&&r.setRequestHeader("Range","bytes="+n.range),n.requestStartDate||(n.requestStartDate=t),i&&(r=i.modifyRequestHeader(r)),r.withCredentials=e.withCredentials,r.onload=e.onload,r.onloadend=e.onend,r.onerror=e.onerror,r.onprogress=e.progress,r.onabort=e.onabort,r.send(),e.response=r;},abort:function(e){var t=e.response;t.onloadend=t.onerror=t.onprogress=void 0,t.abort();}}}o.__dashjs_factory_name="XHRLoader";var s=a.default.getClassFactory(o);n.default=s,t.exports=n.default;},{47:47}],160:[function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}Object.defineProperty(n,"__esModule",{value:!0});var i=(function(e,t,n){return n&&r(e,n),e}(a,null,[{key:"findCencContentProtection",value:function(e){for(var t=null,n=0;n<e.length;++n){var r=e[n];"urn:mpeg:dash:mp4protection:2011"===r.schemeIdUri.toLowerCase()&&"cenc"===r.value.toLowerCase()&&(t=r);}return t}},{key:"getPSSHData",value:function(e){var t=8,n=new DataView(e),r=n.getUint8(t);return t+=20,0<r&&(t+=4+16*n.getUint32(t)),t+=4,e.slice(t)}},{key:"getPSSHForKeySystem",value:function(e,t){var n=a.parsePSSHList(t);return e&&n.hasOwnProperty(e.uuid.toLowerCase())?n[e.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(e,t){return "pssh"in e?(e.pssh.__text=e.pssh.__text.replace(/\r?\n|\r/g,"").replace(/\s+/g,""),t.decodeArray(e.pssh.__text).buffer):null}},{key:"parsePSSHList",value:function(e){if(null==e)return [];for(var t=new DataView(e.buffer||e),n={},r=0;;){var i,a,o=void 0,s=r;if(r>=t.buffer.byteLength)break;if(i=r+t.getUint32(r),r+=4,1886614376===t.getUint32(r))if(r+=4,0===(a=t.getUint8(r))||1===a){r++,r+=3,o="";for(var u=void 0,l=void 0,u=0;u<4;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=4,o+="-",u=0;u<2;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=2,o+="-",u=0;u<2;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=2,o+="-",u=0;u<2;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=2,o+="-",u=0;u<6;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;r+=6,o=o.toLowerCase(),t.getUint32(r),r+=4,n[o]=t.buffer.slice(s,i),r=i;}else r=i;else r=i;}return n}}]),a);function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);}n.default=i,t.exports=n.default;},{}],161:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var h=r(e(163)),p=r(e(164)),i=r(e(162)),a=r(e(169)),g=r(e(171)),_=r(e(172)),E=r(e(170)),m=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],v=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];function o(){var d=void 0,f=this.context;function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];if("function"==typeof e[r[Object.keys(r)[0]]])return r}return null}return d={createProtectionSystem:function(e){var t=null,n=(0, p.default)(f).getInstance();n.setConfig({debug:e.debug,BASE64:e.BASE64}),n.initialize();var r,i,a,o,s,u,l=(i=(r=e).debug,a=i.getLogger(d),o=r.eventBus,s=r.errHandler,(u=r.videoModel?r.videoModel.getElement():null)&&void 0===u.onencrypted||u&&void 0===u.mediaKeys?c(u,v)?(a.info("EME detected on this user agent! (ProtectionModel_3Feb2014)"),(0, _.default)(f).create({debug:i,eventBus:o,events:r.events,api:c(u,v)})):c(u,m)?(a.info("EME detected on this user agent! (ProtectionModel_01b)"),(0, E.default)(f).create({debug:i,eventBus:o,errHandler:s,events:r.events,api:c(u,m)})):(a.warn("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null):(a.info("EME detected on this user agent! (ProtectionModel_21Jan2015)"),(0, g.default)(f).create({debug:i,eventBus:o,events:r.events})));return !t&&l&&(t=(0, h.default)(f).create({protectionModel:l,protectionKeyController:n,eventBus:e.eventBus,debug:e.debug,events:e.events,BASE64:e.BASE64,constants:e.constants}),e.capabilities.setEncryptedMediaSupported(!0)),t}}}o.__dashjs_factory_name="Protection";var s=dashjs.FactoryMaker.getClassFactory(o);s.events=i.default,s.errors=a.default,dashjs.FactoryMaker.updateClassFactory(o.__dashjs_factory_name,s),n.default=s,t.exports=n.default;},{162:162,163:163,164:164,169:169,170:170,171:171,172:172}],162:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n,r=!1;null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0;}};var i,a=e(55);function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r(Object.getPrototypeOf(o.prototype),"constructor",this).call(this),this.INTERNAL_KEY_MESSAGE="internalKeyMessage",this.INTERNAL_KEY_SYSTEM_SELECTED="internalKeySystemSelected",this.INTERNAL_KEY_STATUS_CHANGED="internalkeyStatusChanged",this.KEY_ADDED="public_keyAdded",this.KEY_ERROR="public_keyError",this.KEY_MESSAGE="public_keyMessage",this.KEY_SESSION_CLOSED="public_keySessionClosed",this.KEY_SESSION_CREATED="public_keySessionCreated",this.KEY_SESSION_REMOVED="public_keySessionRemoved",this.KEY_STATUSES_CHANGED="public_keyStatusesChanged",this.KEY_SYSTEM_ACCESS_COMPLETE="public_keySystemAccessComplete",this.KEY_SYSTEM_SELECTED="public_keySystemSelected",this.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",this.NEED_KEY="needkey",this.PROTECTION_CREATED="public_protectioncreated",this.PROTECTION_DESTROYED="public_protectiondestroyed",this.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",this.TEARDOWN_COMPLETE="protectionTeardownComplete",this.VIDEO_ELEMENT_SELECTED="videoElementSelected";}var s=new(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);}(o,((i=a)&&i.__esModule?i:{default:i}).default),o);n.default=s,t.exports=n.default;},{55:55}],163:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var N=r(e(160)),C=r(e(182)),O=r(e(181)),w=r(e(169)),P=r(e(225));function i(e){var t,y=(e=e||{}).protectionKeyController,T=e.protectionModel,S=e.eventBus,A=e.events,n=e.debug,d=e.BASE64,l=e.constants,s=[],I=void 0,f=void 0,c=void 0,h=void 0,r=void 0,p=void 0,R=void 0;function i(){if(!(S&&S.hasOwnProperty("on")&&y&&y.hasOwnProperty("getSupportedKeySystemsFromContentProtection")))throw new Error("Missing config parameter(s)")}function g(e,t){var n=N.default.getPSSHForKeySystem(R,e),r=b(R);if(n){for(var i=T.getAllInitData(),a=0;a<i.length;a++)if(y.initDataEquals(n,i[a]))return void I.warn("DRM: Ignoring initData because we have already seen it!");try{T.createKeySession(n,r,m(R),t);}catch(e){S.trigger(A.KEY_SESSION_CREATED,{data:null,error:new P.default(w.default.KEY_SESSION_CREATED_ERROR_CODE,w.default.KEY_SESSION_CREATED_ERROR_MESSAGE+e.message)});}}else e?T.createKeySession(e,r,m(R),t):S.trigger(A.KEY_SESSION_CREATED,{data:null,error:new P.default(w.default.KEY_SESSION_CREATED_ERROR_CODE,w.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Selected key system is "+(R?R.systemString:null)+".  needkey/encrypted event contains no initData corresponding to that key system!")});}function _(e,t){i(),T.loadKeySession(e,t,m(R));}function a(e){i(),e?(T.setMediaElement(e),S.on(A.NEED_KEY,M,this)):null===e&&(T.setMediaElement(e),S.off(A.NEED_KEY,M,this));}function b(e){var t,n=null;return e&&(t=e.systemString,h&&(n=t in h?h[t]:null)),n}function E(e){var t=b(e),n=[],r=[],i=t&&t.audioRobustness&&0<t.audioRobustness.length?t.audioRobustness:p,a=t&&t.videoRobustness&&0<t.videoRobustness.length?t.videoRobustness:p,o=m(e),s=t&&t.distinctiveIdentifier?t.distinctiveIdentifier:"optional",u=t&&t.persistentState?t.persistentState:"temporary"===o?"optional":"required";return c.forEach(function(e){e.type===l.AUDIO?n.push(new C.default(e.codec,i)):e.type===l.VIDEO&&r.push(new C.default(e.codec,a));}),new O.default(n,r,s,u,[o])}function m(e){var t=b(e);return t&&t.sessionType?t.sessionType:r}function u(n,s){var u=this,t=[];n=n.sort(function(e,t){return (h&&h[e.ks.systemString]&&0<=h[e.ks.systemString].priority?h[e.ks.systemString].priority:n.length)-(h&&h[t.ks.systemString]&&0<=h[t.ks.systemString].priority?h[t.ks.systemString].priority:n.length)});var r,l=void 0;if(R)for(l=0;l<n.length;l++){if(R===n[l].ks)if("break"===function(){t.push({ks:n[l].ks,configs:[E(R)]});return S.on(A.KEY_SYSTEM_ACCESS_COMPLETE,function e(t){S.off(A.KEY_SYSTEM_ACCESS_COMPLETE,e,u),t.error?s||S.trigger(A.KEY_SYSTEM_SELECTED,{error:new P.default(w.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,w.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+t.error)}):(I.info("DRM: KeySystem Access Granted"),S.trigger(A.KEY_SYSTEM_SELECTED,{data:t.data}),n[l].sessionId?_(n[l].sessionId,n[l].initData):n[l].initData&&g(n[l].initData,n[l].cdmData));},u),T.requestKeySystemAccess(t),"break"}())break}else void 0===R?function(){R=null,f.push(n);for(var e=0;e<n.length;e++)t.push({ks:n[e].ks,configs:[E(n[e].ks)]});function a(e){S.off(A.KEY_SYSTEM_ACCESS_COMPLETE,a,u),e.error?(R=void 0,S.off(A.INTERNAL_KEY_SYSTEM_SELECTED,r,u),s||S.trigger(A.KEY_SYSTEM_SELECTED,{data:null,error:new P.default(w.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,w.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+e.error)})):(o=e.data,I.info("DRM: KeySystem Access Granted ("+o.keySystem.systemString+")!  Selecting key system..."),T.selectKeySystem(o));}var o=void 0;r=function e(t){if(S.off(A.INTERNAL_KEY_SYSTEM_SELECTED,e,u),S.off(A.KEY_SYSTEM_ACCESS_COMPLETE,a,u),t.error)R=void 0,s||S.trigger(A.KEY_SYSTEM_SELECTED,{data:null,error:new P.default(w.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,w.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+"Error selecting key system! -- "+t.error)});else {if(!T)return;R=T.getKeySystem(),S.trigger(A.KEY_SYSTEM_SELECTED,{data:o});var n=b(R);n&&n.serverCertificate&&0<n.serverCertificate.length&&T.setServerCertificate(d.decodeArray(n.serverCertificate).buffer);for(var r,i=0;i<f.length;i++)for(l=0;l<f[i].length;l++)if(R===f[i][l].ks){y.isClearKey(R)&&n&&n.hasOwnProperty("clearkeys")&&(r={kids:Object.keys(n.clearkeys)},f[i][l].initData=(new TextEncoder).encode(JSON.stringify(r))),f[i][l].sessionId?_(f[i][l].sessionId,f[i][l].initData):null!==f[i][l].initData&&g(f[i][l].initData,f[i][l].cdmData);break}}},S.on(A.INTERNAL_KEY_SYSTEM_SELECTED,r,u),S.on(A.KEY_SYSTEM_ACCESS_COMPLETE,a,u),T.requestKeySystemAccess(t);}():f.push(n);}function D(e,t){S.trigger(A.LICENSE_REQUEST_COMPLETE,{data:e,error:t});}function o(e){e.error?S.trigger(A.KEY_STATUSES_CHANGED,{data:null,error:e.error}):I.debug("DRM: key status = "+e.status);}function v(e){I.debug("DRM: onKeyMessage");var t=e.data;S.trigger(A.KEY_MESSAGE,{data:t});var n=t.messageType?t.messageType:"license-request",r=t.message,i=t.sessionToken,a=b(R),o=R?R.systemString:null,s=y.getLicenseServer(R,a,n),u={sessionToken:i,messageType:n};if(r&&0!==r.byteLength){if(!s)return I.debug("DRM: License server request not required for this message (type = "+e.data.messageType+").  Session ID = "+i.getSessionID()),void D(u);if(y.isClearKey(R)){var l=y.processClearKeyLicenseRequest(R,a,r);if(l)return I.debug("DRM: ClearKey license request handled by application!"),D(u),void T.updateKeySession(i,l)}var d,f,c,h,p,g,_,E,m,v=null;a&&a.serverURL?"string"==typeof(d=a.serverURL)&&""!==d?v=d:"object"==typeof d&&d.hasOwnProperty(n)&&(v=d[n]):v=a&&a.laURL&&""!==a.laURL?a.laURL:(v=R.getLicenseServerURLFromInitData(N.default.getPSSHData(i.initData)))||e.data.laURL,(v=s.getServerURLFromMessage(v,r,n))?(c=!(f={}),h=function(e){if(e)for(var t in e)"authorization"===t.toLowerCase()&&(c=!0),f[t]=e[t];},a&&h(a.httpRequestHeaders),h(R.getRequestHeadersFromMessage(r)),a&&"boolean"==typeof a.withCredentials&&(c=a.withCredentials),p=function(e,t,n,r){var i=e.response?s.getErrorResponse(e.response,n,r):"NONE";D(t,new P.default(w.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,w.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+n+' update, XHR complete. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState+".  Response is "+i));},g=R.getLicenseRequestFromMessage(r),_=s.getHTTPMethod(n),E=s.getResponseType(o,n),m=a&&!isNaN(a.httpTimeout)?a.httpTimeout:8e3,function e(t,n,r,i,a,o,s,u,l,d,f){var c=new XMLHttpRequest;c.open(r,t,!0);c.responseType=i;c.withCredentials=a;0<u&&(c.timeout=u);for(var h in n)c.setRequestHeader(h,n[h]);var p=function(){s--,setTimeout(function(){e(t,n,r,i,a,o,s,u,l,d,f);},1e3);};c.onload=function(){200===this.status||s<=0?l(this):(I.warn("License request failed ("+this.status+"). Retrying it... Pending retries: "+s),p());};c.ontimeout=c.onerror=function(){s<=0?f(this):(I.warn("License request network request failed . Retrying it... Pending retries: "+s),p());};c.onabort=function(){d(this);};c.send(o);}(v,f,_,E,c,g,3,m,function(e){var t;T&&(200===e.status&&null!==(t=s.getLicenseMessage(e.response,o,n))?(D(u),T.updateKeySession(i,t)):p(e,u,o,n));},function(e){D(u,new P.default(w.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,w.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+o+' update, XHR aborted. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState));},function(e){D(u,new P.default(w.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,w.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+o+' update, XHR error. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState));})):D(u,new P.default(w.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE,w.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE));}else D(u,new P.default(w.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE,w.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE));}function M(e,t){if(I.debug("DRM: onNeedKey"),"cenc"===e.key.initDataType)if(0===c.length&&(I.warn("DRM: onNeedKey called before initializeForMedia, wait until initialized"),(t=void 0===t?1:t+1)<5))s.push(setTimeout(function(){M(e,t);},500));else {var n=e.key.initData;if(ArrayBuffer.isView(n)&&(n=n.buffer),R){var r=N.default.getPSSHForKeySystem(R,n);if(r)for(var i=T.getAllInitData(),a=0;a<i.length;a++)if(y.initDataEquals(r,i[a]))return void I.warn("DRM: Ignoring initData because we have already seen it!")}I.debug("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(n)));var o=y.getSupportedKeySystems(n,h);0!==o.length?u(o,!1):I.debug("DRM: Received needkey event with initData, but we don't support any of the key systems!");}else I.warn("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+e.key.initDataType);}return t={initializeForMedia:function(e){if(!e)throw new Error("mediaInfo can not be null or undefined");i(),S.on(A.INTERNAL_KEY_MESSAGE,v,this),S.on(A.INTERNAL_KEY_STATUS_CHANGED,o,this),c.push(e);var t=y.getSupportedKeySystemsFromContentProtection(e.contentProtection);t&&0<t.length&&u(t,!0);},createKeySession:g,loadKeySession:_,removeKeySession:function(e){i(),T.removeKeySession(e);},closeKeySession:function(e){i(),T.closeKeySession(e);},setServerCertificate:function(e){i(),T.setServerCertificate(e);},setMediaElement:a,setSessionType:function(e){r=e;},setRobustnessLevel:function(e){p=e;},setProtectionData:function(e){h=e,y.setProtectionData(e);},getSupportedKeySystemsFromContentProtection:function(e){return i(),y.getSupportedKeySystemsFromContentProtection(e)},getKeySystems:function(){return y?y.getKeySystems():[]},setKeySystems:function(e){y&&y.setKeySystems(e);},stop:function(){T&&T.stop();},reset:function(){i(),S.off(A.INTERNAL_KEY_MESSAGE,v,this),S.off(A.INTERNAL_KEY_STATUS_CHANGED,o,this),a(null),R=void 0,T&&(T.reset(),T=null),s.forEach(function(e){return clearTimeout(e)}),s=[],c=[];}},I=n.getLogger(t),f=[],c=[],r="temporary",p="",t}i.__dashjs_factory_name="ProtectionController",n.default=dashjs.FactoryMaker.getClassFactory(i),t.exports=n.default;},{160:160,169:169,181:181,182:182,225:225}],164:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var l=r(e(160)),d=r(e(165)),f=r(e(167)),c=r(e(168)),h=r(e(166)),p=r(e(174)),g=r(e(175)),_=r(e(176)),E=r(e(173)),m=r(e(110));function i(){var i=this.context,t=void 0,n=void 0,r=void 0,u=void 0,a=void 0,o=void 0,s=void 0;return t={initialize:function(){u=[];var e=void 0,e=(0, h.default)(i).getInstance({BASE64:a});u.push(e),e=(0, c.default)(i).getInstance({BASE64:a}),u.push(e),e=(0, d.default)(i).getInstance({BASE64:a}),u.push(e),o=e,e=(0, f.default)(i).getInstance({BASE64:a,debug:n}),u.push(e),s=e;},setProtectionData:function(e){for(var t,n,r=0;r<u.length;r++){var i=u[r];i.hasOwnProperty("init")&&i.init((t=i.systemString,n=void 0,n=null,e&&(n=t in e?e[t]:null),n));}},isClearKey:function(e){return e===o||e===s},initDataEquals:function(e,t){if(e.byteLength!==t.byteLength)return !1;for(var n=new Uint8Array(e),r=new Uint8Array(t),i=0;i<n.length;i++)if(n[i]!==r[i])return !1;return !0},getKeySystems:function(){return u},setKeySystems:function(e){u=e;},getKeySystemBySystemString:function(e){for(var t=0;t<u.length;t++)if(u[t].systemString===e)return u[t];return null},getSupportedKeySystemsFromContentProtection:function(e){var t,n=void 0,r=void 0,i=void 0,a=void 0,o=[];if(e)for(i=0;i<u.length;++i)for(r=u[i],a=0;a<e.length;++a){(n=e[a]).schemeIdUri.toLowerCase()===r.schemeIdURI&&(t=r.getInitData(n),o.push({ks:u[i],initData:t,cdmData:r.getCDMData(),sessionId:r.getSessionId(n)}));}return o},getSupportedKeySystems:function(e,t){for(var n=[],r=l.default.parsePSSHList(e),i=void 0,a=void 0,o=void 0,s=0;s<u.length;++s)a=(i=u[s]).systemString,o=!t||a in t,i.uuid in r&&o&&n.push({ks:i,initData:r[i.uuid],cdmData:i.getCDMData(),sessionId:i.getSessionId()});return n},getLicenseServer:function(e,t,n){if("license-release"===n||"individualization-request"===n)return null;var r=null;return t&&t.hasOwnProperty("drmtoday")?r=(0, p.default)(i).getInstance({BASE64:a}):e.systemString===m.default.WIDEVINE_KEYSTEM_STRING?r=(0, _.default)(i).getInstance():e.systemString===m.default.PLAYREADY_KEYSTEM_STRING?r=(0, g.default)(i).getInstance():e.systemString===m.default.CLEARKEY_KEYSTEM_STRING&&(r=(0, E.default)(i).getInstance()),r},processClearKeyLicenseRequest:function(e,t,n){try{return e.getClearKeysFromProtectionData(t,n)}catch(e){return r.error("Failed to retrieve clearkeys from ProtectionData"),null}},setConfig:function(e){e&&(e.debug&&(n=e.debug,r=n.getLogger(t)),e.BASE64&&(a=e.BASE64));}}}i.__dashjs_factory_name="ProtectionKeyController",n.default=dashjs.FactoryMaker.getSingletonFactory(i),t.exports=n.default;},{110:110,160:160,165:165,166:166,167:167,168:168,173:173,174:174,175:175,176:176}],165:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var u=r(e(179)),l=r(e(177)),i=r(e(160)),a=r(e(110)),o="e2719d58-a985-b3c9-781a-b030af78d30e",s=a.default.CLEARKEY_KEYSTEM_STRING;function d(e){var t=(e=e||{}).BASE64;return {uuid:o,schemeIdURI:"urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e",systemString:s,getInitData:function(e){return i.default.parseInitDataFromContentProtection(e,t)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(){return null},getClearKeysFromProtectionData:function(e,t){var n=null;if(e){for(var r=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),i=[],a=0;a<r.kids.length;a++){var o=r.kids[a],s=e.clearkeys&&e.clearkeys.hasOwnProperty(o)?e.clearkeys[o]:null;if(!s)throw new Error("DRM: ClearKey keyID ("+o+") is not known!");i.push(new u.default(o,s));}n=new l.default(i);}return n}}}d.__dashjs_factory_name="KeySystemClearKey",n.default=dashjs.FactoryMaker.getSingletonFactory(d),t.exports=n.default;},{110:110,160:160,177:177,179:179}],166:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var c=r(e(160)),i=r(e(110)),a="9a04f079-9840-4286-ab92-e65be0885f95",o=i.default.PLAYREADY_KEYSTEM_STRING,s=void 0;function u(e){var l="utf-16",d=(e=e||{}).BASE64;function f(){if(!d||!d.hasOwnProperty("decodeArray")||!d.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}return {uuid:a,schemeIdURI:"urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95",systemString:o,getInitData:function(e){var t,n,r,i=new Uint8Array([112,115,115,104,0,0,0,0]),a=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),o=0,s=null,u=void 0,l=void 0;if(f(),!e)return null;if("pssh"in e)return c.default.parseInitDataFromContentProtection(e,d);if("pro"in e)s=d.decodeArray(e.pro.__text);else {if(!("prheader"in e))return null;s=d.decodeArray(e.prheader.__text);}return t=s.length,n=4+i.length+a.length+4+t,r=new ArrayBuffer(n),u=new Uint8Array(r),(l=new DataView(r)).setUint32(o,n),o+=4,u.set(i,o),o+=i.length,u.set(a,o),o+=a.length,l.setUint32(o,t),o+=4,u.set(s,o),o+=t,u.buffer},getRequestHeadersFromMessage:function(e){for(var t=void 0,n={},r=new DOMParser,i=new("utf-16"===l?Uint16Array:Uint8Array)(e),a=String.fromCharCode.apply(null,i),o=(t=r.parseFromString(a,"application/xml")).getElementsByTagName("name"),s=t.getElementsByTagName("value"),u=0;u<o.length;u++)n[o[u].childNodes[0].nodeValue]=s[u].childNodes[0].nodeValue;return n.hasOwnProperty("Content")&&(n["Content-Type"]=n.Content,delete n.Content),n.hasOwnProperty("Content-Type")||(n["Content-Type"]="text/xml; charset=utf-8"),n},getLicenseRequestFromMessage:function(e){var t=null,n=new DOMParser,r=new("utf-16"===l?Uint16Array:Uint8Array)(e);f();var i=String.fromCharCode.apply(null,r),a=n.parseFromString(i,"application/xml");if(!a.getElementsByTagName("PlayReadyKeyMessage")[0])return e;var o=a.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;return o&&(t=d.decode(o)),t},getLicenseServerURLFromInitData:function(e){if(e)for(var t=new DataView(e),n=t.getUint16(4,!0),r=6,i=new DOMParser,a=0;a<n;a++){var o=t.getUint16(r,!0);r+=2;var s=t.getUint16(r,!0);if(r+=2,1===o){var u=e.slice(r,r+s),l=String.fromCharCode.apply(null,new Uint16Array(u)),d=i.parseFromString(l,"application/xml");if(d.getElementsByTagName("LA_URL")[0]){var f=d.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(f)return f}if(d.getElementsByTagName("LUI_URL")[0]){var c=d.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(c)return c}}else r+=s;}return null},getCDMData:function(){var e=void 0,t=void 0,n=void 0,r=void 0;if(f(),s&&s.cdmData){for(e=[],r=0;r<s.cdmData.length;++r)e.push(s.cdmData.charCodeAt(r)),e.push(0);for(e=String.fromCharCode.apply(null,e),e=d.encode(e),t='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>'.replace("%CUSTOMDATA%",e),n=[],r=0;r<t.length;++r)n.push(t.charCodeAt(r)),n.push(0);return new Uint8Array(n).buffer}return null},getSessionId:function(e){return s&&s.sessionId?s.sessionId:e&&e.sessionId?e.sessionId:null},setPlayReadyMessageFormat:function(e){if("utf-8"!==e&&"utf-16"!==e)throw new Error('Specified message format is not one of "utf-8" or "utf-16"');l=e;},init:function(e){e&&(s=e);}}}u.__dashjs_factory_name="KeySystemPlayReady",n.default=dashjs.FactoryMaker.getSingletonFactory(u),t.exports=n.default;},{110:110,160:160}],167:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var l=r(e(179)),d=r(e(177)),i=r(e(160)),a=r(e(110)),o="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",s=a.default.CLEARKEY_KEYSTEM_STRING;function u(e){var t=void 0,n=e.BASE64,u=e.debug.getLogger(t);return t={uuid:o,schemeIdURI:"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",systemString:s,getInitData:function(e){return i.default.parseInitDataFromContentProtection(e,n)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(){return null},getClearKeysFromProtectionData:function(e,t){var n=null;if(e){for(var r=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),i=[],a=0;a<r.kids.length;a++){var o=r.kids[a],s=e.clearkeys&&e.clearkeys.hasOwnProperty(o)?e.clearkeys[o]:null;if(!s)throw new Error("DRM: ClearKey keyID ("+o+") is not known!");i.push(new l.default(o,s));}n=new d.default(i),u.warn("ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4");}return n}}}u.__dashjs_factory_name="KeySystemW3CClearKey",n.default=dashjs.FactoryMaker.getSingletonFactory(u),t.exports=n.default;},{110:110,160:160,177:177,179:179}],168:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(160)),a=r(e(110)),o="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",s=a.default.WIDEVINE_KEYSTEM_STRING;function u(e){var t=null,n=(e=e||{}).BASE64;return {uuid:o,schemeIdURI:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",systemString:s,init:function(e){e&&(t=e);},getInitData:function(e){return i.default.parseInitDataFromContentProtection(e,n)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(e){return t&&t.sessionId?t.sessionId:e&&e.sessionId?e.sessionId:null}}}u.__dashjs_factory_name="KeySystemWidevine",n.default=dashjs.FactoryMaker.getSingletonFactory(u),t.exports=n.default;},{110:110,160:160}],169:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n,r=!1;null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0;}};var i,a=e(52);function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r(Object.getPrototypeOf(o.prototype),"constructor",this).call(this),this.MEDIA_KEYERR_CODE=100,this.MEDIA_KEYERR_UNKNOWN_CODE=101,this.MEDIA_KEYERR_CLIENT_CODE=102,this.MEDIA_KEYERR_SERVICE_CODE=103,this.MEDIA_KEYERR_OUTPUT_CODE=104,this.MEDIA_KEYERR_HARDWARECHANGE_CODE=105,this.MEDIA_KEYERR_DOMAIN_CODE=106,this.MEDIA_KEY_MESSAGE_ERROR_CODE=107,this.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE=108,this.SERVER_CERTIFICATE_UPDATED_ERROR_CODE=109,this.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE=110,this.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE=111,this.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE=112,this.KEY_SESSION_CREATED_ERROR_CODE=113,this.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE=114,this.MEDIA_KEYERR_UNKNOWN_MESSAGE="An unspecified error occurred. This value is used for errors that don't match any of the other codes.",this.MEDIA_KEYERR_CLIENT_MESSAGE="The Key System could not be installed or updated.",this.MEDIA_KEYERR_SERVICE_MESSAGE="The message passed into update indicated an error from the license service.",this.MEDIA_KEYERR_OUTPUT_MESSAGE="There is no available output device with the required characteristics for the content protection system.",this.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE="A hardware configuration change caused a content protection error.",this.MEDIA_KEYERR_DOMAIN_MESSAGE="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.",this.MEDIA_KEY_MESSAGE_ERROR_MESSAGE="Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!",this.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE="DRM: Empty key message from CDM",this.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE="Error updating server certificate -- ",this.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE="DRM: KeyStatusChange error! -- License has expired",this.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE="DRM: No license server URL specified!",this.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE="DRM: KeySystem Access Denied! -- ",this.KEY_SESSION_CREATED_ERROR_MESSAGE="DRM: unable to create session! --",this.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE="DRM: licenser error! --";}var s=new(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);}(o,((i=a)&&i.__esModule?i:{default:i}).default),o);n.default=s,t.exports=n.default;},{52:52}],170:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var y=r(e(164)),T=r(e(183)),S=r(e(225)),A=r(e(178)),I=r(e(181)),R=r(e(180)),b=r(e(169));function i(e){e=e||{};var t=this.context,h=e.eventBus,p=e.events,n=e.debug,o=e.api,s=e.errHandler,r=void 0,u=void 0,g=void 0,i=void 0,_=void 0,l=void 0,d=void 0,f=void 0,a=void 0;function c(){g&&v();for(var e=0;e<d.length;e++)E(d[e]);h.trigger(p.TEARDOWN_COMPLETE);}function E(t){try{g[o.cancelKeyRequest](i.systemString,t.sessionID);}catch(e){h.trigger(p.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+t.sessionID+") "+e.message});}}function m(e,t){if(t&&e){for(var n=e.length,r=0;r<n;r++)if(e[r].sessionID==t)return e[r];return null}return null}function v(){g.removeEventListener(o.keyerror,a),g.removeEventListener(o.needkey,a),g.removeEventListener(o.keymessage,a),g.removeEventListener(o.keyadded,a);}return r={getAllInitData:function(){for(var e=[],t=0;t<l.length;t++)e.push(l[t].initData);for(t=0;t<d.length;t++)e.push(d[t].initData);return e},requestKeySystemAccess:function(e){for(var t=(t=g)||document.createElement("video"),n=!1,r=0;r<e.length;r++)for(var i=e[r].ks.systemString,a=e[r].configs,o=null,s=null,u=0;u<a.length;u++){var l=a[u].videoCapabilities;if(l&&0!==l.length){s=[];for(var d=0;d<l.length;d++)""!==t.canPlayType(l[d].contentType,i)&&s.push(l[d]);}if(s&&(!s||0!==s.length)){n=!0;var f=new I.default(o,s),c=_.getKeySystemBySystemString(i);h.trigger(p.KEY_SYSTEM_ACCESS_COMPLETE,{data:new R.default(c,f)});break}}n||h.trigger(p.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"});},getKeySystem:function(){return i},selectKeySystem:function(e){i=e.keySystem,h.trigger(p.INTERNAL_KEY_SYSTEM_SELECTED);},setMediaElement:function(e){if(g!==e){if(g){v();for(var t=0;t<d.length;t++)E(d[t]);d=[];}(g=e)&&(g.addEventListener(o.keyerror,a),g.addEventListener(o.needkey,a),g.addEventListener(o.keymessage,a),g.addEventListener(o.keyadded,a),h.trigger(p.VIDEO_ELEMENT_SELECTED));}},createKeySession:function(e){if(!i)throw new Error("Can not create sessions until you have selected a key system");if(f||0===d.length){var t={sessionID:null,initData:e,getSessionID:function(){return this.sessionID},getExpirationTime:function(){return NaN},getSessionType:function(){return "temporary"}};return l.push(t),g[o.generateKeyRequest](i.systemString,new Uint8Array(e)),t}throw new Error("Multiple sessions not allowed!")},updateKeySession:function(e,t){var n=e.sessionID;if(_.isClearKey(i))for(var r=0;r<t.keyPairs.length;r++)g[o.addKey](i.systemString,t.keyPairs[r].key,t.keyPairs[r].keyID,n);else g[o.addKey](i.systemString,new Uint8Array(t),new Uint8Array(e.initData),n);},closeKeySession:E,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:c,reset:c},u=n.getLogger(r),l=[],d=[],_=(i=g=null,y.default)(t).getInstance(),a={handleEvent:function(e){var t,n=null;switch(e.type){case o.needkey:var r=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;h.trigger(p.NEED_KEY,{key:new T.default(r,"cenc")});break;case o.keyerror:if(n=(n=m(d,e.sessionId))||m(l,e.sessionId)){var i=b.default.MEDIA_KEYERR_CODE,a="";switch(e.errorCode.code){case 1:i=b.default.MEDIA_KEYERR_UNKNOWN_CODE,a+="MEDIA_KEYERR_UNKNOWN - "+b.default.MEDIA_KEYERR_UNKNOWN_MESSAGE;break;case 2:i=b.default.MEDIA_KEYERR_CLIENT_CODE,a+="MEDIA_KEYERR_CLIENT - "+b.default.MEDIA_KEYERR_CLIENT_MESSAGE;break;case 3:i=b.default.MEDIA_KEYERR_SERVICE_CODE,a+="MEDIA_KEYERR_SERVICE - "+b.default.MEDIA_KEYERR_SERVICE_MESSAGE;break;case 4:i=b.default.MEDIA_KEYERR_OUTPUT_CODE,a+="MEDIA_KEYERR_OUTPUT - "+b.default.MEDIA_KEYERR_OUTPUT_MESSAGE;break;case 5:i=b.default.MEDIA_KEYERR_HARDWARECHANGE_CODE,a+="MEDIA_KEYERR_HARDWARECHANGE - "+b.default.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE;break;case 6:i=b.default.MEDIA_KEYERR_DOMAIN_CODE,a+="MEDIA_KEYERR_DOMAIN - "+b.default.MEDIA_KEYERR_DOMAIN_MESSAGE;}a+="  System Code = "+e.systemCode,h.trigger(p.KEY_ERROR,{data:new S.default(i,a,n)});}else u.error("No session token found for key error");break;case o.keyadded:(n=(n=m(d,e.sessionId))||m(l,e.sessionId))?(u.debug("DRM: Key added."),h.trigger(p.KEY_ADDED,{data:n})):u.debug("No session token found for key added");break;case o.keymessage:(f=null!==e.sessionId&&void 0!==e.sessionId)?!(n=m(d,e.sessionId))&&0<l.length&&(n=l.shift(),d.push(n),n.sessionID=e.sessionId,h.trigger(p.KEY_SESSION_CREATED,{data:n})):0<l.length&&(n=l.shift(),d.push(n),0!==l.length&&s.error(new S.default(b.default.MEDIA_KEY_MESSAGE_ERROR_CODE,b.default.MEDIA_KEY_MESSAGE_ERROR_MESSAGE))),n?(t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message,n.keyMessage=t,h.trigger(p.INTERNAL_KEY_MESSAGE,{data:new A.default(n,t,e.defaultURL)})):u.warn("No session token found for key message");}}},r}i.__dashjs_factory_name="ProtectionModel_01b",n.default=dashjs.FactoryMaker.getClassFactory(i),t.exports=n.default;},{164:164,169:169,178:178,180:180,181:181,183:183,225:225}],171:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var E=r(e(164)),m=r(e(183)),v=r(e(169)),y=r(e(225)),T=r(e(178)),S=r(e(180)),A=r(e(110));function i(e){e=e||{};var t=this.context,o=e.eventBus,s=e.events,n=e.debug,r=void 0,u=void 0,l=void 0,i=void 0,d=void 0,f=void 0,a=void 0,c=void 0;function h(e){var t=e.session;return t.removeEventListener("keystatuseschange",e),t.removeEventListener("message",e),t.close()}function p(e){for(var t=0;t<f.length;t++)if(f[t]===e){f.splice(t,1);break}}function g(e){var t=void 0,n=void 0;return e&&0<e.length&&(e[0]&&("string"==typeof e[0]?t=e[0]:n=e[0]),e[1]&&("string"==typeof e[1]?t=e[1]:n=e[1])),{status:t,keyId:n}}function _(t,e,n,r){var i={session:t,initData:e,sessionId:r,handleEvent:function(e){switch(e.type){case"keystatuseschange":o.trigger(s.KEY_STATUSES_CHANGED,{data:this}),e.target.keyStatuses.forEach(function(){var e=g(arguments);switch(e.status){case"expired":o.trigger(s.INTERNAL_KEY_STATUS_CHANGED,{error:new y.default(v.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE,v.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE)});break;default:o.trigger(s.INTERNAL_KEY_STATUS_CHANGED,e);}});break;case"message":var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;o.trigger(s.INTERNAL_KEY_MESSAGE,{data:new T.default(this,t,void 0,e.messageType)});}},getSessionID:function(){return t.sessionId},getExpirationTime:function(){return t.expiration},getKeyStatuses:function(){return t.keyStatuses},getUsable:function(){var e=!1;return t.keyStatuses.forEach(function(){"usable"===g(arguments).status&&(e=!0);}),e},getSessionType:function(){return n}};return t.addEventListener("keystatuseschange",i),t.addEventListener("message",i),t.closed.then(function(){p(i),u.debug("DRM: Session closed.  SessionID = "+i.getSessionID()),o.trigger(s.KEY_SESSION_CLOSED,{data:i.getSessionID()});}),f.push(i),i}return r={getAllInitData:function(){for(var e=[],t=0;t<f.length;t++)f[t].initData&&e.push(f[t].initData);return e},requestKeySystemAccess:function(e){!function i(a,e){if(void 0===navigator.requestMediaKeySystemAccess||"function"!=typeof navigator.requestMediaKeySystemAccess)return void o.trigger(s.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Insecure origins are not allowed"});!function(t){var r=a[t].ks,e=a[t].configs,n=r.systemString;n===A.default.PLAYREADY_KEYSTEM_STRING&&"required"===e[0].persistentState&&(n+=".recommendation"),navigator.requestMediaKeySystemAccess(n,e).then(function(e){var t="function"==typeof e.getConfiguration?e.getConfiguration():null,n=new S.default(r,t);n.mksa=e,o.trigger(s.KEY_SYSTEM_ACCESS_COMPLETE,{data:n});}).catch(function(e){++t<a.length?i(a,t):o.trigger(s.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! "+e.message});});}(e);}(e,0);},getKeySystem:function(){return l},selectKeySystem:function(t){t.mksa.createMediaKeys().then(function(e){l=t.keySystem,d=e,i?i.setMediaKeys(d).then(function(){o.trigger(s.INTERNAL_KEY_SYSTEM_SELECTED);}):o.trigger(s.INTERNAL_KEY_SYSTEM_SELECTED);}).catch(function(){o.trigger(s.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+t.keySystem.systemString+")! Could not create MediaKeys -- TODO"});});},setMediaElement:function(e){i!==e&&(i&&(i.removeEventListener("encrypted",a),i.setMediaKeys&&i.setMediaKeys(null)),(i=e)&&(i.addEventListener("encrypted",a),i.setMediaKeys&&d&&i.setMediaKeys(d)));},setServerCertificate:function(e){if(!l||!d)throw new Error("Can not set server certificate until you have selected a key system");d.setServerCertificate(e).then(function(){u.info("DRM: License server certificate successfully updated."),o.trigger(s.SERVER_CERTIFICATE_UPDATED);}).catch(function(e){o.trigger(s.SERVER_CERTIFICATE_UPDATED,{error:new y.default(v.default.SERVER_CERTIFICATE_UPDATED_ERROR_CODE,v.default.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE+e.name)});});},createKeySession:function(e,t,n){if(!l||!d)throw new Error("Can not create sessions until you have selected a key system");var r=d.createSession(n),i=_(r,e,n),a=this.getKeySystem().systemString===A.default.CLEARKEY_KEYSTEM_STRING&&t&&t.clearkeys?"keyids":"cenc";r.generateRequest(a,e).then(function(){u.debug("DRM: Session created.  SessionID = "+i.getSessionID()),o.trigger(s.KEY_SESSION_CREATED,{data:i});}).catch(function(e){p(i),o.trigger(s.KEY_SESSION_CREATED,{data:null,error:new y.default(v.default.KEY_SESSION_CREATED_ERROR_CODE,v.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Error generating key request -- "+e.name)});});},updateKeySession:function(t,e){var n=t.session;c.isClearKey(l)&&(e=e.toJWK()),n.update(e).catch(function(e){o.trigger(s.KEY_ERROR,{data:new y.default(v.default.MEDIA_KEYERR_CODE,"Error sending update() message! "+e.name,t)});});},loadKeySession:function(t,e,n){if(!l||!d)throw new Error("Can not load sessions until you have selected a key system");for(var r=0;r<f.length;r++)if(t===f[r].sessionId)return void u.warn("DRM: Ignoring session ID because we have already seen it!");var i=d.createSession(n),a=_(i,e,n,t);i.load(t).then(function(e){e?(u.debug("DRM: Session loaded.  SessionID = "+a.getSessionID()),o.trigger(s.KEY_SESSION_CREATED,{data:a})):(p(a),o.trigger(s.KEY_SESSION_CREATED,{data:null,error:new y.default(v.default.KEY_SESSION_CREATED_ERROR_CODE,v.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session! Invalid Session ID ("+t+")")}));}).catch(function(e){p(a),o.trigger(s.KEY_SESSION_CREATED,{data:null,error:new y.default(v.default.KEY_SESSION_CREATED_ERROR_CODE,v.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session ("+t+")! "+e.name)});});},removeKeySession:function(t){t.session.remove().then(function(){u.debug("DRM: Session removed.  SessionID = "+t.getSessionID()),o.trigger(s.KEY_SESSION_REMOVED,{data:t.getSessionID()});},function(e){o.trigger(s.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+t.getSessionID()+"). "+e.name});});},closeKeySession:function(t){h(t).catch(function(e){p(t),o.trigger(s.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+t.getSessionID()+") "+e.name});});},stop:function(){for(var e=void 0,t=0;t<f.length;t++)(e=f[t]).getUsable()||h(e).catch(function(){p(e);});},reset:function(){var n=f.length,r=void 0;0!==n?function(){for(var t=function(e){p(e),0===f.length&&(i?(i.removeEventListener("encrypted",a),i.setMediaKeys(null).then(function(){o.trigger(s.TEARDOWN_COMPLETE);})):o.trigger(s.TEARDOWN_COMPLETE));},e=0;e<n;e++)!function(e){r.session.closed.then(function(){t(e);}),h(r).catch(function(){t(e);});}(r=f[e]);}():o.trigger(s.TEARDOWN_COMPLETE);}},u=n.getLogger(r),f=[],c=(d=i=l=null,E.default)(t).getInstance(),a={handleEvent:function(e){switch(e.type){case"encrypted":var t;e.initData&&(t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData,o.trigger(s.NEED_KEY,{key:new m.default(t,e.initDataType)}));}}},r}i.__dashjs_factory_name="ProtectionModel_21Jan2015",n.default=dashjs.FactoryMaker.getClassFactory(i),t.exports=n.default;},{110:110,164:164,169:169,178:178,180:180,183:183,225:225}],172:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var m=r(e(164)),v=r(e(183)),y=r(e(225)),T=r(e(169)),S=r(e(178)),A=r(e(181)),I=r(e(180));function i(e){e=e||{};var t=this.context,p=e.eventBus,g=e.events,n=e.debug,_=e.api,r=void 0,u=void 0,i=void 0,l=void 0,d=void 0,f=void 0,c=void 0,a=void 0,E=void 0;function o(){try{for(var e=0;e<c.length;e++)s(c[e]);i&&i.removeEventListener(_.needkey,a),p.trigger(g.TEARDOWN_COMPLETE);}catch(e){p.trigger(g.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+e.message});}}function s(e){var t=e.session;t.removeEventListener(_.error,e),t.removeEventListener(_.message,e),t.removeEventListener(_.ready,e),t.removeEventListener(_.close,e);for(var n=0;n<c.length;n++)if(c[n]===e){c.splice(n,1);break}t[_.release]();}function h(){function e(){i.removeEventListener("loadedmetadata",t),i[_.setMediaKeys](d),p.trigger(g.VIDEO_ELEMENT_SELECTED);}var t=null;1<=i.readyState?e():(t=e.bind(this),i.addEventListener("loadedmetadata",t));}return r={getAllInitData:function(){for(var e=[],t=0;t<c.length;t++)e.push(c[t].initData);return e},requestKeySystemAccess:function(e){for(var t=!1,n=0;n<e.length;n++)for(var r=e[n].ks.systemString,i=e[n].configs,a=null,o=null,s=0;s<i.length;s++){var u=i[s].audioCapabilities,l=i[s].videoCapabilities;if(u&&0!==u.length){a=[];for(var d=0;d<u.length;d++)window[_.MediaKeys].isTypeSupported(r,u[d].contentType)&&a.push(u[d]);}if(l&&0!==l.length){o=[];for(var f=0;f<l.length;f++)window[_.MediaKeys].isTypeSupported(r,l[f].contentType)&&o.push(l[f]);}if(!(!a&&!o||a&&0===a.length||o&&0===o.length)){t=!0;var c=new A.default(a,o),h=E.getKeySystemBySystemString(r);p.trigger(g.KEY_SYSTEM_ACCESS_COMPLETE,{data:new I.default(h,c)});break}}t||p.trigger(g.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"});},getKeySystem:function(){return l},selectKeySystem:function(e){try{d=e.mediaKeys=new window[_.MediaKeys](e.keySystem.systemString),l=e.keySystem,f=e,i&&h(),p.trigger(g.INTERNAL_KEY_SYSTEM_SELECTED);}catch(e){p.trigger(g.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+l.systemString+")! Could not create MediaKeys -- TODO"});}},setMediaElement:function(e){i!==e&&(i&&i.removeEventListener(_.needkey,a),(i=e)&&(i.addEventListener(_.needkey,a),d&&h()));},createKeySession:function(e,t,n,r){if(!l||!d||!f)throw new Error("Can not create sessions until you have selected a key system");var i=null;if(f.ksConfiguration.videoCapabilities&&0<f.ksConfiguration.videoCapabilities.length&&(i=f.ksConfiguration.videoCapabilities[0]),null===i&&f.ksConfiguration.audioCapabilities&&0<f.ksConfiguration.audioCapabilities.length&&(i=f.ksConfiguration.audioCapabilities[0]),null===i)throw new Error("Can not create sessions for unknown content types.");var a=i.contentType,o=d.createSession(a,new Uint8Array(e),r?new Uint8Array(r):null),s={session:o,initData:e,getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return "temporary"},handleEvent:function(e){switch(e.type){case _.error:p.trigger(g.KEY_ERROR,{data:new y.default(T.default.MEDIA_KEYERR_CODE,"KeyError",this)});break;case _.message:var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;p.trigger(g.INTERNAL_KEY_MESSAGE,{data:new S.default(this,t,e.destinationURL)});break;case _.ready:u.debug("DRM: Key added."),p.trigger(g.KEY_ADDED);break;case _.close:u.debug("DRM: Session closed.  SessionID = "+this.getSessionID()),p.trigger(g.KEY_SESSION_CLOSED,{data:this.getSessionID()});}}};o.addEventListener(_.error,s),o.addEventListener(_.message,s),o.addEventListener(_.ready,s),o.addEventListener(_.close,s),c.push(s),u.debug("DRM: Session created.  SessionID = "+s.getSessionID()),p.trigger(g.KEY_SESSION_CREATED,{data:s});},updateKeySession:function(e,t){var n=e.session;E.isClearKey(l)?n.update(new Uint8Array(t.toJWK())):n.update(new Uint8Array(t));},closeKeySession:s,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:o,reset:o},u=n.getLogger(r),c=[],E=(f=d=l=i=null,m.default)(t).getInstance(),a={handleEvent:function(e){switch(e.type){case _.needkey:var t;e.initData&&(t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData,p.trigger(g.NEED_KEY,{key:new v.default(t,"cenc")}));}}},r}i.__dashjs_factory_name="ProtectionModel_3Feb2014",n.default=dashjs.FactoryMaker.getClassFactory(i),t.exports=n.default;},{164:164,169:169,178:178,180:180,181:181,183:183,225:225}],173:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var o=r(e(179)),s=r(e(177));function i(){return {getServerURLFromMessage:function(e,t){var n=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t)));e+="/?";for(var r=0;r<n.kids.length;r++)e+=n.kids[r]+"&";return e=e.substring(0,e.length-1)},getHTTPMethod:function(){return "GET"},getResponseType:function(){return "json"},getLicenseMessage:function(e){if(!e.hasOwnProperty("keys"))return null;for(var t=[],n=0;n<e.keys.length;n++){var r=e.keys[n],i=r.kid.replace(/=/g,""),a=r.k.replace(/=/g,"");t.push(new o.default(i,a));}return new s.default(t)},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}i.__dashjs_factory_name="ClearKey",n.default=dashjs.FactoryMaker.getSingletonFactory(i),t.exports=n.default;},{177:177,179:179}],174:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(110),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var n=(e=e||{}).BASE64,r={};r[a.default.WIDEVINE_KEYSTEM_STRING]={responseType:"json",getLicenseMessage:function(e){return n.decodeArray(e.license)},getErrorResponse:function(e){return e}},r[a.default.PLAYREADY_KEYSTEM_STRING]={responseType:"arraybuffer",getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}};return {getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return "POST"},getResponseType:function(e){return r[e].responseType},getLicenseMessage:function(e,t){return function(){if(!n||!n.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}(),r[t].getLicenseMessage(e)},getErrorResponse:function(e,t){return r[t].getErrorResponse(e)}}}o.__dashjs_factory_name="DRMToday",n.default=dashjs.FactoryMaker.getSingletonFactory(o),t.exports=n.default;},{110:110}],175:[function(e,t,n){function r(){var g="http://schemas.xmlsoap.org/soap/envelope/";function _(e){var t=String.fromCharCode.apply(null,new Uint8Array(e));return decodeURIComponent(escape(t))}return {getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return "POST"},getResponseType:function(){return "arraybuffer"},getLicenseMessage:function(e){return function(e){if(window.DOMParser){var t=_(e),n=(new window.DOMParser).parseFromString(t,"text/xml"),r=n?n.getElementsByTagNameNS(g,"Envelope")[0]:null,i=r?r.getElementsByTagNameNS(g,"Body")[0]:null;if(i?i.getElementsByTagNameNS(g,"Fault")[0]:null)return null}return e}.call(this,e)},getErrorResponse:function(e){return function(e){var t="",n="",r="",i=-1,a=-1;if(window.DOMParser){var o=_(e),s=(new window.DOMParser).parseFromString(o,"text/xml"),u=s?s.getElementsByTagNameNS(g,"Envelope")[0]:null,l=u?u.getElementsByTagNameNS(g,"Body")[0]:null,d=l?l.getElementsByTagNameNS(g,"Fault")[0]:null,f=d?d.getElementsByTagName("detail")[0]:null,c=f?f.getElementsByTagName("Exception")[0]:null,h=null;if(null===d)return o;t=(h=d.getElementsByTagName("faultstring")[0].firstChild)?h.nodeValue:null,null!==c&&(n=(h=c.getElementsByTagName("StatusCode")[0])?h.firstChild.nodeValue:null,i=(r=(h=c.getElementsByTagName("Message")[0])?h.firstChild.nodeValue:null)?r.lastIndexOf("[")+1:-1,a=r?r.indexOf("]"):-1,r=r?r.substring(i,a):"");}var p="code: "+n+", name: "+t;return r&&(p+=", message: "+r),p}.call(this,e)}}}Object.defineProperty(n,"__esModule",{value:!0}),r.__dashjs_factory_name="PlayReady",n.default=dashjs.FactoryMaker.getSingletonFactory(r),t.exports=n.default;},{}],176:[function(e,t,n){function r(){return {getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return "POST"},getResponseType:function(){return "arraybuffer"},getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}Object.defineProperty(n,"__esModule",{value:!0}),r.__dashjs_factory_name="Widevine",n.default=dashjs.FactoryMaker.getSingletonFactory(r),t.exports=n.default;},{}],177:[function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}Object.defineProperty(n,"__esModule",{value:!0});var i=(function(e,t,n){return t&&r(e.prototype,t),e}(a,[{key:"toJWK",value:function(){for(var e=void 0,t=this.keyPairs.length,n={keys:[]},e=0;e<t;e++){var r={kty:"oct",alg:"A128KW",kid:this.keyPairs[e].keyID,k:this.keyPairs[e].key};n.keys.push(r);}this.type&&(n.type=this.type);var i=JSON.stringify(n),a=i.length,o=new ArrayBuffer(a),s=new Uint8Array(o);for(e=0;e<a;e++)s[e]=i.charCodeAt(e);return o}}]),a);function a(e,t){if(!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),t&&"persistent"!==t&&"temporary"!==t)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=e,this.type=t;}n.default=i,t.exports=n.default;},{}],178:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sessionToken=t,this.message=n,this.defaultURL=r,this.messageType=i||"license-request";},t.exports=n.default;},{}],179:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keyID=t,this.key=n;},t.exports=n.default;},{}],180:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keySystem=t,this.ksConfiguration=n;},t.exports=n.default;},{}],181:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(t,n,r,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initDataTypes=["cenc"],t&&t.length&&(this.audioCapabilities=t),n&&n.length&&(this.videoCapabilities=n),this.distinctiveIdentifier=r,this.persistentState=i,this.sessionTypes=a;},t.exports=n.default;},{}],182:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.contentType=t,this.robustness=n;},t.exports=n.default;},{}],183:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initData=t,this.initDataType=n;},t.exports=n.default;},{}],184:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(47),a=(r=i)&&r.__esModule?r:{default:r};function o(){var o=[],s=0,u=0;return {push:function(e,t){var n=t&&t.droppedVideoFrames?t.droppedVideoFrames:0,r=t&&t.totalVideoFrames?t.totalVideoFrames:0,i=n-s;s=n;var a=r-u;u=r,isNaN(e)||(o[e]?(o[e].droppedVideoFrames+=i,o[e].totalVideoFrames+=a):o[e]={droppedVideoFrames:i,totalVideoFrames:a});},getFrameHistory:function(){return o},reset:function(e){o=[],s=e.droppedVideoFrames,u=e.totalVideoFrames;}}}o.__dashjs_factory_name="DroppedFramesHistory";var s=a.default.getClassFactory(o);n.default=s,t.exports=n.default;},{47:47}],185:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(47),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var t=(e=e||{}).abrController,n=e.switchHistory,r=e.droppedFramesHistory,i=e.currentRequest,a=e.useBufferOccupancyABR,o=e.streamProcessor?e.streamProcessor.getScheduleController():null,s=e.streamProcessor?e.streamProcessor.getRepresentationInfo():null;function u(){return s?s.mediaInfo:null}return {getMediaType:function(){var e=u();return e?e.type:null},getMediaInfo:u,getDroppedFramesHistory:function(){return r},getCurrentRequest:function(){return i},getSwitchHistory:function(){return n},getStreamInfo:function(){var e=u();return e?e.streamInfo:null},getScheduleController:function(){return o},getAbrController:function(){return t},getRepresentationInfo:function(){return s},useBufferOccupancyABR:function(){return a}}}o.__dashjs_factory_name="RulesContext",n.default=a.default.getClassFactory(o),t.exports=n.default;},{47:47}],186:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(47),a=(r=i)&&r.__esModule?r:{default:r},o={DEFAULT:.5,STRONG:1,WEAK:0};function s(e,t,n){var r;return {quality:void 0===e?-1:e,reason:void 0===t?null:t,priority:(r=n)!==o.DEFAULT&&r!==o.STRONG&&r!==o.WEAK?o.DEFAULT:r}}s.__dashjs_factory_name="SwitchRequest";var u=a.default.getClassFactory(s);u.NO_CHANGE=-1,u.PRIORITY=o,a.default.updateClassFactory(s.__dashjs_factory_name,u),n.default=u,t.exports=n.default;},{47:47}],187:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),u=r(e(186));function a(){var o=[],s=[];return {push:function(e){e.newValue===u.default.NO_CHANGE&&(e.newValue=e.oldValue),o[e.oldValue]||(o[e.oldValue]={noDrops:0,drops:0,dropSize:0});var t,n=e.newValue-e.oldValue,r=n<0?1:0,i=r?-n:0,a=r?0:1;o[e.oldValue].drops+=r,o[e.oldValue].dropSize+=i,o[e.oldValue].noDrops+=a,s.push({idx:e.oldValue,noDrop:a,drop:r,dropSize:i}),8<s.length&&(t=s.shift(),o[t.idx].drops-=t.drop,o[t.idx].dropSize-=t.dropSize,o[t.idx].noDrops-=t.noDrop);},getSwitchRequests:function(){return o},reset:function(){o=[],s=[];}}}a.__dashjs_factory_name="SwitchRequestHistory";var o=i.default.getClassFactory(a);n.default=o,t.exports=n.default;},{186:186,47:47}],188:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var y=r(e(108)),i=r(e(47));function a(e){var s=3,u=4,l=4,d=1.3,f=1.3,c=(e=e||{}).settings,h=void 0,p=void 0,g=void 0,_=void 0,E=void 0;function m(e,t,n,r){var i=Math.pow(.5,n/r.fast);e.fastEstimate=(1-i)*t+i*e.fastEstimate;var a=Math.pow(.5,n/r.slow);e.slowEstimate=(1-a)*t+a*e.slowEstimate,e.totalWeight+=n;}function n(e,t,n){return c.get().streaming.abr.movingAverageMethod!==y.default.MOVING_AVERAGE_SLIDING_WINDOW?function(e,t){var n=e?E.throughputHalfLife:E.latencyHalfLife,r=e?g[t]:_[t];if(!r||r.totalWeight<=0)return NaN;var i=r.fastEstimate/(1-Math.pow(.5,r.totalWeight/n.fast)),a=r.slowEstimate/(1-Math.pow(.5,r.totalWeight/n.slow));return e?Math.min(i,a):Math.max(i,a)}(e,t):(a=function(e,t,n){var r=void 0,i=void 0,i=e?(r=h[t],n?s:u):(r=p[t],l);if(r){if(i>=r.length)i=r.length;else if(e)for(var a=1;a<i;++a){var o=r[r.length-a]/r[r.length-a-1];if((f<=o||o<=1/d)&&(i+=1)===r.length)break}}else i=0;return i}(r=e,i=t,n),o=(r?h:p)[i],0!==a&&o&&0!==o.length?(o=o.slice(-a)).reduce(function(e,t){return e+t})/o.length:NaN);var r,i,a,o;}function r(e,t){return n(!0,e,t)}function v(e){h[e]=h[e]||[],p[e]=p[e]||[],g[e]=g[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0},_[e]=_[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0};}function t(){h={},p={},g={},_={};}var i={push:function(e,t,n){if(t.trace&&t.trace.length){var r,i,a,o=t.tresponse.getTime()-t.trequest.getTime()||1,s=t._tfinish.getTime()-t.tresponse.getTime()||1,u=t.trace.reduce(function(e,t){return e+t.b[0]},0),l=void 0,l=c.get().streaming.lowLatencyEnabled?t.trace.reduce(function(e,t){return e+t.d},0):n?s:o+s,d=Math.round(8*u/l);if(v(e),a=s,(i=e)===y.default.VIDEO?a<c.get().streaming.cacheLoadThresholds[y.default.VIDEO]:i===y.default.AUDIO&&a<c.get().streaming.cacheLoadThresholds[y.default.AUDIO]){if(0<h[e].length&&!h[e].hasCachedEntries)return;h[e].hasCachedEntries=!0;}else h[e]&&h[e].hasCachedEntries&&(delete h[r=e],delete p[r],delete g[r],delete _[r],v(r));h[e].push(d),20<h[e].length&&h[e].shift(),p[e].push(o),20<p[e].length&&p[e].shift(),m(g[e],d,.001*s,E.throughputHalfLife),m(_[e],o,1,E.latencyHalfLife);}},getAverageThroughput:r,getSafeAverageThroughput:function(e,t){var n=r(e,t);return isNaN(n)||(n*=c.get().streaming.abr.bandwidthSafetyFactor),n},getAverageLatency:function(e){return n(!1,e)},reset:t};return E={throughputHalfLife:{fast:3,slow:8},latencyHalfLife:{fast:1,slow:2}},t(),i}a.__dashjs_factory_name="ThroughputHistory",n.default=i.default.getClassFactory(a),t.exports=n.default;},{108:108,47:47}],189:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var l=r(e(195)),d=r(e(193)),f=r(e(190)),c=r(e(192)),h=r(e(194)),p=r(e(191)),i=r(e(47)),g=r(e(186)),_="qualitySwitchRules",E="abandonFragmentRules";function a(e){e=e||{};var s=this.context,t=e.mediaPlayerModel,n=e.dashMetrics,r=e.settings,i=void 0,a=void 0;function o(e){return e.filter(function(e){return e.quality>g.default.NO_CHANGE})}function u(e){var t,n={},r=void 0,i=void 0,a=void 0,o=void 0;if(0!==e.length){for(n[g.default.PRIORITY.STRONG]=g.default.NO_CHANGE,n[g.default.PRIORITY.WEAK]=g.default.NO_CHANGE,n[g.default.PRIORITY.DEFAULT]=g.default.NO_CHANGE,r=0,t=e.length;r<t;r+=1)(i=e[r]).quality!==g.default.NO_CHANGE&&(n[i.priority]=n[i.priority]>g.default.NO_CHANGE?Math.min(n[i.priority],i.quality):i.quality);return n[g.default.PRIORITY.WEAK]!==g.default.NO_CHANGE&&(a=n[g.default.PRIORITY.WEAK]),n[g.default.PRIORITY.DEFAULT]!==g.default.NO_CHANGE&&(a=n[g.default.PRIORITY.DEFAULT]),n[g.default.PRIORITY.STRONG]!==g.default.NO_CHANGE&&(a=n[g.default.PRIORITY.STRONG]),a!==g.default.NO_CHANGE&&(o=a),(0, g.default)(s).create(o)}}return {initialize:function(){i=[],a=[],r.get().streaming.abr.useDefaultABRRules&&(i.push((0, p.default)(s).create({dashMetrics:n,mediaPlayerModel:t,settings:r})),i.push((0, l.default)(s).create({dashMetrics:n})),i.push((0, d.default)(s).create({dashMetrics:n})),i.push((0, h.default)(s).create()),i.push((0, c.default)(s).create()),a.push((0, f.default)(s).create({dashMetrics:n,mediaPlayerModel:t,settings:r}))),t.getABRCustomRules().forEach(function(e){e.type===_&&i.push(e.rule(s).create()),e.type===E&&a.push(e.rule(s).create());});},reset:function(){[i,a].forEach(function(e){e&&e.length&&e.forEach(function(e){return e.reset&&e.reset()});}),i=[],a=[];},getMaxQuality:function(t){return u(o(i.map(function(e){return e.getMaxIndex(t)})))||(0, g.default)(s).create()},shouldAbandonFragment:function(t){return u(o(a.map(function(e){return e.shouldAbandon(t)})))||(0, g.default)(s).create()}}}a.__dashjs_factory_name="ABRRulesCollection";var o=i.default.getClassFactory(a);o.QUALITY_SWITCH_RULES=_,o.ABANDON_FRAGMENT_RULES=E,i.default.updateSingletonFactory(a.__dashjs_factory_name,o),n.default=o,t.exports=n.default;},{186:186,190:190,191:191,192:192,193:193,194:194,195:195,47:47}],190:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var R=r(e(186)),i=r(e(47)),a=r(e(45));function b(e){e=e||{};var E=this.context,m=e.mediaPlayerModel,v=e.dashMetrics,y=e.settings,t=void 0,T=void 0,S=void 0,A=void 0,I=void 0;function n(){S={},A={},I=[];}return t={shouldAbandon:function(e){var t=(0, R.default)(E).create(R.default.NO_CHANGE,{name:b.__dashjs_factory_name});if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getCurrentRequest")&&e.hasOwnProperty("getRepresentationInfo")&&e.hasOwnProperty("getAbrController")))return t;var n,r,i,a,o=e.getMediaInfo(),s=e.getMediaType(),u=e.getCurrentRequest();if(!isNaN(u.index)){if(i=s,a=u.index,S[i]=S[i]||{},S[i][a]=S[i][a]||{},m.getStableBufferTime()<v.getCurrentBufferLevel(s))return t;var l=S[s][u.index];if(null===l||null===u.firstByteDate||A.hasOwnProperty(l.id))return t;if(void 0===l.firstByteTime&&(I[s]=[],l.firstByteTime=u.firstByteDate.getTime(),l.segmentDuration=u.duration,l.bytesTotal=u.bytesTotal,l.id=u.index),l.bytesLoaded=u.bytesLoaded,l.elapsedTime=(new Date).getTime()-l.firstByteTime,0<l.bytesLoaded&&0<l.elapsedTime&&(n=s,r=Math.round(8*l.bytesLoaded/l.elapsedTime),I[n]=I[n]||[],I[n].push(r)),5<=I[s].length&&500<l.elapsedTime&&l.bytesLoaded<l.bytesTotal){var d,f,c,h,p,g,_=I[s].reduce(function(e,t){return e+t},0);if(l.measuredBandwidthInKbps=Math.round(_/I[s].length),l.estimatedTimeOfDownload=+(8*l.bytesTotal/l.measuredBandwidthInKbps/1e3).toFixed(2),l.estimatedTimeOfDownload<1.8*l.segmentDuration||0===e.getRepresentationInfo().quality)return t;A.hasOwnProperty(l.id)||(d=e.getAbrController(),f=l.bytesTotal-l.bytesLoaded,c=d.getBitrateList(o),h=d.getQualityForBitrate(o,l.measuredBandwidthInKbps*y.get().streaming.abr.bandwidthSafetyFactor),g=void 0!==(p=d.getMinAllowedIndexFor(s))?Math.max(p,h):h,l.bytesTotal*c[g].bitrate/c[d.getQualityFor(s)].bitrate<f&&(t.quality=g,t.reason.throughput=l.measuredBandwidthInKbps,t.reason.fragmentID=l.id,A[l.id]=l,T.debug("["+s+"] frag id",l.id," is asking to abandon and switch to quality to ",g," measured bandwidth was",l.measuredBandwidthInKbps),delete S[s][l.id]));}else l.bytesLoaded===l.bytesTotal&&delete S[s][l.id];}return t},reset:n},T=(0, a.default)(E).getInstance().getLogger(t),n(),t}b.__dashjs_factory_name="AbandonRequestsRule",n.default=i.default.getClassFactory(b),t.exports=n.default;},{186:186,45:45,47:47}],191:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var p=r(e(109)),x=r(e(186)),i=r(e(47)),g=e(241),_=r(e(46)),E=r(e(54)),m=r(e(45));function a(e){e=e||{};var b=this.context,D=e.dashMetrics,o=e.mediaPlayerModel,t=(0, _.default)(b).getInstance(),n=void 0,M=void 0,N=void 0;function s(e,t,r){var n=r.reduce(function(e,t,n){return t>r[e]?n:e},0);if(0===n)return null;var i=Math.max(e,10+2*t.length),a=(r[n]-1)/(i/10-1);return {gp:a,Vp:10/a}}function C(e){var t={},n=e.getMediaInfo().bitrateList.map(function(e){return e.bandwidth}),r=(r=n.map(function(e){return Math.log(e)})).map(function(e){return e-r[0]+1}),i=o.getStableBufferTime(),a=s(i,n,r);return a?(t.state=1,t.bitrates=n,t.utilities=r,t.stableBufferTime=i,t.Vp=a.Vp,t.gp=a.gp,t.lastQuality=0,O(t)):t.state=0,t}function O(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN;}function w(e,t){var n,r,i,a=o.getStableBufferTime();e.stableBufferTime!==a&&((n=s(a,e.bitrates,e.utilities)).Vp===e.Vp&&n.gp===e.gp||(i=(r=D.getCurrentBufferLevel(t))+e.placeholderBuffer,i-=10,i*=n.Vp/e.Vp,i+=10,e.stableBufferTime=a,e.Vp=n.Vp,e.gp=n.gp,e.placeholderBuffer=Math.max(0,i-r)));}function P(e,t){return e.Vp*(e.utilities[t]+e.gp)}function L(e,t){for(var n,r,i,a=e.bitrates[t],o=e.utilities[t],s=0,u=t-1;0<=u;--u){e.utilities[u]<e.utilities[t]&&(n=e.bitrates[u],r=e.utilities[u],i=e.Vp*(e.gp+(a*r-n*o)/(a-n)),s=Math.max(s,i));}return s}function r(){for(var e in N)N.hasOwnProperty(e)&&2===N[e].state&&(N[e].placeholderBuffer=0);}function i(){for(var e in N){var t;!N.hasOwnProperty(e)||0!==(t=N[e]).state&&(t.state=1,O(t));}}function a(){}function u(e){var t,n;e&&e.chunk&&e.chunk.mediaInfo&&((t=N[e.chunk.mediaInfo.type])&&0!==t.state&&(n=e.chunk.start,isNaN(t.mostAdvancedSegmentStart)||n>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=n,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=n,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,d(t,e.chunk.mediaInfo.type)));}function l(e){var t;e&&e.metric===p.default.HTTP_REQUEST&&e.value&&e.value.type===g.HTTPRequest.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length&&((t=N[e.mediaType])&&0!==t.state&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),d(t,e.mediaType)));}function d(e,t){var n,r,i;isNaN(e.lastSegmentStart)||isNaN(e.lastSegmentRequestTimeMs)||isNaN(e.placeholderBuffer)||(e.placeholderBuffer*=.99,isNaN(e.lastSegmentFinishTimeMs)||(n=D.getCurrentBufferLevel(t)+.001*(e.lastSegmentFinishTimeMs-e.lastSegmentRequestTimeMs),r=P(e,e.lastQuality),i=Math.max(0,r-n),e.placeholderBuffer=Math.min(i,e.placeholderBuffer)),e.lastSegmentWasReplacement&&!isNaN(e.lastSegmentDurationS)&&(e.placeholderBuffer+=e.lastSegmentDurationS),e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN);}function f(e){var t;!e||(t=N[e.mediaType])&&0!==t.state&&(t.abrQuality=e.newQuality);}function c(e){var t,n,r,i;!e||(t=N[e.mediaType])&&0!==t.state&&(n=D.getCurrentBufferLevel(e.mediaType),r=void 0,r=0<t.abrQuality?L(t,t.abrQuality):10,i=Math.max(0,r-n),t.placeholderBuffer=Math.min(t.placeholderBuffer,i));}function h(){N={};}return n={getMaxIndex:function(e){var t=(0, x.default)(b).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getScheduleController")&&e.hasOwnProperty("getStreamInfo")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("useBufferOccupancyABR")))return t;var n=e.getMediaInfo(),r=e.getMediaType(),i=e.getScheduleController(),a=e.getStreamInfo(),o=e.getAbrController(),s=o.getThroughputHistory(),u=a?a.id:null,l=a&&a.manifestInfo&&a.manifestInfo.isDynamic,d=e.useBufferOccupancyABR();if(t.reason=t.reason||{},!d)return t;i.setTimeToLoadDelay(0);var f,c,h,p=(c=(f=e).getMediaType(),(h=N[c])?0!==h.state&&w(h,c):(h=C(f),N[c]=h),h);if(0===p.state)return t;var g,_,E,m,v=D.getCurrentBufferLevel(r),y=s.getAverageThroughput(r,l),T=s.getSafeAverageThroughput(r,l),S=s.getAverageLatency(r),A=void 0;if(t.reason.state=p.state,t.reason.throughput=y,t.reason.latency=S,isNaN(y))return t;switch(p.state){case 1:A=o.getQualityForBitrate(n,T,S),t.quality=A,t.reason.throughput=T,p.placeholderBuffer=Math.max(0,L(p,A)-v),p.lastQuality=A,!isNaN(p.lastSegmentDurationS)&&v>=p.lastSegmentDurationS&&(p.state=2);break;case 2:g=p,_=r,m=Date.now(),isNaN(g.lastSegmentFinishTimeMs)?isNaN(g.lastCallTimeMs)||(E=.001*(m-g.lastCallTimeMs),g.placeholderBuffer+=Math.max(0,E)):(E=.001*(m-g.lastSegmentFinishTimeMs),g.placeholderBuffer+=Math.max(0,E)),g.lastCallTimeMs=m,g.lastSegmentStart=NaN,g.lastSegmentRequestTimeMs=NaN,g.lastSegmentFinishTimeMs=NaN,w(g,_),A=function(e,t){for(var n=e.bitrates.length,r=NaN,i=NaN,a=0;a<n;++a){var o=(e.Vp*(e.utilities[a]+e.gp)-t)/e.bitrates[a];(isNaN(i)||i<=o)&&(i=o,r=a);}return r}(p,v+p.placeholderBuffer);var I=o.getQualityForBitrate(n,T,S);A>p.lastQuality&&I<A&&(A=Math.max(I,p.lastQuality));var R=Math.max(0,v+p.placeholderBuffer-P(p,A));R<=p.placeholderBuffer?(p.placeholderBuffer-=R,R=0):(R-=p.placeholderBuffer,p.placeholderBuffer=0,A<o.getTopQualityIndexFor(r,u)?i.setTimeToLoadDelay(1e3*R):R=0),t.quality=A,t.reason.throughput=y,t.reason.latency=S,t.reason.bufferLevel=v,t.reason.placeholderBuffer=p.placeholderBuffer,t.reason.delay=R,p.lastQuality=A;break;default:M.debug("BOLA ABR rule invoked in bad state."),t.quality=o.getQualityForBitrate(n,T,S),t.reason.state=p.state,t.reason.throughput=T,t.reason.latency=S,p.state=1,O(p);}return t},reset:function(){h(),t.off(E.default.BUFFER_EMPTY,r,n),t.off(E.default.PLAYBACK_SEEKING,i,n),t.off(E.default.PERIOD_SWITCH_STARTED,a,n),t.off(E.default.MEDIA_FRAGMENT_LOADED,u,n),t.off(E.default.METRIC_ADDED,l,n),t.off(E.default.QUALITY_CHANGE_REQUESTED,f,n),t.off(E.default.FRAGMENT_LOADING_ABANDONED,c,n);}},M=(0, m.default)(b).getInstance().getLogger(n),h(),t.on(E.default.BUFFER_EMPTY,r,n),t.on(E.default.PLAYBACK_SEEKING,i,n),t.on(E.default.PERIOD_SWITCH_STARTED,a,n),t.on(E.default.MEDIA_FRAGMENT_LOADED,u,n),t.on(E.default.METRIC_ADDED,l,n),t.on(E.default.QUALITY_CHANGE_REQUESTED,f,n),t.on(E.default.FRAGMENT_LOADING_ABANDONED,c,n),n}a.__dashjs_factory_name="BolaRule",n.default=i.default.getClassFactory(a),t.exports=n.default;},{109:109,186:186,241:241,45:45,46:46,47:47,54:54}],192:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),d=r(e(186)),a=r(e(45));function o(){var u=this.context,e=void 0,l=void 0;return e={getMaxIndex:function(e){var t=(0, d.default)(u).create();if(!e||!e.hasOwnProperty("getDroppedFramesHistory"))return t;var n=e.getDroppedFramesHistory();if(n){for(var r=n.getFrameHistory(),i=0,a=0,o=d.default.NO_CHANGE,s=1;s<r.length;s++)if(r[s]&&(i=r[s].droppedVideoFrames,375<(a=r[s].totalVideoFrames)&&.15<i/a)){o=s-1,l.debug("index: "+o+" Dropped Frames: "+i+" Total Frames: "+a);break}return (0, d.default)(u).create(o,{droppedFrames:i})}return t}},l=(0, a.default)(u).getInstance().getLogger(e),e}o.__dashjs_factory_name="DroppedFramesRule",n.default=i.default.getClassFactory(o),t.exports=n.default;},{186:186,45:45,47:47}],193:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var s=r(e(46)),u=r(e(54)),i=r(e(47)),l=r(e(45)),E=r(e(186)),m=r(e(108)),v=r(e(109));function a(e){e=e||{};var c=.5,t=2,h=this.context,n=(0, s.default)(h).getInstance(),p=e.dashMetrics,r=void 0,g=void 0,_=void 0;function i(){(_={})[m.default.VIDEO]={ignoreCount:t},_[m.default.AUDIO]={ignoreCount:t};}function a(){i();}function o(e){isNaN(e.startTime)||e.mediaType!==m.default.AUDIO&&e.mediaType!==m.default.VIDEO||0<_[e.mediaType].ignoreCount&&_[e.mediaType].ignoreCount--;}return r={getMaxIndex:function(e){var t=(0, E.default)(h).create();if(!e||!e.hasOwnProperty("getMediaType"))return t;!function(){if(!p||!p.hasOwnProperty("getCurrentBufferLevel")||!p.hasOwnProperty("getCurrentBufferState"))throw new Error(m.default.MISSING_CONFIG_ERROR)}();var n,r,i,a,o,s,u,l=e.getMediaType(),d=p.getCurrentBufferState(l),f=e.getRepresentationInfo().fragmentDuration;return 0<_[l].ignoreCount||!f||(d&&d.state===v.default.BUFFER_EMPTY?(g.debug("["+l+"] Switch to index 0; buffer is empty."),t.quality=0,t.reason="InsufficientBufferRule: Buffer is empty"):(n=e.getMediaInfo(),i=(r=e.getAbrController()).getThroughputHistory(),a=p.getCurrentBufferLevel(l),o=i.getAverageThroughput(l),s=i.getAverageLatency(l),u=o*(a/f)*c,t.quality=r.getQualityForBitrate(n,u,s),t.reason="InsufficientBufferRule: being conservative to avoid immediate rebuffering")),t},reset:function(){i(),n.off(u.default.PLAYBACK_SEEKING,a,r),n.off(u.default.BYTES_APPENDED_END_FRAGMENT,o,r);}},g=(0, l.default)(h).getInstance().getLogger(r),i(),n.on(u.default.PLAYBACK_SEEKING,a,r),n.on(u.default.BYTES_APPENDED_END_FRAGMENT,o,r),r}a.__dashjs_factory_name="InsufficientBufferRule",n.default=i.default.getClassFactory(a),t.exports=n.default;},{108:108,109:109,186:186,45:45,46:46,47:47,54:54}],194:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),a=r(e(45)),d=r(e(186));function o(){var u=this.context,e=void 0,l=void 0;return e={getMaxIndex:function(e){for(var t=e?e.getSwitchHistory():null,n=t?t.getSwitchRequests():[],r=0,i=0,a=0,o=(0, d.default)(u).create(),s=0;s<n.length;s++)if(void 0!==n[s]&&(r+=n[s].drops,i+=n[s].noDrops,a+=n[s].dropSize,6<=r+i&&.075<r/i)){o.quality=0<s&&0<n[s].drops?s-1:s,o.reason={index:o.quality,drops:r,noDrops:i,dropSize:a},l.debug("Switch history rule index: "+o.quality+" samples: "+(r+i)+" drops: "+r);break}return o}},l=(0, a.default)(u).getInstance().getLogger(e),e}o.__dashjs_factory_name="SwitchHistoryRule",n.default=i.default.getClassFactory(o),t.exports=n.default;},{186:186,45:45,47:47}],195:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),a=r(e(45)),_=r(e(186)),E=r(e(108)),m=r(e(109));function o(e){e=e||{};var h=this.context,p=e.dashMetrics,t=void 0,g=void 0;return t={getMaxIndex:function(e){var t=(0, _.default)(h).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("useBufferOccupancyABR")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("getScheduleController")))return t;!function(){if(!p||!p.hasOwnProperty("getCurrentBufferState"))throw new Error(E.default.MISSING_CONFIG_ERROR)}();var n=e.getMediaInfo(),r=e.getMediaType(),i=p.getCurrentBufferState(r),a=e.getScheduleController(),o=e.getAbrController(),s=e.getStreamInfo(),u=s&&s.manifestInfo?s.manifestInfo.isDynamic:null,l=o.getThroughputHistory(),d=l.getSafeAverageThroughput(r,u),f=l.getAverageLatency(r),c=e.useBufferOccupancyABR();return isNaN(d)||!i||c||o.getAbandonmentStateFor(r)!==m.default.ABANDON_LOAD&&(i.state!==m.default.BUFFER_LOADED&&!u||(t.quality=o.getQualityForBitrate(n,d,f),a.setTimeToLoadDelay(0),g.debug("["+r+"] requesting switch to index: ",t.quality,"Average throughput",Math.round(d),"kbps"),t.reason={throughput:d,latency:f})),t},reset:function(){}},g=(0, a.default)(h).getInstance().getLogger(t),t}o.__dashjs_factory_name="ThroughputRule",n.default=i.default.getClassFactory(o),t.exports=n.default;},{108:108,109:109,186:186,45:45,47:47}],196:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var c=r(e(108)),i=r(e(47)),h=r(e(109));function a(e){var s=(e=e||{}).dashMetrics,u=e.mediaPlayerModel,l=e.textController,d=e.abrController,f=e.settings;function r(e,t,n){var r,i,a,o=NaN;return e&&t?o=e===c.default.FRAGMENTED_TEXT?l.isTextEnabled()?isNaN(t.fragmentDuration)?(r=s.getCurrentSchedulingInfo(h.default.SCHEDULING_INFO))?r.duration:0:t.fragmentDuration:0:e===c.default.AUDIO&&n?(i=s.getCurrentBufferLevel(c.default.VIDEO),isNaN(t.fragmentDuration)?i:Math.max(i,t.fragmentDuration)):(a=t.mediaInfo.streamInfo,d.isPlayingAtTopQuality(a)?a.manifestInfo.duration>=f.get().streaming.longFormContentDurationThreshold?f.get().streaming.bufferTimeAtTopQualityLongForm:f.get().streaming.bufferTimeAtTopQuality:u.getStableBufferTime()):o}return {execute:function(e,t,n){return !e||!t||s.getCurrentBufferLevel(e)<r(e,t,n)},getBufferTarget:r}}a.__dashjs_factory_name="BufferLevelRule",n.default=i.default.getClassFactory(a),t.exports=n.default;},{108:108,109:109,47:47}],197:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(47),a=(r=i)&&r.__esModule?r:{default:r};function o(){var G=0;function r(e){return "red"===e?"rgb(255, 0, 0)":"green"===e?"rgb(0, 255, 0)":"blue"===e?"rgb(0, 0, 255)":"cyan"===e?"rgb(0, 255, 255)":"magenta"===e?"rgb(255, 0, 255)":"yellow"===e?"rgb(255, 255, 0)":"white"===e?"rgb(255, 255, 255)":"black"===e?"rgb(0, 0, 0)":e}function j(e,t){var n=e.videoHeight/15;return t?"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(t.foreground?r(t.foreground):"rgb(255, 255, 255)")+"; font-style: "+(t.italics?"italic":"normal")+"; text-decoration: "+(t.underline?"underline":"none")+"; white-space: pre; background-color: "+(t.background?r(t.background):"transparent")+";":"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}return {createHTMLCaptionsFromScreen:function(e,t,n,r){for(var i=null,a=!1,o=-1,s={start:t,end:n,spans:[]},u="style_cea608_white_black",l={},d={},f=[],c=void 0,h=void 0,c=0;c<15;++c){var p=r.rows[c],g="",_=null;if(!1===p.isEmpty()){var E=function(e){for(var t="",n=0;n<e.length;++n){t+=e[n].uchar;}return t.length-t.replace(/^\s+/,"").length}(p.chars);null===i&&(i={x:E,y1:c,y2:c+1,p:[]}),E!==o&&a&&(i.p.push(s),s={start:t,end:n,spans:[]},i.y2=c,i.name="region_"+i.x+"_"+i.y1+"_"+i.y2,!1===l.hasOwnProperty(i.name)?(f.push(i),l[i.name]=i):l[i.name].p.contat(i.p),i={x:E,y1:c,y2:c+1,p:[]});for(var m=0;m<p.chars.length;++m){var v,y=p.chars[m],T=y.penState;null!==_&&T.equals(_)||(0<g.trim().length&&(s.spans.push({name:u,line:g,row:c}),g=""),v="style_cea608_"+T.foreground+"_"+T.background,T.underline&&(v+="_underline"),T.italics&&(v+="_italics"),d.hasOwnProperty(v)||(d[v]=JSON.parse(JSON.stringify(T))),_=T,u=v),g+=y.uchar;}0<g.trim().length&&s.spans.push({name:u,line:g,row:c}),a=!0,o=E;}else a=!1,o=-1,i&&(i.p.push(s),s={start:t,end:n,spans:[]},i.y2=c,i.name="region_"+i.x+"_"+i.y1+"_"+i.y2,!1===l.hasOwnProperty(i.name)?(f.push(i),l[i.name]=i):l[i.name].p.contat(i.p),i=null);}i&&(i.p.push(s),i.y2=c+1,i.name="region_"+i.x+"_"+i.y1+"_"+i.y2,!1===l.hasOwnProperty(i.name)?(f.push(i),l[i.name]=i):l[i.name].p.contat(i.p),i=null);var S,A=[];for(c=0;c<f.length;++c){var I=f[c],R="sub_cea608_"+G++,b=document.createElement("div");b.id=R;var D="left: "+3.125*(S=I).x+"%; top: "+6.66*S.y1+"%; width: "+(100-3.125*S.x)+"%; height: "+6.66*Math.max(S.y2-1-S.y1,1)+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;";b.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+D;var M=document.createElement("div");M.className="paragraph bodyStyle",M.style.cssText=j(e);var N=document.createElement("div");N.className="cueUniWrapper",N.style.cssText="unicode-bidi: normal; direction: ltr;";for(var C=0;C<I.p.length;++C)for(var O=I.p[C],w=0,h=0;h<O.spans.length;++h){var P,L,x,F,U=O.spans[h];0<U.line.length&&(0!==h&&w!=U.row&&((P=document.createElement("br")).className="lineBreak",N.appendChild(P)),L=!1,w===U.row&&(L=!0),w=U.row,x=d[U.name],(F=document.createElement("span")).className="spanPadding "+U.name+" customSpanColor",F.style.cssText=j(e,x),0!==h&&L?h===O.spans.length-1?F.textContent=U.line.replace(/\s+$/g,""):F.textContent=U.line:1<O.spans.length&&h<O.spans.length-1&&U.row===O.spans[h+1].row?F.textContent=U.line.replace(/^\s+/g,""):F.textContent=U.line.trim(),N.appendChild(F));}M.appendChild(N),b.appendChild(M);var k={bodyStyle:["%",90]};for(var B in d)d.hasOwnProperty(B)&&(k[B]=["%",90]);A.push({type:"html",start:t,end:n,cueHTMLElement:b,cueID:R,cellResolution:[32,15],isFromCEA608:!0,fontSize:k,lineHeight:{},linePadding:{}});}return A}}}o.__dashjs_factory_name="EmbeddedTextHtmlRender",n.default=a.default.getSingletonFactory(o),t.exports=n.default;},{47:47}],198:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var m=r(e(108)),v=r(e(46)),y=r(e(54)),i=r(e(47)),T=r(e(213)),S=r(e(104)),A=r(e(200)),I=r(e(225)),R=r(e(51)),b="NotFragmentedTextBufferController";function a(e){e=e||{};var r=this.context,t=(0, v.default)(r).getInstance(),i=(0, A.default)(r).getInstance(),a=e.errHandler,o=e.streamInfo,s=e.type,u=e.mimeType,l=e.fragmentModel,n=void 0,d=void 0,f=void 0,c=void 0,h=void 0,p=void 0;function g(e){c=e;}function _(e){e.sender.getStreamId()!==o.id||e.sender.getType()!==s||e.error||null===p.extract(o.id,e.currentRepresentation.id)&&(d=!1,t.trigger(y.default.INIT_FRAGMENT_NEEDED,{sender:n,streamId:o.id,mediaType:s,representationId:e.currentRepresentation.id}));}function E(e){e.chunk.streamId===o.id&&e.chunk.mediaInfo.type===s&&e.chunk.bytes&&(p.save(e.chunk),h.append(e.chunk),d=!0,t.trigger(y.default.STREAM_COMPLETED,{request:e.request}));}return n={getBufferControllerType:function(){return b},initialize:function(e){g(e),p=(0, T.default)(r).getInstance();},createBuffer:function(e){var t,n=e[0];try{return h=(0,S.default)(r).create(c,n),f||((t=h.getBuffer()).hasOwnProperty(m.default.INITIALIZE)&&t.initialize(u,o,e,l),f=!0),h}catch(e){if(n&&(n.isText||-1!==n.codec.indexOf('codecs="stpp')||-1!==n.codec.indexOf('codecs="wvtt')))try{h=i.getTextSourceBuffer();}catch(e){a.error(new I.default(R.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,R.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+s+" : "+e.message));}else a.error(new I.default(R.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,R.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+s));}},getType:function(){return s},getBuffer:function(){return h},getBufferLevel:function(){return 0},setMediaSource:g,getMediaSource:function(){return c},getIsBufferingCompleted:function(){return d},getIsPruningInProgress:function(){return !1},dischargePreBuffer:function(){},appendInitSegment:function(e){return null!==p.extract(o.id,e)},getRangeAt:function(){return null},reset:function(e){t.off(y.default.DATA_UPDATE_COMPLETED,_,n),t.off(y.default.INIT_FRAGMENT_LOADED,E,n),!e&&h&&(h.abort(),h.reset(),h=null);},updateTimestampOffset:function(e){h.timestampOffset===e||isNaN(e)||(h.timestampOffset=e);}},c=null,d=f=!1,t.on(y.default.DATA_UPDATE_COMPLETED,_,n),t.on(y.default.INIT_FRAGMENT_LOADED,E,n),n}a.__dashjs_factory_name=b,n.default=i.default.getClassFactory(a),t.exports=n.default;},{104:104,108:108,200:200,213:213,225:225,46:46,47:47,51:51,54:54}],199:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var a=r(e(108)),i=r(e(47)),o=r(e(114)),s=r(e(198));function u(e){e=e||{};var t,n=this.context,r=void 0;function i(){return r.getBuffer()}return t={getBufferControllerType:function(){return r.getBufferControllerType()},initialize:function(e,t){return r.initialize(e,t)},createBuffer:function(e){return r.createBuffer(e)},getType:function(){return r.getType()},getBuffer:i,setBuffer:function(e){r.setBuffer(e);},getBufferLevel:function(){return r.getBufferLevel()},setMediaSource:function(e){r.setMediaSource(e);},getMediaSource:function(){return r.getMediaSource()},getIsBufferingCompleted:function(){return r.getIsBufferingCompleted()},getIsPruningInProgress:function(){return r.getIsPruningInProgress()},dischargePreBuffer:function(){return r.dischargePreBuffer()},appendInitSegment:function(e){r.appendInitSegment(e);},getRangeAt:function(e){return r.getRangeAt(e)},reset:function(e){r.reset(e);},updateTimestampOffset:function(e){var t=i();t.timestampOffset===e||isNaN(e)||(t.timestampOffset=e);}},r=e.type===a.default.FRAGMENTED_TEXT?(0, o.default)(n).create({streamInfo:e.streamInfo,type:e.type,mediaPlayerModel:e.mediaPlayerModel,manifestModel:e.manifestModel,fragmentModel:e.fragmentModel,errHandler:e.errHandler,mediaController:e.mediaController,representationController:e.representationController,adapter:e.adapter,textController:e.textController,abrController:e.abrController,playbackController:e.playbackController,settings:e.settings}):(0, s.default)(n).create({streamInfo:e.streamInfo,type:e.type,mimeType:e.mimeType,fragmentModel:e.fragmentModel,errHandler:e.errHandler}),t}u.__dashjs_factory_name="TextBufferController",n.default=i.default.getClassFactory(u),t.exports=n.default;},{108:108,114:114,198:198,47:47}],200:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var N=r(e(108)),i=r(e(47)),C=r(e(201)),O=r(e(202)),w=r(e(221)),P=r(e(219)),L=r(e(46)),x=r(e(54)),F=e(218);function a(){var e=this.context,t=void 0,h=void 0,n=void 0,r=void 0,i=void 0,p=void 0,a=void 0,g=void 0,_=void 0,o=void 0,s=void 0,u=void 0,l=void 0,d=void 0,f=void 0,c=void 0,E=void 0,m=void 0,v=void 0,y=void 0,T=void 0;function S(e){void 0===T&&null!==e.fromStreamInfo&&(T=this.getCurrentTrackIdx());}function A(){void 0===T&&(T=this.getCurrentTrackIdx());}function I(){void 0!==T&&(this.setTextTrack(T),T=void 0);}function R(e){var n=this,t=e.tracks,r=e.index;l&&t.some(function(e,t){if(p.matchSettings(l,e))return n.setTextTrack(t),r=t,!0}),(!1===c||void 0===c&&!l||y)&&this.setTextTrack(-1),f=r,u.trigger(x.default.TEXT_TRACKS_ADDED,{enabled:D(),index:r,tracks:t}),v=!0;}function b(e){var t;d||!e||!e.newMediaInfo||(t=e.newMediaInfo).type===N.default.FRAGMENTED_TEXT&&(l={lang:t.lang,role:t.roles[0],accessibility:t.accessibility[0]});}function D(){return E&&!m?!1:!0}function M(){y=v=!(E=!0);}return t={setConfig:function(e){e&&(e.errHandler&&(n=e.errHandler),e.adapter&&(r=e.adapter),e.manifestModel&&(i=e.manifestModel),e.mediaController&&(p=e.mediaController),e.videoModel&&(a=e.videoModel),e.streamController&&(g=e.streamController),e.textTracks&&(_=e.textTracks),e.vttParser&&(o=e.vttParser),e.ttmlParser&&(s=e.ttmlParser),h.setConfig({errHandler:n,adapter:r,manifestModel:i,mediaController:p,videoModel:a,streamController:g,textTracks:_,vttParser:o,ttmlParser:s}));},getTextSourceBuffer:function(){return h},getAllTracksAreDisabled:function(){return E},addEmbeddedTrack:function(e){h.addEmbeddedTrack(e);},getTextDefaultLanguage:function(){return l&&l.lang||""},setTextDefaultLanguage:function(e){(0, F.checkParameterType)(e,"string"),(l=l||{}).lang=e,d=!0;},setTextDefaultEnabled:function(e){(0, F.checkParameterType)(e,"boolean"),(c=e)?E=!1:this.setTextTrack(-1);},getTextDefaultEnabled:function(){return void 0!==c&&c},setInitialSettings:function(e){l=e,d=!0;},enableText:function(e){(0, F.checkParameterType)(e,"boolean"),!c&&e&&(c=!0),D()!==e&&(e&&this.setTextTrack(f),e||(f=this.getCurrentTrackIdx(),v?this.setTextTrack(-1):y=!0));},isTextEnabled:D,setTextTrack:function(e){var t=h.getConfig(),n=t.fragmentModel,r=t.fragmentedTracks,i=t.videoModel,a=void 0,o=void 0;E=-1===e;var s=_.getCurrentTrackIdx();if(s!==e){E&&p&&p.saveTextSettingsDisabled(),_.setModeForTrackIdx(s,N.default.TEXT_HIDDEN),_.setCurrentTrackIdx(e),_.setModeForTrackIdx(e,N.default.TEXT_SHOWING);var u=_.getCurrentTrackInfo();if(u&&u.isFragmented&&!u.isEmbedded)for(var l=0;l<r.length;l++){var d=r[l];if(u.lang===d.lang&&u.index===d.index&&(d.id?u.id===d.id:u.id===d.index))if(d!==p.getCurrentTrackFor(N.default.FRAGMENTED_TEXT,g.getActiveStreamInfo()))n.abortRequests(),n.removeExecutedRequestsBeforeTime(),h.remove(),_.deleteCuesFromTrackIdx(s),p.setTrack(d),h.setCurrentFragmentedTrackIdx(l);else if(-1===s){for(var f=g.getActiveStreamProcessors(),c=0;c<f.length;c++)if(f[c].getType()===N.default.FRAGMENTED_TEXT){o=f[c];break}o.setIndexHandlerTime(i.getTime()),o.getScheduleController().start();}}else if(u&&!u.isFragmented){for(f=g.getActiveStreamProcessors(),l=0;l<f.length;l++)if(f[l].getType()===N.default.TEXT){a=(o=f[l]).getMediaInfoArr();break}if(o&&a)for(l=0;l<a.length;l++)if(a[l].index===u.index&&a[l].lang===u.lang){o.selectMediaInfo(a[l]);break}}}},getCurrentTrackIdx:function(){return _.getCurrentTrackIdx()},enableForcedTextStreaming:function(e){(0, F.checkParameterType)(e,"boolean"),m=e;},reset:function(){M(),h.resetEmbedded(),h.reset();}},l=null,_=(y=d=v=m=!(f=-1),O.default)(e).getInstance(),o=(0, w.default)(e).getInstance(),s=(0, P.default)(e).getInstance(),h=(0, C.default)(e).getInstance(),u=(0, L.default)(e).getInstance(),_.initialize(),u.on(x.default.TEXT_TRACKS_QUEUE_INITIALIZED,R,t),u.on(x.default.CURRENT_TRACK_CHANGED,b,t),u.on(x.default.PERIOD_SWITCH_STARTED,S,t),u.on(x.default.STREAM_COMPLETED,A,t),u.on(x.default.PERIOD_SWITCH_COMPLETED,I,t),M(),t}a.__dashjs_factory_name="TextController",n.default=i.default.getSingletonFactory(a),t.exports=n.default;},{108:108,201:201,202:202,218:218,219:219,221:221,46:46,47:47,54:54}],201:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var re=r(e(108)),ie=e(241),m=r(e(233)),v=r(e(206)),y=r(e(208)),i=r(e(47)),T=r(e(45)),S=r(e(202)),A=r(e(197)),ae=r(e(9)),oe=r(e(2)),I=r(e(46)),R=r(e(54)),se=r(e(225)),ue=r(e(51));function a(){var s=this.context,n=(0, I.default)(s).getInstance(),i=!1,u=void 0,U=void 0,k=void 0,B=void 0,l=void 0,G=void 0,d=void 0,j=void 0,r=void 0,a=void 0,f=void 0,Y=void 0,K=void 0,q=void 0,H=void 0,c=void 0,V=void 0,o=void 0,z=void 0,W=void 0,X=void 0,Q=void 0,Z=void 0,$=void 0,J=void 0,ee=void 0;function e(){H=NaN,z=K=null,q=!(c=[]);}function t(){e(),f=[],j=null;}function h(e){var t=e.chunk;t.mediaInfo.embeddedCaptions&&_(t.bytes,t);}function p(){X=[],(Y=(0, S.default)(s).getInstance()).setConfig({videoModel:V}),Y.initialize(),k=(0, v.default)(s).getInstance(),$=[],i=!(Z=W=null),J=(Q=0,A.default)(s).getInstance();var e=o.getActiveStreamProcessors();for(var t in e)if("video"===e[t].getType()){ee=e[t].getRepresentationInfo().MSETimeOffset;break}n.on(R.default.VIDEO_CHUNK_RECEIVED,h,this),n.on(R.default.BUFFER_CLEARED,E,this);}function g(e){W=e;}function te(e,t){var n,r,i=new m.default,a={subtitle:"subtitles",caption:"captions"};i.captionData=e,i.lang=t.lang,i.labels=t.labels,i.id=t.id?t.id:t.index,i.index=t.index,i.isTTML=(n=!1,t.codec&&0<=t.codec.search(re.default.STPP)&&(n=!0),t.mimeType&&0<=t.mimeType.search(re.default.TTML)&&(n=!0),n),i.defaultTrack=function(e){var t=!1;1<X.length&&e.isEmbedded?t=e.id&&e.id===re.default.CC1:1===X.length?e.id&&"string"==typeof e.id&&"CC"===e.id.substring(0,2)&&(t=!0):0===X.length&&(t=e.index===f[0].index);return t}(t),i.isFragmented=!l.getIsTextTrack(t.mimeType),i.isEmbedded=!!t.isEmbedded,i.kind=r=(r=0<t.roles.length?a[t.roles[0]]:a.caption)===a.caption||r===a.subtitle?r:a.caption,i.roles=t.roles,i.accessibility=t.accessibility;var o=(f?f.length:0)+X.length;Y.addTextTrack(i,o);}function _(e,t){var n=void 0,r=void 0,i=void 0,a=void 0,o=void 0,s=void 0,u=void 0,l=t.mediaInfo,d=l.type,f=l.mimeType,c=l.codec||f;if(c){if(d===re.default.FRAGMENTED_TEXT)if(q||"InitializationSegment"!==t.segmentType){if(!q)return;if(r=(s=k.getSamplesInfo(e)).sampleList,null===z&&0<r.length&&(z=r[0].cts-t.start*H),0<=c.search(re.default.STPP))for(j=null!==j?j:ne(c),i=0;i<r.length;i++){var h=(T=r[i]).cts,p=h-z;this.buffered.add(p/H,(p+T.duration)/H);for(var g=new DataView(e,T.offset,T.subSizes[0]),u=ae.default.Utils.dataViewToString(g,re.default.UTF8),_=[],E=T.offset+T.subSizes[0],a=1;a<T.subSizes.length;a++){var m=new Uint8Array(e,E,T.subSizes[a]),v=String.fromCharCode.apply(null,m);_.push(v),E+=T.subSizes[a];}try{var y=G.getValue().ttmlTimeIsRelative?h/H:0,n=j.parse(u,y,h/H,(h+T.duration)/H,_);Y.addCaptions(W,z/H,n);}catch(e){K.removeExecutedRequestsBeforeTime(),this.remove(),U.error("TTML parser error: "+e.message);}}else {for(var T,S=[],i=0;i<r.length;i++){(T=r[i]).cts-=z,this.buffered.add(T.cts/H,(T.cts+T.duration)/H);var A=e.slice(T.offset,T.offset+T.size),I=ae.default.parseBuffer(A);for(a=0;a<I.boxes.length;a++){var R=I.boxes[a];if(U.debug("VTT box1: "+R.type),"vtte"!==R.type&&"vttc"===R.type)for(U.debug("VTT vttc boxes.length = "+R.boxes.length),o=0;o<R.boxes.length;o++){var b,D,M,N=R.boxes[o];U.debug("VTT box2: "+N.type),"payl"===N.type&&(b=N.cue_text,U.debug("VTT cue_text = "+b),D=T.cts/H,M=(T.cts+T.duration)/H,S.push({start:D,end:M,data:b,styles:{}}),U.debug("VTT "+D+"-"+M+" : "+b));}}}0<S.length&&Y.addCaptions(W,0,S);}}else q=!0,H=k.getMediaTimescaleFromMoov(e);else if(d===re.default.TEXT){g=new DataView(e,0,e.byteLength);u=ae.default.Utils.dataViewToString(g,re.default.UTF8);try{n=ne(c).parse(u,0),Y.addCaptions(Y.getCurrentTrackIdx(),0,n);}catch(e){B.error(new se.default(ue.default.TIMED_TEXT_ERROR_ID_PARSE_CODE,ue.default.TIMED_TEXT_ERROR_MESSAGE_PARSE+e.message,u));}}else if(d===re.default.VIDEO)if(t.segmentType===ie.HTTPRequest.INIT_SEGMENT_TYPE){if(0===Q)for(Q=k.getMediaTimescaleFromMoov(e),i=0;i<X.length;i++)te(null,X[i]);}else {if(0===Q)return void U.warn("CEA-608: No timescale for embeddedTextTrack yet");var C=(s=k.getSamplesInfo(e)).lastSequenceNumber;if(!$[0]&&!$[1]){var O=void 0,w=void 0;for(i=0;i<X.length;i++){if(X[i].id===re.default.CC1?w=Y.getTrackIdxForId(re.default.CC1):X[i].id===re.default.CC3&&(w=Y.getTrackIdxForId(re.default.CC3)),-1===w)return void U.warn("CEA-608: data before track is ready.");O=function(i){return function(e,t,n){var r=null;(r=V.getTTMLRenderingDiv()?J.createHTMLCaptionsFromScreen(V.getElement(),e,t,n):[{start:e,end:t,data:n.getDisplayText(),styles:{}}])&&Y.addCaptions(i,0,r);}}(w),$[i]=new oe.default.Cea608Parser(i+1,{newCue:O},null);}}if(Q){if(null!==Z&&C!==Z+s.numSequences)for(i=0;i<$.length;i++)$[i]&&$[i].reset();for(var P=function(e,t){if(0===t.length)return null;for(var n={splits:[],fields:[[],[]]},r=new DataView(e),i=0;i<t.length;i++)for(var a=t[i],o=oe.default.findCea608Nalus(r,a.offset,a.size),s=null,u=0,l=0;l<o.length;l++)for(var d=oe.default.extractCea608DataFromRange(r,o[l]),f=0;f<2;f++)0<d[f].length&&(a.cts!==s?u=0:u+=1,n.fields[f].push([a.cts+ee*Q,d[f],u]),s=a.cts);return n.fields.forEach(function(e){e.sort(function(e,t){return e[0]===t[0]?e[2]-t[2]:e[0]-t[0]});}),n}(e,s.sampleList),L=0;L<$.length;L++){var x=P.fields[L],F=$[L];if(F)for(i=0;i<x.length;i++)F.addData(x[i][0]/Q,x[i][1]);}Z=C;}}}else U.error("No text type defined");}function ne(e){var t=void 0;return 0<=e.search(re.default.VTT)?t=r:(0<=e.search(re.default.TTML)||0<=e.search(re.default.STPP))&&(t=a),t}function E(n){X.forEach(function(e){var t=Y.getTrackIdxForId(e.id);0<=t&&Y.deleteCuesFromTrackIdx(t,n.from,n.to);});}return u={initialize:function(e,t,n,r){i||p(),Y.setConfig({videoModel:V}),Y.initialize(),k=k||(0, v.default)(s).getInstance(),function(e,t,n,r){var i=!l.getIsTextTrack(e);if(f=f.concat(n),i){K=r,u.buffered=(0, y.default)(s).create(),c=d.getTracksFor(re.default.FRAGMENTED_TEXT,t);for(var a=d.getCurrentTrackFor(re.default.FRAGMENTED_TEXT,t),o=0;o<c.length;o++)if(c[o]===a){g(o);break}}for(o=0;o<f.length;o++)te(null,f[o]);}(e,t,n,r);},append:_,abort:function(){Y.deleteAllTextTracks(),e(),k=null,f=[];},addEmbeddedTrack:function(e){if(i||p(),e)if(e.id===re.default.CC1||e.id===re.default.CC3){for(var t=0;t<X.length;t++)if(X[t].id===e.id)return;X.push(e);}else U.warn("Embedded track "+e.id+" not supported!");},resetEmbedded:function(){n.off(R.default.VIDEO_CHUNK_RECEIVED,h,this),n.off(R.default.BUFFER_CLEARED,E,this),Y&&Y.deleteAllTextTracks(),i=!1,X=[],$=[null,null],Z=null;},setConfig:function(e){e&&(e.errHandler&&(B=e.errHandler),e.adapter&&(l=e.adapter),e.manifestModel&&(G=e.manifestModel),e.mediaController&&(d=e.mediaController),e.videoModel&&(V=e.videoModel),e.streamController&&(o=e.streamController),e.textTracks&&(Y=e.textTracks),e.vttParser&&(r=e.vttParser),e.ttmlParser&&(a=e.ttmlParser));},getConfig:function(){return {fragmentModel:K,fragmentedTracks:c,videoModel:V}},setCurrentFragmentedTrackIdx:g,remove:function(e,t){void 0===e&&e===t&&(e=this.buffered.start(0),t=this.buffered.end(this.buffered.length-1)),this.buffered.remove(e,t);},reset:function(){t(),Y=V=o=null;}},U=(0, T.default)(s).getInstance().getLogger(u),t(),u}a.__dashjs_factory_name="TextSourceBuffer",n.default=i.default.getSingletonFactory(a),t.exports=n.default;},{108:108,197:197,2:2,202:202,206:206,208:208,225:225,233:233,241:241,45:45,46:46,47:47,51:51,54:54,9:9}],202:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var m=r(e(108)),v=r(e(46)),C=r(e(54)),i=r(e(47)),O=r(e(45)),w=e(17),P=e(218);function a(){var e=this.context,y=(0, v.default)(e).getInstance(),t=void 0,u=void 0,l=void 0,T=void 0,o=void 0,a=void 0,d=void 0,S=void 0,A=void 0,I=void 0,R=void 0,b=void 0,r=void 0,D=void 0,M=void 0,n=void 0,N=void 0;function s(e){var t=o[e].kind,n=void 0!==o[e].id?o[e].id:o[e].lang,r=o[e].lang,i=o[e].isTTML,a=o[e].isEmbedded;return T.addTextTrack(t,n,r,i,a)}function f(e,t){var n=T.getClientWidth(),r=T.getClientHeight(),i=T.getVideoWidth(),a=T.getVideoHeight(),o=T.getVideoRelativeOffsetTop(),s=T.getVideoRelativeOffsetLeft();if(0!==i&&0!==a){var u=i/a,l=!1;e.isFromCEA608&&(u=3.5/3,l=!0);var d,f=function(e,t,n,r,i,a){var o=0,s=0;n/r<e/t?o=(s=t)/r*n:s=(o=e)/n*r;var u,l,d=0,f=0;return i<o/s?d=(f=s)*i:f=(d=o)/i,u=(e-d)/2,l=(t-f)/2,a?{x:u+.1*d,y:l+.1*f,w:.8*d,h:.8*f}:{x:u,y:l,w:d,h:f}}.call(this,n,r,i,a,u,l),c=f.w,h=f.h,p=f.x,g=f.y;if(c!=I||h!=R||p!=S||g!=A||t){S=p+s,A=g+o,I=c,R=h,!b||(d=b.style)&&(d.left=S+"px",d.top=A+"px",d.width=I+"px",d.height=R+"px",d.zIndex=D&&document[D]||M?N:null,y.trigger(C.default.CAPTION_CONTAINER_RESIZE,{}));var _=e.activeCues;if(_)for(var E=_.length,m=0;m<E;++m){var v=_[m];v.scaleCue(v);}}}}function c(e){var t,n=void 0,r=void 0,i=void 0,a=void 0,o=void 0;if(e.cellResolution){var s=[I/e.cellResolution[0],R/e.cellResolution[1]];if(e.linePadding)for(n in e.linePadding)if(e.linePadding.hasOwnProperty(n))for(var r=(e.linePadding[n]*s[0]).toString(),u=document.getElementsByClassName("spanPadding"),l=0;l<u.length;l++)u[l].style.cssText=u[l].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+r),u[l].style.cssText=u[l].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+r);if(e.fontSize){for(n in e.fontSize)if(e.fontSize.hasOwnProperty(n)){"%"===e.fontSize[n][0]?i=e.fontSize[n][1]/100:"c"===e.fontSize[n][0]&&(i=e.fontSize[n][1]),r=(i*s[1]).toString(),o="defaultFontSize"!==n?document.getElementsByClassName(n):document.getElementsByClassName("paragraph");for(var d=0;d<o.length;d++)o[d].style.cssText=o[d].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+r);}if(e.lineHeight)for(n in e.lineHeight)if(e.lineHeight.hasOwnProperty(n)){"%"===e.lineHeight[n][0]?a=e.lineHeight[n][1]/100:"c"===e.fontSize[n][0]&&(a=e.lineHeight[n][1]),r=(a*s[1]).toString(),o=document.getElementsByClassName(n);for(var f=0;f<o.length;f++)o[f].style.cssText=o[f].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+r);}}}e.isd&&((t=document.getElementById(e.cueID))&&b.removeChild(t),h(e));}function h(a){var e;b&&(e=document.createElement("div"),b.appendChild(e),n=(0, w.renderHTML)(a.isd,e,function(e){var t=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/,n=/^#(.*)$/;if(t.test(e)){var r=t.exec(e),i=parseInt(r[4],10)-1;return "data:image/png;base64,"+btoa(a.images[i])}if(n.test(e)){i=(r=n.exec(e))[1];return "data:image/png;base64,"+a.embeddedImages[i]}return null},b.clientHeight,b.clientWidth,!1,function(e){u.info("renderCaption :",e);},n,!0),e.id=a.cueID,y.trigger(C.default.CAPTION_RENDERED,{captionDiv:e,currentTrackIdx:d}));}function p(e){return 0<=e&&o[e]?T.getTextTrack(o[e].kind,o[e].id,o[e].lang,o[e].isTTML,o[e].isEmbedded):null}function g(e){var t;e!==d&&(t=p(d=e),function(e){E.call(this),e&&"html"===e.renderingType?function(){var e=document.getElementById("native-cue-style");if(e)return;(e=document.createElement("style")).id="native-cue-style",document.head.appendChild(e);var t=e.sheet,n=T.getElement();try{n&&(n.id?t.insertRule("#"+n.id+"::cue {background: transparent}",0):0!==n.classList.length?t.insertRule("."+n.className+"::cue {background: transparent}",0):t.insertRule("video::cue {background: transparent}",0));}catch(e){u.info(""+e.message);}}.call(this):i.call(this);}.call(this,t),r&&(clearInterval(r),r=null),t&&"html"===t.renderingType&&(f.call(this,t,!0),r=setInterval(f.bind(this,t),500)));}function _(e,t,n){if(e.cues)for(var r=e.cues,i=r.length-1;0<=i;i--)a=r[i],o=t,s=n,(isNaN(o)||a.startTime>=o)&&(isNaN(s)||a.endTime<=s)&&e.removeCue(r[i]);var a,o,s;}function i(){var e=document.getElementById("native-cue-style");e&&document.head.removeChild(e);}function E(){if(b)for(;b.firstChild;)b.removeChild(b.firstChild);}return t={initialize:function(){"undefined"!=typeof window&&"undefined"!=typeof navigator&&(l=window.VTTCue||window.TextTrackCue,o=[],a=[],M=!(d=-1),N=2147483647,n=r=b=null,void(R=I=A=S=0)!==document.fullscreenElement?D="fullscreenElement":void 0!==document.webkitIsFullScreen?D="webkitIsFullScreen":document.msFullscreenElement?D="msFullscreenElement":document.mozFullScreen&&(D="mozFullScreen"));},setDisplayCConTop:function(e){(0, P.checkParameterType)(e,"boolean"),M=e,b&&!document[D]&&(b.style.zIndex=e?N:null);},addTextTrack:function(e,t){var i=this;o.length!==t?(o.push(e),o.length===t&&function(){o.sort(function(e,t){return e.index-t.index}),b=T.getTTMLRenderingDiv();for(var n=-1,e=0;e<o.length;e++){var t=s.call(i,e);a.push(t),o[e].defaultTrack&&(t.default=!0,n=e);var r=p(e);r&&(r.mode=m.default.TEXT_SHOWING,b&&(o[e].isTTML||o[e].isEmbedded)?r.renderingType="html":r.renderingType="default"),i.addCaptions(e,0,o[e].captionData),y.trigger(C.default.TEXT_TRACK_ADDED);}g.call(i,n),0<=n&&function(){y.on(C.default.PLAYBACK_METADATA_LOADED,function e(){var t=p(n);t&&f.call(this,t,!0),y.off(C.default.PLAYBACK_METADATA_LOADED,e,this);},i);for(var e=0;e<o.length;e++){var t=p(e);t&&(t.mode=e===n?m.default.TEXT_SHOWING:m.default.TEXT_HIDDEN);}}(),y.trigger(C.default.TEXT_TRACKS_QUEUE_INITIALIZED,{index:d,tracks:o});}()):u.error("Trying to add too many tracks.");},addCaptions:function(e,t,n){var r=p(e),i=this;if(r&&Array.isArray(n)&&0!==n.length)for(var a=0;a<n.length;a++){var o=void 0,s=n[a];r.cellResolution=s.cellResolution,r.isFromCEA608=s.isFromCEA608,"html"===s.type&&b?((o=new l(s.start-t,s.end-t,"")).cueHTMLElement=s.cueHTMLElement,o.isd=s.isd,o.images=s.images,o.embeddedImages=s.embeddedImages,o.cueID=s.cueID,o.scaleCue=c.bind(i),o.cellResolution=s.cellResolution,o.lineHeight=s.lineHeight,o.linePadding=s.linePadding,o.fontSize=s.fontSize,b.style.left=S+"px",b.style.top=A+"px",b.style.width=I+"px",b.style.height=R+"px",o.onenter=function(){r.mode===m.default.TEXT_SHOWING&&(this.isd?(h(this),u.debug("Cue enter id:"+this.cueID)):(b.appendChild(this.cueHTMLElement),c.call(i,this),y.trigger(C.default.CAPTION_RENDERED,{captionDiv:this.cueHTMLElement,currentTrackIdx:d})));},o.onexit=function(){if(b)for(var e=b.childNodes,t=0;t<e.length;++t)e[t].id===this.cueID&&(u.debug("Cue exit id:"+e[t].id),b.removeChild(e[t]),--t);}):s.data&&(o=new l(s.start-t,s.end-t,s.data),s.styles&&(void 0!==s.styles.align&&"align"in o&&(o.align=s.styles.align),void 0!==s.styles.line&&"line"in o&&(o.line=s.styles.line),void 0!==s.styles.position&&"position"in o&&(o.position=s.styles.position),void 0!==s.styles.size&&"size"in o&&(o.size=s.styles.size)),o.onenter=function(){r.mode===m.default.TEXT_SHOWING&&y.trigger(C.default.CAPTION_RENDERED,{currentTrackIdx:d});});try{o?r.addCue(o):u.error("impossible to display subtitles.");}catch(e){throw _(r),r.addCue(o),e}}},getCurrentTrackIdx:function(){return d},setCurrentTrackIdx:g,getTrackIdxForId:function(e){for(var t=-1,n=0;n<o.length;n++)if(o[n].id===e){t=n;break}return t},getCurrentTrackInfo:function(){return o[d]},setModeForTrackIdx:function(e,t){var n=p(e);n&&n.mode!==t&&(n.mode=t);},deleteCuesFromTrackIdx:function(e,t,n){var r=p(e);r&&_(r,t,n);},deleteAllTextTracks:function(){for(var e=a?a.length:0,t=0;t<e;t++){var n=p(t);n&&(_.call(this,n),n.mode="disabled");}a=[],o=[],r&&(clearInterval(r),r=null),d=-1,E.call(this);},deleteTextTrack:function(e){T.removeChild(a[e]),a.splice(e,1);},setConfig:function(e){e&&e.videoModel&&(T=e.videoModel);}},u=(0, O.default)(e).getInstance().getLogger(t),t}a.__dashjs_factory_name="TextTracks",n.default=i.default.getSingletonFactory(a),t.exports=n.default;},{108:108,17:17,218:218,45:45,46:46,47:47,54:54}],203:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),a=r(e(108)),c=r(e(234)),o=r(e(204)),s=r(e(224)),h=e(80);function u(e){var t,n=this.context,f=void 0;function r(){f&&f.reset();}return t={provide:function(e,t){if("function"==typeof t){var n,r=f.getCurrentTrack(),i=void 0;if(!r||r.segmentDuration<=0||null==e)t(null);else {isNaN(r.segmentDuration)&&(i=f.getThumbnailRequestForTime(e))&&(r.segmentDuration=i.duration),n=e%r.segmentDuration;var a,o,s,u,l=Math.floor(n*r.tilesHor*r.tilesVert/r.segmentDuration),d=new c.default;if(d.width=Math.floor(r.widthPerTile),d.height=Math.floor(r.heightPerTile),d.x=Math.floor(l%r.tilesHor)*r.widthPerTile,d.y=Math.floor(l/r.tilesHor)*r.heightPerTile,"readThumbnail"in r)return r.readThumbnail(e,function(e){d.url=e,t(d);});i?(d.url=i.url,r.segmentDuration=NaN):(a=Math.floor(e/r.segmentDuration),d.url=(s=a+(o=r).startNumber,u=(0, h.replaceTokenForTemplate)(o.templateUrl,"Number",s),u=(0, h.replaceTokenForTemplate)(u,"Time",(s-1)*o.segmentDuration),u=(0, h.replaceTokenForTemplate)(u,"Bandwidth",o.bandwidth),(0, h.unescapeDollarsInTemplate)(u))),t(d);}}},setTrackByIndex:function(e){f.setTrackByIndex(e);},getCurrentTrackIndex:function(){return f.getCurrentTrackIndex()},getBitrateList:function(){var e=f.getTracks(),n=0;return e.map(function(e){var t=new s.default;return t.mediaType=a.default.IMAGE,t.qualityIndex=n++,t.bitrate=e.bitrate,t.width=e.width,t.height=e.height,t})},reset:r},r(),f=(0, o.default)(n).create({streamInfo:e.streamInfo,adapter:e.adapter,baseURLController:e.baseURLController,timelineConverter:e.timelineConverter,debug:e.debug,eventBus:e.eventBus,events:e.events,dashConstants:e.dashConstants}),t}u.__dashjs_factory_name="ThumbnailController",n.default=i.default.getClassFactory(u),t.exports=n.default;},{108:108,204:204,224:224,234:234,47:47,80:80}],204:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var T=r(e(108)),S=r(e(61)),i=r(e(47)),A=r(e(235)),I=r(e(220)),R=e(80),b=r(e(54)),D=r(e(206)),M=r(e(159)),N=r(e(57)),C=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"];function a(e){var t,n=this.context,u=e.adapter,s=e.baseURLController,r=e.streamInfo,l=e.timelineConverter,i=e.debug,a=e.eventBus,o=e.events,d=e.dashConstants,f=(0, I.default)(n).getInstance(),c=void 0,h=void 0,p=void 0,g=void 0,_=void 0,E=void 0;function m(){y(),_=(0, M.default)(n).create({}),E=(0, D.default)(n).getInstance(),(h=(0, N.default)(n).create({timelineConverter:l,baseURLController:s,debug:i,eventBus:a,events:o,dashConstants:d,urlUtils:f})).initialize(!!u&&u.getIsDynamic()),function(){if(!r||!u)return;if(!(g=u.getMediaInfoForType(r,T.default.IMAGE)))return;var e=u.getVoRepresentations(g);e&&0<e.length&&e.forEach(function(e){(e.segmentInfoType===S.default.SEGMENT_TEMPLATE&&0<e.segmentDuration&&e.media||e.segmentInfoType===S.default.SEGMENT_TIMELINE)&&v(e),e.segmentInfoType===S.default.SEGMENT_BASE&&v(e,!0);});0<c.length&&(c.sort(function(e,t){return e.bitrate-t.bitrate}),p=c.length-1);}();}function v(e,t){var n,r,i=new A.default;i.id=e.id,i.bitrate=e.bandwidth,i.width=e.width,i.height=e.height,i.tilesHor=1,i.tilesVert=1,e.essentialProperties&&e.essentialProperties.forEach(function(e){var t;0<=C.indexOf(e.schemeIdUri)&&e.value&&(2!==(t=e.value.split("x")).length||isNaN(t[0])||isNaN(t[1])||(i.tilesHor=parseInt(t[0],10),i.tilesVert=parseInt(t[1],10)));}),t?a.trigger(b.default.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,{mimeType:g.mimeType,mediaType:T.default.IMAGE,representation:e,callback:function(e,r){var o=[];e=function(e,t){for(var n=[],r=0,i=void 0,a=void 0,o=void 0,i=0,s=e.length;i<s;i++)a=e[i],(o=(0, R.getTimeBasedSegment)(l,u.getIsDynamic(),t,a.startTime,a.duration,a.timescale,a.media,a.mediaRange,r))&&(n.push(o),o=null,r++);return n}(e,r),i.segmentDuration=e[0].duration,i.readThumbnail=function(t,a){var n=null;o.some(function(e){if(e.start<=t&&e.end>t)return n=e.url,!0}),n?a(n):e.some(function(i){if(i.mediaStartTime<=t&&i.mediaStartTime+i.duration>t){var e=s.resolve(r.path);return _.load({method:"get",url:e.url,request:{range:i.mediaRange,responseType:"arraybuffer"},onload:function(e){var t=E.getSamplesInfo(e.target.response),n=new Blob([e.target.response.slice(t.sampleList[0].offset,t.sampleList[0].offset+t.sampleList[0].size)],{type:"image/jpeg"}),r=window.URL.createObjectURL(n);o.push({start:i.mediaStartTime,end:i.mediaStartTime+i.duration,url:r}),a&&a(r);}}),!0}});};}}):(i.startNumber=e.startNumber,i.segmentDuration=e.segmentDuration,i.timescale=e.timescale,i.templateUrl=(n=e,(r=f.isRelative(n.media)?f.resolve(n.media,s.resolve(n.path).url):n.media)?(0, R.replaceIDForTemplate)(r,n.id):"")),0<i.tilesHor&&0<i.tilesVert&&(i.widthPerTile=i.width/i.tilesHor,i.heightPerTile=i.height/i.tilesVert,c.push(i));}function y(){c=[],p=-1,g=null;}return t={initialize:m,getTracks:function(){return c},reset:y,setTrackByIndex:function(e){c&&0!==c.length&&(e>=c.length&&(e=c.length-1),p=e);},getCurrentTrack:function(){return p<0?null:c[p]},getCurrentTrackIndex:function(){return p},getThumbnailRequestForTime:function(e){for(var t=void 0,n=u.getVoRepresentations(g),r=0;r<n.length;r++)if(c[p].id===n[r].id){t=n[r];break}return h.getSegmentRequestForTime(g,t,e)}},m(),t}n.THUMBNAILS_SCHEME_ID_URIS=C,a.__dashjs_factory_name="ThumbnailTracks",n.default=i.default.getClassFactory(a);},{108:108,159:159,206:206,220:220,235:235,47:47,54:54,57:57,61:61,80:80}],205:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var u=r(e(51)),l=r(e(46)),d=r(e(54)),f=r(e(113)),c=r(e(223)),h=r(e(222)),i=r(e(47)),p=r(e(225)),g=e(218);function a(){var e,t=this.context,i=(0, l.default)(t).getInstance(),n=void 0,a=void 0,r=void 0,o=void 0;function s(){n.reset();}return e={chooseSelector:function(e){(0, g.checkParameterType)(e,"boolean"),o=e?r:a;},select:function(e){if(e){var t=e.baseUrls,n=e.selectedIdx;if(!isNaN(n))return t[n];var r=o.select(t);return r?(e.selectedIdx=t.indexOf(r),r):(i.trigger(d.default.URL_RESOLUTION_FAILED,{error:new p.default(u.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,u.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)}),void(o===a&&s()))}},reset:s,setConfig:function(e){e.selector&&(o=e.selector);}},n=(0, f.default)(t).create({updateEventName:d.default.SERVICE_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:d.default.SERVICE_LOCATION_BLACKLIST_ADD}),a=(0, h.default)(t).create({blacklistController:n}),r=(0, c.default)(t).create({blacklistController:n}),o=a,e}a.__dashjs_factory_name="BaseURLSelector",n.default=i.default.getClassFactory(a),t.exports=n.default;},{113:113,218:218,222:222,223:223,225:225,46:46,47:47,51:51,54:54}],206:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(45)),o=r(e(214)),a=r(e(47)),s=r(e(9)),c=r(e(230));function u(){var a=void 0,e=void 0,r=this.context;function P(e){if(!e)return null;void 0===e.fileStart&&(e.fileStart=0);var t=s.default.parseBuffer(e),n=(0, o.default)(r).create();return n.setData(t),n}return e={parse:P,findLastTopIsoBoxCompleted:function(e,t,n){if(void 0===n&&(n=0),!t||n+8>=t.byteLength)return new c.default(0,!1);for(var r,i,a,o,s=t instanceof ArrayBuffer?new Uint8Array(t):t,u=void 0,l=0;n<s.byteLength;){var d=(a=s)[(o=n)+3]>>>0|a[o+2]<<8>>>0|a[o+1]<<16>>>0|a[o]<<24>>>0,f=(r=s,i=n+4,String.fromCharCode(r[i++])+String.fromCharCode(r[i++])+String.fromCharCode(r[i++])+String.fromCharCode(r[i]));if(0==d)break;n+d<=s.byteLength&&(0<=e.indexOf(f)?u=new c.default(n,!0,d):l=n+d),n+=d;}return u||new c.default(l,!1)},getMediaTimescaleFromMoov:function(e){var t=P(e),n=t?t.getBox("mdhd"):void 0;return n?n.timescale:NaN},getSamplesInfo:function(e){if(!e||0===e.byteLength)return {sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};for(var t=P(e),n=t.getBoxes("moof"),r=t.getBoxes("mfhd"),i=void 0,a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,d=void 0,f=void 0,c=void 0,h=void 0,p=void 0,g=void 0,_=void 0,E=void 0,m=t.getBoxes("moof").length,v=r[r.length-1].sequence_number,u=[],y=-1,T=-1,h=a=0;h<n.length;h++)for(var S=n[h],A=S.getChildBoxes("traf"),f=0;f<A.length;f++){for(var I=A[f],R=I.getChildBox("tfhd"),b=I.getChildBox("tfdt"),s=b.baseMediaDecodeTime,D=I.getChildBoxes("trun"),M=I.getChildBoxes("subs"),c=0;c<D.length;c++)for(var N=D[c],a=N.sample_count,_=(R.base_data_offset||0)+(N.data_offset||0),d=0;d<a;d++){i=void 0!==(l=N.samples[d]).sample_duration?l.sample_duration:R.default_sample_duration,o=void 0!==l.sample_size?l.sample_size:R.default_sample_size;var C={dts:s,cts:s+(void 0!==l.sample_composition_time_offset?l.sample_composition_time_offset:0),duration:i,offset:S.offset+_,size:o,subSizes:[o]};if(M)for(p=0;p<M.length;p++){var O=M[p];if(y<O.entry_count-1&&T<d&&(y++,T+=O.entries[y].sample_delta),d==T){C.subSizes=[];for(var w=O.entries[y],g=0;g<w.subsample_count;g++)C.subSizes.push(w.subsamples[g].subsample_size);}}u.push(C),_+=o,s+=i;}E=s-b.baseMediaDecodeTime;}return {sampleList:u,lastSequenceNumber:v,totalDuration:E,numSequences:m}},findInitRange:function(e){var t=null,n=P(e);if(!n)return t;var r=n.getBox("ftyp"),i=n.getBox("moov");return a.debug("Searching for initialization."),i&&i.isComplete&&(t=(r?r.offset:i.offset)+"-"+(i.offset+i.size-1),a.debug("Found the initialization.  Range: "+t)),t}},a=(0, i.default)(r).getInstance().getLogger(e),e}u.__dashjs_factory_name="BoxParser",n.default=a.default.getSingletonFactory(u),t.exports=n.default;},{214:214,230:230,45:45,47:47,9:9}],207:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(47),a=(r=i)&&r.__esModule?r:{default:r};function o(){var e,t=void 0;return t=!(e={supportsMediaSource:function(){var e="WebKitMediaSource"in window,t="MediaSource"in window;return e||t},supportsEncryptedMedia:function(){return t},supportsCodec:function(e){return !!("MediaSource"in window&&MediaSource.isTypeSupported(e))||!!("WebKitMediaSource"in window&&WebKitMediaSource.isTypeSupported(e))},setEncryptedMediaSupported:function(e){t=e;}}),e}o.__dashjs_factory_name="Capabilities",n.default=a.default.getSingletonFactory(o),t.exports=n.default;},{47:47}],208:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(47),a=(r=i)&&r.__esModule?r:{default:r},o=e(218);function s(){return {customTimeRangeArray:[],length:0,add:function(e,t){for(var n=0,n=0;n<this.customTimeRangeArray.length&&e>this.customTimeRangeArray[n].start;n++);for(this.customTimeRangeArray.splice(n,0,{start:e,end:t}),n=0;n<this.customTimeRangeArray.length-1;n++)this.mergeRanges(n,n+1)&&n--;this.length=this.customTimeRangeArray.length;},clear:function(){this.customTimeRangeArray=[],this.length=0;},remove:function(e,t){for(var n=0;n<this.customTimeRangeArray.length;n++)if(e<=this.customTimeRangeArray[n].start&&t>=this.customTimeRangeArray[n].end)this.customTimeRangeArray.splice(n,1),n--;else {if(e>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end){this.customTimeRangeArray.splice(n+1,0,{start:t,end:this.customTimeRangeArray[n].end}),this.customTimeRangeArray[n].end=e;break}e>this.customTimeRangeArray[n].start&&e<this.customTimeRangeArray[n].end?this.customTimeRangeArray[n].end=e:t>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end&&(this.customTimeRangeArray[n].start=t);}this.length=this.customTimeRangeArray.length;},mergeRanges:function(e,t){var n=this.customTimeRangeArray[e],r=this.customTimeRangeArray[t];return n.start<=r.start&&r.start<=n.end&&n.end<=r.end?(n.end=r.end,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&r.end<=n.end?(n.start=r.start,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&n.end<=r.end?(this.customTimeRangeArray.splice(e,1),!0):n.start<=r.start&&r.start<=n.end&&r.end<=n.end&&(this.customTimeRangeArray.splice(t,1),!0)},start:function(e){return (0, o.checkInteger)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].start},end:function(e){return (0, o.checkInteger)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].end}}}s.__dashjs_factory_name="CustomTimeRanges",n.default=a.default.getClassFactory(s),t.exports=n.default;},{218:218,47:47}],209:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),d=r(e(45)),f=r(e(108)),c=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],h="dashjs_?_bitrate",p="dashjs_?_settings",g="localStorage",_="lastBitrate",E="lastMediaSettings";function a(e){e=e||{};var t=this.context,o=e.settings,n=void 0,s=void 0,r=void 0;function i(e){if(void 0!==r)return r;r=!1;var t=void 0;try{"undefined"!=typeof window&&(t=window[e]);}catch(e){return s.warn("DOMStorage access denied: "+e.message),r}if(!t||e!==g)return r;try{t.setItem("1","1"),t.removeItem("1"),r=!0;}catch(e){s.warn("DOMStorage is supported, but cannot be used: "+e.message);}return r}function a(){return 6e5*Math.round((new Date).getTime()/6e5)}function u(e,t){return i(e)&&o.get().streaming[t+"CachingInfo"].enabled}function l(){if(!o)throw new Error(f.default.MISSING_CONFIG_ERROR)}return n={getSavedBitrateSettings:function(e){var t=NaN;if(l(),u(g,_)){var n=h.replace(/\?/,e);try{var r=JSON.parse(localStorage.getItem(n))||{},i=(new Date).getTime()-parseInt(r.timestamp,10)>=o.get().streaming.lastBitrateCachingInfo.ttl||!1,a=parseFloat(r.bitrate);isNaN(a)||i?i&&localStorage.removeItem(n):(t=a,s.debug("Last saved bitrate for "+e+" was "+a));}catch(e){return null}}return t},setSavedBitrateSettings:function(e,t){if(u(g,_)&&t){var n=h.replace(/\?/,e);try{localStorage.setItem(n,JSON.stringify({bitrate:t.toFixed(3),timestamp:a()}));}catch(e){s.error(e.message);}}},getSavedMediaSettings:function(e){var t=null;if(l(),u(g,E)){var n=p.replace(/\?/,e);try{var r=JSON.parse(localStorage.getItem(n))||{},i=(new Date).getTime()-parseInt(r.timestamp,10)>=o.get().streaming.lastMediaSettingsCachingInfo.ttl||!1,t=r.settings;i&&(localStorage.removeItem(n),t=null);}catch(e){return null}}return t},setSavedMediaSettings:function(e,t){if(u(g,E)){var n=p.replace(/\?/,e);try{localStorage.setItem(n,JSON.stringify({settings:t,timestamp:a()}));}catch(e){s.error(e.message);}}}},s=(0, d.default)(t).getInstance().getLogger(n),i(g)&&c.forEach(function(e){var t=localStorage.getItem(e.oldKey);if(t){localStorage.removeItem(e.oldKey);try{localStorage.setItem(e.newKey,t);}catch(e){s.error(e.message);}}}),n}a.__dashjs_factory_name="DOMStorage";var o=i.default.getSingletonFactory(a);n.default=o,t.exports=n.default;},{108:108,45:45,47:47}],210:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(47),a=(r=i)&&r.__esModule?r:{default:r};function o(){function e(t,e){try{return new window.URL(t,e).toString()}catch(e){return t}}function t(e,t){var n=s;if(!t)return e;if(!d(e))return e;f(e)&&(n=u),c(e)&&(n=l);var r=n(t),i="/"!==r.charAt(r.length-1)&&"/"!==e.charAt(0)?"/":"";return [r,e].join(i)}var n=void 0,r=/^[a-z][a-z0-9+\-_.]*:/i,i=/^https?:\/\//i,a=/^https:\/\//i,o=/^([a-z][a-z0-9+\-_.]*:\/\/[^\/]+)\/?/i;function s(e){var t=e.indexOf("/"),n=e.lastIndexOf("/");return -1!==t?n===t+1?e:(-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),e.substring(0,n+1)):""}function u(e){var t=e.match(o);return t?t[1]:""}function l(e){var t=e.match(r);return t?t[0]:""}function d(e){return !r.test(e)}function f(e){return d(e)&&"/"===e.charAt(0)}function c(e){return 0===e.indexOf("//")}return function(){try{new window.URL("x","http://y");n=e;}catch(e){}finally{n=n||t;}}(),{parseBaseUrl:s,parseOrigin:u,parseScheme:l,isRelative:d,isPathAbsolute:f,isSchemeRelative:c,isHTTPURL:function(e){return i.test(e)},isHTTPS:function(e){return a.test(e)},removeHostname:function(e){return /^(?:\w+\:\/\/)?([^\/]+)(.*)$/.exec(e)[2].substring(1)},resolve:function(e,t){return n(e,t)}}}o.__dashjs_factory_name="DefaultURLUtils",n.default=a.default.getSingletonFactory(o),t.exports=n.default;},{47:47}],211:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(47),a=(r=i)&&r.__esModule?r:{default:r};function o(e){e=e||{};var n=void 0,s=new DataView(e.data),u=0;function i(e,t){var n=!0,r=0;if(void 0===t&&(t=!1),r=16777215<e.tag?(s.getUint32(u)!==e.tag&&(n=!1),4):65535<e.tag?(256*s.getUint16(u)+s.getUint8(u+2)!==e.tag&&(n=!1),3):255<e.tag?(s.getUint16(u)!==e.tag&&(n=!1),2):(s.getUint8(u)!==e.tag&&(n=!1),1),!n&&e.required&&!t)throw new Error("required tag not found");return n&&(u+=r),n}function a(e){for(var t=1,n=128,r=-1,i=0,a=s.getUint8(u),o=0,o=0;o<8;o+=1){if((a&n)===n){i=void 0===e?a&~n:a,r=o;break}n>>=1;}for(o=0;o<r;o+=1,t+=1)i=i<<8|255&s.getUint8(u+t);return u+=t,i}return n={getPos:function(){return u},setPos:function(e){u=e;},consumeTag:i,consumeTagAndSize:function(e,t){var n=i(e,t);return n&&a(),n},parseTag:function(e){var t;return i(e),t=a(),n[e.parse](t)},skipOverElement:function(e,t){var n=i(e,t),r=void 0;return n&&(r=a(),u+=r),n},getMatroskaCodedNum:a,getMatroskaFloat:function(e){var t=void 0;switch(e){case 4:t=s.getFloat32(u),u+=4;break;case 8:t=s.getFloat64(u),u+=8;}return t},getMatroskaUint:function(e){for(var t=0,n=0;n<e;n+=1)t<<=8,t|=255&s.getUint8(u+n);return u+=e,t},moreData:function(){return u<s.byteLength}}}o.__dashjs_factory_name="EBMLParser",n.default=a.default.getClassFactory(o),t.exports=n.default;},{47:47}],212:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(46)),a=r(e(54)),o=r(e(47));function s(){var e=this.context,t=(0, i.default)(e).getInstance();return {error:function(e){t.trigger(a.default.ERROR,{error:e});}}}s.__dashjs_factory_name="ErrorHandler",n.default=o.default.getSingletonFactory(s),t.exports=n.default;},{46:46,47:47,54:54}],213:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(47),a=(r=i)&&r.__esModule?r:{default:r};function o(){var r={};return {save:function(e){var t=e.streamId,n=e.representationId;r[t]=r[t]||{},r[t][n]=e;},extract:function(e,t){return r&&r[e]&&r[e][t]?r[e][t]:null},reset:function(){r={};}}}o.__dashjs_factory_name="InitCache",n.default=a.default.getSingletonFactory(o),t.exports=n.default;},{47:47}],214:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(229)),a=r(e(47));function o(){var o=void 0;function t(e){var t=[];if(!e||!o||"function"!=typeof o.fetchAll)return t;for(var n=o.fetchAll(e),r=void 0,i=0,a=n.length;i<a;i++)(r=s(n[i]))&&t.push(r);return t}function s(e){if(!e)return null;var t=new i.default(e);return e.hasOwnProperty("_incomplete")&&(t.isComplete=!e._incomplete),t}return {getBox:function(e){return e&&o&&o.boxes&&0!==o.boxes.length&&"function"==typeof o.fetch?s(o.fetch(e)):null},getBoxes:t,setData:function(e){o=e;},getLastBox:function(){if(!o||!o.boxes||!o.boxes.length)return null;var e=t(o.boxes[o.boxes.length-1].type);return 0<e.length?e[e.length-1]:null}}}o.__dashjs_factory_name="IsoFile",n.default=a.default.getClassFactory(o),t.exports=n.default;},{229:229,47:47}],215:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),a=r(e(108));function o(e){var r=(e=e||{}).timelineConverter;return {getLiveEdge:function(e){!function(){if(!r||!r.hasOwnProperty("getExpectedLiveEdge"))throw new Error(a.default.MISSING_CONFIG_ERROR)}();var t=e.DVRWindow?e.DVRWindow.end:0,n=t;return e.useCalculatedLiveEdgeTime&&(n=r.getExpectedLiveEdge(),r.setClientTimeOffset(n-t)),n},reset:function(){r=null;}}}o.__dashjs_factory_name="LiveEdgeFinder",n.default=i.default.getClassFactory(o),t.exports=n.default;},{108:108,47:47}],216:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),a=r(e(12));function o(){return {areEqual:function(e,t){return (0, a.default)(e,t)}}}o.__dashjs_factory_name="ObjectUtils",n.default=i.default.getSingletonFactory(o),t.exports=n.default;},{12:12,47:47}],217:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(47),a=(r=i)&&r.__esModule?r:{default:r};function o(){return {modifyRequestURL:function(e){return e},modifyRequestHeader:function(e){return e}}}o.__dashjs_factory_name="RequestModifier",n.default=a.default.getSingletonFactory(o),t.exports=n.default;},{47:47}],218:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.checkParameterType=function(e,t){if(typeof e!==t)throw a.default.BAD_ARGUMENT_ERROR},n.checkInteger=function(e){if(null===e||isNaN(e)||e%1!=0)throw a.default.BAD_ARGUMENT_ERROR+" : argument is not an integer"},n.checkRange=function(e,t,n){if(e<t||n<e)throw a.default.BAD_ARGUMENT_ERROR+" : argument out of range"},n.checkIsVideoOrAudioType=function(e){if("string"!=typeof e||e!==a.default.AUDIO&&e!==a.default.VIDEO)throw a.default.BAD_ARGUMENT_ERROR};var r,i=e(108),a=(r=i)&&r.__esModule?r:{default:r};},{108:108}],219:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),a=r(e(45)),o=r(e(46)),S=r(e(54)),A=e(17);function s(){var e=this.context,v=(0, o.default)(e).getInstance(),t=void 0,y=void 0,T=0;return t={parse:function(e,t,n,r,i){var a="",o=[],s=void 0,u=void 0,l=void 0,d={},f={},c="",h="",p={onOpenTag:function(e,t,n){if("image"===t&&"http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"===e){if(!n[" imagetype"]||"PNG"!==n[" imagetype"].value)return void y.warn("smpte-tt imagetype != PNG. Discarded");c=n["http://www.w3.org/XML/1998/namespace id"].value;}},onCloseTag:function(){c&&(f[c]=h.trim()),c=h="";},onText:function(e){c&&(h+=e);}};if(!e)throw a="no ttml data to parse",new Error(a);d.data=e,v.trigger(S.default.TTML_TO_PARSE,d);var g=(0, A.fromXML)(d.data,function(e){a=e;},p);v.trigger(S.default.TTML_PARSED,{ttmlString:d.data,ttmlDoc:g});for(var _,E=g.getMediaTimeEvents(),l=0;l<E.length;l++){var m=(0, A.generateISD)(g,E[l],function(e){a=e;});m.contents.some(function(e){return e.contents.length})&&(s=E[l]+t<n?n:E[l]+t)<(u=E[l+1]+t>r?r:E[l+1]+t)&&o.push({start:s,end:u,type:"html",cueID:(_="cue_TTML_"+T,T++,_),isd:m,images:i,embeddedImages:f});}if(""!==a)throw y.error(a),new Error(a);return o}},y=(0, a.default)(e).getInstance().getLogger(t),t}s.__dashjs_factory_name="TTMLParser",n.default=i.default.getSingletonFactory(s),t.exports=n.default;},{17:17,45:45,46:46,47:47,54:54}],220:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),o=r(e(210));function a(){var i=void 0,a=[],e=this.context;function n(e,t,n){var r=function(e){for(var t=void 0,t=0;t<a.length;t++){if(a[t].regex.test(e))return a[t].utils}return i}(n||t);return r&&"function"==typeof r[e]?r[e](t,n):i[e](t,n)}return i=(0, o.default)(e).getInstance(),{registerUrlRegex:function(e,t){a.push({regex:e,utils:t});},parseBaseUrl:function(e){return n("parseBaseUrl",e)},parseOrigin:function(e){return n("parseOrigin",e)},parseScheme:function(e){return n("parseScheme",e)},isRelative:function(e){return n("isRelative",e)},isPathAbsolute:function(e){return n("isPathAbsolute",e)},isSchemeRelative:function(e){return n("isSchemeRelative",e)},isHTTPURL:function(e){return n("isHTTPURL",e)},isHTTPS:function(e){return n("isHTTPS",e)},removeHostname:function(e){return n("removeHostname",e)},resolve:function(e,t){return n("resolve",e,t)}}}a.__dashjs_factory_name="URLUtils";var s=i.default.getSingletonFactory(a);n.default=s,t.exports=n.default;},{210:210,47:47}],221:[function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(47)),a=r(e(45));function o(){var e=this.context,t=void 0,p=void 0,g=void 0,_=void 0,E=void 0,m=void 0;function v(e){var t=e.split(":"),n=t.length-1;return e=60*parseInt(t[n-1],10)+parseFloat(t[n]),2==n&&(e+=3600*parseInt(t[0],10)),e}return t={parse:function(e){var t,n=[],r=void 0;if(!e)return n;t=(e=e.split(g)).length,r=-1;for(var i,a,o=0;o<t;o++){var s,u,l,d,f,c,h=e[o];0<h.length&&"WEBVTT"!==h&&h.match(_)&&(a=i=void 0,i=h.split(_),(a=i[1].split(m)).shift(),i[1]=a[0],a.shift(),u=(s={cuePoints:i,styles:function(e){var n={};return e.forEach(function(e){var t;1<e.split(/:/).length&&((t=e.split(/:/)[1])&&-1!=t.search(/%/)&&(t=parseInt(t.replace(/%/,""),10)),(e.match(/align/)||e.match(/A/))&&(n.align=t),(e.match(/line/)||e.match(/L/))&&(n.line=t),(e.match(/position/)||e.match(/P/))&&(n.position=t),(e.match(/size/)||e.match(/S/))&&(n.size=t));}),n}(a)}).cuePoints,l=s.styles,d=function(e,t){var n,r=t,i="",a="";for(;""!==e[r]&&r<e.length;)r++;if(1<(n=r-t))for(var o=0;o<n;o++){if((a=e[t+o]).match(_)){i="";break}i+=a,o!==n-1&&(i+="\n");}else (a=e[t]).match(_)||(i=a);return i}(e,o+1),f=v(u[0].replace(E,"")),c=v(u[1].replace(E,"")),!isNaN(f)&&!isNaN(c)&&r<=f&&f<c?""!==d?(r=f,n.push({start:f,end:c,data:d,styles:l})):p.error("Skipping cue due to empty/malformed cue text"):p.error("Skipping cue due to incorrect cue timing"));}return n}},p=(0, a.default)(e).getInstance().getLogger(t),g=/(?:\r\n|\r|\n)/gm,_=/-->/,E=/(^[\s]+|[\s]+$)/g,m=/\s\b/g,t}o.__dashjs_factory_name="VTTParser",n.default=i.default.getSingletonFactory(o),t.exports=n.default;},{45:45,47:47}],222:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(47),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var r=(e=e||{}).blacklistController;return {select:function(e){var n=0,t=void 0;return e&&e.some(function(e,t){return n=t,!r.contains(e.serviceLocation)})&&(t=e[n]),t}}}o.__dashjs_factory_name="BasicSelector",n.default=a.default.getClassFactory(o),t.exports=n.default;},{47:47}],223:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(47),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var n=(e=e||{}).blacklistController;return {select:function(e){return e&&function(e){var t=0,n=[],r=0,i=void 0,a=void 0;if((a=e.sort(function(e,t){var n=e.dvb_priority-t.dvb_priority;return isNaN(n)?0:n}).filter(function(e,t,n){return !t||n[0].dvb_priority&&e.dvb_priority&&n[0].dvb_priority===e.dvb_priority})).length)return 1<a.length&&(a.forEach(function(e){t+=e.dvb_weight,n.push(t);}),i=Math.floor(Math.random()*(t-1)),n.every(function(e,t){return r=t,!(i<e)})),a[r]}((t=[],e.filter(function(e){return !n.contains(e.serviceLocation)||(e.dvb_priority&&t.push(e.dvb_priority),!1)}).filter(function(e){return !t.length||!e.dvb_priority||-1===t.indexOf(e.dvb_priority)})));var t;}}}o.__dashjs_factory_name="DVBSelector",n.default=a.default.getClassFactory(o),t.exports=n.default;},{47:47}],224:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.scanType=null,this.qualityIndex=NaN;},t.exports=n.default;},{}],225:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.code=t||null,this.message=n||null,this.data=r||null;},t.exports=n.default;},{}],226:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null;},t.exports=n.default;},{}],227:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){return t&&i(e.prototype,t),e};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}var a=e(241),o=(r(s,[{key:"isInitializationRequest",value:function(){return this.type&&this.type===a.HTTPRequest.INIT_SEGMENT_TYPE}},{key:"setInfo",value:function(e){this.type=e&&e.init?a.HTTPRequest.INIT_SEGMENT_TYPE:a.HTTPRequest.MEDIA_SEGMENT_TYPE,this.url=e&&e.url?e.url:null,this.range=e&&e.range?e.range.start+"-"+e.range.end:null,this.mediaType=e&&e.mediaType?e.mediaType:null;}}]),s);function s(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),this.action=s.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=e||null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null;}o.ACTION_DOWNLOAD="download",o.ACTION_COMPLETE="complete",n.default=o,t.exports=n.default;},{241:241}],228:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n,r=!1;null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0;}};var i,a=e(227),o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);}(s,((i=a)&&i.__esModule?i:{default:i}).default),s);function s(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),r(Object.getPrototypeOf(s.prototype),"constructor",this).call(this,e),this.checkForExistenceOnly=!0;}n.default=o,t.exports=n.default;},{227:227}],229:[function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}Object.defineProperty(n,"__esModule",{value:!0});var i=(function(e,t,n){return t&&r(e.prototype,t),e}(a,[{key:"getChildBox",value:function(e){for(var t=0;t<this.boxes.length;t++)if(this.boxes[t].type===e)return this.boxes[t]}},{key:"getChildBoxes",value:function(e){for(var t=[],n=0;n<this.boxes.length;n++)this.boxes[n].type===e&&t.push(this.boxes[n]);return t}}]),a);function a(e){if(!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this.offset=e._offset,this.type=e.type,this.size=e.size,this.boxes=[],e.boxes)for(var t=0;t<e.boxes.length;t++)this.boxes.push(new a(e.boxes[t]));switch(this.isComplete=!0,e.type){case"sidx":if(this.timescale=e.timescale,this.earliest_presentation_time=e.earliest_presentation_time,this.first_offset=e.first_offset,this.references=e.references,e.references){this.references=[];for(t=0;t<e.references.length;t++){var n={reference_type:e.references[t].reference_type,referenced_size:e.references[t].referenced_size,subsegment_duration:e.references[t].subsegment_duration};this.references.push(n);}}break;case"emsg":this.id=e.id,this.value=e.value,this.timescale=e.timescale,this.scheme_id_uri=e.scheme_id_uri,this.presentation_time_delta=1===e.version?e.presentation_time:e.presentation_time_delta,this.event_duration=e.event_duration,this.message_data=e.message_data;break;case"mdhd":this.timescale=e.timescale;break;case"mfhd":this.sequence_number=e.sequence_number;break;case"subs":this.entry_count=e.entry_count,this.entries=e.entries;break;case"tfhd":this.base_data_offset=e.base_data_offset,this.sample_description_index=e.sample_description_index,this.default_sample_duration=e.default_sample_duration,this.default_sample_size=e.default_sample_size,this.default_sample_flags=e.default_sample_flags,this.flags=e.flags;break;case"tfdt":this.version=e.version,this.baseMediaDecodeTime=e.baseMediaDecodeTime,this.flags=e.flags;break;case"trun":if(this.sample_count=e.sample_count,this.first_sample_flags=e.first_sample_flags,this.data_offset=e.data_offset,this.flags=e.flags,this.samples=e.samples,e.samples){this.samples=[];for(var t=0,r=e.samples.length;t<r;t++){var i={sample_size:e.samples[t].sample_size,sample_duration:e.samples[t].sample_duration,sample_composition_time_offset:e.samples[t].sample_composition_time_offset};this.samples.push(i);}}}}n.default=i,t.exports=n.default;},{}],230:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lastCompletedOffset=t,this.found=n,this.size=r;},t.exports=n.default;},{}],231:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[];},t.exports=n.default;},{}],232:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n,r=!1;null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0;}};function i(e){return e&&e.__esModule?e:{default:e}}var a=i(e(108)),o=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);}(s,i(e(227)).default),s);function s(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),r(Object.getPrototypeOf(s.prototype),"constructor",this).call(this),this.url=e||null,this.type=t||null,this.mediaType=a.default.STREAM,this.responseType="";}n.default=o,t.exports=n.default;},{108:108,227:227}],233:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.captionData=null,this.label=null,this.lang=null,this.defaultTrack=!1,this.kind=null,this.isFragmented=!1,this.isEmbedded=!1;},t.exports=n.default;},{}],234:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=null,this.width=null,this.height=null,this.x=null,this.y=null;},t.exports=n.default;},{}],235:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bitrate=0,this.width=0,this.height=0,this.tilesHor=0,this.tilesVert=0,this.widthPerTile=0,this.heightPerTile=0,this.startNumber=0,this.segmentDuration=0,this.timescale=0,this.templateUrl="",this.id="";},t.exports=n.default;},{}],236:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null;},t.exports=n.default;},{}],237:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.level=null;},t.exports=n.default;},{}],238:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e(109),a=(r=i)&&r.__esModule?r:{default:r};n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.target=null,this.state=a.default.BUFFER_EMPTY;},t.exports=n.default;},{109:109}],239:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=null,this.range=null,this.manifestInfo=null;},t.exports=n.default;},{}],240:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=null,this.droppedFrames=null;},t.exports=n.default;},{}],241:[function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});function i(){r(this,i),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this._stream=null,this._tfinish=null,this._mediaduration=null,this._quality=null,this._responseHeaders=null,this._serviceLocation=null;}i.GET="GET",i.HEAD="HEAD",i.MPD_TYPE="MPD",i.XLINK_EXPANSION_TYPE="XLinkExpansion",i.INIT_SEGMENT_TYPE="InitializationSegment",i.INDEX_SEGMENT_TYPE="IndexSegment",i.MEDIA_SEGMENT_TYPE="MediaSegment",i.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",i.OTHER_TYPE="other",n.HTTPRequest=i,n.HTTPRequestTrace=function e(){r(this,e),this.s=null,this.d=null,this.b=[];};},{}],242:[function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});n.ManifestUpdate=function e(){r(this,e),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.representationInfo=[];},n.ManifestUpdateStreamInfo=function e(){r(this,e),this.id=null,this.index=null,this.start=null,this.duration=null;},n.ManifestUpdateRepresentationInfo=function e(){r(this,e),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null;};},{}],243:[function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});function i(){r(this,i),this.start=null,this.mstart=null,this.starttype=null,this.trace=[];}i.INITIAL_PLAYOUT_START_REASON="initial_playout",i.SEEK_START_REASON="seek",i.RESUME_FROM_PAUSE_START_REASON="resume",i.METRICS_COLLECTION_START_REASON="metrics_collection_start";function a(){r(this,a),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null;}a.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",a.REBUFFERING_REASON="rebuffering",a.USER_REQUEST_STOP_REASON="user_request",a.END_OF_PERIOD_STOP_REASON="end_of_period",a.END_OF_CONTENT_STOP_REASON="end_of_content",a.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",a.FAILURE_STOP_REASON="failure",n.PlayList=i,n.PlayListTrace=a;},{}],244:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.mt=null,this.to=null,this.lto=null;},t.exports=n.default;},{}],245:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loadingRequests=[],this.executedRequests=[];},t.exports=n.default;},{}],246:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null;},t.exports=n.default;},{}]},{},[4]);

// MSS support
!function a(o,s,u){function l(t,e){if(!s[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(f)return f(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var i=s[t]={exports:{}};o[t][0].call(i.exports,function(e){return l(o[t][1][e]||e)},i,i.exports,a,o,s,u);}return s[t].exports}for(var f="function"==typeof require&&require,e=0;e<u.length;e++)l(u[e]);return l}({1:[function(e,t,r){var W=function(u){var v=1e7,p=7,t=9007199254740992,r=b(t),d="0123456789abcdefghijklmnopqrstuvwxyz",c="function"==typeof BigInt;function h(e,t,r,n){return void 0===e?h[0]:void 0!==t&&(10!=+t||r)?Y(e,t,r,n):J(e)}function m(e,t){this.value=e,this.sign=t,this.isSmall=!1;}function g(e){this.value=e,this.sign=e<0,this.isSmall=!0;}function y(e){this.value=e;}function _(e){return -t<e&&e<t}function b(e){return e<1e7?[e]:e<1e14?[e%1e7,Math.floor(e/1e7)]:[e%1e7,Math.floor(e/1e7)%1e7,Math.floor(e/1e14)]}function T(e){A(e);var t=e.length;if(t<4&&O(e,r)<0)switch(t){case 0:return 0;case 1:return e[0];case 2:return e[0]+e[1]*v;default:return e[0]+(e[1]+e[2]*v)*v}return e}function A(e){for(var t=e.length;0===e[--t];);e.length=t+1;}function S(e){for(var t=new Array(e),r=-1;++r<e;)t[r]=0;return t}function E(e){return 0<e?Math.floor(e):Math.ceil(e)}function n(e,t){for(var r,n=e.length,i=t.length,a=new Array(n),o=0,s=v,u=0;u<i;u++)o=s<=(r=e[u]+t[u]+o)?1:0,a[u]=r-o*s;for(;u<n;)o=(r=e[u]+o)===s?1:0,a[u++]=r-o*s;return 0<o&&a.push(o),a}function w(e,t){return e.length>=t.length?n(e,t):n(t,e)}function i(e,t){for(var r,n=e.length,i=new Array(n),a=v,o=0;o<n;o++)r=e[o]-a+t,t=Math.floor(r/a),i[o]=r-t*a,t+=1;for(;0<t;)i[o++]=t%a,t=Math.floor(t/a);return i}function M(e,t){for(var r,n=e.length,i=t.length,a=new Array(n),o=0,s=v,u=0;u<i;u++)o=(r=e[u]-o-t[u])<0?(r+=s,1):0,a[u]=r;for(u=i;u<n;u++){if(!((r=e[u]-o)<0)){a[u++]=r;break}r+=s,a[u]=r;}for(;u<n;u++)a[u]=e[u];return A(a),a}function l(e,t,r){for(var n,i=e.length,a=new Array(i),o=-t,s=v,u=0;u<i;u++)n=e[u]+o,o=Math.floor(n/s),n%=s,a[u]=n<0?n+s:n;return "number"==typeof(a=T(a))?(r&&(a=-a),new g(a)):new m(a,r)}function I(e,t){for(var r,n,i,a=e.length,o=t.length,s=S(a+o),u=v,l=0;l<a;++l){i=e[l];for(var f=0;f<o;++f)r=i*t[f]+s[l+f],n=Math.floor(r/u),s[l+f]=r-n*u,s[l+f+1]+=n;}return A(s),s}function D(e,t){for(var r,n=e.length,i=new Array(n),a=v,o=0,s=0;s<n;s++)r=e[s]*t+o,o=Math.floor(r/a),i[s]=r-o*a;for(;0<o;)i[s++]=o%a,o=Math.floor(o/a);return i}function P(e,t){for(var r=[];0<t--;)r.push(0);return r.concat(e)}function a(e,t,r){return new m(e<v?D(t,e):I(t,b(e)),r)}function o(e){for(var t,r,n,i=e.length,a=S(i+i),o=v,s=0;s<i;s++){r=0-(n=e[s])*n;for(var u=s;u<i;u++)t=n*e[u]*2+a[s+u]+r,r=Math.floor(t/o),a[s+u]=t-r*o;a[s+i]=r;}return A(a),a}function C(e,t){for(var r,n,i=e.length,a=S(i),o=v,s=0,u=i-1;0<=u;--u)s=(n=s*o+e[u])-(r=E(n/t))*t,a[u]=0|r;return [a,0|s]}function x(e,t){var r,n=J(t);if(c)return [new y(e.value/n.value),new y(e.value%n.value)];var i=e.value,a=n.value;if(0===a)throw new Error("Cannot divide by zero");if(e.isSmall)return n.isSmall?[new g(E(i/a)),new g(i%a)]:[h[0],e];if(n.isSmall){if(1===a)return [e,h[0]];if(-1==a)return [e.negate(),h[0]];var o=Math.abs(a);if(o<v){l=T((r=C(i,o))[0]);var s=r[1];return e.sign&&(s=-s),"number"==typeof l?(e.sign!==n.sign&&(l=-l),[new g(l),new g(s)]):[new m(l,e.sign!==n.sign),new g(s)]}a=b(o);}var u=O(i,a);if(-1===u)return [h[0],e];if(0===u)return [h[e.sign===n.sign?1:-1],h[0]];l=(r=(i.length+a.length<=200?function(e,t){var r,n,i,a,o,s,u,l=e.length,f=t.length,p=v,d=S(t.length),c=t[f-1],h=Math.ceil(p/(2*c)),m=D(e,h),g=D(t,h);for(m.length<=l&&m.push(0),g.push(0),c=g[f-1],n=l-f;0<=n;n--){for(r=p-1,m[n+f]!==c&&(r=Math.floor((m[n+f]*p+m[n+f-1])/c)),a=i=0,s=g.length,o=0;o<s;o++)i+=r*g[o],u=Math.floor(i/p),a+=m[n+o]-(i-u*p),i=u,a=a<0?(m[n+o]=a+p,-1):(m[n+o]=a,0);for(;0!==a;){for(--r,o=i=0;o<s;o++)i=(i+=m[n+o]-p+g[o])<0?(m[n+o]=i+p,0):(m[n+o]=i,1);a+=i;}d[n]=r;}return m=C(m,h)[0],[T(d),T(m)]}:function(e,t){for(var r,n,i,a,o,s=e.length,u=t.length,l=[],f=[],p=v;s;)if(f.unshift(e[--s]),A(f),O(f,t)<0)l.push(0);else {i=f[(n=f.length)-1]*p+f[n-2],a=t[u-1]*p+t[u-2],u<n&&(i=(i+1)*p),r=Math.ceil(i/a);do{if(O(o=D(t,r),f)<=0)break;r--;}while(r);l.push(r),f=M(f,o);}return l.reverse(),[T(l),T(f)]})(i,a))[0];var l,f=e.sign!==n.sign,p=r[1],d=e.sign;return [l="number"==typeof l?(f&&(l=-l),new g(l)):new m(l,f),p="number"==typeof p?(d&&(p=-p),new g(p)):new m(p,d)]}function O(e,t){if(e.length!==t.length)return e.length>t.length?1:-1;for(var r=e.length-1;0<=r;r--)if(e[r]!==t[r])return e[r]>t[r]?1:-1;return 0}function f(e){var t=e.abs();return !t.isUnit()&&(!!(t.equals(2)||t.equals(3)||t.equals(5))||!(t.isEven()||t.isDivisibleBy(3)||t.isDivisibleBy(5))&&(!!t.lesser(49)||void 0))}function N(e,t){for(var r,n,i,a=e.prev(),o=a,s=0;o.isEven();)o=o.divide(2),s++;e:for(n=0;n<t.length;n++)if(!e.lesser(t[n])&&!(i=W(t[n]).modPow(o,e)).isUnit()&&!i.equals(a)){for(r=s-1;0!=r;r--){if((i=i.square().mod(e)).isUnit())return !1;if(i.equals(a))continue e}return !1}return !0}m.prototype=Object.create(h.prototype),g.prototype=Object.create(h.prototype),y.prototype=Object.create(h.prototype),m.prototype.plus=m.prototype.add=function(e){var t=J(e);if(this.sign!==t.sign)return this.subtract(t.negate());var r=this.value,n=t.value;return t.isSmall?new m(i(r,Math.abs(n)),this.sign):new m(w(r,n),this.sign)},g.prototype.plus=g.prototype.add=function(e){var t=J(e),r=this.value;if(r<0!==t.sign)return this.subtract(t.negate());var n=t.value;if(t.isSmall){if(_(r+n))return new g(r+n);n=b(Math.abs(n));}return new m(i(n,Math.abs(r)),r<0)},y.prototype.plus=y.prototype.add=function(e){return new y(this.value+J(e).value)},m.prototype.minus=m.prototype.subtract=function(e){var t=J(e);if(this.sign!==t.sign)return this.add(t.negate());var r,n,i,a,o=this.value,s=t.value;return t.isSmall?l(o,Math.abs(s),this.sign):(r=o,n=s,i=this.sign,0<=O(r,n)?a=M(r,n):(a=M(n,r),i=!i),"number"==typeof(a=T(a))?(i&&(a=-a),new g(a)):new m(a,i))},g.prototype.minus=g.prototype.subtract=function(e){var t=J(e),r=this.value;if(r<0!==t.sign)return this.add(t.negate());var n=t.value;return t.isSmall?new g(r-n):l(n,Math.abs(r),0<=r)},y.prototype.minus=y.prototype.subtract=function(e){return new y(this.value-J(e).value)},m.prototype.negate=function(){return new m(this.value,!this.sign)},g.prototype.negate=function(){var e=this.sign,t=new g(-this.value);return t.sign=!e,t},y.prototype.negate=function(){return new y(-this.value)},m.prototype.abs=function(){return new m(this.value,!1)},g.prototype.abs=function(){return new g(Math.abs(this.value))},y.prototype.abs=function(){return new y(0<=this.value?this.value:-this.value)},m.prototype.times=m.prototype.multiply=function(e){var t,r,n,i=J(e),a=this.value,o=i.value,s=this.sign!==i.sign;if(i.isSmall){if(0===o)return h[0];if(1===o)return this;if(-1===o)return this.negate();if((t=Math.abs(o))<v)return new m(D(a,t),s);o=b(t);}return r=a.length,n=o.length,new m((0<-.012*r-.012*n+15e-6*r*n?function e(t,r){var n=Math.max(t.length,r.length);if(n<=30)return I(t,r);n=Math.ceil(n/2);var i=t.slice(n),a=t.slice(0,n),o=r.slice(n),s=r.slice(0,n),u=e(a,s),l=e(i,o),f=e(w(a,i),w(s,o)),p=w(w(u,P(M(M(f,u),l),n)),P(l,2*n));return A(p),p}:I)(a,o),s)},g.prototype._multiplyBySmall=function(e){return _(e.value*this.value)?new g(e.value*this.value):a(Math.abs(e.value),b(Math.abs(this.value)),this.sign!==e.sign)},m.prototype._multiplyBySmall=function(e){return 0===e.value?h[0]:1===e.value?this:-1===e.value?this.negate():a(Math.abs(e.value),this.value,this.sign!==e.sign)},g.prototype.times=g.prototype.multiply=function(e){return J(e)._multiplyBySmall(this)},y.prototype.times=y.prototype.multiply=function(e){return new y(this.value*J(e).value)},m.prototype.square=function(){return new m(o(this.value),!1)},g.prototype.square=function(){var e=this.value*this.value;return _(e)?new g(e):new m(o(b(Math.abs(this.value))),!1)},y.prototype.square=function(e){return new y(this.value*this.value)},y.prototype.divmod=g.prototype.divmod=m.prototype.divmod=function(e){var t=x(this,e);return {quotient:t[0],remainder:t[1]}},m.prototype.divide=function(e){return x(this,e)[0]},y.prototype.over=y.prototype.divide=function(e){return new y(this.value/J(e).value)},g.prototype.over=g.prototype.divide=m.prototype.over=m.prototype.divide,m.prototype.mod=function(e){return x(this,e)[1]},y.prototype.mod=y.prototype.remainder=function(e){return new y(this.value%J(e).value)},g.prototype.remainder=g.prototype.mod=m.prototype.remainder=m.prototype.mod,m.prototype.pow=function(e){var t,r,n,i=J(e),a=this.value,o=i.value;if(0===o)return h[1];if(0===a)return h[0];if(1===a)return h[1];if(-1===a)return i.isEven()?h[1]:h[-1];if(i.sign)return h[0];if(!i.isSmall)throw new Error("The exponent "+i.toString()+" is too large.");if(this.isSmall&&_(t=Math.pow(a,o)))return new g(E(t));for(r=this,n=h[1];!0&o&&(n=n.times(r),--o),0!==o;)o/=2,r=r.square();return n},g.prototype.pow=m.prototype.pow,y.prototype.pow=function(e){var t=J(e),r=this.value,n=t.value,i=BigInt(0),a=BigInt(1),o=BigInt(2);if(n===i)return h[1];if(r===i)return h[0];if(r===a)return h[1];if(r===BigInt(-1))return t.isEven()?h[1]:h[-1];if(t.isNegative())return new y(i);for(var s=this,u=h[1];(n&a)===a&&(u=u.times(s),--n),n!==i;)n/=o,s=s.square();return u},y.prototype.modPow=g.prototype.modPow=m.prototype.modPow=function(e,t){if(e=J(e),(t=J(t)).isZero())throw new Error("Cannot take modPow with modulus 0");for(var r=h[1],n=this.mod(t);e.isPositive();){if(n.isZero())return h[0];e.isOdd()&&(r=r.multiply(n).mod(t)),e=e.divide(2),n=n.square().mod(t);}return r},m.prototype.compareAbs=function(e){var t=J(e),r=this.value,n=t.value;return t.isSmall?1:O(r,n)},g.prototype.compareAbs=function(e){var t=J(e),r=Math.abs(this.value),n=t.value;return t.isSmall?r===(n=Math.abs(n))?0:n<r?1:-1:-1},y.prototype.compareAbs=function(e){var t=this.value,r=J(e).value;return (t=0<=t?t:-t)===(r=0<=r?r:-r)?0:r<t?1:-1},m.prototype.compareTo=m.prototype.compare=function(e){if(e===1/0)return -1;if(e===-1/0)return 1;var t=J(e),r=this.value,n=t.value;return this.sign!==t.sign?t.sign?1:-1:t.isSmall?this.sign?-1:1:O(r,n)*(this.sign?-1:1)},g.prototype.compareTo=g.prototype.compare=function(e){if(e===1/0)return -1;if(e===-1/0)return 1;var t=J(e),r=this.value,n=t.value;return t.isSmall?r==n?0:n<r?1:-1:r<0!==t.sign?r<0?-1:1:r<0?1:-1},y.prototype.compareTo=y.prototype.compare=function(e){if(e===1/0)return -1;if(e===-1/0)return 1;var t=this.value,r=J(e).value;return t===r?0:r<t?1:-1},y.prototype.eq=y.prototype.equals=g.prototype.eq=g.prototype.equals=m.prototype.eq=m.prototype.equals=function(e){return 0===this.compare(e)},y.prototype.neq=y.prototype.notEquals=g.prototype.neq=g.prototype.notEquals=m.prototype.neq=m.prototype.notEquals=function(e){return 0!==this.compare(e)},y.prototype.gt=y.prototype.greater=g.prototype.gt=g.prototype.greater=m.prototype.gt=m.prototype.greater=function(e){return 0<this.compare(e)},y.prototype.lt=y.prototype.lesser=g.prototype.lt=g.prototype.lesser=m.prototype.lt=m.prototype.lesser=function(e){return this.compare(e)<0},y.prototype.geq=y.prototype.greaterOrEquals=g.prototype.geq=g.prototype.greaterOrEquals=m.prototype.geq=m.prototype.greaterOrEquals=function(e){return 0<=this.compare(e)},y.prototype.leq=y.prototype.lesserOrEquals=g.prototype.leq=g.prototype.lesserOrEquals=m.prototype.leq=m.prototype.lesserOrEquals=function(e){return this.compare(e)<=0},m.prototype.isEven=function(){return 0==(1&this.value[0])},g.prototype.isEven=function(){return 0==(1&this.value)},y.prototype.isEven=function(){return (this.value&BigInt(1))===BigInt(0)},m.prototype.isOdd=function(){return 1==(1&this.value[0])},g.prototype.isOdd=function(){return 1==(1&this.value)},y.prototype.isOdd=function(){return (this.value&BigInt(1))===BigInt(1)},m.prototype.isPositive=function(){return !this.sign},y.prototype.isPositive=g.prototype.isPositive=function(){return 0<this.value},m.prototype.isNegative=function(){return this.sign},y.prototype.isNegative=g.prototype.isNegative=function(){return this.value<0},m.prototype.isUnit=function(){return !1},g.prototype.isUnit=function(){return 1===Math.abs(this.value)},y.prototype.isUnit=function(){return this.abs().value===BigInt(1)},m.prototype.isZero=function(){return !1},g.prototype.isZero=function(){return 0===this.value},y.prototype.isZero=function(){return this.value===BigInt(0)},y.prototype.isDivisibleBy=g.prototype.isDivisibleBy=m.prototype.isDivisibleBy=function(e){var t=J(e);return !t.isZero()&&(!!t.isUnit()||(0===t.compareAbs(2)?this.isEven():this.mod(t).isZero()))},y.prototype.isPrime=g.prototype.isPrime=m.prototype.isPrime=function(e){var t=f(this);if(t!==u)return t;var r=this.abs(),n=r.bitLength();if(n<=64)return N(r,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var i=Math.log(2)*n.toJSNumber(),a=Math.ceil(!0===e?2*Math.pow(i,2):i),o=[],s=0;s<a;s++)o.push(W(s+2));return N(r,o)},y.prototype.isProbablePrime=g.prototype.isProbablePrime=m.prototype.isProbablePrime=function(e){var t=f(this);if(t!==u)return t;for(var r=this.abs(),n=e===u?5:e,i=[],a=0;a<n;a++)i.push(W.randBetween(2,r.minus(2)));return N(r,i)},y.prototype.modInv=g.prototype.modInv=m.prototype.modInv=function(e){for(var t,r,n,i=W.zero,a=W.one,o=J(e),s=this.abs();!s.isZero();)t=o.divide(s),r=i,n=o,i=a,o=s,a=r.subtract(t.multiply(a)),s=n.subtract(t.multiply(s));if(!o.isUnit())throw new Error(this.toString()+" and "+e.toString()+" are not co-prime");return -1===i.compare(0)&&(i=i.add(e)),this.isNegative()?i.negate():i},m.prototype.next=function(){var e=this.value;return this.sign?l(e,1,this.sign):new m(i(e,1),this.sign)},g.prototype.next=function(){var e=this.value;return e+1<t?new g(e+1):new m(r,!1)},y.prototype.next=function(){return new y(this.value+BigInt(1))},m.prototype.prev=function(){var e=this.value;return this.sign?new m(i(e,1),!0):l(e,1,this.sign)},g.prototype.prev=function(){var e=this.value;return -t<e-1?new g(e-1):new m(r,!0)},y.prototype.prev=function(){return new y(this.value-BigInt(1))};for(var s=[1];2*s[s.length-1]<=v;)s.push(2*s[s.length-1]);var B=s.length,F=s[B-1];function R(e){return Math.abs(e)<=v}function L(e,t,r){t=J(t);for(var n=e.isNegative(),i=t.isNegative(),a=n?e.not():e,o=i?t.not():t,s=0,u=0,l=null,f=null,p=[];!a.isZero()||!o.isZero();)s=(l=x(a,F))[1].toJSNumber(),n&&(s=F-1-s),u=(f=x(o,F))[1].toJSNumber(),i&&(u=F-1-u),a=l[0],o=f[0],p.push(r(s,u));for(var d=0!==r(n?1:0,i?1:0)?W(-1):W(0),c=p.length-1;0<=c;--c)d=d.multiply(F).add(W(p[c]));return d}y.prototype.shiftLeft=g.prototype.shiftLeft=m.prototype.shiftLeft=function(e){var t=J(e).toJSNumber();if(!R(t))throw new Error(String(t)+" is too large for shifting.");if(t<0)return this.shiftRight(-t);var r=this;if(r.isZero())return r;for(;B<=t;)r=r.multiply(F),t-=B-1;return r.multiply(s[t])},y.prototype.shiftRight=g.prototype.shiftRight=m.prototype.shiftRight=function(e){var t,r=J(e).toJSNumber();if(!R(r))throw new Error(String(r)+" is too large for shifting.");if(r<0)return this.shiftLeft(-r);for(var n=this;B<=r;){if(n.isZero()||n.isNegative()&&n.isUnit())return n;n=(t=x(n,F))[1].isNegative()?t[0].prev():t[0],r-=B-1;}return (t=x(n,s[r]))[1].isNegative()?t[0].prev():t[0]},y.prototype.not=g.prototype.not=m.prototype.not=function(){return this.negate().prev()},y.prototype.and=g.prototype.and=m.prototype.and=function(e){return L(this,e,function(e,t){return e&t})},y.prototype.or=g.prototype.or=m.prototype.or=function(e){return L(this,e,function(e,t){return e|t})},y.prototype.xor=g.prototype.xor=m.prototype.xor=function(e){return L(this,e,function(e,t){return e^t})};var q=1<<30,U=(v&-v)*(v&-v)|q;function j(e){var t=e.value,r="number"==typeof t?t|q:"bigint"==typeof t?t|BigInt(q):t[0]+t[1]*v|U;return r&-r}function k(e,t){return e=J(e),t=J(t),e.greater(t)?e:t}function G(e,t){return e=J(e),t=J(t),e.lesser(t)?e:t}function H(e,t){if(e=J(e).abs(),t=J(t).abs(),e.equals(t))return e;if(e.isZero())return t;if(t.isZero())return e;for(var r,n,i=h[1];e.isEven()&&t.isEven();)r=G(j(e),j(t)),e=e.divide(r),t=t.divide(r),i=i.multiply(r);for(;e.isEven();)e=e.divide(j(e));do{for(;t.isEven();)t=t.divide(j(t));e.greater(t)&&(n=t,t=e,e=n),t=t.subtract(e);}while(!t.isZero());return i.isUnit()?e:e.multiply(i)}y.prototype.bitLength=g.prototype.bitLength=m.prototype.bitLength=function(){var e=this;return e.compareTo(W(0))<0&&(e=e.negate().subtract(W(1))),0===e.compareTo(W(0))?W(0):W(function e(t,r){if(r.compareTo(t)<=0){var n=e(t,r.square(r)),i=n.p,a=n.e,o=i.multiply(r);return o.compareTo(t)<=0?{p:o,e:2*a+1}:{p:i,e:2*a}}return {p:W(1),e:0}}(e,W(2)).e).add(W(1))};var Y=function(e,t,r,n){r=r||d,e=String(e),n||(e=e.toLowerCase(),r=r.toLowerCase());for(var i=e.length,a=Math.abs(t),o={},s=0;s<r.length;s++)o[r[s]]=s;for(s=0;s<i;s++){if("-"!==(u=e[s])&&(u in o&&o[u]>=a)){if("1"===u&&1===a)continue;throw new Error(u+" is not a valid digit in base "+t+".")}}t=J(t);var u,l=[],f="-"===e[0];for(s=f?1:0;s<e.length;s++){if((u=e[s])in o)l.push(J(o[u]));else {if("<"!==u)throw new Error(u+" is not a valid character");for(var p=s;">"!==e[++s]&&s<e.length;);l.push(J(e.slice(p+1,s)));}}return K(l,t,f)};function K(e,t,r){for(var n=h[0],i=h[1],a=e.length-1;0<=a;a--)n=n.add(e[a].times(i)),i=i.times(t);return r?n.negate():n}function z(e,t){if((t=W(t)).isZero()){if(e.isZero())return {value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(t.equals(-1)){if(e.isZero())return {value:[0],isNegative:!1};if(e.isNegative())return {value:[].concat.apply([],Array.apply(null,Array(-e.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var r=Array.apply(null,Array(e.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return r.unshift([1]),{value:[].concat.apply([],r),isNegative:!1}}var n=!1;if(e.isNegative()&&t.isPositive()&&(n=!0,e=e.abs()),t.isUnit())return e.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(e.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:n};for(var i,a=[],o=e;o.isNegative()||0<=o.compareAbs(t);){o=(i=o.divmod(t)).quotient;var s=i.remainder;s.isNegative()&&(s=t.minus(s).abs(),o=o.next()),a.push(s.toJSNumber());}return a.push(o.toJSNumber()),{value:a.reverse(),isNegative:n}}function V(e,t,n){var r=z(e,t);return (r.isNegative?"-":"")+r.value.map(function(e){return (t=e)<(r=(r=n)||d).length?r[t]:"<"+t+">";var t,r;}).join("")}function Z(e){if(_(+e)){var t=+e;if(t===E(t))return c?new y(BigInt(t)):new g(t);throw new Error("Invalid integer: "+e)}var r="-"===e[0];r&&(e=e.slice(1));var n=e.split(/e/i);if(2<n.length)throw new Error("Invalid integer: "+n.join("e"));if(2===n.length){var i=n[1];if("+"===i[0]&&(i=i.slice(1)),(i=+i)!==E(i)||!_(i))throw new Error("Invalid integer: "+i+" is not a valid exponent.");var a=n[0],o=a.indexOf(".");if(0<=o&&(i-=a.length-o-1,a=a.slice(0,o)+a.slice(o+1)),i<0)throw new Error("Cannot include negative exponent part for integers");e=a+=new Array(i+1).join("0");}if(!/^([0-9][0-9]*)$/.test(e))throw new Error("Invalid integer: "+e);if(c)return new y(BigInt(r?"-"+e:e));for(var s=[],u=e.length,l=p,f=u-l;0<u;)s.push(+e.slice(f,u)),(f-=l)<0&&(f=0),u-=l;return A(s),new m(s,r)}function J(e){return "number"==typeof e?function(e){if(c)return new y(BigInt(e));if(_(e)){if(e!==E(e))throw new Error(e+" is not an integer.");return new g(e)}return Z(e.toString())}(e):"string"==typeof e?Z(e):"bigint"==typeof e?new y(e):e}m.prototype.toArray=function(e){return z(this,e)},g.prototype.toArray=function(e){return z(this,e)},y.prototype.toArray=function(e){return z(this,e)},m.prototype.toString=function(e,t){if(e===u&&(e=10),10!==e)return V(this,e,t);for(var r,n=this.value,i=n.length,a=String(n[--i]);0<=--i;)r=String(n[i]),a+="0000000".slice(r.length)+r;return (this.sign?"-":"")+a},y.prototype.toString=g.prototype.toString=function(e,t){return e===u&&(e=10),10!=e?V(this,e,t):String(this.value)},y.prototype.toJSON=m.prototype.toJSON=g.prototype.toJSON=function(){return this.toString()},m.prototype.toJSNumber=m.prototype.valueOf=function(){return parseInt(this.toString(),10)},g.prototype.toJSNumber=g.prototype.valueOf=function(){return this.value},y.prototype.valueOf=y.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var e=0;e<1e3;e++)h[e]=J(e),0<e&&(h[-e]=J(-e));return h.one=h[1],h.zero=h[0],h.minusOne=h[-1],h.max=k,h.min=G,h.gcd=H,h.lcm=function(e,t){return e=J(e).abs(),t=J(t).abs(),e.divide(H(e,t)).multiply(t)},h.isInstance=function(e){return e instanceof m||e instanceof g||e instanceof y},h.randBetween=function(e,t){var r=G(e=J(e),t=J(t)),n=k(e,t).subtract(r).add(1);if(n.isSmall)return r.add(Math.floor(Math.random()*n));for(var i=z(n,v).value,a=[],o=!0,s=0;s<i.length;s++){var u=o?i[s]:v,l=E(Math.random()*u);a.push(l),l<u&&(o=!1);}return r.add(h.fromArray(a,v,!1))},h.fromArray=function(e,t,r){return K(e.map(J),J(t||10),r)},h}();void 0!==t&&t.hasOwnProperty("exports")&&(t.exports=W),"function"==typeof define&&define.amd&&define("big-integer",[],function(){return W});},{}],2:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var u,a,n,i,o=(u=void 0,a=[],n={},i={},u={extend:function(e,t,r,n){!n[e]&&t&&(n[e]={instance:t,override:r});},getSingletonInstance:s,setSingletonInstance:function(e,t,r){for(var n in a){var i=a[n];if(i.context===e&&i.name===t)return void(a[n].instance=r)}a.push({name:t,context:e,instance:r});},getSingletonFactory:function(r){var e=l(r.__dashjs_factory_name,n);return e||(e=function(e){var t=void 0;return void 0===e&&(e={}),{getInstance:function(){return (t=t||s(e,r.__dashjs_factory_name))||(t=p(r,e,arguments),a.push({name:r.__dashjs_factory_name,context:e,instance:t})),t}}},n[r.__dashjs_factory_name]=e),e},getSingletonFactoryByName:function(e){return l(e,n)},updateSingletonFactory:function(e,t){f(e,t,n);},getClassFactory:function(t){var e=l(t.__dashjs_factory_name,i);return e||(e=function(e){return void 0===e&&(e={}),{create:function(){return p(t,e,arguments)}}},i[t.__dashjs_factory_name]=e),e},getClassFactoryByName:function(e){return l(e,i)},updateClassFactory:function(e,t){f(e,t,i);}});function s(e,t){for(var r in a){var n=a[r];if(n.context===e&&n.name===t)return n.instance}return null}function l(e,t){return t[e]}function f(e,t,r){e in r&&(r[e]=t);}function p(e,t,r){var n=void 0,i=e.__dashjs_factory_name,a=t[i];if(a){var o=a.instance;if(!a.override)return o.apply({context:t,factory:u},r);for(var s in n=e.apply({context:t},r),o=o.apply({context:t,factory:u,parent:n},r))n.hasOwnProperty(s)&&(n[s]=o[s]);}else n=e.apply({context:t},r);return n.getClassName=function(){return i},n}r.default=o,t.exports=r.default;},{}],3:[function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n);}}Object.defineProperty(r,"__esModule",{value:!0});var i=(function(e,t,r){return t&&n(e.prototype,t),e}(a,[{key:"extend",value:function(e,t){if(e){var r=!!t&&t.override,n=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!r||n&&-1===e[i].indexOf("public_")||(this[i]=e[i]);}}}]),a);function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);}r.default=i,t.exports=r.default;},{}],4:[function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n);}}Object.defineProperty(r,"__esModule",{value:!0});var i=(function(e,t,r){return t&&n(e.prototype,t),e}(a,[{key:"extend",value:function(e,t){if(e){var r=!!t&&t.override,n=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!r||n&&-1===e[i].indexOf("public_")||(this[i]=e[i]);}}}]),a);function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);}r.default=i,t.exports=r.default;},{}],5:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,i=e(17),v=(n=i)&&n.__esModule?n:{default:n};function a(e){var t,l=void 0,f=void 0,p=void 0,d=void 0,a=void 0,o=void 0,s=void 0,c=void 0,h=(e=e||{}).streamProcessor,m=e.baseURLController,r=e.debug;function g(){p&&(l.debug("Stop"),clearTimeout(a),p=!1,s=o=null);}function u(){var e,t,r,n,i,a,o,s,u;p&&(n=(r=(t=(e=h.getRepresentationController().getCurrentRepresentation()).adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index]).SegmentTemplate.SegmentTimeline.S_asArray)[r.length-1],a=e,o=n,s=(i=t).SegmentTemplate.timescale,(u=new v.default).mediaType=d,u.type="FragmentInfoSegment",u.startTime=o.t/s,u.duration=o.d/s,u.timescale=s,u.quality=a.index,u.index=c++,u.mediaInfo=h.getMediaInfo(),u.adaptationIndex=a.adaptation.index,u.representationId=a.id,u.url=m.resolve(a.path).url+i.SegmentTemplate.media,u.url=u.url.replace("$Bandwidth$",a.bandwidth),u.url=u.url.replace("$Time$",o.tManifest?o.tManifest:o.t),u.url=u.url.replace("/Fragments(","/FragmentInfo("),function(e){if(h.getFragmentModel().isFragmentLoadedOrPending(e))return l.debug("End of timeline"),void g();f.executeRequest(e);}.call(this,u));}return t={initialize:function(){d=h.getType(),f=h.getFragmentModel(),p=!1,s=o=null;},controllerType:"MssFragmentInfoController",start:function(){p||(l.debug("Start"),p=!0,o=(new Date).getTime(),c=0,u());},fragmentInfoLoaded:function(e){var t,r,n,i;p&&(t=e.request,e.response?(s=s||t.startTime,n=((new Date).getTime()-o)/1e3,r=t.startTime+t.duration-s,i=Math.max(0,r-n),clearTimeout(a),a=setTimeout(function(){a=null,u();},1e3*i)):l.error("Load error",t.url));},getType:function(){return d},reset:function(){g();}},l=r.getLogger(t),t}a.__dashjs_factory_name="MssFragmentInfoController",r.default=dashjs.FactoryMaker.getClassFactory(a),t.exports=r.default;},{17:17}],6:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var w=n(e(15)),M=n(e(10)),I=n(e(13));function i(e){var t,y=void 0,i=void 0,a=(e=e||{}).dashMetrics,o=e.playbackController,_=e.errHandler,b=e.eventBus,T=e.ISOBoxer,r=e.debug;function A(e,t,r,n){var i=n.getRepresentationController(),a=i.getCurrentRepresentation(),o=a.adaptation.period.mpd.manifest,s=o.Period_asArray[a.adaptation.period.index].AdaptationSet_asArray[a.adaptation.index],u=s.SegmentTemplate.timescale;if(y=n.getType(),"dynamic"===o.type||o.timeShiftBufferDepth)if(t){var l,f,p=s.SegmentTemplate.SegmentTimeline.S,d=t.entry,c=void 0,h=void 0,m=null,g=0,v=null;if(0!==d.length&&(l=d[0],!("static"===o.type&&(c=p[0].tManifest?parseFloat(p[0].tManifest):p[0].t,l.fragment_absolute_time>c+o.timeShiftBufferDepth*u)))){if(c=p[p.length-1].tManifest?parseFloat(p[p.length-1].tManifest):p[p.length-1].t,l.fragment_absolute_time<=c)return h={start:p[0].t/u,end:r.baseMediaDecodeTime/u+e.duration},void S(e.mediaType,h,n.getStreamInfo().manifestInfo);if((m={}).t=l.fragment_absolute_time,m.d=l.fragment_duration,p[0].tManifest&&(m.t-=parseFloat(p[0].tManifest)-p[0].t,m.tManifest=l.fragment_absolute_time),p.push(m),"static"!==o.type){if(o.timeShiftBufferDepth&&0<o.timeShiftBufferDepth){for(g=(m=p[p.length-1]).t,v=Math.round((g-o.timeShiftBufferDepth*u)/u),m=p[0];Math.round(m.t/u)<v;)p.splice(0,1),m=p[0];h={start:p[0].t/u,end:r.baseMediaDecodeTime/u+e.duration},S(y,h,n.getStreamInfo().manifestInfo);}i.updateRepresentation(a,!0);}else "video"!==y||(f=((m=p[p.length-1]).t+m.d)/u)>a.adaptation.period.duration&&b.trigger(I.default.MANIFEST_VALIDITY_CHANGED,{sender:this,newDuration:f});}}else _.error(new w.default(M.default.MSS_NO_TFRF_CODE,M.default.MSS_NO_TFRF_MESSAGE));}function S(e,t,r){var n=a.getCurrentDVRInfo(e);(!n||t.end>n.range.end)&&(i.debug("Update DVR range: ["+t.start+" - "+t.end+"]"),a.addDVRInfo(e,o.getTime(),r,t));}function E(e,t){for(var r=8,n=0,n=0;n<e.boxes.length;n++){if(e.boxes[n].type===t)return r;r+=e.boxes[n].size;}return r}return t={convertFragment:function(e,t){var r=void 0,n=T.parseBuffer(e.response),i=n.fetch("tfhd");i.track_ID=e.request.mediaInfo.index+1;var a=n.fetch("tfdt"),o=n.fetch("traf");null===a&&((a=T.createFullBox("tfdt",o,i)).version=1,a.flags=0,a.baseMediaDecodeTime=Math.floor(e.request.startTime*e.request.timescale));var s=n.fetch("trun"),u=n.fetch("tfxd");u&&(u._parent.boxes.splice(u._parent.boxes.indexOf(u),1),u=null);var l=n.fetch("tfrf");A(e.request,l,a,t),l&&(l._parent.boxes.splice(l._parent.boxes.indexOf(l),1),l=null);var f=n.fetch("sepiff");if(null!==f){f.type="senc",f.usertype=void 0;var p=n.fetch("saio");if(null===p){(p=T.createFullBox("saio",o)).version=0,p.flags=0,p.entry_count=1,p.offset=[0];var d=T.createFullBox("saiz",o);if(d.version=0,d.flags=0,d.sample_count=f.sample_count,d.default_sample_info_size=0,d.sample_info_size=[],2&f.flags)for(r=0;r<f.sample_count;r+=1)d.sample_info_size[r]=10+6*f.entry[r].NumberOfEntries;else d.default_sample_info_size=8;}}i.flags&=16777214,i.flags|=131072,s.flags|=1;var c=n.fetch("moof"),h=c.getLength();s.data_offset=h+8;var m,g,v=n.fetch("saio");null!==v&&(m=E(c,"traf"),g=E(o,"senc"),v.offset[0]=m+g+16),e.response=n.write();},updateSegmentList:function(e,t){if(!e.response)throw new Error("e.response parameter is missing");var r=T.parseBuffer(e.response),n=r.fetch("tfhd");n.track_ID=e.request.mediaInfo.index+1;var i=r.fetch("tfdt"),a=r.fetch("traf");null===i&&((i=T.createFullBox("tfdt",a,n)).version=1,i.flags=0,i.baseMediaDecodeTime=Math.floor(e.request.startTime*e.request.timescale));var o=r.fetch("tfrf");A(e.request,o,i,t),o&&(o._parent.boxes.splice(o._parent.boxes.indexOf(o),1),o=null);},getType:function(){return y}},i=r.getLogger(t),y="",t}i.__dashjs_factory_name="MssFragmentMoofProcessor",r.default=dashjs.FactoryMaker.getClassFactory(i),t.exports=r.default;},{10:10,13:13,15:15}],7:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,i=e(10),B=(n=i)&&n.__esModule?n:{default:n};function a(e){var _=7,b=8,T=(e=e||{}).constants,A=e.ISOBoxer,S=e.protectionController,E=void 0,w=void 0,M=void 0,I=void 0,D=void 0,P=void 0;function i(e){var t,r,n=A.createBox("moov",e);t=n,(r=A.createFullBox("mvhd",t)).version=1,r.creation_time=0,r.modification_time=0,r.timescale=D,r.duration=E.duration===1/0?0x10000000000000000:Math.round(E.duration*D),r.rate=1,r.volume=1,r.reserved1=0,r.reserved2=[0,0],r.matrix=[1,0,0,0,1,0,0,0,16384],r.pre_defined=[0,0,0,0,0,0],r.next_track_ID=P+1;var i,a,o=A.createBox("trak",n);i=o,(a=A.createFullBox("tkhd",i)).version=1,a.flags=7,a.creation_time=0,a.modification_time=0,a.track_ID=P,a.reserved1=0,a.duration=E.duration===1/0?0x10000000000000000:Math.round(E.duration*D),a.reserved2=[0,0],a.layer=0,a.alternate_group=0,a.volume=1,a.reserved3=0,a.matrix=[1,0,0,0,1,0,0,0,16384],a.width=M.width,a.height=M.height;var s,u,l=A.createBox("mdia",o);s=l,(u=A.createFullBox("mdhd",s)).version=1,u.creation_time=0,u.modification_time=0,u.timescale=D,u.duration=E.duration===1/0?0x10000000000000000:Math.round(E.duration*D),u.language=w.lang||"und",u.pre_defined=0,function(e){var t=A.createFullBox("hdlr",e);switch(t.pre_defined=0,w.type){case T.VIDEO:t.handler_type="vide";break;case T.AUDIO:t.handler_type="soun";break;default:t.handler_type="meta";}t.name=M.id,t.reserved=[0,0,0];}(l);var f,p,d,c,h=A.createBox("minf",l);switch(w.type){case T.VIDEO:d=h,(c=A.createFullBox("vmhd",d)).flags=1,c.graphicsmode=0,c.opcolor=[0,0,0];break;case T.AUDIO:f=h,(p=A.createFullBox("smhd",f)).flags=1,p.balance=0,p.reserved=0;}!function(e){var t=A.createFullBox("dref",e);t.entry_count=1,t.entries=[];var r=A.createFullBox("url ",t,!1);r.location="",r.flags=1,t.entries.push(r);}(A.createBox("dinf",h));var m=A.createBox("stbl",h);A.createFullBox("stts",m)._data=[0,0,0,0,0,0,0,0],A.createFullBox("stsc",m)._data=[0,0,0,0,0,0,0,0],A.createFullBox("stco",m)._data=[0,0,0,0,0,0,0,0],A.createFullBox("stsz",m)._data=[0,0,0,0,0,0,0,0,0,0,0,0],function(e){var t=A.createFullBox("stsd",e);switch(t.entries=[],w.type){case T.VIDEO:case T.AUDIO:t.entries.push(function(e){var t=M.codecs.substring(0,M.codecs.indexOf("."));switch(t){case"avc1":return function(e,t){var r=void 0;r=I?A.createBox("encv",e,!1):A.createBox("avc1",e,!1);{var n;r.reserved1=[0,0,0,0,0,0],r.data_reference_index=1,r.pre_defined1=0,r.reserved2=0,r.pre_defined2=[0,0,0],r.height=M.height,r.width=M.width,r.horizresolution=72,r.vertresolution=72,r.reserved3=0,r.frame_count=1,r.compressorname=[10,65,86,67,32,67,111,100,105,110,103,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r.depth=24,r.pre_defined3=65535,r.config=function(){for(var e=null,t=15,r=[],n=[],i=0,a=0,o=0,s=M.codecPrivateData.split("00000001").slice(1),u=void 0,l=0;l<s.length;l++)switch(u=N(s[l]),31&u[0]){case _:r.push(u),t+=u.length+2;break;case b:n.push(u),t+=u.length+2;}0<r.length&&(i=r[0][1],o=r[0][2],a=r[0][3]);e=new Uint8Array(t);var f=0;e[f++]=(4278190080&t)>>24,e[f++]=(16711680&t)>>16,e[f++]=(65280&t)>>8,e[f++]=255&t,e.set([97,118,99,67],f),f+=4,e[f++]=1,e[f++]=i,e[f++]=o,e[f++]=a,e[f++]=255,e[f++]=224|r.length;for(var p=0;p<r.length;p++)e[f++]=(65280&r[p].length)>>8,e[f++]=255&r[p].length,e.set(r[p],f),f+=r[p].length;e[f++]=n.length;for(p=0;p<n.length;p++)e[f++]=(65280&n[p].length)>>8,e[f++]=255&n[p].length,e.set(n[p],f),f+=n[p].length;return e}(),I&&(C(n=A.createBox("sinf",r),t),x(n),O(n));}return r}(e,t);case"mp4a":return function(e,t){var r=void 0;r=I?A.createBox("enca",e,!1):A.createBox("mp4a",e,!1);{var n;r.reserved1=[0,0,0,0,0,0],r.data_reference_index=1,r.reserved2=[0,0],r.channelcount=M.audioChannels,r.samplesize=16,r.pre_defined=0,r.reserved_3=0,r.samplerate=M.audioSamplingRate<<16,r.esds=function(){var e=N(M.codecPrivateData),t=34+e.length,r=new Uint8Array(t),n=0;return r[n++]=(4278190080&t)>>24,r[n++]=(16711680&t)>>16,r[n++]=(65280&t)>>8,r[n++]=255&t,r.set([101,115,100,115],n),n+=4,r.set([0,0,0,0],n),n+=4,r[n++]=3,r[n++]=20+e.length,r[n++]=(65280&P)>>8,r[n++]=255&P,r[n++]=0,r[n++]=4,r[n++]=15+e.length,r[n++]=64,r[n]=20,r[n]|=0,r[n++]|=1,r[n++]=255,r[n++]=255,r[n++]=255,r[n++]=(4278190080&M.bandwidth)>>24,r[n++]=(16711680&M.bandwidth)>>16,r[n++]=(65280&M.bandwidth)>>8,r[n++]=255&M.bandwidth,r[n++]=(4278190080&M.bandwidth)>>24,r[n++]=(16711680&M.bandwidth)>>16,r[n++]=(65280&M.bandwidth)>>8,r[n++]=255&M.bandwidth,r[n++]=5,r[n++]=e.length,r.set(e,n),r}(),I&&(C(n=A.createBox("sinf",r),t),x(n),O(n));}return r}(e,t);default:throw {code:B.default.MSS_UNSUPPORTED_CODEC_CODE,message:B.default.MSS_UNSUPPORTED_CODEC_MESSAGE,data:{codec:t}}}}(t));}t.entry_count=t.entries.length;}(m);var g,v,y=A.createBox("mvex",n);g=y,(v=A.createFullBox("trex",g)).track_ID=P,v.default_sample_description_index=1,v.default_sample_duration=0,v.default_sample_size=0,v.default_sample_flags=0,I&&S&&function(e,t){var r=void 0,n=void 0,i=void 0,a=void 0;for(i=0;i<t.length;i+=1)(r=t[i].initData)&&(a=A.parseBuffer(r),(n=a.fetch("pssh"))&&A.Utils.appendBox(e,n));}(n,S.getSupportedKeySystemsFromContentProtection(I));}function C(e,t){A.createBox("frma",e).data_format=function(e){var t=0,r=void 0;for(r=0;r<e.length;r+=1)t|=e.charCodeAt(r)<<8*(e.length-r-1);return t}(t);}function x(e){var t=A.createFullBox("schm",e);t.flags=0,t.version=0,t.scheme_type=1667591779,t.scheme_version=65536;}function O(e){var t,r,n=A.createBox("schi",e);t=n,(r=A.createFullBox("tenc",t)).flags=0,r.version=0,r.default_IsEncrypted=1,r.default_IV_size=8,r.default_KID=I&&0<I.length&&I[0]["cenc:default_KID"]?I[0]["cenc:default_KID"]:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];}function N(e){for(var t=new Uint8Array(e.length/2),r=void 0,r=0;r<e.length/2;r+=1)t[r]=parseInt(""+e[2*r]+e[2*r+1],16);return t}return {generateMoov:function(e){if(e&&e.adaptation){var t,r,n=void 0;return w=(M=e).adaptation,E=w.period,P=w.index+1,I=E.mpd.manifest.Period_asArray[E.index].AdaptationSet_asArray[w.index].ContentProtection,D=E.mpd.manifest.Period_asArray[E.index].AdaptationSet_asArray[w.index].SegmentTemplate.timescale,n=A.createFile(),t=n,(r=A.createBox("ftyp",t)).major_brand="iso6",r.minor_version=1,r.compatible_brands=[],r.compatible_brands[0]="isom",r.compatible_brands[1]="iso6",r.compatible_brands[2]="msdh",i(n),n.write()}}}}a.__dashjs_factory_name="MssFragmentMoovProcessor",r.default=dashjs.FactoryMaker.getClassFactory(a),t.exports=r.default;},{10:10}],8:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var p=n(e(6)),d=n(e(7));function i(e,r){return e.length===r.length&&e.every(function(e,t){return e===r[t]})}function c(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("entry_count","uint",32),this._procFieldArray("offset",this.entry_count,"uint",1===this.version?64:32);}function h(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("default_sample_info_size","uint",8),this._procField("sample_count","uint",32),0===this.default_sample_info_size&&this._procFieldArray("sample_info_size",this.sample_count,"uint",8);}function m(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("IV_size","uint",8),this._procEntries("entry",this.sample_count,function(e){this._procEntryField(e,"InitializationVector","data",8),2&this.flags&&(this._procEntryField(e,"NumberOfEntries","uint",16),this._procSubEntries(e,"clearAndCryptedData",e.NumberOfEntries,function(e){this._procEntryField(e,"BytesOfClearData","uint",16),this._procEntryField(e,"BytesOfEncryptedData","uint",32);}));});}function g(){i(this.usertype,[109,29,155,5,66,213,68,230,128,226,20,29,175,247,87,178])&&(this._procFullBox(),this._parsing&&(this.type="tfxd"),this._procField("fragment_absolute_time","uint",1===this.version?64:32),this._procField("fragment_duration","uint",1===this.version?64:32)),i(this.usertype,[212,128,126,242,202,57,70,149,142,84,38,203,158,70,167,159])&&(this._procFullBox(),this._parsing&&(this.type="tfrf"),this._procField("fragment_count","uint",8),this._procEntries("entry",this.fragment_count,function(e){this._procEntryField(e,"fragment_absolute_time","uint",1===this.version?64:32),this._procEntryField(e,"fragment_duration","uint",1===this.version?64:32);})),i(this.usertype,[162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244])&&(this._parsing&&(this.type="sepiff"),m.call(this));}function a(e){e=e||{};var t,r=this.context,n=e.dashMetrics,i=e.playbackController,a=e.eventBus,o=e.protectionController,s=e.ISOBoxer,u=e.debug,l=void 0,f=void 0;return t={generateMoov:function(e){return l.generateMoov(e)},processFragment:function(e,t){if(!e||!e.request||!e.response)throw new Error("e parameter is missing or malformed");"MediaSegment"===e.request.type?f.convertFragment(e,t):"FragmentInfoSegment"===e.request.type&&(f.updateSegmentList(e,t),e.sender=null);}},s.addBoxProcessor("uuid",g),s.addBoxProcessor("saio",c),s.addBoxProcessor("saiz",h),s.addBoxProcessor("senc",m),l=(0, d.default)(r).create({protectionController:o,constants:e.constants,ISOBoxer:s}),f=(0, p.default)(r).create({dashMetrics:n,playbackController:i,ISOBoxer:s,eventBus:a,debug:u,errHandler:e.errHandler}),t}a.__dashjs_factory_name="MssFragmentProcessor",r.default=dashjs.FactoryMaker.getClassFactory(a),t.exports=r.default;},{6:6,7:7}],9:[function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var A=n(e(16)),S=n(e(17)),E=n(e(5)),w=n(e(8)),M=n(e(12)),i=n(e(10)),I=n(e(15)),D=n(e(14));function a(f){f=f||{};var r=this.context,p=f.eventBus,d=f.events,n=f.constants,c=f.initSegmentType,e=f.dashMetrics,t=f.playbackController,i=f.streamController,a=f.protectionController,h=(0, w.default)(r).create({dashMetrics:e,playbackController:t,protectionController:a,streamController:i,eventBus:p,constants:n,ISOBoxer:f.ISOBoxer,debug:f.debug,errHandler:f.errHandler}),o=void 0,s=void 0,u=void 0;function m(t){return i.getActiveStreamProcessors().filter(function(e){return e.getType()===t})[0]}function l(t){return s.filter(function(e){return e.getType()===t})[0]}function g(){i.getActiveStreamProcessors().forEach(function(e){var t;e.getType()!==n.VIDEO&&e.getType()!==n.AUDIO&&e.getType()!==n.FRAGMENTED_TEXT||((t=l(e.getType()))||((t=(0, E.default)(r).create({streamProcessor:e,baseURLController:f.baseURLController,debug:f.debug})).initialize(),s.push(t)),t.start());});}function v(e){var t=m(e.sender.getType());if(t){var r=t.getRepresentationController().getCurrentRepresentation(),n=t.getMediaInfo(),i=new S.default;i.mediaType=r.adaptation.type,i.type=c,i.range=r.range,i.quality=r.index,i.mediaInfo=n,i.representationId=r.id;var a,o,s,u,l=(a=i,o=n.streamInfo.id,s=e.type!==d.FRAGMENT_LOADING_PROGRESS,(u=new A.default).streamId=o,u.mediaInfo=a.mediaInfo,u.segmentType=a.type,u.start=a.startTime,u.duration=a.duration,u.end=u.start+u.duration,u.index=a.index,u.quality=a.quality,u.representationId=a.representationId,u.endFragment=s,u);try{l.bytes=h.generateMoov(r),p.trigger(d.INIT_FRAGMENT_LOADED,{chunk:l});}catch(e){f.errHandler.error(new I.default(e.code,e.message,e.data));}e.sender=null;}}function y(e){var t,r,n;e.error||(t=m(e.request.mediaType))&&(h.processFragment(e,t),"FragmentInfoSegment"!==e.request.type||(r=l(e.request.mediaType))&&r.fragmentInfoLoaded(e),(n=e.request.mediaInfo.streamInfo.manifestInfo).isDynamic||n.DVRWindowSize===1/0||g());}function _(){t.getIsDynamic()&&0!==t.getTime()&&g();}function b(){t.getIsDynamic()&&0!==t.getTime()&&g();}function T(e){e&&e.data&&(e.data=e.data.replace(/http:\/\/www.w3.org\/2006\/10\/ttaf1/gi,"http://www.w3.org/ns/ttml"));}return u={reset:function(){o&&(o.reset(),o=void 0),p.off(d.INIT_FRAGMENT_NEEDED,v,this),p.off(d.PLAYBACK_PAUSED,_,this),p.off(d.PLAYBACK_SEEK_ASKED,b,this),p.off(d.FRAGMENT_LOADING_COMPLETED,y,this),p.off(d.TTML_TO_PARSE,T,this),s.forEach(function(e){e.reset();}),s=[];},createMssParser:function(){return o=(0, M.default)(r).create(f)},registerEvents:function(){p.on(d.INIT_FRAGMENT_NEEDED,v,u,dashjs.FactoryMaker.getSingletonFactoryByName(p.getClassName()).EVENT_PRIORITY_HIGH),p.on(d.PLAYBACK_PAUSED,_,u,dashjs.FactoryMaker.getSingletonFactoryByName(p.getClassName()).EVENT_PRIORITY_HIGH),p.on(d.PLAYBACK_SEEK_ASKED,b,u,dashjs.FactoryMaker.getSingletonFactoryByName(p.getClassName()).EVENT_PRIORITY_HIGH),p.on(d.FRAGMENT_LOADING_COMPLETED,y,u,dashjs.FactoryMaker.getSingletonFactoryByName(p.getClassName()).EVENT_PRIORITY_HIGH),p.on(d.TTML_TO_PARSE,T,u);}},s=[],(0, D.default)(r).getInstance(),u}a.__dashjs_factory_name="MssHandler";var o=dashjs.FactoryMaker.getClassFactory(a);o.errors=i.default,dashjs.FactoryMaker.updateClassFactory(a.__dashjs_factory_name,o),r.default=o,t.exports=r.default;},{10:10,12:12,14:14,15:15,16:16,17:17,5:5,8:8}],10:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=function(e,t,r){for(var n=!0;n;){var i=e,a=t,o=r,n=!1;null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,r=o,n=!0,s=l=void 0;}};var i,a=e(3);function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),n(Object.getPrototypeOf(o.prototype),"constructor",this).call(this),this.MSS_NO_TFRF_CODE=200,this.MSS_UNSUPPORTED_CODEC_CODE=201,this.MSS_NO_TFRF_MESSAGE="Missing tfrf in live media segment",this.MSS_UNSUPPORTED_CODEC_MESSAGE="Unsupported codec";}var s=new(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);}(o,((i=a)&&i.__esModule?i:{default:i}).default),o);r.default=s,t.exports=r.default;},{3:3}],11:[function(o,e,s){(function(e){Object.defineProperty(s,"__esModule",{value:!0});var t,r=o(9),n=(t=r)&&t.__esModule?t:{default:t},i="undefined"!=typeof window&&window||e,a=i.dashjs;(a=a||(i.dashjs={})).MssHandler=n.default,s.default=a,s.MssHandler=n.default;}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});},{9:9}],12:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,i=e(1),b=(n=i)&&n.__esModule?n:{default:n};function a(e){var t,I=(e=e||{}).BASE64,r=e.debug,D=e.constants,P=e.manifestModel,C=e.mediaPlayerModel,x=e.settings,O=1e7,h=["AAC","AACL","AVC1","H264","TTML","DFXP"],m={CAPT:"main",SUBT:"alternate",DESC:"main"},g={DESC:"2"},v={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},y={video:"video/mp4",audio:"audio/mp4",text:"application/mp4"},_=void 0,N=void 0;function B(e,t){var r,n={},i=void 0;n.AdaptationSet_asArray=[],r=e.getElementsByTagName("StreamIndex");for(var a=0;a<r.length;a++)null!==(i=function(e,t){var r,n={},i=[],a=void 0,o=void 0,s=void 0,u=e.getAttribute("Name"),l=e.getAttribute("Type"),f=e.getAttribute("Language"),p=f?l+"_"+f:l;{var d,c;n.id=u||p,n.contentType=l,n.lang=f||"und",n.mimeType=y[l],n.subType=e.getAttribute("Subtype"),n.maxWidth=e.getAttribute("MaxWidth"),n.maxHeight=e.getAttribute("MaxHeight"),n.subType&&(m[n.subType]&&(d={schemeIdUri:"urn:mpeg:dash:role:2011",value:m[n.subType]},n.Role=d,n.Role_asArray=[d]),g[n.subType]&&(c={schemeIdUri:"urn:tva:metadata:cs:AudioPurposeCS:2007",value:g[n.subType]},n.Accessibility=c,n.Accessibility_asArray=[c]));}for(r=function(e,t){var r={},n=void 0,i=void 0,a=void 0;return a=e.getAttribute("Url"),n=(n=a?a.replace("{bitrate}","$Bandwidth$"):null)?n.replace("{start time}","$Time$"):null,i=(i=e.getAttribute("TimeScale"))?parseFloat(i):t,r.media=n,r.timescale=i,r.SegmentTimeline=function(e,t){var r={},n=e.getElementsByTagName("c"),i=[],a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,f=void 0,p=0;for(u=0;u<n.length;u++)if(a={},(s=n[u].getAttribute("t"))&&(0, b.default)(s).greater((0, b.default)(Number.MAX_SAFE_INTEGER))&&(a.tManifest=s),a.t=parseFloat(s),a.d=parseFloat(n[u].getAttribute("d")),0!==u||a.t||(a.t=0),0<u&&((o=i[i.length-1]).d||(o.tManifest?o.d=(0, b.default)(s).subtract((0, b.default)(o.tManifest)).toJSNumber():o.d=a.t-o.t,p+=o.d),a.t||(o.tManifest?(a.tManifest=(0, b.default)(o.tManifest).add((0, b.default)(o.d)).toString(),a.t=parseFloat(a.tManifest)):a.t=o.t+o.d)),a.d&&(p+=a.d),i.push(a),f=parseFloat(n[u].getAttribute("r")))for(l=0;l<f-1;l++)o=i[i.length-1],(a={}).t=o.t+o.d,a.d=o.d,o.tManifest&&(a.tManifest=(0, b.default)(o.tManifest).add((0, b.default)(o.d)).toString()),p+=a.d,i.push(a);return r.S=i,r.S_asArray=i,r.duration=p/t,r}(e,r.timescale),r}(e,t),a=e.getElementsByTagName("QualityLevel"),s=0;s<a.length;s++)a[s].BaseURL=n.BaseURL,a[s].mimeType=n.mimeType,a[s].Id=n.id+"_"+a[s].getAttribute("Index"),null!==(o=function(e,t){var r={},n=t.getAttribute("Type"),i=null;r.id=e.Id,r.bandwidth=parseInt(e.getAttribute("Bitrate"),10),r.mimeType=e.mimeType,r.width=parseInt(e.getAttribute("MaxWidth"),10),r.height=parseInt(e.getAttribute("MaxHeight"),10),null!==(i=e.getAttribute("FourCC"))&&""!==i||(i=t.getAttribute("FourCC"));if(null===i||""===i)if(n===D.AUDIO)i="AAC";else if(n===D.VIDEO)return _.debug('FourCC is not defined whereas it is required for a QualityLevel element for a StreamIndex of type "video"'),null;if(-1===h.indexOf(i.toUpperCase()))return _.warn("Codec not supported: "+i),null;"H264"===i||"AVC1"===i?r.codecs=function(e){var t,r=e.getAttribute("CodecPrivateData").toString();return t=/00000001[0-9]7/.exec(r),"avc1."+(t&&t[0]?r.substr(r.indexOf(t[0])+10,6):void 0)}(e):0<=i.indexOf("AAC")?(r.codecs=function(e,t){var r=parseInt(e.getAttribute("SamplingRate"),10),n=e.getAttribute("CodecPrivateData").toString(),i=0,a=void 0,o=void 0,s=void 0;"AACH"===t&&(i=5);void 0===n||""===n?(i=2,o=v[r],n=(n=""+("AACH"===t?(i=5,n=new Uint8Array(4),s=v[2*r],n[0]=i<<3|o>>1,n[1]=o<<7|e.Channels<<3|s>>1,n[2]=s<<7|8,n[3]=0,(a=new Uint16Array(2))[0]=(n[0]<<8)+n[1],a[1]=(n[2]<<8)+n[3],a[0].toString(16),a[0].toString(16)+a[1].toString(16)):((n=new Uint8Array(2))[0]=i<<3|o>>1,n[1]=o<<7|parseInt(e.getAttribute("Channels"),10)<<3,(a=new Uint16Array(1))[0]=(n[0]<<8)+n[1],a[0].toString(16)))).toUpperCase(),e.setAttribute("CodecPrivateData",n)):0===i&&(i=(248&parseInt(n.substr(0,2),16))>>3);return "mp4a.40."+i}(e,i),r.audioSamplingRate=parseInt(e.getAttribute("SamplingRate"),10),r.audioChannels=parseInt(e.getAttribute("Channels"),10)):(i.indexOf("TTML")||i.indexOf("DFXP"))&&(r.codecs=D.STPP);return r.codecPrivateData=""+e.getAttribute("CodecPrivateData"),r.BaseURL=e.BaseURL,r}(a[s],e))&&(o.SegmentTemplate=r,i.push(o));return 0!==i.length?(n.Representation=1<i.length?i:i[0],n.Representation_asArray=i,n.SegmentTemplate=r,r.SegmentTimeline.S_asArray,n):null}(r[a],t))&&n.AdaptationSet_asArray.push(i);return 0<n.AdaptationSet_asArray.length&&(n.AdaptationSet=1<n.AdaptationSet_asArray.length?n.AdaptationSet_asArray:n.AdaptationSet_asArray[0]),n}function F(e){var t,r=void 0,n=void 0;return (r=function(e){var t=void 0,r=void 0,n=void 0,i=0;e[i+3],e[i+2],e[i+1],e[i],e[(i+=4)+1],e[i],i+=2;for(;i<e.length;)if(t=(e[i+1]<<8)+e[i],i+=2,1===t)return r=(e[i+1]<<8)+e[i],i+=2,(n=new Uint8Array(r)).set(e.subarray(i,i+r)),n;return null}(I.decodeArray(e.firstChild.data)))&&(r=new Uint16Array(r.buffer),r=String.fromCharCode.apply(null,r),n=(new DOMParser).parseFromString(r,"application/xml").querySelector("KID").textContent,n=I.decodeArray(n),i(t=n,0,3),i(t,1,2),i(t,4,5),i(t,6,7)),n}function i(e,t,r){var n=e[t];e[t]=e[r],e[r]=n;}function o(e,t){var r,n={},i=[],a=e.getElementsByTagName("SmoothStreamingMedia")[0],o=e.getElementsByTagName("Protection")[0],s=null,u=void 0,l=void 0,f=void 0,p=void 0,d=void 0,c=void 0,h=void 0,m=void 0,g=void 0,v=void 0;n.protocol="MSS",n.profiles="urn:mpeg:dash:profile:isoff-live:2011",n.type="TRUE"===a.getAttribute("IsLive")?"dynamic":"static",r=a.getAttribute("TimeScale"),n.timescale=r?parseFloat(r):O;var y=parseFloat(a.getAttribute("DVRWindowLength"));"dynamic"!==n.type||0!==y&&!isNaN(y)||(y=1/0),0===y&&"TRUE"===a.getAttribute("CanSeek")&&(y=1/0),0<y&&(n.timeShiftBufferDepth=y/n.timescale);var _,b,T,A,S,E,w=parseFloat(a.getAttribute("Duration"));for(n.mediaPresentationDuration=0===w?1/0:w/n.timescale,n.minBufferTime=2,n.ttmlTimeIsRelative=!0,"dynamic"===n.type&&0<w&&(n.type="static",n.timeShiftBufferDepth=w/n.timescale),"dynamic"===n.type&&n.timeShiftBufferDepth<1/0&&(n.refreshManifestOnSwitchTrack=!0,n.doNotUpdateDVRWindowOnBufferUpdated=!0,n.ignorePostponeTimePeriod=!0),n.Period=B(a,n.timescale),n.Period_asArray=[n.Period],void((u=n.Period).start=0)!==o&&((s=e.getElementsByTagName("ProtectionHeader")[0]).firstChild.data=s.firstChild.data.replace(/\n|\r/g,""),p=F(s),(f={schemeIdUri:"urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95",value:"com.microsoft.playready",pro:_={__text:s.firstChild.data,__prefix:"mspr"},pro_asArray:_})["cenc:default_KID"]=p,i.push(f),(f=function(e){var t={schemeIdUri:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",value:"com.widevine.alpha"};if(!e)return t;var r=new Uint8Array(2+e.length);r[0]=18,r[1]=16,r.set(e,2);var n=32+r.length,i=new Uint8Array(n),a=0;return i[a++]=(4278190080&n)>>24,i[a++]=(16711680&n)>>16,i[a++]=(65280&n)>>8,i[a++]=255&n,i.set([112,115,115,104,0,0,0,0],a),a+=8,i.set([237,239,139,169,121,214,74,206,163,200,39,220,213,29,33,237],a),a+=16,i[a++]=(4278190080&r.length)>>24,i[a++]=(16711680&r.length)>>16,i[a++]=(65280&r.length)>>8,i[a++]=255&r.length,i.set(r,a),i=String.fromCharCode.apply(null,i),i=I.encodeASCII(i),t.pssh={__text:i},t}(p))["cenc:default_KID"]=p,i.push(f),n.ContentProtection=i,n.ContentProtection_asArray=i),l=u.AdaptationSet_asArray,g=0;g<l.length;g+=1){l[g].SegmentTemplate.initialization="$Bandwidth$",void 0!==n.ContentProtection&&(l[g].ContentProtection=n.ContentProtection,l[g].ContentProtection_asArray=n.ContentProtection_asArray),"video"===l[g].contentType&&(m=l[g].SegmentTemplate.SegmentTimeline.S_asArray[0].d/l[g].SegmentTemplate.timescale,n.minBufferTime=m,"dynamic"===n.type&&(b=((h=l[g].SegmentTemplate.SegmentTimeline.S_asArray)[h.length-1].t+h[h.length-1].d)/l[g].SegmentTemplate.timescale*1e3,n.availabilityStartTime=new Date(t.getTime()-b),0<n.timeShiftBufferDepth&&n.timeShiftBufferDepth!==1/0&&n.timeShiftBufferDepth>l[g].SegmentTemplate.SegmentTimeline.duration&&(n.timeShiftBufferDepth=l[g].SegmentTemplate.SegmentTimeline.duration)));}if(n.minBufferTime=Math.min(n.minBufferTime,n.timeShiftBufferDepth?n.timeShiftBufferDepth:1/0),"dynamic"===n.type&&(T=(T=C.getLiveDelay())||m*(null===x.get().streaming.liveDelayFragmentCount||isNaN(x.get().streaming.liveDelayFragmentCount)?4:x.get().streaming.liveDelayFragmentCount),A=Math.max(n.timeShiftBufferDepth-10,n.timeShiftBufferDepth/2),E=(S=Math.min(A,T))-m,N={streaming:{liveDelay:x.get().streaming.liveDelay,stableBufferTime:x.get().streaming.stableBufferTime,bufferTimeAtTopQuality:x.get().streaming.bufferTimeAtTopQuality,bufferTimeAtTopQualityLongForm:x.get().streaming.bufferTimeAtTopQualityLongForm}},x.update({streaming:{liveDelay:S,stableBufferTime:E,bufferTimeAtTopQuality:E,bufferTimeAtTopQualityLongForm:E}})),delete n.ContentProtection,delete n.ContentProtection_asArray,"static"===n.type){var M=P.getValue();if(M&&M.timestampOffset)d=M.timestampOffset;else for(g=0;g<l.length;g++)l[g].contentType!==D.AUDIO&&l[g].contentType!==D.VIDEO||(c=(h=l[g].SegmentTemplate.SegmentTimeline.S_asArray)[0].t/l[g].SegmentTemplate.timescale,void 0===d&&(d=c),d=Math.min(d,c),n.mediaPresentationDuration=Math.min(n.mediaPresentationDuration,l[g].SegmentTemplate.SegmentTimeline.duration));if(0<d){for(n.timestampOffset=d,g=0;g<l.length;g++){for(h=l[g].SegmentTemplate.SegmentTimeline.S_asArray,v=0;v<h.length;v++)h[v].tManifest||(h[v].tManifest=h[v].t),h[v].t-=d*l[g].SegmentTemplate.timescale;l[g].contentType!==D.AUDIO&&l[g].contentType!==D.VIDEO||(u.start=Math.max(h[0].t,u.start),l[g].SegmentTemplate.presentationTimeOffset=u.start);}u.start/=n.timescale;}}return n.mediaPresentationDuration=Math.floor(1e3*n.mediaPresentationDuration)/1e3,u.duration=n.mediaPresentationDuration,n}return t={parse:function(e){var t,r=window.performance.now(),n=function(e){var t=null;if(window.DOMParser&&0<(t=(new window.DOMParser).parseFromString(e,"text/xml")).getElementsByTagName("parsererror").length)throw new Error("parsing the manifest failed");return t}(e),i=window.performance.now();if(null===n)return null;t=o(n,new Date);var a=window.performance.now();return _.info("Parsing complete: (xmlParsing: "+(i-r).toPrecision(3)+"ms, mss2dash: "+(a-i).toPrecision(3)+"ms, total: "+((a-r)/1e3).toPrecision(3)+"s)"),t},getMatchers:function(){return null},getIron:function(){return null},reset:function(){N&&x.update(N);}},_=r.getLogger(t),t}a.__dashjs_factory_name="MssParser",r.default=dashjs.FactoryMaker.getClassFactory(a),t.exports=r.default;},{1:1}],13:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=function(e,t,r){for(var n=!0;n;){var i=e,a=t,o=r,n=!1;null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,r=o,n=!0,s=l=void 0;}};var i,a=e(4);function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),n(Object.getPrototypeOf(o.prototype),"constructor",this).call(this),this.AST_IN_FUTURE="astInFuture",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_LOADED="bufferLoaded",this.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",this.ERROR="error",this.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",this.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",this.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",this.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",this.LOG="log",this.MANIFEST_LOADED="manifestLoaded",this.METRICS_CHANGED="metricsChanged",this.METRIC_CHANGED="metricChanged",this.METRIC_ADDED="metricAdded",this.METRIC_UPDATED="metricUpdated",this.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",this.PERIOD_SWITCH_STARTED="periodSwitchStarted",this.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",this.QUALITY_CHANGE_RENDERED="qualityChangeRendered",this.TRACK_CHANGE_RENDERED="trackChangeRendered",this.SOURCE_INITIALIZED="sourceInitialized",this.STREAM_INITIALIZING="streamInitializing",this.STREAM_INITIALIZED="streamInitialized",this.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",this.TEXT_TRACKS_ADDED="allTextTracksAdded",this.TEXT_TRACK_ADDED="textTrackAdded",this.TTML_PARSED="ttmlParsed",this.TTML_TO_PARSE="ttmlToParse",this.CAPTION_RENDERED="captionRendered",this.CAPTION_CONTAINER_RESIZE="captionContainerResize",this.CAN_PLAY="canPlay",this.PLAYBACK_ENDED="playbackEnded",this.PLAYBACK_ERROR="playbackError",this.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",this.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",this.PLAYBACK_PAUSED="playbackPaused",this.PLAYBACK_PLAYING="playbackPlaying",this.PLAYBACK_PROGRESS="playbackProgress",this.PLAYBACK_RATE_CHANGED="playbackRateChanged",this.PLAYBACK_SEEKED="playbackSeeked",this.PLAYBACK_SEEKING="playbackSeeking",this.PLAYBACK_SEEK_ASKED="playbackSeekAsked",this.PLAYBACK_STALLED="playbackStalled",this.PLAYBACK_STARTED="playbackStarted",this.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",this.PLAYBACK_WAITING="playbackWaiting",this.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged";}var s=new(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);}(o,((i=a)&&i.__esModule?i:{default:i}).default),o);r.default=s,t.exports=r.default;},{4:4}],14:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,i=e(2),a=(n=i)&&n.__esModule?n:{default:n};function o(){var n={};return {save:function(e){var t=e.streamId,r=e.representationId;n[t]=n[t]||{},n[t][r]=e;},extract:function(e,t){return n&&n[e]&&n[e][t]?n[e][t]:null},reset:function(){n={};}}}o.__dashjs_factory_name="InitCache",r.default=a.default.getSingletonFactory(o),t.exports=r.default;},{2:2}],15:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});r.default=function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.code=t||null,this.message=r||null,this.data=n||null;},t.exports=r.default;},{}],16:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});r.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null;},t.exports=r.default;},{}],17:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=function(e,t,r){return t&&i(e.prototype,t),e};function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n);}}var a=e(18),o=(n(s,[{key:"isInitializationRequest",value:function(){return this.type&&this.type===a.HTTPRequest.INIT_SEGMENT_TYPE}},{key:"setInfo",value:function(e){this.type=e&&e.init?a.HTTPRequest.INIT_SEGMENT_TYPE:a.HTTPRequest.MEDIA_SEGMENT_TYPE,this.url=e&&e.url?e.url:null,this.range=e&&e.range?e.range.start+"-"+e.range.end:null,this.mediaType=e&&e.mediaType?e.mediaType:null;}}]),s);function s(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),this.action=s.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=e||null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null;}o.ACTION_DOWNLOAD="download",o.ACTION_COMPLETE="complete",r.default=o,t.exports=r.default;},{18:18}],18:[function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});function i(){n(this,i),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this._stream=null,this._tfinish=null,this._mediaduration=null,this._quality=null,this._responseHeaders=null,this._serviceLocation=null;}i.GET="GET",i.HEAD="HEAD",i.MPD_TYPE="MPD",i.XLINK_EXPANSION_TYPE="XLinkExpansion",i.INIT_SEGMENT_TYPE="InitializationSegment",i.INDEX_SEGMENT_TYPE="IndexSegment",i.MEDIA_SEGMENT_TYPE="MediaSegment",i.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",i.OTHER_TYPE="other",r.HTTPRequest=i,r.HTTPRequestTrace=function e(){n(this,e),this.s=null,this.d=null,this.b=[];};},{}]},{},[11]);

window.bradmax.dashjs = dashjs;
if(orgdash) {
    window.dashjs = orgdash;
} else {
    delete window['dashjs'];
}
})(window);!function(t,e){t.bs=t.bs||{},t.bs.player=t.bs.player||{},t.bs.player.plugin=t.bs.player.plugin||{},t.bs.player.plugin.bradmax=t.bs.player.plugin.bradmax||{},t.bs.player.plugin.bradmax.analytics=t.bs.player.plugin.bradmax.analytics||{},Math.__name__="Math";var a=require("haxe.Reflect");class i{static string(t){return y.__string_rec(t,"")}static random(t){return t<=0?0:Math.floor(Math.random()*t)}}i.__name__="Std";var s=require("haxe.StringTools"),r=require("bs.player.core.events.AdEvent"),n=require("bs.player.core.events.ControlEvent"),l=require("bs.player.core.events.DataProviderEvent"),o=require("bs.player.core.events.VideoEvent"),d=require("bs.player.core.model.Live");class c{constructor(t){null==t&&(t=5),this.pluginName="";let e=y.getClass(this);this.pluginName=e.__name__.split(".").pop(),this.initPriority=t;let i=this.pluginName,s=exports.configuration;this.pluginConfig=null!=s&&Object.prototype.hasOwnProperty.call(s,i)?a.field(s,i):Object.create(null);}create(){}destroy(){}activate(){}postActivate(){}deactivate(){}eventFilter(t){return !0}registerPlugin(t){}getPluginVersion(){return "v2.15.38"}getPluginName(){return this.pluginName}get_player(){return this.player}set_player(t){return this.player=t}get_variables(){return this.variables}set_variables(t){return this.variables=t}get_eventHub(){return this.eventHub}set_eventHub(t){return this.eventHub=t}get_parentDisplay(){return this.parentDisplay}set_parentDisplay(t){return this.parentDisplay=t}get_display(){return this.display}isCriticalForPlayback(){return !0}}c.__name__="bs.player.core.plugin.PluginBase",Object.assign(c.prototype,{__class__:c});class h extends c{constructor(){super(),this.settingsTrackAds=!1,this.settingsTrackAdsProgress=!1,this.settingsTrackEngagementRate=!1,this.settingsTrackRealtimeStats=!1,this.settingsEngagementRatePercResolution=1,this.mediaPlayback=new g,this.adPlayback=new g,this.logger=new u,this.playerErrorLogLastSendAt=null,this.gdprAgreeRequired=!1,this.gdprAgreeForCookie=!1,this.playerRemoteErrorLogEnabed=!1;}activate(){if(this.loadSettings(),null!=this.clientToken&&""!=this.clientToken)if(n.add(this.context,"skinPlay",P(m=this.mediaPlayback,m.onPlayEvent)),n.add(this.context,"skinPause",P(m=this.mediaPlayback,m.onPauseEvent)),o.add(this.context,"currentTimeChange",P(m=this.mediaPlayback,m.onVideoProgress)),o.add(this.context,"durationChange",P(m=this.mediaPlayback,m.onVideoDurationChange)),o.add(this.context,"complete",P(m=this.mediaPlayback,m.onVideoComplete)),o.add(this.context,"playing",P(m=this.mediaPlayback,m.onVideoPlaying)),o.add(this.context,"paused",P(m=this.mediaPlayback,m.onVideoPaused)),o.add(this.context,"drmAuthenticationComplete",P(m=this.mediaPlayback,m.onDrmAuthenticationComplete)),o.add(this.context,"playing",P(this,this.onRealtimeEvent)),o.add(this.context,"paused",P(this,this.onRealtimeEvent)),o.add(this.context,"complete",P(this,this.onRealtimeEvent)),o.add(this.context,"mediaError",P(this,this.onRealtimeEvent)),l.add(this.context,"mediaMetadataData",P(m=this.mediaPlayback,m.onMetadata)),l.add(this.context,"mediaAfterPlaybackStartMetadata",P(m=this.mediaPlayback,m.onAfterPlaybackStartMetadataData)),r.add(this.context,"adPlay",P(m=this.adPlayback,m.onPlayEvent)),r.add(this.context,"adPause",P(m=this.adPlayback,m.onPauseEvent)),r.add(this.context,"adCurrentTimeChange",P(m=this.adPlayback,m.onVideoProgress)),r.add(this.context,"adDurationChange",P(m=this.adPlayback,m.onVideoDurationChange)),r.add(this.context,"adComplete",P(m=this.adPlayback,m.onVideoComplete)),r.add(this.context,"adPlaying",P(m=this.adPlayback,m.onVideoPlaying)),r.add(this.context,"adPaused",P(m=this.adPlayback,m.onVideoPaused)),l.add(this.context,"adMetadataData",P(m=this.adPlayback,m.onMetadata)),o.add(this.context,"mediaError",P(this,this.onVideoMediaError)),o.add(this.context,"mediaErrorFallbackTry",P(this,this.onVideoMediaErrorFallbackTry)),r.add(this.context,"adMediaError",P(this,this.onAdVideoMediaError)),r.add(this.context,"adMediaErrorFallbackTry",P(this,this.onAdVideoMediaErrorFallbackTry)),this.mediaPlayback.firstPlayingEventCallback=P(this,this.onMediaFirstPlayingEvent),this.settingsTrackAds&&(r.add(this.context,"adAdClick",P(this,this.onAdClick)),this.adPlayback.firstPlayingEventCallback=P(this,this.onAdFirstPlayingEvent),this.settingsTrackAdsProgress&&(this.adPlayback.firstQuartilePlaybackCallback=P(this,this.onAdFirstQuartilePlayback),this.adPlayback.midpointPlaybackCallback=P(this,this.onAdMidpointPlayback),this.adPlayback.thirdQuartilePlaybackCallback=P(this,this.onAdThirdQuartilePlayback),this.adPlayback.completePlaybackCallback=P(this,this.onAdCompletePlayback))),this.settingsTrackEngagementRate&&(this.mediaPlayback.statsEngagementRateEnabled=!0,this.mediaPlayback.statsEngagementRatePercResolution=this.settingsEngagementRatePercResolution,this.mediaPlayback.engagementRatePercentProgressCallback=P(this,this.onEngegementRatePercProgress),this.mediaPlayback.engagementRateTimeProgressCallback=P(this,this.onEngegementRateTimeProgress)),!this.gdprAgreeRequired||this.gdprAgreeForCookie){let t=window._ba_enable_cookies;null!=t?t():console.error("Cannot enable BradmaxAnalytics users stats - missing _ba callback.");}else {let t=window._ba_disable_cookies;null!=t?t():console.error("Cannot disable BradmaxAnalytics users stats - missing _ba callback.");}else console.warn("Warning: Cannot activate BradmaxAnalytics plugin without client token. Please add 'clientToken' field into bradmaxAnalytics plugin configuration section.");}loadSettings(){Object.prototype.hasOwnProperty.call(this.pluginConfig,"clientToken")&&(this.clientToken=a.field(this.pluginConfig,"clientToken")),Object.prototype.hasOwnProperty.call(this.pluginConfig,"baseUrl")&&(this.logger.baseUrl=a.field(this.pluginConfig,"baseUrl")),Object.prototype.hasOwnProperty.call(this.pluginConfig,"trackAds")&&(this.settingsTrackAds=a.field(this.pluginConfig,"trackAds")),Object.prototype.hasOwnProperty.call(this.pluginConfig,"trackAdsProgress")&&(this.settingsTrackAdsProgress=a.field(this.pluginConfig,"trackAdsProgress")),Object.prototype.hasOwnProperty.call(this.pluginConfig,"trackEngagementRate")&&(this.settingsTrackEngagementRate=a.field(this.pluginConfig,"trackEngagementRate")),Object.prototype.hasOwnProperty.call(this.pluginConfig,"trackRealtimeStats")&&(this.settingsTrackRealtimeStats=a.field(this.pluginConfig,"trackRealtimeStats")),Object.prototype.hasOwnProperty.call(this.pluginConfig,"gdprAgreeRequired")&&(this.gdprAgreeRequired=a.field(this.pluginConfig,"gdprAgreeRequired")),Object.prototype.hasOwnProperty.call(this.pluginConfig,"gdprAgreeForCookie")&&(this.gdprAgreeForCookie=a.field(this.pluginConfig,"gdprAgreeForCookie")),Object.prototype.hasOwnProperty.call(this.pluginConfig,"playerRemoteErrorLogEnabed")&&(this.playerRemoteErrorLogEnabed=a.field(this.pluginConfig,"playerRemoteErrorLogEnabed"));let t=this.get_variables();if(Object.prototype.hasOwnProperty.call(t,"bradmaxAnalytics")){let t=a.field(this.get_variables(),"bradmaxAnalytics");Object.prototype.hasOwnProperty.call(t,"clientToken")&&(this.clientToken=a.field(t,"clientToken")),Object.prototype.hasOwnProperty.call(t,"baseUrl")&&(this.logger.baseUrl=a.field(t,"baseUrl")),Object.prototype.hasOwnProperty.call(t,"trackAds")&&(this.settingsTrackAds=a.field(t,"trackAds")),Object.prototype.hasOwnProperty.call(t,"trackAdsProgress")&&(this.settingsTrackAdsProgress=a.field(t,"trackAdsProgress")),Object.prototype.hasOwnProperty.call(t,"trackEngagementRate")&&(this.settingsTrackEngagementRate=a.field(t,"trackEngagementRate")),Object.prototype.hasOwnProperty.call(t,"trackRealtimeStats")&&(this.settingsTrackRealtimeStats=a.field(t,"trackRealtimeStats")),Object.prototype.hasOwnProperty.call(t,"gdprAgreeRequired")&&(this.gdprAgreeRequired=a.field(t,"gdprAgreeRequired")),Object.prototype.hasOwnProperty.call(t,"gdprAgreeForCookie")&&(this.gdprAgreeForCookie=a.field(t,"gdprAgreeForCookie")),Object.prototype.hasOwnProperty.call(t,"playerRemoteErrorLogEnabed")&&(this.playerRemoteErrorLogEnabed=a.field(t,"playerRemoteErrorLogEnabed"));}}onMediaFirstPlayingEvent(){let t={materialID:this.mediaPlayback.mediaId,title:this.mediaPlayback.title,event:"media.view",currentTime:this.mediaPlayback.currentTime,duration:this.mediaPlayback.duration,isDrmProtected:this.mediaPlayback.isDrmProtected};this.assignContentMetaToData(t),this.sendDataToLogger(t);}assignContentMetaToData(t){if(null!=this.mediaPlayback.media&&null!=this.mediaPlayback.media.contentMeta){let e=this.mediaPlayback.media.contentMeta;Object.prototype.hasOwnProperty.call(e.h,"tags")&&(t.tags=e.h.tags),Object.prototype.hasOwnProperty.call(e.h,"pageTags")&&(t.pageTags=e.h.pageTags);let a=0,s=h.SPECIAL_CONTENT_META_TAGS;for(;a<s.length;){let r=s[a];if(++a,!Object.prototype.hasOwnProperty.call(e.h,r))continue;null==t.tags&&(t.tags=[]);let n=""+i.string(e.h[r]);n=encodeURIComponent(n);let l=r+":"+n;-1==t.tags.indexOf(l)&&t.tags.push(l);}}}makeAdEvent(t){return {materialID:this.adPlayback.mediaId,relatedID:this.mediaPlayback.mediaId,title:this.adPlayback.title,event:t,currentTime:this.adPlayback.currentTime,duration:this.adPlayback.duration,isDrmProtected:this.adPlayback.isDrmProtected}}onAdFirstPlayingEvent(){this.sendDataToLogger(this.makeAdEvent("ad.view"));}onAdFirstQuartilePlayback(){this.sendDataToLogger(this.makeAdEvent("ad.view.25"));}onAdMidpointPlayback(){this.sendDataToLogger(this.makeAdEvent("ad.view.50"));}onAdThirdQuartilePlayback(){this.sendDataToLogger(this.makeAdEvent("ad.view.75"));}onAdCompletePlayback(){this.sendDataToLogger(this.makeAdEvent("ad.view.100"));}onAdClick(t){let e="";null!=t.data&&null!=t.data.url&&(e=t.data.url),this.sendDataToLogger({materialID:this.adPlayback.mediaId,relatedID:this.mediaPlayback.mediaId,title:this.adPlayback.title,event:"ad.click",currentTime:this.adPlayback.currentTime,duration:this.adPlayback.duration,isDrmProtected:this.adPlayback.isDrmProtected,relUrl:e});}onEngegementRatePercProgress(t){let e={materialID:this.mediaPlayback.mediaId,title:this.mediaPlayback.title,event:"er.perc",currentTime:this.mediaPlayback.currentTime,duration:this.mediaPlayback.duration,isDrmProtected:this.mediaPlayback.isDrmProtected,engagementRatePosition:[t]};this.assignContentMetaToData(e),this.sendDataToLogger(e);}onEngegementRateTimeProgress(t){let e={materialID:this.mediaPlayback.mediaId,title:this.mediaPlayback.title,event:"er.time",currentTime:this.mediaPlayback.currentTime,duration:this.mediaPlayback.duration,isDrmProtected:this.mediaPlayback.isDrmProtected,engagementRatePosition:[t]};this.assignContentMetaToData(e),this.sendDataToLogger(e);}sendDataToLogger(t){null!=window._ba_action?window._ba_action(this.clientToken,t):console.error("Cannot send BradmaxAnalytics data. Data logger not found. Key window.bams not exists.");}onRealtimeEvent(t){if(!this.settingsTrackRealtimeStats)return;let e=t.type,a={materialID:this.mediaPlayback.mediaId,title:this.mediaPlayback.title,event:e,currentTime:t.data.currentTime,duration:this.mediaPlayback.duration};switch(null!=this.realtimeMediaId&&this.realtimeMediaId!=this.mediaPlayback.mediaId&&this.realtimeEnd(this.realtimeMediaData),e){case"complete":case"mediaError":case"paused":this.realtimeEnd(a);break;case"playing":this.realtimeStart(a);}this.realtimeMediaId=this.mediaPlayback.mediaId,this.realtimeMediaData=a;}prepareErrorLodData(t,e){let a={m:e,v:"v2.15.38",t:this.clientToken,ct:this.mediaPlayback.currentTime};if(a.l=window.location.href,null!=t&&null!=t.data){null!=t.data.media&&null!=t.data.media.id&&(a["m.id"]=t.data.media.id),null!=t.data.media&&null!=t.data.media.source&&t.data.media.source.length>0&&null!=t.data.media.source[0]&&null!=t.data.media.source[0].url&&(a["m.s.url"]=t.data.media.source[0].url),null!=t.data.source&&""!=t.data.source&&(a["s.url"]=t.data.source);try{null!=t.data.additionalData&&(JSON.stringify(t.data.additionalData),a.d=t.data.additionalData);}catch(t){console.warn("Bradmax Analytics: Cannot serialize error data.");}}return a}sendPlayerErrorLog(t,e){if(this.playerRemoteErrorLogEnabed&&!(null!=this.playerErrorLogLastSendAt&&(new Date).getTime()-this.playerErrorLogLastSendAt.getTime()<3e3))try{let a=JSON.stringify(this.prepareErrorLodData(t,e));(new Image).src="https://bradmax.com/static/player-error-log/img.gif?d="+encodeURIComponent(a),this.playerErrorLogLastSendAt=new Date;}catch(t){console.warn("Bradmax Analytics: Cannot sent player error report.");}}onVideoMediaError(t){this.sendPlayerErrorLog(t,"error");}onAdVideoMediaError(t){this.sendPlayerErrorLog(t,"error_ad");}onVideoMediaErrorFallbackTry(t){this.sendPlayerErrorLog(t,"error_fallback");}onAdVideoMediaErrorFallbackTry(t){this.sendPlayerErrorLog(t,"error_ad_fallback");}realtimeStart(t){t.event="media.user.start",this.assignContentMetaToData(t),this.sendDataToLogger(t);}realtimeEnd(t){t.event="media.user.end",this.assignContentMetaToData(t),this.sendDataToLogger(t);}isCriticalForPlayback(){return !1}}t.bs.player.plugin.bradmax.analytics.BradmaxAnalytics=h,h.__name__="bs.player.plugin.bradmax.analytics.BradmaxAnalytics",Object.assign(h.prototype,{__class__:h});class u{constructor(){this.s=window.screen,this.w=window,this.d=document,(window.bradmax_analytics={}).action=P(this,this.action),0==this.w.location.href.indexOf("http://")?this.baseUrl="http://":this.baseUrl="https://",this.baseUrl+="stats.bradmax.com/v1";}action(t,e){if(null==t&&(t=""),""==t||null==e||""==e.event)return void console.warn("WRONG REQUEST");let a=[],s=function(t){for(var e=t+"=",a=decodeURIComponent(document.cookie).split(";"),i=0;i<a.length;i++){for(var s=a[i];" "==s.charAt(0);)s=s.substring(1);if(0==s.indexOf(e))return s.substring(e.length,s.length)}return ""}("_baml");""==s&&(s=this.uuid());let r=b.get("_bame");null==r&&(r=this.uuid());!function(t,e,a){var i=new Date;i.setTime(i.getTime()+24*a*60*60*1e3);var s="expires="+i.toUTCString();document.cookie=t+"="+e+";"+s+";path=/";}("_baml",s,730);!function(t,e,a){var i=new Date;i.setTime(i.getTime()+24*a*60*60*1e3);var s="expires="+i.toUTCString();document.cookie=t+"="+e+";"+s+";path=/";}("_bame",r,.020833333333333332),a.push(["lc",s]),a.push(["sc",r]),a.push(["pt",""+this.d.title]),a.push(["lo",""+this.d.location.href]),a.push(["la",""+i.string(navigator.language)]),a.push(["cs",""+i.string(document.characterSet)]),a.push(["re",this.s.availWidth+"x"+this.s.availHeight]);let n=Math.max(this.d.documentElement.clientWidth,0|this.w.innerWidth),l=Math.max(this.d.documentElement.clientHeight,0|this.w.innerHeight);a.push(["vp",n+"x"+l]);let o=null;try{o=function(t){for(var e=1,a=1<<24;!t(e)&&e<=a;)e*=2;return e>a?0:function(t,e,a){for(;a-e>1;){var i=a+e>>1;t(i)?a=i:e=i;}return a}(t,e/2,e)}((function(t){return matchMedia("(max-resolution: "+t+"dpi)").matches}));}catch(g){}a.push(["dp",""+(0==o?null:o)]);let d,c,h=""+i.string(screen.orientation||screen.mozOrientation||screen.msOrientation);a.push(["so",-1!=h.indexOf("landscape")?"l":"p"]),a.push(["ev",""+e.event]),a.push(["mi",""+e.materialID]),a.push(["ri",""+e.relatedID]),a.push(["ct",""+e.currentTime]),a.push(["du",""+e.duration]),a.push(["vt",""+e.title]),a.push(["vo",""+e.volume]),a.push(["ms",""+e.currentState]),a.push(["pr",""+e.progress]);try{d=e.videoResolution.width+"x"+e.videoResolution.height;}catch(g){d="";}a.push(["vr",""+d]),a.push(["br",""+e.bitrate]),a.push(["ss",""+e.selectedSubtitle]),a.push(["sa",""+e.selectedAudio]);try{c=e.tags.join(",");}catch(g){c="";}a.push(["tg",""+c]),a.push(["mt",""+e.mimeType]),a.push(["dr",e.isDrmProtected?"1":"0"]),a.push(["ru",""+e.relUrl]),a.push(["pv",""+e.playerVersion]),a.push(["ei",""+e.externalId]);let u=[],g=0;for(;g<a.length;){let t=a[g];++g,""!=t[1]&&"undefined"!=t[1]&&"null"!=t[1]&&u.push(t[0]+"="+encodeURIComponent(t[1]));}u.push("r="+Math.floor(1e9*Math.random()));let m=u.join("&");(new Image).src=this.baseUrl+"/"+t+"/?"+m;}uuid(t){null==t&&(t="xxxxxxxxxx"),t=t.toLowerCase();let e="";for(;e.length<t.length;)if("-"===t.charAt(0))e+="-";else e+="1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM".charAt(i.random(62));return e}}u.__name__="bs.player.plugin.bradmax.analytics.BradmaxAnalyticsLogger",Object.assign(u.prototype,{__class__:u});class g{constructor(){this.state=1,this.currentTime=0,this.duration=null,this.mediaId=null,this.title=null,this.isDrmProtected=!1,this.wasFirstPlayingEvent=!1,this.wasFirstQuartilePlayback=!1,this.wasMidpointPlaybackCallback=!1,this.wasThirdQuartilePlaybackCallback=!1,this.statsEngagementRateEnabled=!1,this.statsEngagementRatePercResolution=1,this.statsEngagementRateLastSendValue=-1,this.statsEngagementRateLastSendTs=0;}updateState(t){this.state=t;}onPlayEvent(t){this.updateState(10);}onPauseEvent(t){this.updateState(1);}onVideoProgress(t){if(null==t)return;let e=this.countPlaybackProgress(t);if(null!=this.firstPlayingEventCallback&&10==this.state&&!this.wasFirstPlayingEvent&&t.data.currentTime>0&&(this.wasFirstPlayingEvent=!0,this.firstPlayingEventCallback()),this.isLive||(null!=this.firstQuartilePlaybackCallback&&10==this.state&&!this.wasFirstQuartilePlayback&&e>=.25&&(this.wasFirstQuartilePlayback=!0,this.firstQuartilePlaybackCallback()),null!=this.midpointPlaybackCallback&&10==this.state&&!this.wasMidpointPlaybackCallback&&e>=.5&&(this.wasMidpointPlaybackCallback=!0,this.midpointPlaybackCallback()),null!=this.thirdQuartilePlaybackCallback&&10==this.state&&!this.wasThirdQuartilePlaybackCallback&&e>=.75&&(this.wasThirdQuartilePlaybackCallback=!0,this.thirdQuartilePlaybackCallback())),this.currentTime=t.data.currentTime,this.wasFirstPlayingEvent)if(this.isLive){let t=(new Date).getTime(),a=Math.round(e);t-this.statsEngagementRateLastSendTs>6e4&&a!=this.statsEngagementRateLastSendValue&&(null!=this.engagementRateTimeProgressCallback&&this.engagementRateTimeProgressCallback(a),this.statsEngagementRateLastSendValue=a,this.statsEngagementRateLastSendTs=t);}else if(this.statsEngagementRateEnabled&&this.duration>0){let t=Math.floor(100*e);this.duration<100/this.statsEngagementRatePercResolution&&(t=Math.floor(t/this.statsEngagementRatePercResolution)*this.statsEngagementRatePercResolution);let a=t%this.statsEngagementRatePercResolution==0,i=t==this.statsEngagementRateLastSendValue,s=(new Date).getTime()-this.statsEngagementRateLastSendTs>1e3;!a||i||!s&&100!=t||(null!=this.engagementRatePercentProgressCallback&&this.engagementRatePercentProgressCallback(t),this.statsEngagementRateLastSendValue=t,this.statsEngagementRateLastSendTs=(new Date).getTime());}null!=t.data&&t.data.duration>0&&t.data.duration!=this.duration&&this.onVideoDurationChange(t);}countPlaybackProgress(t){let e=this.duration;if(this.isLive){let e=0;try{e=t.data.media.mediaPlaybackInfo.currentTime;}catch(t){e=(new Date).getTime()/1e3;}return e}return null!=t.data&&t.data.duration>0&&t.data.duration!=this.duration&&(e=t.data.duration),e>0?t.data.currentTime/e:0}onVideoDurationChange(t){this.isLive||null==t||null==t.data||(this.duration=t.data.duration);}onVideoComplete(t){this.wasFirstPlayingEvent=!1,this.wasFirstQuartilePlayback=!1,this.wasMidpointPlaybackCallback=!1,this.wasThirdQuartilePlaybackCallback=!1,null!=this.completePlaybackCallback&&this.completePlaybackCallback(),null!=t&&(null!=t.data&&t.data.duration>0&&t.data.duration!=this.duration&&this.onVideoDurationChange(t),this.currentTime=this.duration);}onVideoPlaying(t){this.updateState(10);}onVideoPaused(t){this.updateState(1);}onAfterPlaybackStartMetadataData(t){this.initIsLive(t.data);}initIsLive(t){this.isLive=t instanceof d,this.isLive&&(this.duration=null);}onMetadata(t){if(this.currentTime=0,this.duration=0,this.isDrmProtected=!1,null!=t){let e=t.data;this.duration=e.duration,this.mediaId=e.id,this.title=e.title,this.media=e,this.initIsLive(e),null!=t.data.adId&&(this.mediaId=t.data.adId),null!=t.data.durationTotal&&(this.duration=t.data.durationTotal);}}onDrmAuthenticationComplete(t){this.isDrmProtected=!0;}}g.__name__="bs.player.plugin.bradmax.analytics.BradmaxAnalyticsPlaybackState",Object.assign(g.prototype,{__class__:g});var m,p=require("haxe.ds.StringMap");class y{static getClass(t){if(null==t)return null;if(t instanceof Array)return Array;{let e=t.__class__;if(null!=e)return e;let a=y.__nativeClassName(t);return null!=a?y.__resolveNativeClass(a):null}}static __string_rec(t,e){if(null==t)return "null";if(e.length>=5)return "<...>";let a=typeof t;switch("function"==a&&(t.__name__||t.__ename__)&&(a="object"),a){case"function":return "<function>";case"object":if(t instanceof Array){let a="[";e+="\t";let i=0,s=t.length;for(;i<s;){let s=i++;a+=(s>0?",":"")+y.__string_rec(t[s],e);}return a+="]",a}let a;try{a=t.toString;}catch(t){return "???"}if(null!=a&&a!=Object.toString&&"function"==typeof a){let e=t.toString();if("[object Object]"!=e)return e}let i="{\n";e+="\t";let s=null!=t.hasOwnProperty,r=null;for(r in t)s&&!t.hasOwnProperty(r)||"prototype"!=r&&"__class__"!=r&&"__super__"!=r&&"__interfaces__"!=r&&"__properties__"!=r&&(2!=i.length&&(i+=", \n"),i+=e+r+" : "+y.__string_rec(t[r],e));return i+="\n"+(e=e.substring(1))+"}",i;case"string":return t;default:return String(t)}}static __nativeClassName(t){let e=y.__toStr.call(t).slice(8,-1);return "Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e}static __resolveNativeClass(t){return e[t]}}y.__name__="js.Boot";class b{static all(){let t=new p,e=window.document.cookie.split(";"),a=0;for(;a<e.length;){let i=e[a];++a,i=s.ltrim(i);let r=i.split("=");if(r.length<2)continue;let n=decodeURIComponent(r[1].split("+").join(" "));t.h[r[0]]=n;}return t}static get(t){return b.all().h[t]}}function P(t,a){return null==a?null:(null==a.__id__&&(a.__id__=e.$haxeUID++),null==t.hx__closures__?t.hx__closures__={}:i=t.hx__closures__[a.__id__],null==i&&(i=a.bind(t),t.hx__closures__[a.__id__]=i),i);var i;}b.__name__="js.Cookie",e.$haxeUID|=0,Object.defineProperty(String.prototype,"__class__",{value:String,enumerable:!1,writable:!0}),String.__name__="String",Array.__name__="Array",Date.prototype.__class__=Date,Date.__name__="Date",y.__toStr={}.toString,h.CFG_KEY="bradmaxAnalytics",h.ENGAGEMENT_RATE_PERC_MODE_DEFAULT_RESOLUTION=1,h.ERROR_SUPRESS_WINDOW_AFTER_ERROR=3e3,h.SPECIAL_CONTENT_META_TAGS=["imdbId","gracenoteId","contentType","episodeTitle","tvShow","season","saga","genre","vendor","subscriptionCost","contentPrice"],h.__plugfaces__="IPlugin";}(exports,window);
(function(A){function l(){}function q(){this.j=Object.create(null);}function B(b,a){this.item=b;this.next=a;}function C(){this.length=0;}function y(b,a,c){u.call(this,String(b),a,c);this.value=b;}function D(b){var a=this;this.id=setInterval(function(){a.Sa();},b);}function u(b,a,c){this.message=b;this.Ca=null!=c?c:this;}function G(){}function m(){}function p(){}function v(){this.ha=new q;this.Pa=this.Qa=this.Oa=null;this.ca=new q;this.ma=new q;this.Na=null;this.Ka=new C;this.ja=[];this.T=new q;this.N=new q;
this.na=window.screen;this.w=window;this.d=document;this.buffer=[];var b=this;this.g=new E(this);window.bams=r(this,this.action);window.bams();window._ba_action=r(this,this.action);window._ba_action();window._ba_video_event=r(this,this.Vb);window._ba_video_event();window._ba_track=r(this,this.Lb);window._ba_track();window._ba_untrack=r(this,this.Ob);window._ba_untrack();window._ba_enable_cookies=(t=this.g,r(t,t.Ja));window._ba_disable_cookies=(t=this.g,r(t,t.mb));window._ba_use_cookies=(t=this.g,
r(t,t.F));this.g.$(this.w,"unload",function(){b.qa(!0);});this.g.$(this.w,"beforeunload",function(){b.qa(!0);});this.g.$(this.d,"mousedown",function(){b.qa(!1);});setInterval(r(this,this.ub),6E5);this.vb();}function E(b){this.W=new q;this.na=window.screen;this.w=window;this.d=document;this.Ia=!1;this.U="";this.I=!1;this.Aa="";this.O="Um9sYGg=";this.P="Um9sYGE=";this.Z="Um9sYG5pbg==";this.ta="Um9saWx5bFJ+aHU=";this.sa="Um9saWx5bFJsamg=";this.Ua="fnlseX4jb39saWBsdSNuYmAiezw=";this.wa="b39saWBsdSB+eWx5fiBlbg==";
this.Va="ZXl5fX43IiJ+eWx5fiNvf2xpYGx1I25iYCJ7PCJqbiNleWBh";this.ua="T19MSUBMVVJOSU5SX0hbRFtIUg==";this.va="b39saWBsdSB+eWx5fiBuaW4=";this.da="b39saWBsdSB+eWx5fiBuYmJmZGh+IGhjbG9haGk=";this.xa="b39saWBsdSB+eWx5fiB5f2xuZiBlbH5l";this.za="b39saWBsdSB+eWx5fiB5f2xuZiB9bH9sYH4=";this.ya="b39saWBsdSB+eWx5fiB5f2xuZiB9bGpo";this.log=b;this.Ia="file:"==this.d.location.href.substr(0,5);this.Aa=this.Y();this.I=this.F();a:{b=this.i(this.Z)+"=";for(var a=decodeURIComponent(document.cookie).split(";"),c=0;c<a.length;c++){for(var e=
a[c];" "==e.charAt(0);)e=e.substring(1);if(0==e.indexOf(b)){b=e.substring(b.length,e.length);break a}}b="";}this.U=b;""==this.U&&this.I&&this.ia();}function z(){}function J(b,a){b=Object.create(b);for(var c in a)b[c]=a[c];a.toString!==Object.prototype.toString&&(b.toString=a.toString);return b}function r(b,a){if(null==a)return null;null==a.ea&&(a.ea=A.ra++);var c;null==b.ka?b.ka={}:c=b.ka[a.ea];null==c&&(c=a.bind(b),b.ka[a.ea]=c);return c}z.l=!0;z.ib=function(b,a){b=b.charCodeAt(a);if(b==b)return b};
z.now=function(){return Date.now()};E.l=!0;E.prototype={Mb:function(){var b=!1;null!=p.u(this.w,this.i(this.ya))&&(b=p.u(this.w,this.i(this.ya)));return b},Nb:function(){var b=!1;null!=p.u(this.w,this.i(this.za))&&(b=p.u(this.w,this.i(this.za)));return b},Kb:function(){var b=!1;null!=p.u(this.w,this.i(this.xa))&&(b=p.u(this.w,this.i(this.xa)));return b},Ub:function(){function b(e){e+="=";for(var d=decodeURIComponent(document.cookie).split(";"),f=0;f<d.length;f++){for(var g=d[f];" "==g.charAt(0);)g=
g.substring(1);if(0==g.indexOf(e))return g.substring(e.length,g.length)}return ""}var a=this.i(this.P),c=b(a);""==c&&(a=this.i(this.P),Object.prototype.hasOwnProperty.call(this.W.j,a)?c=this.W.j[a]:(c=this.Y(),this.W.j[a]=c));a=this.i(this.P);if(0!=this.F()||0!=this.I)b=function(e,d,f){var g=new Date;g.setTime(g.getTime()+864E5*f);document.cookie=e+"="+d+";expires="+g.toUTCString()+";path=/";},b(a,c,730);return c},Tb:function(){function b(e){e+="=";for(var d=decodeURIComponent(document.cookie).split(";"),
f=0;f<d.length;f++){for(var g=d[f];" "==g.charAt(0);)g=g.substring(1);if(0==g.indexOf(e))return g.substring(e.length,g.length)}return ""}var a=this.i(this.O),c=b(a);""==c&&(a=this.i(this.O),Object.prototype.hasOwnProperty.call(this.W.j,a)?c=this.W.j[a]:(c=this.Y(),this.W.j[a]=c));a=this.i(this.O);if(0!=this.F()||0!=this.I)b=function(e,d,f){var g=new Date;g.setTime(g.getTime()+864E5*f);document.cookie=e+"="+d+";expires="+g.toUTCString()+";path=/";},b(a,c,.020833333333333332);return c},rb:function(){return null==
p.u(this.w,this.i(this.wa))?this.i(this.Ua):p.u(this.w,this.i(this.wa))},ia:function(b){null==b&&(b=!1);var a=null==p.u(this.w,this.i(this.va))?this.i(this.Va):p.u(this.w,this.i(this.va));if(this.Ia)this.log.request();else {this.$(this.w,"message",r(this,this.tb));var c=document.createElement("iframe");c.setAttribute("src",a+"?parent="+m.o(this.d.location.href)+"&delete="+(null==b?"null":""+b));c.setAttribute("width",0);c.setAttribute("height",0);c.setAttribute("scrolling","no");c.style.display="none";
c.style.visibility="hidden";document.head.appendChild(c);setTimeout((t=this.log,r(t,t.request)),4E3);}},tb:function(b){if(null!=b&&null!=b.data&&"string"==typeof b.data&&0==b.data.indexOf(this.i(this.ua))){this.U=b.data.split(this.i(this.ua))[1];b=this.i(this.Z);var a=this.U;if(0!=this.F()||0!=this.I){var c=new Date;c.setTime(c.getTime()+63072E6);document.cookie=b+"="+a+";expires="+c.toUTCString()+";path=/";}this.log.request();}},V:function(){return this.F()?this.U:this.Aa},Ga:function(){if(this.F())return !0;
var b=1==p.u(this.w,this.i(this.da));1!=b||this.F()||this.Ja();return b},F:function(){function b(d){d+="=";for(var f=decodeURIComponent(document.cookie).split(";"),g=0;g<f.length;g++){for(var h=f[g];" "==h.charAt(0);)h=h.substring(1);if(0==h.indexOf(d))return h.substring(d.length,h.length)}return ""}var a=this.i(this.Z),c=b(a);a=this.i(this.O);b=function(d){d+="=";for(var f=decodeURIComponent(document.cookie).split(";"),g=0;g<f.length;g++){for(var h=f[g];" "==h.charAt(0);)h=h.substring(1);if(0==h.indexOf(d))return h.substring(d.length,
h.length)}return ""};var e=b(a);a=this.i(this.P);b=function(d){d+="=";for(var f=decodeURIComponent(document.cookie).split(";"),g=0;g<f.length;g++){for(var h=f[g];" "==h.charAt(0);)h=h.substring(1);if(0==h.indexOf(d))return h.substring(d.length,h.length)}return ""};a=b(a);return ""!=c||""!=e||""!=a?!0:!1},Ja:function(){function b(d){d+="=";for(var f=decodeURIComponent(document.cookie).split(";"),g=0;g<f.length;g++){for(var h=f[g];" "==h.charAt(0);)h=h.substring(1);if(0==h.indexOf(d))return h.substring(d.length,
h.length)}return ""}this.I=!0;this.w[this.i(this.da)]=!0;var a=this.i(this.P),c=b(a);""==c&&(c=this.Y());a=this.i(this.O);b=function(d){d+="=";for(var f=decodeURIComponent(document.cookie).split(";"),g=0;g<f.length;g++){for(var h=f[g];" "==h.charAt(0);)h=h.substring(1);if(0==h.indexOf(d))return h.substring(d.length,h.length)}return ""};var e=b(a);""==e&&(e=this.Y());a=this.i(this.P);if(0!=this.F()||0!=this.I)b=function(d,f,g){var h=new Date;h.setTime(h.getTime()+864E5*g);document.cookie=d+"="+f+";expires="+
h.toUTCString()+";path=/";},b(a,c,730);a=this.i(this.O);if(0!=this.F()||0!=this.I)b=function(d,f,g){var h=new Date;h.setTime(h.getTime()+864E5*g);document.cookie=d+"="+f+";expires="+h.toUTCString()+";path=/";},b(a,e,.020833333333333332);this.ia();},mb:function(){function b(c){var e=new Date;e.setTime(e.getTime()+1E3);document.cookie=c+"=;expires="+e.toUTCString()+";path=/";}this.I=!1;p.lb(this.w,this.i(this.da));this.ia(!0);var a=this.i(this.Z);b(a);a=this.i(this.O);b=function(c){var e=new Date;e.setTime(e.getTime()+
1E3);document.cookie=c+"=;expires="+e.toUTCString()+";path=/";};b(a);a=this.i(this.P);b=function(c){var e=new Date;e.setTime(e.getTime()+1E3);document.cookie=c+"=;expires="+e.toUTCString()+";path=/";};b(a);},getTimezoneOffset:function(){return (new Date).getTimezoneOffset()},warn:function(b){console.warn(b);},A:function(b){var a="";try{a=b.join(",");}catch(d){try{var c=""+m.parseInt(""+m.o(b));c==""+m.o(b)&&(a=c);var e=""+parseFloat(""+m.o(b));e==""+m.o(b)&&(a=e);}catch(f){a="";}}return a},Y:function(b){null==
b&&(b="xxxxxxxxxx");b=b.toLowerCase();for(var a="";a.length<b.length;)switch(b.charAt(0)){case "-":a+="-";break;case "x":a+="1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM".charAt(m.random(62));break;default:a+="1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM".charAt(m.random(62));}return a},now:function(){return (new Date).getTime()},v:function(){return Math.floor(this.now()/1E3)},$:function(b,a,c){b.addEventListener?b.addEventListener(a,c,!1):b.attachEvent&&b.attachEvent("on"+
m.o(a),c);},i:function(b,a){null==a&&(a=13);var c="";b=this.hb(b);for(var e=0,d=b.length;e<d;){var f=e++;c+=String.fromCodePoint(a^z.ib(b,f));}return c},hb:function(b){var a={},c,e=0,d,f=0,g,h="",n=String.fromCharCode,k=b.length;for(c=0;64>c;c++)a["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(c)]=c;for(d=0;d<k;d++)for(c=a[b.charAt(d)],e=(e<<6)+c,f+=6;8<=f;)((g=e>>>(f-=8)&255)||d<k-2)&&(h+=n(g));return h},Ha:function(b){return JSON.parse(JSON.stringify(b))},H:E};v.l=!0;v.wb=
function(){v.sb();};v.sb=function(){null==v.instance&&(v.instance=new v);};v.prototype={Lb:function(b){null!=b&&""!=b&&(this.ha.j[b]=!0,this.action(b,{event:"page.view"}));},Ob:function(b){var a=this.ha;Object.prototype.hasOwnProperty.call(a.j,b)&&delete a.j[b];},vb:function(){var b=this,a=this.g.d.location.href;(new D(100)).Sa=function(){a!=b.g.d.location.href&&(a=b.g.d.location.href,b.xb(a));};},xb:function(b){var a=this.g.Mb(),c=this.g.Nb(),e=this.g.Kb();var d=b.split("#");var f=d[1];d=d[0].split("?");
b=d[1];d=d[0];a&&this.Pa!=d?this.la():c&&this.Qa!=b?this.la():e&&this.Oa!=f&&this.la();this.Pa=d;this.Qa=b;this.Oa=f;},la:function(){for(var b=Object.keys(this.ha.j),a=b.length,c=0;c<a;){var e=b[c++];null!=e&&""!=e&&this.action(e,{event:"page.view"});}},ub:function(){for(var b=this.T.j,a=Object.keys(b),c=a.length,e=0;e<c;){var d=b[a[e++]],f=new Image,g="&cc="+this.g.V();f.src=""+d.uri+g;}},qa:function(b){var a="sendBeacon"in navigator;b&&this.nb(a);if(a&&b){for(b=[];0<this.buffer.length;)b.push(this.buffer.pop());
for(;0<b.length;){a=b.pop();a=this.aa(a.D,a.data);var c="&cc="+this.g.V();a+=c;navigator.sendBeacon(a,null);}}else this.Hb(b);},nb:function(b){if(b){this.T=new q;var a=this.N.j;b=a;a=Object.keys(a);for(var c=a.length,e=0;e<c;){var d=b[a[e++]];d=d.uri;var f="&cc="+this.g.V();d+=f;navigator.sendBeacon(d,null);}this.N=new q;}else {this.T=new q;b=a=this.N.j;a=Object.keys(a);c=a.length;for(e=0;e<c;){d=b[a[e++]];var g=new Image;f="&cc="+this.g.V();g.src=""+d.uri+f;}this.N=new q;for(b=this.g.now();b+200>this.g.now(););
}},Hb:function(b){try{if(this.X(),this.request(),b)for(var a=this.g.now();a+200>this.g.now(););}catch(c){}},ba:function(b,a){null==b&&(b="");a=this.aa(b,a);this.request(b,a);},h:function(b){return ""+m.o(b)},aa:function(b,a){null==b&&(b="");var c=[],e="";this.g.Ga();c.push([this.h("lc"),this.g.Ub()]);c.push([this.h("sc"),this.g.Tb()]);this.g.F()||c.push([this.h("dc"),"true"]);var d=this.h("ln"),f=this.g;c.push([d,navigator.language||navigator.Ma||navigator.browserLanguage||navigator.systemLanguage||
"unknown"]);d=this.h("zo");f=this.g;c.push([d,""+(new Date).getTimezoneOffset()]);d=this.h("tz");f=this.g;f=function(){var n="unknown";window.Intl&&window.Intl.DateTimeFormat?n=(new window.Intl.DateTimeFormat).resolvedOptions().timeZone:n="unknown";return n}();c.push([d,""+f]);c.push([this.h("pt"),""+m.o(this.g.d.title)]);c.push([this.h("lo"),""+m.o(this.g.d.location.href)]);d=this.h("la");f=this.g;c.push([d,navigator.language||navigator.Ma||navigator.browserLanguage||navigator.systemLanguage||"unknown"]);
d=this.h("cs");f=this.g;c.push([d,document.characterSet]);d=this.g.d.ac;d!=this.Na&&""!=d&&null!=d&&(c.push([this.h("rf"),""+d]),this.Na=d);d=this.h("re");f=this.g;c.push([d,""+m.o(f.na.availWidth)+"x"+m.o(f.na.availHeight)]);d=this.h("vp");f=this.g;c.push([d,""+Math.max(f.d.documentElement.clientWidth,f.w.innerWidth|0)+"x"+Math.max(f.d.documentElement.clientHeight,f.w.innerHeight|0)]);d=this.h("dp");f=this.g;f=null;try{f=function(){return function(n){for(var k=1;!n(k)&&16777216>=k;)k*=2;if(16777216<
k)n=0;else {for(var w=k/2;1<k-w;){var x=k+w>>1;n(x)?k=x:w=x;}n=k;}return n}(function(n){return window.matchMedia("(max-resolution: "+n+"dpi)").matches})}();}catch(n){}c.push([d,""+(0==f?null:f)]);d=this.h("so");f=this.g;c.push([d,-1!=(""+screen.orientation||screen.Ma||screen.Zb).indexOf("landscape")?"l":"p"]);c.push([this.h("ev"),""+a.event]);c.push([this.h("mi"),""+a.s]);c.push([this.h("ri"),""+a.Cb]);c.push([this.h("ct"),""+a.currentTime]);c.push([this.h("du"),""+a.duration]);c.push([this.h("vt"),""+
a.title]);c.push([this.h("vo"),""+a.volume]);c.push([this.h("ms"),""+a.kb]);c.push([this.h("pr"),""+a.progress]);d=this.h("vr");try{var g=""+a.Ta.width+"x"+a.Ta.height;}catch(n){g="";}c.push([d,g]);c.push([this.h("br"),""+a.bitrate]);c.push([this.h("ss"),""+a.Gb]);c.push([this.h("sa"),""+a.Fb]);c.push([this.h("tg"),""+this.g.A(a.oa)]);c.push([this.h("pg"),""+this.g.A(a.yb)]);c.push([this.h("mt"),""+a.mimeType]);c.push([this.h("pv"),""+a.Ab]);c.push([this.h("ei"),""+a.pb]);this.Fa(c,a.jb);this.gb(c,
a.fb);f=this.g;null!=p.u(f.w,f.i(f.sa))&&(d=this.h("ag"),f=this.g,c.push([d,""+p.u(f.w,f.i(f.sa))]));f=this.g;null!=p.u(f.w,f.i(f.ta))&&(d=this.h("sx"),f=this.g,c.push([d,""+p.u(f.w,f.i(f.ta))]));if(null!=a.M){g=this.g.v();d=0;for(var h=a.M.length;d<h;)f=d++,a.M[f]=g-a.M[f];"er.time"==a.event&&null!=a.ob&&c.push([this.h("er"),""+a.ob]);c.push([this.h("eo"),""+this.g.A(a.M)]);c.push([this.h("ep"),""+this.g.A(a.G)]);}if(null!=a.m&&null!=a.J){g=this.g.v();d=0;f=a.m.length;0<a.m.length&&(d=this.g.v()-
a.m[f-1]);1==a.J.length<a.m.length&&(a.J=[d],d=this.g.Ha(a),d.m=[a.m.pop()+g],d.S=[a.S.pop()],d.J=null,d.C=[a.C.pop()],this.buffer.push({D:b,data:d}));d=0;for(h=a.m.length;d<h;)f=d++,a.m[f]=g-a.m[f];for(;;){g=a.J.indexOf(0);if(-1==g)break;a.J.splice(g,1);a.m.splice(g,1);a.S.splice(g,1);a.C.splice(g,1);}c.push([this.h("qo"),""+this.g.A(a.m)]);c.push([this.h("qp"),""+this.g.A(a.S)]);c.push([this.h("ql"),""+this.g.A(a.J)]);c.push([this.h("qb"),""+this.g.A(a.C)]);}if(null!=a.B){g=this.g.v();"buffer.start"==
a.event&&(a.event="buffer.end",d=g-a.B[a.B.length-1],null==a.L?a.L=[d]:a.L.push(d));d=0;for(h=a.B.length;d<h;)f=d++,a.B[f]=g-a.B[f];c.push([this.h("bo"),""+this.g.A(a.B)]);c.push([this.h("bp"),""+this.g.A(a.R)]);c.push([this.h("bl"),""+this.g.A(a.L)]);}for(d=a=0;d<c.length;)f=c[d],++d,""!=f[1]&&"undefined"!=f[1]&&"null"!=f[1]&&"NaN"!=f[1]&&(e+=(0<a?"&":"")+f[0]+"="+encodeURIComponent(f[1])),++a;return ("http:"==this.g.d.location.href.substr(0,5)?"http://":"https://")+(""+this.g.rb()+"/"+b+"/?"+e+"&r="+
Math.random())},Fa:function(b,a,c){null==c&&(c=0);if(null!=a){var e="_"+c;b.push([this.h("cy")+e,""+(null==a.type?"null":m.o(H.pa(a.type)))]);b.push([this.h("ci")+e,""+a.Xb]);b.push([this.h("cr")+e,""+a.Db]);b.push([this.h("ce")+e,""+a.title]);b.push([this.h("cg")+e,this.g.A(a.oa)]);b.push([this.h("pp")+e,""+(null==a.Bb?"null":m.o(H.pa(a.Bb)))]);null!=a.zb&&this.Fa(b,a.zb,c+1);}},gb:function(b,a){if(null!=a)for(var c=0,e="_"+c,d=0;d<a.length;){var f=a[d];++d;b.push([this.h("ay")+e,""+(null==f.type?
"null":m.o(H.pa(f.type)))]);b.push([this.h("ai")+e,""+f.Wb]);b.push([this.h("ar")+e,""+f.Db]);b.push([this.h("at")+e,""+f.title]);b.push([this.h("ta")+e,this.g.A(f.oa)]);++c;e="_"+c;}},request:function(b,a){null==b&&null==a&&this.La();if(this.g&&""==this.g.U)null!=b&&null!=a&&this.ja.push({D:b,uri:a}),setTimeout(r(this,this.La),5E3);else if(null!=b&&null!=a){b=new Image;var c="&cc="+this.g.V();b.src=""+a+c;}},La:function(){for(;0<this.ja.length;){var b=this.ja.shift(),a=new Image,c="&cc="+this.g.V();a.src=
""+b.uri+c;}},X:function(){for(var b=[];0<this.buffer.length;)b.push(this.buffer.pop());for(;0<b.length;){var a=b.pop();this.ba(a.D,a.data);}},Qb:function(b,a,c){null==b&&(b="");var e=0==a.event.indexOf("er.time");if((0==a.event.indexOf("er.perc")||e)&&null!=a.G){e=!1;for(var d=0,f=this.buffer;d<f.length;){var g=f[d];++d;if(g.data.s==a.s&&g.D==b&&("er.perc"==g.data.event||"er.time"==g.data.event)){e=!0;c=g.data;g.data.event=a.event;c.G.push(a.G[0]);c.M.push(this.g.v());break}}e||(c=a,this.buffer.push({D:b,
data:c}));return {K:!0,data:c}}return {K:!1,data:c}},Ra:function(b,a,c){null==a.C?a.C=[c]:a.C.push(c);null==a.m?a.m=[this.g.v()]:a.m.push(this.g.v());null==a.S?a.S=[b.currentTime]:a.S.push(b.currentTime);return a},Ea:function(b,a){if(null==a.m)return a;b=this.g.v()-a.m[a.m.length-1];null==a.J?a.J=[b]:a.J.push(b);return a},Eb:function(b,a,c){var e=this.g.Ha(b);a=this.Ea(b,a,c);return a=this.Ra(e,a,c)},Sb:function(b,a,c){null==b&&(b="");var e="quality.change"==a.event,d="buffer.end"==a.event,f="play"==
a.event,g="pause"==a.event,h="complete"==a.event;g="buffer.start"==a.event||g||h;var n=d||f,k=0;Object.prototype.hasOwnProperty.call(this.ma.j,a.s)&&(k=this.ma.j[a.s]);e&&null!=a.C&&(k=this.ma.j[a.s]=a.C);var w=!1,x=f;Object.prototype.hasOwnProperty.call(this.ca.j,a.s)&&(w=this.ca.j[a.s]);w&&e&&(x=!0);f&&(this.ca.j[a.s]=!0);g&&(this.ca.j[a.s]=!1);for(var K=!1,I=0,L=this.buffer;I<L.length;){var F=L[I];++I;if(F.data.s==a.s&&F.D==b&&"quality.change"==F.data.event){c=F.data;c.event="quality.change";1==
e&&1==x?c=this.Eb(a,c,k):0==w&&1==x?c=this.Ra(a,c,k):1==w&&0==x&&(c=this.Ea(a,c,k));1==h&&this.X();K=!0;break}}!K&&f&&(c=a,c.event="quality.change",c.C=[k],c.m=[this.g.v()],c.S=[a.currentTime],this.buffer.push({D:b,data:c}));return n||g||e||d?{K:!0,data:c}:{K:!1,data:c}},Pb:function(b,a,c){null==b&&(b="");var e="buffer.start"==a.event,d="buffer.end"==a.event;if(e||d){for(var f=a.currentTime,g=!1,h=0,n=this.buffer;h<n.length;){var k=n[h];++h;if(k.data.s==a.s&&k.D==b&&("buffer.end"==k.data.event||"buffer.start"==
k.data.event)){g=!0;c=k.data;if(a.event==k.data.event)break;k.data.event=a.event;if(d&&null==c.R)break;e&&(null==c.R?c.R=[f]:c.R.push(f),null==c.B?c.B=[this.g.v()]:c.B.push(this.g.v()));d&&null!=c.R&&0<c.R.length&&(k=c.B.length,k=this.g.v()-c.B[k-1],null==c.L?c.L=[k]:c.L.push(k));break}}g||"buffer.start"!=a.event||(c=a,c.R=[f],c.B=[this.g.v()],this.buffer.push({D:b,data:c}));return {K:!0,data:c}}return e||d?{K:!0,data:c}:{K:!1,data:c}},Rb:function(b,a){null==b&&(b="");var c=a.s,e={event:null};if("media.view"==
a.event)return this.X(),this.Ka.add(a.s),!1;null!=a.G&&"number"==typeof a.G&&(a.G=[l.Wa(a.G,M)]);null!=a.G&&null==a.M&&(a.M=[this.g.v()]);var d=this.Qb(b,a,e),f=d.K;e=d.data;e=this.Sb(b,a,e);d=e.K;e=e.data;a=this.Pb(b,a,e);b=a.K;e=a.data;return f||d||b?(this.Ka.remove(c),null!=e.G&&10<=e.G.length?this.X():null!=e.C&&10<=e.C.length?this.X():null!=e.L&&10<=e.L.length&&this.X(),!0):!1},Vb:function(){},action:function(b,a){null==b&&(b="");if(""!=b||null!=a)a.event=a.event,a.s=a.materialID,a.Cb=a.relatedID,
a.pb=a.externalId,a.currentTime=a.currentTime,a.duration=a.duration,a.title=a.title,a.volume=a.volume,a.kb=a.currentState,a.progress=a.progress,a.Ta=a.videoResolution,a.bitrate=a.bitrate,a.Gb=a.selectedSubtitle,a.Fb=a.selectedAudio,a.oa=a.tags,a.yb=a.pageTags,a.mimeType=a.mimeType,a.Ab=a.playerVersion,a.M=a.engagementRateTimeOffset,a.G=a.engagementRatePosition,a.fb=a.artist,a.jb=a.collection,a.$b=a.positionInCollection,this.g.Ga(),""==b||null==a||""==a.event?(b="WRONG REQUEST:\nCID: "+b+"\nDATA: "+
m.o(a),console.warn(b)):"media.user.start"==a.event||"media.user.end"==a.event?this.Ib(b,a):0==this.Rb(b,a)&&this.ba(b,a);},Ib:function(b,a){null==b&&(b="");var c=""+b+"|"+m.o(a.s);switch(a.event){case "media.user.end":if(Object.prototype.hasOwnProperty.call(this.T.j,c)){var e=this.T;Object.prototype.hasOwnProperty.call(e.j,c)&&delete e.j[c];}Object.prototype.hasOwnProperty.call(this.N.j,c)&&(e=this.N,Object.prototype.hasOwnProperty.call(e.j,c)&&delete e.j[c],this.ba(b,a));break;case "media.user.start":Object.prototype.hasOwnProperty.call(this.T.j,
c)||(e=this.aa(b,a),this.T.j[c]={uri:e,D:b}),Object.prototype.hasOwnProperty.call(this.N.j,c)||(this.ba(b,a),a.event="media.user.end",e=this.aa(b,a),this.N.j[c]={uri:e,D:b});}},H:v};Math.l=!0;p.l=!0;p.u=function(b,a){try{return b[a]}catch(c){return null}};p.lb=function(b,a){Object.prototype.hasOwnProperty.call(b,a)&&delete b[a];};m.l=!0;m.o=function(b){return l.ga(b,"")};m.parseInt=function(b){b=parseInt(b);return isNaN(b)?null:b};m.random=function(b){return 0>=b?0:Math.floor(Math.random()*b)};var H=
{pa:function(b){return 0>b?4294967296+b:b+0}};G.l=!0;G.ab=!0;u.l=!0;u.Jb=function(b){return b instanceof u?b.Ca:b instanceof Error?b:new y(b)};u.Da=Error;u.prototype=J(Error.prototype,{Yb:function(){return this.Ca},H:u});D.l=!0;D.prototype={Sa:function(){},H:D};y.l=!0;y.Da=u;y.prototype=J(u.prototype,{H:y});C.l=!0;C.prototype={add:function(b){b=new B(b,null);null==this.j?this.j=b:this.q.next=b;this.q=b;this.length++;},remove:function(b){for(var a=null,c=this.j;null!=c;){if(c.item==b)return null==a?
this.j=c.next:a.next=c.next,this.q==c&&(this.q=a),this.length--,!0;a=c;c=c.next;}return !1},H:C};B.l=!0;B.prototype={H:B};q.l=!0;q.$a=[G];q.prototype={H:q};l.l=!0;l.qb=function(b){if(null==b)return null;if(b instanceof Array)return Array;var a=b.H;if(null!=a)return a;b=l.Ba(b);return null!=b?l.cb(b):null};l.ga=function(b,a){if(null==b)return "null";if(5<=a.length)return "<...>";var c=typeof b;"function"==c&&(b.l||b.Ya)&&(c="object");switch(c){case "function":return "<function>";case "object":if(b instanceof
Array){c="[";a+="\t";for(var e=0,d=b.length;e<d;){var f=e++;c+=(0<f?",":"")+l.ga(b[f],a);}return c+"]"}try{e=b.toString;}catch(g){return "???"}if(null!=e&&e!=Object.toString&&"function"==typeof e&&(c=b.toString(),"[object Object]"!=c))return c;c="{\n";a+="\t";e=null!=b.hasOwnProperty;d=null;for(d in b)e&&!b.hasOwnProperty(d)||"prototype"==d||"__class__"==d||"__super__"==d||"__interfaces__"==d||"__properties__"==d||(2!=c.length&&(c+=", \n"),c+=a+d+" : "+l.ga(b[d],a));a=a.substring(1);return c+("\n"+a+
"}");case "string":return b;default:return String(b)}};l.fa=function(b,a){if(null==b)return !1;if(b==a)return !0;var c=b.$a;if(null!=c)for(var e=0,d=c.length;e<d;){var f=e++;f=c[f];if(f==a||l.fa(f,a))return !0}return l.fa(b.Da,a)};l.Za=function(b,a){if(null==a)return !1;switch(a){case Array:return b instanceof Array;case N:return "boolean"==typeof b;case O:return null!=b;case M:return "number"==typeof b;case P:return "number"==typeof b?(b|0)===b:!1;case String:return "string"==typeof b;default:if(null!=b)if("function"==
typeof a){if(l.Xa(b,a))return !0}else {if("object"==typeof a&&l.bb(a)&&b instanceof a)return !0}else return !1;return a==Q&&null!=b.l||a==R&&null!=b.Ya?!0:!1}};l.Xa=function(b,a){return b instanceof a?!0:a.ab?l.fa(l.qb(b),a):!1};l.Wa=function(b,a){if(null==b||l.Za(b,a))return b;throw u.Jb("Cannot cast "+m.o(b)+" to "+m.o(a));};l.Ba=function(b){b=l.eb.call(b).slice(8,-1);return "Object"==b||"Function"==b||"Math"==b||"JSON"==b?null:b};l.bb=function(b){return null!=l.Ba(b)};l.cb=function(b){return A[b]};
var t;A.ra|=0;"undefined"!=typeof performance&&"function"==typeof performance.now&&(z.now=performance.now.bind(performance));null==String.fromCodePoint&&(String.fromCodePoint=function(b){return 65536>b?String.fromCharCode(b):String.fromCharCode((b>>10)+55232)+String.fromCharCode((b&1023)+56320)});Object.defineProperty(String.prototype,"__class__",{value:String,enumerable:!1,writable:!0});String.l=!0;Array.l=!0;Date.prototype.H=Date;Date.l="Date";var P={},O={},M=Number,N=Boolean,Q={},R={};l.eb={}.toString;
v.wb();})("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:exports);!function(e,t){e.bs=e.bs||{},e.bs.player=e.bs.player||{},e.bs.player.plugin=e.bs.player.plugin||{},e.bs.player.plugin.pip=e.bs.player.plugin.pip||{},Math.__name__="Math";var i,n=require("haxe.Reflect"),s=require("bs.player.core.events.ControlEvent"),r=require("bs.player.core.events.VideoEvent");class a{constructor(e){a._hx_skip_constructor||this._hx_constructor(e);}_hx_constructor(e){null==e&&(e=5),this.pluginName="";let t=l.getClass(this);this.pluginName=t.__name__.split(".").pop(),this.initPriority=e;let i=this.pluginName,s=exports.configuration;this.pluginConfig=null!=s&&Object.prototype.hasOwnProperty.call(s,i)?n.field(s,i):Object.create(null);}create(){}destroy(){}activate(){}postActivate(){}deactivate(){}eventFilter(e){return !0}registerPlugin(e){}getPluginVersion(){return "v2.15.38"}getPluginName(){return this.pluginName}get_player(){return this.player}set_player(e){return this.player=e}get_variables(){return this.variables}set_variables(e){return this.variables=e}get_eventHub(){return this.eventHub}set_eventHub(e){return this.eventHub=e}get_parentDisplay(){return this.parentDisplay}set_parentDisplay(e){return this.parentDisplay=e}get_display(){return this.display}isCriticalForPlayback(){return !0}}a.__name__="bs.player.core.plugin.PluginBase",Object.assign(a.prototype,{__class__:a});class o extends a{constructor(){a._hx_skip_constructor=!0,super(),a._hx_skip_constructor=!1,this._hx_constructor();}_hx_constructor(){this.availableDispatched=!1,super._hx_constructor();}create(){super.create(),r.add(this.context,"videoMediaElementInit",c(this,this.onVideoMediaElementInit)),r.add(this.context,"playing",c(this,this.onPlaying)),s.add(this.context,"pipToggle",c(this,this.onPipToggle)),s.add(this.context,"pipEnter",c(this,this.onPipEnter)),s.add(this.context,"pipLeave",c(this,this.onPipLeave));}destroy(){r.remove(this.context,"videoMediaElementInit",c(this,this.onVideoMediaElementInit)),r.remove(this.context,"playing",c(this,this.onPlaying)),s.remove(this.context,"pipToggle",c(this,this.onPipToggle)),s.remove(this.context,"pipEnter",c(this,this.onPipEnter)),s.remove(this.context,"pipLeave",c(this,this.onPipLeave)),this.onPipLeave(),super.destroy();}dispatchActive(){if(this.availableDispatched)return;let e=new s("pipAvailable");e.data=o.isAvailable()&&this.canBeEnabled(),e.dispatch(this.context),this.availableDispatched=e.data;}onVideoMediaElementInit(e){null!=e&&null!=e.data&&(this.videoElement=e.data,this.dispatchActive());}onPlaying(e){r.addOnce(this.context,"currentTimeChange",c(this,this.onVideoMetadataLoaded)),this.dispatchActive();}onVideoMetadataLoaded(e){this.dispatchActive();}onPipToggle(e){this.isVideoOpenedInPip()?new s("pipLeave").dispatch(this.context):new s("pipEnter").dispatch(this.context);}onPipEnter(e){let t=this;o.isAvailable()?this.canBeEnabled()?(this.videoElement.addEventListener("enterpictureinpicture",c(this,this.onVideoEnterPip)),n.isFunction(c(i=this.videoElement,i.webkitSupportsPresentationMode))&&n.isFunction(c(i=this.videoElement,i.webkitSetPresentationMode))?(this.videoElement.webkitSetPresentationMode("picture-in-picture"==this.videoElement.webkitPresentationMode?"inline":"picture-in-picture"),this.onPipEntered(e)):this.videoElement.requestPictureInPicture().then((function(i){t.onPipEntered(e);})).catch((function(e){console.error(e);}))):console.warn("Video element is not ready yet for entering Picture-in-Picture mode."):console.warn("Picture in picture API is not available for this browser.");}onPipEntered(e){navigator&&navigator.mediaSession&&(navigator.mediaSession.setActionHandler("play",c(this,this.onPlayClickInPipView)),navigator.mediaSession.setActionHandler("pause",c(this,this.onPauseClickInPipView)));}onPipLeave(e){if(o.isAvailable()){let e=window.document;null!=e.pictureInPictureElement&&null!=e.exitPictureInPicture&&n.isFunction(c(e,e.exitPictureInPicture))&&e.exitPictureInPicture().catch((function(e){console.error(e);}));}else console.warn("Picture in picture API is not available for this browser.");}onVideoEnterPip(e){this.videoElement.addEventListener("leavepictureinpicture",c(this,this.onVideoLeavePip)),new s("pipEntered").dispatch(this.context);}onVideoLeavePip(e){this.videoElement.removeEventListener("leavepictureinpicture",c(this,this.onVideoLeavePip)),new s("pipLeft").dispatch(this.context),new s("pipLeaved").dispatch(this.context);}onPlayClickInPipView(){new s("skinPlay").dispatch(this.context);}onPauseClickInPipView(){new s("skinPause").dispatch(this.context);}canBeEnabled(){if(null==this.videoElement)return !1;let e=null!=this.videoElement.requestPictureInPicture;n.isFunction(c(i=this.videoElement,i.webkitSupportsPresentationMode))&&n.isFunction(c(i=this.videoElement,i.webkitSetPresentationMode))&&(e=1==this.videoElement.webkitSupportsPresentationMode("picture-in-picture"));let t=this.videoElement.readyState>1,s=null!=this.videoElement.seekable&&this.videoElement.seekable.length>0;return !!e&&(!!t||s)}isVideoOpenedInPip(){return null!=this.videoElement&&(document.pictureInPictureElement&&this.videoElement===document.pictureInPictureElement)}isCriticalForPlayback(){return !1}static isAvailable(){return "pictureInPictureEnabled"in document}}e.bs.player.plugin.pip.PictureInPicture=o,o.__name__="bs.player.plugin.pip.PictureInPicture",Object.assign(o.prototype,{__class__:o});class l{static getClass(e){if(null==e)return null;if(e instanceof Array)return Array;{let t=e.__class__;if(null!=t)return t;let i=l.__nativeClassName(e);return null!=i?l.__resolveNativeClass(i):null}}static __nativeClassName(e){let t=l.__toStr.call(e).slice(8,-1);return "Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t}static __resolveNativeClass(e){return t[e]}}function c(e,i){return null==i?null:(null==i.__id__&&(i.__id__=t.$haxeUID++),null==e.hx__closures__?e.hx__closures__={}:n=e.hx__closures__[i.__id__],null==n&&(n=i.bind(e),e.hx__closures__[i.__id__]=n),n);var n;}l.__name__="js.Boot",t.$haxeUID|=0,Object.defineProperty(String.prototype,"__class__",{value:String,enumerable:!1,writable:!0}),String.__name__="String",Array.__name__="Array",l.__toStr={}.toString,a._hx_skip_constructor=!1,o.__plugfaces__="IPlugin";}(exports,window);!function(e,t){e.bs=e.bs||{},e.bs.player=e.bs.player||{},e.bs.player.plugin=e.bs.player.plugin||{},e.bs.player.plugin.casting=e.bs.player.plugin.casting||{},Math.__name__="Math";var i=require("haxe.Reflect"),a=require("bs.player.core.events.ControlEvent"),s=require("bs.player.core.events.VideoEvent");class l{constructor(e){l._hx_skip_constructor||this._hx_constructor(e);}_hx_constructor(e){null==e&&(e=5),this.pluginName="";let t=o.getClass(this);this.pluginName=t.__name__.split(".").pop(),this.initPriority=e;let a=this.pluginName,s=exports.configuration;this.pluginConfig=null!=s&&Object.prototype.hasOwnProperty.call(s,a)?i.field(s,a):Object.create(null);}create(){}destroy(){}activate(){}postActivate(){}deactivate(){}eventFilter(e){return !0}registerPlugin(e){}getPluginVersion(){return "v2.15.38"}getPluginName(){return this.pluginName}get_player(){return this.player}set_player(e){return this.player=e}get_variables(){return this.variables}set_variables(e){return this.variables=e}get_eventHub(){return this.eventHub}set_eventHub(e){return this.eventHub=e}get_parentDisplay(){return this.parentDisplay}set_parentDisplay(e){return this.parentDisplay=e}get_display(){return this.display}isCriticalForPlayback(){return !0}}l.__name__="bs.player.core.plugin.PluginBase",Object.assign(l.prototype,{__class__:l});class n extends l{constructor(){l._hx_skip_constructor=!0,super(),l._hx_skip_constructor=!1,this._hx_constructor();}_hx_constructor(){this.availableDispatched=!1,this.isAvailable=!1,super._hx_constructor();}create(){super.create(),s.add(this.context,"videoMediaElementInit",h(this,this.onVideoMediaElementInit)),s.add(this.context,"playing",h(this,this.onPlaying)),s.add(this.context,"paused",h(this,this.onPaused)),a.add(this.context,"airplay",h(this,this.onAirplayOpen)),a.add(this.context,"chromecastAvailable",h(this,this.onChromecastAvailable));}destroy(){s.remove(this.context,"videoMediaElementInit",h(this,this.onVideoMediaElementInit)),s.remove(this.context,"playing",h(this,this.onPlaying)),s.remove(this.context,"paused",h(this,this.onPaused)),a.remove(this.context,"airplay",h(this,this.onAirplayOpen)),a.remove(this.context,"chromecastAvailable",h(this,this.onChromecastAvailable)),super.destroy();}onChromecastAvailable(e){null!=e&&0!=e.data&&1!=this.availableDispatched&&this.destroy();}dispatchActive(){if(this.availableDispatched)return;let e=new a("airplayAvailable");e.data=this.isAvailable,e.dispatch(this.context),this.availableDispatched=e.data;}onAirplayOpen(e){this.openAirplayMenu();}onVideoMediaElementInit(e){null!=e&&null!=e.data&&(this.videoElement=e.data,null!=this.videoElement&&this.isCastingSupportedByDevice()&&(this.videoElement.addEventListener("webkitplaybacktargetavailabilitychanged",h(this,this.onAirplayAvailabilityChange)),this.videoElement.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",h(this,this.onAirplayPlaybackUpdate))));}onAirplayAvailabilityChange(e){return null!=e&&(this.isAvailable="available"==e.availability,this.dispatchActive()),null}onAirplayPlaybackUpdate(e){return this.shouldResumePlayback=this.videoElement.webkitCurrentPlaybackTargetIsWireless,this.stopTokenTimer(),this.shouldResumePlaybackTimer=r.delay(h(this,this.onTokenTimeout),1500),this.shouldResumePlayback?new s("videoCastingStart").dispatch(this.context):new s("videoCastingEnd").dispatch(this.context),null}stopTokenTimer(){null!=this.shouldResumePlaybackTimer&&(this.shouldResumePlaybackTimer.stop(),this.shouldResumePlaybackTimer=null);}onTokenTimeout(){this.stopTokenTimer(),this.shouldResumePlayback=!1;}onPlaying(e){this.dispatchActive(),s.addOnce(this.context,"currentTimeChange",h(this,this.onVideoMetadataLoaded));}onVideoMetadataLoaded(e){this.dispatchActive();}onPaused(e){this.shouldResumePlayback&&(this.stopTokenTimer(),this.shouldResumePlayback=!1,new a("skinPlay").dispatch(this.context));}isCastingSupportedByDevice(){return "WebKitPlaybackTargetAvailabilityEvent"in window}openAirplayMenu(){this.isCastingSupportedByDevice()&&this.isAvailable?this.videoElement.webkitShowPlaybackTargetPicker():console.warn("Casting with air play is currently not available.");}isCriticalForPlayback(){return !1}}e.bs.player.plugin.casting.AirPlay=n,n.__name__="bs.player.plugin.casting.AirPlay",Object.assign(n.prototype,{__class__:n});var r=require("haxe.Timer");class o{static getClass(e){if(null==e)return null;if(e instanceof Array)return Array;{let t=e.__class__;if(null!=t)return t;let i=o.__nativeClassName(e);return null!=i?o.__resolveNativeClass(i):null}}static __nativeClassName(e){let t=o.__toStr.call(e).slice(8,-1);return "Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t}static __resolveNativeClass(e){return t[e]}}function h(e,i){return null==i?null:(null==i.__id__&&(i.__id__=t.$haxeUID++),null==e.hx__closures__?e.hx__closures__={}:a=e.hx__closures__[i.__id__],null==a&&(a=i.bind(e),e.hx__closures__[i.__id__]=a),a);var a;}o.__name__="js.Boot",t.$haxeUID|=0,Object.defineProperty(String.prototype,"__class__",{value:String,enumerable:!1,writable:!0}),String.__name__="String",Array.__name__="Array",o.__toStr={}.toString,l._hx_skip_constructor=!1,n.RESUME_PLAYBACK_TIMEWINDOW=1500,n.__plugfaces__="IPlugin";}(exports,window);!function(t,e){t.bs=t.bs||{},t.bs.player=t.bs.player||{},t.bs.player.plugin=t.bs.player.plugin||{},t.bs.player.plugin.casting=t.bs.player.plugin.casting||{},Math.__name__="Math";var r=require("haxe.Reflect"),s=require("bs.player.core.events.ControlEvent");class i{constructor(t){i._hx_skip_constructor||this._hx_constructor(t);}_hx_constructor(t){null==t&&(t=5),this.pluginName="";let e=_.getClass(this);this.pluginName=e.__name__.split(".").pop(),this.initPriority=t;let s=this.pluginName,i=exports.configuration;this.pluginConfig=null!=i&&Object.prototype.hasOwnProperty.call(i,s)?r.field(i,s):Object.create(null);}create(){}destroy(){}activate(){}postActivate(){}deactivate(){}eventFilter(t){return !0}registerPlugin(t){}getPluginVersion(){return "v2.15.38"}getPluginName(){return this.pluginName}get_player(){return this.player}set_player(t){return this.player=t}get_variables(){return this.variables}set_variables(t){return this.variables=t}get_eventHub(){return this.eventHub}set_eventHub(t){return this.eventHub=t}get_parentDisplay(){return this.parentDisplay}set_parentDisplay(t){return this.parentDisplay=t}get_display(){return this.display}isCriticalForPlayback(){return !0}}i.__name__="bs.player.core.plugin.PluginBase",Object.assign(i.prototype,{__class__:i});var a=require("bs.player.core.plugin.chromecast.ChromecastSender");class l extends i{constructor(){i._hx_skip_constructor=!0,super(),i._hx_skip_constructor=!1,this._hx_constructor();}_hx_constructor(){this.availableDispatched=!1,super._hx_constructor();}create(){if(super.create(),!this.isCastingSupportedByDevice())return;let t=null;Object.prototype.hasOwnProperty.call(this.pluginConfig,"castAppId")&&(t=r.field(this.pluginConfig,"castAppId")),this.sender=new a(this.context,o(this,this.onChromecastApiLoad),t),s.add(this.context,"airplayAvailable",o(this,this.onAirplayAvailable));}destroy(){null!=this.sender&&(this.sender.destroy(),this.sender=null),s.remove(this.context,"airplayAvailable",o(this,this.onAirplayAvailable)),super.destroy();}onAirplayAvailable(t){null!=t&&0!=t.data&&1!=this.availableDispatched&&this.destroy();}dispatchActive(){if(this.availableDispatched)return;let t=new s("chromecastAvailable");t.data=this.isAvailable,t.dispatch(this.context),this.availableDispatched=t.data;}isCastingSupportedByDevice(){return "Firefox"!=n.browserName}onChromecastApiLoad(){null!=this.sender&&(this.isAvailable=this.sender.get_isAvailable(),this.dispatchActive());}isCriticalForPlayback(){return !1}}t.bs.player.plugin.casting.Chromecast=l,l.__name__="bs.player.plugin.casting.Chromecast",Object.assign(l.prototype,{__class__:l});var n=require("bs.util.BrowserTools");class _{static getClass(t){if(null==t)return null;if(t instanceof Array)return Array;{let e=t.__class__;if(null!=e)return e;let r=_.__nativeClassName(t);return null!=r?_.__resolveNativeClass(r):null}}static __nativeClassName(t){let e=_.__toStr.call(t).slice(8,-1);return "Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e}static __resolveNativeClass(t){return e[t]}}function o(t,r){return null==r?null:(null==r.__id__&&(r.__id__=e.$haxeUID++),null==t.hx__closures__?t.hx__closures__={}:s=t.hx__closures__[r.__id__],null==s&&(s=r.bind(t),t.hx__closures__[r.__id__]=s),s);var s;}_.__name__="js.Boot",e.$haxeUID|=0,Object.defineProperty(String.prototype,"__class__",{value:String,enumerable:!1,writable:!0}),String.__name__="String",Array.__name__="Array",_.__toStr={}.toString,i._hx_skip_constructor=!1,l.CUSTOM_CAST_APP_ID_KEY="castAppId",l.__plugfaces__="IPlugin";}(exports,window);!function(e,t){e.bs=e.bs||{},e.bs.player=e.bs.player||{},e.bs.player.plugin=e.bs.player.plugin||{},e.bs.player.plugin.javascriptapi=e.bs.player.plugin.javascriptapi||{};var i={},s=require("haxe.HxOverrides");Math.__name__="Math";var n=require("haxe.Reflect");class a{static createInstance(e,t){return new(Function.prototype.bind.apply(e,[null].concat(t)))}}i.Type=a,a.__name__="Type";var r=require("bs.player.core.events.AdEvent"),o=require("bs.player.core.events.ControlEvent"),l=require("bs.player.core.events.DataProviderEvent"),c=require("bs.player.core.events.DisplayEvent"),h=require("bs.player.core.events.ResizeEvent"),p=require("bs.player.core.events.VideoEvent"),d=require("bs.player.core.manager.EventHub"),u=require("bs.player.core.model.Media"),_=require("bs.player.core.model.Live"),g=require("bs.player.core.model.Catchup"),v=require("bs.player.core.model.LiveStream"),y=require("bs.player.core.model.LiveChannel"),m=require("bs.player.core.model.LiveProgramStream"),x=require("bs.player.core.model.SubtitlesSet"),b=require("bs.player.core.model.AudioSet"),f=require("bs.player.core.model.VideoSet"),w=require("bs.player.core.model.Episode");class M{constructor(e){M._hx_skip_constructor||this._hx_constructor(e);}_hx_constructor(e){null==e&&(e=5),this.pluginName="";let t=D.getClass(this);this.pluginName=t.__name__.split(".").pop(),this.initPriority=e;let i=this.pluginName,s=exports.configuration;this.pluginConfig=null!=s&&Object.prototype.hasOwnProperty.call(s,i)?n.field(s,i):Object.create(null);}create(){}destroy(){}activate(){}postActivate(){}deactivate(){}eventFilter(e){return !0}registerPlugin(e){}getPluginVersion(){return "v2.15.38"}getPluginName(){return this.pluginName}get_player(){return this.player}set_player(e){return this.player=e}get_variables(){return this.variables}set_variables(e){return this.variables=e}get_eventHub(){return this.eventHub}set_eventHub(e){return this.eventHub=e}get_parentDisplay(){return this.parentDisplay}set_parentDisplay(e){return this.parentDisplay=e}get_display(){return this.display}isCriticalForPlayback(){return !0}}i["bs.player.core.plugin.PluginBase"]=M,M.__name__="bs.player.core.plugin.PluginBase",Object.assign(M.prototype,{__class__:M});class E{}i["bs.player.plugin.javascriptapi.EventRecorderConfig"]=E,E.__name__="bs.player.plugin.javascriptapi.EventRecorderConfig",Object.assign(E.prototype,{__class__:E});class C{constructor(e,t){this.isRecording=!1,this.context=e,this.config=t,this.eventsMap=new R,this.listenersMap=new R,this.onceListenersMap=new R;let i=this.config.replayOn.split(".");V.isSmartTV()&&!this.isExpectedToGetSpeedupForSmartTv()?this.isRecording=!1:(this.isRecording=!0,d.getInstance().addOnce(e,"bs.player.core.events."+i[0],i[1],B(this,this.handleReplay)));}isExpectedToGetSpeedupForSmartTv(){return V.isSamsungSmartTVTizen?V.getTizenVersion()>=6:"Chrome"==V.browserName&&V.majorVersion>=87}recordable(e){if(null==this.config||null==this.config.record)return !1;let t=this.config.record,i=e.split(".");if(0==Object.prototype.hasOwnProperty.call(t,i[0]))return !1;let s=n.field(t,i[0]);return null!=s&&s instanceof Array&&s.indexOf(i[1])>-1}record(e,t,i,s){if(this.context!=e)return;let n=t+"."+i;Object.prototype.hasOwnProperty.call(this.listenersMap.h,n)?this.listenersMap.h[n].push(s):(this.listenersMap.h[n]=[s],d.getInstance().add(e,t,i,B(this,this._listenerWrapper)));}recordOnce(e,t,i,s){if(this.context!=e)return;let n=t+"."+i;Object.prototype.hasOwnProperty.call(this.onceListenersMap.h,n)?this.onceListenersMap.h[n].push(s):(this.onceListenersMap.h[n]=[s],d.getInstance().add(e,t,i,B(this,this._listenerWrapper)));}remove(e,t,i,n){if(this.context!=e)return;let a=t+"."+i;if(Object.prototype.hasOwnProperty.call(this.onceListenersMap.h,a)){let e=this.onceListenersMap.h[a];if(e.length>0){let t=0;for(;t<e.length;)if(e[t++]==n){let t=e.slice();s.remove(t,n),this.onceListenersMap.h[a]=t;break}}}if(Object.prototype.hasOwnProperty.call(this.listenersMap.h,a)){let e=this.listenersMap.h[a];if(e.length>0){let t=0;for(;t<e.length;)if(e[t++]==n){let t=e.slice();s.remove(t,n),this.listenersMap.h[a]=t;break}}}}_listenerWrapper(e){this.eventsMap.h[e.className+"."+e.type]=e;}handleReplay(e){let t=d.getInstance(),i=this;I.delay((function(){let e=i.eventsMap.h,t=Object.keys(e),s=t.length,n=0;for(;n<s;){let s=t[n++],a=e[s];if(Object.prototype.hasOwnProperty.call(i.onceListenersMap.h,s)){let e=0,t=i.onceListenersMap.h[s];for(;e<t.length;)t[e++](a);}if(Object.prototype.hasOwnProperty.call(i.listenersMap.h,s)){let e=0,t=i.listenersMap.h[s];for(;e<t.length;)t[e++](a);}}}),100);let s,n=function(e){let t=e.split("."),i=t.pop(),s=t.join("."),n=new Array(2);return n[0]=s,n[1]=i,n},a=Object.keys(this.onceListenersMap.h),r=a.length,o=0;for(;o<r;)s=n(a[o++]),t.remove(this.context,s[0],s[1],B(this,this._listenerWrapper));let l=this.listenersMap.h,c=Object.keys(l),h=c.length,p=0;for(;p<h;){let e=c[p++],i=l[e];s=n(e),Object.prototype.hasOwnProperty.call(this.onceListenersMap.h,e)||t.remove(this.context,s[0],s[1],B(this,this._listenerWrapper));let a=0;for(;a<i.length;)t.add(this.context,s[0],s[1],i[a++]);}this.isRecording=!1;}}i["bs.player.plugin.javascriptapi.EventRecorder"]=C,C.__name__="bs.player.plugin.javascriptapi.EventRecorder",Object.assign(C.prototype,{__class__:C});class O{}i["bs.player.plugin.javascriptapi.IEventsFilter"]=O,O.__name__="bs.player.plugin.javascriptapi.IEventsFilter",Object.assign(O.prototype,{__class__:O});class P extends M{constructor(){M._hx_skip_constructor=!0,super(),M._hx_skip_constructor=!1,this._hx_constructor();}_hx_constructor(){this.message=null,super._hx_constructor(0),this.videoEventsFilterByContext=new R,null!=this.pluginConfig&&Object.prototype.hasOwnProperty.call(this.pluginConfig,"customVideoEventsFilterClass")&&(this.customVideoEventsFilterClass=n.field(this.pluginConfig,"customVideoEventsFilterClass"));}create(){if(super.create(),o.add(this.context,"close",B(this,this.onClose)),p.add(this.context,"durationChange",B(this,this.onDurationChange)),p.add(this.context,"currentTimeChange",B(this,this.onCurrentTimeChange)),l.add(this.context,"mediaMetadataData",B(this,this.onMetadataData)),l.add(this.context,"mediaAfterPlaybackStartMetadata",B(this,this.onMetadataData)),l.add(this.context,"adMetadataData",B(this,this.onAdMetadataData)),c.add(this.context,"showMessage",B(this,this.onShowMessage)),c.add(this.context,"closeMessage",B(this,this.onCloseMessage)),this.pictureInPicture=new T(this.context),Object.prototype.hasOwnProperty.call(this.pluginConfig,"eventRecorder")){let e=n.field(this.pluginConfig,"eventRecorder");try{this.eventRecorder=new C(this.context,e);}catch(e){let t=this.pluginName+" EventRecorder initialization fail";console.warn(t);}}}destroy(){this.getOrCreateEventsFilterByContext(this.context).onPlayerDestroy(),null!=this.pictureInPicture&&this.pictureInPicture.destroy(),o.remove(this.context,"close",B(this,this.onClose)),p.remove(this.context,"durationChange",B(this,this.onDurationChange)),p.remove(this.context,"currentTimeChange",B(this,this.onCurrentTimeChange)),l.remove(this.context,"mediaMetadataData",B(this,this.onMetadataData)),l.remove(this.context,"mediaAfterPlaybackStartMetadata",B(this,this.onMetadataData)),l.remove(this.context,"adMetadataData",B(this,this.onAdMetadataData)),c.remove(this.context,"showMessage",B(this,this.onShowMessage)),c.remove(this.context,"closeMessage",B(this,this.onCloseMessage)),super.destroy();}getVersion(){return "v2.15.38"}onClose(e){null!=this.onCloseBind&&this.onCloseBind(e);}play(){if(null!=this.adMedia){let e=new r("adAdClick");e.data={url:null},e.dispatch(this.context);}else new o("skinPlay").dispatch(this.context);}pause(){new o("skinPause").dispatch(this.context);}playPause(){new o("skinPlayPause").dispatch(this.context);}seek(e){e>this.durationTime&&(e=this.durationTime-.5),e<0&&(e=0),this.currentTime=e;let t=new o("skinSeek");t.data={seekedPosition:e,seekSource:"jsapi"},t.dispatch(this.context);}seekRelative(e){let t=this;if(null!=this.currentTime)this.seek(this.currentTime+e);else if(this.media instanceof _){let i=!1;p.addOnce(this.context,"currentTimeChange",(function(s){i||(i=!0,t.pause(),null!=t.currentTime&&t.seekRelative(e));})),this.play();}else this.seek(e);}setVolume(e){let t=new o("skinVolume");t.data=e,t.dispatch(this.context);}setMute(e){new o(e?"skinMute":"skinUnmute").dispatch(this.context);}setSubtitlesById(e){let t=new o("selectSubtitles");null!=e&&(t.data=new x,t.data.id=e),t.dispatch(this.context);}setAudioById(e){let t=new o("selectAudio");null!=e&&(t.data=new b,t.data.id=e),t.dispatch(this.context);}setVideoById(e){let t=new o("selectVideoTrack");null!=e&&(t.data=new f,t.data.id=e),t.dispatch(this.context);}toggleFullscreen(){new o("fullscreenToggleRequest").dispatch(this.context);}repaint(){new h("repaint").dispatch(this.context);}on(e,t){"close"==e&&(this.onCloseBind=t);}add(e,t){try{let i,s,n=e.split(".");if(n.length>2?(s=n.pop(),i=n.join(".")):(s=n.pop(),i="bs.player.core.events."+n.join("")),null!=this.eventRecorder&&1==this.eventRecorder.isRecording&&this.eventRecorder.recordable(e))return void this.eventRecorder.record(this.context,i,s,t);null!=this.customVideoEventsFilterClass&&i==p.__name__||V.mobile&&i==p.__name__?this.getOrCreateEventsFilterByContext(this.context).add(s,t):d.getInstance().add(this.context,i,s,t);}catch(e){let t=S.caught(e).unwrap();console.error(t);}}addOnce(e,t){try{let i,s,n=e.split(".");if(n.length>2?(s=n.pop(),i=n.join(".")):(s=n.pop(),i="bs.player.core.events."+n.join("")),null!=this.eventRecorder&&1==this.eventRecorder.isRecording&&this.eventRecorder.recordable(e))return void this.eventRecorder.recordOnce(this.context,i,s,t);null!=this.customVideoEventsFilterClass&&i==p.__name__||V.mobile&&i==p.__name__?this.getOrCreateEventsFilterByContext(this.context).addOnce(s,t):d.getInstance().addOnce(this.context,i,s,t);}catch(e){let t=S.caught(e).unwrap();console.error(t);}}remove(e,t){try{let i,s,n=e.split(".");if(n.length>2?(s=n.pop(),i=n.join(".")):(s=n.pop(),i="bs.player.core.events."+n.join("")),null!=this.eventRecorder&&1==this.eventRecorder.isRecording&&this.eventRecorder.recordable(e))return void this.eventRecorder.remove(this.context,i,s,t);null!=this.customVideoEventsFilterClass&&i==p.__name__||V.mobile&&i==p.__name__?this.getOrCreateEventsFilterByContext(this.context).remove(s,t):d.getInstance().remove(this.context,i,s,t);}catch(e){let t=S.caught(e).unwrap();console.error(t);}}getVideoMetrics(){let e={};return p.addOnce(this.context,"setMetrics",(function(t){e=t.data;})),new p("getMetrics").dispatch(this.context),e}getOrCreateEventsFilterByContext(e){if(!Object.prototype.hasOwnProperty.call(this.videoEventsFilterByContext.h,this.context)){let e=null;if(null!=this.customVideoEventsFilterClass){let t=this.customVideoEventsFilterClass;e=a.createInstance(i[t],[this.context]);}else e=new j(this.context);this.videoEventsFilterByContext.h[this.context]=e;}return this.videoEventsFilterByContext.h[this.context]}onDurationChange(e){this.durationTime=e.data.duration;}onCurrentTimeChange(e){let t=this.currentTime!=e.data.currentTime;this.currentTime=e.data.currentTime,this.durationTime=e.data.duration,t&&(this.lastCurrentTimeChangeTs=(new Date).getTime()/1e3),this.media=e.data.media,this.adMedia=null,1==e.data.duration&&this.media instanceof _&&(e.data.duration=1/0);}onMetadataData(e){if(null!=e){let t=e.data;this.media=t,this.durationTime=t.duration;}}onAdMetadataData(e){null!=e&&(this.adMedia=e.data);}onShowMessage(e){null!=e&&(this.message=e.data);}onCloseMessage(e){this.message=null;}appGoingBackground(){new o("appGoingBackground").dispatch(this.context);}appGoingForeground(){new o("appGoingForeground").dispatch(this.context);}requestVideoQualityChange(e){let t=new o("requestVideoQualityChange");t.data=e,t.dispatch(this.context);}playerInfoShow(){new o("playerInfoShow").dispatch(this.context);}playerInfoHide(){new o("playerInfoHide").dispatch(this.context);}searchForThumbByTime(e,t){null!=this.get_player().modules.BradmaxThumbnailsService?this.get_player().modules.BradmaxThumbnailsService.searchForThumbByTime(e,t):t(null);}restartSkinHide(){new c("animateShow").dispatch(this.context);}mediaType(e){let t=null;return e instanceof u&&(e instanceof _?(t="Live",e instanceof v?t="LiveStream":e instanceof y?t="LiveChannel":e instanceof m&&(t="LiveProgramStream")):e instanceof g?t="Catchup":e instanceof w&&(t="Episode")),t}}i["bs.player.plugin.javascriptapi.JavascriptApi"]=e.bs.player.plugin.javascriptapi.JavascriptApi=P,P.__name__="bs.player.plugin.javascriptapi.JavascriptApi",Object.assign(P.prototype,{__class__:P});class T{constructor(e){this.context=e;}destroy(){this.leave();}enter(){new o("pipEnter").dispatch(this.context);}leave(){new o("pipLeave").dispatch(this.context);}isAvailable(){return "pictureInPictureEnabled"in document}}i["bs.player.plugin.javascriptapi.JavascriptApiPictureInPicture"]=T,T.__name__="bs.player.plugin.javascriptapi.JavascriptApiPictureInPicture",Object.assign(T.prototype,{__class__:T});class j{constructor(e){this.context=e,this.holdedVideoPlayingEvent=null,this.listenersMap=new R,this.trackedVideoEvents=[],this.trackedVideoEvents.push("playing"),this.trackedVideoEvents.push("paused"),this.trackedVideoEvents.push("stopped"),this.trackedVideoEvents.push("complete"),this.attachInternalListeners();}attachInternalListeners(){let e=0,t=this.trackedVideoEvents;for(;e<t.length;){let i=t[e++];d.getInstance().add(this.context,p.__name__,i,B(this,this.onVideoEvent));}}dispatchEvent(e){if(Object.prototype.hasOwnProperty.call(this.listenersMap.h,e.type)){let t=0,i=this.listenersMap.h[e.type];for(;t<i.length;)i[t++](e);}}onVideoEvent(e){null==this.holdedVideoPlayingEvent?"playing"==e.type?(this.holdedVideoPlayingEvent=e,this.waitingPauseTimeoutTimer=I.delay(B(this,this.onWaitingPauseTimeout),50)):this.dispatchEvent(e):("paused"!=e.type&&(this.dispatchEvent(this.holdedVideoPlayingEvent),this.dispatchEvent(e)),this.waitingPauseTimeoutTimer.stop(),this.waitingPauseTimeoutTimer=null,this.holdedVideoPlayingEvent=null);}onWaitingPauseTimeout(){null!=this.holdedVideoPlayingEvent&&this.dispatchEvent(this.holdedVideoPlayingEvent),null!=this.waitingPauseTimeoutTimer&&this.waitingPauseTimeoutTimer.stop(),this.waitingPauseTimeoutTimer=null,this.holdedVideoPlayingEvent=null;}add(e,t){if(-1!=this.trackedVideoEvents.indexOf(e)){if(!Object.prototype.hasOwnProperty.call(this.listenersMap.h,e)){let t=[];this.listenersMap.h[e]=t;}this.listenersMap.h[e].push(t);}else d.getInstance().add(this.context,p.__name__,e,t);}addOnce(e,t){let i=this;if(-1!=this.trackedVideoEvents.indexOf(e)){let s=function(s){t(s),i.remove(e,t);};this.add(e,s);}else d.getInstance().add(this.context,p.__name__,e,t);}remove(e,t){if(-1!=this.trackedVideoEvents.indexOf(e)){if(!Object.prototype.hasOwnProperty.call(this.listenersMap.h,e))return;s.remove(this.listenersMap.h[e],t);}else d.getInstance().remove(this.context,p.__name__,e,t);}onPlayerDestroy(){}}i["bs.player.plugin.javascriptapi.VideoEventsFilterForMobile"]=j,j.__name__="bs.player.plugin.javascriptapi.VideoEventsFilterForMobile",Object.assign(j.prototype,{__class__:j});var V=require("bs.util.BrowserTools");class k{}i["haxe.IMap"]=k,k.__name__="haxe.IMap";class S extends Error{constructor(e,t,i){super(e),this.message=e,this.__previousException=t,this.__nativeException=null!=i?i:this;}unwrap(){return this.__nativeException}static caught(e){return e instanceof S?e:e instanceof Error?new S(e.message,null,e):new F(e,null,e)}}i["haxe.Exception"]=S,S.__name__="haxe.Exception",Object.assign(S.prototype,{__class__:S});var I=require("haxe.Timer");class F extends S{constructor(e,t,i){super(String(e),t,i),this.value=e;}unwrap(){return this.value}}i["haxe.ValueException"]=F,F.__name__="haxe.ValueException",Object.assign(F.prototype,{__class__:F});var R=require("haxe.ds.StringMap");class D{static getClass(e){if(null==e)return null;if(e instanceof Array)return Array;{let t=e.__class__;if(null!=t)return t;let i=D.__nativeClassName(e);return null!=i?D.__resolveNativeClass(i):null}}static __nativeClassName(e){let t=D.__toStr.call(e).slice(8,-1);return "Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t}static __resolveNativeClass(e){return t[e]}}function B(e,i){return null==i?null:(null==i.__id__&&(i.__id__=t.$haxeUID++),null==e.hx__closures__?e.hx__closures__={}:s=e.hx__closures__[i.__id__],null==s&&(s=i.bind(e),e.hx__closures__[i.__id__]=s),s);var s;}i["js.Boot"]=D,D.__name__="js.Boot",t.$haxeUID|=0,i.Math=Math,Object.defineProperty(String.prototype,"__class__",{value:i.String=String,enumerable:!1,writable:!0}),String.__name__="String",i.Array=Array,Array.__name__="Array",Date.prototype.__class__=i.Date=Date,Date.__name__="Date",D.__toStr={}.toString,M._hx_skip_constructor=!1,P.__plugfaces__="IPlugin";}(exports,window);!function(t,e){t.bs=t.bs||{},t.bs.player=t.bs.player||{},t.bs.player.plugin=t.bs.player.plugin||{},t.bs.player.plugin.keyboard=t.bs.player.plugin.keyboard||{},Math.__name__="Math";var i=require("haxe.Reflect"),s=require("bs.player.core.events.ControlEvent"),r=require("bs.player.core.events.DisplayEvent"),n=require("bs.player.core.events.VideoEvent");class a{constructor(t){a._hx_skip_constructor||this._hx_constructor(t);}_hx_constructor(t){null==t&&(t=5),this.pluginName="";let e=u.getClass(this);this.pluginName=e.__name__.split(".").pop(),this.initPriority=t;let s=this.pluginName,r=exports.configuration;this.pluginConfig=null!=r&&Object.prototype.hasOwnProperty.call(r,s)?i.field(r,s):Object.create(null);}create(){}destroy(){}activate(){}postActivate(){}deactivate(){}eventFilter(t){return !0}registerPlugin(t){}getPluginVersion(){return "v2.15.38"}getPluginName(){return this.pluginName}get_player(){return this.player}set_player(t){return this.player=t}get_variables(){return this.variables}set_variables(t){return this.variables=t}get_eventHub(){return this.eventHub}set_eventHub(t){return this.eventHub=t}get_parentDisplay(){return this.parentDisplay}set_parentDisplay(t){return this.parentDisplay=t}get_display(){return this.display}isCriticalForPlayback(){return !0}}a.__name__="bs.player.core.plugin.PluginBase",Object.assign(a.prototype,{__class__:a});class l extends a{constructor(){a._hx_skip_constructor=!0,super(),a._hx_skip_constructor=!1,this._hx_constructor();}_hx_constructor(){this.hasFocus=!1,this.disabled=o.mobile||o.isSmartTV(),super._hx_constructor(),this.videoCurrentTime=null,this.videoDurration=null;}create(){super.create(),this.disabled||(window.document.addEventListener("keydown",h(this,this.onKeyDown),!1),this.get_parentDisplay().addEventListener("mouseup",h(this,this.onMouseUp),!1),1==this.get_variables().autoplay&&this.buildInput(),n.add(this.context,"currentTimeChange",h(this,this.onVideoTimeChange)));}onVideoTimeChange(t){null!=t&&null!=t.data&&(this.videoCurrentTime=t.data.currentTime,this.videoDurration=t.data.duration);}destroy(){this.disabled||(n.remove(this.context,"currentTimeChange",h(this,this.onVideoTimeChange)),window.document.removeEventListener("keydown",h(this,this.onKeyDown)),this.get_parentDisplay().removeEventListener("mouseup",h(this,this.onMouseUp)),super.destroy());}onMouseUp(t){this.buildInput();}buildInput(){null==this.input&&(this.input=window.document.createElement("input"),this.input.style.zIndex="-1",this.input.style.opacity="0",this.input.style.position="absolute",this.input.style.top="-20px",this.input.style.left="-100px",this.input.style.height="20px",this.input.style.width="100px",this.input.setAttribute("inputmode","none"),this.input.addEventListener("blur",h(this,this.destroyInput),!1),this.get_parentDisplay().insertBefore(this.input,this.get_parentDisplay().firstChild)),this.hasFocus=!0,o.focusElement(this.input,{preventScroll:!0});}destroyInput(t){this.hasFocus=!1,null!=this.input&&(this.input.removeEventListener("blur",h(this,this.destroyInput),!1),this.get_parentDisplay().removeChild(this.input)),this.input=null;}onKeyDown(t){32==t.keyCode&&this.dispatchPlayPause(),39==t.keyCode&&this.seekForward(),37==t.keyCode&&this.seekBackward();}seekForward(){if(null==this.videoCurrentTime||null==this.videoDurration)return;let t=this.videoCurrentTime+10;t>this.videoDurration&&(t=this.videoDurration);let e=new s("skinSeek");e.data={seekedPosition:t,seekSource:"keyboard"},e.dispatch(this.context),new r("animateShow").dispatch(this.context);}seekBackward(){if(null==this.videoCurrentTime||null==this.videoDurration)return;let t=this.videoCurrentTime-10;t<0&&(t=0);let e=new s("skinSeek");e.data={seekedPosition:t,seekSource:"keyboard"},e.dispatch(this.context),new r("animateShow").dispatch(this.context);}dispatchPlayPause(){this.hasFocus&&(new s("skinPlayPause").dispatch(this.context),new r("animateShow").dispatch(this.context));}isCriticalForPlayback(){return !1}}t.bs.player.plugin.keyboard.KeyboardSupport=l,l.__name__="bs.player.plugin.keyboard.KeyboardSupport",Object.assign(l.prototype,{__class__:l});var o=require("bs.util.BrowserTools");class u{static getClass(t){if(null==t)return null;if(t instanceof Array)return Array;{let e=t.__class__;if(null!=e)return e;let i=u.__nativeClassName(t);return null!=i?u.__resolveNativeClass(i):null}}static __nativeClassName(t){let e=u.__toStr.call(t).slice(8,-1);return "Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e}static __resolveNativeClass(t){return e[t]}}function h(t,i){return null==i?null:(null==i.__id__&&(i.__id__=e.$haxeUID++),null==t.hx__closures__?t.hx__closures__={}:s=t.hx__closures__[i.__id__],null==s&&(s=i.bind(t),t.hx__closures__[i.__id__]=s),s);var s;}u.__name__="js.Boot",e.$haxeUID|=0,Object.defineProperty(String.prototype,"__class__",{value:String,enumerable:!1,writable:!0}),String.__name__="String",Array.__name__="Array",u.__toStr={}.toString,a._hx_skip_constructor=!1,l.SEEK_STEP=10,l.__plugfaces__="IPlugin";}(exports,window);!function(t,e){t.bs=t.bs||{},t.bs.player=t.bs.player||{},t.bs.player.plugin=t.bs.player.plugin||{},t.bs.player.plugin.quanteec=t.bs.player.plugin.quanteec||{};var s=require("haxe.Lambda");Math.__name__="Math";var n=require("haxe.Reflect");class l{static string(t){return f.__string_rec(t,"")}}l.__name__="Std";var a=require("haxe.StringTools");class i{constructor(t){i._hx_skip_constructor||this._hx_constructor(t);}_hx_constructor(t){null==t&&(t=5),this.pluginName="";let e=f.getClass(this);this.pluginName=e.__name__.split(".").pop(),this.initPriority=t;let s=this.pluginName,l=exports.configuration;this.pluginConfig=null!=l&&Object.prototype.hasOwnProperty.call(l,s)?n.field(l,s):Object.create(null);}create(){}destroy(){}activate(){}postActivate(){}deactivate(){}eventFilter(t){return !0}registerPlugin(t){}getPluginVersion(){return "v2.15.38"}getPluginName(){return this.pluginName}get_player(){return this.player}set_player(t){return this.player=t}get_variables(){return this.variables}set_variables(t){return this.variables=t}get_eventHub(){return this.eventHub}set_eventHub(t){return this.eventHub=t}get_parentDisplay(){return this.parentDisplay}set_parentDisplay(t){return this.parentDisplay=t}get_display(){return this.display}isCriticalForPlayback(){return !0}}i.__name__="bs.player.core.plugin.PluginBase",Object.assign(i.prototype,{__class__:i});class r extends i{constructor(t){i._hx_skip_constructor=!0,super(),i._hx_skip_constructor=!1,this._hx_constructor(t);}_hx_constructor(t){this.config=null,this.sdk=null,this.renderer=null,super._hx_constructor(t);}create(){this.config=this.resolveConfig(this.get_variables()),this.createRenderer();}destroy(){this.destroyWrapper();}hideInUi(){if(null==this.config)return !1;let t=this.config.hideInUi;return null!=t&&1==t}hasValidConfig(){if(null==this.config)return !1;let t=this.config.quanteecKey;return null!=t&&t.length>0}hasDashWrapper(){return !!this.hasQuanteec()&&null!=exports.Quanteec.QuanteecDash}hasHlsWrapper(){return !!this.hasQuanteec()&&null!=exports.Quanteec.QuanteecHls}wrapDashPlayer(t,e){if(this.destroyWrapper(),0==this.hasValidConfig()||0==this.hasDashWrapper())return null;this.updateConfigFromMedia(e);try{this.sdk=new exports.Quanteec.QuanteecDash(this.config,t);}catch(t){let e=p.caught(t);console.warn(e);}let s=this.renderer;return null!=s&&s.updateSdk(this.sdk),this.sdk}wrapHlsPlayer(t,e){if(this.destroyWrapper(),0==this.hasValidConfig()||0==this.hasHlsWrapper())return null;this.updateConfigFromMedia(e);try{this.sdk=new exports.Quanteec.QuanteecHls(this.config,t);}catch(t){let e=p.caught(t);console.warn(e);}let s=this.renderer;return null!=s&&s.updateSdk(this.sdk),this.sdk}updateConfigFromMedia(t){if(null==this.sdk||null==this.config||null==t)return;let e=this.collectConfigMediaInfo(t);if(null==e)return;let s=!1;if(this.config.videoID!=e.videoID&&(this.config.videoID=e.videoID,s=!0),null==this.config.videoID&&this.config.videoID!=t.id&&(this.config.videoID=t.id,s=!0),this.config.collection!=e.collection&&(this.config.collection=e.collection,s=!0),0!=s)try{this.sdk.updateConfig(this.config);}catch(t){let e=p.caught(t);console.warn(e);}}destroyWrapper(){try{let t=this.sdk;null!=t&&t.reset();}catch(t){let e=p.caught(t);console.warn(e);}this.sdk=null;}hasValidStreamboostConfig(){let t=this.config,e=null!=t?t.streamboost:null;if(null==e)return !1;if(null==e)return !1;{let t=e.userId;return null!=t&&t.length>0}}hasStreamboostPlugin(){return !!this.hasQuanteec()&&u.hasCustomElement("streamboost-panel")}hasQuanteec(){return null!=exports.Quanteec}createRenderer(){let t=this.renderer;null!=t&&t.destroy(),null!=this.config&&0!=s.exists(this.get_player().plugins,(function(t){return "HtmlSkin"==t.getPluginName()}))&&(this.renderer=new o(this.context,this.config));}resolveConfig(t){return t.quanteecConfig}collectConfigMediaInfo(t){if(null==(null!=t?t.id:null))return null;let e=t.id,s=this.resolveConfigMedia();return null!=s&&Object.prototype.hasOwnProperty.call(s,e)?s[e]:null}resolveConfigMedia(){return null==this.config?null:this.config.media}}t.bs.player.plugin.quanteec.QuanteecPlugin=r,r.__name__="bs.player.plugin.quanteec.QuanteecPlugin",Object.assign(r.prototype,{__class__:r});class o{constructor(t,e){this.renderTimer=null,this.statsElements=null,this.buttonHandlers=null,this.context=t,this.config=e;let s=this,n=new _;n.h.maxupload0=function(t){s.modifyMaxUploadValue(0);},n.h.maxupload1=function(t){s.modifyMaxUploadValue(.5);},n.h.maxupload2=function(t){s.modifyMaxUploadValue(1);},this.buttonHandlers=n;}destroy(){this.cleanupStats();}updateSdk(t){this.sdk=t;}getLogoSvgString(t,e){return a.replace('<svg viewBox="0 0 86 78" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n<path d="M28.047 38.6229L25.8402 34.9695L21.6368 34.9631L19.5296 38.6101L21.6258 42.2633L25.8292 42.2697L28.047 38.6229Z"/>\n<path d="M31.0332 26.2381L26.7689 26.2317L24.6311 29.8786L26.7577 33.5319L31.022 33.5382L33.1598 29.8913L31.0332 26.2381Z"/>\n<path d="M40.141 21.2653L42.2371 24.9186L46.5511 24.9251L48.6583 21.2782L46.5621 17.6249L42.2482 17.6184L40.141 21.2653Z"/>\n<path d="M35.806 29.7054L37.5872 32.6841L41.0395 32.6893L42.8296 29.7161L41.0485 26.7374L37.5962 26.7322L35.806 29.7054Z"/>\n<path d="M50.8188 27.1529L47.4454 27.1478L45.8668 29.9107L47.4368 32.6783L50.8103 32.6833L52.3888 29.9204L50.8188 27.1529Z"/>\n<path d="M41.527 48.2666L40.3136 46.0526L37.7695 46.0487L36.5494 48.2591L37.7628 50.4731L40.3069 50.4769L41.527 48.2666Z"/>\n<path d="M51.5908 48.2814L50.3774 46.0674L47.8332 46.0635L46.5025 48.2737L47.8265 50.4879L50.3707 50.4917L51.5908 48.2814Z"/>\n<path d="M45.9343 57.7841L44.8309 56.0127L42.7292 56.0095L41.6204 57.7776L42.7237 59.6596L44.8254 59.6628L45.9343 57.7841Z"/>\n<path d="M55.9515 17.6248L51.7482 17.6184L49.641 21.2653L51.7371 24.9186L55.9405 24.925L58.1583 21.2782L55.9515 17.6248Z"/>\n<path d="M31.9509 35.5316L30.3688 38.286L31.9423 41.0449L35.3085 41.0499L36.8907 38.2955L35.3171 35.5366L31.9509 35.5316Z"/>\n<path d="M46.7376 38.5402L45.3035 35.994L42.3169 35.9895L40.8751 38.5313L42.3092 41.0775L45.2958 41.082L46.7376 38.5402Z"/>\n<path d="M31.3204 48.1835L29.6683 45.4242L26.4591 45.4195L24.7985 48.1737L26.4506 50.9329L29.6598 50.9377L31.3204 48.1835Z"/>\n<path d="M32.2159 59.6449L34.3175 59.6481L35.4265 57.7694L34.3231 55.998L32.2214 55.9948L31.1126 57.7629L32.2159 59.6449Z"/>\n<path d="M52.5715 57.7629L53.6748 59.6449L55.7765 59.6481L56.8855 57.7694L55.782 55.998L53.6804 55.9948L52.5715 57.7629Z"/>\n<path d="M58.7805 64.3558L57.91 65.7309L58.7762 67.1947L60.4262 67.1972L61.2969 65.7361L60.4305 64.3583L58.7805 64.3558Z"/>\n<path d="M57.9522 50.0238L60.0539 50.027L61.1629 48.1483L60.0594 46.3769L57.9577 46.3737L56.8489 48.1418L57.9522 50.0238Z"/>\n<path d="M54.7414 36.4354L52.1972 36.4315L50.9771 38.6419L52.1905 40.8559L54.7347 40.8597L55.9548 38.6494L54.7414 36.4354Z"/>\n<path d="M64.6414 36.9785L62.5397 36.9753L61.4309 38.7434L62.5342 40.6254L64.6359 40.6286L65.7449 38.7499L64.6414 36.9785Z"/>\n<path d="M55.4001 29.9042L57.0522 32.6634L60.2614 32.6682L61.922 29.9139L60.2699 27.1547L57.0607 27.1499L55.4001 29.9042Z"/>\n<path d="M29.2183 21.4464L31.6259 25.6425L36.5808 25.6499L39.0011 21.4611L36.5935 17.265L31.6386 17.2576L29.2183 21.4464Z"/>\n</svg>\n',"<svg",'<svg width="'+t+'" height="'+e+'"')}getContextMenuItemHtmlString(){return '<span style="align-items: center;">'+this.getLogoSvgString(22,22)+"&nbsp;View Quanteec panel</span>"}createStreamboostPanelStyleElement(){let t=this.context+"-quanteec-streamboost-css",e=u.getElementById(t);if(null!=e)return e;let s=u.createElement("style");return s.id=t,s.insertAdjacentHTML("beforeend",["#"+this.context+" streamboost-panel {position: relative;display: block;width: 100%;height: 100%;overflow: hidden;z-index: 9999;}","#"+this.context+" streamboost-panel * {box-sizing: content-box;-webkit-box-sizing: content-box;}"].join("")),s}createStreamboostPanelElement(t){let e=this.context+"-quanteec-streamboost-panel",s=this.config,n=null!=s?s.streamboost:null,l=u.getElementById(e),a=this.applyStreamboostConfigToElement(n,null!=l?l:u.createElement("streamboost-panel"));return a.id=e,a.setAttribute("is-open","true"),a.setAttribute("backdrop-mode","contained"),a.setAttribute("backdrop-blur","false"),u.addEngineEventListener("streamboost-close",t,{once:!0,passive:!0}),a}getStatsTitleString(t){return this.getLogoSvgString(32,32)+'<span style="flex: 1;min-width: 115px;">Quanteec panel</span>'}getStatsContentString(t){return this.parseStatsHtmlTemplate(t,'<div class="${PREFIX}-message-info-con" style="flex: 2;min-width: 310px;margin-top: 0;margin-bottom: 0;">\n\t<div class="${PREFIX}-message-info-item" title="\'Green score\' computed thanks to QUANTEEC. It corresponds to the data sent and received in p2p divided by the received data in http.">\n\t\t<small class="${PREFIX}-message-info-item-label" style="align-items: center;">\n\t\t\t<svg width="16" height="16" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" style="opacity:0.5;">\n\t\t\t\t<path fill="currentColor" d="M1280 704q0-26-19-45t-45-19q-172 0-318 49.5t-259.5 134-235.5 219.5q-19 21-19 45 0 26 19 45t45 19q24 0 45-19 27-24 74-71t67-66q137-124 268.5-176t313.5-52q26 0 45-19t19-45zm512-198q0 95-20 193-46 224-184.5 383t-357.5 268q-214 108-438 108-148 0-286-47-15-5-88-42t-96-37q-16 0-39.5 32t-45 70-52.5 70-60 32q-43 0-63.5-17.5t-45.5-59.5q-2-4-6-11t-5.5-10-3-9.5-1.5-13.5q0-35 31-73.5t68-65.5 68-56 31-48q0-4-14-38t-16-44q-9-51-9-104 0-115 43.5-220t119-184.5 170.5-139 204-95.5q55-18 145-25.5t179.5-9 178.5-6 163.5-24 113.5-56.5l29.5-29.5 29.5-28 27-20 36.5-16 43.5-4.5q39 0 70.5 46t47.5 112 24 124 8 96z" />\n\t\t\t</svg>\n\t\t\t<small>&nbsp;GREEN SCORE&nbsp;</small>\n\t\t</small>\n\t\t<strong id="${GREENSCORE_ID}" class="${PREFIX}-message-info-item-value">-</strong>\n\t</div>\n\t<div class="${PREFIX}-message-info-item ${PREFIX}-quanteec-green-power-ctrl" title="Set the maximum percentage of the upload bandwidth that can be used by the QUANTEEC plugin.">\n\t\t<small class="${PREFIX}-message-info-item-label" style="align-items: center;">\n\t\t\t<svg width="16" height="16" viewBox="0 0 2048 1792" xmlns="http://www.w3.org/2000/svg" style="opacity:0.5;">\n\t\t\t\t<path fill="currentColor" d="M960 896q0-106-75-181t-181-75-181 75-75 181 75 181 181 75 181-75 75-181zm768 512q0-52-38-90t-90-38-90 38-38 90q0 53 37.5 90.5t90.5 37.5 90.5-37.5 37.5-90.5zm0-1024q0-52-38-90t-90-38-90 38-38 90q0 53 37.5 90.5t90.5 37.5 90.5-37.5 37.5-90.5zm-384 421v185q0 10-7 19.5t-16 10.5l-155 24q-11 35-32 76 34 48 90 115 7 11 7 20 0 12-7 19-23 30-82.5 89.5t-78.5 59.5q-11 0-21-7l-115-90q-37 19-77 31-11 108-23 155-7 24-30 24h-186q-11 0-20-7.5t-10-17.5l-23-153q-34-10-75-31l-118 89q-7 7-20 7-11 0-21-8-144-133-144-160 0-9 7-19 10-14 41-53t47-61q-23-44-35-82l-152-24q-10-1-17-9.5t-7-19.5v-185q0-10 7-19.5t16-10.5l155-24q11-35 32-76-34-48-90-115-7-11-7-20 0-12 7-20 22-30 82-89t79-59q11 0 21 7l115 90q34-18 77-32 11-108 23-154 7-24 30-24h186q11 0 20 7.5t10 17.5l23 153q34 10 75 31l118-89q8-7 20-7 11 0 21 8 144 133 144 160 0 8-7 19-12 16-42 54t-45 60q23 48 34 82l152 23q10 2 17 10.5t7 19.5zm640 533v140q0 16-149 31-12 27-30 52 51 113 51 138 0 4-4 7-122 71-124 71-8 0-46-47t-52-68q-20 2-30 2t-30-2q-14 21-52 68t-46 47q-2 0-124-71-4-3-4-7 0-25 51-138-18-25-30-52-149-15-149-31v-140q0-16 149-31 13-29 30-52-51-113-51-138 0-4 4-7 4-2 35-20t59-34 30-16q8 0 46 46.5t52 67.5q20-2 30-2t30 2q51-71 92-112l6-2q4 0 124 70 4 3 4 7 0 25-51 138 17 23 30 52 149 15 149 31zm0-1024v140q0 16-149 31-12 27-30 52 51 113 51 138 0 4-4 7-122 71-124 71-8 0-46-47t-52-68q-20 2-30 2t-30-2q-14 21-52 68t-46 47q-2 0-124-71-4-3-4-7 0-25 51-138-18-25-30-52-149-15-149-31v-140q0-16 149-31 13-29 30-52-51-113-51-138 0-4 4-7 4-2 35-20t59-34 30-16q8 0 46 46.5t52 67.5q20-2 30-2t30 2q51-71 92-112l6-2q4 0 124 70 4 3 4 7 0 25-51 138 17 23 30 52 149 15 149 31z" />\n\t\t\t</svg>\n\t\t\t<small>&nbsp;GREEN POWER&nbsp;</small>\n\t\t</small>\n\t\t<div class="${PREFIX}-message-info-item-value" style="gap: 0.25em;">\n\t\t\t<button id="${MAXUPLOAD_0_ID}" class="${PREFIX}-btn" style="min-width: 28px;min-height: 28px;border-radius: 4px;border: 1px solid dimgray;background-color: transparent;color: inherit;">x0</button>\n\t\t\t<button id="${MAXUPLOAD_1_ID}" class="${PREFIX}-btn" style="min-width: 28px;min-height: 28px;border-radius: 4px;border: 1px solid dimgray;background-color: transparent;color: inherit;">x1</button>\n\t\t\t<button id="${MAXUPLOAD_2_ID}" class="${PREFIX}-btn" style="min-width: 28px;min-height: 28px;border-radius: 4px;border: 1px solid dimgray;background-color: transparent;color: inherit;">x2</button>\n\t\t</div>\n\t</div>\n</div>\n<div style="flex: 2;min-width: 310px;">\n\t<div class="${PREFIX}-message-info-con" style="flex: 1;min-width: 145px;margin-top: 0;margin-bottom: 0;">\n\t\t<h4 class="${PREFIX}-message-info-title">Savings:</h4>\n\t\t<div class="${PREFIX}-message-info-list">\n\t\t\t<div class="${PREFIX}-message-info-item" title="Quantity of energy saved thanks to QUANTEEC, in Watt-hour (Wh)">\n\t\t\t\t<small class="${PREFIX}-message-info-item-label" style="align-items: center;">\n\t\t\t\t\t<svg width="16" height="16" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="opacity:0.5;">\n\t\t\t\t\t\t<path fill="currentColor" d="M26.7322 15.6826L12.7322 30.6826C12.5838 30.8409 12.388 30.9467 12.1742 30.984C11.9604 31.0213 11.7404 30.988 11.5472 30.8892C11.354 30.7904 11.1982 30.6315 11.1032 30.4364C11.0083 30.2413 10.9794 30.0206 11.0209 29.8076L12.8534 20.6414L5.64965 17.9364C5.49494 17.8785 5.35697 17.7832 5.24808 17.659C5.13918 17.5348 5.06275 17.3855 5.02561 17.2246C4.98847 17.0637 4.99177 16.896 5.03523 16.7366C5.07869 16.5773 5.16094 16.4312 5.27465 16.3114L19.2747 1.31136C19.423 1.15303 19.6188 1.04725 19.8326 1.00998C20.0464 0.972711 20.2664 1.00598 20.4596 1.10476C20.6528 1.20354 20.8086 1.36248 20.9036 1.55759C20.9985 1.75269 21.0274 1.97338 20.9859 2.18636L19.1484 11.3626L26.3521 14.0639C26.5057 14.1221 26.6426 14.2173 26.7506 14.341C26.8587 14.4647 26.9346 14.6131 26.9717 14.7732C27.0087 14.9332 27.0058 15.0998 26.9632 15.2585C26.9205 15.4171 26.8395 15.5628 26.7271 15.6826H26.7322Z" />\n\t\t\t\t\t</svg>\n\t\t\t\t\t<small>&nbsp;ENERGY&nbsp;</small>\n\t\t\t\t</small>\n\t\t\t\t<small id="${ENERGYSAVED_ID}" class="${PREFIX}-message-info-item-value">-</small>\n\t\t\t</div>\n\t\t\t<div class="${PREFIX}-message-info-item" title="Quantity of CO2 saved thanks to QUANTEEC, in grams (g), based on the quantity of energy saved.">\n\t\t\t\t<small class="${PREFIX}-message-info-item-label" style="align-items: center;">\n\t\t\t\t\t<svg width="16" height="16" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="opacity:0.5;">\n\t\t\t\t\t\t<path fill="currentColor" d="M16 3C13.4288 3 10.9154 3.76244 8.77759 5.1909C6.63975 6.61935 4.97351 8.64968 3.98957 11.0251C3.00563 13.4006 2.74819 16.0144 3.2498 18.5362C3.75141 21.0579 4.98953 23.3743 6.80762 25.1924C8.6257 27.0105 10.9421 28.2486 13.4638 28.7502C15.9856 29.2518 18.5995 28.9944 20.9749 28.0104C23.3503 27.0265 25.3807 25.3603 26.8091 23.2224C28.2376 21.0846 29 18.5712 29 16C28.9964 12.5533 27.6256 9.24882 25.1884 6.81163C22.7512 4.37445 19.4467 3.00364 16 3ZM27 16C27.0011 17.4112 26.7295 18.8094 26.2 20.1175L20.6125 16.6812C20.3749 16.5347 20.1092 16.4397 19.8325 16.4025L16.98 16.0175C16.5869 15.9662 16.1875 16.0321 15.8317 16.2069C15.476 16.3817 15.1797 16.6576 14.98 17H13.89L13.415 16.0175C13.2837 15.7439 13.0915 15.504 12.8532 15.3162C12.6148 15.1283 12.3367 14.9975 12.04 14.9338L11.04 14.7175L12.0175 13H14.1063C14.4442 12.9993 14.7766 12.9133 15.0725 12.75L16.6038 11.905C16.7383 11.83 16.8641 11.7403 16.9788 11.6375L20.3425 8.595C20.6798 8.29276 20.9039 7.8846 20.978 7.43784C21.0521 6.99108 20.9717 6.53241 20.75 6.1375L20.705 6.05625C22.5873 6.94875 24.1778 8.35674 25.292 10.1168C26.4063 11.8769 26.9985 13.9169 27 16ZM5.00001 16C4.99834 14.365 5.36311 12.7505 6.06751 11.275L7.48501 15.0588C7.60313 15.372 7.79802 15.6506 8.0518 15.869C8.30558 16.0874 8.61012 16.2386 8.93751 16.3088L11.6163 16.885L12.0925 17.875C12.2578 18.2117 12.5139 18.4955 12.832 18.6943C13.1501 18.8931 13.5174 18.999 13.8925 19H14.0775L13.1738 21.0287C13.0145 21.386 12.9635 21.782 13.0271 22.168C13.0906 22.5539 13.2659 22.9127 13.5313 23.2L13.5488 23.2175L16 25.7425L15.7575 26.9925C12.8848 26.9256 10.152 25.7387 8.14216 23.685C6.13236 21.6313 5.00477 18.8735 5.00001 16Z" />\n\t\t\t\t\t</svg>\n\t\t\t\t\t<small>&nbsp;CO2&nbsp;</small>\n\t\t\t\t</small>\n\t\t\t\t<small id="${CO2SAVED_ID}" class="${PREFIX}-message-info-item-value">-</small>\n\t\t\t</div>\n\t\t\t<div class="${PREFIX}-message-info-item" title="Quantity of water saved thanks to QUANTEEC, in centiliters (cl), based on the quantity of energy saved.">\n\t\t\t\t<small class="${PREFIX}-message-info-item-label" style="align-items: center;">\n\t\t\t\t\t<svg width="16" height="16" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="opacity:0.5;">\n\t\t\t\t\t\t<path fill="currentColor" d="M21.75 5.96847C20.206 4.18526 18.4682 2.57954 16.5688 1.18097C16.4006 1.06318 16.2003 1 15.995 1C15.7897 1 15.5894 1.06318 15.4213 1.18097C13.5253 2.58012 11.7909 4.18583 10.25 5.96847C6.81375 9.91472 5 14.0747 5 17.9997C5 20.9171 6.15893 23.715 8.22183 25.7779C10.2847 27.8408 13.0826 28.9997 16 28.9997C18.9174 28.9997 21.7153 27.8408 23.7782 25.7779C25.8411 23.715 27 20.9171 27 17.9997C27 14.0747 25.1862 9.91472 21.75 5.96847ZM22.9813 19.1672C22.7219 20.6156 22.0251 21.9498 20.9846 22.9901C19.944 24.0304 18.6097 24.727 17.1612 24.986C17.1079 24.9945 17.054 24.9991 17 24.9997C16.7492 24.9997 16.5075 24.9053 16.323 24.7354C16.1384 24.5655 16.0245 24.3325 16.0037 24.0825C15.9829 23.8325 16.0569 23.5839 16.2108 23.3859C16.3648 23.1878 16.5876 23.0549 16.835 23.0135C18.9062 22.6647 20.6637 20.9072 21.015 18.8322C21.0594 18.5707 21.2059 18.3374 21.4223 18.1839C21.6387 18.0303 21.9072 17.969 22.1688 18.0135C22.4303 18.0579 22.6635 18.2044 22.8171 18.4208C22.9706 18.6371 23.0319 18.9056 22.9875 19.1672H22.9813Z" />\n\t\t\t\t\t</svg>\n\t\t\t\t\t<small>&nbsp;WATER&nbsp;</small>\n\t\t\t\t</small>\n\t\t\t\t<small id="${WATERSAVED_ID}" class="${PREFIX}-message-info-item-value">-</small>\n\t\t\t</div>\n\t\t\t<div class="${PREFIX}-message-info-item" title="Energy saved in lights switched off for 5 minutes.">\n\t\t\t\t<small class="${PREFIX}-message-info-item-label" style="align-items: center;">\n\t\t\t\t\t<svg width="16" height="16" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="opacity:0.5;">\n\t\t\t\t\t\t<path fill="currentColor" d="M22.0002 29.0003C22.0002 29.2655 21.8948 29.5198 21.7073 29.7074C21.5197 29.8949 21.2654 30.0003 21.0002 30.0003H11.0002C10.7349 30.0003 10.4806 29.8949 10.2931 29.7074C10.1055 29.5198 10.0002 29.2655 10.0002 29.0003C10.0002 28.735 10.1055 28.4807 10.2931 28.2932C10.4806 28.1056 10.7349 28.0003 11.0002 28.0003H21.0002C21.2654 28.0003 21.5197 28.1056 21.7073 28.2932C21.8948 28.4807 22.0002 28.735 22.0002 29.0003ZM27.0002 13.0003C27.0045 14.6673 26.6279 16.3133 25.8991 17.8127C25.1704 19.312 24.1087 20.625 22.7952 21.6515C22.5496 21.8398 22.3502 22.0817 22.2125 22.3588C22.0747 22.6359 22.0021 22.9408 22.0002 23.2503V24.0003C22.0002 24.5307 21.7894 25.0394 21.4144 25.4145C21.0393 25.7895 20.5306 26.0003 20.0002 26.0003H12.0002C11.4697 26.0003 10.961 25.7895 10.586 25.4145C10.2109 25.0394 10.0002 24.5307 10.0002 24.0003V23.2503C9.99996 22.9445 9.92965 22.6429 9.79465 22.3685C9.65965 22.0942 9.46355 21.8545 9.22141 21.6678C7.91116 20.6473 6.85022 19.3422 6.11889 17.8512C5.38755 16.3601 5.00499 14.7222 5.00016 13.0615C4.96766 7.10401 9.78266 2.14276 15.7352 2.00026C17.2019 1.96492 18.6608 2.22333 20.0261 2.76029C21.3914 3.29724 22.6355 4.10189 23.6852 5.12688C24.7349 6.15186 25.5689 7.37647 26.1382 8.72862C26.7075 10.0808 27.0006 11.5332 27.0002 13.0003ZM20.7077 13.2928C20.6148 13.1998 20.5045 13.126 20.3831 13.0757C20.2617 13.0254 20.1316 12.9995 20.0002 12.9995C19.8687 12.9995 19.7386 13.0254 19.6172 13.0757C19.4958 13.126 19.3855 13.1998 19.2927 13.2928L16.0002 16.5865L12.7077 13.2928C12.52 13.1051 12.2655 12.9997 12.0002 12.9997C11.7348 12.9997 11.4803 13.1051 11.2927 13.2928C11.105 13.4804 10.9996 13.7349 10.9996 14.0003C10.9996 14.2656 11.105 14.5201 11.2927 14.7078L15.0002 18.414V23.0003C15.0002 23.2655 15.1055 23.5198 15.2931 23.7074C15.4806 23.8949 15.7349 24.0003 16.0002 24.0003C16.2654 24.0003 16.5197 23.8949 16.7073 23.7074C16.8948 23.5198 17.0002 23.2655 17.0002 23.0003V18.414L20.7077 14.7078C20.8006 14.6149 20.8744 14.5046 20.9247 14.3832C20.975 14.2618 21.0009 14.1317 21.0009 14.0003C21.0009 13.8688 20.975 13.7387 20.9247 13.6173C20.8744 13.4959 20.8006 13.3856 20.7077 13.2928Z" />\n\t\t\t\t\t</svg>\n\t\t\t\t\t<small>&nbsp;LIGHT&nbsp;</small>\n\t\t\t\t</small>\n\t\t\t\t<small id="${UNLIGHTENED_ID}" class="${PREFIX}-message-info-item-value">-</small>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="${PREFIX}-message-info-con" style="flex: 1;min-width: 145px;margin-top: 0;margin-bottom: 0;">\n\t\t<h4 class="${PREFIX}-message-info-title">Transfer:</h4>\n\t\t<div class="${PREFIX}-message-info-list">\n\t\t\t<div class="${PREFIX}-message-info-item" title="Number of peers the plugin is connected with.">\n\t\t\t\t<small class="${PREFIX}-message-info-item-label" style="align-items: center;">\n\t\t\t\t\t<svg width="16" height="16" viewBox="0 0 2048 1792" xmlns="http://www.w3.org/2000/svg" style="opacity:0.5;">\n\t\t\t\t\t\t<path fill="currentColor" d="M1344 1504q0 13-9.5 22.5t-22.5 9.5h-960q-8 0-13.5-2t-9-7-5.5-8-3-11.5-1-11.5v-600h-192q-26 0-45-19t-19-45q0-24 15-41l320-384q19-22 49-22t49 22l320 384q15 17 15 41 0 26-19 45t-45 19h-192v384h576q16 0 25 11l160 192q7 10 7 21zm640-416q0 24-15 41l-320 384q-20 23-49 23t-49-23l-320-384q-15-17-15-41 0-26 19-45t45-19h192v-384h-576q-16 0-25-12l-160-192q-7-9-7-20 0-13 9.5-22.5t22.5-9.5h960q8 0 13.5 2t9 7 5.5 8 3 11.5 1 11.5v600h192q26 0 45 19t19 45z" />\n\t\t\t\t\t</svg>\n\t\t\t\t\t<small>&nbsp;conneted PEERS&nbsp;</small>\n\t\t\t\t</small>\n\t\t\t\t<small id="${PEERS_ID}" class="${PREFIX}-message-info-item-value">-</small>\n\t\t\t</div>\n\t\t\t<div class="${PREFIX}-message-info-item" title="Total quantity of data received from other peers.">\n\t\t\t\t<small class="${PREFIX}-message-info-item-label" style="align-items: center;">\n\t\t\t\t\t<svg width="16" height="16" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" style="opacity:0.5;">\n\t\t\t\t\t\t<path fill="currentColor" d="M1344 1344q0-26-19-45t-45-19-45 19-19 45 19 45 45 19 45-19 19-45zm256 0q0-26-19-45t-45-19-45 19-19 45 19 45 45 19 45-19 19-45zm128-224v320q0 40-28 68t-68 28h-1472q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h465l135 136q58 56 136 56t136-56l136-136h464q40 0 68 28t28 68zm-325-569q17 41-14 70l-448 448q-18 19-45 19t-45-19l-448-448q-31-29-14-70 17-39 59-39h256v-448q0-26 19-45t45-19h256q26 0 45 19t19 45v448h256q42 0 59 39z" />\n\t\t\t\t\t</svg>\n\t\t\t\t\t<small>&nbsp;from PEERS&nbsp;</small>\n\t\t\t\t</small>\n\t\t\t\t<small id="${PEERDATA_ID}" class="${PREFIX}-message-info-item-value">-</small>\n\t\t\t</div>\n\t\t\t<div class="${PREFIX}-message-info-item" title="Total quantity of data sent to other peers.">\n\t\t\t\t<small class="${PREFIX}-message-info-item-label" style="align-items: center;">\n\t\t\t\t\t<svg width="16" height="16" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" style="opacity:0.5;">\n\t\t\t\t\t\t<path fill="currentColor" d="M1344 1472q0-26-19-45t-45-19-45 19-19 45 19 45 45 19 45-19 19-45zm256 0q0-26-19-45t-45-19-45 19-19 45 19 45 45 19 45-19 19-45zm128-224v320q0 40-28 68t-68 28h-1472q-40 0-68-28t-28-68v-320q0-40 28-68t68-28h427q21 56 70.5 92t110.5 36h256q61 0 110.5-36t70.5-92h427q40 0 68 28t28 68zm-325-648q-17 40-59 40h-256v448q0 26-19 45t-45 19h-256q-26 0-45-19t-19-45v-448h-256q-42 0-59-40-17-39 14-69l448-448q18-19 45-19t45 19l448 448q31 30 14 69z" />\n\t\t\t\t\t</svg>\n\t\t\t\t\t<small>&nbsp;to PEERS&nbsp;</small>\n\t\t\t\t</small>\n\t\t\t\t<small id="${SENTDATA_ID}" class="${PREFIX}-message-info-item-value">-</small>\n\t\t\t</div>\n\t\t\t<div class="${PREFIX}-message-info-item" title="Total quantity of data received from the CDN.">\n\t\t\t\t<small class="${PREFIX}-message-info-item-label" style="align-items: center;">\n\t\t\t\t\t<svg width="16" height="16" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" style="opacity:0.5;">\n\t\t\t\t\t\t<path fill="currentColor" d="M128 1408h1024v-128h-1024v128zm0-512h1024v-128h-1024v128zm1568 448q0-40-28-68t-68-28-68 28-28 68 28 68 68 28 68-28 28-68zm-1568-960h1024v-128h-1024v128zm1568 448q0-40-28-68t-68-28-68 28-28 68 28 68 68 28 68-28 28-68zm0-512q0-40-28-68t-68-28-68 28-28 68 28 68 68 28 68-28 28-68zm96 832v384h-1792v-384h1792zm0-512v384h-1792v-384h1792zm0-512v384h-1792v-384h1792z" />\n\t\t\t\t\t</svg>\n\t\t\t\t\t<small>&nbsp;from CDN&nbsp;</small>\n\t\t\t\t</small>\n\t\t\t\t<small id="${CDNDATA_ID}" class="${PREFIX}-message-info-item-value">-</small>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n')}startRenderingStats(){if(null==this.statsElements&&(this.statsElements=this.getStatsTemplateElementsMap()),null==this.statsElements)return;this.updateStatsButtons(this.statsElements);let t=new v(this.buttonHandlers.h);for(;t.hasNext();){let e=t.next(),s=e.key,n=e.value;Object.prototype.hasOwnProperty.call(this.statsElements.h,s)&&this.statsElements.h[s].addEventListener("click",n);}let s=this.renderTimer;null!=s&&s.stop(),this.renderTimer=new g(2500),this.renderTimer.run=function(t,s){if(null==s)return null;null==s.__id__&&(s.__id__=e.$haxeUID++);var n;null==t.hx__closures__?t.hx__closures__={}:n=t.hx__closures__[s.__id__];null==n&&(n=s.bind(t),t.hx__closures__[s.__id__]=n);return n}(this,this.renderStats),this.renderStats();}cleanupStats(){if(null==this.statsElements)return;let t=new v(this.buttonHandlers.h);for(;t.hasNext();){let e=t.next(),s=e.key,n=e.value;Object.prototype.hasOwnProperty.call(this.statsElements.h,s)&&this.statsElements.h[s].removeEventListener("click",n);}s.iter(s.filter(this.statsElements,(function(t){return "button"!=t.tagName})),(function(t){t.innerText="-";}));let e=this.statsElements;null!=e&&(e.h=Object.create(null)),this.statsElements=null;let n=this.renderTimer;null!=n&&n.stop(),this.renderTimer=null;}renderStats(){if(null==this.sdk||null==this.statsElements)return;this.updateStatsButtons(this.statsElements);let t=new v(h.getValuesMap(this.sdk).h);for(;t.hasNext();){let e=t.next(),s=e.key,n=e.value;0!=Object.prototype.hasOwnProperty.call(this.statsElements.h,s)&&(this.statsElements.h[s].innerText=n);}}setMaxUploadPercent(t){let e;if(this.config.maxUploadPercent=t,null!=this.sdk){let s=this.sdk.factory,n=null!=s?s.getInstance("GeneralSettings"):null;e=(null!=n?n.maxUploadPercent:null)!=t;}else e=!1;e&&this.sdk.setMaxUploadPercent(t);}getStatsTemplateElementsMap(){let t=this;return s.fold(h.toArray(),(function(e,s){let n=u.getElementById(t.context+"-quanteec-"+e);return s.h[e]=n,s}),new _)}modifyMaxUploadValue(t){this.setMaxUploadPercent(t),this.updateStatsButtons(this.statsElements);}parseStatsHtmlTemplate(t,e){e=a.replace(e,"${PREFIX}",t);let s=new v(h.getMarkersMap().h);for(;s.hasNext();){let t=s.next();e=a.replace(e,t.value,this.context+"-quanteec-"+t.key);}return e}updateStatsButtons(t){if(null==t||0==Object.prototype.hasOwnProperty.call(t.h,"maxupload0")||0==Object.prototype.hasOwnProperty.call(t.h,"maxupload1")||0==Object.prototype.hasOwnProperty.call(t.h,"maxupload2"))return;let e=this.sdk,s=null!=e?e.factory:null,n=null!=s?s.getInstance("GeneralSettings"):null,l=null!=n?n.maxUploadPercent:null;if(null!=l)switch(l){case 0:this.updateStatsButtonStyle(!0,t.h.maxupload0),this.updateStatsButtonStyle(!1,t.h.maxupload1),this.updateStatsButtonStyle(!1,t.h.maxupload2);break;case.5:this.updateStatsButtonStyle(!1,t.h.maxupload0),this.updateStatsButtonStyle(!0,t.h.maxupload1),this.updateStatsButtonStyle(!1,t.h.maxupload2);break;case 1:this.updateStatsButtonStyle(!1,t.h.maxupload0),this.updateStatsButtonStyle(!1,t.h.maxupload1),this.updateStatsButtonStyle(!0,t.h.maxupload2);}}updateStatsButtonStyle(t,e){null!=e&&(e.style.backgroundColor=t?"#aaa":"transparent",e.style.color=t?"#000":"inherit");}applyStreamboostConfigToElement(t,e){if(null==e||null==t)return e;let s,n=Object.create(null);n["user-id"]=t.userId,n["sponsor-id"]=t.sponsorId,n["sponsor-image"]=t.sponsorImage,n["sponsor-url"]=t.sponsorUrl,n["dashboard-cards"]=t.dashboardCards,n["default-is-streamboost-on"]=t.defaultIsStreamboostOn?"true":"false",n["default-section"]=t.defaultSection,n.color=t.color;let l=Object.keys(n),a=l.length,i=0;for(;i<a;){let t=l[i++],a=n[t];s=e.hasAttribute(t),null==a&&s&&e.removeAttribute(t),null==a||s&&e.getAttribute(t)==a||e.setAttribute(t,a);}return e}}o.__name__="bs.player.plugin.quanteec.html.QuanteecHtmlRenderer",Object.assign(o.prototype,{__class__:o});class h{static toArray(){return ["cdndata","sentdata","peerdata","peers","greenscore","energysaved","co2saved","watersaved","unlightened","maxupload0","maxupload1","maxupload2"]}static getMarkersMap(){let t=new _;return t.h.cdndata="${CDNDATA_ID}",t.h.sentdata="${SENTDATA_ID}",t.h.peerdata="${PEERDATA_ID}",t.h.peers="${PEERS_ID}",t.h.greenscore="${GREENSCORE_ID}",t.h.energysaved="${ENERGYSAVED_ID}",t.h.co2saved="${CO2SAVED_ID}",t.h.watersaved="${WATERSAVED_ID}",t.h.unlightened="${UNLIGHTENED_ID}",t.h.maxupload0="${MAXUPLOAD_0_ID}",t.h.maxupload1="${MAXUPLOAD_1_ID}",t.h.maxupload2="${MAXUPLOAD_2_ID}",t}static getValuesMap(t){if(null==t)return new _;let e=t.getGreenScore(),s=t.getEnergySavedInLight(),n=new _,l=""+c.bytesToHumanReadable(t.getDataCDN(),2);n.h.cdndata=l;let a=""+c.bytesToHumanReadable(t.getDataSent(),2);n.h.sentdata=a;let i=""+c.bytesToHumanReadable(t.getDataPeer(),2);n.h.peerdata=i;let r=""+t.getPeerConnected();n.h.peers=r;let o=isNaN(e)?0:e;n.h.greenscore=o+" %";let h=d.toFixedString(t.getEnergySavedInWh(),2)+" Wh";n.h.energysaved=h;let u=d.toFixedString(t.getEnergySavedInCO2g(),2)+" g";n.h.co2saved=u;let p=d.toFixedString(t.getEnergySavedInWatercL(),2)+" cl";return n.h.watersaved=p,n.h.unlightened=s+" "+(s<2?"bulb":"bulbs"),n}}var u=require("bs.ui.Ui");class c{static bytesToHumanReadable(t,e,s){null==s&&(s=!1),null==e&&(e=0);let n=e<0?0:e;if(isNaN(t)||t<=0)return (e>0?d.toFixedString(0,e):"0")+" B";let a,i=s?1024:1e3,r=s?c.BINARY_UNITS:c.SI_UNITS,o=r.length,h=0|Math.floor(Math.log(t)/Math.log(i)),u=h<0?0:h>=o?o-1:h,p=t/Math.pow(i,u),g=r[u];if(n<=0)a=l.string(Math.round(p));else {let t=Math.pow(10,n),e=Math.round(p*t)/t;a=e==(0|e)?d.toFixedString(0|e,n):n>0?d.toFixedString(e,n):l.string(e);}return a+" "+g}}c.__name__="bs.util.ByteFormatter";var d=require("bs.util.TextTools");class p extends Error{constructor(t,e,s){super(t),this.message=t,this.__previousException=e,this.__nativeException=null!=s?s:this;}static caught(t){return t instanceof p?t:t instanceof Error?new p(t.message,null,t):new m(t,null,t)}}p.__name__="haxe.Exception",Object.assign(p.prototype,{__class__:p});var g=require("haxe.Timer");class m extends p{constructor(t,e,s){super(String(t),e,s),this.value=t;}}m.__name__="haxe.ValueException",Object.assign(m.prototype,{__class__:m});var _=require("haxe.ds.StringMap");class v{constructor(t){this.h=t,this.keys=Object.keys(t),this.length=this.keys.length,this.current=0;}hasNext(){return this.current<this.length}next(){let t=this.keys[this.current++];return {key:t,value:this.h[t]}}}v.__name__="haxe.ds._StringMap.StringMapKeyValueIterator",Object.assign(v.prototype,{__class__:v});class f{static getClass(t){if(null==t)return null;if(t instanceof Array)return Array;{let e=t.__class__;if(null!=e)return e;let s=f.__nativeClassName(t);return null!=s?f.__resolveNativeClass(s):null}}static __string_rec(t,e){if(null==t)return "null";if(e.length>=5)return "<...>";let s=typeof t;switch("function"==s&&(t.__name__||t.__ename__)&&(s="object"),s){case"function":return "<function>";case"object":if(t instanceof Array){let s="[";e+="\t";let n=0,l=t.length;for(;n<l;){let l=n++;s+=(l>0?",":"")+f.__string_rec(t[l],e);}return s+="]",s}let s;try{s=t.toString;}catch(t){return "???"}if(null!=s&&s!=Object.toString&&"function"==typeof s){let e=t.toString();if("[object Object]"!=e)return e}let n="{\n";e+="\t";let l=null!=t.hasOwnProperty,a=null;for(a in t)l&&!t.hasOwnProperty(a)||"prototype"!=a&&"__class__"!=a&&"__super__"!=a&&"__interfaces__"!=a&&"__properties__"!=a&&(2!=n.length&&(n+=", \n"),n+=e+a+" : "+f.__string_rec(t[a],e));return n+="\n"+(e=e.substring(1))+"}",n;case"string":return t;default:return String(t)}}static __nativeClassName(t){let e=f.__toStr.call(t).slice(8,-1);return "Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e}static __resolveNativeClass(t){return e[t]}}f.__name__="js.Boot",e.$haxeUID|=0,Object.defineProperty(String.prototype,"__class__",{value:String,enumerable:!1,writable:!0}),String.__name__="String",Array.__name__="Array",f.__toStr={}.toString,i._hx_skip_constructor=!1,r.__plugfaces__="IQuanteecPlugin,IPlugin",c.BINARY_UNITS=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],c.SI_UNITS=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];}(exports,window);
!function webpackUniversalModuleDefinition(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Quanteec",[],t):"object"==typeof exports?exports.Quanteec=t():e.Quanteec=t();}(window,function(){return r=[function(e,t,r){var n=r(33),i=r(34);e.exports=function(e,t){return null!=e&&i(e,t,n)};},function(t,e,r){!function(e){e="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};t.exports=e;}.call(this,r(26));},function(e,t,r){function a(e){return (a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=r(15),n=Object.prototype.toString;function o(e){return "[object Array]"===n.call(e)}function s(e){return void 0===e}function c(e){return null!==e&&"object"===a(e)}function u(e){return "[object Function]"===n.call(e)}function l(e,t){if(null!=e)if(o(e="object"!==a(e)?[e]:e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e);}e.exports={isArray:o,isArrayBuffer:function(e){return "[object ArrayBuffer]"===n.call(e)},isBuffer:function(e){return null!==e&&!s(e)&&null!==e.constructor&&!s(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return "undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return e="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return "string"==typeof e},isNumber:function(e){return "number"==typeof e},isObject:c,isUndefined:s,isDate:function(e){return "[object Date]"===n.call(e)},isFile:function(e){return "[object File]"===n.call(e)},isBlob:function(e){return "[object Blob]"===n.call(e)},isFunction:u,isStream:function(e){return c(e)&&u(e.pipe)},isURLSearchParams:function(e){return "undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return ("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:l,merge:function f(){var r={};function e(e,t){"object"===a(r[t])&&"object"===a(e)?r[t]=f(r[t],e):r[t]=e;}for(var t=0,n=arguments.length;t<n;t++)l(arguments[t],e);return r},deepMerge:function d(){var r={};function e(e,t){"object"===a(r[t])&&"object"===a(e)?r[t]=d(r[t],e):"object"===a(e)?r[t]=d({},e):r[t]=e;}for(var t=0,n=arguments.length;t<n;t++)l(arguments[t],e);return r},extend:function(r,e,n){return l(e,function(e,t){r[t]=n&&"function"==typeof e?i(e,n):e;}),r},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}};},function(e,t,r){var o=r(45),s=r(46);e.exports=function(e,t,r){var n=t&&r||0,i=("string"==typeof e&&(t="binary"===e?new Array(16):null,e=null),(e=e||{}).random||(e.rng||o)());if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var a=0;a<16;++a)t[n+a]=i[a];return t||s(i)};},function(e,t,r){e.exports=r(47);},function(e,t,r){var i=r(3);function a(e){return (a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=a(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=a(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==a(e)?e:e+""}(n.key),n);}}r=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");var r=this;this.id=e.id||i(),this.index=e.index,this.realNumber=e.realNumber,this.name=e.name,this.quality=e.quality,this.mediaType=e.mediaType,this.responseType=e.responseType,this.url=e.originUrl,this.originUrl=e.originUrl,this.isManifest=e.isManifest,this.manifestType=e.manifestType,this.isInit=e.isInit,this.isData=e.isData||!1,this.isSegment=e.isSegment,this.isInit||this.isManifest||this.isSegment||(this.isData=!0),this.range=e.range||undefined,this.duration=e.duration||0,this.progFunction=e.progressFunction||function(){},this.progressFunction=function(e,t){return e&&(r.progressSent+=e.byteLength),r.progFunction(e,t)},this.progressSent=e.progressSent||0,this.progressHistory=[],this.headers=e.headers||{},this.withCredentials=e.withCredentials||!1;}return e=t,(r=[{key:"toString",value:function(){return "index=".concat(this.index,"|quality=").concat(this.quality,"|mediaType=").concat(this.mediaType,"|init=").concat(this.isInit,"|manifest=").concat(this.isManifest,"|url=").concat(this.originUrl,"|").concat(this.id)}},{key:"getIndex",value:function(){return this.realNumber||this.index}},{key:"getSegmentSize",value:function(){return this.range&&this.range.end&&"number"==typeof this.range.end?this.range.end-this.range.start+1:0}}])&&o(e.prototype,r),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();t.a=r;},function(e,t,r){function i(e){return (i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=i(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==i(e)?e:e+""}(n.key),n);}}var n=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger"),this.buffer=0,this.audioBuffer=0,this.currentSegmentPlaying=-1;}return e=t,(r=[{key:"getCurrentSegmentPlaying",value:function(e,t){return -1===this.currentSegmentPlaying?e:this.currentSegmentPlaying}},{key:"getBufferLength",value:function(){return this.buffer}},{key:"setBufferLength",value:function(e){this.buffer=e;}},{key:"getAudioBufferLength",value:function(){return this.buffer}},{key:"setAudioBufferLength",value:function(e){this.buffer=e;}},{key:"seek",value:function(){}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();t.a=n;},function(e,t,r){function i(e){return (i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=i(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==i(e)?e:e+""}(n.key),n);}}var n=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger");}return e=t,(r=[{key:"stopPlayer",value:function(){var e=this.factory.getInstance("Events");e&&e.emit("PlaybackForbidden",{});}},{key:"liveDelay",value:function(){return this.factory.getInstance("BufferService").getBufferLength()}},{key:"getPlaybackRate",value:function(){return 1}},{key:"getBufferState",value:function(){return 0}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();t.a=n;},function(e,t){var r=Array.isArray;e.exports=r;},function(e,t,r){m=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",a={};var m,n,i,a,o,s=o={compressToBase64:function(e){if(null==e)return "";var t=o._compress(e,6,function(e){return n.charAt(e)});switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:o._decompress(t.length,32,function(e){return c(n,t.charAt(e))})},compressToUTF16:function(e){return null==e?"":o._compress(e,15,function(e){return m(e+32)})+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:o._decompress(t.length,16384,function(e){return t.charCodeAt(e)-32})},compressToUint8Array:function(e){for(var t=o.compress(e),r=new Uint8Array(2*t.length),n=0,i=t.length;n<i;n++){var a=t.charCodeAt(n);r[2*n]=a>>>8,r[2*n+1]=a%256;}return r},decompressFromUint8Array:function(e){if(null==e)return o.decompress(e);for(var t=new Array(e.length/2),r=0,n=t.length;r<n;r++)t[r]=256*e[2*r]+e[2*r+1];var i=[];return t.forEach(function(e){i.push(m(e));}),o.decompress(i.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":o._compress(e,6,function(e){return i.charAt(e)})},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),o._decompress(t.length,32,function(e){return c(i,t.charAt(e))}))},compress:function(e){return o._compress(e,16,function(e){return m(e)})},_compress:function(e,t,r){if(null==e)return "";for(var n,i,a,o,s={},c={},u="",l=2,f=3,d=2,p=[],y=0,g=0,h=0;h<e.length;h+=1)if(a=e.charAt(h),Object.prototype.hasOwnProperty.call(s,a)||(s[a]=f++,c[a]=!0),o=u+a,Object.prototype.hasOwnProperty.call(s,o))u=o;else {if(Object.prototype.hasOwnProperty.call(c,u)){if(u.charCodeAt(0)<256){for(n=0;n<d;n++)y<<=1,g==t-1?(g=0,p.push(r(y)),y=0):g++;for(i=u.charCodeAt(0),n=0;n<8;n++)y=y<<1|1&i,g==t-1?(g=0,p.push(r(y)),y=0):g++,i>>=1;}else {for(i=1,n=0;n<d;n++)y=y<<1|i,g==t-1?(g=0,p.push(r(y)),y=0):g++,i=0;for(i=u.charCodeAt(0),n=0;n<16;n++)y=y<<1|1&i,g==t-1?(g=0,p.push(r(y)),y=0):g++,i>>=1;}0==--l&&(l=Math.pow(2,d),d++),delete c[u];}else for(i=s[u],n=0;n<d;n++)y=y<<1|1&i,g==t-1?(g=0,p.push(r(y)),y=0):g++,i>>=1;0==--l&&(l=Math.pow(2,d),d++),s[o]=f++,u=String(a);}if(""!==u){if(Object.prototype.hasOwnProperty.call(c,u)){if(u.charCodeAt(0)<256){for(n=0;n<d;n++)y<<=1,g==t-1?(g=0,p.push(r(y)),y=0):g++;for(i=u.charCodeAt(0),n=0;n<8;n++)y=y<<1|1&i,g==t-1?(g=0,p.push(r(y)),y=0):g++,i>>=1;}else {for(i=1,n=0;n<d;n++)y=y<<1|i,g==t-1?(g=0,p.push(r(y)),y=0):g++,i=0;for(i=u.charCodeAt(0),n=0;n<16;n++)y=y<<1|1&i,g==t-1?(g=0,p.push(r(y)),y=0):g++,i>>=1;}0==--l&&(l=Math.pow(2,d),d++),delete c[u];}else for(i=s[u],n=0;n<d;n++)y=y<<1|1&i,g==t-1?(g=0,p.push(r(y)),y=0):g++,i>>=1;0==--l&&(l=Math.pow(2,d),d++);}for(i=2,n=0;n<d;n++)y=y<<1|1&i,g==t-1?(g=0,p.push(r(y)),y=0):g++,i>>=1;for(;;){if(y<<=1,g==t-1){p.push(r(y));break}g++;}return p.join("")},decompress:function(t){return null==t?"":""==t?null:o._decompress(t.length,32768,function(e){return t.charCodeAt(e)})},_decompress:function(e,t,r){for(var n,i,a,o,s,c,u=[],l=4,f=4,d=3,p="",y=[],g={val:r(0),position:t,index:1},h=0;h<3;h+=1)u[h]=h;for(i=0,o=Math.pow(2,2),s=1;s!=o;)a=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=r(g.index++)),i|=(0<a?1:0)*s,s<<=1;switch(i){case 0:for(i=0,o=Math.pow(2,8),s=1;s!=o;)a=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=r(g.index++)),i|=(0<a?1:0)*s,s<<=1;c=m(i);break;case 1:for(i=0,o=Math.pow(2,16),s=1;s!=o;)a=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=r(g.index++)),i|=(0<a?1:0)*s,s<<=1;c=m(i);break;case 2:return ""}for(n=u[3]=c,y.push(c);;){if(e<g.index)return "";for(i=0,o=Math.pow(2,d),s=1;s!=o;)a=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=r(g.index++)),i|=(0<a?1:0)*s,s<<=1;switch(c=i){case 0:for(i=0,o=Math.pow(2,8),s=1;s!=o;)a=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=r(g.index++)),i|=(0<a?1:0)*s,s<<=1;u[f++]=m(i),c=f-1,l--;break;case 1:for(i=0,o=Math.pow(2,16),s=1;s!=o;)a=g.val&g.position,g.position>>=1,0==g.position&&(g.position=t,g.val=r(g.index++)),i|=(0<a?1:0)*s,s<<=1;u[f++]=m(i),c=f-1,l--;break;case 2:return y.join("")}if(0==l&&(l=Math.pow(2,d),d++),u[c])p=u[c];else {if(c!==f)return null;p=n+n.charAt(0);}y.push(p),u[f++]=n+p.charAt(0),n=p,0==--l&&(l=Math.pow(2,d),d++);}}};function c(e,t){if(!a[e]){a[e]={};for(var r=0;r<e.length;r++)a[e][e.charAt(r)]=r;}return a[e][t]}(r=function(){return s}.call(t,r,t,e))!==undefined&&(e.exports=r);},function(e,t,r){e.exports=o,e.exports.isMobile=o,e.exports["default"]=o;var n=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|redmi|series[46]0|samsungbrowser.*mobile|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,i=/CrOS/,a=/android|ipad|playbook|silk/i;function o(e){var t,r=(e=e||{}).ua;return "string"==typeof(r=(r=r||"undefined"==typeof navigator?r:navigator.userAgent)&&r.headers&&"string"==typeof r.headers["user-agent"]?r.headers["user-agent"]:r)&&(!!(!(t=n.test(r)&&!i.test(r)||!!e.tablet&&a.test(r))&&e.tablet&&e.featureDetect&&navigator&&1<navigator.maxTouchPoints&&-1!==r.indexOf("Macintosh")&&-1!==r.indexOf("Safari"))||t)}},function(e,t,r){function n(e){return (n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return (t=t===undefined?Object:t)&&"function"==typeof t.freeze?t.freeze(e):e}var a=i({HTML:"text/html",isHTML:function(e){return e===a.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),o=i({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(e){return e===o.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});t.assign=function(e,t){if(null===e||"object"!==n(e))throw new TypeError("target is not an object");for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},t.find=function(e,t,r){if(r===undefined&&(r=Array.prototype),e&&"function"==typeof r.find)return r.find.call(e,t);for(var n=0;n<e.length;n++)if(Object.prototype.hasOwnProperty.call(e,n)){var i=e[n];if(t.call(undefined,i,n,e))return i}},t.freeze=i,t.MIME_TYPE=a,t.NAMESPACE=o;},function(e,t,r){var n=r(71);e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n(e,t);},e.exports.__esModule=!0,e.exports["default"]=e.exports;},function(r,C,e){e.r(C);var t=e(0),ee=e.n(t);function i(e){return (i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=i(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==i(e)?e:e+""}(n.key),n);}}var U=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.generalSettings=this.factory.getInstance("GeneralSettings"),this.data={},this.max_links_failed=30,this.max_segments_requested=20,this.max_broadcast_answers=30,this.reset();}return e=t,(r=[{key:"reset",value:function(){this.data={id:"",sdk:"web",group:"",private_ip:"",join_date:(new Date).getTime(),join_duration:0,group_join_date:0,group_join_duration:0,segment_number:0,r:0,network_type:"",device_type:"",nav:"",version:"",buffer:0,latency:0,segments_available:[],links_failed:[],links:[]};}},{key:"sendData",value:function(){this.generalSettings.activateFullFeedback&&(this.setDurations(),this.addExternalInfos(),this.factory.getInstance("Tracker").sendFeedback(this.data));}},{key:"addExternalInfos",value:function(){this.data.buffer=this.factory.getInstance("BufferService").getBufferLength(),this.data.latency=this.factory.getInstance("PlayerService").liveDelay(),this.data.segment_number=this.factory.getInstance("PeerInfosStorage").segmentNumber;}},{key:"setDurations",value:function(){var e=(new Date).getTime();this.data.join_duration=Math.floor((e-this.data.join_date)/1e3),0<this.data.group_join_date&&(this.data.group_join_duration=Math.floor((e-this.data.group_join_date)/1e3));for(var t=0;t<this.data.links.length;t++){var r=this.data.links[t];r.connection_duration=Math.floor((e-r.connection_date)/1e3);}}},{key:"setR",value:function(e){this.generalSettings.activateFullFeedback&&(this.data.r=e);}},{key:"setIP",value:function(e){this.generalSettings.activateFullFeedback&&(this.data.private_ip=e);}},{key:"setMainInfos",value:function(e,t,r,n){this.generalSettings.activateFullFeedback&&(this.data.version=e,this.data.network_type=t,this.data.device_type=r,this.data.nav=n);}},{key:"setID",value:function(e){this.generalSettings.activateFullFeedback&&(this.data.id=e);}},{key:"setInfosOfNewGroup",value:function(e,t){this.generalSettings.activateFullFeedback&&(this.data.group=e,this.data.group_join_date=t);}},{key:"addAvailableSegments",value:function(t,r,n,e){var i;this.generalSettings.activateFullFeedback&&(-1<(i=this.data.segments_available.findIndex(function(e){return e.segment_number===r&&e.media_type===t&&e.quality===n}))?this.data.segments_available[i].complete=e:this.data.segments_available.push({media_type:t,segment_number:r,quality:n,complete:e}));}},{key:"removeAvailableSegments",value:function(t,r){var e;this.generalSettings.activateFullFeedback&&-1<(e=this.data.segments_available.findIndex(function(e){return e.segment_number===r&&e.media_type===t}))&&this.data.segments_available.splice(e,1);}},{key:"addSegmentRequested",value:function(t,r,n,i,e){var a,o;this.generalSettings.activateFullFeedback&&-1<(a=this.data.links.findIndex(function(e){return e.id_link===t}))&&(-1<(o=(a=this.data.links[a]).segments_requested.findIndex(function(e){return e.segment_number===n&&e.media_type===r&&e.quality===i}))?a.segments_requested[o].status=e:(a.segments_requested.push({media_type:r,segment_number:n,quality:i,status:e}),a.nbr_segments_requested+=1),a.segments_requested.length>this.max_segments_requested)&&a.segments_requested.splice(0,1);}},{key:"addBroadcastAnswer",value:function(t,e,r,n,i,a,o,s,c,u,l){var f;this.generalSettings.activateFullFeedback&&-1<(f=this.data.links.findIndex(function(e){return e.id_link===t}))&&((f=this.data.links[f]).broadcast_answers.push({segment_number:e,quality:r,media_type:n,buf:i,pos:a,qa:o,r:s,sr:c,st:u,ste:l}),f.broadcast_answers.length>this.max_broadcast_answers)&&f.broadcast_answers.splice(0,1);}},{key:"addPingToLink",value:function(t,e){var r;this.generalSettings.activateFullFeedback&&-1<(r=this.data.links.findIndex(function(e){return e.id_link===t}))&&(this.data.links[r].ping_ms=e);}},{key:"addScoreToLink",value:function(t,e){var r;this.generalSettings.activateFullFeedback&&-1<(r=this.data.links.findIndex(function(e){return e.id_link===t}))&&(this.data.links[r].score_last=e);}},{key:"addDataReceivedToLink",value:function(t,e){var r;this.generalSettings.activateFullFeedback&&-1<(r=this.data.links.findIndex(function(e){return e.id_link===t}))&&(this.data.links[r].data_received_total_kB+=e);}},{key:"addDataSentToLink",value:function(t,e){var r;this.generalSettings.activateFullFeedback&&-1<(r=this.data.links.findIndex(function(e){return e.id_link===t}))&&(this.data.links[r].data_sent_total_kB+=e);}},{key:"addLink",value:function(e,t,r,n,i,a){this.generalSettings.activateFullFeedback&&(e={id_link:e,ping_ms:0,data_sent_total_kB:0,data_received_total_kB:0,is_ip:t,is_country:a,is_region:i,is_city:n,is_isp:r,nbr_segments_requested:0,connection_duration:0,connection_date:(new Date).getTime(),score_last:0,segments_requested:[],broadcast_answers:[]},this.data.links.push(e));}},{key:"removeLink",value:function(t){var e;this.generalSettings.activateFullFeedback&&-1<(e=this.data.links.findIndex(function(e){return e.id_link===t}))&&this.data.links.splice(e,1);}},{key:"addFailedLinks",value:function(t,e){var r,n;this.generalSettings.activateFullFeedback&&(-1<(r=this.data.links_failed.findIndex(function(e){return e.id_link===t}))?((n=this.data.links_failed[r]).last_fail_date=(new Date).getTime(),n.nbr_fails+=1):(n={id_link:t,last_fail_date:(new Date).getTime(),nbr_fails:1,reason:e},this.data.links_failed.push(n)),this.data.links_failed.length>this.max_links_failed)&&(this.data.links_failed.sort(function(e,t){return t.last_fail_date-e.last_fail_date}),this.data.links_failed.splice(0,1));}}])&&_(e.prototype,r),n&&_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}(),j=e(14);function a(e){return (a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=a(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=a(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==a(e)?e:e+""}(n.key),n);}}var F=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.init();}return e=t,(r=[{key:"init",value:function(){this.segmentVerificationSize=1e4;}}])&&B(e.prototype,r),n&&B(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function o(e){return (o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=o(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=o(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==o(e)?e:e+""}(n.key),n);}}var G=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.init();}return e=t,(r=[{key:"init",value:function(){this.useAbonnement=!0,this.useBroadcast=!0,this.useKnowledge=!1,this.useAnticipatedKnowledge=!1,this.useLastUL=!1,this.useSendLastUL=!0,this.useRetryP2P=!0,this.setLowLatency=!1,this.useComputedR=!0,this.useBlacklist=!0,this.useSendLogs=!1,this.forceLogLevel=-1,this.startDate=new Date,this.fuzzPercent=0,this.fuzzErrorPercent=0,this.serverSupportRangeRequests=!0,this.rangeSupported=!0,this.selectAbonnementFromBroadcast=!0,this.rFromGreenScore=!1,this.isSeeder=!1,this.rFromGSTime=30,this.ipRFactor=20,this.limitBandwidth=!1,this.idInUrlMatchedOnce=!1,this.useIndexModification=!1,this.useDownloadSimilarUrl=!1,this.useMissingData=!0,this.validateDataWithHead=!1,this.removeMessageOfOneByte=!1,this.useS2N=!0,this.factorP2P=1,this.factorP2PMin=1,this.factorP2PMax=2,this.factorHighSeeder=2.1,this.factorLowSeeder=1.6,this.guardFactor=.8,this.guardDLFactor=1,this.longDLFactor=.5,this.longFactor=1,this.longDLFactorLast=1.2,this.longFactorLast=1.3,this.longForcedFactor=3,this.longFactorLL=1.1,this.adRegex1="index_.*_\\d+_(\\d+)\\.(aac|ts|m4s|m4a|mp3|mp4)$",this.adRegex2="index_.*_(\\d+)\\.(aac|ts|m4s|m4a|mp3|mp4)$",this.adExtension1="",this.adExtension2="",this.adNumber=1;}},{key:"getFromGreenScore",value:function(){return this.rFromGreenScore&&(new Date).getTime()-this.startDate.getTime()>=1e3*this.rFromGSTime}},{key:"increaseP2PFactor",value:function(){this.factorP2P+=.2,this.validateP2PFactor();}},{key:"decreaseP2PFactor",value:function(){this.factorP2P-=.2,this.validateP2PFactor();}},{key:"validateP2PFactor",value:function(){this.factorP2P>this.factorP2PMax&&(this.factorP2P=this.factorP2PMax),this.factorP2P<this.factorP2PMin&&(this.factorP2P=this.factorP2PMin);}}])&&H(e.prototype,r),n&&H(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}(),t=e(9),V=e.n(t);function n(e){return (n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function s(n){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?z(Object(i),!0).forEach(function(e){var t,r;t=n,r=i[e=e],(e=X(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r;}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):z(Object(i)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e));});}return n}function K(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,X(n.key),n);}}function X(e){e=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=n(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==n(e)?e:e+""}var Q=function(){function n(e,t,r){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");this.cryptoModule=undefined,this.keyLengthRSA=2048,this.keyLengthAES=256,this.atob=t,this.btoa=r;}return e=n,(t=[{key:"initCrypto",value:function(e,t){e.pubKey&&this.cryptoModule&&this.cryptoModule.subtle&&(t.peerPublicKey||(t.peerPublicKey=this.importRSAKey(e.pubKey)),t.symmetricAESKey||(t.symmetricAESKey=this.generateAESKey()),t.encryptedAESKey||(t.encryptedAESKey=this.encryptAESKey(t.symmetricAESKey,t.peerPublicKey)));}},{key:"arrayBufferToBase64",value:function(e){for(var t="",r=new Uint8Array(e),n=r.byteLength,i=0;i<n;i++)t+=String.fromCharCode(r[i]);return window.btoa(t)}},{key:"base64ToArrayBuffer",value:function(e){for(var t=window.atob(e),r=t.length,n=new Uint8Array(r),i=0;i<r;i++)n[i]=t.charCodeAt(i);return n.buffer}},{key:"generateRSAKey",value:function(){return this.cryptoModule&&this.cryptoModule.subtle?this.cryptoModule.subtle.generateKey({name:"RSA-OAEP",modulusLength:this.keyLengthRSA,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"},!0,["encrypt","decrypt"]):undefined}},{key:"generateAESKey",value:function(){return this.cryptoModule&&this.cryptoModule.subtle?this.cryptoModule.subtle.generateKey({name:"AES-GCM",length:this.keyLengthAES},!0,["encrypt","decrypt"]):undefined}},{key:"exportKey",value:function(e){return this.cryptoModule.subtle.exportKey("jwk",e)}},{key:"importRSAKey",value:function(e){return this.cryptoModule.subtle.importKey("jwk",e,{name:"RSA-OAEP",modulusLength:this.keyLengthRSA,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"},!0,["encrypt"])}},{key:"importAESKey",value:function(e){return this.cryptoModule.subtle.importKey("raw",e,{name:"AES-GCM",length:this.keyLengthAES},!0,["encrypt","decrypt"])}},{key:"importJWKAESKey",value:function(e){return this.cryptoModule.subtle.importKey("jwk",JSON.parse((new TextDecoder).decode(e)),{name:"AES-GCM",length:this.keyLengthAES},!0,["encrypt","decrypt"])}},{key:"encryptAESKey",value:function(e,t){var r=this;return e.then(function(e){return Promise.all([t,r.exportKey(e)]).then(function(e){return r.cryptoModule.subtle.encrypt({name:"RSA-OAEP"},e[0],(new TextEncoder).encode(JSON.stringify(e[1])))})})}},{key:"encryptMessage",value:function(r,n){var i=this;return new Promise(function(t,e){if(n&&n.peerPublicKey)return Promise.all([n.symmetricAESKey,n.peerPublicKey]).then(function(e){var t=i.cryptoModule.getRandomValues(new Uint8Array(12));return Promise.all([i.cryptoModule.subtle.encrypt({name:"AES-GCM",iv:t},e[0],(new TextEncoder).encode(JSON.stringify(r))),i.cryptoModule.subtle.encrypt({name:"RSA-OAEP"},e[1],t),n.encryptedAESKey])}).then(function(e){t({dataEnc:i.arrayBufferToBase64(e[0]),iv:i.arrayBufferToBase64(e[1]),aeskey:i.arrayBufferToBase64(e[2])});});t(r);})}},{key:"decryptMessage",value:function(i,a){var o=this;return new Promise(function(t,e){var r;if(""===i.iv&&""===i.aeskey)try{i=JSON.parse(window.atob(i.dataEnc));}catch(n){}else if(i.dataEnc)return r=o.cryptoModule.subtle.decrypt({name:"RSA-OAEP"},a,o.base64ToArrayBuffer(i.iv)),o.cryptoModule.subtle.decrypt({name:"RSA-OAEP"},a,o.base64ToArrayBuffer(i.aeskey)).then(function(e){return Promise.all([r,o.importAESKey(e)])}).then(function(e){return o.cryptoModule.subtle.decrypt({name:"AES-GCM",iv:e[0]},e[1],o.base64ToArrayBuffer(i.dataEnc))}).then(function(e){t(s(s({},JSON.parse((new TextDecoder).decode(e))),i));});t(i);})}},{key:"decryptMessagePeer",value:function(n,i){var a=this;return new Promise(function(t,e){var r;if(n.dataEnc&&i)return r=a.cryptoModule.subtle.decrypt({name:"RSA-OAEP"},i,a.base64ToArrayBuffer(n.iv)),a.cryptoModule.subtle.decrypt({name:"RSA-OAEP"},i,a.base64ToArrayBuffer(n.aeskey)).then(function(e){return Promise.all([r,a.importJWKAESKey(e)])}).then(function(e){return a.cryptoModule.subtle.decrypt({name:"AES-GCM",iv:e[0]},e[1],a.base64ToArrayBuffer(n.dataEnc))}).then(function(e){t(s(s({},JSON.parse((new TextDecoder).decode(e))),n));});t(n);})}}])&&K(e.prototype,t),r&&K(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r;}();function c(e){return (c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function m(n){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?W(Object(i),!0).forEach(function(e){var t,r;t=n,r=i[e=e],(e=Z(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r;}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):W(Object(i)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e));});}return n}function Y(e,t){var r,n,i,a,o,s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(e);},n:function(){var e=s.next();return n=e.done,e},e:function t(e){i=!0,r=e;},f:function(){try{n||null==s["return"]||s["return"]();}finally{if(i)throw r}}};if(Array.isArray(e)||(s=function(e,t){{var r;if(e)return "string"==typeof e?$(e,t):"Map"===(r="Object"===(r={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length)return s&&(e=s),a=0,{s:o=function o(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function t(e){throw e},f:o};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function J(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Z(n.key),n);}}function Z(e){e=function(e,t){if("object"!=c(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=c(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==c(e)?e:e+""}var te=e(3),re=function(){function n(e,t){var r=this;if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");this.factory=e,this.peerAnalyticsUuid=te(),this.log=this.factory.getInstance("MyLogger"),this.events=this.factory.getInstance("Events"),this.callbacks=[],this.defaultUrl="",t&&t.url&&(this.defaultUrl=t.url),this.listUrl=[this.defaultUrl],this.listUrlPosition=0,this.videoID=t.videoID,this.clientID=t.clientID,this.isClosed=!0,this.reconnectTimeout=null,this.retryReconnectDuration=.5,this.minRetryReconnectDuration=.5,this.maxRetryReconnectDuration=10,this.peerKeys={},this.cryptoUtils=new Q(window.crypto,window.atob,window.btoa),this.privKey="",this.keyPair=this.cryptoUtils.generateRSAKey(),this.keyPair?this.pubKey=this.keyPair.then(function(e){return r.privKey=e.privateKey,r.cryptoUtils.exportKey(e.publicKey)}):this.pubKey=new Promise(function(e){return e("")}),this.initSent=!1,this.groupRequestBeforeUuid=null,this.playbackReceived=!1,this.playbackDate=null,this.jailTime=12e4,this.allTimeouts=[],this.startPingDate=new Date;}return e=n,(t=[{key:"reset",value:function(){this.isClosed=!0;try{this.socket.close();}catch(e){}try{clearTimeout(this.reconnectTimeout);}catch(e){}this.clearAllTimeouts();}},{key:"getVideoID",value:function(){return this.videoID}},{key:"clearAllTimeouts",value:function(){try{for(var e=0;e<this.allTimeouts.length;e++)clearTimeout(this.allTimeouts[e]);this.allTimeouts=[];}catch(t){}}},{key:"connect",value:function(){var p=this,y=p.factory.getInstance("PeerConnection"),e=p.factory.getInstance("GeneralSettings"),g=0;if(null!==this.playbackDate&&(new Date).getTime()-this.playbackDate.getTime()>this.jailTime&&(this.playbackReceived=!1),""===this.videoID||this.playbackReceived)this.isClosed=!0;else {this.isClosed=!1;var t=this.listUrl[this.listUrlPosition],r=(e.p2pConfiguration&&(t+="?config="+e.p2pConfiguration),this.socket=new WebSocket(t),p.factory.getInstance("PeerInfosStorage"));try{r.hasBeenInGroup||(g=setTimeout(function(){r.hasBeenInGroup=!0;},3e3));}catch(h){}this.socket.onopen=function(e){p.retryReconnectDuration=p.minRetryReconnectDuration,p.events.emit("trackerStatusChanged",{status:"connected"}),p.initSent=!1;},this.socket.onmessage=function(e){var t,r=JSON.parse(e.data),n=p.factory.getInstance("GeneralSettings");switch(r.type){case"uuid":p.factory.getInstance("PeerInfosStorage").setUuid(r.uuid),p.factory.getInstance("PeerDataService").setID(r.uuid),p.events.emit("uuid",r.uuid),r.pubKey&&(p.peerKeys.tracker={},p.cryptoUtils.initCrypto({uuid:"tracker",pubKey:r.pubKey},p.peerKeys.tracker)),p.pubKey.then(function(r){y.getLocalIPs().then(function(e){var t={type:"init",videoID:p.videoID,pubKey:r,clientID:p.clientID,sdk:"web"};n&&n.analyticsVideoID&&""!==n.analyticsVideoID&&(t.analyticsVideoID=n.analyticsVideoID),e&&0<e.length&&(t.privateAddr=e),p.startPingDate=new Date,p.socket.send(JSON.stringify(t)),setTimeout(function(){p.initSent=!0,null!==p.groupRequestBeforeUuid&&p.groupRequest(p.groupRequestBeforeUuid);},700);});});break;case"groupResponse":if(p.log.debug("[Tracker] Group response received",r),p.factory.getInstance("AnalyticsService").nbrGroups+=1,p.clearAllTimeouts(),n.activated){p.factory.getInstance("StorageCustomDecision").setData("lastGroupRequest",new Date),y.isFirstInGroup=!1;var i,a=Y(r.list);try{for(a.s();!(i=a.n()).done;){var o=i.value;1===p.factory.getInstance("AnalyticsService").nbrGroups&&p.factory.getInstance("VideoStorage").initSegmentToKeepNumbers(r.list.length),o.uuid!==p.factory.getInstance("PeerInfosStorage").getUuid()&&"add"===o.modification&&(p.peerKeys[o.uuid]={},p.cryptoUtils.initCrypto(o,p.peerKeys[o.uuid]),p.log.debug("[Controller] Add peer:",o.uuid),p.factory.getInstance("PeerListStorage").addOrUpdateInList(o.uuid,{uuid:o.uuid,joinDate:o.joinDate,ip:o.sameIP&&!n.ignoreSameIP?1:0,country:o.sameCountry?1:0,region:o.sameRegion?1:0,city:o.sameCity?1:0}),(y=p.factory.getInstance("PeerConnection")).connect(o.uuid,o.joinDate,o.sameIP&&!n.ignoreSameIP?1:0,o.sameCountry?1:0,o.sameRegion?1:0,o.sameCity?1:0));}}catch(h){a.e(h);}finally{a.f();}try{p.factory.getInstance("AnalyticsService").nbrPeerInGroup=0;}catch(h){}var s=p.factory.getInstance("PeerInfosStorage");if(s.setGroup(r.group),!s.hasBeenInGroup){try{clearTimeout(g);}catch(h){}g=setTimeout(function(){s.hasBeenInGroup=!0;},1e3);}s.setJoinDate(r.joinDate),p.factory.getInstance("PeerDataService").setInfosOfNewGroup(r.group,(new Date).getTime()),p.events.emit("groupRefreshed",r.group),p.events.emit("peerListRefreshed",r.list);}break;case"storageWindow":if(r.data&&"number"==typeof r.data)try{p.factory.getInstance("VideoStorage").numberToKeep=r.data;}catch(h){}break;case"iceList":p.cryptoUtils.decryptMessage(r,p.privKey).then(function(e){y=p.factory.getInstance("PeerConnection");e=e.data;e&&Array.isArray(e)&&(y.configuration.iceServers=e);});break;case"trackerList":var c=p.listUrl[p.listUrlPosition];p.cryptoUtils.decryptMessage(r,p.privKey).then(function(e){r.data=e.data,p.listUrl="string"==typeof e.data?[e.data]:e.data,p.listUrl[p.listUrlPosition]===c?p.listUrlPosition=0:(p.listUrlPosition=-1,p.socket.close());});break;case"peerListModif":if(n.activated){var u,l=Y(r.list);try{for(l.s();!(u=l.n()).done;){var f=u.value;f.uuid!==p.factory.getInstance("PeerInfosStorage").getUuid()&&("add"===f.modification?(p.peerKeys[f.uuid]={},p.cryptoUtils.initCrypto(f,p.peerKeys[f.uuid])):f.modification);}}catch(h){l.e(h);}finally{l.f();}p.events.emit("peerListRefreshed",r.list);}break;case"peerDisconnected":break;case"peerConnectedModif":r.list&&(t=p.factory.getInstance("PeerConnection"),r.list.forEach(function(e){"delete"===e.modification&&e.uuid!==p.factory.getInstance("PeerInfosStorage").getUuid()&&(p.log.debug("[Controller] Disconnect received from controller",e.uuid),t.disconnect(e.uuid));}));break;case"transfer":n.activated&&(r.dataEnc&&(r.dataEnc=V.a.decompressFromUTF16(r.dataEnc)),p.cryptoUtils.decryptMessagePeer(r,p.privKey).then(function(e){p.factory.getInstance("PeerConnection").transferReceived(e);})["catch"](function(e){p.factory.getInstance("PeerConnection").transferReceived(r);}));break;case"peerList":ee()(p.callbacks,r.msgId)&&p.callbacks[r.msgId]instanceof Function&&p.callbacks[r.msgId](m(m({},r),{},{requestEnd:(new Date).getTime()}));break;case"playbackManagement":p.playbackReceived=!0,p.playbackDate=new Date,p.close();break;case"groupReaffection":n.activated&&(p.factory.getInstance("PeerInfosStorage").mustReaffectGroup=!0);break;case"params":var d=p.factory.getInstance("VariableSettings");try{p.factory.getInstance("AnalyticsService").controllerPing=(new Date).getTime()-p.startPingDate.getTime();}catch(h){}ee()(r,"cellularActivated")&&"boolean"==typeof r.cellularActivated&&(n.cellularActivated=r.cellularActivated),ee()(r,"maxUploadPercent")&&"number"==typeof r.maxUploadPercent&&!p.factory.getInstance("GeneralSettings").forceMaxUploadPercent&&(n.maxUploadPercent=r.maxUploadPercent/100),ee()(r,"numberOfSegmentsToKeep")&&"number"==typeof r.numberOfSegmentsToKeep&&(n.numberOfSegmentsToKeep=r.numberOfSegmentsToKeep),ee()(r,"activateFullFeedback")&&"boolean"==typeof r.activateFullFeedback&&(n.activateFullFeedback=r.activateFullFeedback,p.factory.getInstance("PeerDataService").setID(p.factory.getInstance("PeerInfosStorage").getUuid())),ee()(r,"prevents")&&n.setPrevents(r.prevents),ee()(r,"collection")?p.log.debug("Collection used for P2P configuration:",r.collection):p.log.trace("No collection used for P2P configuration"),ee()(r,"useIndexModification")&&"boolean"==typeof r.useIndexModification&&(d.useIndexModification=r.useIndexModification),ee()(r,"useDownloadSimilarUrl")&&"boolean"==typeof r.useDownloadSimilarUrl&&(d.useDownloadSimilarUrl=r.useDownloadSimilarUrl),ee()(r,"validateData")&&"boolean"==typeof r.validateData&&(n.validateData=r.validateData),ee()(r,"useMissingData")&&"boolean"==typeof r.useMissingData&&(d.useMissingData=r.useMissingData),ee()(r,"validateDataWithHead")&&"boolean"==typeof r.validateDataWithHead&&(d.validateDataWithHead=r.validateDataWithHead),ee()(r,"p2pOptimizedStart")&&"boolean"==typeof r.p2pOptimizedStart&&(n.p2pOptimizedStart=r.p2pOptimizedStart),ee()(r,"lowLatency")&&"boolean"==typeof r.lowLatency&&(d.setLowLatency=r.lowLatency),ee()(r,"lowLatencyBufferLimit")&&"number"==typeof r.lowLatencyBufferLimit&&(n.lowLatencyBufferLimit=r.lowLatencyBufferLimit),ee()(r,"useS2N")&&"boolean"==typeof r.useS2N&&(d.useS2N=r.useS2N),ee()(r,"factorP2P")&&"number"==typeof r.factorP2P&&(d.factorP2P=r.factorP2P),ee()(r,"factorP2PMin")&&"number"==typeof r.factorP2PMin&&(d.factorP2PMin=r.factorP2PMin),ee()(r,"factorP2PMax")&&"number"==typeof r.factorP2PMax&&(d.factorP2PMax=r.factorP2PMax),ee()(r,"factorHighSeeder")&&"number"==typeof r.factorHighSeeder&&(d.factorHighSeeder=r.factorHighSeeder),ee()(r,"factorLowSeeder")&&"number"==typeof r.factorLowSeeder&&(d.factorLowSeeder=r.factorLowSeeder),ee()(r,"guardFactor")&&"number"==typeof r.guardFactor&&(d.guardFactor=r.guardFactor),ee()(r,"guardDLFactor")&&"number"==typeof r.guardDLFactor&&(d.guardDLFactor=r.guardDLFactor),ee()(r,"longDLFactor")&&"number"==typeof r.longDLFactor&&(d.longDLFactor=r.longDLFactor),ee()(r,"longFactor")&&"number"==typeof r.longFactor&&(d.longFactor=r.longFactor),ee()(r,"longDLFactorLast")&&"number"==typeof r.longDLFactorLast&&(d.longDLFactorLast=r.longDLFactorLast),ee()(r,"longFactorLast")&&"number"==typeof r.longFactorLast&&(d.longFactorLast=r.longFactorLast),ee()(r,"longForcedFactor")&&"number"==typeof r.longForcedFactor&&(d.longForcedFactor=r.longForcedFactor),ee()(r,"longFactorLL")&&"number"==typeof r.longFactorLL&&(d.longFactorLL=r.longFactorLL),ee()(r,"removeMessageOfOneByte")&&"boolean"==typeof r.removeMessageOfOneByte&&(d.removeMessageOfOneByte=r.removeMessageOfOneByte),ee()(r,"useComputedR")&&"boolean"==typeof r.useComputedR&&(d.useComputedR=r.useComputedR),ee()(r,"useSendLogs")&&"boolean"==typeof r.useSendLogs&&(d.useSendLogs=r.useSendLogs),ee()(r,"forceLogLevel")&&"number"==typeof r.forceLogLevel&&(d.forceLogLevel=r.forceLogLevel,0<=r.forceLogLevel)&&r.forceLogLevel<=4&&(p.log.loglevel=r.forceLogLevel),ee()(r,"adRegex1")&&"string"==typeof r.adRegex1&&(d.adRegex1=r.adRegex1),ee()(r,"adRegex2")&&"string"==typeof r.adRegex2&&(d.adRegex2=r.adRegex2),ee()(r,"adExtension1")&&"string"==typeof r.adExtension1&&(d.adExtension1=r.adExtension1),ee()(r,"adExtension2")&&"string"==typeof r.adExtension2&&(d.adExtension2=r.adExtension2),ee()(r,"adNumber")&&"number"==typeof r.adNumber&&(d.adNumber=r.adNumber);break;default:p.log.trace("Unknown message type "+r.type);}},this.socket.onclose=function(e){p.log.debug("[Controller] Websocket closed",e),p.events.emit("trackerStatusChanged",{status:"disconnected"});try{p.factory.getInstance("PeerInfosStorage").hasBeenInGroup=!0;}catch(h){}if(!p.isClosed){try{clearTimeout(p.reconnectTimeout);}catch(s){}p.listUrlPosition++,p.listUrlPosition>=p.listUrl.length&&(p.listUrlPosition=0),p.retryReconnectDuration=Math.min(2*p.retryReconnectDuration,p.maxRetryReconnectDuration),p.reconnectTimeout=setTimeout(p.connect.bind(p),1e3*p.retryReconnectDuration);}try{var t,r=p.factory.getInstance("PeerListStorage").getListKeys(),n=p.factory.getInstance("PeerConnection"),i=p.factory.getInstance("PeerInfosStorage"),a=Y(r);try{for(a.s();!(t=a.n()).done;){var o=t.value;n.closeChannel(o);}}catch(h){a.e(h);}finally{a.f();}i.disconnect();}catch(h){}},this.socket.onerror=function(e){p.log.error("[Controller] Websocket error",e),p.socket.close();};}}},{key:"transfer",value:function(t){var r=this,e=this.factory.getInstance("GeneralSettings");this.socket&&(1===this.socket.readyState&&e.activated?this.privKey?this.cryptoUtils.encryptMessage(t,this.peerKeys[t.remotePeerID]).then(function(e){e.dataEnc=V.a.compressToUTF16(e.dataEnc),r.socket.send(JSON.stringify(m({type:"transfer",remotePeerID:t.remotePeerID},e)));})["catch"](function(e){r.socket.send(JSON.stringify(m({type:"transfer",remotePeerID:t.remotePeerID},t)));}):this.socket.send(JSON.stringify(m({type:"transfer",remotePeerID:t.remotePeerID},t))):0===this.socket.readyState&&setTimeout(this.transfer.bind(this),500,t));}},{key:"sendInfos",value:function(e){this.socket&&1===this.socket.readyState&&this.socket.send(JSON.stringify(m({type:"sendInfos"},e)));}},{key:"sendFeedback",value:function(e){this.socket&&1===this.socket.readyState&&this.socket.send(JSON.stringify({type:"sendFeedback",data:e}));}},{key:"sendHdmof",value:function(e){this.socket&&1===this.socket.readyState&&this.socket.send(JSON.stringify({type:"hdmof",value:e}));}},{key:"getList",value:function(e){var t;this.socket&&(1===this.socket.readyState?(t=te(),this.callbacks[t]=e,this.socket.send(JSON.stringify({type:"peerList",msgId:t,requestStart:(new Date).getTime()}))):0===this.socket.readyState&&setTimeout(this.getList.bind(this),500,e));}},{key:"groupRequest",value:function(e){try{var t=this.factory.getInstance("GeneralSettings"),r=this.factory.getInstance("AnalyticsService");if(this.socket&&t.activated)if(1===this.socket.readyState&&this.initSent){try{""===this.factory.getInstance("PeerInfosStorage").getGroup()&&this.factory.getInstance("PeerInfosStorage").setGroup("waiting...");}catch(n){}try{r.newg+=1;}catch(i){}this.socket.send(JSON.stringify({type:"groupRequest",groupRequest:e})),this.groupRequestBeforeUuid=null,this.factory.getInstance("PeerInfosStorage").setGroupTargetQuality(e.targetQuality);}else 0===this.socket.readyState?(this.groupRequestBeforeUuid=e,setTimeout(this.groupRequest.bind(this),500,e)):1!==this.socket.readyState||this.initSent||(this.groupRequestBeforeUuid=e);}catch(i){}}},{key:"leaveGroup",value:function(){try{this.factory.getInstance("PeerInfosStorage").setGroup("");}catch(e){}this.socket&&(1===this.socket.readyState&&this.initSent?this.socket.send(JSON.stringify({type:"leaveGroup"})):0===this.socket.readyState?setTimeout(this.leaveGroup.bind(this),500,data):1===this.socket.readyState&&this.initSent);}},{key:"createCrypto",value:function(e){}},{key:"clearCrypto",value:function(e){try{delete this.peerKeys[e];}catch(t){}}},{key:"sendAnalytics",value:function(e,t){this.socket&&(1===this.socket.readyState?this.socket.send(JSON.stringify({type:"analytics",key:e.toLowerCase(),data:t,uuid:this.peerAnalyticsUuid})):0===this.socket.readyState&&setTimeout(this.sendAnalytics.bind(this),500,e,t));}},{key:"sendLogs",value:function(e){this.socket&&(1===this.socket.readyState?this.socket.send(JSON.stringify({type:"logs",data:e})):0===this.socket.readyState&&setTimeout(this.sendLogs.bind(this),500,e));}},{key:"close",value:function(){try{this.isClosed=!0,this.socket.close(),this.socket=null;}catch(e){}}}])&&J(e.prototype,t),r&&J(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r;}(),t=e(10),ne=e.n(t),ie=e(3);function ae(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function oe(n){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ae(Object(i),!0).forEach(function(e){var t,r;t=n,r=i[e=e],(e=le(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r;}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):ae(Object(i)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e));});}return n}function u(e){return (u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ce(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,le(n.key),n);}}function ue(e,t,r){return t&&ce(e.prototype,t),r&&ce(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function le(e){e=function(e,t){if("object"!=u(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=u(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==u(e)?e:e+""}var fe=function(){return ue(function e(){se(this,e),this.reset();},[{key:"reset",value:function(){this.peer_id="",this.help={http:0},this.B_manifest=0,this.MB_server=0,this.MB_peer=0,this.MB_peer_ip=0,this.MB_peer_country=0,this.MB_peer_region=0,this.MB_peer_city=0,this.data_sent=0,this.sec_peer=0,this.sec_server=0,this.s=0,this.q=0,this.co_sum=0,this.co_no=0,this.bg=0,this.gTime=0,this.age=0,this.dr=0,this.ds=0,this.lastP="",this.qualities={SD:0,HD:0,FullHD:0,"2K":0,"4K":0,"8K":0,audio:0},this.timestamp=0,this.video_id=0,this.nbrQualityChange=0,this.bestQuality=0,this.otherQualities=0,this.timeLQ=0,this.timeHQ=0,this.p2pReady=0,this.qChanged=0,this.co=0,this.ciu=0,this.bufferFactor=0,this.nav="",this.ua="",this.v="1.2.20",this.connected={},this.ttfb_server=0,this.ttfb_peer=0,this.ttfb_peer_ip=0,this.ttfb_peer_country=0,this.ttfb_peer_region=0,this.ttfb_peer_city=0,this.isStalled=0,this.sec_rebuf=0,this.sec_rebuf_p2p=0,this.sec_rebuf_http=0,this.nbrStalls=0,this.nbrStallsHTTP=0,this.nbrStallsP2P=0,this.nReq=0,this.nReq_server=0,this.nReq_p2p=0,this.sec_rebuf_1=0,this.sec_rebuf_2=0,this.sec_rebuf_3=0,this.n_rebuf_1=0,this.n_rebuf_2=0,this.n_rebuf_3=0,this.buf={isStalled:0,sec_rebuf:0,sec_rebuf_p2p:0,sec_rebuf_http:0,nbrStalls:0,nbrStallsHTTP:0,nbrStallsP2P:0,nReq:0,nReq_server:0,nReq_p2p:0,sec_rebuf_1:0,sec_rebuf_2:0,sec_rebuf_3:0,n_rebuf_1:0,n_rebuf_2:0,n_rebuf_3:0},this.HTTP_errors={},this.HTTPDownloadDuration=[],this.P2PDownloadDuration=[],this.mean_HTTP_download_duration=0,this.mean_P2P_download_duration=0,this.P2P_requests_abort=0,this.P2P_abort_reason={},this.current_buffer=0;var e,t,r=["cellular","wifi","phone","tablet","desktop"],n=["MB_peer","MB_server","sec_peer","sec_server","timeHQ","timeLQ","represented_client","MB_peer_ip","MB_peer_city","MB_peer_region","MB_peer_country","isStalled","nbrStalls","nbrQualityChange","bufferFactor","current_buffer","bestQuality","ohterQualities"],i=["MB_peer","MB_server","sec_peer","sec_server","isStalled","nbrStalls","nbrQualityChange","bufferFactor"];for(e in n)this.connected[n[e]]=0;for(t in this.connected.qualities={},r)for(var a in this.connected[r[t]]={},this[r[t]]={},i)this.connected[r[t]][i[a]]=0,this[r[t]][i[a]]=0;}}])}(),de=function(){return ue(function t(e){se(this,t),this.factory=e,this.events=this.factory.getInstance("Events"),this.log=this.factory.getInstance(""),this.isInitialized=!1,this.rebufs=[],this.dateStartRebuf,this.dateEndRebuf,this.dateStartMetrics=new Date,this.startDateMetrics=new Date,this.playerMetrics=new fe,this.Http=new XMLHttpRequest,this.registerHttp=new XMLHttpRequest,this.registered=0,this.analyticsAddr=undefined,this.playerMetrics.client_uuid=ie(),this.playerMetrics.represented_client=1,this.dateHidden=null,this.ciu=0,this.stream_type="",this.protocol="",this.q_nbr=0,this.seg_dur=0,this.seg_nbr=0,this.seg_ext="",this.cover_ratio=0,this.cover_ratio_max=0,this.connectedWithSomeoneOnce=0,this.connectedWithManyOnce=0,this.maxConnectedWithMany=0,this.nbrGroups=0,this.controllerPing=-1,this.newco=0,this.newco_to=0,this.newco_ok=0,this.ice=0,this.nbrPeerInGroup=0,this.newg=0,this.newg_q=0,this.newg_co=0,this.newg_5=0,this.newg_p2p=0,this.newg_f=0,this.regularRebuffs=!1,this.nbRebuffs=0,this.lastDateRebuf=null,this.p2pReceivedLastPeriod=!1,this.p2pReceivedDate=new Date,this.p2pSentLastPeriod=!1,this.p2pSentDate=new Date,this.p2pSentReceivedThreshold=30,this.connectedCount=0,this.notConnectedCount=0,this.q=0,this.lastPeer="",this.sleepTime=10,this.interval,this.arg=this.playerMetrics,this.elasticUrl="",this.record={},this.logs=[],this.interval=setInterval(this.afterSleep.bind(this),1e3*this.sleepTime,this.arg),this.lastQuality=null,this.hidden="hidden",this.visibilityState="visibilityState","undefined"!=typeof document.hidden?(this.hidden="hidden",this.visibilityState="visibilityState"):"undefined"!=typeof document.msHidden?(this.hidden="msHidden",this.visibilityState="msVisibilityState"):"undefined"!=typeof document.webkitHidden&&(this.hidden="webkitHidden",this.visibilityState="webkitVisibilityState"),ne()()?this.category=1:ne()({tablet:!0})?this.category=2:this.category=3,this.speedType=1;e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;e&&e.type&&"cellular"===e.type&&(this.speedType=2),this.dataReceived={http:0,p2p:0,factor:0,ip:0,city:0,region:0,country:0},this.dataSent={p2p:0,factor:0,ip:0,city:0,region:0,country:0},this.factor={ip:1.25,city:1.15,region:1.05,country:1};},[{key:"isAlwaysStalled",value:function(){return null!==this.lastDateRebuf&&!!(((new Date).getTime()-this.lastDateRebuf.getTime()<72e5||!this.dateEndRebuf&&this.dateStartRebuf)&&2<=this.nbRebuffs)}},{key:"sendCustomAnalytics",value:function(e){var t,r,n,i=this.factory.getInstance("GeneralSettings");i.logLatency&&(self.log.debug("Timings ".concat(e.rType," first: ").concat(e.first," end: ").concat(e.end)),n=this.factory.getInstance("P2P"),t=i.analyticsVideoID||i.videoID,r=i.analyticsID,this.analyticsAddr=i.analyticsUrl,i=new Date(Date.now()),n=n.factory.getInstance("Tracker"),e=oe(oe({},e),{},{videoID:t,timestamp:i}),n.sendAnalytics(r.toString(),e));}},{key:"afterSleep",value:function(e){var t=this.factory.getInstance("GeneralSettings"),r=this.factory.getInstance("PeerDataService"),n=this.factory.getInstance("P2P"),i=t.analyticsVideoID||t.videoID,a=t.analyticsID,o=(this.analyticsAddr=t.analyticsUrl,new Date(Date.now())),s=n.factory.getInstance("Tracker"),c=this.factory.getInstance("PeerInfosStorage").uuid,u=this.isAlwaysStalled();if(this.registered||0!==e.sec_server||0!==e.sec_peer||t.isFileMode){this.registered||(this.record.timestamp=o,this.record.new_client_uuid=this.playerMetrics.client_uuid,this.record.new_client_number=1,this.record.video_id=i,s.sendAnalytics(a.toString(),this.record),this.registered=1),this.playerMetrics.timestamp=o,this.playerMetrics.video_id=i,this.playerMetrics.peer_id=c,document[this.hidden]&&(this.dateStartMetrics=new Date);try{this.playerMetrics.p2pReady=0<n.factory.getInstance("PeerListService").getListByConnectedPeers().length?1:0,this.playerMetrics.co=n.factory.getInstance("PeerListService").getListByConnectedPeers().length,5<this.playerMetrics.co&&(this.connectedWithManyOnce=1),this.playerMetrics.co>this.maxConnectedWithMany&&(this.maxConnectedWithMany=this.playerMetrics.co);}catch(h){}1===this.playerMetrics.p2pReady&&(this.playerMetrics.connected.represented_client=1),t.collection&&(this.playerMetrics.collection=t.collection),t.p2pConfiguration&&(this.playerMetrics.p2pConf=t.p2pConfiguration);try{this.playerMetrics.live=t.externalLive?1:0,this.playerMetrics.sessionDuration=Math.floor(((new Date).getTime()-this.dateStartMetrics.getTime())/1e3),this.playerMetrics.category=this.category,this.playerMetrics.speedType=this.speedType;}catch(h){}this.playerMetrics.ciu=this.ciu;try{var l=function l(){var e=navigator.userAgent,e=e.match(/chrome|chromium|crios/i)?"chrome":e.match(/firefox|fxios/i)?"firefox":e.match(/safari/i)?"safari":e.match(/opr|opera/i)?"opera":e.match(/edg/i)?"edge":-1<e.indexOf("Trident")||-1<e.indexOf("MSIE")?"internet_explorer":"unknow";return e};this.playerMetrics.nav=l();}catch(h){}try{this.playerMetrics.ua=navigator.userAgent;}catch(h){}o=1===this.category?"phone":2===this.category?"tablet":"desktop",i=1===this.speedType?"wifi":"cellular",c=(r.setMainInfos(this.playerMetrics.v,i,o,this.playerMetrics.nav),0);try{c=0<n.factory.getInstance("PeerListService").getListByConnectedPeers().length?1:0;}catch(h){}1===c?(this.connectedCount+=1,this.connectedWithSomeoneOnce=1):this.notConnectedCount+=1,0<this.connectedCount+this.notConnectedCount&&(this.playerMetrics.cop=Math.round(this.notConnectedCount/(this.connectedCount+this.notConnectedCount)*100)),this.dateStartRebuf?(this.playerMetrics.isStalled=1,this.playerMetrics[o].isStalled=1,(this.playerMetrics[i].isStalled=1)===c&&(this.playerMetrics.connected.isStalled=1,this.playerMetrics.connected[o].isStalled=1,this.playerMetrics.connected[i].isStalled=1)):(this.playerMetrics.isStalled=0,this.playerMetrics[o].isStalled=0,this.playerMetrics[i].isStalled=0,1===c&&(this.playerMetrics.connected.isStalled=0,this.playerMetrics.connected[o].isStalled=0,this.playerMetrics.connected[i].isStalled=0)),0<this.playerMetrics.HTTPDownloadDuration.length&&(this.playerMetrics.mean_HTTP_download_duration=this.playerMetrics.HTTPDownloadDuration.reduce(function(e,t){return e+t},0)/this.playerMetrics.HTTPDownloadDuration.length),0<this.playerMetrics.P2PDownloadDuration.length&&(this.playerMetrics.mean_P2P_download_duration=this.playerMetrics.P2PDownloadDuration.reduce(function(e,t){return e+t},0)/this.playerMetrics.P2PDownloadDuration.length),this.playerMetrics.current_buffer=this.factory.getInstance("BufferService").getBufferLength(),1===c&&this.playerMetrics.connected.current_buffer,1===this.playerMetrics.nbrStalls&&(this.playerMetrics.n_rebuf_1=1,u)&&(this.playerMetrics.buf.n_rebuf_1=1),1<this.playerMetrics.nbrStalls&&this.playerMetrics.nbrStalls<5&&(this.playerMetrics.n_rebuf_2=1,u)&&(this.playerMetrics.buf.n_rebuf_2=1),5<=this.playerMetrics.nbrStalls&&(this.playerMetrics.n_rebuf_3=1,u)&&(this.playerMetrics.buf.n_rebuf_3=1);try{this.isHighSender()&&(this.playerMetrics.help.highR=this.factory.getInstance("PeerInfosStorage").sendableSegments);}catch(h){}try{var f=this.factory.getInstance("PeerInfosStorage").group;f&&""!=f&&"waiting..."!=f?(this.playerMetrics.groupID=f,this.playerMetrics.g=1):this.playerMetrics.g=0;}catch(h){}try{this.playerMetrics.s=this.factory.getInstance("PeerInfosStorage").segmentNumber;}catch(h){}try{this.playerMetrics.q=this.q;}catch(h){}try{this.playerMetrics.lastP=this.lastPeer;}catch(h){}try{this.playerMetrics.bg=document[this.hidden]?1:0;}catch(h){}try{this.playerMetrics.gTime=this.factory.getInstance("PeerInfosStorage").getTimeInGroup();}catch(h){}try{this.playerMetrics.age=this.getPeerAge();}catch(h){}try{this.playerMetrics.co_once=this.connectedWithSomeoneOnce,this.playerMetrics.co_sum=this.connectedCount,this.playerMetrics.co_no=this.notConnectedCount;}catch(h){}try{this.playerMetrics.dr=this.dataReceived.p2p,this.playerMetrics.ds=this.dataSent.p2p;}catch(h){}try{this.playerMetrics.co_max=this.maxConnectedWithMany,this.playerMetrics.co_many=this.connectedWithManyOnce;}catch(h){}try{this.playerMetrics.newco=this.newco,this.playerMetrics.newco_ok=this.newco_ok,this.playerMetrics.newco_to=this.newco_to,this.playerMetrics.newco_d=this.factory.getInstance("PeerConnection").computeCoTime();}catch(h){}try{this.playerMetrics.g_nbr=this.nbrGroups;}catch(h){}try{this.playerMetrics.ping_med=this.factory.getInstance("PeerListStorage").getMedianPing();}catch(h){}try{this.playerMetrics.ping_c=this.controllerPing;}catch(h){}try{this.playerMetrics.ice=this.ice;}catch(h){}try{this.playerMetrics.nbrPeerInGroup=this.nbrPeerInGroup;}catch(h){}try{this.playerMetrics.newg=this.newg,this.playerMetrics.newg_q=this.newg_q,this.playerMetrics.newg_co=this.newg_co,this.playerMetrics.newg_5=this.newg_5,this.playerMetrics.newg_p2p=this.newg_p2p,this.playerMetrics.newg_f=this.newg_f;}catch(h){}try{this.playerMetrics.latency=this.factory.getInstance("PlayerService").liveDelay();}catch(h){}this.playerMetrics.stream_type=this.stream_type,this.playerMetrics.protocol=this.protocol,this.playerMetrics.q_nbr=this.q_nbr,this.playerMetrics.seg_dur=this.seg_dur,this.playerMetrics.seg_nbr=this.seg_nbr,this.playerMetrics.seg_ext=this.seg_ext,this.playerMetrics.cover_ratio=this.cover_ratio,this.playerMetrics.cover_ratio_max=this.cover_ratio_max;try{this.playerMetrics.help&&this.playerMetrics.help.FR1&&this.playerMetrics.help.SendSeg&&0<this.playerMetrics.help.SendSeg&&(this.playerMetrics.help.FR2=Math.round(this.playerMetrics.help.FR1/(1.35*this.playerMetrics.help.SendSeg)*100));}catch(h){}if(document[this.hidden]&&"viewsurf"===a.toString()){if(null==this.dateHidden&&(this.dateHidden=new Date),6e4<(new Date).getTime()-this.dateHidden.getTime()){var d,o=this.factory.getInstance("P2P").factory,i=o.getInstance("Tracker"),c=(o.getInstance("PeerInfosStorage").resetP2P(),o.getInstance("PeerListStorage")),p=o.getInstance("PeerConnection"),y=c.getListKeys();for(d in y){var g=y[d];p.disconnect(g);}i.close();}}else {null!==this.dateHidden&&this.dateHidden;try{this.events.emit("quanteecAnalytics",{analytics:JSON.parse(JSON.stringify(e))});}catch(h){}r.sendData(),s.sendAnalytics(a.toString(),e),this.logs&&0<this.logs.length&&s.sendLogs(this.logs),n.sendSegmentNumber()||t.isFileMode||s.close(),this.playerMetrics.reset(),this.logs=[];}}}},{key:"reset",value:function(){this.rebufs=[];try{clearInterval(this.interval);}catch(e){}}},{key:"getIsInitialized",value:function(){return isInitialized}},{key:"getQualityByResolution",value:function(e){var t=e.height;return {name:2160<t?"8K":1440<t&&t<=2160?"4K":1080<t&&t<=1440?"2K":720<t&&t<=1080?"FullHD":480<t&&t<=720?"HD":"SD",height:t,width:e.width}}},{key:"manageManifestMetrics",value:function(e){var t=this.factory.getInstance("GeneralSettings");this.analyticsAddr=t.analyticsUrl,this.analyticsAddr!==undefined&&null!==this.analyticsAddr&&""!==this.analyticsAddr&&(this.playerMetrics.B_manifest+=e);}},{key:"manageMetrics",value:function(e){var t,r,n=this.factory.getInstance("GeneralSettings"),i=this.factory.getInstance("ManifestService").getManifest(),a=this.factory.getInstance("P2P"),o=e.inputRequest.mediaType,s=0,c=0,u=(this.analyticsAddr=n.analyticsUrl,[]),l=0,f=0,d=this.isAlwaysStalled();if(i&&i.playlists&&0<i.playlists.length)for(l=0;l<i.playlists.length;l++){var p=i.playlists[l];p&&p.attributes&&p.attributes.BANDWIDTH>c&&(s=l,c=p.attributes.BANDWIDTH),u.push(this.getQualityByResolution(p.attributes&&p.attributes.RESOLUTION?p.attributes.RESOLUTION:{width:1280,height:720}));}else u.push(this.getQualityByResolution({width:1280,height:720}));var y,g={peer:0,server:0,peer_ip:0,peer_city:0,peer_region:0,peer_country:0,mediaType:o};try{f=0<a.factory.getInstance("PeerListService").getListByConnectedPeers().length?1:0;}catch(S){}for(r=1===this.category?"phone":2===this.category?"tablet":"desktop",t=1===this.speedType?"wifi":"cellular",y=0;y<Object.keys(e.requests).length;y++){var h,m,b=void 0,v=void 0;"storage"!==e.requests[y].request.serverType&&("video"===o&&(null===this.lastQuality?this.lastQuality=e.inputRequest.quality:this.lastQuality!==e.inputRequest.quality&&(this.addQualityChange(),this.lastQuality=e.inputRequest.quality),this.q=e.inputRequest.quality||0),e.requests[y].request.server?(b=e.requests[y].result||e.requests[y].progress,this.playerMetrics.nReq+=1,this.playerMetrics.nReq_server+=1,d&&(this.playerMetrics.buf.nReq+=1,this.playerMetrics.buf.nReq_server+=1),this.playerMetrics.MB_server+=b.bytesLoaded/1e3,this.playerMetrics[t].MB_server+=b.bytesLoaded/1e3,this.playerMetrics[r].MB_server+=b.bytesLoaded/1e3,1===f&&(this.playerMetrics.connected.MB_server+=b.bytesLoaded/1e3,this.playerMetrics.connected[t].MB_server+=b.bytesLoaded/1e3,this.playerMetrics.connected[r].MB_server+=b.bytesLoaded/1e3),"video"===o&&0===y&&(this.playerMetrics.sec_server+=e.inputRequest.duration,this.playerMetrics[t].sec_server+=e.inputRequest.duration,this.playerMetrics[r].sec_server+=e.inputRequest.duration,1===f)&&(this.playerMetrics.connected.sec_server+=e.inputRequest.duration,this.playerMetrics.connected[t].sec_server+=e.inputRequest.duration,this.playerMetrics.connected[r].sec_server+=e.inputRequest.duration),g.server+=b.bytesLoaded/1e3,b.startDate&&b.endDate&&(h=b.endDate.getTime()-b.startDate.getTime(),this.playerMetrics.HTTPDownloadDuration.push(h))):e.requests[y].request.peer&&(this.playerMetrics.nReq+=1,this.playerMetrics.nReq_p2p+=1,d&&(this.playerMetrics.buf.nReq+=1,this.playerMetrics.buf.nReq_p2p+=1),b=e.requests[y].result||e.requests[y].progress,this.playerMetrics.MB_peer+=b.bytesLoaded/1e3,this.playerMetrics[t].MB_peer+=b.bytesLoaded/1e3,this.playerMetrics[r].MB_peer+=b.bytesLoaded/1e3,1===f&&(this.playerMetrics.connected.MB_peer+=b.bytesLoaded/1e3,this.playerMetrics.connected[t].MB_peer+=b.bytesLoaded/1e3,this.playerMetrics.connected[r].MB_peer+=b.bytesLoaded/1e3),this.factory.getInstance("PeerDataService").addDataReceivedToLink(e.requests[y].request.peer,b.bytesLoaded/1e3),h=this.factory.getInstance("P2P").factory.getInstance("PeerListStorage").getPeerFromList(e.requests[y].request.peer),this.lastPeer=e.requests[y].request.peer,1===h.ip?(this.playerMetrics.MB_peer_ip+=b.bytesLoaded/1e3,g.peer_ip+=b.bytesLoaded/1e3,1===f&&(this.playerMetrics.connected.MB_peer_ip+=b.bytesLoaded/1e3)):1===h.city?(this.playerMetrics.MB_peer_city+=b.bytesLoaded/1e3,g.peer_city+=b.bytesLoaded/1e3,1===f&&(this.playerMetrics.connected.MB_peer_city+=b.bytesLoaded/1e3)):1===h.region?(this.playerMetrics.MB_peer_region+=b.bytesLoaded/1e3,g.peer_region+=b.bytesLoaded/1e3,1===f&&(this.playerMetrics.connected.MB_peer_region+=b.bytesLoaded/1e3)):(this.playerMetrics.MB_peer_country+=b.bytesLoaded/1e3,g.peer_country+=b.bytesLoaded/1e3,1===f&&(this.playerMetrics.connected.MB_peer_country+=b.bytesLoaded/1e3)),"video"===o&&0===y&&(this.playerMetrics.sec_peer+=e.inputRequest.duration,this.playerMetrics[t].sec_peer+=e.inputRequest.duration,this.playerMetrics[r].sec_peer+=e.inputRequest.duration,1===f)&&(this.playerMetrics.connected.sec_peer+=e.inputRequest.duration,this.playerMetrics.connected[t].sec_peer+=e.inputRequest.duration,this.playerMetrics.connected[r].sec_peer+=e.inputRequest.duration),g.peer+=b.bytesLoaded/1e3,b.startDate)&&b.endDate&&(m=b.endDate.getTime()-b.startDate.getTime(),this.playerMetrics.P2PDownloadDuration.push(m)),"video"===o&&(v=u[e.requests[y].request.quality],this.playerMetrics.qualities[v.name]+=b.bytesLoaded/1e3,1===f&&(this.playerMetrics.connected.qualities[v.name]=this.playerMetrics.connected.qualities[v.name]||0,this.playerMetrics.connected.qualities[v.name]+=b.bytesLoaded/1e3),e.requests[y].request.quality!==this.playerMetrics.qualityNbr?this.playerMetrics.qChange=1:this.playerMetrics.qChange=0,this.playerMetrics.qualityNbr=e.requests[y].request.quality,e.requests[y].request.quality===s||v.height>=window.screen.height||n.lowLatency?(this.playerMetrics.bestQuality+=b.bytesLoaded/1e3,1===f&&(this.playerMetrics.connected.bestQuality+=b.bytesLoaded/1e3)):(this.playerMetrics.otherQualities+=b.bytesLoaded/1e3,1===f&&(this.playerMetrics.connected.otherQualities+=b.bytesLoaded/1e3)),b.bytesLoaded)&&e.inputRequest&&e.inputRequest.duration&&0===y&&(3<=Math.round(8*b.bytesLoaded/e.inputRequest.duration/1e6*100)/100?(this.playerMetrics.timeHQ+=e.inputRequest.duration,1===f&&(this.playerMetrics.connected.timeHQ+=e.inputRequest.duration)):(this.playerMetrics.timeLQ+=e.inputRequest.duration,1===f&&(this.playerMetrics.connected.timeLQ+=e.inputRequest.duration))),"audio"===o)&&(this.playerMetrics.qualities.audio+=b.bytesLoaded/1e3);}this.factory.getInstance("Events").emit("quanteecDataReceived",g),this.totalDataReceived(g);}},{key:"addHTTPError",value:function(e){[401,404,403,500].includes(e)?this.playerMetrics.HTTP_errors[e]=ee()(this.playerMetrics.HTTP_errors,e)?this.playerMetrics.HTTP_errors[e]+1:this.playerMetrics.HTTP_errors[e]=1:400<=e&&e<=499?this.playerMetrics.HTTP_errors["4xx"]=ee()(this.playerMetrics.HTTP_errors,"4xx")?this.playerMetrics.HTTP_errors["4xx"]+1:this.playerMetrics.HTTP_errors["4xx"]=1:500<=e&&e<=599&&(this.playerMetrics.HTTP_errors["5xx"]=ee()(this.playerMetrics.HTTP_errors,"5xx")?this.playerMetrics.HTTP_errors["5xx"]+1:this.playerMetrics.HTTP_errors["5xx"]=1);}},{key:"addAbandonP2P",value:function(e){this.playerMetrics.P2P_requests_abort++,this.playerMetrics.P2P_abort_reason[e]||(this.playerMetrics.P2P_abort_reason[e]=0),this.playerMetrics.P2P_abort_reason[e]+=1;}},{key:"addBufferFactor",value:function(e){this.playerMetrics.bufferFactor=e;var t=0;try{t=0<this.factory.getInstance("PeerListService").getListByConnectedPeers().length?1:0;}catch(i){}try{var r=1===this.category?"phone":2===this.category?"tablet":"desktop",n=1===this.speedType?"wifi":"cellular";this.playerMetrics[r].bufferFactor=e,this.playerMetrics[n].bufferFactor=e,1===t&&(this.playerMetrics.connected.bufferFactor=e,this.playerMetrics.connected[r].bufferFactor=e,this.playerMetrics.connected[n].bufferFactor=e);}catch(i){}}},{key:"addValue",value:function(e,t){this.playerMetrics[e]=t;}},{key:"addHelpMetrics",value:function(e){this.playerMetrics.help[e]||(this.playerMetrics.help[e]=0),this.playerMetrics.help[e]+=1;}},{key:"addHelpMetricsNbr",value:function(e,t){this.playerMetrics.help[e]||(this.playerMetrics.help[e]=t),this.playerMetrics.help[e]=t;}},{key:"addUniqMetric",value:function(e){this.playerMetrics[e]||(this.playerMetrics[e]=0),this.playerMetrics[e]=1;}},{key:"addQualityChange",value:function(){try{this.playerMetrics.nbrQualityChange+=1;var e=0;try{e=0<p2p.factory.getInstance("PeerListService").getListByConnectedPeers().length?1:0;}catch(n){}var t=1===this.category?"phone":2===this.category?"tablet":"desktop",r=1===this.speedType?"wifi":"cellular";this.playerMetrics[t].nbrQualityChange+=1,this.playerMetrics[r].nbrQualityChange+=1,1===e&&(this.playerMetrics.connected.nbrQualityChange+=1,this.playerMetrics.connected[t].nbrQualityChange+=1,this.playerMetrics.connected[r].nbrQualityChange+=1);}catch(n){}}},{key:"manageBufferStall",value:function(){this.dateStartRebuf=new Date,this.dateEndRebuf=undefined;var e=this.factory.getInstance("StorageCustomDecision"),t=(e.setData("rebufStarted",1),this.isAlwaysStalled());this.lastDateRebuf=new Date,this.nbRebuffs+=1;try{this.playerMetrics.nbrStalls+=1,t&&(this.playerMetrics.buf.nbrStalls+=1);var r=0;try{r=0<p2p.factory.getInstance("PeerListService").getListByConnectedPeers().length?1:0;}catch(l){}var n,i=1===this.category?"phone":2===this.category?"tablet":"desktop",a=1===this.speedType?"wifi":"cellular",o=(this.playerMetrics[i].nbrStalls+=1,this.playerMetrics[a].nbrStalls+=1,1===r&&(this.playerMetrics.connected.nbrStalls+=1,this.playerMetrics.connected[i].nbrStalls+=1,this.playerMetrics.connected[a].nbrStalls+=1),!1),s=this.factory.getInstance("DownloadController").currentRequestsProgress;for(n in s)for(var c in s[n].requests){var u=s[n].requests[c];"server"!==u.request.serverType&&"peer"===u.request.serverType&&(o=!0);}o?(this.playerMetrics.nbrStallsP2P+=1,t&&(this.playerMetrics.buf.nbrStallsP2P+=1),e.setData("rebufStartedP2P",1)):(e.setData("rebufStartedHTTP",1),this.playerMetrics.nbrStallsHTTP+=1,t&&(this.playerMetrics.buf.nbrStallsHTTP+=1));}catch(l){}}},{key:"manageBufferRestart",value:function(){this.dateEndRebuf=new Date;var e,t,r=this.isAlwaysStalled();this.lastDateRebuf=new Date,this.dateStartRebuf&&((e=600<(e=(this.dateEndRebuf.getTime()-this.dateStartRebuf.getTime())/1e3)?600:e)<.2&&(e=0,this.playerMetrics.sec_rebuf_1+=1,r)&&(this.playerMetrics.buf.sec_rebuf_1+=1),0<(e=e<0?0:e)&&e<=1&&(this.playerMetrics.sec_rebuf_2+=1,r)&&(this.playerMetrics.buf.sec_rebuf_2+=1),1<e&&(this.playerMetrics.sec_rebuf_3+=1,r)&&(this.playerMetrics.buf.sec_rebuf_3+=1),this.playerMetrics.sec_rebuf+=e,r&&this.playerMetrics.buf.sec_rebuf,this.dateStartRebuf=undefined,(t=this.factory.getInstance("StorageCustomDecision")).removeData("rebufStarted"),1==t.getData("rebufStartedP2P")?(this.playerMetrics.sec_rebuf_p2p+=e,r&&(this.playerMetrics.buf.sec_rebuf_p2p+=e),t.removeData("rebufStartedP2P")):1==t.getData("rebufStartedHTTP")&&(this.playerMetrics.sec_rebuf_http+=e,r&&(this.playerMetrics.buf.sec_rebuf_http+=e),t.removeData("rebufStartedHTTP")));}},{key:"resetBuffer",value:function(){this.dateStartRebuf=undefined,this.dateEndRebuf=undefined,this.playerMetrics.reset();}},{key:"p2pLastPeriod",value:function(){return this.p2pReceivedLastPeriod||this.p2pSentLastPeriod}},{key:"resetP2PLastPeriod",value:function(){var e=new Date;e.getTime()-this.p2pReceivedDate.getTime()>1e3*this.p2pSentReceivedThreshold&&(this.p2pReceivedLastPeriod=!1),e.getTime()-this.p2pSentDate.getTime()>1e3*this.p2pSentReceivedThreshold&&(this.p2pSentLastPeriod=!1);}},{key:"addDataSent",value:function(e){this.playerMetrics.data_sent=Math.round((e.ip+e.city+e.region+e.country)/1e3);}},{key:"totalDataReceived",value:function(e){this.dataReceived.ip+=1e3*e.peer_ip,this.dataReceived.city+=1e3*e.peer_city,this.dataReceived.region+=1e3*e.peer_region,this.dataReceived.country+=1e3*e.peer_country,this.dataReceived.http+=1e3*e.server,this.dataReceived.p2p+=1e3*e.peer_ip+1e3*e.peer_city+1e3*e.peer_region+1e3*e.peer_country,this.dataReceived.factor+=1e3*e.peer_ip*this.factor.ip+1e3*e.peer_city*this.factor.city+1e3*e.peer_region*this.factor.region+1e3*e.peer_country*this.factor.country;}},{key:"totalDataSent",value:function(e){this.dataSent.ip+=e.ip,this.dataSent.city+=e.city,this.dataSent.region+=e.region,this.dataSent.country+=e.country,this.dataSent.p2p+=e.ip+e.city+e.region+e.country,this.dataSent.factor+=e.ip*this.factor.ip+e.city*this.factor.city+e.region*this.factor.region+e.country*this.factor.country,0<e.ip+e.city+e.region+e.country&&(this.factory.getInstance("PeerInfosStorage").hasSentP2PData=!0);try{this.addDataSent(e);}catch(t){}}},{key:"getDataHttp",value:function(){return this.dataReceived.http}},{key:"getDataP2p",value:function(){return this.dataReceived.p2p}},{key:"getDataSent",value:function(){return this.dataSent.p2p}},{key:"isHighSender",value:function(){return 150<Math.round(this.dataSent.p2p/(this.dataReceived.p2p+this.dataReceived.http)*1e3)/10}},{key:"greenScore",value:function(){return Math.round((this.dataReceived.factor+this.dataSent.factor)/(this.dataReceived.p2p+this.dataReceived.http)*1e3)/10}},{key:"energySavedWh",value:function(){return 72e-9*(this.dataReceived.p2p+this.dataSent.p2p)/20+5.35e-8*(this.dataReceived.p2p+this.dataSent.p2p)-(5.35e-8*(this.dataReceived.country+this.dataSent.country)+2.43e-8*(this.dataReceived.region+this.dataSent.region)+4.3e-9*(this.dataReceived.city+this.dataSent.city))}},{key:"energySavedReceivedWh",value:function(){return 72e-9*this.dataReceived.p2p/20+5.35e-8*this.dataReceived.p2p-(5.35e-8*this.dataReceived.country+2.43e-8*this.dataReceived.region+4.3e-9*this.dataReceived.city)}},{key:"energySavedSentWh",value:function(){return 72e-9*this.dataSent.p2p/20+5.35e-8*this.dataSent.p2p-(5.35e-8*this.dataSent.country+2.43e-8*this.dataSent.region+4.3e-9*this.dataSent.city)}},{key:"energyInLight",value:function(){var e=this.energySavedWh();return Math.round(e/2.5*10)/10}},{key:"energyInCO2g",value:function(){var e=this.energySavedWh();return Math.round(.466*e*10)/10}},{key:"energyInWatercL",value:function(){var e=this.energySavedWh();return Math.round(.219*e*10)/10}},{key:"getPeerAge",value:function(){try{var e=new Date,t=Math.round((e.getTime()-this.startDateMetrics.getTime())/1e3);return t<0&&(t=0),t=isNaN(t)?0:t}catch(r){return 0}}},{key:"setLogs",value:function(e){this.logs.push(e);}}])}();function l(e){return (l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=l(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=l(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==l(e)?e:e+""}(n.key),n);}}var ye=function(){function o(e,t,r){var n=this;if(!(this instanceof o))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger"),this.events=this.factory.getInstance("Events"),this.peerID=t,this.datachannel=r,this.lowBufferedAmount=5e6,this.datachannel.bufferedAmountLowThreshold=this.lowBufferedAmount,this.queue=[];var i=this,a=(this.objectReport={bytesSent:0,ip:0,city:0,region:0,country:0},this.intervalReport=null,function a(){var e;0<i.objectReport.bytesSent&&(e={status:"metrics",clientOrServer:"server",peerID:i.peerID,startDate:new Date,endDate:new Date,bytesSent:i.objectReport.bytesSent,ip:i.objectReport.ip,city:i.objectReport.city,region:i.objectReport.region,country:i.objectReport.country},i.events.emit("fileRequestStatus",e),i.objectReport={bytesSent:0,ip:0,city:0,region:0,country:0});});this.sendQueueData=function(){for(;i.datachannel.bufferedAmount<=i.lowBufferedAmount&&0<i.queue.length;){var e=i.queue.shift().data;if(i.datachannel.send(e),"string"!=typeof e){try{1===e.byteLength&&n.log.debug("[Send1] Send size 1");}catch(r){}try{i.factory.getInstance("AnalyticsService").p2pSentLastPeriod=!0,i.factory.getInstance("AnalyticsService").p2pSentDate=new Date;}catch(r){}var t=i.factory.getInstance("PeerListStorage").getPeerFromList(i.peerID),e=e.byteLength||e.length;i.factory.getInstance("PeerDataService").addDataSentToLink(i.peerID,e),i.objectReport.bytesSent+=e,1===t.ip?i.objectReport.ip+=e:1===t.city?i.objectReport.city+=e:1===t.region?i.objectReport.region+=e:1===t.country&&(i.objectReport.country+=e);}}},this.datachannel.onbufferedamountlow=function(){i.sendQueueData();},this.intervalReport=setInterval(a,2e3);}return e=o,(t=[{key:"close",value:function(){this.datachannel.onbufferedamountlow=null,this.lowBufferedAmount=null,this.datachannel.bufferedAmountLowThreshold=null,this.queue=[],this.datachannel=null,clearInterval(this.intervalReport),this.objectReport={bytesSent:0,ip:0,city:0,region:0,country:0};}},{key:"sortByPriorityAndDate",value:function(e,t){return e.priority-t.priority||e.joinDate-t.joinDate}},{key:"send",value:function(e,t,r){if(this.datachannel.bufferedAmount<=this.lowBufferedAmount&&0===this.queue.length){if(this.datachannel.send(e),"string"!=typeof e){try{1===e.byteLength&&this.log.debug("[Send2] Send size 1");}catch(a){}var n=this.factory.getInstance("PeerListStorage").getPeerFromList(this.peerID),i=e.byteLength||e.length;this.factory.getInstance("PeerDataService").addDataSentToLink(this.peerID,i),this.objectReport.bytesSent+=i,1===n.ip?this.objectReport.ip+=i:1===n.city?this.objectReport.city+=i:1===n.region?this.objectReport.region+=i:1===n.country&&(this.objectReport.country+=i);try{this.factory.getInstance("AnalyticsService").p2pSentLastPeriod=!0,this.factory.getInstance("AnalyticsService").p2pSentDate=new Date;}catch(a){}}}else this.queue.push({data:e,joinDate:(new Date).getTime(),type:t||"control",priority:r||1}),this.datachannel.bufferedAmount<=this.lowBufferedAmount&&0<this.queue.length&&this.sendQueueData();}},{key:"removeDataFromQueue",value:function(e){for(var t=[],r=0;r<this.queue.length;r++)this.queue[r].type===e&&t.unshift(r);for(var n=0;n<t.length;n++)this.queue.splice(t[n],1);this.queue.sort(this.sortByPriorityAndDate);}}])&&pe(e.prototype,t),r&&pe(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r;}();function f(e){return (f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ge(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=f(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=f(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==f(e)?e:e+""}(n.key),n);}}var he=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger"),this.reset();}return e=t,(r=[{key:"reset",value:function(){this.uuid="",this.resetData();}},{key:"resetData",value:function(){this.group="",this.segmentNumber=0,this.audioSegmentNumber=0,this.joinDate="",this.upload=0,this.download=0,this.sendableSegments=0,this.lastUploads=[],this.groupTargetQuality=-1,this.hasNewSegmentPlaying=!1,this.hasNewSegmentNumber=!1,this.numberWithoutSegments=0,this.maxNumberWithoutSegment=6,this.maxNumberWithoutSegmentVOD=6,this.hasSentP2PData=!1,this.mustReaffectGroup=!1,this.hasBeenInGroup=!1,this.infoSent={audio:[],video:[]};}},{key:"resetP2P",value:function(){this.group="",this.joinDate="",this.lastUploads=[],this.groupTargetQuality=-1,this.hasNewSegmentPlaying=!1,this.hasNewSegmentNumber=!1,this.mustReaffectGroup=!1,this.hasBeenInGroup=!1,this.infoSent={audio:[],video:[]};}},{key:"disconnect",value:function(){this.uuid="",this.group="",this.joinDate="",this.listOrdered=[],this.groupTargetQuality=-1,this.mustReaffectGroup=!1;}},{key:"setUuid",value:function(e){this.uuid=e;}},{key:"getUuid",value:function(){return this.uuid}},{key:"setGroup",value:function(e){this.group=e;}},{key:"getGroup",value:function(){return this.group}},{key:"sendSegmentNumber",value:function(){try{this.hasNewSegmentNumber?(this.numberWithoutSegments=0,this.factory.getInstance("Tracker").sendInfos({segmentNumber:this.segmentNumber}),this.hasNewSegmentNumber=!1):this.numberWithoutSegments+=1;}catch(e){}return this.numberWithoutSegments>=this.maxNumberWithoutSegment&&this.factory.getInstance("ManifestService").live?(this.numberWithoutSegments=0,!1):!(this.numberWithoutSegments>=this.maxNumberWithoutSegmentVOD&&!this.factory.getInstance("ManifestService").live)||(this.numberWithoutSegments=0,this.hasSentP2PData?!(this.hasSentP2PData=!1):this.hasSentP2PData=!1)}},{key:"setSegmentNumber",value:function(e){try{e!==this.segmentNumber&&(this.hasNewSegmentNumber=!0);}catch(t){}this.segmentNumber=e;}},{key:"setAudioSegmentNumber",value:function(e){this.audioSegmentNumber=e;}},{key:"getSegmentNumber",value:function(){return this.segmentNumber}},{key:"getAudioSegmentNumber",value:function(){return this.audioSegmentNumber}},{key:"setJoinDate",value:function(e){this.joinDate=e;}},{key:"getJoinDate",value:function(){return this.joinDate}},{key:"setUpload",value:function(e){this.upload=e;}},{key:"getUpload",value:function(){return this.upload}},{key:"setDownload",value:function(e){this.download=e;}},{key:"getDownload",value:function(){return this.download}},{key:"getGroupTargetQuality",value:function(){return this.groupTargetQuality}},{key:"setGroupTargetQuality",value:function(e){this.groupTargetQuality=e;}},{key:"getLastUploads",value:function(){return this.lastUploads}},{key:"setLastUpload",value:function(e){this.lastUploads.push(e);}},{key:"deleteLastUploads",value:function(){this.lastUploads=[];}},{key:"setSendableSegments",value:function(e){this.sendableSegments=e;}},{key:"getSendableSegments",value:function(){return this.sendableSegments}},{key:"setMustReaffectGroup",value:function(e){this.mustReaffectGroup=e;}},{key:"setInfoSent",value:function(e,t,r,n,i,a){this.infoSent[e].unshift({segmentNumber:t,quality:r,r:n,buf:i,timestamp:a}),15<this.infoSent.length&&this.infoSent.pop();}},{key:"getInfoSent",value:function(e,t){return this.infoSent[e].find(function(e){return e.segmentNumber===t})}},{key:"getTimeInGroup",value:function(){if(!this.joinDate)return 0;try{var e=new Date,t=new Date(this.joinDate),r=Math.round((e.getTime()-t.getTime())/1e3);return r<0&&(r=0),r=isNaN(r)?0:r}catch(n){return 0}}}])&&ge(e.prototype,r),n&&ge(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function d(e){return (d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function me(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=d(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=d(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==d(e)?e:e+""}(n.key),n);}}var be=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");var l=function l(){window.mozRTCPeerConnection||navigator.mozGetUserMedia?(e="moz",t=navigator.userAgent.match(/Firefox/)&&parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10)):(window.webkitRTCPeerConnection||navigator.webkitGetUserMedia)&&(e="webkit",t=navigator.userAgent.match(/Chrom(e|ium)/)&&parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10));var e,t,r=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,n=window.mozRTCIceCandidate||window.RTCIceCandidate,i=window.mozRTCSessionDescription||window.RTCSessionDescription,a=window.webkitMediaStream||window.MediaStream,o="https:"===window.location.protocol&&("webkit"===e&&26<=t||"moz"===e&&33<=t),s=window.AudioContext||window.webkitAudioContext,c=document.createElement("video"),c=c&&c.canPlayType&&"probably"===c.canPlayType('video/webm; codecs="vp8", vorbis'),u=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia;return {prefix:e,browserVersion:t,support:Boolean(r)&&Boolean(u),supportRTCPeerConnection:Boolean(r),supportVp8:c,supportGetUserMedia:Boolean(u),supportDataChannel:Boolean(r&&r.prototype&&r.prototype.createDataChannel),supportWebAudio:Boolean(s&&s.prototype.createMediaStreamSource),supportMediaStream:Boolean(a&&a.prototype.removeTrack),supportScreenSharing:Boolean(o),AudioContext:s,PeerConnection:r,SessionDescription:i,IceCandidate:n,MediaStream:a,getUserMedia:u}};this.factory=e,this.log=this.factory.getInstance("MyLogger"),this.peerListStorage=this.factory.getInstance("PeerListStorage"),this.events=this.factory.getInstance("Events"),this.webrtcSupport=l(),this.connectionTimeoutValue=1e4,this.coTimeTable=[],this.configuration={iceServers:this.factory.getInstance("GeneralSettings").iceServers},this.options={},this.isFirstInGroup=!1,this.areLocalIPsRetrieved=!0,this.localIPsRetrieved=[];}return e=t,(r=[{key:"computeLocalIPs",value:function(){var a=this;return a.areLocalIPsRetrieved=!1,new Promise(function(r){var n=new RTCPeerConnection({iceServers:[]}),i=n.createDataChannel("P2P",{ordered:!1,reliable:!1});setTimeout(function(){!1===a.areLocalIPsRetrieved&&(a.timeoutEnded=!0,a.areLocalIPsRetrieved=!0,r(a.localIPsRetrieved));},5e3),a.localIPsRetrieved=[],n.onicecandidate=function(e){var t;e&&e.candidate&&"host"===(t={component_id:(t=e.candidate.candidate.split(" "))[1],transport:t[2],priority:t[3],address:t[4],port:t[5],type:t[7]}).type&&(/((^\s*((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))\s*$)|(^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$))/g.test(t.address)?(a.factory.getInstance("PeerDataService").setIP(t.address),a.localIPsRetrieved.push(t.address)):-1<t.address.indexOf(".local")?(a.factory.getInstance("PeerDataService").setIP("mDNS"),a.log.error('The parameter "useSubnets" was set to true in the configuration, but mDNS seems to be activated in this browser.')):a.log.error(t.address)),e&&null===e.candidate&&(i.close(),n.close(),n=i=null,a.areLocalIPsRetrieved=!0,r(a.localIPsRetrieved));},n.createOffer().then(function(e){n.setLocalDescription(e).then(function(e){})["catch"](function(e){});});})}},{key:"modifyBandwidthInSDP",value:function(e,t){for(var r=e.split("\n"),n=-1,i=0;i<r.length;i++)if(0===r[i].indexOf("m=")){n=i;break}if(-1===n)return e;for(n++;0===r[n].indexOf("i=")||0===r[n].indexOf("c=");)n++;return (0===r[n].indexOf("b")?(r[n]="b=AS:"+t,r):((e=r.slice(0,n)).push("b=AS:"+t),e=e.concat(r.slice(n,r.length)))).join("\n")}},{key:"getLocalIPs",value:function(){var r=this;return new Promise(function(e){var t=function(){r.areLocalIPsRetrieved?e(r.localIPsRetrieved):setTimeout(t,200);};t();})}},{key:"updateBandwidthRestriction",value:function(e,t){var r="AS";return "firefox"===adapter.browserDetails.browser&&(t=1e3*(t>>>0),r="TIAS"),e=-1===e.indexOf("b="+r+":")?e.replace(/c=IN (.*)\r\n/,"c=IN $1\r\nb="+r+":"+t+"\r\n"):e.replace(new RegExp("b="+r+":.*\r\n"),"b="+r+":"+t+"\r\n")}},{key:"removeBandwidthRestriction",value:function(e){return e.replace(/b=AS:.*\r\n/,"").replace(/b=TIAS:.*\r\n/,"")}},{key:"testAvailability",value:function(){var e=!1;return {global:e=this.webrtcSupport.supportDataChannel&&this.webrtcSupport.supportRTCPeerConnection?!0:e,RTCPeerConnection:this.webrtcSupport.supportRTCPeerConnection,DataChannel:this.webrtcSupport.supportDataChannel}}},{key:"timeoutConnection",value:function(e){var t,r,n,i,a,o,s=this.peerListStorage.getPeerFromList(e),c=this;if(s&&s.connection&&s.connection.localConnection&&"connected"!==s.connection.localConnection.iceConnectionState&&"completed"!==s.connection.localConnection.iceConnectionState){this.log.debug("DISCONNECT",s.connection.localConnection.iceConnectionState,s.connection.localConnection.connectionState,s.connection.localConnection),this.log.debug("[PeerConnection] Disconnect because of timeout",e),this.factory.getInstance("PeerDataService").addFailedLinks(e,"timeout"),this.factory.getInstance("AnalyticsService").newco_to+=1;try{s.connection.isOffer&&0===s.connection.retry&&(t=s.connection.remotePeerID,r=s.connection.joinDate,n=s.connection.sameIP,i=s.connection.sameCountry,a=s.connection.sameRegion,o=s.connection.sameCity,setTimeout(function(){c.connect(t,r,n,i,a,o,1);},1500));}catch(u){}this.disconnect(e);}}},{key:"createConnection",value:function(e,n,t,r,i,a,o,s,c){var u,l,f,d,p=this,y=this,g=y.factory.getInstance("Tracker");y.factory.getInstance("BlackListPeerStorage").hasInBlacklist(n)?y.log.debug("[PeerConnection] Connection requested to an unreliable peer. Request ignored: "+n):(y.factory.getInstance("AnalyticsService").newco+=1,e?(y.log.debug("[PeerConnection] Initiate connection with peer "+n),u=(l=new RTCPeerConnection(y.configuration,y.options)).createDataChannel("P2P",{ordered:!0,reliable:!0}),y.peerListStorage.addOrUpdateInList(n,{connection:{localConnection:l,dataChannel:u,isDeleted:!1,isOpennedOnce:!1,retry:c?1:0,dateStart:new Date,isOffer:e,remotePeerID:n,joinDate:t,sameIP:r,sameCountry:i,sameRegion:a,sameCity:o},uuid:n,joinDate:t,ip:r,country:i,region:a,city:o}),y.manageDataChannel(n)):(y.log.debug("[PeerConnection] Received connection with peer "+n),l=new RTCPeerConnection(y.configuration,y.options),y.peerListStorage.addOrUpdateInList(n,{connection:{localConnection:l,isDeleted:!1,isOpennedOnce:!1,retry:0,dateStart:new Date,isOffer:e},uuid:n,ip:r,country:i,region:a,city:o,joinDate:t}),y.peerListStorage.getPeerFromList(n).connection.localConnection.ondatachannel=function(e){var t,r;y.log.trace("[PeerConnection]ondatachannel event",n,e),e.channel?(t=e.channel,(r=y.peerListStorage.getPeerFromList(n))&&r.connection?(r.connection.dataChannel=t,y.events.emit("peerConnectedRefreshed",[{modification:"add",uuid:n}]),y.manageDataChannel(n)):(y.log.debug("[PeerConnection] Disconnect because no connection",n),y.disconnect(n))):y.log.error("ondatachannel:",e);},(0===y.peerListStorage.getList().length||1===y.peerListStorage.getList().length&&null!==f)&&(y.isFirstInGroup=!0)),(f=y.peerListStorage.getPeerFromList(n)).connection.localConnection.onicecandidate=function(e){e.candidate&&(y.log.trace("[Ice] candidate sent"),y.factory.getInstance("AnalyticsService").ice+=1,g.transfer({remotePeerID:n,candidate:e.candidate}));},f.connection.localConnection.oniceconnectionstatechange=function(){try{if(-1<["disconnected","closed"].indexOf(f.connection.localConnection.iceConnectionState)&&(y.log.debug("[PeerConnection] Disconnect because iceconnectionstate",f.connection.localConnection.iceConnectionState,n),y.disconnect(n)),"failed"===f.connection.localConnection.iceConnectionState){y.log.trace("Failed offer");try{y.factory.getInstance("AnalyticsService").addUniqMetric("icef");}catch(e){}f.connection.localConnection.restartIce();}}catch(e){}},f.connection.localConnection.onclose=function(){},e?(d=function d(e){f.connection.localConnection.setLocalDescription(e).then(function(){y.factory.getInstance("VariableSettings").limitBandwidth&&(e.sdp=y.modifyBandwidthInSDP(e.sdp,y.factory.getInstance("VariableSettings").limitBandwidth)),g.transfer({remotePeerID:n,description:e,sameIP:r,sameCountry:i,sameRegion:a,sameCity:o,joinDate:t});})["catch"](function(e){y.log.error("[PeerConnection] Error calling setLocalDescription for offering peer. Remote peer:",n,"Error:",e);});},f.connection.localConnection.onnegotiationneeded=function(){f.connection&&f.connection.timeout&&clearTimeout(f.connection.timeout),f.connection.timeout=setTimeout(p.timeoutConnection.bind(y),p.connectionTimeoutValue,n),y.log.trace("[PeerConnection] createOffer onnegotiationneeded",n),f.connection.localConnection.createOffer().then(d)["catch"](function(e){y.log.error("[PeerConnection] Error calling createOffer for offering peer. Remote peer:",n);});}):(f.connection.localConnection.setRemoteDescription(s).then(function(){y.log.trace("[PeerConnection] createAnswer",n),f.connection.localConnection.createAnswer().then(function(e){y.factory.getInstance("VariableSettings").limitBandwidth&&(e.sdp=y.modifyBandwidthInSDP(e.sdp,y.factory.getInstance("VariableSettings").limitBandwidth)),f.connection.localConnection.setLocalDescription(e).then(function(){g.transfer({remotePeerID:n,description:e});})["catch"](function(e){y.log.error("[PeerConnection] Error calling setLocalDescription for answering peer. Remote peer:",n,"Error:",e);});})["catch"](function(e){y.log.error("[PeerConnection] Error calling createAnswer for answering peer. Remote peer:",n,"Error:",e);});})["catch"](function(e){y.log.error("[PeerConnection] Error calling setRemoteDescription for answering peer. Remote peer:",n,"Error:",e);}),f.connection&&f.connection.timeout&&clearTimeout(f.connection.timeout),f.connection.timeout=setTimeout(this.timeoutConnection.bind(y),this.connectionTimeoutValue,n)));}},{key:"connect",value:function(e,t,r,n,i,a,o){var s=this.peerListStorage.getPeerFromList(e);null!==s&&s.hasOwnProperty("connection")||this.createConnection(!0,e,t,r,n,i,a,undefined,o);}},{key:"transferReceived",value:function(t){var r=this,e=r.peerListStorage.getPeerFromList(t.askingPeerID);null!==e&&e.hasOwnProperty("connection")?(t.description&&e.connection.localConnection&&"answer"===t.description.type&&e.connection.localConnection.setRemoteDescription(t.description)["catch"](function(e){r.log.error("[PeerConnection] Error calling setRemoteDescription for offering peer, received by signalling. Remote peer:",t.askingPeerID,"Error:",e);}),t.candidate&&(r.log.trace("[Ice] candidate received"),e.connection.localConnection.addIceCandidate(t.candidate)["catch"](function(e){r.log.error("[PeerConnection] Error calling addIceCandidate. Remote peer:",t.askingPeerID,"Error:",e);})),t.status&&"disconnected"===t.status&&this.closeChannel(t.askingPeerID)):t.description&&"answer"!==t.description.type&&r.createConnection(!1,t.askingPeerID,t.joinDate,t.sameIP,t.sameCountry,t.sameRegion,t.sameCity,t.description);}},{key:"manageDataChannel",value:function(r){var n=this,t=this,i=this.factory.getInstance("GeneralSettings"),a=this.factory.getInstance("VariableSettings"),o=(this.factory.getInstance("PeerListStorage"),this.factory.getInstance("PeerInfosStorage")),s=this.factory.getInstance("PeerListStorage").getPeerFromList(r),c=this.factory.getInstance("Message");s.connection.queue=new ye(this.factory,r,s.connection.dataChannel),s.connection.dataChannel.binaryType="arraybuffer",s.connection.dataChannel.onmessage=function(e){try{e.data&&n.factory.getInstance("Message").receiveMessage(r,e.data);}catch(t){}},s.connection.dataChannel.onopen=function(){t.isFirstInGroup=!1,s.connection.isOpennedOnce=!0;var e;t.factory.getInstance("VideoStorage");t.events.emit("peerConnectedRefreshed",[{modification:"add",uuid:r}]),t.factory.getInstance("PeerDataService").addLink(r,1===s.ip,!1,1===s.city,1===s.region,1===s.country),t.factory.getInstance("AnalyticsService").newco_ok+=1,s.connection.dateStart&&(e=(new Date).getTime()-s.connection.dateStart.getTime(),t.coTimeTable.push(e),n.clearCoTime()),c.sendMessage(r,{type:"ping"}),i&&i.lowLatency&&"strict_seeding"===i.lowLatencyMode&&i.seed&&c.sendMessage(r,{type:"sol",s:1}),a.useKnowledge&&(e={type:"segs",list:o.infoSent},c.sendMessage(r,e));},s.connection.dataChannel.onclose=function(e){t.log.trace("[PeerConnection] Disconnect because datachannel closed",r),t.log.debug("[PeerConnection] Datachannel closed",e),t.disconnect(r);},s.connection.dataChannel.onclosing=function(e){t.log.trace("[PeerConnection] Datachannel closing",r);},s.connection.dataChannel.onerror=function(e){t.log.trace("[PeerConnection] Disconnect because datachannel error",r),t.log.debug("[PeerConnection] Datachannel error",e),t.disconnect(r);};}},{key:"closeChannel",value:function(e){var t=this.peerListStorage.getPeerFromList(e);null!==t&&t.hasOwnProperty("connection")?t.connection.dataChannel&&"closed"!==t.connection.dataChannel.readyState&&"closing"!==t.connection.dataChannel.readyState?t.connection.dataChannel.close():(this.log.debug("[PeerConnection] Disconnect in function close channel",e),this.disconnect(e),this.factory.getInstance("PeerDataService").addFailedLinks(e,"close channel")):(this.log.debug("[PeerConnection] Disconnect in function close channel peer unknown",e),this.disconnect(e));}},{key:"clearCoTime",value:function(){10<this.coTimeTable.length&&this.coTimeTable.splice(0,1);}},{key:"computeCoTime",value:function(){return 0<this.coTimeTable.length?Math.round(this.coTimeTable.reduce(function(e,t){return e+t})/this.coTimeTable.length):-1}},{key:"disconnect",value:function(e){this.log.debug("DISCONNECT");var t=this.peerListStorage.getPeerFromList(e);if(null!==t&&t.hasOwnProperty("connection"))try{var r=this.factory.getInstance("Tracker"),n=this.factory.getInstance("FileRequestStorage"),i=this.factory.getInstance("PeerSelectionService"),a=this.factory.getInstance("AbonnementService"),o=n.getCurrentRequestsForPeer("server",e),s=n.getCurrentRequestsForPeer("client",e);this.factory.getInstance("PeerInfosStorage");if(this.factory.getInstance("PeerDataService").removeLink(e),null!==o&&0<o.length)for(var c=0;c<o.length;c++){var u=o[c];this.events.emit("fileRequestStatus",{status:"stopped",statusDetail:"cancelled",clientOrServer:"server",requestID:u.requestID,peerID:e,startDate:u.startDate,endDate:(new Date).getTime(),bytesSent:u.bytesSent}),n.removeRequest("server",e,u.requestID);}if(null!==s&&0<s.length)for(var l=0;l<s.length;l++){var f=s[l];this.events.emitNow("fileRequestStatus",{status:"stopped",statusDetail:"cancelled",clientOrServer:"client",reason:"disco",requestID:f.requestID,peerID:e,startDate:f.startDate,endDate:(new Date).getTime(),bytesReceived:f.bytesReceived}),n.removeRequest("client",e,f.requestID);}try{t.connection.queue&&(t.connection.queue.close(),delete t.connection.queue);}catch(d){}try{t.connection.dataChannel&&(t.connection.dataChannel.close(),t.connection.dataChannel.onmessage=null,t.connection.dataChannel.onopen=null,t.connection.dataChannel.onclose=null,t.connection.dataChannel.onerror=null,t.connection.dataChannel=null);}catch(d){this.log.error(d);}try{t.connection.localConnection&&(t.connection.localConnection.close(),t.connection.localConnection.onicecandidate=null,t.connection.localConnection.oniceconnectionstatechange=null,t.connection.localConnection.onconnectionstatechange=null,t.connection.localConnection.ondatachannel=null,t.connection.localConnection.onnegotiationneeded=null,t.connection.localConnection.onclose=null,t.connection.localConnection=null);}catch(d){this.log.error(d);}try{t.connection.timeout&&clearTimeout(t.connection.timeout);}catch(d){}try{this.peerListStorage.removePeerAttribute(e,"connection");}catch(d){}try{i.removePeerFromRequests(e);}catch(d){}try{a.removeAllAbonnements(e);}catch(d){}try{this.peerListStorage.removePeerFromList(e,"connection");}catch(d){}this.log.debug("Peer ".concat(e," disconnected"),this.peerListStorage.getPeerFromList(e)),r.transfer({remotePeerID:e,status:"disconnected"});try{r.clearCrypto(e);}catch(d){}this.events.emit("peerConnectedRefreshed",[{modification:"delete",uuid:e}]);}catch(p){this.log.error("Can not disconnect peer",e,p);}}}])&&me(e.prototype,r),n&&me(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function p(e){return (p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ve(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=p(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=p(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==p(e)?e:e+""}(n.key),n);}}var Se=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger"),this.peerList=[];}return e=t,(r=[{key:"reset",value:function(){this.peerList=[];}},{key:"getPeersFromList",value:function(e){for(var r,n=this,i=[],a=function a(){var t=e[o];(r=n.peerList.find(function(e){return e.key===t}))!==undefined&&i.push(r.value);},o=0;o<e.length;o++)a();return i}},{key:"getAvailableSegment",value:function(e,t,r,n){for(var i=[],a=this.factory.getInstance("PeerListService"),o=this.factory.getInstance("VariableSettings"),s=0;s<this.peerList.length;s++){var c,u=this.peerList[s];u&&u.value&&u.value.currentSegment&&u.value.currentSegment[e]&&0<u.value.currentSegment[e].length&&(c=u.value.currentSegment[e].find(function(e){return e.segmentNumber===t&&(null===r||e.quality===r)}))&&i.push({peerID:u.key,r:o.useComputedR?a.getAppropriateResource(u.key,c.r):c.r,ip:u.value.ip,buf:c.buf,timestamp:c.timestamp});}return i.sort(function(e,t){return t.r-e.r}),i}},{key:"getMedianPing",value:function(){for(var e=-1,t=[],r=0;r<this.peerList.length;r++){var n=this.peerList[r];n&&n.value&&n.value.ping&&t.push(n.value.ping);}return e=0<t.length&&(t.sort(),!(e=t[Math.round((t.length-1)/2)])||e<0||isNaN(e))?-1:e}},{key:"getPeerFromList",value:function(t){var e=this.peerList.find(function(e){return e.key===t});return e!==undefined?e.value:null}},{key:"addOrUpdateInList",value:function(t,e){var r=this.peerList.find(function(e){return e.key===t});return r===undefined&&"object"===p(e)?(this.peerList.push(r={key:t,value:e}),this.log.debug("[PeerListStorage] Add peer "+t),r):r!==undefined&&"object"===p(e)?(Object.assign(r.value,e),this.log.debug("[PeerListStorage] Update peer "+t),r):null}},{key:"removePeerFromList",value:function(t){var e=this.peerList.findIndex(function(e){return e.key===t});return -1!==e?(this.peerList.splice(e,1),this.log.debug("[PeerListStorage] Remove peer "+t),"OK"):null}},{key:"removePeerAttribute",value:function(t,e){var r=this.peerList.find(function(e){return e.key===t});return r!==undefined?(delete r.value[e],r):null}},{key:"updatePeerFromList",value:function(t,e){var r=this.peerList.find(function(e){return e.key===t});return r!==undefined&&"object"===p(e)?(Object.assign(r.value,e),r):null}},{key:"getList",value:function(){return this.peerList}},{key:"getListKeys",value:function(){return this.peerList.map(function(e){return e.key})}},{key:"getListKeysConnected",value:function(){return this.peerList.filter(function(e){return e.value&&e.value.connection&&e.value.connection.dataChannel&&"open"===e.value.connection.dataChannel.readyState}).map(function(e){return e.key})}},{key:"getListPeerInfos",value:function(){for(var e={},t=0;t<this.peerList.length;t++){var r,n=this.peerList[t];for(r in e[n.key]={},n.value)"connection"!==r?e[n.key][r]=n.value[r]:n.value[r].dataChannel&&"open"===n.value[r].dataChannel.readyState&&(e[n.key].connected=!0);}return e}},{key:"getLastInfosList",value:function(){for(var e=[],t=new Date,r=0;r<this.peerList.length;r++){var n=this.peerList[r];n.value&&n.value.last&&n.value.last.date&&t.getTime()-new Date(n.value.last.date).getTime()<18e4&&e.push({key:n.key,last:n.value.last});}return e}}])&&ve(e.prototype,r),n&&ve(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function y(e){return (y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function we(e){return function(e){if(Array.isArray(e))return Pe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Ie(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ie(e,t){var r;if(e)return "string"==typeof e?Pe(e,t):"Map"===(r="Object"===(r={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pe(e,t):void 0}function Pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function De(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=y(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=y(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==y(e)?e:e+""}(n.key),n);}}var Te=e(3),Re=function(){function m(e){if(!(this instanceof m))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger"),this.events=this.factory.getInstance("Events"),this.peerList=this.factory.getInstance("PeerListStorage"),this.chunkSize=15900,this.segmentNumberDiffConsideredValid=1,this.listOfReasons=["before","after","just before","other","quality","loop","invalid"],this.callbacks={};}return e=m,(t=[{key:"sendMessage",value:function(e,t,r){var n,i=this.peerList.getPeerFromList(e),a=this.factory.getInstance("FileRequestStorage"),o=this.factory.getInstance("GeneralSettings"),s=this.factory.getInstance("AnalyticsService"),c=null,u=null,l="control",f=1,d=Te();if(null!==i)try{if("string"==typeof t)n={type:"string",message:t},n=JSON.stringify(n);else if(t instanceof ArrayBuffer)n=t,l="data",f=2;else {if("fileRequest"===t.type){var p=a.getCurrentRequestForPeer("client",e,t.mediaType);if(null!==p)return this.log.debug("[DL] A request already exists for this segment with the same mediaType "+p.requestID),u={peerID:e,success:!1,error:"Request already exists",request:p,requestID:p.requestID};t.requestID=d,u={peerID:e,success:!0,error:null,requestID:t.requestID},(c=a.initRequest("client",e,t.requestID)).meshID="",c.videoID=t.videoID,c.segmentNumber=t.segmentNumber,c.quality=t.quality,c.mediaType=t.mediaType,c.storageUrl=t.storageUrl,c.bytesReceived=0,c.expectedSize=0,c.segmentSize=0,c.range=t.range,c.nextChunk=0,c.startDate=(new Date).getTime(),c.endDate=null,c.chunks=[],c.chunks.push({index:0,startDate:(new Date).getTime(),endDate:null,data:null,status:"waiting"}),r&&(c.callback=r),o.checkUrls||delete t.storageUrl,this.events.emit("fileRequestStatus",{status:"starting",clientOrServer:"client",requestID:m.requestID,peerID:e,startDate:c.startDate,endDate:null,bytesReceived:c.bytesReceived,expectedSize:c.expectedSize});}else if(-1<["aboRequest","cancelAbo","p2pOrg"].indexOf(t.type))u={peerID:e,success:!0,error:null,requestID:d},r&&(this.callbacks[d]=r),t.requestID=d;else if("ping"===t.type)this.factory.getInstance("PeerListStorage").getPeerFromList(e).pingDate=new Date;else if("fileAvailability"===t.type){u={peerID:e,success:!0,error:null,requestID:d},r&&(this.callbacks[d]=r),t.requestID=d;var y=this.factory.getInstance("AbonnementService");t.r=y.getAvailableResources();}else if("fileRequestStop"===t.type){if(null===(c=a.getRequest("client",e,t.requestID)))return u={peerID:e,success:!1,error:"Request does not exist",requestID:t.requestID};this.events.emit("fileRequestStatus",{status:"stopped",statusDetail:"cancelledByLocalPeer",clientOrServer:"client",requestID:t.requestID,peerID:e,startDate:c.startDate,endDate:(new Date).getTime(),bytesReceived:c.bytesReceived,expectedSize:c.expectedSize}),this.log.debug("[DL] Stopping the request",t.requestID),a.removeRequest("client",e,t.requestID);}n=JSON.stringify(t);}if(i&&i.connection&&i.connection.dataChannel&&"open"===i.connection.dataChannel.readyState&&i.connection.queue)i.connection.queue.send(n,l,f);else {u={peerID:e,success:!1,error:"Not ready",requestID:t.requestID},this.callbacks[d]&&delete this.callbacks[d],this.log.debug("Error sending message to peer",e,i,n);try{s.addHelpMetrics("sco");}catch(g){}}}catch(h){this.callbacks[d]&&delete this.callbacks[d],u={peerID:e,success:!1,error:h,requestID:d},this.log.error(h);}return u}},{key:"receiveMessage",value:function(e,t){var r,C,n=this.factory.getInstance("FileRequestStorage"),i=this.factory.getInstance("VideoStorage"),_=this.factory.getInstance("PeerListStorage"),a=this.factory.getInstance("PeerListStorage").getPeerFromList(e),o=this.factory.getInstance("PeerInfosStorage"),s=this.factory.getInstance("VariableSettings"),c=this.factory.getInstance("AbonnementService"),u=this.factory.getInstance("AnalyticsService"),l=null,f=null,U=null,d=null,p=null;try{if(a.lastMessageDate=new Date,"string"==typeof t)if("mi"===(r=JSON.parse(t)).type)try{var y=n.getRequest("client",e,r.ri),g=r.mi.split("|"),j=(y&&(y.depth=g.length),g.indexOf(o.getUuid().split("-")[0]));if(j!==g.length-1&&-1<j)this.events.emitNow("fileRequestStatus",{status:"stopped",statusDetail:"cancelled",clientOrServer:"client",reason:"loop",after:0,before:0,requestID:r.ri,peerID:e,startDate:y.startDate,endDate:(new Date).getTime(),bytesReceived:0,expectedSize:0}),this.sendMessage(e,{type:"fileRequestStop",requestID:r.ri}),n.removeRequest("client",e,r.ri),this.log.debug("[DL] Loop detected (from ".concat(e," to me ").concat(o.getUuid()," mesh ").concat(r.mi," segment ").concat(y.segmentNumber," ").concat(y.mediaType,")"));else {y.meshID=r.mi;var h,m=n.getRequestsForSegment("server",y.videoID,y.segmentNumber,y.mediaType);for(h in m)this.sendMessage(m[h].peerID,{type:"mi",ri:m[h].requestID,mi:y.meshID+"|"+m[h].peerID.split("-")[0]});this.log.debug("[Loop] Mesh client received:",y.meshID,y.mediaType,y.segmentNumber);}}catch(O){}else if("ping"===r.type)this.sendMessage(e,{type:"pong"});else if("pong"===r.type)a.pingDate&&(a.ping=(new Date).getTime()-a.pingDate.getTime(),this.log.debug("Ping peer",e,a.ping+"ms"),this.factory.getInstance("PeerDataService").addPingToLink(e,a.ping));else if("sol"===r.type)1===r.s&&(a.seed=!0);else if("lasts"===r.type)try{for(var B=r.list,b=0;b<B.length;b++)_.updatePeerFromList(B[b].key,{last:B[b].last});}catch(O){}else if("segs"===r.type){a.currentSegment=a.currentSegment||{video:[],audio:[]};var F,H=["video","audio"];for(F in H){var G,v=H[F];if(1===a.ip)for(var S=0;S<r.list[v].length;S++)r.list[v][S].r=r.list[v][S].r*s.ipRFactor;for((G=a.currentSegment[v]).unshift.apply(G,we(r.list[v]));15<a.currentSegment[v].length;)a.currentSegment[v].pop();}}else if("seg"===r.type)1===a.ip&&(r.r=r.r*s.ipRFactor),a.currentSegment=a.currentSegment||{video:[],audio:[]},a.currentSegment[r.mt].unshift({segmentNumber:r.sn,quality:r.q,r:r.r,buf:r.buf,timestamp:r.ts}),15<a.currentSegment[r.mt].length&&a.currentSegment[r.mt].pop();else if("p2pOrg"===r.type){var w={type:"p2pOrgRes",requestID:r.requestID,pos:-1,st:-1,ste:-1,buf:-1,r:c.getAvailableResources()};r.segmentNumber>o.getSegmentNumber()&&(w.pos=0),r.segmentNumber===o.getSegmentNumber()&&(w.pos=1),r.segmentNumber<o.getSegmentNumber()&&(r.segmentNumber<o.getSegmentNumber()-2?w.pos=3:w.pos=2,w.st=i.getFirstAfter(r.mediaType,r.videoID,r.segmentNumber)-r.segmentNumber,w.ste=i.getFirstAfter(r.mediaType,r.videoID,r.segmentNumber)),"video"===r.mediaType?w.buf=this.factory.getInstance("BufferService").getBufferLength():"audio"===r.mediaType&&(w.buf=this.factory.getInstance("BufferService").getAudioBufferLength()),this.sendMessage(e,w);}else if("fileAvailability"===r.type){var I=this.factory.getInstance("GeneralSettings"),P={type:"fileAvailabilityResponse",requestID:r.requestID,sr:0,qa:-1,pos:-1,st:-1,ste:-1,buf:-1,r:c.getAvailableResources()};if(I.shouldSend()){var D=this.factory.getInstance("StorageCustomDecision"),V=D.getData("segmentNumber1"+r.mediaType),z=D.getData("segmentNumber2"+r.mediaType),T=D.getData("lastSelectedPeer"+r.mediaType);if("video"===r.mediaType?(r.segmentNumber>o.getSegmentNumber()&&(P.pos=0),r.segmentNumber===o.getSegmentNumber()&&(P.pos=1),r.segmentNumber<o.getSegmentNumber()&&(r.segmentNumber<o.getSegmentNumber()-2?P.pos=3:P.pos=2,P.st=i.getFirstAfter(r.mediaType,r.videoID,r.segmentNumber)-r.segmentNumber,P.ste=i.getFirstAfter(r.mediaType,r.videoID,r.segmentNumber))):"audio"===r.mediaType&&(r.segmentNumber>o.getAudioSegmentNumber()&&(P.pos=0),r.segmentNumber===o.getAudioSegmentNumber()&&(P.pos=1),r.segmentNumber<o.getAudioSegmentNumber())&&(r.segmentNumber<o.getAudioSegmentNumber()-2?P.pos=3:P.pos=2),(0===P.pos&&r.segmentNumber===z&&T!==e||0===P.pos&&T!==e&&r.segmentNumber===V&&0<e.localeCompare(o.getUuid()))&&(P.pos=1,P.sr=2),r.latency){var R=this.factory.getInstance("PlayerService").liveDelay(),K=r.latency,X=R-K,Q=r.mediaType,W=D.getData(Q+"_quality"),Y=null==W||W===r.quality;T!==e&&R&&!isNaN(R)&&Y?400<Math.abs(X)?P.pos=X<0?2:0:P.pos=0<e.localeCompare(o.getUuid())?1:0:P.pos=0;try{this.log.trace("peerID: ".concat(e," lastSelected: ").concat(T," diffLatency: ").concat(X," myLatency: ").concat(R," remoteLatency: ").concat(K," pos: ").concat(P.pos," sameQuality: ").concat(Y));}catch(O){this.log.error(O);}}if("video"===r.mediaType?P.buf=this.factory.getInstance("BufferService").getBufferLength():"audio"===r.mediaType&&(P.buf=this.factory.getInstance("BufferService").getAudioBufferLength()),l=i.getData(r.mediaType,r.videoID,r.segmentNumber,r.quality))l.data?P.sr=1:P.sr=2;else if(null===l&&"video"===r.mediaType){var q="",M=(o.getSegmentNumber()>r.segmentNumber?q="after":o.getSegmentNumber()<r.segmentNumber-this.segmentNumberDiffConsideredValid*I.indexDiff[r.mediaType]?q="before":o.getSegmentNumber()<=r.segmentNumber&&o.getSegmentNumber()>=r.segmentNumber-this.segmentNumberDiffConsideredValid*I.indexDiff[r.mediaType]&&(q="just before"),i.getSegmentList(r.mediaType,r.videoID));if("quality"===(q="video"===r.mediaType&&M[r.segmentNumber]&&!M[r.segmentNumber][r.quality]?"quality":q)){var $=-1,J=0;try{for(var Z in M[r.segmentNumber])M[r.segmentNumber][Z].size>J&&($=Number(Z),J=M[r.segmentNumber][Z].size);0!==$&&(P.qa=$);}catch(O){}P.sr=0;}else "just before"!==q&&(P.sr=0);}else null===l&&"audio"===r.mediaType&&(P.sr=0);}else P={type:"fileAvailabilityResponse",requestID:r.requestID,sr:0,qa:-1,pos:0,st:-1,ste:-1,buf:0,r:0};s.isSeeder||I.lowLatency||(P.pos=0),this.log.debug("[Broadcast] File availability received from",e,"for ",r.mediaType," segment",r.segmentNumber,P),this.sendMessage(e,P);}else if(-1<["fileAvailabilityResponse","p2pOrgRes","aboResponse","cancelAboRes"].indexOf(r.type))this.callbacks[r.requestID]&&(this.callbacks[r.requestID](r.requestID,e,r),delete this.callbacks[r.requestID]);else if("fileRequest"===r.type){this.log.debug("[UL] File request received from",e,"for ",r.mediaType," segment",r.segmentNumber);var ee=n.getCurrentRequestForPeer("server",e,r.mediaType),te=this.factory.getInstance("SendVideoData"),N=this.factory.getInstance("GeneralSettings");if(null!==ee&&n.removeRequest("server",e,ee.requestID),N.shouldSend()){var re=n.getRequestsForSegment("client",r.videoID,r.segmentNumber,r.mediaType),ne=0<re.length&&""!==re[0].meshID?re[0].meshID+"|"+e.split("-")[0]:o.getUuid().split("-")[0]+"|"+e.split("-")[0];if(this.log.trace("[Loop] Mesh server:",ne),this.sendMessage(e,{type:"mi",ri:r.requestID,mi:ne}),(d=n.initRequest("server",e,r.requestID)).videoID=r.videoID,d.segmentNumber=r.segmentNumber,d.storageUrl=r.storageUrl,d.quality=r.quality,d.startDate=(new Date).getTime(),d.endDate=null,d.bytesSent=0,d.mediaType=r.mediaType,d.range=r.range,d.meshID=ne,l=i.getData(d.mediaType,r.videoID,r.segmentNumber,r.quality),l=!d.storageUrl||l&&l.storageUrl===d.storageUrl||!s.useDownloadSimilarUrl?l:i.getDataFromUrl(d.mediaType,r.videoID,d.storageUrl))d.storageUrl&&l.storageUrl!==d.storageUrl?this.sendMessage(e,{type:"fileRequestResponse",requestID:r.requestID,valid:!1,reason:this.listOfReasons.indexOf("quality"),after:i.getFirstAfter(r.mediaType,d.videoID,r.segmentNumber),before:o.getSegmentNumber()}):l.data?(d.dataready=!0,u.addHelpMetrics("FR1"),te.sendData(e,r,l)):(this.log.debug("[UL] Segment is being received, creating subscription ",r.segmentNumber,d.mediaType),d.justbefore=!0,u.addHelpMetrics("FR1"),te.createSubscription(e,{type:r.mediaType,videoID:r.videoID,segmentNumber:r.segmentNumber,quality:r.quality,requestID:r.requestID,storageUrl:r.storageUrl,range:r.range,ignoreQuality:!0===r.noquality}));else {var E="quality",L=("video"===r.mediaType?o.getSegmentNumber()>r.segmentNumber?E="after":o.getSegmentNumber()<r.segmentNumber-this.segmentNumberDiffConsideredValid*N.indexDiff[r.mediaType]?E="before":o.getSegmentNumber()<=r.segmentNumber&&o.getSegmentNumber()>=r.segmentNumber-this.segmentNumberDiffConsideredValid*N.indexDiff[r.mediaType]&&(E="just before"):"audio"===r.mediaType&&(o.getAudioSegmentNumber()>r.segmentNumber?E="after":o.getAudioSegmentNumber()<r.segmentNumber-this.segmentNumberDiffConsideredValid*N.indexDiff[r.mediaType]?E="before":o.getAudioSegmentNumber()<=r.segmentNumber&&o.getAudioSegmentNumber()>=r.segmentNumber-this.segmentNumberDiffConsideredValid*N.indexDiff[r.mediaType]&&(E="just before")),i.getSegmentList(r.mediaType,d.videoID));if(("video"===d.mediaType&&L[r.segmentNumber]&&!L[r.segmentNumber][r.quality]||"audio"===d.mediaType&&L[r.segmentNumber]&&!L[r.segmentNumber][r.quality])&&(E="quality"),d.reason=E,this.log.debug("[UL] Can not send for reason:",E,r.mediaType,r.segmentNumber,"video"===r.mediaType?o.getSegmentNumber():o.getAudioSegmentNumber(),r.segmentNumber,N.indexDiff[r.mediaType]),"just before"===E){u.addHelpMetrics("FR1"),te.createSubscription(e,{type:r.mediaType,videoID:r.videoID,segmentNumber:r.segmentNumber,quality:r.quality,requestID:r.requestID,storageUrl:r.storageUrl,range:r.range,ignoreQuality:!0===r.noquality});try{u.addHelpMetrics("jb");}catch(O){}}else {n.removeRequest("server",e,r.requestID);try{this.sendMessage(e,{type:"fileRequestResponse",requestID:r.requestID,valid:!1,reason:this.listOfReasons.indexOf(E),after:i.getFirstAfter(r.mediaType,d.videoID,r.segmentNumber),before:o.getSegmentNumber()});}catch(O){this.log.error(O);}}}}else this.sendMessage(e,{type:"fileRequestResponse",requestID:r.requestID,valid:!1,reason:6,after:0,before:0});}else if("fileRequestResponse"===r.type)!0===r.valid?null!==(d=n.getRequest("client",e,r.requestID))&&(d.status="ongoing",d.segmentSize=r.segmentSize,d.expectedSize=r.size,d.numberOfChunks=r.numberOfChunks,d.byteStart=r.byteStart||0,d.quality=r.quality||d.quality,d.waitingTime=r.waitingTime||d.waitingTime||0,this.events.emitNow("fileRequestStatus",{status:"started",clientOrServer:"client",requestID:r.requestID,peerID:e,startDate:d.startDate,endDate:null,quality:d.quality,bytesReceived:d.bytesReceived,expectedSize:d.expectedSize,waitingTime:d.waitingTime})):null!==(d=n.getRequest("client",e,r.requestID))&&(this.events.emitNow("fileRequestStatus",{status:"stopped",statusDetail:"cancelled",clientOrServer:"client",reason:this.listOfReasons[r.reason],after:r.after,before:r.before,requestID:r.requestID,peerID:e,startDate:d.startDate,endDate:(new Date).getTime(),bytesReceived:d.bytesReceived,expectedSize:d.expectedSize,waitingTime:r.waitingTime||d.waitingTime||0}),n.removeRequest("client",e,r.requestID));else if("fileRequestEnd"===r.type){var d=n.getRequest("server",e,r.requestID),ie=(new Date).getTime();this.events.emit("fileRequestStatus",{status:"stopped",statusDetail:"ended",clientOrServer:"server",requestID:r.requestID,peerID:e,startDate:d.startDate,endDate:ie,bytesSent:d.bytesSent,waitingTime:r.waitingTime||d.waitingTime||0}),this.factory.getInstance("SendVideoData").removeSubscription(e,r.requestID);try{o.setLastUpload({peer:e,upload:Math.floor(8*d.bytesSent/((ie-d.startDate)/1e3)),start:d.startDate,end:ie});}catch(x){this.log.error(x);}n.removeRequest("server",e,r.requestID);}else if("fileRequestStop"===r.type){var ae=this.peerList.getPeerFromList(e),oe=(d=n.getRequest("server",e,r.requestID),(new Date).getTime());if(null!==d){try{var se=c.getAvailableResources(),k=(u.addHelpMetricsNbr("noRA",se),o.sendableSegments),ce=(u.addHelpMetricsNbr("noR",k),0<k&&u.addHelpMetricsNbr("noRPA",Math.round(se/k*100)),n.getNumberOfRequests("server"));0<ce&&u.addHelpMetricsNbr("noRP",Math.round(ce/k*100));}catch(O){}this.events.emit("fileRequestStatus",{status:"stopped",statusDetail:"cancelledByRemotePeer",clientOrServer:"server",requestID:r.requestID,peerID:e,startDate:d.startDate,endDate:oe,bytesSent:d.bytesSent}),this.factory.getInstance("SendVideoData").removeSubscription(e,r.requestID),ae.connection&&ae.connection.queue&&ae.connection.queue.removeDataFromQueue("data");try{o.setLastUpload({peer:e,upload:Math.floor(8*d.bytesSent/((oe-d.startDate)/1e3)),start:d.startDate,end:oe});}catch(x){this.log.error(x);}d=n.removeRequest("server",e,r.requestID),this.log.debug("[UL] Request stopped",r.requestID);}}else "aboRequest"===r.type?0<c.getAvailableResources()||1===a.ip?(C=1===a.ip?r.r||1:0,c.reserveResource(e,C),this.sendMessage(e,{type:"aboResponse",requestID:r.requestID,success:!0})):this.sendMessage(e,{type:"aboResponse",requestID:r.requestID,success:!1}):"cancelAbo"===r.type?(c.removeAllAbonnements(e),this.sendMessage(e,{type:"cancelAboRes",requestID:r.requestID})):"notifyFirst"===r.type?c.getNoPeerToSelect()&&(c.revokeAbonnement(e),this.factory.getInstance("ScoreService").resetScores()):this.events.emit("messageReceived",{peerID:e,message:t});else if(t instanceof ArrayBuffer){var ue=new Uint8Array(t),le=this.getBufferHeader(ue);if(null!==(d=n.getRequest("client",e,le)))if(le===d.requestID){u.addHelpMetrics("C0");var fe=this.getBufferByteStart(ue),de=d.chunks.findIndex(function(e){return "waiting"===e.status}),f=d.chunks[de];if(f.data=new Uint8Array(ue.slice(24,t.byteLength)),f.size=f.data.byteLength||f.data.length,1===f.size&&(this.log.debug("[data1] data received",d.expectedSize,d.mediaType,d.segmentNumber,d.quality,fe,de,f.size),this.log.debug("[Size1] received chunk with size 1",d.mediaType,d.segmentNumber,d.quality),s.removeMessageOfOneByte))f.data=null,delete f.size;else if(f.endDate=(new Date).getTime(),f.status="received",d.bytesReceived+=f.size,d.nextChunk+=1,0!==f.data.byteLength?(i.postPartialData(d.mediaType,d.videoID,d.segmentNumber,d.quality,{start:fe,end:fe+f.size,size:f.size,data:f.data},d.segmentSize,d.storageUrl),d.callback&&d.callback(f.data)):(d.segmentSize=d.bytesReceived,d.expectedSize=d.bytesReceived,i.postPartialDataSize(d.mediaType,d.videoID,d.segmentNumber,d.quality,d.segmentSize,d.storageUrl),d.chunks.splice(de,1)),d.bytesReceived===d.expectedSize&&-1===d.chunks.findIndex(function(e){return "received"!==e.status})){var pe,ye=0,U=new Uint8Array(d.expectedSize),A=function(e,t){var r,n,i,a,o,s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(e);},n:function(){var e=s.next();return n=e.done,e},e:function t(e){i=!0,r=e;},f:function(){try{n||null==s["return"]||s["return"]();}finally{if(i)throw r}}};if(Array.isArray(e)||(s=Ie(e))||t&&e&&"number"==typeof e.length)return s&&(e=s),a=0,{s:o=function o(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function t(e){throw e},f:o};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(d.chunks);try{for(A.s();!(pe=A.n()).done;){var ge=pe.value;U.set(new Uint8Array(ge.data),ye),ye+=ge.size;}}catch(O){A.e(O);}finally{A.f();}this.events.emitNow("fileReceived",{status:"complete",peerID:e,requestID:d.requestID,startDate:d.startDate,endDate:(new Date).getTime(),data:U.buffer,size:d.expectedSize,depth:d.depth||1}),this.sendMessage(e,{type:"fileRequestEnd",requestID:d.requestID}),n.removeRequest("client",e,d.requestID);}else p={index:d.nextChunk},d.chunks.push(p),p.startDate=(new Date).getTime(),p.endDate=null,p.data=null,p.status="waiting",this.events.emitNow("fileRequestStatus",{status:"ongoing",clientOrServer:"client",requestID:d.requestID,peerID:e,startDate:d.startDate,endDate:(new Date).getTime(),bytesReceived:d.bytesReceived,expectedSize:d.expectedSize,nextChunk:d.nextChunk,depth:d.depth||1});}else u.addHelpMetrics("C2"),this.log.trace("[DL] Chunk received but requestID mismatch:",le,d.requestID);else this.log.trace("[DL] Chunk received from a cancelled request"),u.addHelpMetrics("C1");}}catch(O){try{this.log.trace(O);}catch(he){}}}},{key:"sendAll",value:function(t,r){var e=this.peerList.getListKeysConnected(),n=this,i=[];return e.forEach(function(e){i.push(n.sendMessage(e,t,r));}),i}},{key:"toUuid",value:function(e){if(16!=e.length)throw new Error("Invalid buffer length for uuid: ".concat(e.length));e=e.reduce(function(e,t){return e+t.toString(16).padStart(2,"0")},"");return "".concat(e.slice(0,8),"-").concat(e.slice(8,12),"-").concat(e.slice(12,16),"-").concat(e.slice(16,20),"-").concat(e.slice(20))}},{key:"getBufferHeader",value:function(e){e=e.slice(0,16);return this.toUuid(e)}},{key:"BufferToByteNumber",value:function(e){for(var t=0,r=0;r<8;r++)t=(t*=256)+e[r];return t}},{key:"getBufferByteStart",value:function(e){e=e.slice(16,24);return this.BufferToByteNumber(e)}},{key:"removeCallback",value:function(e){this.callbacks[e]&&delete this.callbacks[e];}}])&&De(e.prototype,t),r&&De(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r;}();function g(e){return (g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=g(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=g(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==g(e)?e:e+""}(n.key),n);}}var Me=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger"),this.generalSettings=e.getInstance("GeneralSettings"),this.reset(),this.interval=setInterval(this.removeOldSegments.bind(this),5e3);}return e=t,(r=[{key:"reset",value:function(){this.mediaStorage={video:{},audio:{}},this.videoData={},this.segmentToKeepInVoD=4,this.segmentToKeepMultiplier=2,this.segmentToKeepInVoD2=this.segmentToKeepInVoD*this.segmentToKeepMultiplier,this.externalRandomNumber=undefined,this.oneRandomNumber=undefined,this.initSegmentToKeepNumbers(),this.initNumberToKeep(),clearInterval(this.interval);}},{key:"initSegmentToKeepNumbers",value:function(e){var t;e!==undefined&&this.externalRandomNumber===undefined&&(this.externalRandomNumber=e%this.segmentToKeepInVoD),this.myRandomNumber=this.externalRandomNumber||Math.floor(Math.random()*this.segmentToKeepInVoD),this.oneRandomNumber=this.oneRandomNumber||(e=1,t=this.segmentToKeepMultiplier,e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e),this.myRandomNumber2=this.myRandomNumber+this.segmentToKeepInVoD*(this.oneRandomNumber-1);}},{key:"initNumberToKeep",value:function(){try{this.generalSettings.activated?this.numberToKeep=this.factory.getInstance("GeneralSettings").numberOfSegmentsToKeep:this.numberToKeep=0;}catch(e){this.generalSettings.activated?this.numberToKeep=20:this.numberToKeep=0;}}},{key:"setNumberToKeep",value:function(e){this.numberToKeep=e;}},{key:"getDataConstructed",value:function(e,t,r,n){e=this.mediaStorage[e];if(!(e[t]&&e[t][r]&&e[t][r][n]))return null;if(e[t][r][n].data)return e[t][r][n].data;try{for(var i=e[t][r][n].subData.reduce(function(e,t){return {size:e.size+t.size}},{size:0}),a=e[t][r][n].subData,o=new Uint8Array(i.size),s=(a.sort(function(e,t){return e.start-t.start}),0),c=0;c<a.length;c++)o.set(a[c].data,s),s+=a[c].size;return o.buffer}catch(u){return null}}},{key:"getDataMissing",value:function(e,t,r,n){e=this.mediaStorage[e];if(!(e[t]&&e[t][r]&&e[t][r][n]))return null;if(e[t][r][n].data)return "";try{var i=e[t][r][n].size,a=e[t][r][n].subData,o=[],s=0;a.sort(function(e,t){return e.start-t.start});try{s=a[0].start;}catch(f){}for(var c=0;c<a.length;c++){var u,l=a[c];s<l.start&&(u={start:s,end:l.start},o.push(u)),s=l.end;}return (!i||s<i)&&o.push({start:s,end:i?i-1:""}),0===o.length&&this.log.trace("SubData size of segment",r,n,e[t][r][n].subData,e[t][r][n].size),o}catch(f){return null}}},{key:"postData",value:function(e,t,r,n,i,a){if(!isNaN(r)&&!isNaN(n)){this.log.trace("Save full data",e,t,r,n,i.byteLength,a);var o={},s=this.mediaStorage[e];s[t][r]=s[t][r]||{},s[t][r][n]=s[t][r][n]||{filename:t+r+n,size:undefined,data:undefined,storageUrl:a,date:new Date,subData:[]},s[t][r][n].data===undefined&&(s[t][r][n].data=i.slice(0),s[t][r][n].size=i.byteLength),o.segmentNumber=r,o[r]={},Object.keys(s[t][r]).forEach(function(e){o[r][e]={size:s[t][r][e].size};}),this.factory.getInstance("PeerDataService").addAvailableSegments(e,r,n,!0);try{s[t]&&s[t][r]&&s[t][r][n]&&this.factory.getInstance("SendVideoData")&&this.factory.getInstance("SendVideoData").publishData({type:e,videoID:t,segmentNumber:r,quality:n},s[t][r][n]);}catch(c){}return o}this.log.trace("QUANTEEC deactivated data not saved");}},{key:"postPartialDataSize",value:function(e,t,r,n,i,a){if(isNaN(r)||isNaN(n))this.log.trace("QUANTEEC deactivated data not saved");else {var o=this.mediaStorage[e];o[t]=o[t]||{},o[t][r]=o[t][r]||{},o[t][r][n]=o[t][r][n]||{filename:t+r+n,size:i,storageUrl:a,data:undefined,date:new Date,subData:[]},(o[t][r][n].size===undefined&&"number"==typeof i||"number"==typeof o[t][r][n].size&&"number"==typeof i&&i>o[t][r][n].size)&&(o[t][r][n].size=i);try{o[t]&&o[t][r]&&o[t][r][n]&&this.factory.getInstance("SendVideoData")&&this.factory.getInstance("SendVideoData").publishData({type:e,videoID:t,segmentNumber:r,quality:n,storageUrl:a},o[t][r][n]);}catch(s){}}}},{key:"postPartialData",value:function(e,t,r,n,i,a,o){if(!isNaN(r)&&!isNaN(n)){var s,c,u,l,f=this.mediaStorage[e];f[t]=f[t]||{},f[t][r]=f[t][r]||{},f[t][r][n]=f[t][r][n]||{filename:t+r+n,size:a,storageUrl:o,data:undefined,date:new Date,subData:[]},(f[t][r][n].size===undefined&&"number"==typeof a||"number"==typeof f[t][r][n].size&&"number"==typeof a&&a>f[t][r][n].size)&&(f[t][r][n].size=a);try{this.factory.getInstance("VariableSettings").useKnowledge&&0===f[t][r][n].subData.length&&(s=this.factory.getInstance("Message"),c=this.factory.getInstance("AbonnementService").getAvailableResources(),u="audio"===e?this.factory.getInstance("BufferService").getAudioBufferLength():this.factory.getInstance("BufferService").getBufferLength(),l=(new Date).getTime(),this.factory.getInstance("PeerInfosStorage").setInfoSent(e,r,n,c,u,l),s.sendAll({type:"seg",mt:e,sn:r,q:n,r:c,buf:u,ts:l}));}catch(d){}f[t][r][n].subData.push(i),this.factory.getInstance("PeerDataService").addAvailableSegments(e,r,n,!1);try{f[t]&&f[t][r]&&f[t][r][n]&&this.factory.getInstance("SendVideoData")&&this.factory.getInstance("SendVideoData").publishData({type:e,videoID:t,segmentNumber:r,quality:n,storageUrl:o},f[t][r][n]);}catch(d){}return {}}this.log.trace("QUANTEEC deactivated data not saved");}},{key:"getSegmentList",value:function(e,r,t){var n,i=t||0,a=this.mediaStorage[e];return ee()(a,r)?(n={},Object.keys(a[r]).forEach(function(t){var e;Number(t)>=i&&(e=Object.keys(a[r][t]),n[t]={},e.forEach(function(e){n[t][e]={size:a[r][t][e].size};}));}),n):{}}},{key:"getLastSegmentList",value:function(e,t,r){var n=r||10,i=this.mediaStorage[e],a=this.factory.getInstance("AbonnementService").getAvailableResources();if(ee()(i,t)){var o=[],s=Object.keys(i[t]);s.sort(function(e,t){return t-e});for(var c=0;c<s.length&&o.length<n;c++){var u=Object.keys(i[t][s[c]]);o.push({segmentNumber:Number(s[c]),quality:Number(u[0]),r:a,buf:"audio"===e?this.factory.getInstance("BufferService").getAudioBufferLength():this.factory.getInstance("BufferService").getBufferLength()});}return o}return []}},{key:"getFirstAfter",value:function(e,t,r){var e=this.mediaStorage[e],n=r||0,i=-1;if(ee()(e,t)){for(var a=Object.keys(e[t]),o=0;o<a.length;o++){var s=Number(a[o]);if(n<=s){i=s;break}}return i}return -1}},{key:"getData",value:function(e,t,r,n){e=this.mediaStorage[e];return ee()(e,[t,r,n])?e[t][r][n]:null}},{key:"getDataWithoutQuality",value:function(e,t,r){e=this.mediaStorage[e];if(ee()(e,[t,r]))try{var n=Object.keys(e[t][r]).sort().pop();return {data:e[t][r][n],quality:n}}catch(i){}return null}},{key:"getDataFromUrl",value:function(e,t,r){var n=this.mediaStorage[e];if(ee()(n,t))for(var i in n[t])for(var a in n[t][i])if(n[t][i][a].storageUrl===r)return n[t][i][a];return null}},{key:"keepNumberSegments_vod",value:function(e,t,r){this.initNumberToKeep();var n=r||this.numberToKeep,i=Math.ceil(3*n/4),a=[],o=this.mediaStorage[e];if(ee()(o,t)){var s=Object.keys(o[t]);s.sort(function(e,t){return Number(e)-Number(t)});for(var c=0;c<s.length;c++)s.length-a.length>n&&c<i&&s[c]%this.segmentToKeepInVoD!==this.myRandomNumber&&(a.push(Number(s[c])),this.factory.getInstance("PeerDataService").removeAvailableSegments(e,Number(s[c])),delete o[t][s[c]]);if((s=Object.keys(o[t])).sort(function(e,t){return Number(e)-Number(t)}),s.length>n)for(var u=0;u<s.length;u++)s.length-a.length>n&&u<i&&s[u]%this.segmentToKeepInVoD2!==this.myRandomNumber2&&(a.push(Number(s[u])),this.factory.getInstance("PeerDataService").removeAvailableSegments(e,Number(s[u])),delete o[t][s[u]]);for((s=Object.keys(o[t])).sort(function(e,t){return Number(e)-Number(t)});s.length>n;){var l=s.shift();a.push(Number(l)),this.factory.getInstance("PeerDataService").removeAvailableSegments(e,Number(l)),delete o[t][l];}}return a}},{key:"keepNumberSegments_other",value:function(e,t,r){this.initNumberToKeep();var n=r||this.numberToKeep,i=[],a=this.mediaStorage[e];if(ee()(a,t)){var o=Object.keys(a[t]);for(o.sort(function(e,t){return Number(e)-Number(t)});o.length>n;){var s=o.shift();i.push(Number(s)),this.factory.getInstance("PeerDataService").removeAvailableSegments(e,Number(s)),delete a[t][s];}}return i}},{key:"computeCoverRatio",value:function(e,t){var r,n=this.factory.getInstance("AnalyticsService"),e=this.mediaStorage[e],t=Object.keys(e[t]),e=0,t=(0<t.length&&0<n.seg_nbr&&(t.sort(function(e,t){return Number(e)-Number(t)}),r=Number(t[0]),t=Number(t[t.length-1]),e=Math.round((t-r)/n.seg_nbr*1e4)/100),n.cover_ratio=e,this.numberToKeep/10*60);n.cover_ratio_max=Math.round(t/n.seg_nbr*1e4)/100;}},{key:"keepNumberSegments",value:function(e,t,r){var n=this.factory.getInstance("AnalyticsService");n.stream_type&&"vod"===n.stream_type?(this.keepNumberSegments_vod(e,t,r),this.computeCoverRatio(e,t)):this.keepNumberSegments_other(e,t,r);}},{key:"removeOldSegments",value:function(){try{var e=this.factory.getInstance("AnalyticsService"),t=this.factory.getInstance("GeneralSettings"),r=[];if("live"===e.stream_type&&e.seg_nbr<700){var n,i=new Date;for(n in this.mediaStorage){var a,o=this.mediaStorage[n];for(a in o){var s,c=o[a];for(s in c){var u,l=c[s];for(u in l){var f=l[u];i.getTime()-f.date.getTime()>1e3*t.maxAgeLive&&r.push({mediaType:n,videoID:a,segmentNumber:s});}}}}for(var d=0;d<r.length;d++)delete this.mediaStorage[r[d].mediaType][r[d].videoID][r[d].segmentNumber];}}catch(p){}}},{key:"deleteQuality",value:function(e,t,r,n){var i=this.mediaStorage[e];if(ee()(i,[t,r,n])){delete i[t][r][n],this.log.debug("Quality deleted",t,r,n);try{this.factory.getInstance("SendVideoData").removeSubscriptions(t,e,r,n);}catch(a){}}}},{key:"deleteSegmentAndAbove",value:function(e,t,r){var n=this.mediaStorage[e];if(ee()(n,[t,r]))for(var i in delete n[t][r],n[t])r<i&&delete n[t][i];}},{key:"deleteAll",value:function(){this.mediaStorage={video:{},audio:{}};}}])&&qe(e.prototype,r),n&&qe(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function h(e){return (h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ne(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=h(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=h(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==h(e)?e:e+""}(n.key),n);}}var Ee=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger"),this.fileRequests={server:{},client:{}};}return e=t,(r=[{key:"reset",value:function(){this.fileRequests={server:{},client:{}};}},{key:"initRequest",value:function(e,t,r){return this.fileRequests[e][t]=this.fileRequests[e][t]||{},this.fileRequests[e][t][r]={peerID:t,requestID:r},this.fileRequests[e][t][r]}},{key:"getAll",value:function(){return this.fileRequests}},{key:"getNumberOfRequests",value:function(e){return this.fileRequests[e]?Object.keys(this.fileRequests[e]).length:0}},{key:"getRequestsForPeer",value:function(e,t){return this.fileRequests[e].hasOwnProperty(t)?this.fileRequests[e][t]:null}},{key:"getRequestsForSegment",value:function(e,t,r,n){var i,a=[];for(i in this.fileRequests[e])for(var o in this.fileRequests[e][i]){o=this.fileRequests[e][i][o];o.videoID===t&&o.segmentNumber===r&&o.mediaType===n&&a.push(o);}return a}},{key:"getCurrentRequestForPeer",value:function(e,t,r){if(this.fileRequests[e].hasOwnProperty(t))for(var n in this.fileRequests[e][t])if(this.fileRequests[e][t][n].mediaType===r)return this.fileRequests[e][t][n];return null}},{key:"getCurrentRequestsForPeer",value:function(e,t){var r,n=[];if(this.fileRequests[e].hasOwnProperty(t))for(r in this.fileRequests[e][t])n.push(this.fileRequests[e][t][r]);return n}},{key:"getRequest",value:function(e,t,r){return this.fileRequests[e].hasOwnProperty(t)&&this.fileRequests[e][t].hasOwnProperty(r)?this.fileRequests[e][t][r]:null}},{key:"removeRequest",value:function(e,t,r){if(this.fileRequests[e].hasOwnProperty(t)&&this.fileRequests[e][t].hasOwnProperty(r)&&(delete this.fileRequests[e][t][r],"server"===e))try{this.factory.getInstance("SendVideoData").removeSubscription(t,r);}catch(n){}}},{key:"removeRequestFromPeerID",value:function(e){this.fileRequests.server.hasOwnProperty(e)&&delete this.fileRequests.server[e],this.fileRequests.client.hasOwnProperty(e)&&delete this.fileRequests.client[e];}}])&&Ne(e.prototype,r),n&&Ne(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function b(e){return (b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Le(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=b(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=b(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==b(e)?e:e+""}(n.key),n);}}var ke=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger"),this.blacklist=[],this.retainTimeSeconds=300;}return e=t,(r=[{key:"reset",value:function(){this.blacklist=[];}},{key:"eraseOld",value:function(){for(var e=[],t=new Date,r=0;r<this.blacklist.length;r++)t.getTime()-this.blacklist[r].timestamp.getTime()>=1e3*this.retainTimeSeconds&&e.unshift(r);for(var n=0;n<e.length;n++)this.blacklist.splice(e[n],1);}},{key:"getBlackList",value:function(){return this.eraseOld(),this.blacklist.map(function(e){return e.value})}},{key:"getFullBlackList",value:function(){return this.eraseOld(),this.blacklist}},{key:"hasInBlacklist",value:function(t){return this.eraseOld(),-1<this.blacklist.findIndex(function(e){return e.value===t})}},{key:"putBlackList",value:function(t){t&&(this.hasInBlacklist(t)?this.blacklist[this.blacklist.findIndex(function(e){return e.value===t})].timestamp=new Date:this.blacklist.push({value:t,timestamp:new Date}));}},{key:"deleteBlackList",value:function(t){var e=this.blacklist.findIndex(function(e){return e.value===t}),r=[];return r=-1<e?this.blacklist.splice(e,1):r}}])&&Le(e.prototype,r),n&&Le(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function v(e){return (v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=v(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=v(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==v(e)?e:e+""}(n.key),n);}}var Oe=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger");}return e=t,(r=[{key:"reset",value:function(){try{clearInterval(this.interval);}catch(e){}}},{key:"disconnectAll",value:function(){var e,t=this.factory.getInstance("PeerConnection");for(e in this.factory.getInstance("PeerListStorage").getListPeerInfos()){var r=e;t.disconnect(r);}}},{key:"getAppropriateResource",value:function(e,t){return this.factory.getInstance("VariableSettings").useLastUL&&(e=this.factory.getInstance("PeerListStorage").getPeerFromList(e))&&e.last&&(new Date).getTime()-new Date(e.last.date).getTime()<18e4?e.last.r:t}},{key:"getFullList",value:function(){var e,t=this.factory.getInstance("PeerListStorage").getListPeerInfos(),r=[];for(e in t){var n=t[e];r.push(n);}return r}},{key:"getNbrConnectedPeers",value:function(){var e=0;try{e=this.getListByConnectedPeers().length;}catch(t){}return e}},{key:"getListByConnectedPeers",value:function(){var e,t=this.factory.getInstance("PeerListStorage").getListPeerInfos(),r=[];for(e in t){var n=t[e];n!==undefined&&n.connected&&r.push(n);}return r}},{key:"getListByScore",value:function(){var e,t=this.factory.getInstance("PeerListStorage").getListPeerInfos(),r=[];for(e in t){var n=t[e];n!==undefined&&n.connected&&n.hasOwnProperty("score")&&r.push(n);}var i=function i(e,t){return t.score-e.score};return r.sort(i),r}}])&&Ae(e.prototype,r),n&&Ae(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function S(e){return (S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=S(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=S(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==S(e)?e:e+""}(n.key),n);}}var Ce=function(){function n(e,t,r){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger"),this.events=this.factory.getInstance("Events"),this.subscription=[],this.chunkSize=15900,this.uuid=Math.round(15e3*Math.random());}return e=n,(t=[{key:"sendWrongQuality",value:function(e,t,r){this.factory.getInstance("Message").sendMessage(e,{type:"fileRequestResponse",requestID:t.requestID,valid:!1,reason:4,quality:r});}},{key:"ByteNumberToBuffer",value:function(e){for(var t=[],r=0;r<8;r++)t[r]=255&e,e/=256;return t.reverse(),new Uint8Array(t)}},{key:"BufferToByteNumber",value:function(e){for(var t=0,r=0;r<8;r++)t=(t*=256)+e[r];return t}},{key:"toBuffer",value:function(e){var t;return e?(t=e.replace(/-/g,""),36==e.length&&t.length,new Uint8Array(t.match(/.{1,2}/g).map(function(e){return parseInt(e,16)}))):new Uint8Array(16)}},{key:"sendData",value:function(t,r,e){this.log.debug("[UL] Sending complete segment ".concat(r.segmentNumber," ").concat(r.mediaType));var n=this.factory.getInstance("Message"),i=this.factory.getInstance("FileRequestStorage"),a=null;try{var o=this.subscription.findIndex(function(e){return e.peerID===t&&e.type===r.mediaType});-1<o&&(this.subscription.splice(o,1),this.log.debug("[UL] Remove subscription for same segment",r.segmentNumber,r.mediaType));}catch(m){}var s=r.range||{start:0,end:e.size-1},c=(s.size=s.end-s.start+1,i.getRequest("server",t,r.requestID));if(c){this.log.trace("[UL] Valid fileResponse sendData()"),n.sendMessage(t,{type:"fileRequestResponse",requestID:r.requestID,valid:!0,byteStart:s.start,size:s.size,numberOfChunks:Math.ceil(s.size/this.chunkSize),segmentSize:e.size,quality:r.quality,range:s,waitingTime:c.waitingTime||Date.now()-c.startDate});for(var u=0,l=!1,f=Math.ceil(s.size/this.chunkSize),d=new Uint8Array(e.data),p=this.toBuffer(r.requestID);!l&&u<f;){try{var y=u*this.chunkSize+s.start,g=Math.min((u+1)*this.chunkSize+s.start,s.end+1),a=new Uint8Array(d.subarray(y,g)),h=this.ByteNumberToBuffer(y);a=this.concatBuffer([p,h,a]);}catch(m){l=!0;break}u++,c.bytesSent+=a.byteLength,this.events.emit("fileRequestStatus",{status:"ongoing",clientOrServer:"server",requestID:r.requestID,peerID:t,startDate:c.startDate,endDate:(new Date).getTime(),bytesSent:c.bytesSent,expectedSize:s.size,waitingTime:c.waitingTime||Date.now()-c.startDate}),c.isSending=!0,n.sendMessage(t,a.buffer);}this.log.debug("[UL] Complete segment is correctly sent ".concat(r.segmentNumber," ").concat(r.mediaType));}else this.log.error("[UL] Server request object is null",t,r.requestID);}},{key:"concatBuffer",value:function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r].length;for(var n=new Uint8Array(t),i=0,a=0;a<e.length;a++)n.set(e[a],i),i+=e[a].length;return n}},{key:"createSubscription",value:function(e,t){e={peerID:e,requestID:t.requestID,type:t.type,videoID:t.videoID,segmentNumber:t.segmentNumber,quality:t.quality,range:t.range,init:!1,ignoreQuality:t.ignoreQuality,dataSent:[]};t.storageUrl&&(e.storageUrl=t.storageUrl),this.subscription.push(e),this.log.debug("[UL] Create subscription ".concat(t.segmentNumber," ").concat(t.type," ").concat(this.uuid),e,JSON.parse(JSON.stringify(this.subscription))),this.sendAvailableData(e);}},{key:"hasSubscriptionForSegment",value:function(t,r){return -1<this.subscription.findIndex(function(e){return e.type===t&&e.segmentNumber===r})}},{key:"addDataSent",value:function(e,t){var r=!1;t.sort(function(e,t){return e.start-t.start});for(var n=0;n<t.length;n++){var i=t[n];if(i.start===e.end){i.start=e.start,r=!0;break}if(i.end===e.start){i.end=e.end,r=!0;break}}r||(t.push(e),t.sort(function(e,t){return e.start-t.start}));}},{key:"missingDataToSend",value:function(e){for(var t=e.range.start,r=e.range.end,n=[],i=(e.dataSent.sort(function(e,t){return e.start-t.start}),t),a=0;a<e.dataSent.length;a++){var o,s=e.dataSent[a];i<s.start&&(o={start:i,end:s.start},n.push(o)),i=s.end;}return (i<r||0===r)&&n.push({start:i,end:r}),n}},{key:"sendAvailableData",value:function(e){var t=this.factory.getInstance("Message"),r=this.factory.getInstance("VideoStorage"),n=this.factory.getInstance("FileRequestStorage"),i=null;if((i=r.getData(e.type,e.videoID,e.segmentNumber,e.quality))&&0<i.subData.length&&0<=i.size){var a=this.toBuffer(e.requestID),o=(i.subData.sort(function(e,t){return e.start-t.start}),i.size);if(0===o?o=Infinity:this.log.trace("[UL] Direct UL data size received",e.type,o),e.range=e.range||{start:0,end:o-1},e.range.end===Infinity&&o!==Infinity&&(e.range.end=o),e.range.size=e.range.end-e.range.start+1,!1===e.init){r=n.getRequest("server",e.peerID,e.requestID);if(!r)return void this.log.error("[UL] Server request object is null",e.peerID,e.requestID);this.log.trace("[UL] Valid fileResponse sendAvailableData()"),t.sendMessage(e.peerID,{type:"fileRequestResponse",requestID:e.requestID,valid:!0,byteStart:e.range.start,size:e.range.size,numberOfChunks:-1,segmentSize:i.size,quality:e.quality,waitingTime:r.waitingTime||Date.now()-r.startDate}),e.init=!0;}for(var s=0;s<i.subData.length;s++){for(var c=i.subData[s],u=(c.start>=e.dataSent.start&&(c.start,e.dataSent.end),this.missingDataToSend(e)),l=!1,f=c.data,d=c.size,p=c.start,y=c.end,g=0;g<u.length;g++){var h=u[g],m=c.start<=h.start&&c.end>h.start,b=c.start<=h.end&&c.end>h.end;c.start>=h.start&&c.end<=h.end?l=!0:m&&b?(p=h.start,y=h.end,d=h.end-h.start,f=new Uint8Array(new Uint8Array(c.data).subarray(h.start-c.start,h.end-c.start+1)),l=!0):m?(p=h.start,y=c.end,d=c.end-h.start,f=new Uint8Array(new Uint8Array(c.data).subarray(h.start-c.start,c.end-c.start+1)),l=!0):b&&(p=c.start,y=h.end,d=h.end-c.start,f=new Uint8Array(new Uint8Array(c.data).subarray(0,h.end-c.start+1)),l=!0);}if(l){if(1===d&&this.log.debug("[Size1] Send size 1"),d<=this.chunkSize){var v=this.ByteNumberToBuffer(p),v=this.concatBuffer([a,v,f]);y-p==1&&this.log.debug("SENDING PARTIAL SEGMENT => Start:".concat(p," End: ").concat(y)),t.sendMessage(e.peerID,v.buffer);}else for(var S=void 0,w=0,I=!1,P=Math.ceil(d/this.chunkSize),D=new Uint8Array(f);!I&&w<P;){try{var T=w*this.chunkSize,R=Math.min((w+1)*this.chunkSize,c.size),S=new Uint8Array(D.subarray(T,R)),q=this.ByteNumberToBuffer(T+p);S=this.concatBuffer([a,q,S]),R-(T+p)==1&&this.log.debug("SENDING PARTIAL PARTIAL SEGMENT => Start:".concat(T+p," End: ").concat(R));}catch(M){I=!0;break}w++,t.sendMessage(e.peerID,S.buffer);}this.addDataSent({start:p,end:y},e.dataSent);}else c.end===o&&0===u.length&&(v=this.concatBuffer([a,this.ByteNumberToBuffer(e.range.size)]),t.sendMessage(e.peerID,v.buffer),this.log.infos("[UL] Direct data: Send empty data to signal end of data when no size",e.type,e.segmentNumber,e.quality));}}}},{key:"invalidateSubscription",value:function(e,t,r,n){for(var i=this.subscription.length-1;0<=i;i--){var a=this.subscription[i];a.type===t&&a.videoID===e&&a.segmentNumber===r&&a.quality===n&&(this.log.debug("[UL] Invalidate subscription ".concat(this.subscription[i].segmentNumber," ").concat(this.subscription[i].type)),this.factory.getInstance("Message").sendMessage(a.peerID,{type:"fileRequestResponse",requestID:a.requestID,valid:!1,reason:6}),this.subscription.splice(i,1));}}},{key:"removeSubscriptions",value:function(e,t,r,n){for(var i=this.subscription.length-1;0<=i;i--){var a=this.subscription[i];a.type===t&&a.videoID===e&&a.segmentNumber===r&&a.quality===n&&(this.log.debug("[UL] Remove subscription ".concat(this.subscription[i].segmentNumber," ").concat(this.subscription[i].type)),this.subscription.splice(i,1),this.log.debug("Removed subscriptions",e,r,n));}}},{key:"removeSubscription",value:function(t,r){var e=this.subscription.findIndex(function(e){return e.peerID===t&&e.requestID===r});if(-1<e){try{this.log.debug("[UL] Remove subscription ".concat(this.subscription[e].segmentNumber," ").concat(this.subscription[e].type));}catch(n){this.log.debug("[UL] Remove subscription",n);}this.subscription.splice(e,1);}}},{key:"publishData",value:function(t,e){this.factory.getInstance("VideoStorage");for(var r=this.subscription.filter(function(e){return e.type===t.type&&e.videoID===t.videoID&&e.segmentNumber===t.segmentNumber}),n=0;n<r.length;n++)if(e.data&&(r[n].quality===t.quality||r[n].ignoreQuality))!1===r[n].init?(this.log.debug("[UL] SUBSCRIPTION full segment",e),this.sendData(r[n].peerID,r[n],e)):this.log.debug("[UL] SUBSCRIPTION full segment received but UL already in progress ".concat(t.segmentNumber," ").concat(t.type),e);else if(r[n].storageUrl&&r[n].storageUrl!==t.storageUrl)this.log.debug("[UL] SUBSCRIPTION wrong url ".concat(t.segmentNumber," ").concat(t.type)),this.sendWrongQuality(r[n].peerID,r[n],t.quality);else if(r[n].quality!==t.quality)this.log.debug("[UL] SUBSCRIPTION wrong quality ".concat(t.segmentNumber," ").concat(t.type)),this.sendWrongQuality(r[n].peerID,r[n],t.quality);else if(e.data===undefined)try{this.log.trace("[UL] SUBSCRIPTION partial segment ".concat(t.segmentNumber," ").concat(t.type)),this.sendAvailableData(r[n]);}catch(i){this.log.trace("ERROR ".concat(t.segmentNumber," ").concat(t.type),i);}}}])&&xe(e.prototype,t),r&&xe(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r;}();function w(e){return (w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _e(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function Ue(n){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?_e(Object(i),!0).forEach(function(e){var t,r;t=n,r=i[e=e],(e=Be(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r;}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):_e(Object(i)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e));});}return n}function je(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Be(n.key),n);}}function Be(e){e=function(e,t){if("object"!=w(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=w(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==w(e)?e:e+""}var Fe=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger"),this.counterSeg=0,this.currentRequests={};}return e=t,(r=[{key:"reset",value:function(){try{clearInterval(this.interval);}catch(e){}}},{key:"forceAbonnement",value:function(e){var t;this.factory.getInstance("VariableSettings").useAbonnement&&0===(t=this.factory.getInstance("AbonnementService")).getClientAbonnements().length&&t.createAbonnement(e,1);}},{key:"testAbonnement",value:function(){var e,t,r,n;return this.factory.getInstance("VariableSettings").useAbonnement?(0===(e=this.factory.getInstance("AbonnementService")).getClientAbonnements().length&&(0<(t=e.selectAbo()).length?(r="",(r=(n=this.factory.getInstance("StorageCustomDecision")).getData("peerLastBroadcast")?n.getData("peerLastBroadcast"):r)===t[0].uuid&&this.factory.getInstance("AnalyticsService").addHelpMetrics("NBAbo"),e.createAbonnement(t[0].uuid,1)):this.factory.getInstance("AnalyticsService").addHelpMetricsNbr("first_noR",1)),[]):null}},{key:"lowLatAbonnement",value:function(e){var t=this.factory.getInstance("AbonnementService");return 0===t.getClientAbonnements().length&&t.createAbonnement(e,1),e}},{key:"getPeersToAsk",value:function(){var P=this,D=0<arguments.length&&arguments[0]!==undefined?arguments[0]:{videoID:videoID,mediaType:mediaType,segmentNumber:segmentNumber,quality:quality,timeout:timeout},T=this;return new Promise(function(i,r){var e=!1,a=P.factory.getInstance("GeneralSettings"),o=P.factory.getInstance("AnalyticsService"),t=P.factory.getInstance("AbonnementService"),s=P.factory.getInstance("StorageCustomDecision"),n=P.factory.getInstance("VariableSettings"),c=P.factory.getInstance("PeerListStorage"),u=P.factory.getInstance("PeerInfosStorage"),l=t.getClientAbonnements();if(a.lowLatency&&"push_infos"===a.lowLatencyMode)if(0===Object.keys(t.currentPeers).length){var f=P.factory.getInstance("PeerListStorage").getListPeerInfos();if(0<l.length&&!e)e=!0,P.log.debug("[Decision] Peer selected by abonnement :",l[0].uuid),o.addHelpMetrics("abo"),i({success:!0,peer:l[0].uuid});else for(var d in f)if(f[d].connected&&f[d].currentSegment&&f[d].currentSegment[D.mediaType]){for(var p in f[d].currentSegment[D.mediaType])if(f[d].currentSegment[D.mediaType][p].segmentNumber===D.segmentNumber&&f[d].currentSegment[D.mediaType][p].quality===D.quality){e=!0,T.lowLatAbonnement(d),i({success:!0,peer:d});break}if(e)break}e||i({success:!1,peer:null});}else i({success:!1,peer:null});else if(a.lowLatency&&"strict_seeding"===a.lowLatencyMode)if(0===Object.keys(t.currentPeers).length){var y=P.factory.getInstance("PeerListStorage").getListPeerInfos();if(0<l.length&&!e)e=!0,P.log.debug("Selected by abo :",l[0].uuid,D.segmentNumber),o.addHelpMetrics("abo"),i({success:!0,peer:l[0].uuid});else {var g,h,m=[];for(g in y)y[g].connected&&y[g].seed&&m.push(g),0<m.length&&(h=m[Math.floor(Math.random()*m.length)],e=!0,T.lowLatAbonnement(h),i({success:!0,peer:g}));}e||i({success:!1,peer:null});}else i({success:!1,peer:null});else if(0<l.length&&!e)e=!0,P.log.debug("Selected by abo :",l[0].uuid,D.segmentNumber),o.addHelpMetrics("abo"),o.addHelpMetrics("S3O"),i({success:!0,peer:l[0].uuid,type:"abo"});else {if("video"!==D.mediaType||n.selectAbonnementFromBroadcast||P.testAbonnement(),!e&&n.useKnowledge){t=c.getAvailableSegment(D.mediaType,D.segmentNumber,D.quality,!0);if(0<t.length&&1<t[0].r)return e=!0,P.log.debug("Selected by knowledge :",t[0].peerID,D.segmentNumber),o.addHelpMetrics("S7O"),void i({success:!0,peer:t[0].peerID,type:"broadcast"});if(o.addHelpMetrics("S7N"),n.useAnticipatedKnowledge&&!e){var b=null,v=c.getAvailableSegment(D.mediaType,D.segmentNumber-1,null,!0),l=u.getInfoSent(D.mediaType,D.segmentNumber-1);if(l){v.push(Ue({peerID:u.uuid,me:!0},l)),v.sort(function(e,t){return e.timestamp-t.timestamp}),P.log.debug("selected",v);for(var S=v.findIndex(function(e){return e.me}),w=0;w<S;w++)if(v[w].r>S-w){b=v[w];break}}if(b)return e=!0,P.log.debug("Selected by anticipated knowledge :",b.peerID,D.segmentNumber),o.addHelpMetrics("S8O"),void i({success:!0,peer:b.peerID,type:"broadcast"});o.addHelpMetrics("S8N");}}if(!e)if(n.useBroadcast){P.counterSeg=0,o.addHelpMetrics("S3N");try{o.addHelpMetricsNbr("S4N_t",D.timeout),o.addHelpMetricsNbr("NBCo",P.factory.getInstance("PeerListService").getListByConnectedPeers().length);}catch(I){}P.broadcastRequest(D,!0).then(function(e){if(e.success)o.addHelpMetrics("broad"),e.type="broadcast",o.addHelpMetrics("S4O+"),P.log.debug("Selected by broadcast :",e.peer,D.segmentNumber);else {if(e.timeout&&0===e.nbrReceived){o.addHelpMetrics("S4N");try{var t=s.getData("maxS4N")||0;s.setData("maxS4N",t+1),o.addHelpMetricsNbr("S4N_max",s.getData("maxS4N"));}catch(I){}try{for(var r=P.factory.getInstance("PeerListService").getListByConnectedPeers(),n=0;n<r.length;n++)o.addHelpMetrics("S4N_n"),r[n].ping&&r[n].ping<1e3&&o.addHelpMetrics("S4N_psm"),r[n].ping&&1e3<=r[n].ping&&o.addHelpMetrics("S4N_plg"),r[n].ping||o.addHelpMetrics("S4N_pno"),r[n].lastMessageDate&&(new Date).getTime()-r[n].lastMessageDate.getTime()<3e4&&o.addHelpMetrics("S4N_dsm"),r[n].lastMessageDate&&3e4<=(new Date).getTime()-r[n].lastMessageDate.getTime()&&o.addHelpMetrics("S4N_dlg"),r[n].lastMessageDate||o.addHelpMetrics("S4N_dno");}catch(I){}}else {o.addHelpMetrics("S4O-");try{0<e.nbrReceived&&o.addHelpMetricsNbr("S4O-_percent",Math.round(e.nbrReceived/e.nbrTotal*100));}catch(I){}}o.addHelpMetrics("nobroad"),P.log.debug("Not selected by broadcast",D.segmentNumber);}a.lowLatency||i(e);})["catch"](function(e){o.addHelpMetrics("S4N");try{var t=s.getData("maxS4N")||0;s.setData("maxS4N",t+1),o.addHelpMetricsNbr("S4N_max",s.getData("maxS4N"));}catch(e){}a.lowLatency||r(e);}),a.lowLatency&&i({success:!1,peer:null});}else P.log.debug("No peer selected",D.segmentNumber),i({success:!1,peer:null});}})}},{key:"broadcastRequest",value:function(){var v=this,S=0<arguments.length&&arguments[0]!==undefined?arguments[0]:{videoID:videoID,mediaType:mediaType,segmentNumber:segmentNumber,quality:quality,timeout:timeout},w=1<arguments.length?arguments[1]:undefined;return new Promise(function(a,e){var o=v.factory.getInstance("ScoreService"),s=v.factory.getInstance("PeerListStorage"),c=v.factory.getInstance("PeerListService"),t=v.factory.getInstance("Message"),u=v.factory.getInstance("StorageCustomDecision"),l=v.factory.getInstance("VariableSettings"),r=v.factory.getInstance("GeneralSettings"),f=v.factory.getInstance("AnalyticsService"),d=ie(),p=(v.currentRequests[d]={},null),y=0,g=0,h=function h(e,t,r){if(e&&v.currentRequests[d]&&v.currentRequests[d][e]){v.currentRequests[d][e].received=!0;var n,e=s.getPeerFromList(t),i=!0;for(n in v.currentRequests[d])v.currentRequests[d][n].received||(i=!1);y++,1===e.ip&&(r.r=r.r*l.ipRFactor),v.log.debug("Broadcast resp",r),v.factory.getInstance("PeerDataService").addBroadcastAnswer(t,S.segmentNumber,S.quality,S.mediaType,r.buf,r.pos,r.qa,r.r,r.sr,r.st,r.ste),r.hasOwnProperty("pos")&&"video"===S.mediaType&&(s.updatePeerFromList(t,{pos:r.pos,st:r.st,ste:r.ste,buf:r.buf,r:c.getAppropriateResource(t,r.r)}),o.computeScores()),f.addHelpMetrics("S4"),(1===r.sr||2===r.sr)&&c.getAppropriateResource(t,r.r)<1&&(f.addHelpMetrics("S4No"),f.addHelpMetrics("S4_noR")),1!==r.sr&&2!==r.sr&&(f.addHelpMetrics("S4No"),f.addHelpMetrics("S4_noSeg")),(1===r.sr||2===r.sr)&&1<=c.getAppropriateResource(t,r.r)?((w||i)&&u.setData("peerLastBroadcast",t),i&&(delete v.currentRequests[d],"video"!==S.mediaType||l.selectAbonnementFromBroadcast||v.testAbonnement()),(w||i)&&(clearTimeout(p),a({success:!0,peer:t,reason:"peer_found",nbrReceived:y,nbrTotal:g}))):i&&("video"!==S.mediaType||l.selectAbonnementFromBroadcast||v.testAbonnement(),delete v.currentRequests[d],clearTimeout(p),a({success:!1,peer:null,reason:"no_peer",nbrReceived:y,nbrTotal:g}));}else clearTimeout(p),a({success:!1,peer:null,timeout:!0,reason:"timeout",nbrReceived:y,nbrTotal:g});},n={type:"fileAvailability",videoID:S.videoID,mediaType:S.mediaType,segmentNumber:S.segmentNumber,quality:S.quality},i=(r.lowLatency&&(n.latency=v.factory.getInstance("PlayerService").liveDelay()),t.sendAll(n,h));try{message.sendAll({type:"ping"});}catch(b){}for(var m=0;m<i.length;m++)i[m].success&&(v.currentRequests[d][i[m].requestID]={received:!1,request:i[m]},g++);0===Object.keys(v.currentRequests[d]).length?a({success:!1,peer:null,reason:"no_request"}):p=setTimeout(h,S.timeout);})}},{key:"removePeerFromRequests",value:function(e){var t,r=!1,n=[];for(t in this.currentRequests){var i,r=!0,a=[];for(i in this.currentRequests[t])this.currentRequests[t][i].request.peerID===e?a.push(i):this.currentRequests[t][ids].received||(r=!1);for(var o=0;o<a.length;o++)delete this.currentRequests[t][a[o]];r&&n.push(t);}for(var s=0;s<n.length;s++)delete this.currentRequests[n[s]];}}])&&je(e.prototype,r),n&&je(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function I(e){return (I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function He(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=I(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=I(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==I(e)?e:e+""}(n.key),n);}}var Ge=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger"),this.resourceReserved=0,this.currentPeers={},this.clientAbonnement=[],this.noPeerToSelect=!1;}return e=t,(r=[{key:"setNoPeerToSelect",value:function(e){this.noPeerToSelect=e;}},{key:"getNoPeerToSelect",value:function(){return this.noPeerToSelect}},{key:"reset",value:function(){try{clearInterval(this.interval);}catch(e){}}},{key:"getAvailableResources",value:function(){var e=this.factory.getInstance("PeerInfosStorage");return Math.round(100*(e.getSendableSegments()-this.resourceReserved))/100}},{key:"reserveResource",value:function(e,t){this.currentPeers[e]=t,this.resourceReserved+=t;}},{key:"freeResource",value:function(e,t){!this.currentPeers.hasOwnProperty(e)||"number"!=typeof(t=t||this.currentPeers[e])||isNaN(t)||(this.currentPeers[e]=t,this.resourceReserved-=t,delete this.currentPeers[e]);}},{key:"addClientAbonnement",value:function(e){this.clientAbonnement.push(e);}},{key:"removeClientAbonnement",value:function(t){var e=this.clientAbonnement.findIndex(function(e){return e===t});-1<e&&this.clientAbonnement.splice(e,1);}},{key:"getClientAbonnements",value:function(e){var t=this.factory.getInstance("PeerListStorage").getPeersFromList(this.clientAbonnement);return t.sort(function(e,t){return t.score-e.score}),t}},{key:"removeAllAbonnements",value:function(e){this.removeClientAbonnement(e),this.freeResource(e);}},{key:"createAbonnement",value:function(e,t){var n=this,r=this.factory.getInstance("Message"),t={type:"aboRequest",resource:t===undefined?1:t},i=function i(e,t,r){r.success||n.removeClientAbonnement(t);};this.currentPeers.hasOwnProperty(e)||(this.addClientAbonnement(e),r.sendMessage(e,t,i));}},{key:"revokeAbonnement",value:function(e){var n,i=this;(this.currentPeers.hasOwnProperty(e)||-1<this.clientAbonnement.indexOf(e))&&(n=function n(e,t,r){i.removeAllAbonnements(t);},this.factory.getInstance("Message").sendMessage(e,{type:"cancelAbo"},n),this.removeAllAbonnements(e));}},{key:"selectAbo",value:function(){var e=this.factory.getInstance("PeerListService"),t=this.factory.getInstance("Message"),r=e.getListByScore(),n=this.factory.getInstance("PeerInfosStorage"),i=(this.factory.getInstance("AnalyticsService"),!1),a=[],o=!0;0===r.length&&(o=!1);for(var s=0;s<r.length;++s){if(r[s].pos==undefined||null==r[s].pos){o=!1;break}if(0<r[s].pos&&(i=!0),0!==r[s].pos){o=!1;break}if(1===r[s].pos&&r[s].r>n.sendableSegments-this.reserveResource){o=!1;break}if(1===r[s].pos&&r[s].r===n.sendableSegments-this.reserveResource&&r.peerID>n.uuid){o=!1;break}}if(i||this.factory.getInstance("AnalyticsService").addHelpMetricsNbr("first",1),o&&!this.noPeerToSelect)this.noPeerToSelect=!0,t.sendAll({type:"notifyFirst"});else if(!o){this.noPeerToSelect=!1;for(var c=0;c<r.length;c++)if(0<r[c].score&&0<r[c].pos){a.push(r[c]);break}}return a}}])&&He(e.prototype,r),n&&He(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function P(e){return (P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ve(e,t){return function(e){if(Array.isArray(e))return e}(e)||Ke(e,t)||function(e,t){{var r;if(e)return "string"==typeof e?ze(e,t):"Map"===(r="Object"===(r={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ze(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Ke(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,o,s=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1;}else for(;!(c=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,i=e;}finally{try{if(!c&&null!=r["return"]&&(o=r["return"](),Object(o)!==o))return}finally{if(u)throw i}}return s}}function Xe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=P(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=P(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==P(e)?e:e+""}(n.key),n);}}var Qe=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger");}return e=t,(r=[{key:"reset",value:function(){}},{key:"computePosScore",value:function(e){return 0===e?-25:1===e?0:2===e?25:50}},{key:"computeStScore",value:function(e){return e&&0<=e?-5*e:0}},{key:"computeBuffScore",value:function(e){return 0}},{key:"computeRScore",value:function(e,t){return 1===(t=t||0)&&1<=e?51+5*e:e<=1?-50:e<=2?-10:5*e}},{key:"computeScores",value:function(){for(var e=this.factory.getInstance("PeerListStorage"),t=e.getListPeerInfos(),r=0,n=0,i=Object.entries(t);n<i.length;n++){var a,o=Ve(i[n],2),o=(o[0],o[1]);o.hasOwnProperty("pos")&&o.hasOwnProperty("buf")&&o.hasOwnProperty("r")&&(a=this.computePosScore(o.pos)+this.computeBuffScore(o.buf)+this.computeStScore(o.st)+this.computeRScore(o.r,o.ip),e.updatePeerFromList(o.uuid,{score:a}),this.factory.getInstance("PeerDataService").addScoreToLink(o.uuid,a),r++);}this.factory.getInstance("AnalyticsService").addHelpMetricsNbr("NBInfo",r);}},{key:"resetScores",value:function(){var e,t=this.factory.getInstance("PeerListStorage").getList();for(e in t)delete t[e].value.pos,delete t[e].value.st,delete t[e].value.buf,delete t[e].value.r,delete t[e].value.score;}}])&&Xe(e.prototype,r),n&&Xe(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function D(e){return (D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function We(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=D(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=D(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==D(e)?e:e+""}(n.key),n);}}var Ye=function(){function n(e,t){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");var r=this,t=(r.factory=t,r.factory);r.factory.setInstance("PeerListStorage",new Se(t)),r.factory.setInstance("PeerInfosStorage",new he(t)),r.factory.setInstance("FileRequestStorage",new Ee(t)),r.factory.setInstance("BlackListStorage",new ke(t)),r.factory.setInstance("BlackListPeerStorage",new ke(t)),r.factory.setInstance("VideoStorage",new Me(t)),r.factory.setInstance("Tracker",new re(t,e)),r.factory.setInstance("PeerConnection",new be(t)),r.factory.setInstance("Message",new Re(t)),r.factory.setInstance("SendVideoData",new Ce(t)),r.factory.setInstance("PeerListService",new Oe(t)),r.factory.setInstance("AbonnementService",new Ge(t)),r.factory.setInstance("PeerSelectionService",new Fe(t)),r.factory.setInstance("ScoreService",new Qe(t));}return e=n,(t=[{key:"getVideoStorage",value:function(){return this.factory.getInstance("VideoStorage")}},{key:"getMyPeerID",value:function(){return this.factory.getInstance("PeerInfosStorage").getUuid()}},{key:"getMyGroup",value:function(){return this.factory.getInstance("PeerInfosStorage").getGroup()}},{key:"getMySegmentNumber",value:function(){return this.factory.getInstance("PeerInfosStorage").getSegmentNumber()}},{key:"getMyAudioSegmentNumber",value:function(){return this.factory.getInstance("PeerInfosStorage").getAudioSegmentNumber()}},{key:"sendSegmentNumber",value:function(){return this.factory.getInstance("PeerInfosStorage").sendSegmentNumber()}},{key:"getMyDownload",value:function(){return this.factory.getInstance("PeerInfosStorage").getDownload()}},{key:"groupRequest",value:function(e){this.factory.getInstance("Tracker").groupRequest(e);}},{key:"isSupported",value:function(){return this.factory.getInstance("PeerConnection").testAvailability()}},{key:"sendMessage",value:function(e,t,r){return this.factory.getInstance("Message").sendMessage(e,t,r)}},{key:"on",value:function(e,t){return this.factory.getInstance("Events").on(e,t)}},{key:"off",value:function(e,t,r){this.factory.getInstance("Events").off(e,t,r);}}])&&We(e.prototype,t),r&&We(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r;}();function T(e){return (T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=T(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=T(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==T(e)?e:e+""}(n.key),n);}}var Je=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger"),this.callbacks=[];}return e=t,(r=[{key:"reset",value:function(){this.callbacks=[];}},{key:"on",value:function(e,t){var r=ie();return this.callbacks.push({eventName:e,callback:t,listenerID:r}),r}},{key:"off",value:function(t,r,n){var e;n?-1<(e=this.callbacks.findIndex(function(e){return e.eventName===t&&e.listenerID===n}))&&this.callbacks.splice(e,1):-1<(e=this.callbacks.findIndex(function(e){return e.eventName===t&&e.callback.toString()===r.toString()}))&&this.callbacks.splice(e,1);}},{key:"emit",value:function(t,e){var r={type:t,data:e};this.callbacks.filter(function(e){return e.eventName===t}).forEach(function(e){setTimeout(e.callback,0,r);});}},{key:"emitNow",value:function(t,e){var r={type:t,data:e};this.callbacks.filter(function(e){return e.eventName===t}).forEach(function(e){e.callback(r);});}}])&&$e(e.prototype,r),n&&$e(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function R(e){return (R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=R(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=R(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==R(e)?e:e+""}(n.key),n);}}var et=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.instances={};}return t=e,(r=[{key:"reset",value:function(){this.instances={};}},{key:"setInstance",value:function(e,t){this.instances[e]=t;}},{key:"getInstance",value:function(e){return this.instances[e]}},{key:"removeInstance",value:function(e){delete this.instances[e];}}])&&Ze(t.prototype,r),n&&Ze(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n;}();function q(e){return (q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=q(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=q(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==q(e)?e:e+""}(n.key),n);}}var rt=function(){function r(e,t){var c=this;if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");this.factory=e,this.loglevel=0,this.type="Undefined";var e=0,u={Error:"#ba0000",Infos:"#007bff",Debug:"#f98e35",Trace:"#c71585",Always:"#f98e35",Fuzz:"#ff10f0"};"number"==typeof(e=t&&t.loglevel?t.loglevel:e)&&(this.loglevel=e),"error"!==e&&"errors"!==e||(this.loglevel=1),"infos"===e&&(this.loglevel=2),"debug"===e&&(this.loglevel=3),"trace"===e&&(this.loglevel=4),t.type&&(this.type=t.type),this.log=function(e){for(var t=c.factory.getInstance("GeneralSettings").logPrefix,r=c.factory.getInstance("VariableSettings"),n=c.factory.getInstance("AnalyticsService"),i=new Date,a=arguments.length,o=new Array(1<a?a-1:0),s=1;s<a;s++)o[s-1]=arguments[s];r.useSendLogs&&n.setLogs({message:"[".concat(i.getMinutes(),":").concat(i.getSeconds(),".").concat(i.getMilliseconds(),"] ").concat(o.join(" ")),level:e,timestamp:i,sdk:"web"}),t?(r=console).log.apply(r,["%c".concat(t," %c").concat(e,": [").concat(i.getMinutes(),":").concat(i.getSeconds(),".").concat(i.getMilliseconds(),"]"),"color:#007bff","color:".concat(u[e])].concat(o)):(n=console).log.apply(n,["%c".concat(e,": [").concat(i.getMinutes(),":").concat(i.getSeconds(),".").concat(i.getMilliseconds(),"]"),"color:".concat(u[e])].concat(o));};}return e=r,(t=[{key:"always",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["Always"].concat(t));}},{key:"error",value:function error(){if(1<=this.loglevel){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["Error"].concat(t));}}},{key:"infos",value:function(){if(2<=this.loglevel){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["Infos"].concat(t));}}},{key:"debug",value:function(){if(3<=this.loglevel){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["Debug"].concat(t));}}},{key:"trace",value:function(){if(4<=this.loglevel){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["Trace"].concat(t));}}},{key:"fuzz",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.log.apply(this,["Fuzz"].concat(t));}}])&&tt(e.prototype,t),n&&tt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n;}(),nt=function(){return new Promise(function(e){e([]);})},it=function(s,e,c){return new Promise(function(e,t){var r=[],n=c.getInstance("StorageCustomDecision"),i=s.originUrl,a=c.getInstance("StorageAlternativeUrls");try{a.getData("selected")&&a.setData("default",new URL(i).origin);}catch(o){}i=i.replace(a.getData("default"),a.getData("selected")),a={mediaType:s.mediaType,serverType:"server",index:s.index,quality:s.quality,url:i,server:i,responseType:s.responseType};r.push(a);try{n.setData("lastDecisionIndexMPD",s.realNumber);}catch(o){}e(r);})},at=function(){return new Promise(function(e){e();})},ot=function(X,e,Q){return new Promise(function(U,j){var B=Q.getInstance("VariableSettings"),F=Q.getInstance("MyLogger"),H=(B.factorP2P),G=!1,V=1e3,z=.9,K=function(){try{0;var u=[],e=Q.getInstance("ManifestService").manifest,l=Q.getInstance("GeneralSettings"),f=Q.getInstance("StorageCustomDecision"),t=Q.getInstance("P2P").factory.getInstance("PeerInfosStorage"),d=Q.getInstance("AnalyticsService"),r=5;try{"video"===X.mediaType?(f.setData("video_quality",X.quality),r=Q.getInstance("BufferService").getBufferLength()):"audio"===X.mediaType&&(f.setData("audio_quality",X.quality),r=Q.getInstance("BufferService").getAudioBufferLength());}catch(x){}var p=1,n=0;if(!isNaN(X.duration)){n=X.duration;try{for(var i=e.playlists[X.quality].segments,a=[],o=i.length-1;o>=Math.max(i.length-10,0);o--)a.push(i[o].duration);var s=a.reduce(function(e,t){return e+t})/a.length,n=Math.min(s,X.duration);}catch(x){n=X.duration;}p=r/n,F.debug("[QuanteecDecision] Segment duration",n,"Buffer length",r,"Number of segments in buffer",p);}if("video"!==X.mediaType&&"audio"!==X.mediaType){var c=X.originUrl,y=Q.getInstance("StorageAlternativeUrls"),g=(.05<Math.random()&&(c=c.replace(y.getData("default"),y.getData("selected"))),{mediaType:X.mediaType,serverType:"server",index:X.realNumber,quality:X.quality,url:c,server:c,responseType:X.responseType});try{if(f.getData("lastDecisionIndexAudio")===X.realNumber)for(var h=function h(){var e=u[m],t=y.getData("alternatives"),r=(y.getData("default"),y.getData("selected"));"server"===e.serverType&&1<t.length&&((t=JSON.parse(JSON.stringify(t))).splice(t.findIndex(function(e){return e===r}),1),t=t[Math.floor(Math.random()*t.length)],e.url=e.url.replace(r,t),e.originUrl=e.url);},m=0;m<u.length;m++)h();}catch(x){}try{f.setData("lastDecisionIndexAudio",X.realNumber);}catch(x){}u.push(g),U(u);}else if("video"===X.mediaType||"audio"===X.mediaType){var b=null,v=null,S=X.quality;if("video"===X.mediaType){f.setData("videoQuality",X.quality);try{e.playlists[S].segments[0].number>X.getIndex()&&Q.getInstance("Events").emit("quanteecRestartSuggested",{reason:"Out of live window"});var w=f.getData("lastFirstSegment")||e.playlists[S].segments[0].number;e.playlists[S].segments[0].number<w-20&&l.externalLive&&Q.getInstance("Events").emit("quanteecRestartSuggested",{reason:"Out of live window"}),f.setData("lastFirstSegment",e.playlists[S].segments[0].number);}catch(x){}}else "audio"===X.mediaType&&f.setData("audioQuality",X.quality);if("video"===X.mediaType)try{v={bandwidth:e.playlists[S].attributes.BANDWIDTH,number:S};}catch(x){v={bandwidth:3e6,number:S};}else "audio"===X.mediaType&&(v={bandwidth:0,number:S});var I,b=null,P=function P(e){null===b&&f.setData("segmentNumber2"+X.mediaType,X.getIndex()),f.setData("lastSelectedPeer"+X.mediaType,b);var t,r=X.originUrl,n=Q.getInstance("StorageAlternativeUrls"),r=r.replace(n.getData("default"),n.getData("selected")),i=f.getData("lastFailed"+X.mediaType);i&&i.peer===b&&"video"===X.mediaType?("quality"===i.reason&&i.index===X.getIndex()&&(Q.getInstance("P2P").factory.getInstance("AbonnementService").revokeAbonnement(i.peer),Q.getInstance("P2P").factory.getInstance("ScoreService").resetScores()),"after"===i.reason&&i.index===X.getIndex()&&i.quality===X.quality&&(Q.getInstance("P2P").factory.getInstance("AbonnementService").revokeAbonnement(i.peer),Q.getInstance("P2P").factory.getInstance("ScoreService").resetScores()),"after"===i.reason&&i.after>X.getIndex()&&(Q.getInstance("P2P").factory.getInstance("AbonnementService").revokeAbonnement(i.peer),Q.getInstance("P2P").factory.getInstance("ScoreService").resetScores()),"before"===i.reason&&(Q.getInstance("P2P").factory.getInstance("AbonnementService").revokeAbonnement(i.peer),Q.getInstance("P2P").factory.getInstance("ScoreService").resetScores()),"loop"===i.reason&&i.index===X.getIndex()&&(Q.getInstance("P2P").factory.getInstance("AbonnementService").revokeAbonnement(i.peer),Q.getInstance("P2P").factory.getInstance("ScoreService").resetScores(),G=!0)):i&&i.peer===b&&"audio"===X.mediaType&&("quality"===i.reason&&i.index>=X.getIndex()-5&&(G=!0),"after"===i.reason&&i.index===X.getIndex()&&i.quality===X.quality&&(G=!0),"after"===i.reason&&i.after>X.getIndex()&&(G=!0),"before"===i.reason&&(G=!0),"loop"===i.reason)&&(G=!0);X.range&&(G=!0),p<=H&&null===b?d.addHelpMetrics("http_nob_nop"):p<=H?d.addHelpMetrics("http_nobuffer"):null===b&&d.addHelpMetrics("http_nopeer"),null===b||G?(t={mediaType:X.mediaType,serverType:"server",index:X.getIndex(),quality:v.number,url:r,server:r,responseType:X.responseType},X.range&&(t.range=X.range),l.lowLatency&&"push_infos"===l.lowLatencyMode&&Q.getInstance("Message").sendAll({type:"seg",mt:X.mediaType,sn:X.getIndex(),q:v.number})):t={mediaType:X.mediaType,serverType:"peer",index:X.getIndex(),quality:v.number,url:r,peer:b,responseType:X.responseType},u.push(t);try{if(f.getData("lastDecisionIndex")===X.realNumber)for(var a=function a(){var e=u[o],t=n.getData("alternatives"),r=(n.getData("default"),n.getData("selected"));if("server"===e.serverType&&1<t.length){(t=JSON.parse(JSON.stringify(t))).splice(t.findIndex(function(e){return e===r}),1);try{Math.random()<.3&&1<t.length&&t.splice(0,1);}catch(x){}t=t[Math.floor(Math.random()*t.length)];e.url=e.url.replace(r,t),e.server=e.url;}},o=0;o<u.length;o++)a();}catch(x){}try{f.setData("lastDecisionIndex",X.realNumber);}catch(x){}var s,c,i=0;try{i=(i=f.getData("numberOfSegmentsBeforeChange"))||0;}catch(x){}try{5<i?(i=0,1<(s=n.getData("alternatives")).length&&(c=s.shift(),n.setData("selected",s[Math.floor(Math.random()*s.length)]),s.unshift(c))):i+=1,f.setData("numberOfSegmentsBeforeChange",i);}catch(x){}U(u);};f.setData("segmentNumber1"+X.mediaType,X.getIndex()),G=!l.validatePrevents({segment:X.getIndex(),url:X.originUrl});try{d.addHelpMetrics("S0");var D=Q.getInstance("PeerListService").getNbrConnectedPeers();if(0===D){var T=f.getData("lastGroupRequest"),R=-1;try{T&&(R=(new Date).getTime()-T.getTime());}catch(x){}if(!l.lowLatency&&-1<R&&R<2e3&&2*H<p)return F.debug("In a new group, wait a little"),void setTimeout(K,200);G=!0,d.addHelpMetrics("S1N"),F.debug("Not selected S1N",X.getIndex());try{p<H?(q=f.getData("maxS2N")||0,f.setData("maxS2N",q+1)):(M=f.getData("maxS2O")||0,f.setData("maxS2O",M+1));var q,M,N=f.getData("maxS2N")||0,E=f.getData("maxS2O")||0,L=0;0<N+E&&(L=Math.round(N/(N+E)*100)),d.addBufferFactor(L);}catch(x){}}else {d.addHelpMetrics("S1O"),d.addHelpMetricsNbr("S1O_data",D);try{if(p<H&&!l.lowLatency&&!l.forceP2P&&B.useS2N){G=!0,d.addHelpMetrics("S2N"),F.debug("Not selected S2N",X.getIndex());try{d.addHelpMetricsNbr("S2N_data",p);var C=f.getData("maxS2N")||0;f.setData("maxS2N",C+1);}catch(x){console.error(x);}}else {d.addHelpMetrics("S2O");try{d.addHelpMetricsNbr("S2O_data",p);var _=f.getData("maxS2O")||0;f.setData("maxS2O",_+1);}catch(x){console.error(x);}}var k=f.getData("maxS2N")||0,A=f.getData("maxS2O")||0,O=0;0<k+A&&(O=Math.round(k/(k+A)*100)),d.addBufferFactor(O);}catch(x){}}}catch(x){}try{l.lowLatency?B.isSeeder=!0:(I=B.isSeeder,p>=B.factorHighSeeder?B.isSeeder=!0:p<=B.factorLowSeeder&&(B.isSeeder=!1),I!==B.isSeeder&&F.debug("Is Seeder ?",B.isSeeder));}catch(x){F.error(x);}try{if(G)d.addHelpMetrics("http"),P();else if(""!==Q.getInstance("P2P").getMyGroup()&&"waiting..."!==Q.getInstance("P2P").getMyGroup()&&t.hasBeenInGroup){try{Q.getInstance("SendVideoData").hasSubscriptionForSegment(X.mediaType,X.getIndex())&&d.addHelpMetrics("NSbef");}catch(x){}Q.getInstance("P2P").factory.getInstance("PeerSelectionService").getPeersToAsk({videoID:l.videoID,mediaType:X.mediaType,segmentNumber:X.getIndex(),quality:X.quality,timeout:Math.min(1e3,Math.min(n,r)/4*1e3)}).then(function(e){try{Q.getInstance("SendVideoData").hasSubscriptionForSegment(X.mediaType,X.getIndex())&&d.addHelpMetrics("NSaft");}catch(x){}if(e.success)X.getIndex(),X.quality,f.setData("peerAttributions",e.peer),b=e.peer,e.type&&"broadcast"===e.type?X.broadcast=!0:X.broadcast=!1;else {f.setData("peerAttributions",""),d.addHelpMetrics("http");var t=0;try{t=Q.getInstance("P2P").factory.getInstance("PeerListService").getListByConnectedPeers().length,B.selectAbonnementFromBroadcast&&Q.getInstance("PeerSelectionService").testAbonnement();}catch(x){}0<t?(t="http_nopeerres",e.reason&&(t+=e.reason),d.addHelpMetrics("http_nopeerres"),d.addHelpMetrics(t)):d.addHelpMetrics("http_nopeerco");}P();})["catch"](function(e){try{Q.getInstance("SendVideoData").hasSubscriptionForSegment(X.mediaType,X.getIndex())&&d.addHelpMetrics("NSaft");}catch(e){}d.addHelpMetrics("http"),d.addHelpMetrics("http_error"),P();});}else l.p2pOptimizedStart&&!l.lowLatency&&!t.hasBeenInGroup&&z*n<r&&"video"===X.mediaType?setTimeout(K,Math.min(V,r-z*n)):(d.addHelpMetrics("http"),t.hasBeenInGroup?d.addHelpMetrics("http_nogroup"):(t.hasBeenInGroup,d.addHelpMetrics("http_nogroup_init")),P());}catch(x){F.error(x);}}}catch(x){j(x);}};K();})},st=function($,J,Z){return new Promise(function(t,C){var r=[],e=Z.getInstance("MyLogger"),n=[],i=!1,a=!1;try{var o=Z.getInstance("AnalyticsService");if(("video"===$.inputRequest.mediaType||"audio"===$.inputRequest.mediaType)&&!$.isAbort){var s,c=$.inputRequest,u=Z.getInstance("GeneralSettings"),l=Z.getInstance("VariableSettings"),f=0,d=("video"===c.mediaType?f=Z.getInstance("BufferService").getBufferLength():"audio"===c.mediaType&&(f=Z.getInstance("BufferService").getAudioBufferLength()),{noServer:!0,oneOver:!1,targetQualityOver:!1,overhead:!1,overheadOver:!1}),p=null,y=c.originUrl,_=Z.getInstance("StorageAlternativeUrls"),y=y.replace(_.getData("default"),_.getData("selected"));for(s in $.requests){var g=$.requests[s],p=g;g.isOver&&g.isSuccess&&(d.oneOver=!0),"server"===g.request.serverType&&(d.noServer=!1);}var h=c.duration;try{if(1===u.indexDiff.video){for(var m=Z.getInstance("ManifestService").manifest.playlists[c.quality].segments,b=[],v=m.length-1;v>=Math.max(m.length-10,0);v--)b.push(m[v].duration);var U,j=b.reduce(function(e,t){return e+t})/b.length,h=Math.min(j,c.duration);0<m.length&&(U=m[m.length-1]).uri&&0<=c.originUrl.indexOf(U.uri)&&(a=!0);}}catch(O){h=c.duration;}if(u.lowLatency){var S,w,B=l.longFactorLL,I=$.requests[J],F=I.progress&&I.progress.reason,H=I.loader&&I.loader.startDate&&(new Date).getTime()-I.loader.startDate.getTime()>1e3*c.duration*B,G=Z.getInstance("PlayerService").getBufferState();d.noServer&&(F||-1===G||H)&&(e.infos("[LL-P2P] Stopped request. ruleProgressReason: ".concat(F,", bufferState:").concat(G,", ruleTooLong: ").concat(H)),I.isOver||I.loader.aborted||I.loader.abort(),$.newRequestsPending||("video"===$.inputRequest.mediaType&&(Z.getInstance("P2P").factory.getInstance("AbonnementService").revokeAbonnement($.requests[J].request.peer),Z.getInstance("P2P").factory.getInstance("ScoreService").resetScores()),S=Z.getInstance("P2P").factory.getInstance("VideoStorage").getDataMissing($.inputRequest.mediaType,u.videoID,$.requests[J].request.index,$.requests[J].request.quality),w=[{start:c.progressSent,end:""}],S&&0<S.length&&S[0].start!==w[0].start&&e.debug("DIFFERENT SIZE IN PROGRESS",S[0].start,w[0].start),null===(w=0===c.progressSent?null:w)||0===w.length?(r.push({mediaType:c.mediaType,serverType:"server",index:c.getIndex(),quality:c.quality,url:y,server:y,responseType:c.responseType}),e.debug("[RULE] Low latency fallback not missing",w)):"strict_seeding"!==u.lowLatencyMode&&(w.forEach(function(e){r.push({mediaType:c.mediaType,serverType:"server",index:c.getIndex(),quality:c.quality,url:y,server:y,responseType:c.responseType,range:{start:e.start,end:e.end}});}),e.debug("[RULE] Low latency fallback missing",w))));}else {d.noServer&&1===f&&p.progress&&null!==p.progress&&p.progress.duration()>1.5*h&&((P=$.requests[J]).isOver||P.loader.aborted||P.loader.abort(),$.newRequestsPending||r.push({mediaType:c.mediaType,serverType:"server",index:c.getIndex(),quality:c.quality,url:y,server:y,responseType:c.responseType}));var P,V=l.guardFactor,z=l.guardDLFactor,D=l.longDLFactor,T=l.longFactor,R=(a&&(D=l.longDLFactorLast,T=l.longFactorLast),u.forceP2P&&(D=l.longForcedFactor,T=l.longForcedFactor),p.progress&&p.progress.reason),q=f<V*h,M=p.progress&&null!==p.progress&&null===p.progress.timeLeft()&&p.progress.duration()>D*h,N=p.progress&&null!==p.progress&&null===p.progress.timeLeft()&&f<z*h,E=p.progress&&null!==p.progress&&p.progress.duration()>T*h;if(d.noServer&&1!==f&&(R||q||N||E||M)){try{var K=p.progress?p.progress.duration():undefined,X=p.progress?p.progress.timeLeft():undefined,Q=p.progress?p.progress.bytesLoaded:0,W="[DL RULE] Selected Reason: ".concat(R," guardRule: ").concat(q,", guardDLRule: ").concat(N,", lowRule: ").concat(!1,", mediumRule: ").concat(!1,", longRule: ").concat(E,", longDLRule: ").concat(M," |||||| segmentDuration/bufferLength: ").concat(h,"/").concat(f," duration: ").concat(K,"|||||| Time Left : ").concat(X," Bytes Loaded : ").concat(Q);e.infos(W),Z.getInstance("PeerDataService").addSegmentRequested($.requests[J].request.peer,c.mediaType,c.getIndex(),c.quality,"stop");}catch(O){}o.addHelpMetrics("S5N");try{$.inputRequest.broadcast?(o.addHelpMetrics("S5N_b"),l.selectAbonnementFromBroadcast&&Z.getInstance("PeerSelectionService").testAbonnement()):o.addHelpMetrics("S5N_a");}catch(O){}try{p.progress&&null!==p.progress&&p.progress.duration()>h&&(o.addHelpMetrics("S5N-"),$.inputRequest.broadcast?o.addHelpMetrics("S5N-_b"):o.addHelpMetrics("S5N-_a"));}catch(O){}q&&l.increaseP2PFactor();var L=$.requests[J];if(L.isOver||L.loader.aborted||L.loader.abort(),!$.newRequestsPending)if($.inputRequest&&$.inputRequest.broadcast&&o.addHelpMetrics("NBFail"),"video"===$.inputRequest.mediaType&&(Z.getInstance("P2P").factory.getInstance("AbonnementService").revokeAbonnement($.requests[J].request.peer),Z.getInstance("P2P").factory.getInstance("ScoreService").resetScores()),l.useRetryP2P&&(R&&-1===["loop","disco"].indexOf(R)||M)&&(!ee()($,"numberP2PRetry")||$.numberP2PRetry<2))i=!0,$.waitingForRequests=!0,Z.getInstance("DecisionManager").startDecision("before","segment",$.inputRequest).then(function(e){$.waitingForRequests=!1,$.numberP2PRetry=$.numberP2PRetry||0,$.numberP2PRetry+=1,0<e.length&&"server"===e[0].serverType&&o.addHelpMetrics("S6O"),t(e);})["catch"](function(e){$.waitingForRequests=!1,o.addHelpMetrics("S6O"),t([{mediaType:c.mediaType,serverType:"server",index:c.getIndex(),quality:c.quality,url:y,server:y,responseType:c.responseType}]);});else {var k=Z.getInstance("P2P").factory.getInstance("VideoStorage").getDataMissing($.inputRequest.mediaType,u.videoID,$.requests[J].request.index,$.requests[J].request.quality);if(R&&("invalid"===R||"disco"===R&&Z.getInstance("BlackListPeerStorage").hasInBlacklist($.requests[J].request.peer))){k=null;try{p&&p.progress&&1===p.progress.depth&&"disco"!==R&&(Z.getInstance("BlackListPeerStorage").putBlackList($.requests[J].request.peer),n.push($.requests[J].request.peer)),Z.getInstance("SendVideoData").invalidateSubscription(u.videoID,$.inputRequest.mediaType,$.requests[J].request.index,$.requests[J].request.quality),Z.getInstance("P2P").factory.getInstance("VideoStorage").deleteQuality($.inputRequest.mediaType,u.videoID,$.requests[J].request.index,$.requests[J].request.quality);}catch(O){}}if(!$.newRequestsPending&&(!q||q||$.inRetry))if(!l.useMissingData&&k&&0<=k.length&&(e.debug("Missing data",k),k=null,Z.getInstance("P2P").factory.getInstance("VideoStorage").deleteQuality($.inputRequest.mediaType,u.videoID,$.requests[J].request.index,$.requests[J].request.quality),Z.getInstance("SendVideoData").removeSubscriptions(u.videoID,$.inputRequest.mediaType,$.requests[J].request.index,$.requests[J].request.quality),e.debug("Missing data deleting",$.inputRequest.mediaType,u.videoID,$.requests[J].request.index,$.requests[J].request.quality)),null===k||0===k.length){o.addHelpMetrics("S6O");try{$.inputRequest.broadcast?o.addHelpMetrics("S6O_b"):o.addHelpMetrics("S6O_a");}catch(O){}try{if(p.progress&&null!==p.progress&&p.progress.duration()>h){o.addHelpMetrics("S6O-");try{$.inputRequest.broadcast?o.addHelpMetrics("S6O-_b"):o.addHelpMetrics("S6O-_a");}catch(O){}}var Y=customStorage.getData("maxS60")||0;customStorage.setData("maxS6O",Y+1),o.addHelpMetricsNbr("S6O_max",customStorage.getData("maxS6O"));}catch(O){}q?(o.addHelpMetrics("guardTotal"),o.addAbandonP2P("guardTotal")):N?(o.addHelpMetrics("guardDLTotal"),o.addAbandonP2P("guardDLTotal")):E?(o.addHelpMetrics("longTotal"),o.addAbandonP2P("longTotal")):M?o.addHelpMetrics("longDLTotal"):(o.addHelpMetrics("unknowTotal"),o.addAbandonP2P("unknowTotal")),r.push({mediaType:c.mediaType,serverType:"server",index:c.getIndex(),quality:c.quality,url:y,server:y,responseType:c.responseType});}else {o.addHelpMetrics("S6N");try{$.inputRequest.broadcast?o.addHelpMetrics("S6N_b"):o.addHelpMetrics("S6N_a");}catch(O){}try{if(p.progress&&null!==p.progress&&p.progress.duration()>h){o.addHelpMetrics("S6N-");try{$.inputRequest.broadcast?o.addHelpMetrics("S6N-_b"):o.addHelpMetrics("S6N-_a");}catch(O){}}}catch(O){}q?(o.addHelpMetrics("guardPartial"),o.addAbandonP2P("guardPartial")):N?(o.addHelpMetrics("guardDLPartial"),o.addAbandonP2P("guardDLPartial")):E?(o.addHelpMetrics("longPartial"),o.addAbandonP2P("longPartial")):M?o.addHelpMetrics("longDLPartial"):(o.addHelpMetrics("unknowPartial"),o.addAbandonP2P("unknowPartial")),k.forEach(function(e){r.push({mediaType:c.mediaType,serverType:"server",index:c.getIndex(),quality:c.quality,url:y,server:y,responseType:c.responseType,range:{start:e.start,end:e.end}});});}}}}}}catch(x){e.error(x);}for(var A=0;A<n.length;A++)Z.getInstance("PeerConnection").disconnect(n[A]);(0<r.length||i)&&($.newRequestsPending=!0),i?e.trace("[DL] Waiting for new request"):t(r);})},ct=function(N,E,L){return new Promise(function(e,t){try{var r,n,i=N.inputRequest,a=L.getInstance("ManifestService").manifest,o=L.getInstance("StorageCustomDecision"),s=o.getData("videoDurationDownloaded")||0,c=L.getInstance("GeneralSettings"),u=L.getInstance("VariableSettings"),l=L.getInstance("AnalyticsService"),f=L.getInstance("P2P").factory.getInstance("PeerInfosStorage"),d=L.getInstance("P2P").factory.getInstance("PeerListService"),p=(L.getInstance("P2P").factory.getInstance("PeerListStorage"),3e6),y="";if("video"===i.mediaType){if(E.allOver){var g,h=i.quality,m=0,b=!1;for(g in isNaN(i.getIndex())||f.setSegmentNumber(i.getIndex()),N.requests){var v,S=N.requests[g];"server"!==S.request.serverType||S.request.url&&(S.request.url,-1!==S.request.url.indexOf("not_found"))||(v="result",null!==S.result?v="result":S.progress&&null!==S.progress&&(v="progress"),S[v]&&(c.lowLatency&&S[v].lowLatencyManager?m+=S[v].lowLatencyManager.computeThroughput():m+=S[v].estimatedBandwidth()),S.request.serverType&&"server"===S.request.serverType&&(b=!0)),S.request.serverType;}b&&(f.setDownload(m),f.setUpload(.8*m*c.maxUploadPercent));try{l.addHelpMetricsNbr("DL",m);}catch(M){}try{var w=a.playlists[i.quality].attributes.BANDWIDTH;try{a.playlists[i.quality].attributes["AVERAGE-BANDWIDTH"]&&0<Number(a.playlists[i.quality].attributes["AVERAGE-BANDWIDTH"])&&(w=Number(a.playlists[i.quality].attributes["AVERAGE-BANDWIDTH"]));}catch(M){}0===(p=w)&&(p=3e6);var I,P=Math.floor(f.getUpload()/p*100)/100;try{for(o.setData("sendableSegments",o.getData("sendableSegments")||[]),P!==Infinity?o.getData("sendableSegments").push(P):L.getInstance("MyLogger").debug("Infinity:",p,m,f.getUpload());5<o.getData("sendableSegments").length;)o.getData("sendableSegments").shift();P=o.getData("sendableSegments").reduce(function(e,t){return e+t},0)/o.getData("sendableSegments").length;}catch(M){}c.lowLatency&&P<0&&(P=1);try{u.getFromGreenScore()&&100<=(I=l.greenScore())&&(P=Math.round(I)/100,L.getInstance("MyLogger").debug("Sendable segments from GS:",P));}catch(M){}(P=c.isFileMode?3:P)&&P<0&&(P=0),f.setSendableSegments(P),L.getInstance("PeerDataService").setR(P),L.getInstance("MyLogger").debug("Sendable segments:",P);try{l.addHelpMetricsNbr("SendSeg",P);}catch(M){}}catch(M){var D=0;c.isFileMode&&(D=3),f.setSendableSegments(D),L.getInstance("PeerDataService").setR(D),L.getInstance("MyLogger").debug("Sendable segments:",D);try{l.addHelpMetricsNbr("SendSeg",D);}catch(M){}}f.bitrate=p,isNaN(i.duration)||(s+=i.duration,o.setData("videoDurationDownloaded",s)),h===L.getInstance("P2P").factory.getInstance("PeerInfosStorage").getGroupTargetQuality()&&""!==L.getInstance("P2P").getMyGroup()&&o.setData("missedTargetQuality",0);var T=L.getInstance("P2P").factory.getInstance("BlackListStorage");if(T.eraseOld(),o.getData("lastGroupRequest")&&25e3<(new Date).getTime()-o.getData("lastGroupRequest").getTime())if(0===d.getListByConnectedPeers().length){try{l.newg_co+=1;}catch(M){}f.mustReaffectGroup=!0,T.putBlackList(L.getInstance("P2P").getMyGroup());}else if(d.getListByConnectedPeers().length<=5&&3e4<(new Date).getTime()-o.getData("lastGroupRequest").getTime()){f.mustReaffectGroup=!0;try{l.newg_5+=1;}catch(M){}}else if(!l.p2pLastPeriod()){f.mustReaffectGroup=!0;try{l.newg_p2p+=1;}catch(M){}y=L.getInstance("P2P").getMyGroup(),T.putBlackList(L.getInstance("P2P").getMyGroup());}l.p2pLastPeriod(),l.resetP2PLastPeriod();try{h!==f.getGroupTargetQuality()&&""!==L.getInstance("P2P").getMyGroup()&&(l.newg_q+=1);}catch(M){}if(h!==f.getGroupTargetQuality()&&!c.allowQualityChangeToOptimizeP2P&&!c.ignoreGroupQuality&&""!==L.getInstance("P2P").getMyGroup()||f.mustReaffectGroup){var R=o.getData("missedTargetQuality")||0,q=(o.getData("maxMissedTargetQuality")||i.duration,o.setData("missedTargetQuality",R+i.duration),0===f.getUpload()&&f.setUpload(Math.min(m/3,15e6)),L.getInstance("MyLogger").debug("Estimated upload bandwith 1: ".concat(f.getUpload()," bps")),{bitrate:p,targetQuality:c.allowQualityChangeToOptimizeP2P||c.ignoreGroupQuality?9999:i.quality,DL:f.getDownload(),UL:c.shouldSend()?f.getUpload():0,currentSegmentNumber:f.getSegmentNumber()});try{u.useBlacklist?q.blackList=T.getBlackList()||[]:q.blackList=[];}catch(M){}y&&T.deleteBlackList(y),L.getInstance("P2P").groupRequest(q),o.setData("missedTargetQuality",0),f.mustReaffectGroup=!1;}1<=s&&""===L.getInstance("P2P").getMyGroup()&&c.activated&&(0===f.getUpload()&&f.setUpload(Math.max(m/3,15e6)),L.getInstance("MyLogger").debug("Estimated upload bandwith 2: ".concat(f.getUpload()," bps")),l.newg_f+=1,L.getInstance("P2P").groupRequest({bitrate:p,targetQuality:c.allowQualityChangeToOptimizeP2P||c.ignoreGroupQuality?9999:i.quality,DL:f.getDownload(),UL:c.shouldSend()?f.getUpload():0,currentSegmentNumber:f.getSegmentNumber()}),f.mustReaffectGroup=!1);}}else "audio"===i.mediaType&&(r=i.realNumber,n=L.getInstance("P2P").factory.getInstance("PeerInfosStorage"),isNaN(r)||n.setAudioSegmentNumber(r));e();}catch(M){t(M);}})};function M(e){return (M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ut(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=M(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=M(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==M(e)?e:e+""}(n.key),n);}}var lt=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger"),this.decisions=null;}return e=t,(r=[{key:"initDecisions",value:function(){this.decisions={before:{segment:ot,manifest:it,data:it,init:it},progress:{segment:st,manifest:nt,data:nt,init:nt},end:{segment:ct,manifest:at,data:at,init:at}};}},{key:"startDecision",value:function(e,t,r,n){return null!==this.decisions?this.decisions[e][t](r,n,this.factory):null}}])&&ut(e.prototype,r),n&&ut(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}(),ft=e(5);function N(e){return (N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=N(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=N(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==N(e)?e:e+""}(n.key),n);}}var L=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.success=e.success,this.type=e.type,this.firstByteDate=e.firstByteDate,this.startDate=e.startDate,this.endDate=e.endDate,this.bytesLoaded=e.bytesLoaded||1,this.bytesTotal=e.bytesTotal||1,this.headers=e.headers||{},this.lowLatencyManager=e.lowLatencyManager||null,this.reason=e.reason||"",this.waitingTime=e.waitingTime||0;}return e=t,(r=[{key:"percent",value:function i(){var i=null;return i=this.bytesLoaded&&this.bytesTotal?Math.round(this.bytesLoaded/this.bytesTotal*100):i}},{key:"ttfb",value:function(){var e;return this.firstByteDate&&this.startDate?(e=this.firstByteDate.getTime()-this.startDate.getTime(),Math.max(0,Math.round((e-(this.waitingTime||0))/1e3*100)/100)):0}},{key:"estimatedBandwidth",value:function a(e){var t=this.endDate||new Date,a=null,r=1,n=this.firstByteDate||this.startDate;return "kbps"===e&&(r=1e3),"Mbps"===e&&(r=1e6),n&&this.bytesLoaded&&(e=8*this.bytesLoaded,t=(t.getTime()-n.getTime())/1e3,a=0<t?1e3*Math.round(e/t/1e3)/r:0),a}},{key:"duration",value:function(){return ((this.endDate||new Date).getTime()-this.startDate.getTime())/1e3}}])&&dt(e.prototype,r),n&&dt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function E(e){return (E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=E(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=E(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==E(e)?e:e+""}(n.key),n);}}var k=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.type=e.type,this.startDate=e.startDate,this.firstByteDate=e.firstByteDate,this.lastReportDate=e.lastReportDate,this.waitingTime=e.waitingTime||0,this.endDate=e.endDate,this.bytesLoaded=e.bytesLoaded||1,this.bytesTotal=e.bytesTotal||2,this.headers=e.headers||{},this.lowLatencyManager=e.lowLatencyManager||null,this.reason=e.reason||"",this.before=e.before||null,this.after=e.after||null,this.depth=e.depth||1;}return e=t,(r=[{key:"percent",value:function i(){var i=0;return i=this.bytesLoaded&&this.bytesTotal&&2<this.bytesTotal&&1<this.bytesLoaded?Math.round(this.bytesLoaded/this.bytesTotal*100):i}},{key:"estimatedBandwidth",value:function a(e){var t=this.lastReportDate||new Date,a=null,r=1,n=this.firstByteDate||this.startDate;return "kbps"===e&&(r=1e3),"Mbps"===e&&(r=1e6),n&&this.bytesLoaded&&(e=8*this.bytesLoaded,t=(t.getTime()-n.getTime())/1e3,a=0<t?1e3*Math.round(e/t/1e3)/r:0),a}},{key:"duration",value:function(){return ((new Date).getTime()-this.startDate.getTime())/1e3}},{key:"downloadActiveDuration",value:function(){var e=new Date,t=this.firstByteDate||this.startDate;return (e.getTime()-t.getTime())/1e3}},{key:"downloadDuration",value:function(){return ((new Date).getTime()-this.startDate.getTime())/1e3}},{key:"timeLeft",value:function(){var e;return this.bytesTotal&&this.bytesLoaded&&2<this.bytesTotal&&1<this.bytesLoaded?(e=this.bytesTotal*this.downloadDuration()/this.bytesLoaded,Math.round(1e3*(e-this.downloadDuration()))/1e3):null}},{key:"ttfb",value:function(){var e;return this.firstByteDate&&this.startDate?(e=this.firstByteDate.getTime()-this.startDate.getTime(),Math.max(0,e-(this.waitingTime||0))):0}},{key:"ttfb_all",value:function(){var e;return this.firstByteDate&&this.startDate?(e=this.firstByteDate.getTime()-this.startDate.getTime(),Math.max(0,e)):0}}])&&pt(e.prototype,r),n&&pt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function A(e){return (A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=A(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=A(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==A(e)?e:e+""}(n.key),n);}}var gt=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.measure=[],this.throughput=0,this.throughputGlobal=0,this.throughputExternal=0;}return e=t,(r=[{key:"writeMeasure",value:function(e){var t,r;0===this.measure.length?(this.startTime=(new Date).getTime(),this.measure.push({liveDelay:this.factory.getInstance("PlayerService").liveDelay(),bufferLength:this.factory.getInstance("BufferService").getBufferLength(),rate:this.factory.getInstance("PlayerService").getPlaybackRate(),durationMS:0,cumulativeDurationMS:0,bytes:0,cumulativeBytes:0,date:new Date})):(t=this.measure.length-1,r=new Date,this.measure.push({liveDelay:this.factory.getInstance("PlayerService").liveDelay(),bufferLength:this.factory.getInstance("BufferService").getBufferLength(),rate:this.factory.getInstance("PlayerService").getPlaybackRate(),durationMS:r.getTime()-this.measure[t].date.getTime(),cumulativeDurationMS:r.getTime()-this.startTime,bytes:e-this.measure[t].bytes,cumulativeBytes:e,date:r}));}},{key:"computeThroughput",value:function(){for(var e=0,t=this.measure[this.measure.length-1].cumulativeBytes,r=this.measure[this.measure.length-1].cumulativeDurationMS,n=1;n<this.measure.length;n++){var i=this.measure[n],a=this.measure[n-1];i.bufferLength+i.durationMS<a.bufferLength+a.durationMS&&(e+=i.durationMS);}return this.throughput=Math.round(8*t/(e/1e3)),this.throughputGlobal=Math.round(8*t/(r/1e3)),this.throughput}},{key:"getThroughputUnit",value:function(){var e="bps",t=this.throughput;return 1e6<t?(e="Mbps",t=Math.round(t/1e6*100)/100):1e3<t&&(e="kbps",t=Math.round(t/1e3*100)/100),t+" "+e}},{key:"getThroughputGlobalUnit",value:function(){var e="bps",t=this.throughputGlobal;return 1e6<t?(e="Mbps",t=Math.round(t/1e6*100)/100):1e3<t&&(e="kbps",t=Math.round(t/1e3*100)/100),t+" "+e}},{key:"getThroughputExternalUnit",value:function(){var e="bps",t=this.throughputExternal;return 1e6<t?(e="Mbps",t=Math.round(t/1e6*100)/100):1e3<t&&(e="kbps",t=Math.round(t/1e3*100)/100),t+" "+e}},{key:"measure2CSV",value:function(){var e,t,r="",n=!0,i=[];if(!(0<this.measure.length))return "";for(e in i=Object.keys(this.measure[0]))n?n=!1:r+=",",r+=i[e];for(t in r+="\r\n",this.measure){var a,n=!0,o=this.measure[t];for(a in i)n?n=!1:r+=",",r+=o[i[a]];r+="\r\n";}return r}}])&&yt(e.prototype,r),n&&yt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function O(e){return (O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ht(e,t){var r,n,i,a,o,s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(e);},n:function(){var e=s.next();return n=e.done,e},e:function t(e){i=!0,r=e;},f:function(){try{n||null==s["return"]||s["return"]();}finally{if(i)throw r}}};if(Array.isArray(e)||(s=function(e,t){{var r;if(e)return "string"==typeof e?mt(e,t):"Map"===(r="Object"===(r={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length)return s&&(e=s),a=0,{s:o=function o(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function t(e){throw e},f:o};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function bt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=O(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=O(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==O(e)?e:e+""}(n.key),n);}}var vt=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=e.getInstance("MyLogger"),this.aborted=!1,this.fetchObject=null,this.abortController=new AbortController,this.response=null,this.interval=null,this.outputHeaders={},this.startDate,this.HTTPRequestObject={};}return e=t,(r=[{key:"load",value:function(f,a,d){var p=this,o=this.factory.getInstance("P2P"),y=p.factory.getInstance("GeneralSettings"),g=(p.factory.getInstance("VariableSettings"),this.factory.getInstance("P2P").factory.getInstance("VideoStorage")),h=(this.factory.getInstance("StorageCustomDecision"),this.factory.getInstance("AnalyticsService")),m=0,b=0,v=d.getSegmentSize(),s=0,S=!1,w=!1,I=!1,P={mType:"time",rType:"http",first:0,end:0};return y.lowLatency&&(this.lowLatencyManager=new gt(this.factory)),v&&!f.range?(f.range=d.range,S=!0):v&&f.range&&(m=f.range.end-f.range.start,S=!0),new Promise(function(i,t){p.reject=t;var c=new Date,u=(p.startDate=c,function u(e){var t={startDate:c,lastReportDate:new Date,bytesLoaded:m,bytesTotal:s,headers:p.outputHeaders,lowLatencyManager:p.lowLatencyManager},t=new k(t);a(t,f.ID);}),l={method:"GET",signal:p.abortController.signal,redirect:"follow"};if((y.withCredentials||d.withCredentials)&&(l.credentials="include"),f.index===undefined||isNaN(f.index)||("video"===f.mediaType&&p.log.infos("Start HTTP fetch request for ".concat(f.mediaType," segment ").concat(f.index)),"audio"===f.mediaType&&p.log.infos("Start HTTP fetch request for ".concat(f.mediaType," segment ").concat(f.index))),l.headers=d.headers||{},f.range==undefined||Array.isArray(f.range)){if(f.range!=undefined&&Array.isArray(f.range)){for(var e="",r=0;r<f.range.length;++r){var n=f.range[r];r!=f.range.length-1?e+="".concat(n.start,"-").concat(n.end,", "):e+="".concat(n.start,"-").concat(n.end);}l.headers.Range="bytes=".concat(e);}}else l.headers.Range="bytes=".concat(f.range.start,"-").concat(f.range.end),S||(m=f.range.start);"WebRTS"===d.manifestType&&(l.headers["x-quanteec"]="true"),fetch(f.url,l).then(function(e){if(p.log.trace("HTTP Response",e.status),400<=e.status&&e.status<=599)throw h.addHTTPError(e.status),{status:e.status,responseRequest:e};var t,r=ht(e.headers.entries());try{for(r.s();!(t=r.n()).done;){var n=t.value;p.outputHeaders[n[0]]=n[1];}}catch(a){r.e(a);}finally{r.f();}if(e.headers.get("Content-Length")&&(v=v||Number(e.headers.get("Content-Length")),s=Number(e.headers.get("Content-Length")),I=!0),e.headers.get("Content-Range"))try{var i=e.headers.get("Content-Range").split("/")[1];f.range.end&&"number"==typeof f.range.end&&(s=f.range.end-f.range.start,I=!0),I="*"!==i&&!v&&(v=Number(i),!0);}catch(a){}return p.response=e,"206"!=p.response.status&&f.range&&(w=f.range,delete f.range,m=0),y.lowLatency&&p.lowLatencyManager.writeMeasure(0),e.url&&-1===e.url.indexOf("data:")&&e.url!==d.originUrl&&(d.originUrl=e.url),e.body}).then(function(e){var t=e.getReader();return new ReadableStream({start:function(o){!function s(){t.read().then(function(e){var t=e.done,e=e.value,r=!1;if(t)o.close();else if(o.enqueue(e),!1===p.aborted){if((0===m||f.range&&m===f.range.start)&&(r=!0),f.index===undefined||isNaN(f.index)||(!w||m+e.byteLength>w.start&&w.start<=m?g.postPartialData(f.mediaType,y.videoID,f.index,f.quality,{start:m,end:m+e.byteLength,size:e.byteLength,data:e},v,d.storageUrl):m+e.byteLength>w.start&&w.start>m&&(t=new Uint8Array(e.subarray(w.start-m)),g.postPartialData(f.mediaType,y.videoID,f.index,f.quality,{start:w.start,end:w.start+t.byteLength,size:t.byteLength,data:t},v,d.storageUrl))),m+=e.byteLength,b+=e.byteLength,y.lowLatency){if(!w||m>w.start&&w.start<=m-e.byteLength)d.progressFunction(e,p.outputHeaders);else if(m>w.start&&w.start>m-e.byteLength){try{var n=d.progressHistory[d.progressHistory.length-1],i=n[n.byteLength-1];i!==e[w.start-(m-e.byteLength)-1]&&(p.log.debug("[HTTP Range]",l.headers,d.mediaType,d.getIndex(),d.quality,"Last Range bytes",i,"CurrentValue",e[w.start-(m-e.byteLength)-2],e[w.start-(m-e.byteLength)-1],e[w.start-(m-e.byteLength)],"Start range at byte",e[w.start-(m-e.byteLength)],w.start,d.progressSent),p.log.error("[HTTP Range] Byte dcal"));}catch(a){}t=new Uint8Array(e.subarray(w.start-(m-e.byteLength))),d.progressFunction(t,p.outputHeaders);}p.lowLatencyManager.writeMeasure(b);}if(r){u();try{P.first=(new Date).getTime()-c.getTime(),h.addValue("ttfb_server",P.first);}catch(a){}}s();}})["catch"](function(e){});}();}})}).then(function(e){return ""!==f.responseType&&"text"===f.responseType?new Response(e,{headers:{"Content-Type":p.response.headers.get("Content-Type")}}).text():new Response(e,{headers:{"Content-Type":p.response.headers.get("Content-Type")}}).arrayBuffer()}).then(function(e){if(y.lowLatency&&d.isSegment&&!I&&"video"===d.mediaType)try{p.lowLatencyManager.computeThroughput();}catch(n){p.log.error(n);}clearInterval(p.interval);var t={success:!0,startDate:c,endDate:new Date,bytesLoaded:e.byteLength||e.length,bytesTotal:e.byteLength||e.length,headers:p.outputHeaders,lowLatencyManager:p.lowLatencyManager};try{P.end=(new Date).getTime()-c.getTime(),"video"===f.mediaType&&p.factory.getInstance("AnalyticsService").sendCustomAnalytics(P);}catch(n){}0===s&&(r=e.byteLength,f.range&&f.range.start&&(r+=f.range.start),g.postPartialDataSize(f.mediaType,y.videoID,f.index,f.quality,r,d.storageUrl));var r=new L(t);f.index===undefined||isNaN(f.index)||p.log.infos("End HTTP fetch request for ".concat(f.mediaType," segment ").concat(f.index," me: ").concat(o.getMyPeerID())),i({result:r,data:e});})["catch"](function(e){f.index===undefined||isNaN(f.index)||p.log.infos("Stop HTTP fetch request for ".concat(f.mediaType," segment ").concat(f.index)),clearInterval(p.interval),t(e);}),p.interval=setInterval(u,500);})}},{key:"abort",value:function(){this.aborted=!0;try{this.abortController.abort();}catch(e){}clearInterval(this.interval),this.reject();}}])&&bt(e.prototype,r),n&&bt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}(),t=e(4),St=e.n(t);function wt(e){return (wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function It(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=wt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=wt(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==wt(e)?e:e+""}(n.key),n);}}var Pt=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=e.getInstance("MyLogger"),this.cancel=St.a.CancelToken.source(),this.aborted=!1,this.outputHeaders={};}return e=t,(r=[{key:"load",value:function(s,r){var c=this;this.factory.getInstance("StorageCustomDecision");return new Promise(function(n,t){var i=c.factory.getInstance("GeneralSettings"),a=c.factory.getInstance("P2P").factory.getInstance("VideoStorage"),o=new Date,e={url:s.url,method:"get",cancelToken:c.cancel.token,responseType:""!==s.responseType?s.responseType:"text",headers:s.headers,timeout:3e4,onDownloadProgress:function(e){e={startDate:o,lastReportDate:new Date,bytesLoaded:e.loaded,bytesTotal:e.total,headers:c.outputHeaders},e=new k(e);r(e,s.ID);}};i.withCredentials&&(e.withCredentials=!0),i.manifestNoCache&&(e.headers||(e.headers={}),e.headers["Cache-Control"]="no-store, no-cache, must-revalidate, proxy-revalidate, max-age=0"),s.index===undefined||isNaN(s.index)||"video"===s.mediaType&&c.log.infos("Start HTTP request for ".concat(s.mediaType," segment ").concat(s.index)),St()(e).then(function(e){var t=0,r=(c.outputHeaders=e.headers,e.headers["content-length"]&&(t=t||Number(e.headers["content-length"]),Number(e.headers["content-length"])),e.headers["content-range"]&&(r=e.headers["content-range"].split("/")[1],s.range.end,s.range.start,"*"!==r)&&(t=t||Number(r)),{success:!0,startDate:o,endDate:new Date,bytesLoaded:e.data.byteLength||e.data.length,bytesTotal:e.data.byteLength||e.data.length,headers:c.outputHeaders}),r=new L(r);s.index===undefined||isNaN(s.index)||"video"===s.mediaType&&c.log.infos("End HTTP request for ".concat(s.mediaType," segment ").concat(s.index)),s.index===undefined||isNaN(s.index)||a.postPartialData(s.mediaType,i.videoID,s.index,s.quality,{start:0,end:0+e.data.byteLength,size:e.data.byteLength,data:e.data},t,inputRequest.storageUrl),n({result:r,data:e.data});})["catch"](function(e){e.response&&this.factory.getInstance("AnalyticsService").addHTTPError(response.status),s.index===undefined||isNaN(s.index)||"video"===s.mediaType&&c.log.infos("Stop HTTP request for ".concat(s.mediaType," segment ").concat(s.index)),t(e);});})}},{key:"abort",value:function(){this.aborted=!0,this.cancel.cancel("Download aborted by the controller");}}])&&It(e.prototype,r),n&&It(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function Dt(e){return (Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tt(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function Rt(n){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Tt(Object(i),!0).forEach(function(e){var t,r;t=n,r=i[e=e],(e=Mt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r;}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Tt(Object(i)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e));});}return n}function qt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mt(n.key),n);}}function Mt(e){e=function(e,t){if("object"!=Dt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=Dt(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==Dt(e)?e:e+""}var Nt=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=e.getInstance("MyLogger"),this.peerID="",this.requestID="",this.lastProgress=new k({}),this.aborted=!1,this.timeoutProgress=null,this.lowLatencyManager=new gt(e),this.alreadyRejected=!1,this.startDate,this.isValidatingData=!1;}return e=t,(r=[{key:"load",value:function(m,b,v){var S=this,w=this.factory.getInstance("P2P"),I=this.factory.getInstance("GeneralSettings"),P=this.factory.getInstance("VariableSettings"),D=this.factory.getInstance("AnalyticsService"),T=this.factory.getInstance("PeerListStorage"),R={mType:"time",rType:"p2p",first:0,end:0},q=3e6;try{var e=factory.getInstance("ManifestService").manifest,t=e.playlists[v.quality].attributes.BANDWIDTH;try{e.playlists[v.quality].attributes["AVERAGE-BANDWIDTH"]&&0<Number(e.playlists[v.quality].attributes["AVERAGE-BANDWIDTH"])&&(t=Number(e.playlists[v.quality].attributes["AVERAGE-BANDWIDTH"]));}catch(M){}q=t;}catch(M){}return new Promise(function(o,n){var s=new Date,c=(S.startDate=s,{}),e="",t="",r="",u=null,l=I.lowLatency?150:500,f=(S.log.infos("Start P2P request for ".concat(m.mediaType," segment ").concat(m.index)),S.factory.getInstance("PeerDataService").addSegmentRequested(m.peer,m.mediaType,m.index,m.quality,"start"),function f(){try{clearTimeout(S.timeoutProgress);}catch(M){}}),d=function d(){w.off("fileRequestStatus",null,e),w.off("fileReceived",null,t),w.off("peerConnectedRefreshed",null,r);},p=function(e,t){e=e.data;if(e.requestID===c.requestID){if(S.log.trace("[DL] PROGRESS ".concat(c.requestID," ").concat(e.bytesReceived||S.lastProgress.bytesLoaded," ").concat(e.expectedSize||S.lastProgress.bytesTotal)),null===u)if(1<(e.expectedSize||S.lastProgress.bytesLoaded)){u=new Date;try{R.first=(new Date).getTime()-s.getTime();}catch(M){}}if(f(),e.statusDetail&&(e.statusDetail,-1!==e.statusDetail.indexOf("cancelled")))if(e.statusDetail&&-1!==e.statusDetail.indexOf("cancelled")&&e.reason){S.log.trace("[DL] Cancelled reason:",e.reason);try{D.addHelpMetrics(e.reason);}catch(M){}S.factory.getInstance("StorageCustomDecision").setData("lastFailed"+m.mediaType,Rt(Rt({},m),{},{reason:e.reason,after:e.after,before:e.before}));try{factory.getInstance("P2P").factory.getInstance("AbonnementService").revokeAbonnement(m.peer),factory.getInstance("P2P").factory.getInstance("ScoreService").resetScores();}catch(M){}n={startDate:s,lastReportDate:new Date,firstByteDate:S.lastProgress&&S.lastProgress.firstByteDate?S.lastProgress.firstByteDate:undefined,bytesLoaded:e.bytesReceived||S.lastProgress.bytesLoaded||1,bytesTotal:e.expectedSize||S.lastProgress.bytesTotal||2,lowLatencyManager:S.lowLatencyManager,reason:e.reason,after:e.after,before:e.before,depth:e.depth,waitingTime:e.waitingTime||S.lastProgress.waitingTime||0},i=new k(n);if(1<(S.lastProgress=i).bytesLoaded&&!i.firstByteDate){i.firstByteDate=new Date;try{S.log.debug("ttfb:",i.ttfb(),i.ttfb_all());}catch(M){S.log.error(M);}D.addValue("ttfb_peer",i.ttfb());try{var r=T.getPeerFromList(S.peerID);1===r.ip?D.addValue("ttfb_peer_ip",i.ttfb()):1===r.city?D.addValue("ttfb_peer_city",i.ttfb()):1===r.region?D.addValue("ttfb_peer_region",i.ttfb()):1===r.country&&D.addValue("ttfb_peer_country",i.ttfb());}catch(M){}}1<i.bytesLoaded&&(D.p2pReceivedLastPeriod=!0,D.p2pReceivedDate=new Date,I.lowLatency)&&S.lowLatencyManager.writeMeasure(n.bytesLoaded);b(i,m.ID);}else S.log.debug("[DL] Cancelled in onDownloadProgress",e),S.rejected();else {var n={startDate:s,lastReportDate:new Date,firstByteDate:S.lastProgress&&S.lastProgress.firstByteDate?S.lastProgress.firstByteDate:undefined,bytesLoaded:e.bytesReceived||S.lastProgress.bytesLoaded||1,bytesTotal:e.expectedSize||S.lastProgress.bytesTotal||2,lowLatencyManager:S.lowLatencyManager,depth:e.depth,waitingTime:e.waitingTime||S.lastProgress.waitingTime||0},i=new k(n);if(1<(S.lastProgress=i).bytesLoaded&&!i.firstByteDate){i.firstByteDate=new Date;try{S.log.debug("ttfb:",i.ttfb(),i.ttfb_all());}catch(M){S.log.error(M);}D.addValue("ttfb_peer",i.ttfb());try{var a=T.getPeerFromList(S.peerID);1===a.ip?D.addValue("ttfb_peer_ip",i.ttfb()):1===a.city?D.addValue("ttfb_peer_city",i.ttfb()):1===a.region?D.addValue("ttfb_peer_region",i.ttfb()):1===a.country&&D.addValue("ttfb_peer_country",i.ttfb());}catch(M){}}1<i.bytesLoaded&&(D.p2pReceivedLastPeriod=!0,D.p2pReceivedDate=new Date,I.lowLatency)&&S.lowLatencyManager.writeMeasure(n.bytesLoaded),b(i,m.ID)?(f(),S.timeoutProgress=setTimeout(p,l,{data:{requestID:c.requestID,bytesReceived:n.bytesLoaded,expectedSize:n.bytesTotal,depth:n.depth}},!0)):(S.log.debug("[DL] False timeout for a finished request",t),S.rejected());}}},y=function y(e){var i,a=e.data;a.requestID===c.requestID&&(i=function i(){var e={success:!0,firstByteDate:S.lastProgress&&S.lastProgress.firstByteDate?S.lastProgress.firstByteDate:s,startDate:s,endDate:new Date,bytesLoaded:a.data.byteLength||a.data.length,bytesTotal:a.data.byteLength||a.data.length,lowLatencyManager:S.lowLatencyManager,waitingTime:S.lastProgress&&S.lastProgress.waitingTime?S.lastProgress.waitingTime:0};try{R.end=(new Date).getTime()-s.getTime(),"video"===m.mediaType&&D.sendCustomAnalytics(R);}catch(M){}a.data.byteLength,a.size;e=new L(e);try{I.lowLatency&&S.lowLatencyManager.computeThroughput();}catch(M){S.log.error(M);}d(),f();var t=0,r=0;I.lowLatency||(t=Math.floor(e.estimatedBandwidth()/q*100)/100,r=Math.round(e.ttfb()/v.duration*100)/100,null!==(t=(t=Math.round(100*(t-r))/100)<0?0:t)&&t!==Infinity&&T.updatePeerFromList(S.peerID,{last:{r:t,ttfb:r,date:new Date}}));try{S.log.infos("End P2P request for ".concat(m.mediaType," segment ").concat(m.index," ").concat(c.requestID," (from ").concat(m.peer," to me ").concat(w.getMyPeerID()," in ").concat(e.duration()," ").concat(r," ").concat(t,")"));}catch(M){try{S.log.infos("End P2P request for ".concat(m.mediaType," segment ").concat(m.index," ").concat(c.requestID," (from ").concat(m.peer," to me ").concat(w.getMyPeerID()," in ").concat(e.duration()));}catch(n){}}S.factory.getInstance("PeerDataService").addSegmentRequested(m.peer,m.mediaType,m.index,m.quality,"end"),D.addHelpMetrics("S50");try{P.decreaseP2PFactor(),6e3<(new Date).getTime()-s.getTime()&&(D.addHelpMetrics("S5O-"),v.broadcast?D.addHelpMetrics("S5O-_b"):D.addHelpMetrics("S5O-_a")),v.broadcast&&P.selectAbonnementFromBroadcast&&(S.factory.getInstance("PeerSelectionService").forceAbonnement(m.peer),D.addHelpMetrics("S5O_ab"));}catch(M){S.log.error(M);}o({result:e,data:a.data});},P.rangeSupported&&I.validateData?(S.isValidatingData=!0,S.factory.getInstance("VerifyDataService").run(v,a.data,a.data.byteLength).then(function(e){S.isValidatingData=!1,e?(S.log.debug("[DL] Data validated"),i()):(S.log.debug("[DL] Data not validated"),p({data:{requestID:c.requestID,statusDetail:"cancelled",reason:"invalid"}}));})):i());},i=function i(e){-1<e.data.findIndex(function(e){return "delete"===e.modification&&e.uuid===m.peer})&&(S.isValidatingData||a());},a=S.rejected=function(){f(),d();try{var e,t;S.alreadyRejected||(t=e=0,!I.lowLatency&&S.lastProgress&&0!==S.lastProgress.ttfb()&&0<q&&0<v.duration&&S.lastProgress.firstDate&&(e=Math.floor(S.lastProgress.estimatedBandwidth()/q*100)/100,t=Math.round(S.lastProgress.ttfb()/v.duration*100)/100,null!==(e=(e=Math.round(100*(e-t))/100)<0?0:e))&&e!=Infinity&&T.updatePeerFromList(S.peerID,{last:{r:e,ttfb:t,date:new Date}}),S.log.infos("Stop P2P request for ".concat(m.mediaType," segment ").concat(m.index," ").concat(c.requestID," (from ").concat(m.peer," to me ").concat(w.getMyPeerID()," in ").concat(S.lastProgress.duration()," ").concat(t," ").concat(e,"))")));}catch(M){try{S.log.infos("Stop P2P request for ".concat(m.mediaType," segment ").concat(m.index," ").concat(c.requestID," (from ").concat(m.peer," to me ").concat(w.getMyPeerID()," in ").concat(S.lastProgress.duration()));}catch(r){}}n(),S.alreadyRejected=!0;},g={type:"fileRequest",videoID:I.videoID,segmentNumber:m.index,quality:m.quality,mediaType:m.mediaType,storageUrl:v.storageUrl,noquality:I.allowQualityChangeToOptimizeP2P},h=(m.range&&(g.range=m.range),function h(e){S.aborted?S.log.debug("P2P tried to post after abort"):v.progressFunction(e);}),c=I.lowLatency?w.sendMessage(m.peer,g,h):w.sendMessage(m.peer,g);S.log.debug("Begin P2P request for ".concat(m.mediaType," segment ").concat(m.index," ").concat(c.requestID)),S.requestID=c,S.peerID=m.peer,e=w.on("fileRequestStatus",p),t=w.on("fileReceived",y),r=w.on("peerConnectedRefreshed",i),p({data:{requestID:c.requestID}},!0),I.lowLatency&&S.lowLatencyManager.writeMeasure(0);})}},{key:"abort",value:function(){if(!this.aborted){var e=this.factory.getInstance("P2P");this.aborted=!0;try{e.sendMessage(this.peerID,{type:"fileRequestStop",requestID:this.requestID.requestID});}catch(t){}this.rejected();}}}])&&qt(e.prototype,r),n&&qt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function Et(e){return (Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lt(e,t){return function(e){if(Array.isArray(e))return e}(e)||kt(e,t)||At(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kt(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,o,s=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1;}else for(;!(c=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,i=e;}finally{try{if(!c&&null!=r["return"]&&(o=r["return"](),Object(o)!==o))return}finally{if(u)throw i}}return s}}function At(e,t){var r;if(e)return "string"==typeof e?Ot(e,t):"Map"===(r="Object"===(r={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ot(e,t):void 0}function Ot(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function xt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=Et(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=Et(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==Et(e)?e:e+""}(n.key),n);}}var Ct=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.reset(),this.log=this.factory.getInstance("MyLogger"),this.events=this.factory.getInstance("Events"),this.numberOfMPDWithoutSegments=0,this.isLive=null,this.currentRequestsProgress={},this.currentRetries={},this.maxNumberOfRetries=3,this.hidden="hidden",this.visibilityState="visibilityState","undefined"!=typeof document.hidden?(this.hidden="hidden",this.visibilityState="visibilityState"):"undefined"!=typeof document.msHidden?(this.hidden="msHidden",this.visibilityState="msVisibilityState"):"undefined"!=typeof document.webkitHidden&&(this.hidden="webkitHidden",this.visibilityState="webkitVisibilityState");}return e=t,(r=[{key:"reset",value:function(){try{for(var e in this.currentRequestsProgress)try{this.abortAll(e);}catch(t){console.debug("Error aborting requests for hashIndex:",e,t);}}catch(t){console.warn("Error during abortAll in reset:",t);}this.currentRequestsProgress={},this.currentRetries={},this.isLive=null,this.numberOfMPDWithoutSegments=0;}},{key:"manageIncorrectSegmentNumbers",value:function(e){try{var t,r,n=this.factory.getInstance("GeneralSettings"),i=this.factory.getInstance("VariableSettings"),a=this.factory.getInstance("UtilsService");!0===n.checkUrls&&e.isSegment&&i.useIndexModification&&(null===(t=a.getLastNumberIfValid(e.storageUrl))||isNaN(Number(t))||((r=Number(t))!==e.realNumber&&i.idInUrlMatchedOnce?(e.realNumber=r,this.factory.getInstance("VideoStorage").deleteSegmentAndAbove(e.mediaType,n.videoID,e.realNumber)):i.idInUrlMatchedOnce=!0));}catch(o){this.log.error(o);}}},{key:"load",value:function(q){var e,M=this,N=0,p=this.factory,t=p.getInstance("GeneralSettings"),r=p.getInstance("VariableSettings");if(q=new ft.a(q),""===t.videoID){try{e=q.originUrl.split("?")[0];}catch(E){e=q.originUrl;}t.videoID=e,p.getInstance("P2P").factory.getInstance("Tracker").videoID=e;}q.storageUrl=t.transformUrl(q.originUrl),M.manageIncorrectSegmentNumbers(q),q.isSegment&&this.log.debug("Stored request url:",q.storageUrl),q.isManifest&&this.log.infos("Refreshing manifest");try{p.getInstance("P2P").factory.getInstance("Tracker").isClosed&&!document[this.hidden]&&q.isSegment&&t.trackerActivated&&p.getInstance("P2P").factory.getInstance("Tracker").connect();}catch(E){}try{videoStorage.deleteQuality(q.mediaType,t.videoID,q.getIndex(),q.quality);}catch(E){}try{t.lowLatency!==r.setLowLatency&&0===Object.keys(M.currentRequestsProgress).length&&(t.lowLatency=r.setLowLatency);}catch(E){}return new Promise(function(D,T){var R=function(){N*=2,q.url=q.originUrl;var S=M.factory.getInstance("ManifestService"),w=M.factory.getInstance("GeneralSettings"),r=M.factory.getInstance("DecisionManager"),I=M.factory.getInstance("StorageSegments"),P=q.toString(),n="data",o=0,s=function s(e,t){if(ee()(M.currentRequestsProgress,P)&&M.currentRequestsProgress[P].requests[t]){M.currentRequestsProgress[P].requests[t].progress=e;try{M.currentRetries[M.currentRequestsProgress[P].inputRequest.url]&&1<M.currentRetries[M.currentRequestsProgress[P].inputRequest.url]&&(M.currentRequestsProgress[P].inRetry=!0);}catch(E){}return r.startDecision("progress",n,M.currentRequestsProgress[P],t).then(function(e){0<e.length&&c(e);})["catch"](function(e){}),!0}return !1},c=function c(e){var t,r=function(e,t){var r,n,i,a,o,s="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(e);},n:function(){var e=s.next();return n=e.done,e},e:function t(e){i=!0,r=e;},f:function(){try{n||null==s["return"]||s["return"]();}finally{if(i)throw r}}};if(Array.isArray(e)||(s=At(e))||t&&e&&"number"==typeof e.length)return s&&(e=s),a=0,{s:o=function o(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function t(e){throw e},f:o};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e);try{var n,i=function i(){n=t.value,M.currentRequestsProgress[P].newRequestsPending=!1;var e=null,r=o;if("server"===n.serverType)e=new(window.fetch?vt:Pt)(M.factory);else {if("peer"!==n.serverType)return 1;e=new Nt(M.factory);}n.ID=o,o++,M.currentRequestsProgress[P].requests[r]={request:n,loader:e,progress:null,result:null,isOver:!1,isSuccess:!1,isAbort:!1,isPartial:!1,partialRange:"",error:null,data:null},e.load(n,s,M.currentRequestsProgress[P].inputRequest).then(function(e){var t=e.result,e=e.data;ee()(M.currentRequestsProgress,P)&&M.currentRequestsProgress[P].requests&&M.currentRequestsProgress[P].requests[r]&&(M.currentRequestsProgress[P].requests[r].isOver=!0,M.currentRequestsProgress[P].requests[r].isSuccess=!0,M.currentRequestsProgress[P].requests[r].result=t,M.currentRequestsProgress[P].requests[r].data=e,u(r));})["catch"](function(e){ee()(M.currentRequestsProgress,P)&&M.currentRequestsProgress[P].requests&&M.currentRequestsProgress[P].requests[r]&&(M.currentRequestsProgress[P].requests[r].isOver=!0,M.currentRequestsProgress[P].requests[r].isSuccess=!1,M.currentRequestsProgress[P].requests[r].error=e,u(r));});};for(r.s();!(t=r.n()).done;)i();}catch(E){r.e(E);}finally{r.f();}},d=function d(){var e={allOver:!0,isAbort:!1,dataReady:!1,data:null,result:null},t=0,r=-1,n=!1;if(M.currentRequestsProgress[P].isAbort)e.isAbort=!0;else {for(var i in M.currentRequestsProgress[P].requests){var a=M.currentRequestsProgress[P].requests[i];a.isOver||(e.allOver=!1),a.isSuccess&&(t+=1,r=i);}if(M.currentRequestsProgress[P].inputRequest.isSegment&&("video"===M.currentRequestsProgress[P].inputRequest.mediaType||"audio"===M.currentRequestsProgress[P].inputRequest.mediaType)){var o=p.getInstance("P2P").factory.getInstance("VideoStorage"),s=o.getDataMissing(M.currentRequestsProgress[P].inputRequest.mediaType,w.videoID,M.currentRequestsProgress[P].inputRequest.getIndex(),M.currentRequestsProgress[P].inputRequest.quality);if(null!==s&&0===s.length){var c=o.getData(M.currentRequestsProgress[P].inputRequest.mediaType,w.videoID,M.currentRequestsProgress[P].inputRequest.getIndex(),M.currentRequestsProgress[P].inputRequest.quality);if(c.size)for(var u in M.currentRequestsProgress[P].requests){var l=M.currentRequestsProgress[P].requests[u];l.isSuccess&&c.size&&l.result&&l.result.bytesLoaded===c.size&&(t=1,r=u,n=!0);}n?(s=M.currentRequestsProgress[P].requests[r],e.dataReady=!0,e.data=s.data,e.result=s.result,e.quality=s.request.quality,e.allOver=!0):1<=t&&(null!==(s=o.getDataConstructed(M.currentRequestsProgress[P].inputRequest.mediaType,w.videoID,M.currentRequestsProgress[P].inputRequest.getIndex(),M.currentRequestsProgress[P].inputRequest.quality))?(e.dataReady=!0,e.data=s,e.result=new L({success:!0,startDate:new Date(M.currentRequestsProgress[P].startDate),endDate:new Date,bytesLoaded:s.byteLength||s.length,bytesTotal:s.byteLength||s.length}),e.quality=M.currentRequestsProgress[P].inputRequest.quality,e.allOver=!0,w.activated||M.factory.getInstance("VideoStorage").keepNumberSegments(q.mediaType,w.videoID,0)):o.deleteQuality(M.currentRequestsProgress[P].inputRequest.mediaType,w.videoID,M.currentRequestsProgress[P].inputRequest.getIndex(),M.currentRequestsProgress[P].inputRequest.quality));}}if(M.currentRequestsProgress[P].inputRequest.isManifest||M.currentRequestsProgress[P].inputRequest.isInit||M.currentRequestsProgress[P].inputRequest.isData||"text"===M.currentRequestsProgress[P].inputRequest.mediaType&&M.currentRequestsProgress[P].inputRequest.isSegment)for(var f in M.currentRequestsProgress[P].requests){f=M.currentRequestsProgress[P].requests[f];if(f.isSuccess&&!f.isAbort){e.dataReady=!0,e.data=f.data,e.result=f.result,e.quality=f.request.quality,e.allOver=!0;break}}M.currentRequestsProgress[P].waitingForRequests&&(e.allOver=!1),e.allOver&&!e.dataReady&&M.log.debug("All requests over but no success",M.currentRequestsProgress[P]);}return e},u=function u(){if(ee()(M.currentRequestsProgress,P)){var g,h=d(),m=!1,b=M.factory.getInstance("AnalyticsService"),v=M.factory.getInstance("P2P");if(h.isAbort&&!(h.allOver||h.dataReady||h.data||h.result)){try{delete M.currentRequestsProgress[P];}catch(E){}T({isAbort:!0});}else r.startDecision("end",n,M.currentRequestsProgress[P],h).then(function(){if(ee()(M.currentRequestsProgress,P)){if(h.allOver){try{var e=M.currentRequestsProgress[P].inputRequest.getIndex();isNaN(e)||"video"!==M.currentRequestsProgress[P].inputRequest.mediaType||v.factory.getInstance("PeerInfosStorage").setSegmentNumber(e),isNaN(e)||"audio"!==M.currentRequestsProgress[P].inputRequest.mediaType||v.factory.getInstance("PeerInfosStorage").setAudioSegmentNumber(e);}catch(y){}if(h.dataReady){if(M.currentRequestsProgress[P].inputRequest.isManifest){if(null===S.manageManifest(h.data,M.currentRequestsProgress[P].inputRequest.originUrl,q.manifestType))return M.events.emit("quanteecInvalidManifest",{}),void(w.retryOnHTTPErrors?(delete M.currentRequestsProgress[P],setTimeout(R,Math.min(1e3*N,1e4)),N+=.3):T({isAbort:!1}));try{b.manageManifestMetrics(h.data.length);}catch(E){}S.validTestLive(h.data)&&(null===M.isLive&&(M.isLive=S.isLiveManifest(h.data)),M.isLive!==S.isLiveManifest(h.data)&&(M.events.emit("quanteecRestartSuggested",{}),M.events.emit("quanteecMPDTypeChange",{from:M.isLive?"live":"vod",to:S.isLiveManifest()?"live":"vod"}),M.isLive,S.isLiveManifest()),!S.isLiveManifest(h.data)&&w.externalLive?(h.data=S.changeUpdatePeriod(h.data,15),S.manageManifest(h.data,M.currentRequestsProgress[P].inputRequest.originUrl,q.manifestType)):S.isLiveManifest(h.data)&&5<S.getUpdatePeriod()&&(h.data=S.changeUpdatePeriod(h.data,5),S.manageManifest(h.data,M.currentRequestsProgress[P].inputRequest.originUrl,q.manifestType)));}else M.currentRequestsProgress[P].inputRequest.isInit?I.setInitSegment(M.currentRequestsProgress[P].inputRequest.mediaType+"|"+M.currentRequestsProgress[P].inputRequest.quality,h.data):(S.getNeedInit()&&M.currentRequestsProgress[P].inputRequest.isSegment&&I.getInitSegment(M.currentRequestsProgress[P].inputRequest.mediaType+"|"+h.quality)===undefined&&(m=!0,M.load(new ft.a({index:NaN,mediaType:M.currentRequestsProgress[P].inputRequest.mediaType,quality:h.quality,originUrl:"",responseType:"arraybuffer",isManifest:!1,isInit:!0,manifestType:undefined})).then(function(e){if((g=new Uint8Array(h.data.byteLength+e.data.byteLength)).set(new Uint8Array(e.data)),g.set(new Uint8Array(h.data),e.data.byteLength),M.currentRequestsProgress[P].inputRequest.isSegment&&("video"===M.currentRequestsProgress[P].inputRequest.mediaType||"audio"===M.currentRequestsProgress[P].inputRequest.mediaType))try{b.manageMetrics(M.currentRequestsProgress[P]);}catch(y){}delete M.currentRequestsProgress[P],v.getMyDownload()&&(h.result.endDate=new Date,e=8*h.data.byteLength/v.getMyDownload(),h.result.startDate=new Date(h.result.endDate.getTime()-Math.round(1e3*e))),q.isSegment&&M.factory.getInstance("StorageCustomDecision").removeData("lastFailed"+q.mediaType),D({result:h.result,data:h.data,finalInputRequest:q}),M.deleteCurrentRetries(q.url);try{q.isSegment&&M.factory.getInstance("VideoStorage").keepNumberSegments(q.mediaType,w.videoID);}catch(E){}})["catch"](function(e){})),v.getVideoStorage().postData(M.currentRequestsProgress[P].inputRequest.mediaType,w.videoID,M.currentRequestsProgress[P].inputRequest.getIndex(),h.quality,h.data,M.currentRequestsProgress[P].inputRequest.storageUrl));if(!m){if(M.currentRequestsProgress[P].inputRequest.isSegment&&("video"===M.currentRequestsProgress[P].inputRequest.mediaType||"audio"===M.currentRequestsProgress[P].inputRequest.mediaType))try{b.manageMetrics(M.currentRequestsProgress[P]);}catch(y){}delete M.currentRequestsProgress[P],v.getMyDownload()&&(h.result.endDate=new Date,h.data.byteLength)&&(e=8*h.data.byteLength/v.getMyDownload(),h.result.startDate=new Date(h.result.endDate.getTime()-1e3*e)),q.isSegment&&M.factory.getInstance("StorageCustomDecision").removeData("lastFailed"+q.mediaType),D({result:h.result,data:h.data,finalInputRequest:q}),M.deleteCurrentRetries(q.url);try{q.isSegment&&M.factory.getInstance("VideoStorage").keepNumberSegments(q.mediaType,w.videoID);}catch(E){}}}else if(M.currentRequestsProgress[P].isAbort){M.log.debug("Back to beginning in Abort");try{delete M.currentRequestsProgress[P];}catch(E){}M.deleteCurrentRetries(q.url),T({isAbort:!0});}else try{if(!(w.retryOnHTTPErrors||!M.currentRetries[q.url]||M.currentRetries[q.url]&&M.currentRetries[q.url]<M.maxNumberOfRetries)||M.currentRequestsProgress[P].requests&&1===Object.keys(M.currentRequestsProgress[P].requests).length&&"server"===M.currentRequestsProgress[P].requests[0].request.serverType){var t=null;try{for(var r=M.currentRequestsProgress[P].requests,n=0,i=Object.entries(r);n<i.length;n++){var a=Lt(i[n],2),o=(a[0],a[1]);null!=o.error&&(t=o.error.responseRequest);}delete M.currentRequestsProgress[P];}catch(E){}M.deleteCurrentRetries(q.url),T({isAbort:!1,responseRequest:t});}else {try{M.log.infos("Back to beginning in request",q.getIndex(),q.mediaType,q.quality);}catch(E){}try{var s=M.factory.getInstance("VideoStorage");w.lowLatency?q.range={start:q.progressSent,end:""}:s.deleteQuality(q.mediaType,w.videoID,q.getIndex(),q.quality);}catch(E){M.log.debug("Back to beginning error",E);}delete M.currentRequestsProgress[P],setTimeout(R,Math.min(1e3*N,1e3)),N+=.3,M.currentRetries[q.url]=M.currentRetries[q.url]||0,M.currentRetries[q.url]+=1;}}catch(E){var c=null;try{for(var u=M.currentRequestsProgress[P].requests,l=0,f=Object.entries(u);l<f.length;l++){var d=Lt(f[l],2),p=(d[0],d[1]);null!=p.error&&(c=p.error.responseRequest);}delete M.currentRequestsProgress[P];}catch(E){}M.deleteCurrentRetries(q.url),T({isAbort:!1,responseRequest:c});}}}else {try{delete M.currentRequestsProgress[P];}catch(E){}M.deleteCurrentRetries(q.url),T({isAbort:!0});}})["catch"](function(e){M.log.debug(e);});}};q.isManifest&&(n="manifest",M.numberOfMPDWithoutSegments++,5<M.numberOfMPDWithoutSegments)&&(S.isLiveManifest()||S.isEmptyManifest())&&1<M.currentRequestsProgress.length&&(M.events.emit("quanteecRestartSuggested",{reason:"Successive MPD"}),M.events.emit("quanteecSuccessiveMPD",{}),M.numberOfMPDWithoutSegments=0),q.isInit&&(n="init"),q.isSegment&&(n="segment",M.numberOfMPDWithoutSegments=0),ee()(M.currentRequestsProgress,P)?M.log.debug("Request already exists after abort",P):M.currentRequestsProgress[P]={inputRequest:q,isAbort:!1,startDate:(new Date).getTime(),endDate:null,requests:{},newRequestsPending:!1},r.startDecision("before",n,q).then(function(e){try{var t=M.factory.getInstance("P2P").factory.getInstance("PeerListService").getListByConnectedPeers(),r=[];try{r=Object.keys(M.factory.getInstance("P2P").factory.getInstance("AbonnementService").currentPeers);}catch(E){}var n=M.factory.getInstance("P2P").factory.getInstance("AbonnementService").clientAbonnement;M.factory.getInstance("Events").emit("quanteecPeerListUpdated",{list:t,listAboReceiver:n,listAboSender:r});}catch(i){}c(e);})["catch"](function(e){T({isAbort:!0});});};R();})}},{key:"deleteCurrentRetries",value:function(e){try{delete this.currentRetries[e];}catch(t){}}},{key:"abortOne",value:function(e,t){this.currentRequestsProgress[e].requests[t].isAbort=!0,this.currentRequestsProgress[e].requests[t].loader.abort();}},{key:"abortAll",value:function(e){try{if(this.currentRequestsProgress[e]){for(var t in this.currentRequestsProgress[e].isAbort=!0,this.currentRequestsProgress[e].requests)try{this.currentRequestsProgress[e].requests[t]&&(this.currentRequestsProgress[e].requests[t].isAbort=!0,this.currentRequestsProgress[e].requests[t].loader)&&this.currentRequestsProgress[e].requests[t].loader.abort();}catch(r){console.debug("Error aborting individual request:",r);}delete this.currentRequestsProgress[e];}}catch(r){console.warn("Error in abortAll:",r);}}},{key:"abortEveryRequest",value:function(){for(var e in this.currentRequestsProgress)this.currentRequestsProgress[e].isAbort=!0,this.abortAll(e);}},{key:"abort",value:function(e,t){for(var r in this.currentRequestsProgress)(null!==e||t&&this.currentRequestsProgress[r].inputRequest.mediaType===t.mediaType&&!0===this.currentRequestsProgress[r].inputRequest.isSegment)&&(this.currentRequestsProgress[r].isAbort=!0,this.abortAll(r));}}])&&xt(e.prototype,r),n&&xt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}(),_t=e(6);function Ut(e){return (Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=Ut(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=Ut(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==Ut(e)?e:e+""}(n.key),n);}}var Bt=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.init();}return e=t,(r=[{key:"init",value:function(){this.log=this.factory.getInstance("MyLogger");}},{key:"getRandomNumber",value:function(e,t){return Math.random()*(t-e)+e}},{key:"fuzzNumber",value:function(e,t){return Math.random()<this.factory.getInstance("VariableSettings").fuzzPercent?(this.log.fuzz(t),this.getRandomNumber(-256,256)):e}},{key:"fuzzString",value:function(e,t){return Math.random()<this.factory.getInstance("VariableSettings").fuzzPercent?(this.log.fuzz(t),String(this.getRandomNumber(-256,256))):e}},{key:"fuzzError",value:function(e){if(Math.random()<this.factory.getInstance("VariableSettings").fuzzErrorPercent)throw this.log.fuzz(e),new Error("[Fuzzed]"+e)}}])&&jt(e.prototype,r),n&&jt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function Ft(e){return (Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ht(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=Ft(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=Ft(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==Ft(e)?e:e+""}(n.key),n);}}var Gt=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger"),this.haveMaster=!1,this.manifestType=null,this.needInit=!1,this.manifest={},this.textManifest="",this.live=!1;}return e=t,(r=[{key:"manageManifest",value:function(e,t,r){var n,i=function i(e){return String.fromCharCode.apply(null,new Uint8Array(e))},a={};this.manifestType!==r&&(this.manifestType=r,this.haveMaster=!1);try{n="string"!=typeof e?i(e):e,"MPD"===r?(this.textManifest=n,this.needInit=!1):-1<r.indexOf("M3U8")&&(!1===this.haveMaster&&(this.haveMaster=!0),this.needInit=!1,this.textManifest=n);}catch(o){return this.log.debug(o),this.textManifest(""),null}return this.manifest=a}},{key:"getNeedInit",value:function(){return this.needInit}},{key:"getManifest",value:function(){return this.manifest}},{key:"isLiveManifest",value:function(e){return "MPD"===this.manifestType?-1<this.textManifest.indexOf('type="dynamic"')?this.live=!0:this.live=!1:"M3U8"===this.manifestType&&-1===(e||this.textManifest).indexOf("#EXT-X-ENDLIST")?this.live=!0:this.live=!1}},{key:"validTestLive",value:function(e){return "MPD"===this.manifestType||"M3U8"!==this.manifestType||-1<e.indexOf("#EXT-X-TARGETDURATION")}},{key:"isEmptyManifest",value:function(){return ""===this.textManifest}},{key:"getUpdatePeriod",value:function(){return "MPD"===this.manifestType?(this.textManifest,5):"M3U8"===this.manifestType?5:null}},{key:"changeUpdatePeriod",value:function(e,t){var r,n,i;return "MPD"===this.manifestType?(r=-1<e.indexOf('type="dynamic"')?"dynamic":"static",t="PT".concat(t,"S"),-1<(n=e.indexOf("minimumUpdatePeriod="))?(i=e.indexOf('"',n+1),i=e.indexOf('"',i+1),e.replace(e.substring(n,i+1),'minimumUpdatePeriod="'.concat(t,'"'))):e.replace('type="'.concat(r,'"'),'type="'.concat(r,'" minimumUpdatePeriod="').concat(t,'"'))):"M3U8"===this.manifestType?e.replace("#EXT-X-ENDLIST",""):e}}])&&Ht(e.prototype,r),n&&Ht(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}(),Vt=e(7);function zt(e){return (zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=zt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=zt(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==zt(e)?e:e+""}(n.key),n);}}var Xt=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger");}return e=t,(r=[{key:"getLastNumberIfValid",value:function(e){try{var t=this.factory.getInstance("VariableSettings"),r=new RegExp(t.adRegex1,t.adExtension1),n=new RegExp(t.adRegex2,t.adExtension2),i=e.match(r),a=e.match(n);if(i)return i[t.adNumber];if(a)return a[t.adNumber]}catch(o){}return null}}])&&Kt(e.prototype,r),n&&Kt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function Qt(e){return (Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=Qt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=Qt(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==Qt(e)?e:e+""}(n.key),n);}}var Yt=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger"),this.reset();}return e=t,(r=[{key:"reset",value:function(){}},{key:"selectDataToVerify",value:function(e){return e<412?{start:0,end:e-1}:(e=e-206,{start:e=Math.floor(Math.random()*(e-206+1))+206,end:e+206})}},{key:"requestData",value:function(a,o){var s=this;return new Promise(function(i,t){a.range&&0<a.range.start&&(o.start+=a.range.start,o.end+=a.range.end);var e={url:a.originUrl,method:"get",responseType:"arraybuffer",headers:{Range:"bytes="+o.start+"-"+o.end}},r={url:a.originUrl,method:"head",responseType:"arraybuffer"},n=(s.factory.getInstance("GeneralSettings").withCredentials&&(r.withCredentials=e.withCredentials=!0),[]);n.push(St()(e)),s.factory.getInstance("VariableSettings").validateDataWithHead&&n.push(St()(r)),Promise.all(n).then(function(e){var t,r=e[0],n=-1;206===r.status&&((t=r.headers["content-range"])?(t=t.match(/bytes\s+\d+-\d+\/(\d+)/))&&(n=parseInt(t[1],10)):1<e.length&&(t=e[1],n=Number(t.headers["content-length"]))),i({data:r.data,size:n});})["catch"](function(e){t(e);});})}},{key:"validateData",value:function(e,t,r,n){var i=e.start;if(n<-1&&n!==t.byteLength)return this.log.infos("Validation: length mismatch"),!1;for(var a=0;a<r.byteLength;a++)if(t[i+a]!==r[a])return !1;return !0}},{key:"run",value:function(e,n,i){var a=this;return new Promise(function(t){var r=a.selectDataToVerify(i);a.requestData(e,r).then(function(e){e=a.validateData(r,new Uint8Array(n),new Uint8Array(e.data),e.size);t(e);})["catch"](function(e){a.log.error("[Validation] Error validating data",e),t(!1);});})}}])&&Wt(e.prototype,r),n&&Wt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function $t(e){return ($t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=$t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=$t(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==$t(e)?e:e+""}(n.key),n);}}var Zt=e(4),er=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger"),this.reset();}return e=t,(r=[{key:"getIsUsed",value:function(){return this.isUsed}},{key:"replaceInUrl",value:function(e){var t;return this.getIsUsed()&&Boolean(this.getCorrectSource().replace)&&(t=this.getCorrectSource(),e=e.replace(new URL(e).origin,t.replace)),e}},{key:"getCorrectSource",value:function(){return this.isUsed?{find:this.baseSource.base,replace:this.currentSource.base}:{find:"",replace:""}}},{key:"initVerify",value:function(e){var t=this;this.isUsed=!0,e?(this.currentSource=this.currentSource||{},this.currentSource.base=e,this.baseSource=this.currentSource,this.interval=setInterval(this.verifySource.bind(this,!0),3e4)):this.verifySource(!1).then(function(){t.isUsed&&(t.baseSource=t.currentSource,t.interval=setInterval(t.verifySource.bind(t,!0),3e4));})["catch"](function(e){});}},{key:"verifySource",value:function(c){var u=this;return new Promise(function(t,e){var r,n,i,a,o=0;try{r=u.factory.getInstance("GeneralSettings");}catch(s){}"viewsurf"===r.quanteecKey?(n=r.videoID,i=["https://platforms6.joada.net","https://platforms7.joada.net","https://platforms8.joada.net","https://platforms9.joada.net","https://platforms10.joada.net","https://platforms11.joada.net","https://platforms12.joada.net"],(a=function(e){Zt({method:"get",url:i[e]+"/api/videos/manifest/"+n,timeout:1e4}).then(function(e){e=e.data;u.currentSource={base:e.alternativeBaseUrls[0],mpd:e.mpd,m3u8:e.m3u8,poster:e.poster,thumbnail:e.thumbnail,alternativeBaseUrls:e.alternativeBaseUrls,analytics:"",refreshSources:!0},c&&u.baseSource.base!==u.currentSource.base&&(u.factory.getInstance("Events").emit("quanteecLastSourceUpdated",{reason:"Source modified"}),u.factory.getInstance("Events").emit("quanteecRestartSuggested",{reason:"Source modified",quanteecLastSource:u.currentSource})),t();})["catch"](function(e){o<5?(o++,a(Math.floor(Math.random()*i.length))):t();});})(Math.floor(Math.random()*i.length))):t();})}},{key:"verifyAlternativeUrls",value:function(){var u=this;return new Promise(function(n,e){var t,r,i,a,o=u,s=0;try{t=u.factory.getInstance("GeneralSettings");}catch(c){}"viewsurf"===t.quanteecKey?(r=t.videoID,i=["https://platforms6.joada.net","https://platforms7.joada.net","https://platforms8.joada.net","https://platforms9.joada.net","https://platforms10.joada.net","https://platforms11.joada.net","https://platforms12.joada.net"],(a=function(e){Zt({method:"get",url:i[e]+"/api/videos/manifest/"+r,timeout:1e4}).then(function(e){var t,r,e=e.data;e.alternativeBaseUrls&&1<e.alternativeBaseUrls.length&&((t=o.factory.getInstance("StorageAlternativeUrls")).setData("default",e.alternativeBaseUrls[0]),t.setData("alternatives",e.alternativeBaseUrls),t.setData("selected",e.alternativeBaseUrls[0]),1<e.alternativeBaseUrls.length)&&(r=e.alternativeBaseUrls.shift(),t.setData("selected",e.alternativeBaseUrls[Math.floor(Math.random()*e.alternativeBaseUrls.length)]),e.alternativeBaseUrls.unshift(r)),n();})["catch"](function(e){s<3?(s++,a(Math.floor(Math.random()*i.length))):n();});})(Math.floor(Math.random()*i.length))):n();})}},{key:"reset",value:function(){try{clearInterval(this.interval);}catch(e){}this.interval=null,this.isUsed=!1,this.baseSource={base:""},this.currentSource={base:""};}}])&&Jt(e.prototype,r),n&&Jt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function tr(e){return (tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=tr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=tr(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==tr(e)?e:e+""}(n.key),n);}}var nr=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.reset();}return e=t,(r=[{key:"reset",value:function(){this.data={};}},{key:"setData",value:function(e,t){this.data[e]=t;}},{key:"getData",value:function(e){return this.data[e]}},{key:"removeData",value:function(e){delete this.data[e];}}])&&rr(e.prototype,r),n&&rr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function ir(e){return (ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ar(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=ir(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=ir(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==ir(e)?e:e+""}(n.key),n);}}var or=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.reset();}return e=t,(r=[{key:"reset",value:function(){this.data={};}},{key:"setData",value:function(e,t){this.data[e]=t;}},{key:"getData",value:function(e){return this.data[e]}},{key:"removeData",value:function(e){this.data[e]&&delete this.data[e];}}])&&ar(e.prototype,r),n&&ar(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function sr(e){return (sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=sr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=sr(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==sr(e)?e:e+""}(n.key),n);}}var ur=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.reset();}return e=t,(r=[{key:"reset",value:function(){this.segments={},this.initSegments={};}},{key:"setSegment",value:function(e,t){this.segments[e]=t;}},{key:"getSegment",value:function(e){return this.segments[e]}},{key:"removeSegment",value:function(e){delete this.segments[e];}},{key:"setInitSegment",value:function(e,t){this.initSegments[e]=t;}},{key:"getInitSegment",value:function(e){return this.initSegments[e]}},{key:"removeInitSegment",value:function(e){delete this.initSegments[e];}}])&&cr(e.prototype,r),n&&cr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function lr(e){return (lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=lr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=lr(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==lr(e)?e:e+""}(n.key),n);}}var dr=e(4),pr=e(3),yr="";try{var gr=document.getElementsByTagName("script"),yr=gr[gr.length-1].src;}catch(x){}t=function(){function d(t){var a=this;if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var r,e,o=this;if((t="string"==typeof t?{clientID:t}:t)&&(t.clientID||t.key||t.quanteecKey)||(t={},(e={quanteecKey:(r=function r(e,t){t=t||window.location.href,e=e.replace(/[\[\]]/g,"\\$&");e=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return e?e[2]?decodeURIComponent(e[2].replace(/\+/g," ")):"":null})("quanteecKey",yr),videoID:r("videoID",yr)}).quanteecKey&&(t.quanteecKey=e.quanteecKey),e.videoID&&(t.videoID=e.videoID)),!t||!t.clientID&&!t.key&&!t.quanteecKey)throw new Error("Missing quanteecKey in Quanteec configuration");var n=function n(){var e=new et;o.factory=e,o.eventStopPlayerID="",o.eventFileRequestStatus="",o.eventPeerConnected="",o.factory.setInstance("MyLogger",new rt(e,{loglevel:t.logLevel||0})),o.factory.setInstance("Events",new Je(e)),o.factory.setInstance("DownloadController",new Ct(e)),o.factory.setInstance("GeneralSettings",new j.a(e)),o.factory.setInstance("StaticSettings",new F(e)),o.factory.setInstance("VariableSettings",new G(e)),o.factory.setInstance("PeerDataService",new U(e)),o.factory.setInstance("UtilsService",new Xt(e)),o.factory.setInstance("StorageCustomDecision",new or(e)),o.factory.setInstance("StorageSegments",new ur(e)),o.factory.setInstance("StorageAlternativeUrls",new nr(e)),o.factory.setInstance("DecisionManager",new lt(e)),o.factory.setInstance("ManifestService",new Gt(e)),o.factory.setInstance("BufferService",new _t.a(e)),o.factory.setInstance("AnalyticsService",new de(e)),o.factory.setInstance("PlayerService",new Vt.a(e)),o.factory.setInstance("VerifySourceService",new er(e)),o.factory.setInstance("VerifyDataService",new Yt(e)),o.factory.setInstance("FuzzService",new Bt(e)),o.factory.getInstance("DecisionManager").initDecisions();},s=function s(e){var t;return 5<e.split("-").length?(t=e[e.length-1].charCodeAt(0)-("a".charCodeAt(0)-1),function(e){for(var t="",r=0;r<e.length;r+=2)t+=String.fromCharCode(parseInt(e[r]+e[r+1],16));return t}(e.split("-").splice(3,t).join("")).split("").reverse().join("")):undefined},c=function c(e){var t,r=o.factory.getInstance("GeneralSettings"),n=o.factory.getInstance("VariableSettings"),i=o.factory.getInstance("MyLogger");r.quanteecKey=e.clientID||e.key||e.quanteecKey,e.videoID&&(r.videoID=e.videoID),ee()(e,"collection")&&(r.collection=e.collection),ee()(e,"indexModification")&&(r.indexModification=e.indexModification),ee()(e,"validateData")&&(r.validateData=e.validateData),ee()(e,"p2pOptimizedStart")&&(r.p2pOptimizedStart=e.p2pOptimizedStart),ee()(e,"p2pConfiguration")&&(r.p2pConfiguration=e.p2pConfiguration),ee()(e,"useSubnets")&&(r.useSubnets=e.useSubnets),ee()(e,"retryOnHTTPErrors")&&(r.retryOnHTTPErrors=e.retryOnHTTPErrors),ee()(e,"activateFullFeedback")&&"boolean"==typeof e.activateFullFeedback&&(r.activateFullFeedback=e.activateFullFeedback),ee()(e,"maxAgeLive")&&"number"==typeof e.maxAgeLive&&(r.maxAgeLive=e.maxAgeLive),ee()(e,"iceServers")&&(Array.isArray(e.iceServers)?r.iceServers=e.iceServers:i.error('Configuration "iceServers" is not an array. The configuration is ignored.')),ee()(e,"logPrefix")&&(r.logPrefix=e.logPrefix),ee()(e,"externalLive")&&(r.externalLive=e.externalLive),ee()(e,"withCredentials")&&(r.withCredentials=e.withCredentials),e.lowLatency&&(r.lowLatency=e.lowLatency,n.setLowLatency=e.lowLatency),ee()(e,"lowLatencyBufferLimit")&&(r.lowLatencyBufferLimit=e.lowLatencyBufferLimit),e.logLatency&&(r.logLatency=e.logLatency),e.checkUrls&&(r.checkUrls=e.checkUrls),e.ignoreTokenInUrls&&(r.ignoreTokenInUrls=e.ignoreTokenInUrls),ee()(e,"fuzzPercent")&&(a.factory.getInstance("VariableSettings").fuzzErrorPercent=e.fuzzPercent),ee()(e,"maxUploadPercent")&&a.setMaxUploadPercent(e.maxUploadPercent),ee()(e,"forceMaxUploadPercent")&&"boolean"==typeof e.forceMaxUploadPercent&&(r.forceMaxUploadPercent=e.forceMaxUploadPercent),ee()(e,"forceP2P")&&"boolean"==typeof e.forceP2P&&(r.forceP2P=e.forceP2P),e.p2p&&ee()(e.p2p,"maxUploadPercent")&&a.setMaxUploadPercent(e.p2p.maxUploadPercent),ee()(e,"p2pActivated")&&(r.activated=e.p2pActivated),e.p2p&&ee()(e.p2p,"activated")&&(r.activated=e.p2p.activated),e.p2p&&ee()(e.p2p,"sendingActivated")&&(r.sendingActivated=e.p2p.sendingActivated),ee()(e,"ignoreGroupQuality")&&"boolean"==typeof e.ignoreGroupQuality&&(r.ignoreGroupQuality=e.ignoreGroupQuality),ee()(e,"allowQualityChangeToOptimizeP2P")&&"boolean"==typeof e.allowQualityChangeToOptimizeP2P&&(r.allowQualityChangeToOptimizeP2P=e.allowQualityChangeToOptimizeP2P),ee()(e,"cellularActivated")&&(r.cellularActivated=e.cellularActivated),e.p2p&&ee()(e.p2p,"cellularActivated")&&(r.cellularActivated=e.p2p.cellularActivated),e&&ee()(e,"numberOfSegmentsToKeep")&&(r.numberOfSegmentsToKeep=e.numberOfSegmentsToKeep),e.p2p&&ee()(e.p2p,"logLevel")&&(r.P2PLogLevel=e.p2p.logLevel),e.p2p&&ee()(e.p2p,"ignoreSameIP")&&(r.ignoreSameIP=e.p2p.ignoreSameIP),ee()(e,"tracker")?r.tracker=e.tracker:e.p2p&&ee()(e.p2p,"tracker")?r.tracker=e.p2p.tracker:r.tracker="wss://controller-ws.quanteec.com/",ee()(e,"controller")?r.tracker=e.controller:e.p2p&&ee()(e.p2p,"controller")?r.tracker=e.p2p.controller:r.tracker="wss://controller-ws.quanteec.com/",e.analytics&&e.analytics.analyticsID?r.analyticsID=e.analytics.analyticsID:r.analyticsID=r.quanteecKey,e.p2p&&ee()(e.p2p,"lowLatencyMode")&&(["default","push_infos","strict_seeding"].indexOf(-1<e.p2p.lowLatencyMode)?r.lowLatencyMode=e.p2p.lowLatencyMode:console.log("[QUANTEEC] Config p2p.lowLatencyMode unauthorized and ignored. Authorized values are : [default', 'push_infos', 'strict_seeding']"),ee()(e.p2p,"seed"))&&(r.seed=e.p2p.seed),""!==r.videoID&&(n=s(r.videoID),"viewsurf"===r.quanteecKey)&&void 0!==n&&(r.analyticsVideoID=n),e.analyticsVideoID&&(r.analyticsVideoID=e.analyticsVideoID),e.analytics&&e.analytics.analyticsVideoID&&(r.analyticsVideoID=e.analytics.analyticsVideoID),e.servers&&0<e.servers.length?((n=o.factory.getInstance("StorageAlternativeUrls")).setData("default",e.servers[0]),n.setData("alternatives",e.servers),n.setData("selected",e.servers[0]),1<e.servers.length&&(t=e.servers.shift(),n.setData("selected",e.servers[Math.floor(Math.random()*e.servers.length)]),e.servers.unshift(t))):((n=o.factory.getInstance("StorageAlternativeUrls")).setData("default",""),n.setData("alternatives",[]),n.setData("selected","")),i.debug("URL:",o.factory.getInstance("StorageAlternativeUrls").getData("default")),e.refreshSources&&!0===e.refreshSources&&("viewsurf"===r.quanteecKey?o.factory.getInstance("VerifySourceService").verifyAlternativeUrls()["catch"](function(e){}):(r.refreshSources=e.refreshSources,o.factory.getInstance("VerifySourceService").initVerify(o.factory.getInstance("StorageAlternativeUrls").getData("default")||undefined))),ee()(e,"activated")&&(r.trackerActivated=e.activated,r.activated=e.activated);},i=(this.manageConfig=c,function i(){var e=a.factory.getInstance("PlayerService");e&&e.stopPlayer();}),u=function u(e){e&&e.data&&"metrics"===e.data.status&&"server"===e.data.clientOrServer&&(e={sent:e.data.bytesSent||0,ip:e.data.ip||0,city:e.data.city||0,region:e.data.region||0,country:e.data.country||0},o.factory.getInstance("Events").emit("quanteecDataSent",e),o.factory.getInstance("AnalyticsService").totalDataSent(e));},l=function l(e){var t=o.factory.getInstance("P2P").factory.getInstance("PeerListService").getListByConnectedPeers(),r=[];try{r=Object.keys(o.factory.getInstance("P2P").factory.getInstance("AbonnementService").currentPeers);}catch(i){}var n=o.factory.getInstance("P2P").factory.getInstance("AbonnementService").clientAbonnement;o.factory.getInstance("Events").emit("quanteecPeerListUpdated",{list:t,listAboSender:r,listAboReceiver:n});},f=function f(){var e=o.factory.getInstance("GeneralSettings"),t=new Ye({videoID:e.videoID,clientID:e.quanteecKey,url:e.tracker,loglevel:e.P2PLogLevel},o.factory);if(o.factory.setInstance("P2P",t),o.eventStopPlayerID=t.factory.getInstance("Events").on("PlaybackForbidden",i),o.eventFileRequestStatus=t.factory.getInstance("Events").on("fileRequestStatus",u),o.peerConnected=t.factory.getInstance("Events").on("peerConnectedRefreshed",l),o.p2pSupported=t.isSupported(),o.p2pSupported.DataChannel)try{o.factory.getInstance("AnalyticsService").ciu=1;}catch(r){}else e.activated=!1;e.useSubnets?o.factory.getInstance("PeerConnection").computeLocalIPs()["catch"](function(e){}):o.factory.getInstance("PeerDataService").setIP("unknown");};if(n(),"error"===c(t))throw error;f(),this.playerUuid=pr(),window.quanteecPlayers||(window.quanteecPlayers=[]),window.quanteecPlayers.push({uuid:this.playerUuid,player:o});}return e=d,r=[{key:"getSourceUrls",value:function(d){var p=this;return new Promise(function(r,e){var t;try{t=p.factory.getInstance("GeneralSettings");}catch(f){}var n,i,a,o=[{base:"",mpd:"",m3u8:"",poster:"",thumbnail:"",analytics:""}],s=t?t.quanteecKey:d.clientID,c=(t||d).videoID,u=0,l=(t||d).externalLive;"viewsurf"===s?(n=(t||d).externalLive,i=["https://platforms6.joada.net","https://platforms7.joada.net","https://platforms8.joada.net","https://platforms9.joada.net","https://platforms10.joada.net","https://platforms11.joada.net","https://platforms12.joada.net"],(a=function(e){dr({method:"get",url:i[e]+"/api/videos/manifest/"+c,timeout:3e3}).then(function(e){e=e.data;(o=[]).push({base:e.alternativeBaseUrls[0],mpd:e.mpd,m3u8:e.m3u8,poster:e.poster,thumbnail:e.thumbnail,alternativeBaseUrls:e.alternativeBaseUrls,analytics:"",refreshSources:!0}),r(o[0]);})["catch"](function(e){var t;u<2?(u++,a(Math.floor(Math.random()*i.length))):(o=[],n=!(t="")===n?(t=Math.random()<.5?"https://deliverys5.quanteec.com":"https://deliverys6.quanteec.com","live"):(t="https://deliverys4.joada.net","vod"),o.push({base:t,mpd:"".concat(t,"/contents/encodings/").concat(n,"/").concat(c,"/mpd.mpd"),m3u8:"".concat(t,"/contents/encodings/").concat(n,"/").concat(c,"/master.m3u8"),poster:"".concat(t,"/contents/encodings/").concat(n,"/").concat(c,"/poster.jpg"),thumbnail:"".concat(t,"/contents/encodings/").concat(n,"/").concat(c,"/thumbnail.jpg"),alternativeBaseUrls:[t],analytics:""}),r(o[0]));});})(Math.floor(Math.random()*i.length))):(l=!0===l?"live":"vod",o=[],dr({method:"get",url:"https://".concat(s,".quanteec.com/api/videos/").concat(c,"/manifest"),timeout:1e4}).then(function(e){var t=e.data.alternativeBaseUrls[0];o.push({base:t,mpd:e.data.mpd,m3u8:e.data.m3u8,poster:e.data.poster,thumbnail:e.data.thumbnail,alternativeBaseUrls:e.data.alternativeBaseUrls,analytics:"",refreshSources:!1}),r(o);})["catch"](function(e){var t=window.origin;o.push({base:t,mpd:"".concat(t,"/contents/encodings/").concat(l,"/").concat(c,"/mpd.mpd"),m3u8:"".concat(t,"/contents/encodings/").concat(l,"/").concat(c,"/master.m3u8"),poster:"".concat(t,"/contents/encodings/").concat(l,"/").concat(c,"/poster.jpg"),thumbnail:"".concat(t,"/contents/encodings/").concat(l,"/").concat(c,"/thumbnail.jpg"),alternativeBaseUrls:[t],analytics:"",refreshSources:!1}),r(o);}));})}}],(t=[{key:"on",value:function(e,t){return this.factory.getInstance("Events").on(e,t)}},{key:"off",value:function(e,t,r){this.factory.getInstance("Events").off(e,t,r);}},{key:"activateQuanteec",value:function(e){var t,r,n,i=this.factory.getInstance("GeneralSettings");!0===e&&this.p2pSupported&&this.p2pSupported.DataChannel?(i.trackerActivated=!0,i.activated=!0,this.factory.getInstance("P2P").factory.getInstance("Tracker").isClosed&&this.factory.getInstance("P2P").factory.getInstance("Tracker").connect(),this.factory.getInstance("P2P").factory.getInstance("VideoStorage").setNumberToKeep(i.numberOfSegmentsToKeep)):!1===e&&(i.trackerActivated=!1,i.activated=!1,i=(e=this.factory.getInstance("P2P")).factory.getInstance("PeerInfosStorage"),t=e.factory.getInstance("Tracker"),r=e.factory.getInstance("PeerListStorage"),n=e.factory.getInstance("PeerConnection"),e.factory.getInstance("VideoStorage").setNumberToKeep(0),i.group="",t.leaveGroup(),t.close(),r.getListKeys().forEach(function(e){try{n.disconnect(e);}catch(t){}}));}},{key:"activateP2P",value:function(e){var t,r,n,i=this.factory.getInstance("GeneralSettings");!0===i.trackerActivated&&(!0===e&&this.p2pSupported&&this.p2pSupported.DataChannel?(i.activated=!0,this.factory.getInstance("P2P").factory.getInstance("Tracker").isClosed&&this.factory.getInstance("P2P").factory.getInstance("Tracker").connect()):!1===e&&(i.activated=!1,i=(e=this.factory.getInstance("P2P")).factory.getInstance("PeerInfosStorage"),t=e.factory.getInstance("Tracker"),r=e.factory.getInstance("PeerListStorage"),n=e.factory.getInstance("PeerConnection"),i.group="",t.leaveGroup(),r.getListKeys().forEach(function(e){try{n.disconnect(e);}catch(t){}})));}},{key:"setNumberOfSegmentsToKeep",value:function(e){try{"number"==typeof e&&this.factory.getInstance("VideoStorage").setNumberToKeep(e);}catch(t){}}},{key:"getGreenScore",value:function(){return this.factory.getInstance("AnalyticsService").greenScore()}},{key:"getEnergySavedInWh",value:function(){return this.factory.getInstance("AnalyticsService").energySavedWh()}},{key:"getEnergySavedReceivedInWh",value:function(){return this.factory.getInstance("AnalyticsService").energySavedReceivedWh()}},{key:"getEnergySavedSentInWh",value:function(){return this.factory.getInstance("AnalyticsService").energySavedSentWh()}},{key:"getEnergySavedInLight",value:function(){return this.factory.getInstance("AnalyticsService").energyInLight()}},{key:"getEnergySavedInCO2g",value:function(){return this.factory.getInstance("AnalyticsService").energyInCO2g()}},{key:"getEnergySavedInWatercL",value:function(){return this.factory.getInstance("AnalyticsService").energyInWatercL()}},{key:"setMaxUploadPercent",value:function(e){if(!("number"==typeof e&&0<=e&&e<=1))return "Bad value, should be a number in [0,1]";var t=this.factory.getInstance("GeneralSettings");t.maxUploadPercent=e;try{var r=this.factory.getInstance("P2P").factory.getInstance("PeerInfosStorage"),n=r.getDownload();0<n&&r.setUpload(.8*n*t.maxUploadPercent);}catch(i){}try{0===e&&(peerInfosStorage.sendableSegments=0);}catch(i){}}},{key:"getDataCDN",value:function(){var e=0;try{e=this.factory.getInstance("AnalyticsService").getDataHttp();}catch(t){}return e}},{key:"getDataPeer",value:function(){var e=0;try{e=this.factory.getInstance("AnalyticsService").getDataP2p();}catch(t){}return e}},{key:"getDataSent",value:function(){var e=0;try{e=this.factory.getInstance("AnalyticsService").getDataSent();}catch(t){}return e}},{key:"getP2PPercent",value:function(){var e=0;try{var t=this.getDataCDN(),r=this.getDataPeer();0<t+r&&(e=Math.round(r/(r+t)*1e3)/10);}catch(n){}return e}},{key:"getPeerConnected",value:function(){var e=0;try{e=this.factory.getInstance("P2P").factory.getInstance("PeerListService").getListByConnectedPeers().length;}catch(x){}return e}},{key:"registerAnalyticsListener",value:function(t){return this.factory.getInstance("Events").on("quanteecAnalytics",function(e){e.data&&e.data.analytics&&t(e.data.analytics);})}},{key:"extendYouboraAdapters",value:function(e){var t=e||window.youbora;if(t&&t.adapters)for(var r in t.adapters)t.adapters[r]=t.adapters[r].extend(this.getYouboraAdapter());}},{key:"getYouboraAdapter",value:function(){var r=this;return {getCdnTraffic:function(){return r.getDataCDN()},getP2PTraffic:function(){return r.getDataPeer()},getUploadTraffic:function(){return r.getDataSent()},getIsP2PEnabled:function(){var e=!1;try{e=e||r.factory.getInstance("GeneralSettings").activated;}catch(t){e=e||!1;}return e}}}},{key:"updateConfig",value:function(e){var t=this.factory.getInstance("P2P"),r=t.factory.getInstance("PeerInfosStorage"),n=t.factory.getInstance("Tracker"),i=t.factory.getInstance("PeerListStorage"),a=t.factory.getInstance("PeerConnection"),t=t.factory.getInstance("VideoStorage");r.group="",n.leaveGroup(),n.close(),n.videoID=e.videoID||n.videoID,i.getListKeys().forEach(function(e){try{a.disconnect(e);}catch(t){}}),t.deleteAll(),this.manageConfig(e);}},{key:"reset",value:function(){try{this.getP2P().factory.getInstance("Events").off("PlaybackForbidden",null,this.eventStopPlayerID),this.eventStopPlayerID="";}catch(x){}try{this.getP2P().factory.getInstance("Events").off("fileRequestStatus",null,this.eventFileRequestStatus),this.eventFileRequestStatus="";}catch(x){}try{this.getP2P().factory.getInstance("Events").off("peerConnectedRefreshed",null,this.eventPeerConnected),this.eventPeerConnected="";}catch(x){}for(var e in this.factory.instances)try{"Player"!==e&&(this.factory.instances[e]&&"function"==typeof this.factory.instances[e].reset&&this.factory.instances[e].reset(),delete this.factory.instances[e]);}catch(x){console.error("Error during core instances reset",x);}this.factory.reset();}}])&&fr(e.prototype,t),r&&fr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r;}();t.LOG_LEVEL_NONE=0,t.LOG_LEVEL_ERROR=1,t.LOG_LEVEL_INFOS=2,t.LOG_LEVEL_DEBUG=3,t.LOG_LEVEL_TRACE=4,t.QuanteecYouboraAdapter={getCdnTraffic:function(){var t=null;return window.quanteecPlayers&&0<window.quanteecPlayers.length&&(t=0,window.quanteecPlayers.forEach(function(e){t+=e.player.getDataCDN();})),t},getP2PTraffic:function(){var t=null;return window.quanteecPlayers&&0<window.quanteecPlayers.length&&(t=0,window.quanteecPlayers.forEach(function(e){t+=e.player.getDataPeer();})),t},getUploadTraffic:function(){var t=null;return window.quanteecPlayers&&0<window.quanteecPlayers.length&&(t=0,window.quanteecPlayers.forEach(function(e){t+=e.player.getDataSent();})),t},getIsP2PEnabled:function(){var t=!1;try{window.quanteecPlayers&&0<window.quanteecPlayers.length&&window.quanteecPlayers.forEach(function(e){t=t||e.player.factory.getInstance("GeneralSettings").activated;});}catch(e){t=t||!1;}return t}},C["default"]=t;},function(e,t,r){var n=r(0),d=r.n(n);function y(e){return (y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=y(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=y(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==y(e)?e:e+""}(n.key),n);}}n=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.init();}return e=t,(r=[{key:"init",value:function(){this.videoID="",this.quanteecKey="",this.logLevel="error",this.externalLive=!1,this.withCredentials=!1,this.manifestNoCache=!1,this.collection="",this.retryOnHTTPErrors=!1,this.prevents=[],this.checkUrls=!1,this.ignoreTokenInUrls="",this.lowLatency=!1,this.lowLatencyBufferLimit=-1,this.lowLatencyMode="default",this.leech=!1,this.seed=!1,this.cmsdBitrate=!0,this.analyticsID="",this.analyticsVideoID="",this.analyticsUrl="",this.ignoreSameIP=!1,this.trackerActivated=!0,this.activated=!0,this.P2PLogLevel="error",this.numberOfSegmentsToKeep=20,this.tracker="",this.sendingActivated=!0,this.cellularActivated=!0,this.maxUploadPercent=.5,this.indexDiff={video:1,audio:1,text:1,other:1},this.refreshSources=!1,this.servers={video:[],audio:[]},this.isCellular=!1,this.simulateCellular=!1,this.logPrefix="",this.logLatency=!1,this.useSubnets=!1,this.validateData=!1,this.p2pOptimizedStart=!1,this.p2pConfiguration="",this.allowQualityChangeToOptimizeP2P=!1,this.ignoreGroupQuality=!1,this.indexModification=0,this.activateFullFeedback=!1,this.maxAgeLive=200,this.forceMaxUploadPercent=!1,this.forceP2P=!1,this.isFileMode=!1,this.iceServers=[{urls:["stun:stun.quanteec.com:3478"]},{urls:["stun:stun.l.google.com:19302"]}];}},{key:"setPrevents",value:function(u){if(u&&"object"===y(u)&&0<u.length){for(var l=[{value:"start",type:"string",canCastAccordingToType:[{type:"segment",canCastTo:"number"},{type:"timestamp",canCastTo:"number"},{type:"time",canCastTo:"Date"}]},{value:"end",type:"string",canCastAccordingToType:[{type:"segment",canCastTo:"number"},{type:"timestamp",canCastTo:"number"},{type:"time",canCastTo:"Date"}]},{value:"type",type:"string","in":["segment","timestamp","time","urlTemplate"]},{value:"isExclude",type:"boolean"},{value:"urlTemplate",type:"string",canCastAccordingToType:[{type:"urlTemplate",canCastTo:"string"}]}],f=/^(?:\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z|\d{2}:\d{2}:\d{2})$/,d=function d(){for(var t=u[p],e=!0,r=0,n=l;r<n.length;r++){var i=n[r],a=i.value,o=i.type,s=i["in"],i=i.canCastAccordingToType,c=t[a];if(c===undefined){e=!1;break}if(y(c)!==o){e=!1;break}if(s&&0<s.length&&!s.includes(c)){e=!1;break}if(i&&0<i.length){s=i.find(function(e){return e.type===t.type});if(s){i=s.canCastTo;if("string"===o&&"number"===i){if(isNaN(Number(c))){e=!1;break}t[a]=Number(c);}if("string"===o&&"Date"===i&&!f.test(c)){e=!1;break}if("string"===o&&"string"===i&&0===c.length){e=!1;break}}}}e||u.splice(p,1);},p=u.length-1;0<=p;p--)d();this.prevents=u;}}},{key:"validatePrevents",value:function(e){try{if(e&&"object"===y(e))for(var t=0;t<this.prevents.length;t++){var r=this.prevents[t];if("segment"===r.type&&d()(e,"segment")){if(r.start<=e.segment&&e.segment<=r.end)return !1}else if("timestamp"===r.type&&d()(e,"timestamp")){if(r.start<=e.timestamp&&e.timestamp<=r.end)return !1}else if("urlTemplate"===r.type&&d()(e,"url")){var n=new RegExp("^"+r.urlTemplate.replace(/[-/\\^$+?.()|[\]{}]/g,"\\$&").replace(/\*/g,".*")+"$");if(n.test(e.url)&&r.isExclude||!n.test(e.url)&&!r.isExclude)return !1}else if("time"===r.type){var i=new Date;if(/^(\d{2}:\d{2}:\d{2})$/.test(r.start)){var a=i.toUTCString().split(" ")[4],o=new Date("1970-01-01T".concat(r.start,"Z")),s=new Date("1970-01-01T".concat(r.end,"Z")),c=new Date("1970-01-01T".concat(a,"Z"));if(o<=c&&c<=s)return !1}else {var u=new Date(r.start),l=new Date(r.end);if(u<=i&&i<=l)return !1}}}}catch(f){}return !0}},{key:"checkCellular",value:function(){var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return e&&e.type&&"cellular"===e.type||this.simulateCellular?this.isCellular=!0:this.isCellular=!1,this.isCellular}},{key:"shouldSend",value:function(){return this.checkCellular(),!(!this.sendingActivated||0===this.maxUploadPercent||this.isCellular&&!this.cellularActivated)}},{key:"transformUrl",value:function(e){return e.replace(new RegExp(this.ignoreTokenInUrls,"g"),"")}}])&&i(e.prototype,r),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();t.a=n;},function(e,t,r){e.exports=function(r,n){return function(){for(var e=new Array(arguments.length),t=0;t<e.length;t++)e[t]=arguments[t];return r.apply(n,e)}};},function(e,t,r){var i=r(2);function a(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){var n;return t&&(r=r?r(t):i.isURLSearchParams(t)?t.toString():(n=[],i.forEach(t,function(e,t){null!=e&&(i.isArray(e)?t+="[]":e=[e],i.forEach(e,function(e){i.isDate(e)?e=e.toISOString():i.isObject(e)&&(e=JSON.stringify(e)),n.push(a(t)+"="+a(e));}));}),n.join("&")))&&(-1!==(t=e.indexOf("#"))&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+r),e};},function(e,t,r){e.exports=function(e){return !(!e||!e.__CANCEL__)};},function(s,e,c){!function(e){var r=c(2),n=c(53),t={"Content-Type":"application/x-www-form-urlencoded"};function i(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t);}var a,o={adapter:a="undefined"!=typeof XMLHttpRequest||void 0!==e&&"[object process]"===Object.prototype.toString.call(e)?c(19):a,transformRequest:[function(e,t){return n(t,"Accept"),n(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(i(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(i(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e);}catch(t){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return 200<=e&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],function(e){o.headers[e]={};}),r.forEach(["post","put","patch"],function(e){o.headers[e]=r.merge(t);}),s.exports=o;}.call(this,c(52));},function(e,t,u){var l=u(2),f=u(54),d=u(16),p=u(56),y=u(59),g=u(60),h=u(20);e.exports=function(c){return new Promise(function(t,r){var e,n=c.data,i=c.headers,a=(l.isFormData(n)&&delete i["Content-Type"],new XMLHttpRequest),o=(c.auth&&(o=c.auth.username||"",e=c.auth.password||"",i.Authorization="Basic "+btoa(o+":"+e)),p(c.baseURL,c.url));if(a.open(c.method.toUpperCase(),d(o,c.params,c.paramsSerializer),!0),a.timeout=c.timeout,a.onreadystatechange=function(){var e;a&&4===a.readyState&&(0!==a.status||a.responseURL&&0===a.responseURL.indexOf("file:"))&&(e="getAllResponseHeaders"in a?y(a.getAllResponseHeaders()):null,e={data:c.responseType&&"text"!==c.responseType?a.response:a.responseText,status:a.status,statusText:a.statusText,headers:e,config:c,request:a},f(t,r,e),a=null);},a.onabort=function(){a&&(r(h("Request aborted",c,"ECONNABORTED",a)),a=null);},a.onerror=function(){r(h("Network Error",c,null,a)),a=null;},a.ontimeout=function(){var e="timeout of "+c.timeout+"ms exceeded";c.timeoutErrorMessage&&(e=c.timeoutErrorMessage),r(h(e,c,"ECONNABORTED",a)),a=null;},l.isStandardBrowserEnv()&&(e=u(61),o=(c.withCredentials||g(o))&&c.xsrfCookieName?e.read(c.xsrfCookieName):undefined)&&(i[c.xsrfHeaderName]=o),"setRequestHeader"in a&&l.forEach(i,function(e,t){void 0===n&&"content-type"===t.toLowerCase()?delete i[t]:a.setRequestHeader(t,e);}),l.isUndefined(c.withCredentials)||(a.withCredentials=!!c.withCredentials),c.responseType)try{a.responseType=c.responseType;}catch(s){if("json"!==c.responseType)throw s}"function"==typeof c.onDownloadProgress&&a.addEventListener("progress",c.onDownloadProgress),"function"==typeof c.onUploadProgress&&a.upload&&a.upload.addEventListener("progress",c.onUploadProgress),c.cancelToken&&c.cancelToken.promise.then(function(e){a&&(a.abort(),r(e),a=null);}),n===undefined&&(n=null),a.send(n);})};},function(e,t,r){var a=r(55);e.exports=function(e,t,r,n,i){e=new Error(e);return a(e,t,r,n,i)};},function(e,t,r){var s=r(2);e.exports=function(t,r){r=r||{};var n={},e=["url","method","params","data"],i=["headers","auth","proxy"],a=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"],o=(s.forEach(e,function(e){"undefined"!=typeof r[e]&&(n[e]=r[e]);}),s.forEach(i,function(e){s.isObject(r[e])?n[e]=s.deepMerge(t[e],r[e]):"undefined"!=typeof r[e]?n[e]=r[e]:s.isObject(t[e])?n[e]=s.deepMerge(t[e]):"undefined"!=typeof t[e]&&(n[e]=t[e]);}),s.forEach(a,function(e){"undefined"!=typeof r[e]?n[e]=r[e]:"undefined"!=typeof t[e]&&(n[e]=t[e]);}),e.concat(i).concat(a)),i=Object.keys(r).filter(function(e){return -1===o.indexOf(e)});return s.forEach(i,function(e){"undefined"!=typeof r[e]?n[e]=r[e]:"undefined"!=typeof t[e]&&(n[e]=t[e]);}),n};},function(e,t,r){function n(e){this.message=e;}n.prototype.toString=function(){return "Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n;},function(e,c,t){!function(e){var t,r,a,n,i,o;function s(e){return (s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,a=/^(?=([^\/?#]*))\1([^]*)$/,n=/(?:\/|^)\.(?=\/)/g,i=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var n=o.parseURL(e);if(n)return n.path=o.normalizePath(n.path),o.buildURLFromParts(n);throw new Error("Error trying to parse base URL.")}n=o.parseURL(t);if(!n)throw new Error("Error trying to parse relative URL.");if(n.scheme)return r.alwaysNormalize?(n.path=o.normalizePath(n.path),o.buildURLFromParts(n)):t;t=o.parseURL(e);if(!t)throw new Error("Error trying to parse base URL.");!t.netLoc&&t.path&&"/"!==t.path[0]&&(e=a.exec(t.path),t.netLoc=e[1],t.path=e[2]),t.netLoc&&!t.path&&(t.path="/");var i,e={scheme:t.scheme,netLoc:n.netLoc,path:null,params:n.params,query:n.query,fragment:n.fragment};return n.netLoc||(e.netLoc=t.netLoc,"/"!==n.path[0]&&(n.path?(i=(i=t.path).substring(0,i.lastIndexOf("/")+1)+n.path,e.path=o.normalizePath(i)):(e.path=t.path,n.params||(e.params=t.params,n.query)||(e.query=t.query)))),null===e.path&&(e.path=r.alwaysNormalize?o.normalizePath(n.path):n.path),o.buildURLFromParts(e)},parseURL:function(e){e=r.exec(e);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(n,"");e.length!==(e=e.replace(i,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},"object"===s(c)&&"object"===s(e)?e.exports=o:(t=function(){return o}.apply(c,[]))!==undefined&&(e.exports=t);}.call(this,t(64)(e));},function(e,t){function r(){return e.exports=r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)!{}.hasOwnProperty.call(n,r)||(e[r]=n[r]);}return e},e.exports.__esModule=!0,e.exports["default"]=e.exports,r.apply(null,arguments)}e.exports=r,e.exports.__esModule=!0,e.exports["default"]=e.exports;},function(C,_,e){var t=e(23),U=e.n(t),t=e(1),S=e.n(t),j="http://example.com",o=function(e,t){if(/^[a-z]+:/i.test(t))return t;/^data:/.test(e)&&(e=S.a.location&&S.a.location.href||"");var r="function"==typeof S.a.URL,n=/^\/\//.test(e),i=!S.a.location&&!/\/\//i.test(e);return r?e=new S.a.URL(e,S.a.location||j):/\/\//i.test(e)||(e=U.a.buildAbsoluteURL(S.a.location&&S.a.location.href||"",e)),r?(r=new URL(t,e),i?r.href.slice(j.length):n?r.href.slice(r.protocol.length):r.href):U.a.buildAbsoluteURL(e,t)},B=function B(i,e,a){e.forEach(function(e){for(var t in i.mediaGroups[e])for(var r in i.mediaGroups[e][t]){var n=i.mediaGroups[e][t][r];a(n,e,t,r);}});},F=e(29),H=e(30);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||G(e,t)||z(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,o,s=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1;}else for(;!(c=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,i=e;}finally{try{if(!c&&null!=r["return"]&&(o=r["return"](),Object(o)!==o))return}finally{if(u)throw i}}return s}}function p(e,t,r){return (t=function(e){e=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=i(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==i(e)?e:e+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function V(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||z(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){var r;if(e)return "string"==typeof e?n(e,t):"Map"===(r="Object"===(r={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function i(e){return (i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/*! @name mpd-parser @version 1.3.0 @license Apache-2.0 */var a=function a(e){return !!e&&"object"===i(e)},c=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce(function(t,r){return "object"===i(r)&&Object.keys(r).forEach(function(e){Array.isArray(t[e])&&Array.isArray(r[e])?t[e]=t[e].concat(r[e]):a(t[e])&&a(r[e])?t[e]=c(t[e],r[e]):t[e]=r[e];}),t},{})},u=function u(t){return Object.keys(t).map(function(e){return t[e]})},l=function l(e){return e.reduce(function(e,t){return e.concat(t)},[])},f=function f(e){if(!e.length)return [];for(var t=[],r=0;r<e.length;r++)t.push(e[r]);return t},K=function K(e,n){return e.reduce(function(e,t,r){return t[n]&&e.push(r),e},[])},X=function X(e,r){return u(e.reduce(function(t,e){return e.forEach(function(e){t[r(e)]=e;}),t},{}))},d={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",INVALID_NUMBER_OF_CONTENT_STEERING:"INVALID_NUMBER_OF_CONTENT_STEERING",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"},y=function(e){var t=e.baseUrl,r=e.source,r=void 0===r?"":r,n=e.range,n=void 0===n?"":n,e=e.indexRange,e=void 0===e?"":e,t={uri:r,resolvedUri:o((void 0===t?"":t)||"",r)};return (n||e)&&(r=(n||e).split("-"),n=S.a.BigInt?S.a.BigInt(r[0]):parseInt(r[0],10),e=S.a.BigInt?S.a.BigInt(r[1]):parseInt(r[1],10),n<Number.MAX_SAFE_INTEGER&&"bigint"==typeof n&&(n=Number(n)),"bigint"==typeof(r="bigint"==typeof(e=e<Number.MAX_SAFE_INTEGER&&"bigint"==typeof e?Number(e):e)||"bigint"==typeof n?S.a.BigInt(e)-S.a.BigInt(n)+S.a.BigInt(1):e-n+1)&&r<Number.MAX_SAFE_INTEGER&&(r=Number(r)),t.byterange={length:r,offset:n}),t},g=function g(e){return e&&"number"!=typeof e&&(e=parseInt(e,10)),isNaN(e)?null:e},Q={"static":function(e){var t=e.duration,r=e.timescale,r=void 0===r?1:r,n=e.sourceDuration,i=e.periodDuration,e=g(e.endNumber),t=t/r;return "number"==typeof e?{start:0,end:e}:"number"==typeof i?{start:0,end:i/t}:{start:0,end:n/t}},dynamic:function(e){var t=e.NOW,r=e.clientOffset,n=e.availabilityStartTime,i=e.timescale,i=void 0===i?1:i,a=e.duration,o=e.periodStart,o=void 0===o?0:o,s=e.minimumUpdatePeriod,s=void 0===s?0:s,c=e.timeShiftBufferDepth,c=void 0===c?Infinity:c,e=g(e.endNumber),t=(t+r)/1e3,r=n+o,n=Math.ceil((t+s-r)*i/a),o=Math.floor((t-r-c)*i/a),s=Math.floor((t-r)*i/a);return {start:Math.max(0,o),end:"number"==typeof e?e:Math.min(n,s)}}},W=function W(i){return function(e){var t=i.duration,r=i.timescale,n=i.startNumber;return {number:(void 0===n?1:n)+e,duration:t/(void 0===r?1:r),timeline:i.periodStart,time:e*t}}},h=function h(e){var t=e.type,r=e.duration,n=e.timescale,n=void 0===n?1:n,i=e.periodDuration,a=e.sourceDuration,o=Q[t](e),o=function(e,t){for(var r=[],n=e;n<t;n++)r.push(n);return r}(o.start,o.end).map(W(e));return "static"===t&&(o[e=o.length-1].duration=("number"==typeof i?i:a)-r/n*e),o},w=function w(e){var t=e.baseUrl,r=e.initialization,r=void 0===r?{}:r,n=e.sourceDuration,i=e.indexRange,i=void 0===i?"":i,a=e.periodStart,o=e.presentationTime,s=e.number,s=void 0===s?0:s,c=e.duration;if(t)return r=y({baseUrl:t,source:r.sourceURL,range:r.range}),(t=y({baseUrl:t,source:t,indexRange:i})).map=r,c?(i=h(e)).length&&(t.duration=i[0].duration,t.timeline=i[0].timeline):n&&(t.duration=n,t.timeline=a),t.presentationTime=o||a,t.number=s,[t];throw new Error(d.NO_BASE_URL)},Y=["AUDIO","SUBTITLES"],m=function m(e){return X(e,function(e){return e.timeline}).sort(function(e,t){return e.timeline>t.timeline?1:-1})},$=function $(e,t){for(var r=0;r<e.length;r++)if(e[r].attributes.NAME===t)return e[r];return null},J=function(e){var i=[];return B(e,Y,function(e,t,r,n){i=i.concat(e.playlists||[]);}),i},b=function b(e){var r=e.playlist;r.mediaSequence=e.mediaSequence,r.segments.forEach(function(e,t){e.number=r.mediaSequence+t;});},Z=function Z(e){var i=e.oldPlaylists,t=e.newPlaylists,a=e.timelineStarts;t.forEach(function(t){t.discontinuitySequence=a.findIndex(function(e){return e.timeline===t.timeline});var r,e,n=$(i,t.attributes.NAME);n&&!t.sidx&&(r=t.segments[0],-1===(e=n.segments.findIndex(function(e){return Math.abs(e.presentationTime-r.presentationTime)<1/60}))?(b({playlist:t,mediaSequence:n.mediaSequence+n.segments.length}),t.segments[0].discontinuity=!0,t.discontinuityStarts.unshift(0),(!n.segments.length&&t.timeline>n.timeline||n.segments.length&&t.timeline>n.segments[n.segments.length-1].timeline)&&t.discontinuitySequence--):(n.segments[e].discontinuity&&!r.discontinuity&&(r.discontinuity=!0,t.discontinuityStarts.unshift(0),t.discontinuitySequence--),b({playlist:t,mediaSequence:n.segments[e].number})));});},ee=function ee(e){var t=e.oldManifest,e=e.newManifest,r=t.playlists.concat(J(t)),n=e.playlists.concat(J(e));return e.timelineStarts=m([t.timelineStarts,e.timelineStarts]),Z({oldPlaylists:r,newPlaylists:n,timelineStarts:e.timelineStarts}),e},te=function te(e){return e&&e.uri+"-"+(t="bigint"==typeof(e=e.byterange).offset||"bigint"==typeof e.length?S.a.BigInt(e.offset)+S.a.BigInt(e.length)-S.a.BigInt(1):e.offset+e.length-1,"".concat(e.offset,"-").concat(t));var t;},v=function v(e){var e=e.reduce(function(e,t){return e[t.attributes.baseUrl]||(e[t.attributes.baseUrl]=[]),e[t.attributes.baseUrl].push(t),e},{}),t=[];return Object.values(e).forEach(function(e){e=u(e.reduce(function(e,t){var r,n=t.attributes.id+(t.attributes.lang||"");return e[n]?(t.segments&&(t.segments[0]&&(t.segments[0].discontinuity=!0),(r=e[n].segments).push.apply(r,V(t.segments))),t.attributes.contentProtection&&(e[n].attributes.contentProtection=t.attributes.contentProtection)):(e[n]=t,e[n].attributes.timelineStarts=[]),e[n].attributes.timelineStarts.push({start:t.attributes.periodStart,timeline:t.attributes.periodStart}),e},{}));t=t.concat(e);}),t.map(function(e){return e.discontinuityStarts=K(e.segments||[],"discontinuity"),e})},I=function I(e,t){var r=te(e.sidx),r=r&&t[r]&&t[r].sidx;if(r){for(var t=e,n=r,i=e.sidx.resolvedUri,a=t.sidx.map||null,o=t.sidx.duration,s=t.timeline||0,r=(r=t.sidx.byterange).offset+r.length,c=n.timescale,u=n.references.filter(function(e){return 1!==e.referenceType}),l=[],f=t.endList?"static":"dynamic",d=t.sidx.timeline,p=d,y=t.mediaSequence||0,g="bigint"==typeof n.firstOffset?S.a.BigInt(r)+n.firstOffset:r+n.firstOffset,h=0;h<u.length;h++){var m=n.references[h],b=m.referencedSize,m=m.subsegmentDuration,v=void 0,v="bigint"==typeof g?g+S.a.BigInt(b)-S.a.BigInt(1):g+b-1,v="".concat(g,"-").concat(v),v=w({baseUrl:i,timescale:c,timeline:s,periodStart:d,presentationTime:p,number:y,duration:m,sourceDuration:o,indexRange:v,type:f})[0];a&&(v.map=a),l.push(v),g+="bigint"==typeof g?S.a.BigInt(b):b,p+=m/c,y++;}t.segments=l;}return e},re=function re(e){var t=1<arguments.length&&arguments[1]!==undefined?arguments[1]:{};if(Object.keys(t).length)for(var r in e)e[r]=I(e[r],t);return e},ne=function ne(e,t){var r=e.attributes,n=e.segments,i=e.sidx,a=e.mediaSequence,o=e.discontinuitySequence,e=e.discontinuityStarts,o={attributes:p({NAME:r.id,BANDWIDTH:r.bandwidth,CODECS:r.codecs},"PROGRAM-ID",1),uri:"",endList:"static"===r.type,timeline:r.periodStart,resolvedUri:r.baseUrl||"",targetDuration:r.duration,discontinuitySequence:o,discontinuityStarts:e,timelineStarts:r.timelineStarts,mediaSequence:a,segments:n};return r.contentProtection&&(o.contentProtection=r.contentProtection),r.serviceLocation&&(o.attributes.serviceLocation=r.serviceLocation),i&&(o.sidx=i),t&&(o.attributes.AUDIO="audio",o.attributes.SUBTITLES="subs"),o},ie=function ie(e){var t=e.attributes,r=e.segments,n=e.mediaSequence,i=e.discontinuityStarts,e=e.discontinuitySequence,a=(void 0===r&&(r=[{uri:t.baseUrl,timeline:t.periodStart,resolvedUri:t.baseUrl||"",duration:t.sourceDuration,number:0}],t.duration=t.sourceDuration),p({NAME:t.id,BANDWIDTH:t.bandwidth},"PROGRAM-ID",1)),a=(t.codecs&&(a.CODECS=t.codecs),{attributes:a,uri:"",endList:"static"===t.type,timeline:t.periodStart,resolvedUri:t.baseUrl||"",targetDuration:t.duration,timelineStarts:t.timelineStarts,discontinuityStarts:i,discontinuitySequence:e,mediaSequence:n,segments:r});return t.serviceLocation&&(a.attributes.serviceLocation=t.serviceLocation),a},ae=function ae(e){var o,s=1<arguments.length&&arguments[1]!==undefined?arguments[1]:{},c=2<arguments.length&&arguments[2]!==undefined&&arguments[2],e=e.reduce(function(e,t){var r=t.attributes.role&&t.attributes.role.value||"",n=t.attributes.lang||"",i=t.attributes.label||"main",a=(n&&!t.attributes.label&&(a=r?" (".concat(r,")"):"",i="".concat(t.attributes.lang).concat(a)),e[i]||(e[i]={language:n,autoselect:!0,"default":"main"===r,playlists:[],uri:""}),I(ne(t,c),s));return e[i].playlists.push(a),void 0===o&&"main"===r&&((o=t)["default"]=!0),e},{});return o||(e[Object.keys(e)[0]]["default"]=!0),e},oe=function oe(e){var n=1<arguments.length&&arguments[1]!==undefined?arguments[1]:{};return e.reduce(function(e,t){var r=t.attributes.label||t.attributes.lang||"text";return e[r]||(e[r]={language:r,"default":!1,autoselect:!1,playlists:[],uri:""}),e[r].playlists.push(I(ie(t),n)),e},{})},se=function se(e){return e.reduce(function(n,e){return e&&e.forEach(function(e){var t=e.channel,r=e.language;n[r]={autoselect:!1,"default":!1,instreamId:t,language:r},e.hasOwnProperty("aspectRatio")&&(n[r].aspectRatio=e.aspectRatio),e.hasOwnProperty("easyReader")&&(n[r].easyReader=e.easyReader),e.hasOwnProperty("3D")&&(n[r]["3D"]=e["3D"]);}),n},{})},ce=function ce(e){var t=e.attributes,r=e.segments,n=e.sidx,e=e.discontinuityStarts,e={attributes:p({NAME:t.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:t.width,height:t.height},CODECS:t.codecs,BANDWIDTH:t.bandwidth},"PROGRAM-ID",1),uri:"",endList:"static"===t.type,timeline:t.periodStart,resolvedUri:t.baseUrl||"",targetDuration:t.duration,discontinuityStarts:e,timelineStarts:t.timelineStarts,segments:r};return t.frameRate&&(e.attributes["FRAME-RATE"]=t.frameRate),t.contentProtection&&(e.contentProtection=t.contentProtection),t.serviceLocation&&(e.attributes.serviceLocation=t.serviceLocation),n&&(e.sidx=n),e},ue=function ue(e){e=e.attributes;return "video/mp4"===e.mimeType||"video/webm"===e.mimeType||"video"===e.contentType},le=function le(e){e=e.attributes;return "audio/mp4"===e.mimeType||"audio/webm"===e.mimeType||"audio"===e.contentType},fe=function fe(e){e=e.attributes;return "text/vtt"===e.mimeType||"text"===e.contentType},de=function de(e,r){e.forEach(function(t){t.mediaSequence=0,t.discontinuitySequence=r.findIndex(function(e){return e.timeline===t.timeline}),t.segments&&t.segments.forEach(function(e,t){e.number=t;});});},P=function P(r){return r?Object.keys(r).reduce(function(e,t){t=r[t];return e.concat(t.playlists)},[]):[]},pe=function pe(e){var t,r,n,i,a,o,s,c=e.dashPlaylists,u=e.locations,l=e.contentSteering,f=e.sidxMapping,f=void 0===f?{}:f,d=e.previousManifest,e=e.eventStream;return c.length?(i=(a=c[0].attributes).sourceDuration,o=a.type,s=a.suggestedPresentationDelay,a=a.minimumUpdatePeriod,t=v(c.filter(ue)).map(ce),r=v(c.filter(le)),n=v(c.filter(fe)),c=c.map(function(e){return e.attributes.captionServices}).filter(Boolean),i={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:p(p({AUDIO:{},VIDEO:{}},"CLOSED-CAPTIONS",{}),"SUBTITLES",{}),uri:"",duration:i,playlists:re(t,f)},0<=a&&(i.minimumUpdatePeriod=1e3*a),u&&(i.locations=u),l&&(i.contentSteering=l),"dynamic"===o&&(i.suggestedPresentationDelay=s),e&&0<e.length&&(i.eventStream=e),a=0===i.playlists.length,u=r.length?ae(r,f,a):null,l=n.length?oe(n,f):null,s=(o=t.concat(P(u),P(l))).map(function(e){return e.timelineStarts}),i.timelineStarts=m(s),de(o,i.timelineStarts),u&&(i.mediaGroups.AUDIO.audio=u),l&&(i.mediaGroups.SUBTITLES.subs=l),c.length&&(i.mediaGroups["CLOSED-CAPTIONS"].cc=se(c)),d?ee({oldManifest:d,newManifest:i}):i):{}},ye=function ye(e,t,r){var n=e.NOW,i=e.timescale,a=e.periodStart,o=e.minimumUpdatePeriod;return Math.ceil((((n+e.clientOffset)/1e3+(void 0===o?0:o)-(e.availabilityStartTime+(void 0===a?0:a)))*(void 0===i?1:i)-t)/r)},D=function D(e,t){for(var r=e.type,n=e.minimumUpdatePeriod,i=void 0===n?0:n,n=e.media,a=void 0===n?"":n,o=e.sourceDuration,n=e.timescale,s=void 0===n?1:n,n=e.startNumber,c=void 0===n?1:n,u=e.periodStart,l=[],f=-1,d=0;d<t.length;d++)for(var p,y=t[d],g=y.d,h=y.r||0,y=y.t||0,y=(f<0&&(f=y),y&&f<y&&(f=y),void 0),m=(y=h<0?(p=d+1)===t.length?"dynamic"===r&&0<i&&0<a.indexOf("$Number$")?ye(e,f,g):(o*s-f)/g:(t[p].t-f)/g:h+1,c+l.length+y),b=c+l.length;b<m;)l.push({number:b,duration:g/s,time:f,timeline:u}),f+=g,b++;return l},ge=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,he=function he(i){return function(e,t,r,n){return "$$"===e?"$":"undefined"==typeof i[t]?e:(e=""+i[t],"RepresentationID"===t||(n=r?parseInt(n,10):1)<=e.length?e:"".concat(new Array(n-e.length+1).join("0")).concat(e))}},me=function me(e,t){return e.replace(ge,he(t))},be=function be(e,t){return e.duration||t?e.duration?h(e):D(e,t):[{number:e.startNumber||1,duration:e.sourceDuration,time:0,timeline:e.periodStart}]},ve=function(n,e){var i={RepresentationID:n.id,Bandwidth:n.bandwidth||0},t=n.initialization,t=void 0===t?{sourceURL:"",range:""}:t,a=y({baseUrl:n.baseUrl,source:me(t.sourceURL,i),range:t.range});return be(n,e).map(function(e){i.Number=e.number,i.Time=e.time;var t=me(n.media||"",i),r=n.timescale||1,r=n.periodStart+(e.time-(n.presentationTimeOffset||0))/r;return {uri:t,timeline:e.timeline,duration:e.duration,resolvedUri:o(n.baseUrl||"",t),map:a,number:e.number,presentationTime:r}})},Se=function Se(e,t){var r=e.baseUrl,e=e.initialization,e=void 0===e?{}:e,e=y({baseUrl:r,source:e.sourceURL,range:e.range}),r=y({baseUrl:r,source:t.media,range:t.mediaRange});return r.map=e,r},we=function we(i,e){var t=i.duration,r=i.segmentUrls,r=void 0===r?[]:r,a=i.periodStart;if(!t&&!e||t&&e)throw new Error(d.SEGMENT_TIME_UNSPECIFIED);var n,o=r.map(function(e){return Se(i,e)});return t&&(n=h(i)),(n=e?D(i,e):n).map(function(e,t){var r,n;if(o[t])return t=o[t],r=i.timescale||1,n=i.presentationTimeOffset||0,t.timeline=e.timeline,t.duration=e.duration,t.number=e.number,t.presentationTime=a+(e.time-n)/r,t}).filter(function(e){return e})},Ie=function Ie(e){var t,r,n,i,a=e.attributes,e=e.segmentInfo,a=(e.template?(r=ve,t=c(a,e.template)):e.base?(r=w,t=c(a,e.base)):e.list&&(r=we,t=c(a,e.list)),{attributes:a});return r&&(r=r(t,e.segmentTimeline),t.duration?(i=(n=t).duration,t.duration=i/(void 0===(i=n.timescale)?1:i)):r.length?t.duration=r.reduce(function(e,t){return Math.max(e,Math.ceil(t.duration))},0):t.duration=0,a.attributes=t,a.segments=r,e.base)&&t.indexRange&&(a.sidx=r[0],a.segments=[]),a},Pe=function Pe(e){return e.map(Ie)},T=function T(e,t){return f(e.childNodes).filter(function(e){return e.tagName===t})},R=function R(e){return e.textContent.trim()},De=function De(e){return parseFloat(e.split("/").reduce(function(e,t){return e/t}))},q=function q(e){var t,r,n,i,a,e=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(e);return e?(t=(e=s(e.slice(1),6))[0],r=e[1],n=e[2],i=e[3],a=e[4],e=e[5],31536e3*parseFloat(t||0)+2592e3*parseFloat(r||0)+86400*parseFloat(n||0)+3600*parseFloat(i||0)+60*parseFloat(a||0)+parseFloat(e||0)):0},Te=function Te(e){return /^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),Date.parse(e)},Re={mediaPresentationDuration:function(e){return q(e)},availabilityStartTime:function(e){return Te(e)/1e3},minimumUpdatePeriod:function(e){return q(e)},suggestedPresentationDelay:function(e){return q(e)},type:function(e){return e},timeShiftBufferDepth:function(e){return q(e)},start:function(e){return q(e)},width:function(e){return parseInt(e,10)},height:function(e){return parseInt(e,10)},bandwidth:function(e){return parseInt(e,10)},frameRate:function(e){return De(e)},startNumber:function(e){return parseInt(e,10)},timescale:function(e){return parseInt(e,10)},presentationTimeOffset:function(e){return parseInt(e,10)},duration:function(e){var t=parseInt(e,10);return isNaN(t)?q(e):t},d:function(e){return parseInt(e,10)},t:function(e){return parseInt(e,10)},r:function(e){return parseInt(e,10)},presentationTime:function(e){return parseInt(e,10)},DEFAULT:function(e){return e}},M=function M(e){return e&&e.attributes?f(e.attributes).reduce(function(e,t){var r=Re[t.name]||Re.DEFAULT;return e[t.name]=r(t.value),e},{}):{}},qe={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime","urn:mpeg:dash:mp4protection:2011":"mp4protection"},N=function(e,t){return t.length?l(e.map(function(n){return t.map(function(e){var t=R(e),r=o(n.baseUrl,t),e=c(M(e),{baseUrl:r});return r!==t&&!e.serviceLocation&&n.serviceLocation&&(e.serviceLocation=n.serviceLocation),e})})):e},E=function E(e){var t=T(e,"SegmentTemplate")[0],r=T(e,"SegmentList")[0],n=r&&T(r,"SegmentURL").map(function(e){return c({tag:"SegmentURL"},M(e))}),e=T(e,"SegmentBase")[0],i=r||t,i=i&&T(i,"SegmentTimeline")[0],a=r||e||t,a=a&&T(a,"Initialization")[0],t=t&&M(t),o=(t&&a?t.initialization=a&&M(a):t&&t.initialization&&(t.initialization={sourceURL:t.initialization}),{template:t,segmentTimeline:i&&T(i,"S").map(function(e){return M(e)}),list:r&&c(M(r),{segmentUrls:n,initialization:M(a)}),base:e&&c(M(e),{initialization:M(a)})});return Object.keys(o).forEach(function(e){o[e]||delete o[e];}),o},Me=function Me(i,a,o){return function(e){var t=T(e,"BaseURL"),t=N(a,t),r=c(i,M(e)),n=E(e);return t.map(function(e){return {segmentInfo:c(o,n),attributes:c(r,e)}})}},Ne=function Ne(e){return "urn:scte:dash:cc:cea-608:2015"===e.schemeIdUri?("string"!=typeof e.value?[]:e.value.split(";")).map(function(e){var t,r,n;return /^CC\d=/.test(n=e)?(r=(t=s(e.split("="),2))[0],n=t[1]):/^CC\d$/.test(e)&&(r=e),{channel:r,language:n}}):"urn:scte:dash:cc:cea-708:2015"===e.schemeIdUri?("string"!=typeof e.value?[]:e.value.split(";")).map(function(e){var t,r,n={channel:undefined,language:undefined,aspectRatio:1,easyReader:0,"3D":0};return /=/.test(e)?(t=(r=s(e.split("="),2))[0],r=void 0===(r=r[1])?"":r,n.channel=t,n.language=e,r.split(",").forEach(function(e){var e=s(e.split(":"),2),t=e[0],e=e[1];"lang"===t?n.language=e:"er"===t?n.easyReader=Number(e):"war"===t?n.aspectRatio=Number(e):"3D"===t&&(n["3D"]=Number(e));})):n.language=e,n.channel&&(n.channel="SERVICE"+n.channel),n}):void 0},Ee=function Ee(o){return l(T(o.node,"EventStream").map(function(e){var i=M(e),a=i.schemeIdUri;return T(e,"Event").map(function(e){var t=M(e),r=t.presentationTime||0,n=i.timescale||1,r=r/n+o.attributes.start;return {schemeIdUri:a,value:i.value,id:t.id,start:r,end:r+(t.duration||0)/n,messageData:R(e)||t.messageData,contentEncoding:i.contentEncoding,presentationTimeOffset:i.presentationTimeOffset||0}})}))},Le=function Le(i,a,o){return function(e){var t=M(e),r=N(a,T(e,"BaseURL")),n=T(e,"Role")[0],n={role:M(n)},t=c(i,t,n),n=T(e,"Accessibility")[0],n=Ne(M(n)),n=(n&&(t=c(t,{captionServices:n})),T(e,"Label")[0]),n=(n&&n.childNodes.length&&(n=n.childNodes[0].nodeValue.trim(),t=c(t,{label:n})),T(e,"ContentProtection").reduce(function(e,t){var r=M(t),n=(r.schemeIdUri&&(r.schemeIdUri=r.schemeIdUri.toLowerCase()),qe[r.schemeIdUri]);return n&&(e[n]={attributes:r},r=T(t,"cenc:pssh")[0])&&(t=R(r),e[n].pssh=t&&Object(F.a)(t)),e},{})),n=(Object.keys(n).length&&(t=c(t,{contentProtection:n})),E(e)),e=T(e,"Representation"),n=c(o,n);return l(e.map(Me(t,r,n)))}},ke=function ke(a,o){return function(e,t){var r=N(o,T(e.node,"BaseURL")),n=c(a,{periodStart:e.attributes.start}),i=("number"==typeof e.attributes.duration&&(n.periodDuration=e.attributes.duration),T(e.node,"AdaptationSet")),e=E(e.node);return l(i.map(Le(n,r,e)))}},Ae=function Ae(e,t){return 1<e.length&&t({type:"warn",message:"The MPD manifest should contain no more than one ContentSteering tag"}),e.length?((t=c({serverURL:R(e[0])},M(e[0]))).queryBeforeStart="true"===t.queryBeforeStart,t):null},Oe=function Oe(e){var t=e.attributes,r=e.priorPeriodAttributes;return "number"==typeof t.start?t.start:r&&"number"==typeof r.start&&"number"==typeof r.duration?r.start+r.duration:r||"static"!==e.mpdType?null:0},xe=function xe(e){var t,n,i,r=1<arguments.length&&arguments[1]!==undefined?arguments[1]:{},a=r.manifestUri,a=void 0===a?"":a,o=r.NOW,o=void 0===o?Date.now():o,s=r.clientOffset,s=void 0===s?0:s,r=r.eventHandler,r=void 0===r?function(){}:r,c=T(e,"Period");if(c.length)return t=T(e,"Location"),n=M(e),a=N([{baseUrl:a}],T(e,"BaseURL")),e=T(e,"ContentSteering"),n.type=n.type||"static",n.sourceDuration=n.mediaPresentationDuration||0,n.NOW=o,n.clientOffset=s,t.length&&(n.locations=t.map(R)),i=[],c.forEach(function(e,t){var r=M(e),t=i[t-1];r.start=Oe({attributes:r,priorPeriodAttributes:t?t.attributes:null,mpdType:n.type}),i.push({node:e,attributes:r});}),{locations:n.locations,contentSteeringInfo:Ae(e,r),representationInfo:l(i.map(ke(n,a))),eventStream:l(i.map(Ee))};throw new Error(d.INVALID_NUMBER_OF_PERIOD)},Ce=function(e){if(""===e)throw new Error(d.DASH_EMPTY_MANIFEST);var t,r,n=new H.DOMParser;try{r=(t=n.parseFromString(e,"application/xml"))&&"MPD"===t.documentElement.tagName?t.documentElement:null;}catch(i){}if(!r||0<r.getElementsByTagName("parsererror").length)throw new Error(d.DASH_INVALID_XML);return r},_e=(function _e(e){var t=1<arguments.length&&arguments[1]!==undefined?arguments[1]:{},e=xe(Ce(e),t),r=Pe(e.representationInfo);return pe({dashPlaylists:r,locations:e.locations,contentSteering:e.contentSteeringInfo,sidxMapping:t.sidxMapping,previousManifest:t.previousManifest,eventStream:e.eventStream})}),t=e(12),Ue=e.n(t),t=function(){function e(){this.listeners={};}var t=e.prototype;return t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t);},t.off=function(e,t){return !!this.listeners[e]&&(t=this.listeners[e].indexOf(t),this.listeners[e]=this.listeners[e].slice(0),this.listeners[e].splice(t,1),-1<t)},t.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var r=t.length,n=0;n<r;++n)t[n].call(this,arguments[1]);else for(var i=Array.prototype.slice.call(arguments,1),a=t.length,o=0;o<a;++o)t[o].apply(this,i);},t.dispose=function(){this.listeners={};},t.pipe=function(t){this.on("data",function(e){t.push(e);});},e}(),r=e(24),je=e.n(r),r=e(31),Be=e.n(r),Fe=e(32),He=function(t){function e(){var e=t.call(this)||this;return e.buffer="",e}return Ue()(e,t),e.prototype.push=function(e){var t;for(this.buffer+=e,t=this.buffer.indexOf("\n");-1<t;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1);},e}(t),Ge=String.fromCharCode(9),L=function L(e){var e=/([0-9.]*)?@?([0-9.]*)?/.exec(e||""),t={};return e[1]&&(t.length=parseInt(e[1],10)),e[2]&&(t.offset=parseInt(e[2],10)),t},Ve=function Ve(){return new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')},k=function M(e){for(var t,r=e.split(Ve()),n={},i=r.length;i--;)""!==r[i]&&((t=/([^=]*)=(.*)/.exec(r[i]).slice(1))[0]=t[0].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^['"](.*)['"]$/g,"$1"),n[t[0]]=t[1]);return n},ze=function(t){function e(){var e=t.call(this)||this;return e.customParsers=[],e.tagMappers=[],e}Ue()(e,t);var r=e.prototype;return r.push=function(r){var i,a,o=this;0!==(r=r.trim()).length&&("#"!==r[0]?this.trigger("data",{type:"uri",uri:r}):this.tagMappers.reduce(function(e,t){t=t(r);return t===r?e:e.concat([t])},[r]).forEach(function(e){for(var t,r,n=0;n<o.customParsers.length;n++)if(o.customParsers[n].call(o,e))return;0!==e.indexOf("#EXT")?o.trigger("data",{type:"comment",text:e.slice(1)}):(e=e.replace("\r",""),/^#EXTM3U/.exec(e)?o.trigger("data",{type:"tag",tagType:"m3u"}):(i=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e))?(a={type:"tag",tagType:"inf"},i[1]&&(a.duration=parseFloat(i[1])),i[2]&&(a.title=i[2]),o.trigger("data",a)):(i=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e))?(a={type:"tag",tagType:"targetduration"},i[1]&&(a.duration=parseInt(i[1],10)),o.trigger("data",a)):(i=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e))?(a={type:"tag",tagType:"version"},i[1]&&(a.version=parseInt(i[1],10)),o.trigger("data",a)):(i=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))?(a={type:"tag",tagType:"media-sequence"},i[1]&&(a.number=parseInt(i[1],10)),o.trigger("data",a)):(i=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))?(a={type:"tag",tagType:"discontinuity-sequence"},i[1]&&(a.number=parseInt(i[1],10)),o.trigger("data",a)):(i=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e))?(a={type:"tag",tagType:"playlist-type"},i[1]&&(a.playlistType=i[1]),o.trigger("data",a)):(i=/^#EXT-X-BYTERANGE:?(.*)?$/.exec(e))?(a=je()(L(i[1]),{type:"tag",tagType:"byterange"}),o.trigger("data",a)):(i=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e))?(a={type:"tag",tagType:"allow-cache"},i[1]&&(a.allowed=!/NO/.test(i[1])),o.trigger("data",a)):(i=/^#EXT-X-MAP:?(.*)$/.exec(e))?(a={type:"tag",tagType:"map"},i[1]&&((r=k(i[1])).URI&&(a.uri=r.URI),r.BYTERANGE)&&(a.byterange=L(r.BYTERANGE)),o.trigger("data",a)):(i=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e))?(a={type:"tag",tagType:"stream-inf"},i[1]&&(a.attributes=k(i[1]),a.attributes.RESOLUTION&&(r={},(t=a.attributes.RESOLUTION.split("x"))[0]&&(r.width=parseInt(t[0],10)),t[1]&&(r.height=parseInt(t[1],10)),a.attributes.RESOLUTION=r),a.attributes.BANDWIDTH&&(a.attributes.BANDWIDTH=parseInt(a.attributes.BANDWIDTH,10)),a.attributes["FRAME-RATE"]&&(a.attributes["FRAME-RATE"]=parseFloat(a.attributes["FRAME-RATE"])),a.attributes["PROGRAM-ID"])&&(a.attributes["PROGRAM-ID"]=parseInt(a.attributes["PROGRAM-ID"],10)),o.trigger("data",a)):(i=/^#EXT-X-MEDIA:?(.*)$/.exec(e))?(a={type:"tag",tagType:"media"},i[1]&&(a.attributes=k(i[1])),o.trigger("data",a)):/^#EXT-X-ENDLIST/.exec(e)?o.trigger("data",{type:"tag",tagType:"endlist"}):/^#EXT-X-DISCONTINUITY/.exec(e)?o.trigger("data",{type:"tag",tagType:"discontinuity"}):(i=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e))?(a={type:"tag",tagType:"program-date-time"},i[1]&&(a.dateTimeString=i[1],a.dateTimeObject=new Date(i[1])),o.trigger("data",a)):(i=/^#EXT-X-KEY:?(.*)$/.exec(e))?(a={type:"tag",tagType:"key"},i[1]&&(a.attributes=k(i[1]),a.attributes.IV)&&("0x"===a.attributes.IV.substring(0,2).toLowerCase()&&(a.attributes.IV=a.attributes.IV.substring(2)),a.attributes.IV=a.attributes.IV.match(/.{8}/g),a.attributes.IV[0]=parseInt(a.attributes.IV[0],16),a.attributes.IV[1]=parseInt(a.attributes.IV[1],16),a.attributes.IV[2]=parseInt(a.attributes.IV[2],16),a.attributes.IV[3]=parseInt(a.attributes.IV[3],16),a.attributes.IV=new Uint32Array(a.attributes.IV)),o.trigger("data",a)):(i=/^#EXT-X-START:?(.*)$/.exec(e))?(a={type:"tag",tagType:"start"},i[1]&&(a.attributes=k(i[1]),a.attributes["TIME-OFFSET"]=parseFloat(a.attributes["TIME-OFFSET"]),a.attributes.PRECISE=/YES/.test(a.attributes.PRECISE)),o.trigger("data",a)):(i=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e))?(a={type:"tag",tagType:"cue-out-cont"},i[1]?a.data=i[1]:a.data="",o.trigger("data",a)):(i=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e))?(a={type:"tag",tagType:"cue-out"},i[1]?a.data=i[1]:a.data="",o.trigger("data",a)):(i=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e))?(a={type:"tag",tagType:"cue-in"},i[1]?a.data=i[1]:a.data="",o.trigger("data",a)):(i=/^#EXT-X-SKIP:(.*)$/.exec(e))&&i[1]?((a={type:"tag",tagType:"skip"}).attributes=k(i[1]),a.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(a.attributes["SKIPPED-SEGMENTS"]=parseInt(a.attributes["SKIPPED-SEGMENTS"],10)),a.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(a.attributes["RECENTLY-REMOVED-DATERANGES"]=a.attributes["RECENTLY-REMOVED-DATERANGES"].split(Ge)),o.trigger("data",a)):(i=/^#EXT-X-PART:(.*)$/.exec(e))&&i[1]?((a={type:"tag",tagType:"part"}).attributes=k(i[1]),["DURATION"].forEach(function(e){a.attributes.hasOwnProperty(e)&&(a.attributes[e]=parseFloat(a.attributes[e]));}),["INDEPENDENT","GAP"].forEach(function(e){a.attributes.hasOwnProperty(e)&&(a.attributes[e]=/YES/.test(a.attributes[e]));}),a.attributes.hasOwnProperty("BYTERANGE")&&(a.attributes.byterange=L(a.attributes.BYTERANGE)),o.trigger("data",a)):(i=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(e))&&i[1]?((a={type:"tag",tagType:"server-control"}).attributes=k(i[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(e){a.attributes.hasOwnProperty(e)&&(a.attributes[e]=parseFloat(a.attributes[e]));}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(e){a.attributes.hasOwnProperty(e)&&(a.attributes[e]=/YES/.test(a.attributes[e]));}),o.trigger("data",a)):(i=/^#EXT-X-PART-INF:(.*)$/.exec(e))&&i[1]?((a={type:"tag",tagType:"part-inf"}).attributes=k(i[1]),["PART-TARGET"].forEach(function(e){a.attributes.hasOwnProperty(e)&&(a.attributes[e]=parseFloat(a.attributes[e]));}),o.trigger("data",a)):(i=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(e))&&i[1]?((a={type:"tag",tagType:"preload-hint"}).attributes=k(i[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(e){var t;a.attributes.hasOwnProperty(e)&&(a.attributes[e]=parseInt(a.attributes[e],10),t="BYTERANGE-LENGTH"===e?"length":"offset",a.attributes.byterange=a.attributes.byterange||{},a.attributes.byterange[t]=a.attributes[e],delete a.attributes[e]);}),o.trigger("data",a)):(i=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(e))&&i[1]?((a={type:"tag",tagType:"rendition-report"}).attributes=k(i[1]),["LAST-MSN","LAST-PART"].forEach(function(e){a.attributes.hasOwnProperty(e)&&(a.attributes[e]=parseInt(a.attributes[e],10));}),o.trigger("data",a)):o.trigger("data",{type:"tag",data:e.slice(4)}));}));},r.addParser=function(e){var t=this,r=e.expression,n=e.customType,i=e.dataParser,a=e.segment;"function"!=typeof i&&(i=function i(e){return e}),this.customParsers.push(function(e){if(r.exec(e))return t.trigger("data",{type:"custom",data:i(e),customType:n,segment:a}),!0});},r.addTagMapper=function(e){var t=e.expression,r=e.map,n=function n(e){return t.test(e)?r(e):e};this.tagMappers.push(n);},e}(t),Ke=function Ke(e){return e.toLowerCase().replace(/-(\w)/g,function(e){return e[1].toUpperCase()})},A=function A(t){var r={};return Object.keys(t).forEach(function(e){r[Ke(e)]=t[e];}),r},O=function O(e){var t,r,n,i,a,o=e.serverControl,s=e.targetDuration,e=e.partTargetDuration;o&&(t="#EXT-X-SERVER-CONTROL",r="holdBack",n="partHoldBack",i=s&&3*s,a=e&&2*e,s&&!o.hasOwnProperty(r)&&(o[r]=i,this.trigger("info",{message:t+" defaulting HOLD-BACK to targetDuration * 3 ("+i+")."})),i&&o[r]<i&&(this.trigger("warn",{message:t+" clamping HOLD-BACK ("+o[r]+") to targetDuration * 3 ("+i+")"}),o[r]=i),e&&!o.hasOwnProperty(n)&&(o[n]=3*e,this.trigger("info",{message:t+" defaulting PART-HOLD-BACK to partTargetDuration * 3 ("+o[n]+")."})),e)&&o[n]<a&&(this.trigger("warn",{message:t+" clamping PART-HOLD-BACK ("+o[n]+") to partTargetDuration * 2 ("+a+")."}),o[n]=a);},Xe=function(t){function e(){var a,s,e=t.call(this)||this,c=(e.lineStream=new He,e.parseStream=new ze,e.lineStream.pipe(e.parseStream),Be()(e)),u=[],l={},f=!1,d=function d(){},p={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},y=0,g=(e.manifest={allowCache:!0,discontinuityStarts:[],segments:[]},0),h=0;return e.on("end",function(){l.uri||!l.parts&&!l.preloadHints||(!l.map&&a&&(l.map=a),!l.key&&s&&(l.key=s),l.timeline||"number"!=typeof y||(l.timeline=y),e.manifest.preloadSegment=l);}),e.parseStream.on("data",function(o){var r,i;({tag:function(){({version:function e(){o.version&&(this.manifest.version=o.version);},"allow-cache":function(){this.manifest.allowCache=o.allowed,"allowed"in o||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0);},byterange:function t(){var t={};"length"in o&&((l.byterange=t).length=o.length,"offset"in o||(o.offset=g)),"offset"in o&&((l.byterange=t).offset=o.offset),g=t.offset+t.length;},endlist:function(){this.manifest.endList=!0;},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),0<o.duration&&(l.duration=o.duration),0===o.duration&&(l.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=u;},key:function(){if(o.attributes)if("NONE"===o.attributes.METHOD)s=null;else if(o.attributes.URI)if("com.apple.streamingkeydelivery"===o.attributes.KEYFORMAT)this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:o.attributes};else if("com.microsoft.playready"===o.attributes.KEYFORMAT)this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:o.attributes.URI};else {if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===o.attributes.KEYFORMAT)return -1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(o.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===o.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==o.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):o.attributes.KEYID&&"0x"===o.attributes.KEYID.substring(0,2)?(this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:o.attributes.KEYFORMAT,keyId:o.attributes.KEYID.substring(2)},pssh:Object(Fe.a)(o.attributes.URI.split(",")[1])})):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}));o.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),s={method:o.attributes.METHOD||"AES-128",uri:o.attributes.URI},"undefined"!=typeof o.attributes.IV&&(s.iv=o.attributes.IV);}else this.trigger("warn",{message:"ignoring key declaration without URI"});else this.trigger("warn",{message:"ignoring key declaration without attribute list"});},"media-sequence":function(){isFinite(o.number)?this.manifest.mediaSequence=o.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+o.number});},"discontinuity-sequence":function(){isFinite(o.number)?(this.manifest.discontinuitySequence=o.number,y=o.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+o.number});},"playlist-type":function(){/VOD|EVENT/.test(o.playlistType)?this.manifest.playlistType=o.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+o.playlist});},map:function(){a={},o.uri&&(a.uri=o.uri),o.byterange&&(a.byterange=o.byterange),s&&(a.key=s);},"stream-inf":function(){this.manifest.playlists=u,this.manifest.mediaGroups=this.manifest.mediaGroups||p,o.attributes?(l.attributes||(l.attributes={}),je()(l.attributes,o.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"});},media:function(){var e;this.manifest.mediaGroups=this.manifest.mediaGroups||p,o.attributes&&o.attributes.TYPE&&o.attributes["GROUP-ID"]&&o.attributes.NAME?((e=this.manifest.mediaGroups[o.attributes.TYPE])[o.attributes["GROUP-ID"]]=e[o.attributes["GROUP-ID"]]||{},r=e[o.attributes["GROUP-ID"]],(i={"default":/yes/i.test(o.attributes.DEFAULT)}).autoselect=!!i["default"]||/yes/i.test(o.attributes.AUTOSELECT),o.attributes.LANGUAGE&&(i.language=o.attributes.LANGUAGE),o.attributes.URI&&(i.uri=o.attributes.URI),o.attributes["INSTREAM-ID"]&&(i.instreamId=o.attributes["INSTREAM-ID"]),o.attributes.CHARACTERISTICS&&(i.characteristics=o.attributes.CHARACTERISTICS),o.attributes.FORCED&&(i.forced=/yes/i.test(o.attributes.FORCED)),r[o.attributes.NAME]=i):this.trigger("warn",{message:"ignoring incomplete or missing media group"});},discontinuity:function(){y+=1,l.discontinuity=!0,this.manifest.discontinuityStarts.push(u.length);},"program-date-time":function(){"undefined"==typeof this.manifest.dateTimeString&&(this.manifest.dateTimeString=o.dateTimeString,this.manifest.dateTimeObject=o.dateTimeObject),l.dateTimeString=o.dateTimeString,l.dateTimeObject=o.dateTimeObject;},targetduration:function(){!isFinite(o.duration)||o.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+o.duration}):(this.manifest.targetDuration=o.duration,O.call(this,this.manifest));},start:function(){!o.attributes||isNaN(o.attributes["TIME-OFFSET"])?this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"}):this.manifest.start={timeOffset:o.attributes["TIME-OFFSET"],precise:o.attributes.PRECISE};},"cue-out":function(){l.cueOut=o.data;},"cue-out-cont":function(){l.cueOutCont=o.data;},"cue-in":function(){l.cueIn=o.data;},skip:function(){this.manifest.skip=A(o.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",o.attributes,["SKIPPED-SEGMENTS"]);},part:function n(){var r=this,e=(f=!0,this.manifest.segments.length),n=A(o.attributes),t=(l.parts=l.parts||[],l.parts.push(n),n.byterange&&(n.byterange.hasOwnProperty("offset")||(n.byterange.offset=h),h=n.byterange.offset+n.byterange.length),l.parts.length-1);this.warnOnMissingAttributes_("#EXT-X-PART #"+t+" for segment #"+e,o.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach(function(e,t){e.hasOwnProperty("lastPart")||r.trigger("warn",{message:"#EXT-X-RENDITION-REPORT #"+t+" lacks required attribute(s): LAST-PART"});});},"server-control":function(){var e=this.manifest.serverControl=A(o.attributes);e.hasOwnProperty("canBlockReload")||(e.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),O.call(this,this.manifest),e.canSkipDateranges&&!e.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"});},"preload-hint":function(){var e=this.manifest.segments.length,t=A(o.attributes),r=t.type&&"PART"===t.type,n=(l.preloadHints=l.preloadHints||[],l.preloadHints.push(t),!t.byterange||t.byterange.hasOwnProperty("offset")||(t.byterange.offset=r?h:0,r&&(h=t.byterange.offset+t.byterange.length)),l.preloadHints.length-1);if(this.warnOnMissingAttributes_("#EXT-X-PRELOAD-HINT #"+n+" for segment #"+e,o.attributes,["TYPE","URI"]),t.type)for(var i=0;i<l.preloadHints.length-1;i++){var a=l.preloadHints[i];a.type&&a.type===t.type&&this.trigger("warn",{message:"#EXT-X-PRELOAD-HINT #"+n+" for segment #"+e+" has the same TYPE "+t.type+" as preload hint #"+i});}},"rendition-report":function(){var e=A(o.attributes),e=(this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(e),this.manifest.renditionReports.length-1),t=["LAST-MSN","URI"];f&&t.push("LAST-PART"),this.warnOnMissingAttributes_("#EXT-X-RENDITION-REPORT #"+e,o.attributes,t);},"part-inf":function(){this.manifest.partInf=A(o.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",o.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),O.call(this,this.manifest);}}[o.tagType]||d).call(c);},uri:function(){l.uri=o.uri,u.push(l),!this.manifest.targetDuration||"duration"in l||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),l.duration=this.manifest.targetDuration),s&&(l.key=s),l.timeline=y,a&&(l.map=a),h=0,l={};},comment:function(){},custom:function(){o.segment?(l.custom=l.custom||{},l.custom[o.customType]=o.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[o.customType]=o.data);}})[o.type].call(c);}),e}Ue()(e,t);var r=e.prototype;return r.warnOnMissingAttributes_=function(e,t,r){var n=[];r.forEach(function(e){t.hasOwnProperty(e)||n.push(e);}),n.length&&this.trigger("warn",{message:e+" lacks required attribute(s): "+n.join(", ")});},r.push=function(e){this.lineStream.push(e);},r.end=function(){this.lineStream.push("\n"),this.trigger("end");},r.addParser=function(e){this.parseStream.addParser(e);},r.addTagMapper=function(e){this.parseStream.addTagMapper(e);},e}(t);function x(e){return (x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=x(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=x(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==x(e)?e:e+""}(n.key),n);}}r=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e,this.log=this.factory.getInstance("MyLogger"),this.haveMaster=!1,this.manifestType=null,this.needInit=!1,this.manifest={},this.textManifest="",this.live=!0;}return e=t,(r=[{key:"manageManifest",value:function(e,a,t){var r,n=this,i=function i(e){return String.fromCharCode.apply(null,new Uint8Array(e))},o=null;this.manifestType!==t&&(this.manifestType=t,this.haveMaster=!1);try{if(r="string"!=typeof e?i(e):e,"MPD"===t)o=_e(r,{manifestUri:a}),this.manifest=o,this.textManifest=r,o&&o.playlists&&o.playlists[0]&&o.playlists[0].segments&&o.playlists[0].segments[0]&&o.playlists[0].segments[0].map&&(this.needInit=!0),this.fillAnalyticsFromManifest();else if(-1<t.indexOf("M3U8")){var s=new Xe;if(s.push(r),s.end(),!1===this.haveMaster)(o=s.manifest).playlists===undefined&&o.segments!==undefined&&(o.playlists=[],o.segments[0].map?(this.needInit=!0,o.segments=o.segments.map(function(e,t){var r;return -1===e.uri.indexOf("http")?((r=a.split("/")).pop(),r=r.join("/")+"/",e.map.resolvedUri=new URL(e.uri,r).href,e.resolvedUri=new URL(e.uri,r).href):(e.map.resolvedUri=e.map.uri,e.resolvedUri=e.uri),e.number=t+o.mediaSequence,e})):o.segments=o.segments.map(function(e,t){var r;return -1===e.uri.indexOf("http")?((r=a.split("/")).pop(),r=r.join("/")+"/",e.resolvedUri=new URL(e.uri,r).href):e.resolvedUri=e.uri,e.number=t+o.mediaSequence,e}),o.playlists.push({attributes:{BANDWIDTH:3e6},segments:o.segments,uri:a})),this.manifest=o,this.textManifest=r,this.haveMaster=!0;else {for(var o=s.manifest,c=this.manifest,u=(c.endList=o.endList,[]),l=!1,f=function f(){(y=c.playlists[d]).attributes&&y.attributes.AUDIO&&-1===u.findIndex(function(e){return e===y.attributes.AUDIO})&&u.push(y.attributes.AUDIO);var i=y.uri.replace(/\.\.\//g,"").replace(/\.\//g,"").split("?")[0];if(-1<a.indexOf(i))return l=!0,y.segments=o.segments,y.segments[0].map?(n.needInit=!0,y.segments=y.segments.map(function(e,t){var r,n="";return -1===e.uri.indexOf("http")?(-1<i.indexOf("http")?((r=i.split("/")).pop(),n=r.join("/")+"/"):(r=i.split("/"),n=a.replace(r[r.length-1],""),0<r.length&&r.pop()),e.map.resolvedUri=new URL(e.uri,n).href,e.resolvedUri=new URL(e.uri,n).href):(e.map.resolvedUri=e.map.uri,e.resolvedUri=e.uri),e.number=t+o.mediaSequence,e})):y.segments=y.segments.map(function(e,t){var r,n="";return -1===e.uri.indexOf("http")?(-1<i.indexOf("http")?((r=i.split("/")).pop(),n=r.join("/")+"/"):(r=i.split("/"),n=a.replace(r[r.length-1],""),0<r.length&&r.pop()),e.resolvedUri=new URL(e.uri,n).href):e.resolvedUri=e.uri,e.number=t+o.mediaSequence,e}),1},d=0;d<c.playlists.length&&!f();d++);if(!1===l)for(d=0;d<u.length;d++){var p=u[d];if(c.mediaGroups.AUDIO[p]){var y,g,h=function h(){var i=(y=c.mediaGroups.AUDIO[p][g]).uri.replace(/\.\.\//g,"").replace(/\.\//g,"").split("?")[0];if(-1<a.indexOf(i))return l=!0,y.segments=o.segments,y.segments[0].map?(n.needInit=!0,y.segments=y.segments.map(function(e,t){var r,n="";return -1===e.uri.indexOf("http")?(-1<i.indexOf("http")?((r=i.split("/")).pop(),n=r.join("/")+"/"):(r=i.split("/"),n=a.replace(r[r.length-1],""),0<r.length&&r.pop()),e.map.resolvedUri=new URL(e.uri,n).href,e.resolvedUri=new URL(e.uri,n).href):(e.map.resolvedUri=e.map.uri,e.resolvedUri=e.uri),e.number=t+o.mediaSequence,e})):y.segments=y.segments.map(function(e,t){var r,n="";return -1===e.uri.indexOf("http")?(-1<i.indexOf("http")?((r=i.split("/")).pop(),n=r.join("/")+"/"):(r=i.split("/"),n=a.replace(r[r.length-1],""),0<r.length&&r.pop()),e.resolvedUri=new URL(e.uri,n).href):e.resolvedUri=e.uri,e.number=t+o.mediaSequence,e}),1};for(g in c.mediaGroups.AUDIO[p])if(h())break}if(!0===l)break}!1===l&&this.log.debug("Playlist not found in base M3U8"),this.manifest=c,this.textManifest=r,this.fillAnalyticsFromManifest();}}}catch(m){return this.log.debug(m),this.textManifest="",null}try{o.playlists&&(o.playlists=o.playlists.sort(function(e,t){return e.attributes.BANDWIDTH-t.attributes.BANDWIDTH}));}catch(m){this.log.error(m);}return o}},{key:"fillAnalyticsFromManifest",value:function(){var e,t,r=this.factory.getInstance("AnalyticsService");this.factory.getInstance("VariableSettings"),this.factory.getInstance("GeneralSettings");try{""!==this.textManifest&&this.isLiveManifest(this.textManifest)&&(r.stream_type="live"),this.isLiveManifest()||(r.stream_type="vod"),"M3U8"===this.manifestType&&(r.protocol="hls"),"MPD"===this.manifestType&&(r.protocol="dash"),"webrts"===this.manifestType&&(r.protocol="webrts"),this.manifest&&this.manifest.playlists&&0<this.manifest.playlists.length&&0<=this.manifest.playlists.findIndex(function(e){return e.segments})&&(e=this.manifest.playlists.findIndex(function(e){return e.segments}),r.q_nbr=this.manifest.playlists.length,r.seg_dur=this.manifest.playlists[e].segments[0].duration,r.seg_nbr=this.manifest.playlists[e].segments.length,r.seg_ext=(t=this.manifest.playlists[e].segments[0].resolvedUri,(t=(t=new URL(t).pathname).substring(t.lastIndexOf("/")+1)).includes(".")?t.substring(t.lastIndexOf(".")+1):""));}catch(n){}}},{key:"getManifestType",value:function(){return this.manifestType}},{key:"getHaveMaster",value:function(){return this.haveMaster}},{key:"getNeedInit",value:function(){return this.needInit}},{key:"getManifest",value:function(){return this.manifest}},{key:"getTextManifest",value:function(){return this.textManifest}},{key:"isLiveManifest",value:function(e){return "MPD"===this.manifestType?-1<this.textManifest.indexOf('type="dynamic"')?this.live=!0:this.live=!1:"M3U8"===this.manifestType&&-1===(e||this.textManifest).indexOf("#EXT-X-ENDLIST")?this.live=!0:this.live=!1}},{key:"validTestLive",value:function(e){return "MPD"===this.manifestType||"M3U8"!==this.manifestType||-1<e.indexOf("#EXT-X-TARGETDURATION")}},{key:"isEmptyManifest",value:function(){return ""===this.textManifest}},{key:"getUpdatePeriod",value:function(){var e=undefined;return "MPD"===this.manifestType?(e=this.manifest)&&e.minimumUpdatePeriod?e.minimumUpdatePeriod/1e3:null:"M3U8"===this.manifestType&&(e=this.manifest)&&e.minimumUpdatePeriod?e.minimumUpdatePeriod/1e3:null}},{key:"changeUpdatePeriod",value:function(e,t){var r,n,i;return "MPD"===this.manifestType?(r=-1<e.indexOf('type="dynamic"')?"dynamic":"static",t="PT".concat(t,"S"),-1<(n=e.indexOf("minimumUpdatePeriod="))?(i=e.indexOf('"',n+1),i=e.indexOf('"',i+1),e.replace(e.substring(n,i+1),'minimumUpdatePeriod="'.concat(t,'"'))):e.replace('type="'.concat(r,'"'),'type="'.concat(r,'" minimumUpdatePeriod="').concat(t,'"'))):"M3U8"===this.manifestType?e.replace("#EXT-X-ENDLIST",""):e}},{key:"removeAverageBandwidth",value:function(e){var t="";try{t=e;}catch(r){}return t}}])&&Qe(e.prototype,r),n&&Qe(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();_.a=r;},function(e,t){function r(e){return (r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n=function(){return this}();try{n=n||new Function("return this")();}catch(i){"object"===("undefined"==typeof window?"undefined":r(window))&&(n=window);}e.exports=n;},function(e,k,A){!function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var D=A(65),a=A(66),s=A(67);function r(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function c(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return f.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=f.prototype:(e=null===e?new f(t):e).length=t,e}function f(e,t,r){if(!(f.TYPED_ARRAY_SUPPORT||this instanceof f))return new f(e,t,r);if("number"!=typeof e)return n(this,e,t,r);if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return o(this,e)}function n(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer){var i=e,a=t,o=r;if(a.byteLength,o<0||a.byteLength<o)throw new RangeError("'offset' is out of bounds");if(a.byteLength<o+(n||0))throw new RangeError("'length' is out of bounds");return a=o===undefined&&n===undefined?new Uint8Array(a):n===undefined?new Uint8Array(a,o):new Uint8Array(a,o,n),f.TYPED_ARRAY_SUPPORT?(i=a).__proto__=f.prototype:i=u(i,a),i}if("string"!=typeof t){o=e,n=t;if(f.isBuffer(n))return a=0|l(n.length),0!==(o=c(o,a)).length&&n.copy(o,0,0,a),o;if(n){if("undefined"!=typeof ArrayBuffer&&n.buffer instanceof ArrayBuffer||"length"in n)return "number"!=typeof n.length||function(e){return e!=e}(n.length)?c(o,0):u(o,n);if("Buffer"===n.type&&s(n.data))return u(o,n.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}i=e,n=t,e=r;if(f.isEncoding(e="string"==typeof e&&""!==e?e:"utf8"))return t=0|d(n,e),i=(n=(i=c(i,t)).write(n,e))!==t?i.slice(0,n):i;throw new TypeError('"encoding" must be a valid string encoding')}function i(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function o(e,t){if(i(t),e=c(e,t<0?0:0|l(t)),!f.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function u(e,t){var r=t.length<0?0:0|l(t.length);e=c(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function l(e){if(r()<=e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function d(e,t){if(f.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;var r=(e="string"!=typeof e?""+e:e).length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case undefined:return N(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return E(e).length;default:if(n)return N(e).length;t=(""+t).toLowerCase(),n=!0;}}function t(e,t,r){var n,i=!1;if((t=t===undefined||t<0?0:t)>this.length)return "";if((r=r===undefined||r>this.length?this.length:r)<=0)return "";if((r>>>=0)<=(t>>>=0))return "";for(e=e||"utf8";;)switch(e){case"hex":var a=this,o=t,s=r,c=a.length;(!s||s<0||c<s)&&(s=c);for(var u="",l=o=!o||o<0?0:o;l<s;++l)u+=function(e){return e<16?"0"+e.toString(16):e.toString(16)}(a[l]);return u;case"utf8":case"utf-8":return T(this,t,r);case"ascii":var f=this,c=t,d=r,p="";d=Math.min(f.length,d);for(var y=c;y<d;++y)p+=String.fromCharCode(127&f[y]);return p;case"latin1":case"binary":var g=this,o=t,h=r,m="";h=Math.min(g.length,h);for(var b=o;b<h;++b)m+=String.fromCharCode(g[b]);return m;case"base64":return n=this,S=r,0===(v=t)&&S===n.length?D.fromByteArray(n):D.fromByteArray(n.slice(v,S));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(var v=t,S=r,w=this.slice(v,S),I="",P=0;P<w.length;P+=2)I+=String.fromCharCode(w[P]+256*w[P+1]);return I;default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0;}}function p(e,t,r){var n=e[t];e[t]=e[r],e[r]=n;}function y(e,t,r,n,i){if(0===e.length)return -1;if("string"==typeof r?(n=r,r=0):2147483647<r?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,(r=(r=isNaN(r)?i?0:e.length-1:r)<0?e.length+r:r)>=e.length){if(i)return -1;r=e.length-1;}else if(r<0){if(!i)return -1;r=0;}if("string"==typeof t&&(t=f.from(t,n)),f.isBuffer(t))return 0===t.length?-1:g(e,t,r,n,i);if("number"==typeof t)return t&=255,f.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?(i?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,r):g(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function g(e,t,r,n,i){var a=1,o=e.length,s=t.length;if(n!==undefined&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return -1;o/=a=2,s/=2,r/=2;}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i)for(var u=-1,l=r;l<o;l++)if(c(e,l)===c(t,-1===u?0:l-u)){if(l-(u=-1===u?l:u)+1===s)return u*a}else -1!==u&&(l-=l-u),u=-1;else for(l=r=o<r+s?o-s:r;0<=l;l--){for(var f=!0,d=0;d<s;d++)if(c(e,l+d)!==c(t,d)){f=!1;break}if(f)return l}return -1}function h(e,t,r,n){return L(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function m(e,t,r,n){return L(function(e,t){for(var r,n,i=[],a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,i.push(r%256),i.push(n);return i}(t,e.length-r),e,r,n)}function T(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var a,o,s,c,u=e[i],l=null,f=239<u?4:223<u?3:191<u?2:1;if(i+f<=r)switch(f){case 1:u<128&&(l=u);break;case 2:128==(192&(a=e[i+1]))&&127<(c=(31&u)<<6|63&a)&&(l=c);break;case 3:a=e[i+1],o=e[i+2],128==(192&a)&&128==(192&o)&&2047<(c=(15&u)<<12|(63&a)<<6|63&o)&&(c<55296||57343<c)&&(l=c);break;case 4:a=e[i+1],o=e[i+2],s=e[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&65535<(c=(15&u)<<18|(63&a)<<12|(63&o)<<6|63&s)&&c<1114112&&(l=c);}null===l?(l=65533,f=1):65535<l&&(n.push((l-=65536)>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=f;}var d=n,p=d.length;if(p<=b)return String.fromCharCode.apply(String,d);for(var y="",g=0;g<p;)y+=String.fromCharCode.apply(String,d.slice(g,g+=b));return y}k.Buffer=f,k.SlowBuffer=function(e){+e!=e&&(e=0);return f.alloc(+e)},k.INSPECT_MAX_BYTES=50,f.TYPED_ARRAY_SUPPORT=e.TYPED_ARRAY_SUPPORT!==undefined?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return !1}}(),k.kMaxLength=r(),f.poolSize=8192,f._augment=function(e){return e.__proto__=f.prototype,e},f.from=function(e,t,r){return n(null,e,t,r)},f.TYPED_ARRAY_SUPPORT&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!=typeof Symbol)&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0}),f.alloc=function(e,t,r){return n=null,t=t,r=r,i(e=e),!(e<=0)&&t!==undefined?"string"==typeof r?c(n,e).fill(t,r):c(n,e).fill(t):c(n,e);var n;},f.allocUnsafe=function(e){return o(null,e)},f.allocUnsafeSlow=function(e){return o(null,e)},f.isBuffer=function(e){return !(null==e||!e._isBuffer)},f.compare=function(e,t){if(!f.isBuffer(e)||!f.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,a=Math.min(r,n);i<a;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},f.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return !0;default:return !1}},f.concat=function(e,t){if(!s(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return f.alloc(0);if(t===undefined)for(i=t=0;i<e.length;++i)t+=e[i].length;for(var r=f.allocUnsafe(t),n=0,i=0;i<e.length;++i){var a=e[i];if(!f.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,n),n+=a.length;}return r},f.byteLength=d,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)p(this,t,t+1);return this},f.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)p(this,t,t+3),p(this,t+1,t+2);return this},f.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)p(this,t,t+7),p(this,t+1,t+6),p(this,t+2,t+5),p(this,t+3,t+4);return this},f.prototype.toString=function(){var e=0|this.length;return 0==e?"":0===arguments.length?T(this,0,e):t.apply(this,arguments)},f.prototype.equals=function(e){if(f.isBuffer(e))return this===e||0===f.compare(this,e);throw new TypeError("Argument must be a Buffer")},f.prototype.inspect=function(){var e="",t=k.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t)&&(e+=" ... "),"<Buffer "+e+">"},f.prototype.compare=function(e,t,r,n,i){if(!f.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(t===undefined&&(t=0),r===undefined&&(r=e?e.length:0),n===undefined&&(n=0),i===undefined&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(i<=n&&r<=t)return 0;if(i<=n)return -1;if(r<=t)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0),s=Math.min(a,o),c=this.slice(n,i),u=e.slice(t,r),l=0;l<s;++l)if(c[l]!==u[l]){a=c[l],o=u[l];break}return a<o?-1:o<a?1:0},f.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},f.prototype.indexOf=function(e,t,r){return y(this,e,t,r,!0)},f.prototype.lastIndexOf=function(e,t,r){return y(this,e,t,r,!1)},f.prototype.write=function(e,t,r,n){if(t===undefined)n="utf8",r=this.length,t=0;else if(r===undefined&&"string"==typeof t)n=t,r=this.length,t=0;else {if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,n===undefined&&(n="utf8")):(n=r,r=undefined);}var i=this.length-t;if((r===undefined||i<r)&&(r=i),0<e.length&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n=n||"utf8";for(var a,o,s,c=!1;;)switch(n){case"hex":var u=this,l=e,f=t,d=r,p=(f=Number(f)||0,u.length-f);if((!d||p<(d=Number(d)))&&(d=p),(p=l.length)%2!=0)throw new TypeError("Invalid hex string");p/2<d&&(d=p/2);for(var y=0;y<d;++y){var g=parseInt(l.substr(2*y,2),16);if(isNaN(g))return y;u[f+y]=g;}return y;case"utf8":case"utf-8":return p=t,s=r,L(N(e,(o=this).length-p),o,p,s);case"ascii":return h(this,e,t,r);case"latin1":case"binary":return h(this,e,t,r);case"base64":return o=this,s=t,a=r,L(E(e),o,s,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return m(this,e,t,r);default:if(c)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),c=!0;}},f.prototype.toJSON=function(){return {type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var b=4096;function v(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(r<e+t)throw new RangeError("Trying to access beyond buffer length")}function S(e,t,r,n,i,a){if(!f.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<t||t<a)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function w(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,a=Math.min(e.length-r,2);i<a;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i);}function I(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,a=Math.min(e.length-r,4);i<a;++i)e[r+i]=t>>>8*(n?i:3-i)&255;}function P(e,t,r,n){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function R(e,t,r,n,i){return i||P(e,0,r,4),a.write(e,t,r,n,23,4),r+4}function q(e,t,r,n,i){return i||P(e,0,r,8),a.write(e,t,r,n,52,8),r+8}f.prototype.slice=function(e,t){var r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):r<e&&(e=r),(t=t===undefined?r:~~t)<0?(t+=r)<0&&(t=0):r<t&&(t=r),t<e&&(t=e),f.TYPED_ARRAY_SUPPORT)(i=this.subarray(e,t)).__proto__=f.prototype;else for(var n=t-e,i=new f(n,undefined),a=0;a<n;++a)i[a]=this[a+e];return i},f.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||v(e,t,this.length);for(var n=this[e],i=1,a=0;++a<t&&(i*=256);)n+=this[e+a]*i;return n},f.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||v(e,t,this.length);for(var n=this[e+--t],i=1;0<t&&(i*=256);)n+=this[e+--t]*i;return n},f.prototype.readUInt8=function(e,t){return t||v(e,1,this.length),this[e]},f.prototype.readUInt16LE=function(e,t){return t||v(e,2,this.length),this[e]|this[e+1]<<8},f.prototype.readUInt16BE=function(e,t){return t||v(e,2,this.length),this[e]<<8|this[e+1]},f.prototype.readUInt32LE=function(e,t){return t||v(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},f.prototype.readUInt32BE=function(e,t){return t||v(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},f.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||v(e,t,this.length);for(var n=this[e],i=1,a=0;++a<t&&(i*=256);)n+=this[e+a]*i;return (i*=128)<=n&&(n-=Math.pow(2,8*t)),n},f.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||v(e,t,this.length);for(var n=t,i=1,a=this[e+--n];0<n&&(i*=256);)a+=this[e+--n]*i;return (i*=128)<=a&&(a-=Math.pow(2,8*t)),a},f.prototype.readInt8=function(e,t){return t||v(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},f.prototype.readInt16LE=function(e,t){t||v(e,2,this.length);t=this[e]|this[e+1]<<8;return 32768&t?4294901760|t:t},f.prototype.readInt16BE=function(e,t){t||v(e,2,this.length);t=this[e+1]|this[e]<<8;return 32768&t?4294901760|t:t},f.prototype.readInt32LE=function(e,t){return t||v(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},f.prototype.readInt32BE=function(e,t){return t||v(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},f.prototype.readFloatLE=function(e,t){return t||v(e,4,this.length),a.read(this,e,!0,23,4)},f.prototype.readFloatBE=function(e,t){return t||v(e,4,this.length),a.read(this,e,!1,23,4)},f.prototype.readDoubleLE=function(e,t){return t||v(e,8,this.length),a.read(this,e,!0,52,8)},f.prototype.readDoubleBE=function(e,t){return t||v(e,8,this.length),a.read(this,e,!1,52,8)},f.prototype.writeUIntLE=function(e,t,r,n){e=+e,t|=0,r|=0,n||S(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,a=0;for(this[t]=255&e;++a<r&&(i*=256);)this[t+a]=e/i&255;return t+r},f.prototype.writeUIntBE=function(e,t,r,n){e=+e,t|=0,r|=0,n||S(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,a=1;for(this[t+i]=255&e;0<=--i&&(a*=256);)this[t+i]=e/a&255;return t+r},f.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||S(this,e,t,1,255,0),f.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},f.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||S(this,e,t,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):w(this,e,t,!0),t+2},f.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||S(this,e,t,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):w(this,e,t,!1),t+2},f.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||S(this,e,t,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):I(this,e,t,!0),t+4},f.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||S(this,e,t,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):I(this,e,t,!1),t+4},f.prototype.writeIntLE=function(e,t,r,n){e=+e,t|=0,n||S(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);var i=0,a=1,o=0;for(this[t]=255&e;++i<r&&(a*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/a>>0)-o&255;return t+r},f.prototype.writeIntBE=function(e,t,r,n){e=+e,t|=0,n||S(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);var i=r-1,a=1,o=0;for(this[t+i]=255&e;0<=--i&&(a*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/a>>0)-o&255;return t+r},f.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||S(this,e,t,1,127,-128),f.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&(e=e<0?255+e+1:e),t+1},f.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||S(this,e,t,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):w(this,e,t,!0),t+2},f.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||S(this,e,t,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):w(this,e,t,!1),t+2},f.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||S(this,e,t,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):I(this,e,t,!0),t+4},f.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||S(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),f.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):I(this,e,t,!1),t+4},f.prototype.writeFloatLE=function(e,t,r){return R(this,e,t,!0,r)},f.prototype.writeFloatBE=function(e,t,r){return R(this,e,t,!1,r)},f.prototype.writeDoubleLE=function(e,t,r){return q(this,e,t,!0,r)},f.prototype.writeDoubleBE=function(e,t,r){return q(this,e,t,!1,r)},f.prototype.copy=function(e,t,r,n){if(r=r||0,n||0===n||(n=this.length),t>=e.length&&(t=e.length),(n=0<n&&n<r?r:n)===r)return 0;if(0===e.length||0===this.length)return 0;if((t=t||0)<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length);var i,a=(n=e.length-t<n-r?e.length-t+r:n)-r;if(this===e&&r<t&&t<n)for(i=a-1;0<=i;--i)e[i+t]=this[i+r];else if(a<1e3||!f.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+a),t);return a},f.prototype.fill=function(e,t,r,n){if("string"==typeof e){var i;if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length&&(i=e.charCodeAt(0))<256&&(e=i),n!==undefined&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!f.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else "number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(!(r<=t))if(t>>>=0,r=r===undefined?this.length:r>>>0,"number"==typeof(e=e||0))for(s=t;s<r;++s)this[s]=e;else for(var a=f.isBuffer(e)?e:N(new f(e,n).toString()),o=a.length,s=0;s<r-t;++s)this[s+t]=a[s%o];return this};var M=/[^+\/0-9A-Za-z-_]/g;function N(e,t){t=t||Infinity;for(var r,n=e.length,i=null,a=[],o=0;o<n;++o){if(55295<(r=e.charCodeAt(o))&&r<57344){if(!i){if(56319<r){-1<(t-=3)&&a.push(239,191,189);continue}if(o+1===n){-1<(t-=3)&&a.push(239,191,189);continue}i=r;continue}if(r<56320){-1<(t-=3)&&a.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320);}else i&&-1<(t-=3)&&a.push(239,191,189);if(i=null,r<128){if(--t<0)break;a.push(r);}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128);}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128);}else {if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128);}}return a}function E(e){return D.toByteArray(function(e){var t;if((e=((t=e).trim?t.trim():t.replace(/^\s+|\s+$/g,"")).replace(M,"")).length<2)return "";for(;e.length%4!=0;)e+="=";return e}(e))}function L(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}}.call(this,A(26));},function(C,e,t){function _(e){return (_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var t=t(11),o=t.find,S=t.NAMESPACE;function U(e){return ""!==e}function j(e,t){return e.hasOwnProperty(t)||(e[t]=!0),e}function B(e){return e?(e=(e=e)?e.split(/[\t\n\f\r ]+/).filter(U):[],Object.keys(e.reduce(j,{}))):[]}function i(e,t){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);}function r(e,t){var r,n=e.prototype;n instanceof t||((r=function r(){}).prototype=t.prototype,i(n,r=new r),e.prototype=n=r),n.constructor!=e&&("function"!=typeof e&&console.error("unknown Class:"+e),n.constructor=e);}var n,t={},a=(t.ELEMENT_NODE=1,t.ATTRIBUTE_NODE=2,t.TEXT_NODE=3,t.CDATA_SECTION_NODE=4,t.ENTITY_REFERENCE_NODE=5,t.ENTITY_NODE=6,t.PROCESSING_INSTRUCTION_NODE=7,t.COMMENT_NODE=8,t.DOCUMENT_NODE=9,t.DOCUMENT_TYPE_NODE=10,t.DOCUMENT_FRAGMENT_NODE=11,t.NOTATION_NODE=12,{}),s={},c=(a.INDEX_SIZE_ERR=(s[1]="Index size error",1),a.DOMSTRING_SIZE_ERR=(s[2]="DOMString size error",2),a.HIERARCHY_REQUEST_ERR=(s[3]="Hierarchy request error",3)),F=(a.WRONG_DOCUMENT_ERR=(s[4]="Wrong document",4),a.INVALID_CHARACTER_ERR=(s[5]="Invalid character",5),a.NO_DATA_ALLOWED_ERR=(s[6]="No data allowed",6),a.NO_MODIFICATION_ALLOWED_ERR=(s[7]="No modification allowed",7),a.NOT_FOUND_ERR=(s[8]="Not found",8));a.NOT_SUPPORTED_ERR=(s[9]="Not supported",9),a.INUSE_ATTRIBUTE_ERR=(s[10]="Attribute in use",10),a.INVALID_STATE_ERR=(s[11]="Invalid state",11),a.SYNTAX_ERR=(s[12]="Syntax error",12),a.INVALID_MODIFICATION_ERR=(s[13]="Invalid modification",13),a.NAMESPACE_ERR=(s[14]="Invalid namespace",14),a.INVALID_ACCESS_ERR=(s[15]="Invalid access",15);function u(e,t){var r;return t instanceof Error?r=t:(r=this,Error.call(this,s[e]),this.message=s[e],Error.captureStackTrace&&Error.captureStackTrace(this,u)),r.code=e,t&&(this.message=this.message+": "+t),r}function d(){}function l(e,t){this._node=e,this._refresh=t,f(this);}function f(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!==t){var r=e._refresh(e._node);if(x(e,"length",r.length),!e.$$length||r.length<e.$$length)for(var n=r.length;n in e;n++)Object.prototype.hasOwnProperty.call(e,n)&&delete e[n];i(r,e),e._inc=t;}}function p(){}function H(e,t){for(var r=e.length;r--;)if(e[r]===t)return r}function G(e,t,r,n){n?t[H(t,n)]=r:t[t.length++]=r,e&&(t=(r.ownerElement=e).ownerDocument)&&(n&&X(t,e,n),n=e,e=r,(r=t)&&r._inc++,e.namespaceURI===S.XMLNS)&&(n._nsMap[e.prefix?e.localName:""]=e.value);}function V(e,t,r){var n=H(t,r);if(!(0<=n))throw new u(F,new Error(e.tagName+"@"+r));for(var i,a=t.length-1;n<a;)t[n]=t[++n];t.length=a,e&&(i=e.ownerDocument)&&(X(i,e,r),r.ownerElement=null);}function z(){}function y(){}function K(e){return ("<"==e?"&lt;":">"==e&&"&gt;")||("&"==e?"&amp;":'"'==e&&"&quot;")||"&#"+e.charCodeAt()+";"}function g(e,t){if(t(e))return 1;if(e=e.firstChild)do{if(g(e,t))return 1}while(e=e.nextSibling)}function h(){this.ownerDocument=this;}function X(e,t,r){e&&e._inc++,r.namespaceURI===S.XMLNS&&delete t._nsMap[r.prefix?r.localName:""];}function m(e,t,r){if(e&&e._inc){e._inc++;var n=t.childNodes;if(r)n[n.length++]=r;else {for(var i=t.firstChild,a=0;i;)i=(n[a++]=i).nextSibling;n.length=a,delete n[n.length];}}}function Q(e,t){var r=t.previousSibling,n=t.nextSibling;return r?r.nextSibling=n:e.firstChild=n,n?n.previousSibling=r:e.lastChild=r,t.parentNode=null,t.previousSibling=null,t.nextSibling=null,m(e.ownerDocument,e),t}function b(e){return e&&e.nodeType===y.DOCUMENT_TYPE_NODE}function v(e){return e&&e.nodeType===y.ELEMENT_NODE}function w(e){return e&&e.nodeType===y.TEXT_NODE}function W(e,t){var r,e=e.childNodes||[];if(!o(e,v)&&!b(t))return r=o(e,b),!(t&&r&&e.indexOf(r)>e.indexOf(t))}function Y(e,t){var r,e=e.childNodes||[];if(!o(e,function(e){return v(e)&&e!==t}))return r=o(e,b),!(t&&r&&e.indexOf(r)>e.indexOf(t))}function $(e,t,r){if(!(n=e)||n.nodeType!==y.DOCUMENT_NODE&&n.nodeType!==y.DOCUMENT_FRAGMENT_NODE&&n.nodeType!==y.ELEMENT_NODE)throw new u(c,"Unexpected parent node type "+e.nodeType);var n;if(r&&r.parentNode!==e)throw new u(F,"child not in parent");if(!(n=t)||!(v(n)||w(n)||b(n)||n.nodeType===y.DOCUMENT_FRAGMENT_NODE||n.nodeType===y.COMMENT_NODE||n.nodeType===y.PROCESSING_INSTRUCTION_NODE)||b(t)&&e.nodeType!==y.DOCUMENT_NODE)throw new u(c,"Unexpected node type "+t.nodeType+" for parent node type "+e.nodeType)}function J(e,t,r){var n=e.childNodes||[],i=t.childNodes||[];if(t.nodeType===y.DOCUMENT_FRAGMENT_NODE){var a=i.filter(v);if(1<a.length||o(i,w))throw new u(c,"More than one element or text in fragment");if(1===a.length&&!W(e,r))throw new u(c,"Element in fragment can not be inserted before doctype")}if(v(t)&&!W(e,r))throw new u(c,"Only one element can be added and only after doctype");if(b(t)){if(o(n,b))throw new u(c,"Only one doctype is allowed");i=o(n,v);if(r&&n.indexOf(i)<n.indexOf(r))throw new u(c,"Doctype can only be inserted before an element");if(!r&&i)throw new u(c,"Doctype can not be appended since element is present")}}function Z(e,t,r){var n=e.childNodes||[],i=t.childNodes||[];if(t.nodeType===y.DOCUMENT_FRAGMENT_NODE){var a=i.filter(v);if(1<a.length||o(i,w))throw new u(c,"More than one element or text in fragment");if(1===a.length&&!Y(e,r))throw new u(c,"Element in fragment can not be inserted before doctype")}if(v(t)&&!Y(e,r))throw new u(c,"Only one element can be added and only after doctype");if(b(t)){if(o(n,function(e){return b(e)&&e!==r}))throw new u(c,"Only one doctype is allowed");i=o(n,v);if(r&&n.indexOf(i)<n.indexOf(r))throw new u(c,"Doctype can only be inserted before an element")}}function I(e,t,r,n){$(e,t,r),e.nodeType===y.DOCUMENT_NODE&&(n||J)(e,t,r);n=t.parentNode;if(n&&n.removeChild(t),11===t.nodeType){var i=t.firstChild;if(null==i)return t;var a=t.lastChild;}else i=a=t;n=r?r.previousSibling:e.lastChild;for(i.previousSibling=n,a.nextSibling=r,n?n.nextSibling=i:e.firstChild=i,null==r?e.lastChild=a:r.previousSibling=a;i.parentNode=e,i!==a&&(i=i.nextSibling););return m(e.ownerDocument||e,e),11==t.nodeType&&(t.firstChild=t.lastChild=null),t}function P(){this._nsMap={};}function D(){}function T(){}function R(){}function q(){}function M(){}function N(){}function ee(){}function te(){}function E(){}function L(){}function k(){}function re(){}function ne(e,t){var r,n=[],i=9==this.nodeType&&this.documentElement||this,a=i.prefix,o=i.namespaceURI;return O(this,n,e,t,r=o&&null==a&&null==i.lookupPrefix(o)?[{namespace:o,prefix:null}]:r),n.join("")}function ie(e,t,r){var n=e.prefix||"",i=e.namespaceURI;if(i&&("xml"!==n||i!==S.XML)&&i!==S.XMLNS){for(var a=r.length;a--;){var o=r[a];if(o.prefix===n)return o.namespace!==i}return 1}}function A(e,t,r){e.push(" ",t,'="',r.replace(/[<>&"\t\n\r]/g,K),'"');}function O(e,t,r,n,i){if(i=i||[],n){if(!(e=n(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case 1:var a=e.attributes,o=a.length,s=e.firstChild,c=e.tagName,u=c;if(!(r=S.isHTML(e.namespaceURI)||r)&&!e.prefix&&e.namespaceURI){for(var l,f=0;f<a.length;f++)if("xmlns"===a.item(f).name){l=a.item(f).value;break}if(!l)for(var d=i.length-1;0<=d;d--)if(""===(p=i[d]).prefix&&p.namespace===e.namespaceURI){l=p.namespace;break}if(l!==e.namespaceURI)for(var p,d=i.length-1;0<=d;d--)if((p=i[d]).namespace===e.namespaceURI){p.prefix&&(u=p.prefix+":"+c);break}}t.push("<",u);for(var y=0;y<o;y++)"xmlns"==(g=a.item(y)).prefix?i.push({prefix:g.localName,namespace:g.value}):"xmlns"==g.nodeName&&i.push({prefix:"",namespace:g.value});for(var g,h,m,y=0;y<o;y++)ie(g=a.item(y),0,i)&&(A(t,(h=g.prefix||"")?"xmlns:"+h:"xmlns",m=g.namespaceURI),i.push({prefix:h,namespace:m})),O(g,t,r,n,i);if(c===u&&ie(e,0,i)&&(A(t,(h=e.prefix||"")?"xmlns:"+h:"xmlns",m=e.namespaceURI),i.push({prefix:h,namespace:m})),s||r&&!/^(?:meta|link|img|br|hr|input)$/i.test(c)){if(t.push(">"),r&&/^script$/i.test(c))for(;s;)s.data?t.push(s.data):O(s,t,r,n,i.slice()),s=s.nextSibling;else for(;s;)O(s,t,r,n,i.slice()),s=s.nextSibling;t.push("</",u,">");}else t.push("/>");return;case 9:case 11:for(s=e.firstChild;s;)O(s,t,r,n,i.slice()),s=s.nextSibling;return;case 2:return A(t,e.name,e.value);case 3:return t.push(e.data.replace(/[<&>]/g,K));case 4:return t.push("<![CDATA[",e.data,"]]>");case 8:return t.push("\x3c!--",e.data,"--\x3e");case 10:var b=e.publicId,v=e.systemId;return t.push("<!DOCTYPE ",e.name),void(b?(t.push(" PUBLIC ",b),v&&"."!=v&&t.push(" ",v),t.push(">")):v&&"."!=v?t.push(" SYSTEM ",v,">"):((b=e.internalSubset)&&t.push(" [",b,"]"),t.push(">")));case 7:return t.push("<?",e.target," ",e.data,"?>");case 5:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName);}}function x(e,t,r){e[t]=r;}u.prototype=Error.prototype,i(a,u),d.prototype={length:0,item:function(e){return 0<=e&&e<this.length?this[e]:null},toString:function(e,t){for(var r=[],n=0;n<this.length;n++)O(this[n],r,e,t);return r.join("")},filter:function(e){return Array.prototype.filter.call(this,e)},indexOf:function(e){return Array.prototype.indexOf.call(this,e)}},l.prototype.item=function(e){return f(this),this[e]||null},r(l,d),p.prototype={length:0,item:d.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var r=this[t];if(r.nodeName==e)return r}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new u(10);t=this.getNamedItem(e.nodeName);return G(this._ownerElement,this,e,t),t},setNamedItemNS:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new u(10);return t=this.getNamedItemNS(e.namespaceURI,e.localName),G(this._ownerElement,this,e,t),t},removeNamedItem:function(e){e=this.getNamedItem(e);return V(this._ownerElement,this,e),e},removeNamedItemNS:function(e,t){e=this.getNamedItemNS(e,t);return V(this._ownerElement,this,e),e},getNamedItemNS:function(e,t){for(var r=this.length;r--;){var n=this[r];if(n.localName==t&&n.namespaceURI==e)return n}return null}},z.prototype={hasFeature:function(e,t){return !0},createDocument:function(e,t,r){var n=new h;return n.implementation=this,n.childNodes=new d,n.doctype=r||null,r&&n.appendChild(r),t&&(r=n.createElementNS(e,t),n.appendChild(r)),n},createDocumentType:function(e,t,r){var n=new N;return n.name=e,n.nodeName=e,n.publicId=t||"",n.systemId=r||"",n}},y.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return I(this,e,t)},replaceChild:function(e,t){I(this,e,t,Z),t&&this.removeChild(t);},removeChild:function(e){return Q(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return function f(e,t,r){var n=new t.constructor;for(var i in t){var a;Object.prototype.hasOwnProperty.call(t,i)&&"object"!=_(a=t[i])&&a!=n[i]&&(n[i]=a);}t.childNodes&&(n.childNodes=new d);n.ownerDocument=e;switch(n.nodeType){case 1:var o=t.attributes,s=n.attributes=new p,c=o.length;s._ownerElement=n;for(var u=0;u<c;u++)n.setAttributeNode(f(e,o.item(u),!0));break;case 2:r=!0;}if(r)for(var l=t.firstChild;l;)n.appendChild(f(e,l,r)),l=l.nextSibling;return n}(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&3==t.nodeType&&3==e.nodeType?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t);}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return 0<this.attributes.length},lookupPrefix:function(e){for(var t=this;t;){var r=t._nsMap;if(r)for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)&&r[n]===e)return n;t=2==t.nodeType?t.ownerDocument:t.parentNode;}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var r=t._nsMap;if(r&&Object.prototype.hasOwnProperty.call(r,e))return r[e];t=2==t.nodeType?t.ownerDocument:t.parentNode;}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},i(t,y),i(t,y.prototype),h.prototype={nodeName:"#document",nodeType:9,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(11==e.nodeType)for(var r=e.firstChild;r;){var n=r.nextSibling;this.insertBefore(r,t),r=n;}else I(this,e,t),null===(e.ownerDocument=this).documentElement&&1===e.nodeType&&(this.documentElement=e);return e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),Q(this,e)},replaceChild:function(e,t){I(this,e,t,Z),e.ownerDocument=this,t&&this.removeChild(t),v(e)&&(this.documentElement=e);},importNode:function(e,t){return function a(e,t,r){var n;switch(t.nodeType){case 1:(n=t.cloneNode(!1)).ownerDocument=e;case 11:break;case 2:r=!0;}n=n||t.cloneNode(!1);n.ownerDocument=e;n.parentNode=null;if(r)for(var i=t.firstChild;i;)n.appendChild(a(e,i,r)),i=i.nextSibling;return n}(this,e,t)},getElementById:function(t){var r=null;return g(this.documentElement,function(e){if(1==e.nodeType&&e.getAttribute("id")==t)return r=e,!0}),r},getElementsByClassName:function(o){var s=B(o);return new l(this,function(i){var a=[];return 0<s.length&&g(i.documentElement,function(e){var t,r,n;e!==i&&1===e.nodeType&&(t=e.getAttribute("class"))&&((r=o===t)||(t=B(t),r=s.every((n=t,function(e){return n&&-1!==n.indexOf(e)}))),r)&&a.push(e);}),a})},createElement:function(e){var t=new P;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.localName=e,t.childNodes=new d,(t.attributes=new p)._ownerElement=t},createDocumentFragment:function(){var e=new L;return e.ownerDocument=this,e.childNodes=new d,e},createTextNode:function(e){var t=new R;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new q;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new M;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var r=new k;return r.ownerDocument=this,r.tagName=r.nodeName=r.target=e,r.nodeValue=r.data=t,r},createAttribute:function(e){var t=new D;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new E;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var r=new P,n=t.split(":"),i=r.attributes=new p;return r.childNodes=new d,r.ownerDocument=this,r.nodeName=t,r.tagName=t,r.namespaceURI=e,2==n.length?(r.prefix=n[0],r.localName=n[1]):r.localName=t,i._ownerElement=r},createAttributeNS:function(e,t){var r=new D,n=t.split(":");return r.ownerDocument=this,r.nodeName=t,r.name=t,r.namespaceURI=e,r.specified=!0,2==n.length?(r.prefix=n[0],r.localName=n[1]):r.localName=t,r}},r(h,y),h.prototype.getElementsByTagName=(P.prototype={nodeType:1,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){e=this.getAttributeNode(e);return e&&e.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){e=this.ownerDocument.createAttribute(e);e.value=e.nodeValue=""+t,this.setAttributeNode(e);},removeAttribute:function(e){e=this.getAttributeNode(e);e&&this.removeAttributeNode(e);},appendChild:function(e){return 11===e.nodeType?this.insertBefore(e,null):(t=this,(e=e).parentNode&&e.parentNode.removeChild(e),e.parentNode=t,e.previousSibling=t.lastChild,e.nextSibling=null,e.previousSibling?e.previousSibling.nextSibling=e:t.firstChild=e,t.lastChild=e,m(t.ownerDocument,t,e),e);var t;},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){e=this.getAttributeNodeNS(e,t);e&&this.removeAttributeNode(e);},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){e=this.getAttributeNodeNS(e,t);return e&&e.value||""},setAttributeNS:function(e,t,r){e=this.ownerDocument.createAttributeNS(e,t);e.value=e.nodeValue=""+r,this.setAttributeNode(e);},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(n){return new l(this,function(t){var r=[];return g(t,function(e){e===t||1!=e.nodeType||"*"!==n&&e.tagName!=n||r.push(e);}),r})},getElementsByTagNameNS:function(n,i){return new l(this,function(t){var r=[];return g(t,function(e){e===t||1!==e.nodeType||"*"!==n&&e.namespaceURI!==n||"*"!==i&&e.localName!=i||r.push(e);}),r})}}).getElementsByTagName,h.prototype.getElementsByTagNameNS=P.prototype.getElementsByTagNameNS,r(P,y),D.prototype.nodeType=2,r(D,y),T.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length;},insertData:function(e,t){this.replaceData(e,0,t);},appendChild:function(e){throw new Error(s[c])},deleteData:function(e,t){this.replaceData(e,t,"");},replaceData:function(e,t,r){var n=this.data.substring(0,e),e=this.data.substring(e+t);this.nodeValue=this.data=r=n+r+e,this.length=r.length;}},r(T,y),R.prototype={nodeName:"#text",nodeType:3,splitText:function(e){var t=(r=this.data).substring(e),r=r.substring(0,e),e=(this.data=this.nodeValue=r,this.length=r.length,this.ownerDocument.createTextNode(t));return this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling),e}},r(R,T),q.prototype={nodeName:"#comment",nodeType:8},r(q,T),M.prototype={nodeName:"#cdata-section",nodeType:4},r(M,T),N.prototype.nodeType=10,r(N,y),ee.prototype.nodeType=12,r(ee,y),te.prototype.nodeType=6,r(te,y),E.prototype.nodeType=5,r(E,y),L.prototype.nodeName="#document-fragment",L.prototype.nodeType=11,r(L,y),k.prototype.nodeType=7,r(k,y),re.prototype.serializeToString=function(e,t,r){return ne.call(e,t,r)},y.prototype.toString=ne;try{Object.defineProperty&&(n=function(e){switch(e.nodeType){case 1:case 11:var t=[];for(e=e.firstChild;e;)7!==e.nodeType&&8!==e.nodeType&&t.push(n(e)),e=e.nextSibling;return t.join("");default:return e.nodeValue}},Object.defineProperty(l.prototype,"length",{get:function(){return f(this),this.$$length}}),Object.defineProperty(y.prototype,"textContent",{get:function(){return n(this)},set:function(e){switch(this.nodeType){case 1:case 11:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e;}}}),x=function x(e,t,r){e["$$"+t]=r;});}catch(ae){}e.DocumentType=N,e.DOMException=u,e.DOMImplementation=z,e.Element=P,e.Node=y,e.NodeList=d,e.XMLSerializer=re;},function(e,a,o){!function(t){o.d(a,"a",function(){return n});var e=o(1),r=o.n(e),i=function i(e){return r.a.atob?r.a.atob(e):t.from(e,"base64").toString("binary")};function n(e){for(var t=i(e),r=new Uint8Array(t.length),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r}}.call(this,o(27).Buffer);},function(e,t,r){var n=r(28);t.DOMImplementation=n.DOMImplementation,t.XMLSerializer=n.XMLSerializer,t.DOMParser=r(68).DOMParser;},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports["default"]=e.exports;},function(e,a,o){!function(t){o.d(a,"a",function(){return n});var e=o(1),r=o.n(e),i=function i(e){return r.a.atob?r.a.atob(e):t.from(e,"base64").toString("binary")};function n(e){for(var t=i(e),r=new Uint8Array(t.length),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r}}.call(this,o(27).Buffer);},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)};},function(e,t,r){var s=r(35),c=r(41),u=r(8),l=r(42),f=r(43),d=r(44);e.exports=function(e,t,r){for(var n=-1,i=(t=s(t,e)).length,a=!1;++n<i;){var o=d(t[n]);if(!(a=null!=e&&r(e,o)))break;e=e[o];}return a||++n!=i?a:!!(i=null==e?0:e.length)&&f(i)&&l(o,i)&&(u(e)||c(e))};},function(e,t,r){var n=r(8),i=r(36),a=r(38),o=r(40);e.exports=function(e,t){return n(e)?e:i(e,t)?[e]:a(o(e))};},function(e,t,r){function n(e){return (n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=r(8),a=r(37),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=function(e,t){var r;return !i(e)&&(!("number"!=(r=n(e))&&"symbol"!=r&&"boolean"!=r&&null!=e&&!a(e))||s.test(e)||!o.test(e)||null!=t&&e in Object(t))};},function(e,t){e.exports=function(){return !1};},function(e,t,r){var r=r(39),n=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,r=r(function(e){var i=[];return 46===e.charCodeAt(0)&&i.push(""),e.replace(n,function(e,t,r,n){i.push(r?n.replace(a,"$1"):t||e);}),i});e.exports=r;},function(e,t){e.exports=function(e){return e};},function(e,t){e.exports=function(e){return e};},function(e,t){e.exports=function(){return !1};},function(e,t){function n(e){return (n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var r=n(e);return !!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&i.test(e))&&-1<e&&e%1==0&&e<t};},function(e,t){e.exports=function(e){return "number"==typeof e&&-1<e&&e%1==0&&e<=9007199254740991};},function(e,t){e.exports=function(e){return e};},function(e,t){var r,n,i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);i?(r=new Uint8Array(16),e.exports=function(){return i(r),r}):(n=new Array(16),e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n});},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var t=t||0,r=n;return [r[e[t++]],r[e[t++]],r[e[t++]],r[e[t++]],"-",r[e[t++]],r[e[t++]],"-",r[e[t++]],r[e[t++]],"-",r[e[t++]],r[e[t++]],"-",r[e[t++]],r[e[t++]],r[e[t++]],r[e[t++]],r[e[t++]],r[e[+t]]].join("")};},function(e,t,r){var n=r(2),i=r(15),a=r(48),o=r(21);function s(e){var e=new a(e),t=i(a.prototype.request,e);return n.extend(t,a.prototype,e),n.extend(t,e),t}var c=s(r(18));c.Axios=a,c.create=function(e){return s(o(c.defaults,e))},c.Cancel=r(22),c.CancelToken=r(62),c.isCancel=r(17),c.all=function(e){return Promise.all(e)},c.spread=r(63),e.exports=c,e.exports["default"]=c;},function(e,t,r){var i=r(2),n=r(16),a=r(49),o=r(50),s=r(21);function c(e){this.defaults=e,this.interceptors={request:new a,response:new a};}c.prototype.request=function request(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=s(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[o,undefined],r=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected);}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected);});t.length;)r=r.then(t.shift(),t.shift());return r},c.prototype.getUri=function(e){return e=s(this.defaults,e),n(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},i.forEach(["delete","get","head","options"],function(r){c.prototype[r]=function(e,t){return this.request(i.merge(t||{},{method:r,url:e}))};}),i.forEach(["post","put","patch"],function(n){c.prototype[n]=function(e,t,r){return this.request(i.merge(r||{},{method:n,url:e,data:t}))};}),e.exports=c;},function(e,t,r){var n=r(2);function i(){this.handlers=[];}i.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null);},i.prototype.forEach=function(t){n.forEach(this.handlers,function(e){null!==e&&t(e);});},e.exports=i;},function(e,t,r){var n=r(2),i=r(51),a=r(17),o=r(18);function s(e){e.cancelToken&&e.cancelToken.throwIfRequested();}e.exports=function(t){return s(t),t.headers=t.headers||{},t.data=i(t.data,t.headers,t.transformRequest),t.headers=n.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),n.forEach(["delete","get","head","post","put","patch","common"],function(e){delete t.headers[e];}),(t.adapter||o.adapter)(t).then(function(e){return s(t),e.data=i(e.data,e.headers,t.transformResponse),e},function(e){return a(e)||(s(t),e&&e.response&&(e.response.data=i(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})};},function(e,t,r){var n=r(2);e.exports=function(t,r,e){return n.forEach(e,function(e){t=e(t,r);}),t};},function(e,t){var r,n,e=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}try{r="function"==typeof setTimeout?setTimeout:i;}catch(g){r=i;}try{n="function"==typeof clearTimeout?clearTimeout:a;}catch(g){n=a;}function o(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return (r=setTimeout)(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}var s,c=[],u=!1,l=-1;function f(){u&&s&&(u=!1,s.length?c=s.concat(c):l=-1,c.length)&&d();}function d(){if(!u){for(var e=o(f),t=(u=!0,c.length);t;){for(s=c,c=[];++l<t;)s&&s[l].run();l=-1,t=c.length;}s=null,u=!1,!function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return (n=clearTimeout)(e);try{n(e);}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e);}}function p(e,t){this.fun=e,this.array=t;}function y(){}e.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new p(e,t)),1!==c.length||u||o(d);},p.prototype.run=function(){this.fun.apply(null,this.array);},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=y,e.addListener=y,e.once=y,e.off=y,e.removeListener=y,e.removeAllListeners=y,e.emit=y,e.prependListener=y,e.prependOnceListener=y,e.listeners=function(e){return []},e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return "/"},e.chdir=function(e){throw new Error("process.chdir is not supported")},e.umask=function(){return 0};},function(e,t,r){var i=r(2);e.exports=function(r,n){i.forEach(r,function(e,t){t!==n&&t.toUpperCase()===n.toUpperCase()&&(r[n]=e,delete r[t]);});};},function(e,t,r){var i=r(20);e.exports=function(e,t,r){var n=r.config.validateStatus;!n||n(r.status)?e(r):t(i("Request failed with status code "+r.status,r.config,null,r.request,r));};},function(e,t,r){e.exports=function(e,t,r,n,i){return e.config=t,r&&(e.code=r),e.request=n,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return {message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e};},function(e,t,r){var n=r(57),i=r(58);e.exports=function(e,t){return e&&!n(t)?i(e,t):t};},function(e,t,r){e.exports=function(e){return /^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)};},function(e,t,r){e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e};},function(e,t,r){var i=r(2),a=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,n={};return e&&i.forEach(e.split("\n"),function(e){r=e.indexOf(":"),t=i.trim(e.substr(0,r)).toLowerCase(),r=i.trim(e.substr(r+1)),!t||n[t]&&0<=a.indexOf(t)||(n[t]="set-cookie"===t?(n[t]||[]).concat([r]):n[t]?n[t]+", "+r:r);}),n};},function(e,t,r){var n,i,a,o=r(2);function s(e){return i&&(a.setAttribute("href",e),e=a.href),a.setAttribute("href",e),{href:a.href,protocol:a.protocol?a.protocol.replace(/:$/,""):"",host:a.host,search:a.search?a.search.replace(/^\?/,""):"",hash:a.hash?a.hash.replace(/^#/,""):"",hostname:a.hostname,port:a.port,pathname:"/"===a.pathname.charAt(0)?a.pathname:"/"+a.pathname}}e.exports=o.isStandardBrowserEnv()?(i=/(msie|trident)/i.test(navigator.userAgent),a=document.createElement("a"),n=s(window.location.href),function(e){e=o.isString(e)?s(e):e;return e.protocol===n.protocol&&e.host===n.host}):function(){return !0};},function(e,t,r){var s=r(2);e.exports=s.isStandardBrowserEnv()?{write:function(e,t,r,n,i,a){var o=[];o.push(e+"="+encodeURIComponent(t)),s.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),s.isString(n)&&o.push("path="+n),s.isString(i)&&o.push("domain="+i),!0===a&&o.push("secure"),document.cookie=o.join("; ");},read:function(e){e=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5);}}:{write:function(){},read:function(){return null},remove:function(){}};},function(e,t,r){var n=r(22);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");this.promise=new Promise(function(e){t=e;});var t,r=this;e(function(e){r.reason||(r.reason=new n(e),t(r.reason));});}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var t;return {token:new i(function(e){t=e;}),cancel:t}},e.exports=i;},function(e,t,r){e.exports=function(t){return function(e){return t.apply(null,e)}};},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e};},function(e,t,r){t.byteLength=function(e){var e=l(e),t=e[0],e=e[1];return 3*(t+e)/4-e},t.toByteArray=function(e){var t,r,n=l(e),i=n[0],n=n[1],a=new u(function(e,t){return 3*(e+t)/4-t}(i,n)),o=0,s=0<n?i-4:i;for(r=0;r<s;r+=4)t=c[e.charCodeAt(r)]<<18|c[e.charCodeAt(r+1)]<<12|c[e.charCodeAt(r+2)]<<6|c[e.charCodeAt(r+3)],a[o++]=t>>16&255,a[o++]=t>>8&255,a[o++]=255&t;2===n&&(t=c[e.charCodeAt(r)]<<2|c[e.charCodeAt(r+1)]>>4,a[o++]=255&t);1===n&&(t=c[e.charCodeAt(r)]<<10|c[e.charCodeAt(r+1)]<<4|c[e.charCodeAt(r+2)]>>2,a[o++]=t>>8&255,a[o++]=255&t);return a},t.fromByteArray=function(e){for(var t,r=e.length,n=r%3,i=[],a=0,o=r-n;a<o;a+=16383)i.push(function(e,t,r){for(var n,i=[],a=t;a<r;a+=3)n=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),i.push(function(e){return s[e>>18&63]+s[e>>12&63]+s[e>>6&63]+s[63&e]}(n));return i.join("")}(e,a,o<a+16383?o:a+16383));1==n?(t=e[r-1],i.push(s[t>>2]+s[t<<4&63]+"==")):2==n&&(t=(e[r-2]<<8)+e[r-1],i.push(s[t>>10]+s[t>>4&63]+s[t<<2&63]+"="));return i.join("")};for(var s=[],c=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,a=n.length;i<a;++i)s[i]=n[i],c[n.charCodeAt(i)]=i;function l(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("="),t=(e=-1===e?t:e)===t?0:4-e%4;return [e,t]}c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63;},function(e,t){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
t.read=function(e,t,r,n,i){var a,o,s=8*i-n-1,c=(1<<s)-1,u=c>>1,l=-7,f=r?i-1:0,d=r?-1:1,i=e[t+f];for(f+=d,a=i&(1<<-l)-1,i>>=-l,l+=s;0<l;a=256*a+e[t+f],f+=d,l-=8);for(o=a&(1<<-l)-1,a>>=-l,l+=n;0<l;o=256*o+e[t+f],f+=d,l-=8);if(0===a)a=1-u;else {if(a===c)return o?NaN:(i?-1:1)*Infinity;o+=Math.pow(2,n),a-=u;}return (i?-1:1)*o*Math.pow(2,a-n)},t.write=function(e,t,r,n,i,a){var o,s,c=8*a-i-1,u=(1<<c)-1,l=u>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:a-1,p=n?1:-1,a=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===Infinity?(s=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(n=Math.pow(2,-o))<1&&(o--,n*=2),2<=(t+=1<=o+l?f/n:f*Math.pow(2,1-l))*n&&(o++,n/=2),u<=o+l?(s=0,o=u):1<=o+l?(s=(t*n-1)*Math.pow(2,i),o+=l):(s=t*Math.pow(2,l-1)*Math.pow(2,i),o=0));8<=i;e[r+d]=255&s,d+=p,s/=256,i-=8);for(o=o<<i|s,c+=i;0<c;e[r+d]=255&o,d+=p,o/=256,c-=8);e[r+d-p]|=128*a;};},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return "[object Array]"==r.call(e)};},function(e,t,r){var n=r(11),i=r(28),u=r(69),r=r(70),a=i.DOMImplementation,l=n.NAMESPACE,o=r.ParseError,f=r.XMLReader;function d(e){return e.replace(/\r[\n\u0085]/g,"\n").replace(/[\r\u0085\u2028]/g,"\n")}function s(e){this.options=e||{locator:{}};}function p(){this.cdata=!1;}function y(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber;}function g(e){if(e)return "\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function c(e,t,r){return "string"==typeof e?e.substr(t,r):e.length>=t+r||t?new java.lang.String(e,t,r)+"":e}function h(e,t){(e.currentElement||e.doc).appendChild(t);}s.prototype.parseFromString=function(e,t){var r=this.options,n=new f,i=r.domBuilder||new p,a=r.errorHandler,o=r.locator,s=r.xmlns||{},t=/\/x?html?$/.test(t),c=t?u.HTML_ENTITIES:u.XML_ENTITIES,a=(o&&i.setDocumentLocator(o),n.errorHandler=function(n,e,i){if(!n){if(e instanceof p)return e;n=e;}var a={},o=n instanceof Function;function t(t){var r=n[t];!r&&o&&(r=2==n.length?function(e){n(t,e);}:n),a[t]=r?function(e){r("[xmldom "+t+"]\t"+e+g(i));}:function(){};}return i=i||{},t("warning"),t("error"),t("fatalError"),a}(a,i,o),n.domBuilder=r.domBuilder||i,t&&(s[""]=l.HTML),s.xml=s.xml||l.XML,r.normalizeLineEndings||d);return e&&"string"==typeof e?n.parse(a(e),s,c):n.errorHandler.error("invalid doc source"),i.doc},p.prototype={startDocument:function(){this.doc=(new a).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId);},startElement:function(e,t,r,n){var i=this.doc,a=i.createElementNS(e,r||t),o=n.length;h(this,a),this.currentElement=a,this.locator&&y(this.locator,a);for(var s=0;s<o;s++){var e=n.getURI(s),c=n.getValue(s),r=n.getQName(s),u=i.createAttributeNS(e,r);this.locator&&y(n.getLocator(s),u),u.value=u.nodeValue=c,a.setAttributeNode(u);}},endElement:function(e,t,r){var n=this.currentElement;n.tagName;this.currentElement=n.parentNode;},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){e=this.doc.createProcessingInstruction(e,t);this.locator&&y(this.locator,e),h(this,e);},ignorableWhitespace:function(e,t,r){},characters:function(e,t,r){var n;(e=c.apply(this,arguments))&&(n=this.cdata?this.doc.createCDATASection(e):this.doc.createTextNode(e),this.currentElement?this.currentElement.appendChild(n):/^\s*$/.test(e)&&this.doc.appendChild(n),this.locator)&&y(this.locator,n);},skippedEntity:function(e){},endDocument:function(){this.doc.normalize();},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0);},comment:function(e,t,r){e=c.apply(this,arguments);var n=this.doc.createComment(e);this.locator&&y(this.locator,n),h(this,n);},startCDATA:function(){this.cdata=!0;},endCDATA:function(){this.cdata=!1;},startDTD:function(e,t,r){var n=this.doc.implementation;n&&n.createDocumentType&&(e=n.createDocumentType(e,t,r),this.locator&&y(this.locator,e),h(this,e),this.doc.doctype=e);},warning:function(e){console.warn("[xmldom warning]\t"+e,g(this.locator));},error:function error(e){console.error("[xmldom error]\t"+e,g(this.locator));},fatalError:function(e){throw new o(e,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){p.prototype[e]=function(){return null};}),t.__DOMHandler=p,t.normalizeLineEndings=d,t.DOMParser=s;},function(e,t,r){r=r(11).freeze;t.XML_ENTITIES=r({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),t.HTML_ENTITIES=r({Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",AMP:"&",amp:"&",And:"",and:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",ap:"",apacir:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",Barwed:"",barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",Because:"",because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxDL:"",boxDl:"",boxdL:"",boxdl:"",boxDR:"",boxDr:"",boxdR:"",boxdr:"",boxH:"",boxh:"",boxHD:"",boxHd:"",boxhD:"",boxhd:"",boxHU:"",boxHu:"",boxhU:"",boxhu:"",boxminus:"",boxplus:"",boxtimes:"",boxUL:"",boxUl:"",boxuL:"",boxul:"",boxUR:"",boxUr:"",boxuR:"",boxur:"",boxV:"",boxv:"",boxVH:"",boxVh:"",boxvH:"",boxvh:"",boxVL:"",boxVl:"",boxvL:"",boxvl:"",boxVR:"",boxVr:"",boxvR:"",boxvr:"",bprime:"",Breve:"",breve:"",brvbar:"",Bscr:"",bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",Cap:"",cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",CenterDot:"",centerdot:"",Cfr:"",cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",Colon:"",colon:":",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",Conint:"",conint:"",ContourIntegral:"",Copf:"",copf:"",coprod:"",Coproduct:"",COPY:"",copy:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",Cross:"",cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",Cup:"",cup:"",cupbrcap:"",CupCap:"",cupcap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",Dagger:"",dagger:"",daleth:"",Darr:"",dArr:"",darr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",DD:"",dd:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",Diamond:"",diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrow:"",Downarrow:"",downarrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",ecir:"",Ecirc:"",ecirc:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",eDot:"",edot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",Escr:"",escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",ExponentialE:"",exponentiale:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",ForAll:"",forall:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",Fscr:"",fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",gE:"",ge:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",Gg:"",gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gnE:"",gne:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",Gt:"",GT:">",gt:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",hArr:"",harr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",Hfr:"",hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",Hopf:"",hopf:"",horbar:"",HorizontalLine:"",Hscr:"",hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",Ifr:"",ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Im:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"","in":"",incare:"",infin:"",infintie:"",inodot:"",Int:"","int":"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",Iscr:"",iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",Lang:"",lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",Larr:"",lArr:"",larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",lAtail:"",latail:"",late:"",lates:"",lBarr:"",lbarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",lE:"",le:"",LeftAngleBracket:"",LeftArrow:"",Leftarrow:"",leftarrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",Ll:"",ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lnE:"",lne:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",LongLeftArrow:"",Longleftarrow:"",longleftarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longleftrightarrow:"",longmapsto:"",LongRightArrow:"",Longrightarrow:"",longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",Lscr:"",lscr:"",Lsh:"",lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",Lt:"",LT:"<",lt:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",Mscr:"",mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",ne:"",nearhk:"",neArr:"",nearr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:"\n",nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nhArr:"",nharr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlArr:"",nlarr:"",nldr:"",nlE:"",nle:"",nLeftarrow:"",nleftarrow:"",nLeftrightarrow:"",nleftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",Nopf:"",nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrArr:"",nrarr:"",nrarrc:"",nrarrw:"",nRightarrow:"",nrightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nVDash:"",nVdash:"",nvDash:"",nvdash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwArr:"",nwarr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",ocir:"",Ocirc:"",ocirc:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",Or:"",or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",Otimes:"",otimes:"",otimesas:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",Popf:"",popf:"",pound:"",Pr:"",pr:"",prap:"",prcue:"",prE:"",pre:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",Prime:"",prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",Qopf:"",qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",QUOT:'"',quot:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",Rang:"",rang:"",rangd:"",range:"",rangle:"",raquo:"",Rarr:"",rArr:"",rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",rAtail:"",ratail:"",ratio:"",rationals:"",RBarr:"",rBarr:"",rbarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",REG:"",reg:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",Rfr:"",rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrow:"",Rightarrow:"",rightarrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",Ropf:"",ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",Rscr:"",rscr:"",Rsh:"",rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",Sc:"",sc:"",scap:"",Scaron:"",scaron:"",sccue:"",scE:"",sce:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",seArr:"",searr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",sol:"/",solb:"",solbar:"",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",Square:"",square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",Sub:"",sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",Subset:"",subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",Sum:"",sum:"",sung:"",Sup:"",sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",Supset:"",supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swArr:"",swarr:"",swarrow:"",swnwar:"",szlig:"",Tab:"\t",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",Therefore:"",therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",THORN:"",thorn:"",Tilde:"",tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",TRADE:"",trade:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",Uarr:"",uArr:"",uarr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrow:"",Uparrow:"",uparrow:"",UpArrowBar:"",UpArrowDownArrow:"",UpDownArrow:"",Updownarrow:"",updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",Upsi:"",upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",vArr:"",varr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",Vbar:"",vBar:"",vBarv:"",Vcy:"",vcy:"",VDash:"",Vdash:"",vDash:"",vdash:"",Vdashl:"",Vee:"",vee:"",veebar:"",veeeq:"",vellip:"",Verbar:"",verbar:"|",Vert:"",vert:"|",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",Wedge:"",wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xhArr:"",xharr:"",Xi:"",xi:"",xlArr:"",xlarr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrArr:"",xrarr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",Yuml:"",yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",Zfr:"",zfr:"",ZHcy:"",zhcy:"",zigrarr:"",Zopf:"",zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""}),t.entityMap=t.HTML_ENTITIES;},function(e,t,r){var L=r(11).NAMESPACE,r=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,n=new RegExp("[\\-\\.0-9"+r.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),i=new RegExp("^"+r.source+n.source+"*(?::"+r.source+n.source+"*)?$"),k=0,A=1,O=2,x=3,C=4,_=5,U=6,j=7;function B(e,t){this.message=e,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,B);}function a(){}function o(r,e,n,i,a){function o(e){var t=e.slice(1,-1);return Object.hasOwnProperty.call(n,t)?n[t]:"#"===t.charAt(0)?65535<(t=parseInt(t.substr(1).replace("x","0x")))?(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t))):String.fromCharCode(t):(a.error("entity not found:"+e),e)}function t(e){var t;y<e&&(t=r.substring(y,e).replace(/&#?\w+;/g,o),f&&s(y),i.characters(t,0,e-y),y=e);}function s(e,t){for(;u<=e&&(t=l.exec(r));)c=t.index,u=c+t[0].length,f.lineNumber++;f.columnNumber=e-c+1;}for(var c=0,u=0,l=/.*(?:\r\n?|\n)|.*$/g,f=i.locator,d=[{currentNSMap:e}],p={},y=0;;){try{var g,h,m=r.indexOf("<",y);if(m<0)return void(r.substr(y).match(/^\s*$/)||(h=(g=i.doc).createTextNode(r.substr(y)),g.appendChild(h),i.currentElement=h));switch(y<m&&t(m),r.charAt(m+1)){case"/":var b=r.indexOf(">",m+3),v=r.substring(m+2,b).replace(/[ \t\n\r]+$/g,""),S=d.pop(),w=(b<0?(v=r.substring(m+2).replace(/[\s<].*/,""),a.error("end tag name: "+v+" is not complete:"+S.tagName),b=m+1+v.length):v.match(/\s</)&&(v=v.replace(/[\s<].*/,""),a.error("end tag name: "+v+" maybe not complete"),b=m+1+v.length),S.localNSMap),I=S.tagName==v;if(I||S.tagName&&S.tagName.toLowerCase()==v.toLowerCase()){if(i.endElement(S.uri,S.localName,v),w)for(var P in w)Object.prototype.hasOwnProperty.call(w,P)&&i.endPrefixMapping(P);I||a.fatalError("end tag name: "+v+" is not match the current start tagName:"+S.tagName);}else d.push(S);b++;break;case"?":f&&s(m),b=function(e,t,r){var n=e.indexOf("?>",t);if(n){t=e.substring(t,n).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(t)return t[0].length,r.processingInstruction(t[1],t[2]),n+2}return -1}(r,m,i);break;case"!":f&&s(m),b=function(e,t,r,n){{if("-"===e.charAt(t+2))return "-"===e.charAt(t+3)?(a=e.indexOf("--\x3e",t+4),t<a?(r.comment(e,t+4,a-t-4),a+3):(n.error("Unclosed comment"),-1)):-1;if("CDATA["==e.substr(t+3,6))return a=e.indexOf("]]>",t+9),r.startCDATA(),r.characters(e,t+9,a-t-9),r.endCDATA(),a+3;var i,n=function(e,t){var r,n=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;i.lastIndex=t,i.exec(e);for(;r=i.exec(e);)if(n.push(r),r[1])return n}(e,t),a=n.length;if(1<a&&/!doctype/i.test(n[0][0]))return e=n[1][0],i=t=!1,3<a&&(/^public$/i.test(n[2][0])?(t=n[3][0],i=4<a&&n[4][0]):/^system$/i.test(n[2][0])&&(i=n[3][0])),a=n[a-1],r.startDTD(e,t,i),r.endDTD(),a.index+a[0].length}return -1}(r,m,i,a);break;default:f&&s(m);var D=new G,T=d[d.length-1].currentNSMap,b=function(e,t,n,r,i,a){function o(e,t,r){n.attributeNames.hasOwnProperty(e)&&a.fatalError("Attribute "+e+" redefined"),n.addValue(e,t.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,i),r);}var s,c=++t,u=k;for(;;){var l=e.charAt(c);switch(l){case"=":if(u===A)s=e.slice(t,c);else if(u!==O)throw new Error("attribute equal must after attrName");u=x;break;case"'":case'"':if(u===x||u===A){if(u===A&&(a.warning('attribute value must after "="'),s=e.slice(t,c)),t=c+1,!(0<(c=e.indexOf(l,t))))throw new Error("attribute value no end '"+l+"' match");f=e.slice(t,c),o(s,f,t-1);}else {if(u!=C)throw new Error('attribute value must after "="');f=e.slice(t,c),o(s,f,t),a.warning('attribute "'+s+'" missed start quot('+l+")!!"),t=c+1;}u=_;break;case"/":switch(u){case k:n.setTagName(e.slice(t,c));case _:case U:case j:u=j,n.closed=!0;case C:case A:break;case O:n.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return a.error("unexpected end of input"),u==k&&n.setTagName(e.slice(t,c)),c;case">":switch(u){case k:n.setTagName(e.slice(t,c));case _:case U:case j:break;case C:case A:"/"===(f=e.slice(t,c)).slice(-1)&&(n.closed=!0,f=f.slice(0,-1));case O:u===O&&(f=s),u==C?(a.warning('attribute "'+f+'" missed quot(")!'),o(s,f,t)):(L.isHTML(r[""])&&f.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+f+'" missed value!! "'+f+'" instead!!'),o(f,f,t));break;case x:throw new Error("attribute value missed!!")}return c;case"":l=" ";default:if(l<=" ")switch(u){case k:n.setTagName(e.slice(t,c)),u=U;break;case A:s=e.slice(t,c),u=O;break;case C:var f=e.slice(t,c);a.warning('attribute "'+f+'" missed quot(")!!'),o(s,f,t);case _:u=U;}else switch(u){case O:n.tagName;L.isHTML(r[""])&&s.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+s+'" missed value!! "'+s+'" instead2!!'),o(s,s,t),t=c,u=A;break;case _:a.warning('attribute space is required"'+s+'"!!');case U:u=A,t=c;break;case x:u=C,t=c;break;case j:throw new Error("elements closed character '/' and '>' must be connected to")}}c++;}}(r,m,D,T,o,a),R=D.length;if(!D.closed&&function(e,t,r,n){var i=n[r];null==i&&((i=e.lastIndexOf("</"+r+">"))<t&&(i=e.lastIndexOf("</"+r)),n[r]=i);return i<t}(r,b,D.tagName,p)&&(D.closed=!0,n.nbsp||a.warning("unclosed xml attribute")),f&&R){for(var q=F(f,{}),M=0;M<R;M++){var N=D[M];s(N.offset),N.locator=F(f,{});}i.locator=q,H(D,i,T)&&d.push(D),i.locator=f;}else H(D,i,T)&&d.push(D);L.isHTML(D.uri)&&!D.closed?b=function(e,t,r,n,i){if(/^(?:script|textarea)$/i.test(r)){var a=e.indexOf("</"+r+">",t),e=e.substring(t+1,a);if(/[&<]/.test(e))return /^script$/i.test(r)?i.characters(e,0,e.length):(e=e.replace(/&#?\w+;/g,n),i.characters(e,0,e.length)),a}return t+1}(r,b,D.tagName,o,i):b++;}}catch(E){if(E instanceof B)throw E;a.error("element parse error: "+E),b=-1;}y<b?y=b:t(Math.max(m,y)+1);}}function F(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function H(e,t,r){for(var n=e.tagName,i=null,a=e.length;a--;){var o=e[a],s=o.qName,c=o.value,s=0<(l=s.indexOf(":"))?(u=o.prefix=s.slice(0,l),f=s.slice(l+1),"xmlns"===u&&f):(u=null,"xmlns"===(f=s)&&"");o.localName=f,!1!==s&&(null==i&&(i={},p(r,r={})),r[s]=i[s]=c,o.uri=L.XMLNS,t.startPrefixMapping(s,c));}for(var u,a=e.length;a--;)(u=(o=e[a]).prefix)&&("xml"===u&&(o.uri=L.XML),"xmlns"!==u)&&(o.uri=r[u||""]);var l,f=0<(l=n.indexOf(":"))?(u=e.prefix=n.slice(0,l),e.localName=n.slice(l+1)):(u=null,e.localName=n),d=e.uri=r[u||""];if(t.startElement(d,f,n,e),!e.closed)return e.currentNSMap=r,e.localNSMap=i,1;if(t.endElement(d,f,n),i)for(u in i)Object.prototype.hasOwnProperty.call(i,u)&&t.endPrefixMapping(u);}function p(e,t){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);}function G(){this.attributeNames={};}(B.prototype=new Error).name=B.name,a.prototype={parse:function(e,t,r){var n=this.domBuilder;n.startDocument(),p(t,t={}),o(e,t,r,n,this.errorHandler),n.endDocument();}},G.prototype={setTagName:function(e){if(!i.test(e))throw new Error("invalid tagName:"+e);this.tagName=e;},addValue:function(e,t,r){if(!i.test(e))throw new Error("invalid attribute:"+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:t,offset:r};},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},t.XMLReader=a,t.ParseError=B;},function(r,e){function n(e,t){return r.exports=n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r.exports.__esModule=!0,r.exports["default"]=r.exports,n(e,t)}r.exports=n,r.exports.__esModule=!0,r.exports["default"]=r.exports;},function(x,e,t){t.r(e);var r=t(13),b=t(5);function i(e){return (i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=i(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==i(e)?e:e+""}(n.key),n);}}var s=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.factory=e;}return e=t,(r=[{key:"load",value:function(i,e,a,t,r){var n,o=this,s=this.factory.getInstance("GeneralSettings"),c=this.factory.getInstance("DownloadController"),u=i.frag,l=i.part;u===undefined?n={index:i.index,mediaType:i.mediaType,quality:i.quality,originUrl:i.url,responseType:i.responseType,isManifest:"manifest"===i.type||"audioTrack"===i.type||"level"===i.type,isInit:"InitializationSegment"===i.type,isSegment:"manifest"!==i.type&&"audioTrack"!==i.type&&"level"!==i.type&&i.request&&"InitializationSegment"!==i.request.type,isData:"subtitleTrack"===i.type,manifestType:"manifest"===i.type||"audioTrack"===i.type||"subtitleTrack"===i.type||"level"===i.type?"M3U8":undefined,duration:i.duration}:l?(n={index:"number"==typeof u.sn&&"subtitle"!==u.type?u.sn:undefined,realNumber:"subtitle"!==u.type?parseFloat(String(u.sn)+"."+(l.fragOffset+1)):undefined,mediaType:"audio"===u.type?"audio":"video",quality:u.level,originUrl:i.url,responseType:i.responseType,isManifest:!1,isInit:"initSegment"===u.sn,isSegment:"initSegment"!==u.sn&&"subtitle"!==u.type,isData:"subtitle"===u.type,manifestType:"manifest"===i.type||"audioTrack"===i.type||"subtitleTrack"===i.type||"level"===i.type?"M3U8":undefined,duration:l.duration},u._byteRange&&0<u._byteRange.length&&(n.range={start:u._byteRange[0],end:u._byteRange[1]-1}),s.lowLatency=!0):(n={index:"number"==typeof u.sn&&"subtitle"!==u.type?u.sn+s.indexModification:undefined,realNumber:"subtitle"!==u.type?u.sn+s.indexModification:undefined,mediaType:"audio"===u.type?"audio":"video",quality:u.level,originUrl:i.url,responseType:i.responseType,isManifest:!1,isInit:"initSegment"===u.sn,isSegment:"initSegment"!==u.sn&&"subtitle"!==u.type,isData:"subtitle"===u.type,manifestType:"manifest"===i.type||"audioTrack"===i.type||"subtitleTrack"===i.type||"level"===i.type?"M3U8":undefined,duration:u.duration},u._byteRange&&0<u._byteRange.length&&(n.range={start:u._byteRange[0],end:u._byteRange[1]-1}));try{-1<s.quanteecKey.indexOf("7408968b3")&&n.duration&&"number"==typeof n.duration&&!isNaN(n.duration)&&(n.duration<6||11<n.duration)&&(n.duration=8);}catch(m){}var f=new b.a(n),d=(r.inputRequest=f,o.factory.getInstance("MyLogger"),{total:0,loaded:0,trequest:0,tfirst:0,tload:0,tparsed:0,loading:{start:performance.now(),first:0,end:0},parsing:{start:0,end:0},bwEstimate:0,aborted:!1,retry:0,chunkCount:0,buffering:{start:0,end:0,first:0}});l?l.stats=d:u&&(u.stats=d),f.isManifest&&(f.responseType="text");try{if(!isNaN(f.quality)){var p=this.factory.getInstance("ManifestService").manifest,y=(p.playlists=p.playlists.sort(function(e,t){return e.attributes.BANDWIDTH-t.attributes.BANDWIDTH}),t.levelController._levels);if("video"===f.mediaType)for(var g=y[f.quality],h=0;h<p.playlists.length;h++)Number(g.attrs.BANDWIDTH)===p.playlists[h].attributes.BANDWIDTH&&(f.quality=h);}}catch(m){}c.load(f).then(function(e){var t=e.result,r=e.data,e=e.finalInputRequest,n=performance.now(),n={total:t.bytesTotal,loaded:t.bytesLoaded,trequest:n-1-(t.endDate.getTime()-t.startDate.getTime()),tfirst:n-(t.endDate.getTime()-t.startDate.getTime()),tload:performance.now()-1,tparsed:performance.now(),loading:{start:n-1-(t.endDate.getTime()-t.startDate.getTime()),first:n-(t.endDate.getTime()-t.startDate.getTime()),end:performance.now()-1},parsing:{start:0,end:0},bwEstimate:0<t.endDate.getTime()-t.startDate.getTime()?Math.round(8*t.bytesTotal/(t.endDate.getTime()-t.startDate.getTime())*1e3):0,aborted:!1,retry:0,chunkCount:0,buffering:{start:0,end:0,first:0}};l?l.stats=n:u&&(u.stats=n),a.onProgress&&a.onProgress(n,i,r,undefined),a.onSuccess&&a.onSuccess({url:e.originUrl,data:r},n,i,undefined);})["catch"](function(e){!1===e.isAbort&&null!=e.responseRequest?a.onError({code:e.responseRequest.status,text:e.responseRequest.statusText},i,e.responseRequest,d):!1===e.isAbort?a.onError({code:0,text:""},i,null,d):a.onAbort&&(d.aborted=!0,o.factory.getInstance("MyLogger").debug("Calling Abort to player",f),a.onAbort(d,i,{responseText:"",responseType:f.responseType,responseUrl:f.originUrl,status:0,statusText:"",readyState:3}));});}},{key:"abort",value:function(e){try{var t,r;e?((r=this.factory.getInstance("MyLogger"))&&r.debug("Abort request received",e),(t=this.factory.getInstance("DownloadController"))&&t.abortAll(e.toString())):(r=this.factory.getInstance("MyLogger"))&&r.debug("Abort received but no inputrequest");}catch(n){console.warn("Error in RequestOverride.abort:",n);}}},{key:"destroy",value:function(){}},{key:"reset",value:function(){try{var e=this.factory.getInstance("DownloadController");e&&e.abortEveryRequest();}catch(t){console.warn("Error in RequestOverride.destroy:",t);}}}])&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n;}();function o(e){return (o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=o(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=o(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==o(e)?e:e+""}(n.key),n);}}function u(e,t,r){t=f(t);var n=e,e=l()?Reflect.construct(t,r||[],f(e).constructor):t.apply(e,r);if(e&&("object"==o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");r=n;if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return (l=function l(){return !!e})()}function f(e){return (f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return (d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(e){if(this instanceof t)return u(this,t,[e]);throw new TypeError("Cannot call a class as a function")}var n=t;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");return n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&d(n,e),n=t,(e=[{key:"setCurrentSegmentPlaying",value:function(e){this.currentSegmentPlaying=e;}},{key:"getCurrentSegmentPlaying",value:function(){return this.currentSegmentPlaying}},{key:"getBufferLength",value:function(){var e=1,t=this.factory.getInstance("Player");if(t&&t.media){var e=0,r=t.media.currentTime,n=t.media.buffered;t.streamController&&t.streamController.videoBuffer&&t.streamController.videoBuffer.buffered&&(n=t.streamController.videoBuffer.buffered);for(var i=0;i<n.length;i++)if((n.start(i)<.5?0:n.start(i))<=r&&r<=n.end(i)){e=n.end(i)-r;break}}return e}},{key:"getAudioBufferLength",value:function(){var e=1,t=this.factory.getInstance("Player");if(t&&t.media)for(var e=0,r=t.media.currentTime,n=t.media.buffered,i=0;i<n.length;i++)if((n.start(i)<.5?0:n.start(i))<=r&&r<=n.end(i)){e=n.end(i)-r;break}return e}},{key:"seek",value:function(e){}},{key:"duration",value:function(){return this.factory.getInstance("Player")}}])&&c(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}(t(6).a);function y(e){return (y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=y(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=y(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==y(e)?e:e+""}(n.key),n);}}function h(e,t,r){t=v(t);var n=e,e=m()?Reflect.construct(t,r||[],v(e).constructor):t.apply(e,r);if(e&&("object"==y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");r=n;if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function m(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return (m=function l(){return !!e})()}function v(e){return (v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){return (S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var w=function(e){function t(e){if(this instanceof t)return h(this,t,[e]);throw new TypeError("Cannot call a class as a function")}var n=t;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");return n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&S(n,e),n=t,(e=[{key:"stopPlayer",value:function(){var e=this.factory.getInstance("Player"),t=this.factory.getInstance("Events");t&&t.emit("PlaybackForbidden",{}),e&&e.destroy();}},{key:"liveDelay",value:function(){var e=this.factory.getInstance("Player");return e&&e.latencyController?e.latencyController.latency:this.factory.getInstance("BufferService").getBufferLength()}},{key:"getBufferState",value:function(){var e=this.factory.getInstance("Player"),t=this.factory.getInstance("GeneralSettings"),r=this.factory.getInstance("BufferService");return e&&e.latencyController&&e.media&&(e=t.lowLatencyBufferLimit,1e3*r.getBufferLength()<=e)?-1:0}}])&&g(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}(t(7).a),I=t(25);function P(e){return (P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(){return (D="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=N(e)););return e}(e,t);if(n)return (n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(null,arguments)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=P(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=P(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==P(e)?e:e+""}(n.key),n);}}function T(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q(e,t,r){t=N(t);var n=e,e=M()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r);if(e&&("object"==P(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");r=n;if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function M(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return (M=function l(){return !!e})()}function N(e){return (N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L(e,t);}function L(e,t){return (L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}try{var k=function k(e){var t=function(){function r(e){var t;return R(this,r),t=q(this,r,[e=e||{}]),e.quanteec&&(e=new A(e.quanteec,t),t.quanteec_=e),t}return E(r,e.Hls),T(r)}();e.Hls=t;};window&&window.Hls&&k(window);}catch(O){console.error(O);}var A=function(){function o(e,t){R(this,o),(e=q(this,o,[e])).media=null,e.myPlayer=null,e.factory.setInstance("ManifestService",new I.a(e.factory)),e.factory.setInstance("RequestOverride",new s(e.factory)),e.factory.setInstance("BufferService",new p(e.factory)),e.factory.setInstance("PlayerService",new w(e.factory)),e.factory.getInstance("AnalyticsService").resetBuffer(),e.preparePlayer(t),t&&t.url&&e.factory.getInstance("DownloadController").load({index:NaN,mediaType:"",quality:NaN,originUrl:t.url,responseType:"text",isManifest:!0,isInit:!1,isSegment:!1,manifestType:"M3U8",duration:NaN})["catch"](function(e){});try{if(t){var r,n=JSON.parse(JSON.stringify(t.config)),i={};for(r in n){var a=r;(-1<a.indexOf("live")||-1<a.indexOf("Live")||-1<a.indexOf("buffer")||-1<a.indexOf("Buffer"))&&(i[r]=n[r]);}e.factory.getInstance("AnalyticsService").addHelpMetricsNbr("config",i);}}catch(O){console.error(O);}return e}return E(o,r["default"]),T(o,[{key:"preparePlayer",value:function(n){var t,r,i=this,a=(this.loader=null,this.factory.getInstance("RequestOverride")),e=function(){return T(function e(){R(this,e),this.context=null,this.inputRequest=null;},[{key:"load",value:function(e,t,r){this.context=e,a.load(e,t,r,n,this);}},{key:"abort",value:function(e){a.abort(this.inputRequest);}},{key:"destroy",value:function(e){a.destroy(e);}}])}();n&&n.debugController&&-1<n.debugController.version.indexOf("voplayer")?(n.configure({hlsConfiguration:{pLoader:e,fLoader:e}}),n.once("loaded",function(){i.setPlayer(n.corePlayer_.hlsPlayer);})):n&&n.version&&-1<n.version.indexOf("jwplayer")?(r=!(t=null),Object.defineProperty(n,"hls",{set:function(e){t=e,r&&(r=!1,i.setPlayer(e));},get:function(){return t}},{writable:!0,enumerable:!0,configurable:!0})):n&&(n.config?(n.config.pLoader=e,n.config.fLoader=e,this.factory.setInstance("Player",n),this.initPlayer(n)):n.conf&&(n.conf.hlsjs={pLoader:e,fLoader:e})),this.loader=e;}},{key:"managePlaying",value:function(){this.factory.getInstance("AnalyticsService").manageBufferRestart();}},{key:"manageWaiting",value:function(e){2===e.media.readyState&&2===e.media.networkState&&this.factory.getInstance("AnalyticsService").manageBufferStall();}},{key:"manageFragChanged",value:function(e,t){this.factory.getInstance("BufferService").setCurrentSegmentPlaying(t.frag.sn);}},{key:"setPlayer",value:function(e){this.preparePlayer(e);}},{key:"setFlowplayer",value:function(e){var t=e.hls;e.hls||(t=e.engine.hls),this.factory.setInstance("Player",t),this.preparePlayer(t);}},{key:"initPlayer",value:function(r){var n=this;n.media&&n.listener1&&n.media.removeEventListener("playing",n.listener1),n.media&&n.listener2&&n.media.removeEventListener("waiting",n.listener2),n.player&&n.listener3&&n.player.off("hlsFragChanged",n.listener3),(n.player=r)&&r.media?(n.media=r.media,n.listener1=n.managePlaying.bind(n),n.listener2=n.manageWaiting.bind(n,r),n.listener3=n.manageFragChanged.bind(n),r.media.addEventListener("playing",n.listener1),r.media.addEventListener("waiting",n.listener2),r.on("hlsFragChanged",n.listener3)):r.on&&r.on("hlsMediaAttached",function(e,t){n.media=r.media,n.listener1=n.managePlaying.bind(n),n.listener2=n.manageWaiting.bind(n,r),n.listener3=n.manageFragChanged.bind(n),r.media.addEventListener("playing",n.listener1),r.media.addEventListener("waiting",n.listener2),r.on("hlsFragChanged",n.listener3);});}},{key:"reset",value:function(){var e,t,r,n,i,a=this;try{a.player&&"function"==typeof a.player.stopLoad&&a.player.stopLoad(),a.media&&a.listener1&&a.media.removeEventListener("playing",a.listener1),a.media&&a.listener2&&a.media.removeEventListener("waiting",a.listener2),a.player&&a.listener3&&a.player.off("hlsFragChanged",a.listener3),a.media=null,a.listener1=null,a.listener2=null,a.listener3=null;}catch(O){console.warn("Error during hls.js adapter cleanup:",O);}try{e=o,t="reset",r=this,i=D(N(1&(n=3)?e.prototype:e),t,r),(2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i)([]);}catch(O){console.warn("Error during core reset:",O);}}}])}();e["default"]=A;},function(e,t,r){r.r(t);var n=r(13),y=r(5);function i(e){return (i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=i(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==i(e)?e:e+""}(n.key),n);}}function o(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var g=o(function g(e,t,r){s(this,g),this.code=e||null,this.message=t||null,this.data=r||null;}),c=function(){return o(function t(e){s(this,t),this.factory=e,this.log=e.getInstance("MyLogger"),this.errorCount={audio:0,video:0},this.lastRequest={audio:undefined,video:undefined},this.lastData=[];},[{key:"load",value:function(a,e,o,s){var t,r=this,n=this.factory.getInstance("DownloadController"),i=this.factory.getInstance("GeneralSettings"),c=(a.request.type&&"MediaSegment"===a.request.type&&isNaN(a.request.quality)&&null!=a.request.representation&&(a.request.quality=a.request.representation.index),{index:a.request.index,mediaType:a.request.mediaType,quality:a.request.quality,originUrl:a.request.url,responseType:"MPD"===a.request.type?"text":"arraybuffer",isManifest:"MPD"===a.request.type,isInit:"InitializationSegment"===a.request.type,isSegment:"MPD"!==a.request.type&&"InitializationSegment"!==a.request.type&&!isNaN(a.request.quality)&&("video"===a.request.mediaType||"audio"===a.request.mediaType),isData:"MPD"!==a.request.type&&"InitializationSegment"!==a.request.type&&isNaN(a.request.quality),manifestType:"MPD"===a.request.type?"MPD":undefined,duration:a.request.duration,range:a.request.range?{start:Number(a.request.range.split("-")[0]),end:Number(a.request.range.split("-")[1])}:undefined}),u=new y.a(c),l={MPD:o.errors.DOWNLOAD_ERROR_ID_MANIFEST_CODE,XLinkExpansion:o.errors.DOWNLOAD_ERROR_ID_XLINK_CODE,InitializationSegment:o.errors.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE,MediaSegment:o.errors.DOWNLOAD_ERROR_ID_CONTENT_CODE,IndexSegment:o.errors.DOWNLOAD_ERROR_ID_CONTENT_CODE,BitstreamSwitchingSegment:o.errors.DOWNLOAD_ERROR_ID_CONTENT_CODE,other:o.errors.DOWNLOAD_ERROR_ID_CONTENT_CODE};if(u.isManifest||u.isInit||u.isSegment||(u.isData=!0,u.quality=NaN),u.range&&(u.isData=!0,u.quality=NaN,u.isSegment=!1,u.isManifest=!1,u.isInit=!1),u.isSegment&&"video"===u.mediaType)u.realNumber=Math.round(100*a.request.startTime)/100,i.indexDiff[u.mediaType]=1.2*a.request.duration;else if(u.isSegment&&"audio"===u.mediaType){u.realNumber=Math.round(100*a.request.startTime)/100,i.indexDiff[u.mediaType]=1.2*a.request.duration;try{a.request&&a.request.mediaInfo?u.quality=a.request.mediaInfo.index:a.request&&a.request.representation&&a.request.representation.mediaInfo&&(u.quality=a.request.representation.mediaInfo.index);}catch(d){}}if(r.lastRequest[u.mediaType]&&u.originUrl===r.lastRequest[u.mediaType].originUrl&&u.isSegment&&u.mediaType===r.lastRequest[u.mediaType].mediaType){if(r.errorCount[u.mediaType]+=1,3<r.errorCount[u.mediaType]){for(var f in r.errorCount)r.errorCount[f]=0;this.lastRequest={audio:undefined,video:undefined},e.seek(e.getVideoElement().currentTime-.2);try{this.factory.getInstance("Events").emit("quanteecRestartSuggested",{reason:"dash.js infinite loop bug"});}catch(p){}}}else r.errorCount[u.mediaType]=0;if(u.isSegment){r.lastRequest[u.mediaType]=u;try{isNaN(u.quality)||((t=this.factory.getInstance("ManifestService").manifest).playlists=t.playlists.sort(function(e,t){return e.attributes.BANDWIDTH-t.attributes.BANDWIDTH}));}catch(d){}}i.lowLatency&&(u.progressFunction=function(e){if(!e)return r.lastData;if(a.progress){try{r.lastData=new Uint8Array(e.subarray(e.byteLength-5));}catch(d){}a.progress({data:e.buffer,lengthComputable:!1,noTrace:!0});}}),s&&s.onGoingRequests.push(u),n.load(u).then(function(e){var n=e.result,e=e.data,i=function i(){a.request.requestStartDate=n.startDate,a.request.startDate=n.startDate,a.request.requestEndDate=new Date,a.request.endDate=new Date,a.request.firstByteDate=n.startDate,a.request.fileLoaderType="QUANTEEC",a.request.bytesLoaded=n.bytesLoaded,a.request.bytesTotal=n.bytesTotal;var e=a.request.url,t="";try{""!==(t=Object.entries(n.headers).map(function(e){return e.join(": ")}).join("\r\n"))&&(t+="\r\n");}catch(d){t="";}""===t?t=s.lastHeaders||"":s.lastHeaders=t;var r=t,t=s&&s.cmsdModel?s.cmsdModel.parseResponseHeaders(t,u.mediaType):null;a.request.cmsd=t||undefined,o.dashMetrics.addHttpRequest(a.request,e,200,r,[{s:n.startDate,d:n.endDate.getTime()-n.startDate.getTime(),b:[n.bytesLoaded],t:Math.round(n.bytesLoaded/((n.endDate.getTime()-n.startDate.getTime())/1e3))}],t),"MPD"===a.request.type&&o.dashMetrics.addManifestUpdate(a.request);};try{i();}catch(d){}a.success&&(a.success(e,"OK",a.request.url),s.onGoingRequests.splice(s.onGoingRequests.findIndex(function(e){return e.toString()===u.toString()}),1)),a.complete&&a.complete(a.request,"OK");})["catch"](function(e){!1===e.isAbort?e.responseRequest?(o.errHandler.error(new g(l[a.request.type],a.request.url+" is not available",{request:a.request,response:e.responseRequest})),a.error&&a.error(a.request,"error",e.responseRequest.statusText,e.responseRequest),a.complete&&a.complete(request,e.responseRequest.statusText)):(e=Response.error(),o.errHandler.error(new g(l[a.request.type],a.request.url+" is not available",{request:a.request,response:e})),a.error&&a.error(a.request,"error",0,e),a.complete&&a.complete(request,"")):(s.onGoingRequests.splice(s.onGoingRequests.findIndex(function(e){return e.toString()===u.toString()}),1),a.abort&&a.abort(a.request));});}},{key:"abort",value:function(e,t){var r,n=function(){return (new Error).stack.split("\n").slice(2).map(function(e){return e.replace(/\s+at\s+/,"")}).join("\n")}(),i=(-1<n.indexOf("prepareQualityChange")?this.log.debug("Abort quality request",t.requestID,JSON.parse(JSON.stringify(t.onGoingRequests))):-1<n.indexOf("prepareInnerPeriodPlaybackSeeking")?this.log.debug("Abort seek request",t.requestID,JSON.parse(JSON.stringify(t.onGoingRequests))):(this.log.debug("Abort unknown request",t.requestID,JSON.parse(JSON.stringify(t.onGoingRequests))),this.log.debug("Unknown",{stack:n})),this.factory.getInstance("DownloadController"));for(r in t.onGoingRequests)i.abortAll(t.onGoingRequests[r].toString());}}])}();function u(e){return (u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=u(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=u(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==u(e)?e:e+""}(n.key),n);}}function f(e,t,r){t=p(t);var n=e,e=d()?Reflect.construct(t,r||[],p(e).constructor):t.apply(e,r);if(e&&("object"==u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");r=n;if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function d(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return (d=function d(){return !!e})()}function p(e){return (p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return (h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var m=function(e){function t(e){if(this instanceof t)return f(this,t,[e]);throw new TypeError("Cannot call a class as a function")}var n=t;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");return n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&h(n,e),n=t,(e=[{key:"getBufferLength",value:function(){var e=this.factory.getInstance("Player").getBufferLength("video");return e=isNaN(e)?0:e}},{key:"getAudioBufferLength",value:function(){var e=this.factory.getInstance("Player").getBufferLength("audio");return e=isNaN(e)?0:e}},{key:"seek",value:function(e){this.factory.getInstance("Player").seek(e);}}])&&l(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}(r(6).a);function b(e){return (b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=b(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=b(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==b(e)?e:e+""}(n.key),n);}}function S(e,t,r){t=I(t);var n=e,e=w()?Reflect.construct(t,r||[],I(e).constructor):t.apply(e,r);if(e&&("object"==b(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");r=n;if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function w(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return (w=function d(){return !!e})()}function I(e){return (I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function P(e,t){return (P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var D=function(e){function t(e){if(this instanceof t)return S(this,t,[e]);throw new TypeError("Cannot call a class as a function")}var n=t;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");return n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&P(n,e),n=t,(e=[{key:"stopPlayer",value:function(){var e=this.factory.getInstance("Player"),t=this.factory.getInstance("Events");t&&t.emit("PlaybackForbidden",{}),e&&e.reset();}},{key:"liveDelay",value:function(){var e=this.factory.getInstance("Player");return e?e.getCurrentLiveLatency():this.factory.getInstance("BufferService").getBufferLength()}},{key:"getPlaybackRate",value:function(){var e=this.factory.getInstance("Player");return e?e.getPlaybackRate():1}}])&&v(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}(r(7).a),T=r(25);function R(e){return (R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=R(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return ("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=R(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return "symbol"==R(e)?e:e+""}(n.key),n);}}function M(e,t,r){t=E(t);var n=e,e=N()?Reflect.construct(t,r||[],E(e).constructor):t.apply(e,r);if(e&&("object"==R(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");r=n;if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function N(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(e){}return (N=function d(){return !!e})()}function E(e){return (E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function L(e,t){return (L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}r=function(e){function a(e,t){var r,n,i;if(this instanceof a)return r=e=M(this,a,[e]),e.factory.setInstance("ManifestService",new T.a(e.factory)),e.factory.setInstance("RequestOverride",new c(e.factory)),e.factory.setInstance("BufferService",new m(e.factory)),e.factory.setInstance("PlayerService",new D(e.factory)),t&&t.debugController&&-1<t.debugController.version.indexOf("voplayer")?(i=!(n=null),Object.defineProperty(t,"corePlayer_",{set:function(e){n=e,i&&(i=!1,r.setPlayer(e.dashPlayer_));},get:function(){return n}},{writable:!0,enumerable:!0,configurable:!0})):t&&e.refreshPlayer(t),e;throw new TypeError("Cannot call a class as a function")}var r=a;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");return r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&L(r,e),r=a,(e=[{key:"setPlayer",value:function(r){this.factory.setInstance("Player",r);var n=this.factory.getInstance("RequestOverride"),e=function e(t){return {load:function(e){n.load(e,r,t);},abort:function(e){n.abort(e,t);},destroy:function(e){n.destroy(e,t);}}},t=(r.extend("HTTPLoader",e,!0),this.factory.getInstance("AnalyticsService"));t.resetBuffer(),r.on("bufferStalled",t.manageBufferStall.bind(t)),r.on("bufferLoaded",t.manageBufferRestart.bind(t));}},{key:"refreshPlayer",value:function(n){var i=this.factory.getInstance("GeneralSettings"),a=(this.factory.getInstance("DownloadController").reset(),this.factory.setInstance("Player",n),this.factory.getInstance("RequestOverride")),o=function o(t){var r=this;try{r.cmsdModel=i.lowLatency?this.factory.getSingletonInstance(r.context,"CmsdModel"):null;}catch(e){}return r.onGoingRequests=[],r.requestID=Math.round(15600*Math.random()),{load:function(e){a.load(e,n,t,r);},abort:function(e){a.abort(e,r);},destroy:function(e){a.destroy(e,t);}}},e=(n.extend("HTTPLoader",o,!0),this.factory.getInstance("AnalyticsService"));e.resetBuffer(),n.on("bufferStalled",e.manageBufferStall.bind(e)),n.on("bufferLoaded",e.manageBufferRestart.bind(e));}},{key:"refreshVideo",value:function(t,e,r){this.factory.getInstance("DownloadController").reset();var n,i=this.factory.getInstance("P2P").factory,a=(i.getInstance("PeerInfosStorage").resetData(),i.getInstance("PeerListStorage")),o=i.getInstance("PeerConnection"),s=a.getListKeys();for(n in s){var c=s[n];o.disconnect(c);}this.factory.setInstance("Player",t);var u=this.factory.getInstance("RequestOverride"),l=function l(){return {load:function(e){u.load(e,t);},abort:function(e){u.abort(e);},destroy:function(e){u.destroy(e);}}},i=(t.extend("HTTPLoader",l,!0),this.factory.getInstance("AnalyticsService"));i.resetBuffer(),t.on("bufferStalled",i.manageBufferStall.bind(i)),t.on("bufferLoaded",i.manageBufferRestart.bind(i));}}])&&q(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}(n["default"]);t["default"]=r;},,function(e,t,r){r.r(t);var n=r(72),r=r(73),n={QuanteecHls:n["default"],QuanteecDash:r["default"],LOG_LEVEL_NONE:0,LOG_LEVEL_ERROR:1,LOG_LEVEL_INFOS:2,LOG_LEVEL_DEBUG:3,LOG_LEVEL_TRACE:4};t["default"]=n;}],n={},i.m=r,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r});},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0});},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=75)["default"];function i(e){var t;return (n[e]||(t=n[e]={i:e,l:!1,exports:{}},r[e].call(t.exports,t,t.exports,i),t.l=!0,t)).exports}var r,n;});var e$1,t,n,r,a$1,l,o,i,s$1,u,c=Object.create,f=Object.defineProperty,d=Object.getOwnPropertyDescriptor,p=Object.getOwnPropertyNames,h=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty,g=(e,t)=>function(){return t||(0, e[p(e)[0]])((t={exports:{}}).exports,t),t.exports},y=(e,t,n)=>(n=null!=e?c(h(e)):{},((e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(var a,l=p(t),o=0,i=l.length;o<i;o++)a=l[o],m.call(e,a)||void 0===a||f(e,a,{get:(e=>t[e]).bind(null,a),enumerable:!(r=d(t,a))||r.enumerable});return e})(!t&&e&&e.__esModule?n:f(n,"default",{value:e,enumerable:!0}),e));function v(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function b(){throw new Error("setTimeout has not been defined")}function w(){throw new Error("clearTimeout has not been defined")}function k(e){if(n===setTimeout)return setTimeout(e,0);if((n===b||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}function C(){l&&o&&(l=!1,o.length?a$1=o.concat(a$1):i=-1,a$1.length&&x());}function x(){if(!l){var e=k(C);l=!0;for(var t=a$1.length;t;){for(o=a$1,a$1=[];++i<t;)o&&o[i].run();i=-1,t=a$1.length;}o=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===w||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e);}}function S(e,t){this.fun=e,this.array=t;}function E(){}var _,A,P=(_={"node_modules/vite-plugin-node-polyfills/shims/process/dist/index.js":()=>{t=(e$1={exports:{}}).exports={},function(){try{n="function"==typeof setTimeout?setTimeout:b;}catch(e){n=b;}try{r="function"==typeof clearTimeout?clearTimeout:w;}catch(e){r=w;}}(),a$1=[],l=!1,i=-1,t.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];a$1.push(new S(e,t)),1!==a$1.length||l||k(x);},S.prototype.run=function(){this.fun.apply(null,this.array);},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=E,t.addListener=E,t.once=E,t.off=E,t.removeListener=E,t.removeAllListeners=E,t.emit=E,t.prependListener=E,t.prependOnceListener=E,t.listeners=function(e){return []},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return "/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0},s$1=e$1.exports,u=v(s$1);}},function(){return _&&(A=(0, _[p(_)[0]])(_=0)),A}),j=g({"node_modules/react/cjs/react.production.js":e=>{P();var t=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),i=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),h=Symbol.iterator,m={isMounted:function(){return !1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,y={};function v(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||m;}function b(){}function w(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||m;}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState");},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate");},b.prototype=v.prototype;var k=w.prototype=new b;k.constructor=w,g(k,v.prototype),k.isPureReactComponent=!0;var C=Array.isArray;function x(){}var S={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function _(e,n,r){var a=r.ref;return {$$typeof:t,type:e,key:n,ref:void 0!==a?a:null,props:r}}function A(e){return "object"==typeof e&&null!==e&&e.$$typeof===t}var j=/\/+/g;function N(e,t){return "object"==typeof e&&null!==e&&null!=e.key?(n=""+e.key,r={"=":"=0",":":"=2"},"$"+n.replace(/[=:]/g,function(e){return r[e]})):t.toString(36);var n,r;}function z(e,r,a,l,o){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var s,u,c=!1;if(null===e)c=!0;else switch(i){case"bigint":case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case t:case n:c=!0;break;case d:return z((c=e._init)(e._payload),r,a,l,o)}}if(c)return o=o(e),c=""===l?"."+N(e,0):l,C(o)?(a="",null!=c&&(a=c.replace(j,"$&/")+"/"),z(o,r,a,"",function(e){return e})):null!=o&&(A(o)&&(s=o,u=a+(null==o.key||e&&e.key===o.key?"":(""+o.key).replace(j,"$&/")+"/")+c,o=_(s.type,u,s.props)),r.push(o)),1;c=0;var f,p=""===l?".":l+":";if(C(e))for(var m=0;m<e.length;m++)c+=z(l=e[m],r,a,i=p+N(l,m),o);else if("function"==typeof(m=null===(f=e)||"object"!=typeof f?null:"function"==typeof(f=h&&f[h]||f["@@iterator"])?f:null))for(e=m.call(e),m=0;!(l=e.next()).done;)c+=z(l=l.value,r,a,i=p+N(l,m++),o);else if("object"===i){if("function"==typeof e.then)return z(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"==typeof e.status?e.then(x,x):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t);},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t);})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),r,a,l,o);throw r=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===r?"object with keys {"+Object.keys(e).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.")}return c}function L(e,t,n){if(null==e)return e;var r=[],a=0;return z(e,r,"","",function(e){return t.call(n,e,a++)}),r}function T(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t);},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t);}),-1===e._status&&(e._status=0,e._result=t);}if(1===e._status)return e._result.default;throw e._result}var I="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof u&&"function"==typeof u.emit)return void u.emit("uncaughtException",e);console.error(e);},O={map:L,forEach:function(e,t,n){L(e,function(){t.apply(this,arguments);},n);},count:function(e){var t=0;return L(e,function(){t++;}),t},toArray:function(e){return L(e,function(e){return e})||[]},only:function(e){if(!A(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};e.Activity=p,e.Children=O,e.Component=v,e.Fragment=r,e.Profiler=l,e.PureComponent=w,e.StrictMode=a,e.Suspense=c,e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,e.__COMPILER_RUNTIME={__proto__:null,c:function(e){return S.H.useMemoCache(e)}},e.cache=function(e){return function(){return e.apply(null,arguments)}},e.cacheSignal=function(){return null},e.cloneElement=function(e,t,n){if(null==e)throw Error("The argument must be a React element, but you passed "+e+".");var r=g({},e.props),a=e.key;if(null!=t)for(l in void 0!==t.key&&(a=""+t.key),t)!E.call(t,l)||"key"===l||"__self"===l||"__source"===l||"ref"===l&&void 0===t.ref||(r[l]=t[l]);var l=arguments.length-2;if(1===l)r.children=n;else if(1<l){for(var o=Array(l),i=0;i<l;i++)o[i]=arguments[i+2];r.children=o;}return _(e.type,a,r)},e.createContext=function(e){return (e={$$typeof:i,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:o,_context:e},e},e.createElement=function(e,t,n){var r,a={},l=null;if(null!=t)for(r in void 0!==t.key&&(l=""+t.key),t)E.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(a[r]=t[r]);var o=arguments.length-2;if(1===o)a.children=n;else if(1<o){for(var i=Array(o),s=0;s<o;s++)i[s]=arguments[s+2];a.children=i;}if(e&&e.defaultProps)for(r in o=e.defaultProps)void 0===a[r]&&(a[r]=o[r]);return _(e,l,a)},e.createRef=function(){return {current:null}},e.forwardRef=function(e){return {$$typeof:s,render:e}},e.isValidElement=A,e.lazy=function(e){return {$$typeof:d,_payload:{_status:-1,_result:e},_init:T}},e.memo=function(e,t){return {$$typeof:f,type:e,compare:void 0===t?null:t}},e.startTransition=function(e){var t=S.T,n={};S.T=n;try{var r=e(),a=S.S;null!==a&&a(n,r),"object"==typeof r&&null!==r&&"function"==typeof r.then&&r.then(x,I);}catch(e){I(e);}finally{null!==t&&null!==n.types&&(t.types=n.types),S.T=t;}},e.unstable_useCacheRefresh=function(){return S.H.useCacheRefresh()},e.use=function(e){return S.H.use(e)},e.useActionState=function(e,t,n){return S.H.useActionState(e,t,n)},e.useCallback=function(e,t){return S.H.useCallback(e,t)},e.useContext=function(e){return S.H.useContext(e)},e.useDebugValue=function(){},e.useDeferredValue=function(e,t){return S.H.useDeferredValue(e,t)},e.useEffect=function(e,t){return S.H.useEffect(e,t)},e.useEffectEvent=function(e){return S.H.useEffectEvent(e)},e.useId=function(){return S.H.useId()},e.useImperativeHandle=function(e,t,n){return S.H.useImperativeHandle(e,t,n)},e.useInsertionEffect=function(e,t){return S.H.useInsertionEffect(e,t)},e.useLayoutEffect=function(e,t){return S.H.useLayoutEffect(e,t)},e.useMemo=function(e,t){return S.H.useMemo(e,t)},e.useOptimistic=function(e,t){return S.H.useOptimistic(e,t)},e.useReducer=function(e,t,n){return S.H.useReducer(e,t,n)},e.useRef=function(e){return S.H.useRef(e)},e.useState=function(e){return S.H.useState(e)},e.useSyncExternalStore=function(e,t,n){return S.H.useSyncExternalStore(e,t,n)},e.useTransition=function(){return S.H.useTransition()},e.version="19.2.0";}}),N=g({"node_modules/react/index.js":(e,t)=>{t.exports=j();}}),z=y(N()),L=function(){return L=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},L.apply(this,arguments)};function T(e,t,n){if(n||2===arguments.length)for(var r,a=0,l=t.length;a<l;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}var I=g({"node_modules/shallowequal/index.js":(e,t)=>{t.exports=function(e,t,n,r){var a=n?n.call(r,e,t):void 0;if(void 0!==a)return !!a;if(e===t)return !0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return !1;var l=Object.keys(e),o=Object.keys(t);if(l.length!==o.length)return !1;for(var i=Object.prototype.hasOwnProperty.bind(t),s=0;s<l.length;s++){var u=l[s];if(!i(u))return !1;var c=e[u],f=t[u];if(!1===(a=n?n.call(r,c,f,u):void 0)||void 0===a&&c!==f)return !1}return !0};}}),O="-ms-",$="-moz-",D="-webkit-",M="comm",R="rule",F="decl",B="@keyframes",U=Math.abs,H=String.fromCharCode,V=Object.assign;function q(e){return e.trim()}function W(e,t){return (e=t.exec(e))?e[0]:e}function Q(e,t,n){return e.replace(t,n)}function G(e,t,n){return e.indexOf(t,n)}function Y(e,t){return 0|e.charCodeAt(t)}function Z(e,t,n){return e.slice(t,n)}function K(e){return e.length}function X(e){return e.length}function J(e,t){return t.push(e),e}function ee(e,t){return e.filter(function(e){return !W(e,t)})}var te=1,ne=1,re=0,ae=0,le=0,oe="";function ie(e,t,n,r,a,l,o,i){return {value:e,root:t,parent:n,type:r,props:a,children:l,line:te,column:ne,length:o,return:"",siblings:i}}function se(e,t){return V(ie("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function ue(e){for(;e.root;)e=se(e.root,{children:[e]});J(e,e.siblings);}function ce(){return le=ae>0?Y(oe,--ae):0,ne--,10===le&&(ne=1,te--),le}function fe(){return le=ae<re?Y(oe,ae++):0,ne++,10===le&&(ne=1,te++),le}function de(){return Y(oe,ae)}function pe(){return ae}function he(e,t){return Z(oe,e,t)}function me(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function ge(e){return q(he(ae-1,be(91===e?e+2:40===e?e+1:e)))}function ye(e){for(;(le=de())&&le<33;)fe();return me(e)>2||me(le)>3?"":" "}function ve(e,t){for(;--t&&fe()&&!(le<48||le>102||le>57&&le<65||le>70&&le<97););return he(e,pe()+(t<6&&32==de()&&32==fe()))}function be(e){for(;fe();)switch(le){case e:return ae;case 34:case 39:34!==e&&39!==e&&be(le);break;case 40:41===e&&be(e);break;case 92:fe();}return ae}function we(e,t){for(;fe()&&e+le!==57&&(e+le!==84||47!==de()););return "/*"+he(t,ae-1)+"*"+H(47===e?e:fe())}function ke(e){for(;!me(de());)fe();return he(e,ae)}function Ce(e){return function(e){return oe="",e}(xe("",null,null,null,[""],e=function(e){return te=ne=1,re=K(oe=e),ae=0,[]}(e),0,[0],e))}function xe(e,t,n,r,a,l,o,i,s){for(var u=0,c=0,f=o,d=0,p=0,h=0,m=1,g=1,y=1,v=0,b="",w=a,k=l,C=r,x=b;g;)switch(h=v,v=fe()){case 40:if(108!=h&&58==Y(x,f-1)){-1!=G(x+=Q(ge(v),"&","&\f"),"&\f",U(u?i[u-1]:0))&&(y=-1);break}case 34:case 39:case 91:x+=ge(v);break;case 9:case 10:case 13:case 32:x+=ye(h);break;case 92:x+=ve(pe()-1,7);continue;case 47:switch(de()){case 42:case 47:J(Ee(we(fe(),pe()),t,n,s),s);break;default:x+="/";}break;case 123*m:i[u++]=K(x)*y;case 125*m:case 59:case 0:switch(v){case 0:case 125:g=0;case 59+c:-1==y&&(x=Q(x,/\f/g,"")),p>0&&K(x)-f&&J(p>32?_e(x+";",r,n,f-1,s):_e(Q(x," ","")+";",r,n,f-2,s),s);break;case 59:x+=";";default:if(J(C=Se(x,t,n,u,c,a,i,b,w=[],k=[],f,l),l),123===v)if(0===c)xe(x,t,C,C,w,l,f,i,k);else switch(99===d&&110===Y(x,3)?100:d){case 100:case 108:case 109:case 115:xe(e,C,C,r&&J(Se(e,C,C,0,0,a,i,b,a,w=[],f,k),k),a,k,f,i,r?w:k);break;default:xe(x,C,C,C,[""],k,0,i,k);}}u=c=p=0,m=y=1,b=x="",f=o;break;case 58:f=1+K(x),p=h;default:if(m<1)if(123==v)--m;else if(125==v&&0==m++&&125==ce())continue;switch(x+=H(v),v*m){case 38:y=c>0?1:(x+="\f",-1);break;case 44:i[u++]=(K(x)-1)*y,y=1;break;case 64:45===de()&&(x+=ge(fe())),d=de(),c=f=K(b=x+=ke(pe())),v++;break;case 45:45===h&&2==K(x)&&(m=0);}}return l}function Se(e,t,n,r,a,l,o,i,s,u,c,f){for(var d=a-1,p=0===a?l:[""],h=X(p),m=0,g=0,y=0;m<r;++m)for(var v=0,b=Z(e,d+1,d=U(g=o[m])),w=e;v<h;++v)(w=q(g>0?p[v]+" "+b:Q(b,/&\f/g,p[v])))&&(s[y++]=w);return ie(e,t,n,0===a?R:i,s,u,c,f)}function Ee(e,t,n,r){return ie(e,t,n,M,H(le),Z(e,2,-2),0,r)}function _e(e,t,n,r,a){return ie(e,t,n,F,Z(e,0,r),Z(e,r+1,-1),r,a)}function Ae(e,t,n){switch(function(e,t){return 45^Y(e,0)?(((t<<2^Y(e,0))<<2^Y(e,1))<<2^Y(e,2))<<2^Y(e,3):0}(e,t)){case 5103:return D+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return D+e+e;case 4789:return $+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return D+e+$+e+O+e+e;case 5936:switch(Y(e,t+11)){case 114:return D+e+O+Q(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return D+e+O+Q(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return D+e+O+Q(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return D+e+O+e+e;case 6165:return D+e+O+"flex-"+e+e;case 5187:return D+e+Q(e,/(\w+).+(:[^]+)/,D+"box-$1$2"+O+"flex-$1$2")+e;case 5443:return D+e+O+"flex-item-"+Q(e,/flex-|-self/g,"")+(W(e,/flex-|baseline/)?"":O+"grid-row-"+Q(e,/flex-|-self/g,""))+e;case 4675:return D+e+O+"flex-line-pack"+Q(e,/align-content|flex-|-self/g,"")+e;case 5548:return D+e+O+Q(e,"shrink","negative")+e;case 5292:return D+e+O+Q(e,"basis","preferred-size")+e;case 6060:return D+"box-"+Q(e,"-grow","")+D+e+O+Q(e,"grow","positive")+e;case 4554:return D+Q(e,/([^-])(transform)/g,"$1"+D+"$2")+e;case 6187:return Q(Q(Q(e,/(zoom-|grab)/,D+"$1"),/(image-set)/,D+"$1"),e,"")+e;case 5495:case 3959:return Q(e,/(image-set\([^]*)/,D+"$1$`$1");case 4968:return Q(Q(e,/(.+:)(flex-)?(.*)/,D+"box-pack:$3"+O+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+D+e+e;case 4200:if(!W(e,/flex-|baseline/))return O+"grid-column-align"+Z(e,t)+e;break;case 2592:case 3360:return O+Q(e,"template-","")+e;case 4384:case 3616:return n&&n.some(function(e,n){return t=n,W(e.props,/grid-\w+-end/)})?~G(e+(n=n[t].value),"span",0)?e:O+Q(e,"-start","")+e+O+"grid-row-span:"+(~G(n,"span",0)?W(n,/\d+/):+W(n,/\d+/)-+W(e,/\d+/))+";":O+Q(e,"-start","")+e;case 4896:case 4128:return n&&n.some(function(e){return W(e.props,/grid-\w+-start/)})?e:O+Q(Q(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return Q(e,/(.+)-inline(.+)/,D+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(K(e)-1-t>6)switch(Y(e,t+1)){case 109:if(45!==Y(e,t+4))break;case 102:return Q(e,/(.+:)(.+)-([^]+)/,"$1"+D+"$2-$3$1"+$+(108==Y(e,t+3)?"$3":"$2-$3"))+e;case 115:return ~G(e,"stretch",0)?Ae(Q(e,"stretch","fill-available"),t,n)+e:e}break;case 5152:case 5920:return Q(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(t,n,r,a,l,o,i){return O+n+":"+r+i+(a?O+n+"-span:"+(l?o:+o-+r)+i:"")+e});case 4949:if(121===Y(e,t+6))return Q(e,":",":"+D)+e;break;case 6444:switch(Y(e,45===Y(e,14)?18:11)){case 120:return Q(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+D+(45===Y(e,14)?"inline-":"")+"box$3$1"+D+"$2$3$1"+O+"$2box$3")+e;case 100:return Q(e,":",":"+O)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Q(e,"scroll-","scroll-snap-")+e}return e}function Pe(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function je(e,t,n,r){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case F:return e.return=e.return||e.value;case M:return "";case B:return e.return=e.value+"{"+Pe(e.children,r)+"}";case R:if(!K(e.value=e.props.join(",")))return ""}return K(n=Pe(e.children,r))?e.return=e.value+"{"+n+"}":""}function Ne(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case F:return void(e.return=Ae(e.value,e.length,n));case B:return Pe([se(e,{value:Q(e.value,"@","@"+D)})],r);case R:if(e.length)return function(e,t){return e.map(t).join("")}(n=e.props,function(t){switch(W(t,r=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":ue(se(e,{props:[Q(t,/:(read-\w+)/,":-moz-$1")]})),ue(se(e,{props:[t]})),V(e,{props:ee(n,r)});break;case"::placeholder":ue(se(e,{props:[Q(t,/:(plac\w+)/,":"+D+"input-$1")]})),ue(se(e,{props:[Q(t,/:(plac\w+)/,":-moz-$1")]})),ue(se(e,{props:[Q(t,/:(plac\w+)/,O+"input-$1")]})),ue(se(e,{props:[t]})),V(e,{props:ee(n,r)});}return ""})}}y(I());var Le={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};P();var Te=void 0!==u&&void 0!==u.env&&(u.env.REACT_APP_SC_ATTR||u.env.SC_ATTR)||"data-styled",Ie="active",Oe="data-styled-version",$e="6.1.19",De="/*!sc*/\n",Me="undefined"!=typeof window&&"undefined"!=typeof document,Re=Boolean("boolean"==typeof SC_DISABLE_SPEEDY?SC_DISABLE_SPEEDY:void 0!==u&&void 0!==u.env&&void 0!==u.env.REACT_APP_SC_DISABLE_SPEEDY&&""!==u.env.REACT_APP_SC_DISABLE_SPEEDY?"false"!==u.env.REACT_APP_SC_DISABLE_SPEEDY&&u.env.REACT_APP_SC_DISABLE_SPEEDY:void 0!==u&&void 0!==u.env&&void 0!==u.env.SC_DISABLE_SPEEDY&&""!==u.env.SC_DISABLE_SPEEDY&&"false"!==u.env.SC_DISABLE_SPEEDY&&u.env.SC_DISABLE_SPEEDY),Fe=Object.freeze([]),Be=Object.freeze({}),Ue=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),He=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,Ve=/(^-|-$)/g;function qe(e){return e.replace(He,"-").replace(Ve,"")}var We=/(a)(d)/gi,Qe=function(e){return String.fromCharCode(e+(e>25?39:97))};function Ge(e){var t,n="";for(t=Math.abs(e);t>52;t=t/52|0)n=Qe(t%52)+n;return (Qe(t%52)+n).replace(We,"$1-$2")}var Ye,Ze=function(e,t){for(var n=t.length;n;)e=33*e^t.charCodeAt(--n);return e},Ke=function(e){return Ze(5381,e)};function Xe(e){return "string"==typeof e&&!0}var Je="function"==typeof Symbol&&Symbol.for,et=Je?Symbol.for("react.memo"):60115,tt=Je?Symbol.for("react.forward_ref"):60112,nt={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},rt={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},at={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},lt=((Ye={})[tt]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Ye[et]=at,Ye);function ot(e){return ("type"in(t=e)&&t.type.$$typeof)===et?at:"$$typeof"in e?lt[e.$$typeof]:nt;var t;}var it=Object.defineProperty,st=Object.getOwnPropertyNames,ut=Object.getOwnPropertySymbols,ct=Object.getOwnPropertyDescriptor,ft=Object.getPrototypeOf,dt=Object.prototype;function pt(e,t,n){if("string"!=typeof t){if(dt){var r=ft(t);r&&r!==dt&&pt(e,r,n);}var a=st(t);ut&&(a=a.concat(ut(t)));for(var l=ot(e),o=ot(t),i=0;i<a.length;++i){var s=a[i];if(!(s in rt||n&&n[s]||o&&s in o||l&&s in l)){var u=ct(t,s);try{it(e,s,u);}catch(e){}}}}return e}function ht(e){return "function"==typeof e}function mt(e){return "object"==typeof e&&"styledComponentId"in e}function gt(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function yt(e,t){if(0===e.length)return "";for(var n=e[0],r=1;r<e.length;r++)n+=t?t+e[r]:e[r];return n}function vt(e){return null!==e&&"object"==typeof e&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function bt(e,t,n){if(void 0===n&&(n=!1),!n&&!vt(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var r=0;r<t.length;r++)e[r]=bt(e[r],t[r]);else if(vt(t))for(var r in t)e[r]=bt(e[r],t[r]);return e}function wt(e,t){Object.defineProperty(e,"toString",{value:t});}function kt(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var Ct=function(){function e(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e;}return e.prototype.indexOfGroup=function(e){for(var t=0,n=0;n<e;n++)t+=this.groupSizes[n];return t},e.prototype.insertRules=function(e,t){if(e>=this.groupSizes.length){for(var n=this.groupSizes,r=n.length,a=r;e>=a;)if((a<<=1)<0)throw kt(16,"".concat(e));this.groupSizes=new Uint32Array(a),this.groupSizes.set(n),this.length=a;for(var l=r;l<a;l++)this.groupSizes[l]=0;}for(var o=this.indexOfGroup(e+1),i=(l=0,t.length);l<i;l++)this.tag.insertRule(o,t[l])&&(this.groupSizes[e]++,o++);},e.prototype.clearGroup=function(e){if(e<this.length){var t=this.groupSizes[e],n=this.indexOfGroup(e),r=n+t;this.groupSizes[e]=0;for(var a=n;a<r;a++)this.tag.deleteRule(n);}},e.prototype.getGroup=function(e){var t="";if(e>=this.length||0===this.groupSizes[e])return t;for(var n=this.groupSizes[e],r=this.indexOfGroup(e),a=r+n,l=r;l<a;l++)t+="".concat(this.tag.getRule(l)).concat(De);return t},e}(),xt=new Map,St=new Map,Et=1,_t=function(e){if(xt.has(e))return xt.get(e);for(;St.has(Et);)Et++;var t=Et++;return xt.set(e,t),St.set(t,e),t},At=function(e,t){Et=t+1,xt.set(e,t),St.set(t,e);},Pt="style[".concat(Te,"][").concat(Oe,'="').concat($e,'"]'),jt=new RegExp("^".concat(Te,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),Nt=function(e,t,n){for(var r,a=n.split(","),l=0,o=a.length;l<o;l++)(r=a[l])&&e.registerName(t,r);},zt=function(e,t){for(var n,r=(null!==(n=t.textContent)&&void 0!==n?n:"").split(De),a=[],l=0,o=r.length;l<o;l++){var i=r[l].trim();if(i){var s=i.match(jt);if(s){var u=0|parseInt(s[1],10),c=s[2];0!==u&&(At(c,u),Nt(e,c,s[3]),e.getTag().insertRules(u,a)),a.length=0;}else a.push(i);}}},Lt=function(e){for(var t=document.querySelectorAll(Pt),n=0,r=t.length;n<r;n++){var a=t[n];a&&a.getAttribute(Te)!==Ie&&(zt(e,a),a.parentNode&&a.parentNode.removeChild(a));}};function Tt(){return "undefined"!=typeof __webpack_nonce__?__webpack_nonce__:null}var It=function(e){var t,n,r=document.head,a=e||r,l=document.createElement("style"),o=(t=a,(n=Array.from(t.querySelectorAll("style[".concat(Te,"]"))))[n.length-1]),i=void 0!==o?o.nextSibling:null;l.setAttribute(Te,Ie),l.setAttribute(Oe,$e);var s=Tt();return s&&l.setAttribute("nonce",s),a.insertBefore(l,i),l},Ot=function(){function e(e){this.element=It(e),this.element.appendChild(document.createTextNode("")),this.sheet=function(e){if(e.sheet)return e.sheet;for(var t=document.styleSheets,n=0,r=t.length;n<r;n++){var a=t[n];if(a.ownerNode===e)return a}throw kt(17)}(this.element),this.length=0;}return e.prototype.insertRule=function(e,t){try{return this.sheet.insertRule(t,e),this.length++,!0}catch(e){return !1}},e.prototype.deleteRule=function(e){this.sheet.deleteRule(e),this.length--;},e.prototype.getRule=function(e){var t=this.sheet.cssRules[e];return t&&t.cssText?t.cssText:""},e}(),$t=function(){function e(e){this.element=It(e),this.nodes=this.element.childNodes,this.length=0;}return e.prototype.insertRule=function(e,t){if(e<=this.length&&e>=0){var n=document.createTextNode(t);return this.element.insertBefore(n,this.nodes[e]||null),this.length++,!0}return !1},e.prototype.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--;},e.prototype.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},e}(),Dt=function(){function e(e){this.rules=[],this.length=0;}return e.prototype.insertRule=function(e,t){return e<=this.length&&(this.rules.splice(e,0,t),this.length++,!0)},e.prototype.deleteRule=function(e){this.rules.splice(e,1),this.length--;},e.prototype.getRule=function(e){return e<this.length?this.rules[e]:""},e}(),Mt=Me,Rt={isServer:!Me,useCSSOMInjection:!Re},Ft=function(){function e(e,t,n){void 0===e&&(e=Be),void 0===t&&(t={});var r=this;this.options=L(L({},Rt),e),this.gs=t,this.names=new Map(n),this.server=!!e.isServer,!this.server&&Me&&Mt&&(Mt=!1,Lt(this)),wt(this,function(){return function(e){for(var t=e.getTag(),n=t.length,r="",a=function(n){var a,l=(a=n,St.get(a));if(void 0===l)return "continue";var o=e.names.get(l),i=t.getGroup(n);if(void 0===o||!o.size||0===i.length)return "continue";var s="".concat(Te,".g").concat(n,'[id="').concat(l,'"]'),u="";void 0!==o&&o.forEach(function(e){e.length>0&&(u+="".concat(e,","));}),r+="".concat(i).concat(s,'{content:"').concat(u,'"}').concat(De);},l=0;l<n;l++)a(l);return r}(r)});}return e.registerId=function(e){return _t(e)},e.prototype.rehydrate=function(){!this.server&&Me&&Lt(this);},e.prototype.reconstructWithOptions=function(t,n){return void 0===n&&(n=!0),new e(L(L({},this.options),t),this.gs,n&&this.names||void 0)},e.prototype.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(t=(e=this.options).useCSSOMInjection,n=e.target,r=e.isServer?new Dt(n):t?new Ot(n):new $t(n),new Ct(r)));var e,t,n,r;},e.prototype.hasNameForId=function(e,t){return this.names.has(e)&&this.names.get(e).has(t)},e.prototype.registerName=function(e,t){if(_t(e),this.names.has(e))this.names.get(e).add(t);else {var n=new Set;n.add(t),this.names.set(e,n);}},e.prototype.insertRules=function(e,t,n){this.registerName(e,t),this.getTag().insertRules(_t(e),n);},e.prototype.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear();},e.prototype.clearRules=function(e){this.getTag().clearGroup(_t(e)),this.clearNames(e);},e.prototype.clearTag=function(){this.tag=void 0;},e}(),Bt=/&/g,Ut=/^\s*\/\/.*$/gm;function Ht(e,t){return e.map(function(e){return "rule"===e.type&&(e.value="".concat(t," ").concat(e.value),e.value=e.value.replaceAll(",",",".concat(t," ")),e.props=e.props.map(function(e){return "".concat(t," ").concat(e)})),Array.isArray(e.children)&&"@keyframes"!==e.type&&(e.children=Ht(e.children,t)),e})}function Vt(e){var t,n,r,a=void 0===e?Be:e,l=a.options,o=void 0===l?Be:l,i=a.plugins,s=void 0===i?Fe:i,u=function(e,r,a){return a.startsWith(n)&&a.endsWith(n)&&a.replaceAll(n,"").length>0?".".concat(t):e},c=s.slice();c.push(function(e){"rule"===e.type&&e.value.includes("&")&&(e.props[0]=e.props[0].replace(Bt,n).replace(r,u));}),o.prefix&&c.push(Ne),c.push(je);var f=function(e,a,l,i){void 0===a&&(a=""),void 0===l&&(l=""),void 0===i&&(i="&"),t=i,n=a,r=new RegExp("\\".concat(n,"\\b"),"g");var s=e.replace(Ut,""),u=Ce(l||a?"".concat(l," ").concat(a," { ").concat(s," }"):s);o.namespace&&(u=Ht(u,o.namespace));var f,d,p,h=[];return Pe(u,(f=c.concat((p=function(e){return h.push(e)},function(e){e.root||(e=e.return)&&p(e);})),d=X(f),function(e,t,n,r){for(var a="",l=0;l<d;l++)a+=f[l](e,t,n,r)||"";return a})),h};return f.hash=s.length?s.reduce(function(e,t){return t.name||kt(15),Ze(e,t.name)},5381).toString():"",f}var qt=new Ft,Wt=Vt(),Qt=z.createContext({shouldForwardProp:void 0,styleSheet:qt,stylis:Wt});(Qt.Consumer,z.createContext(void 0));function Yt(){return (0, z.useContext)(Qt)}var Kt=function(){function e(e,t){var n=this;this.inject=function(e,t){void 0===t&&(t=Wt);var r=n.name+t.hash;e.hasNameForId(n.id,r)||e.insertRules(n.id,r,t(n.rules,r,"@keyframes"));},this.name=e,this.id="sc-keyframes-".concat(e),this.rules=t,wt(this,function(){throw kt(12,String(n.name))});}return e.prototype.getName=function(e){return void 0===e&&(e=Wt),this.name+e.hash},e}(),Xt=function(e){return e>="A"&&e<="Z"};function Jt(e){for(var t="",n=0;n<e.length;n++){var r=e[n];if(1===n&&"-"===r&&"-"===e[0])return e;Xt(r)?t+="-"+r.toLowerCase():t+=r;}return t.startsWith("ms-")?"-"+t:t}var en=function(e){return null==e||!1===e||""===e},tn=function(e){var t,n,r=[];for(var a in e){var l=e[a];e.hasOwnProperty(a)&&!en(l)&&(Array.isArray(l)&&l.isCss||ht(l)?r.push("".concat(Jt(a),":"),l,";"):vt(l)?r.push.apply(r,T(T(["".concat(a," {")],tn(l),!1),["}"],!1)):r.push("".concat(Jt(a),": ").concat((t=a,null==(n=l)||"boolean"==typeof n||""===n?"":"number"!=typeof n||0===n||t in Le||t.startsWith("--")?String(n).trim():"".concat(n,"px")),";")));}return r};function nn(e,t,n,r){return en(e)?[]:mt(e)?[".".concat(e.styledComponentId)]:ht(e)?!ht(a=e)||a.prototype&&a.prototype.isReactComponent||!t?[e]:nn(e(t),t,n,r):e instanceof Kt?n?(e.inject(n,r),[e.getName(r)]):[e]:vt(e)?tn(e):Array.isArray(e)?Array.prototype.concat.apply(Fe,e.map(function(e){return nn(e,t,n,r)})):[e.toString()];var a;}function rn(e){for(var t=0;t<e.length;t+=1){var n=e[t];if(ht(n)&&!mt(n))return !1}return !0}var an=Ke($e),ln=function(){function e(e,t,n){this.rules=e,this.staticRulesId="",this.isStatic=(void 0===n||n.isStatic)&&rn(e),this.componentId=t,this.baseHash=Ze(an,t),this.baseStyle=n,Ft.registerId(t);}return e.prototype.generateAndInjectStyles=function(e,t,n){var r=this.baseStyle?this.baseStyle.generateAndInjectStyles(e,t,n):"";if(this.isStatic&&!n.hash)if(this.staticRulesId&&t.hasNameForId(this.componentId,this.staticRulesId))r=gt(r,this.staticRulesId);else {var a=yt(nn(this.rules,e,t,n)),l=Ge(Ze(this.baseHash,a)>>>0);if(!t.hasNameForId(this.componentId,l)){var o=n(a,".".concat(l),void 0,this.componentId);t.insertRules(this.componentId,l,o);}r=gt(r,l),this.staticRulesId=l;}else {for(var i=Ze(this.baseHash,n.hash),s="",u=0;u<this.rules.length;u++){var c=this.rules[u];if("string"==typeof c)s+=c;else if(c){var f=yt(nn(c,e,t,n));i=Ze(i,f+u),s+=f;}}if(s){var d=Ge(i>>>0);t.hasNameForId(this.componentId,d)||t.insertRules(this.componentId,d,n(s,".".concat(d),void 0,this.componentId)),r=gt(r,d);}}return r},e}(),on=z.createContext(void 0),sn=(on.Consumer,{});function un(e,t,n){var r,a=mt(e),l=e,o=!Xe(e),i=t.attrs,s=void 0===i?Fe:i,u=t.componentId,c=void 0===u?function(e,t){var n="string"!=typeof e?"sc":qe(e);sn[n]=(sn[n]||0)+1;var r="".concat(n,"-").concat(function(e){return Ge(Ke(e)>>>0)}($e+n+sn[n]));return t?"".concat(t,"-").concat(r):r}(t.displayName,t.parentComponentId):u,f=t.displayName,d=void 0===f?Xe(r=e)?"styled.".concat(r):"Styled(".concat(function(e){return e.displayName||e.name||"Component"}(r),")"):f,p=t.displayName&&t.componentId?"".concat(qe(t.displayName),"-").concat(t.componentId):t.componentId||c,h=a&&l.attrs?l.attrs.concat(s).filter(Boolean):s,m=t.shouldForwardProp;if(a&&l.shouldForwardProp){var g=l.shouldForwardProp;if(t.shouldForwardProp){var y=t.shouldForwardProp;m=function(e,t){return g(e,t)&&y(e,t)};}else m=g;}var v=new ln(n,p,a?l.componentStyle:void 0);function b(e,t){return function(e,t,n){var r=e.attrs,a=e.componentStyle,l=e.defaultProps,o=e.foldedComponentIds,i=e.styledComponentId,s=e.target,u=z.useContext(on),c=Yt(),f=e.shouldForwardProp||c.shouldForwardProp,d=function(e,t,n){return void 0===n&&(n=Be),e.theme!==n.theme&&e.theme||t||n.theme}(t,u,l)||Be,p=function(e,t,n){for(var r,a=L(L({},t),{className:void 0,theme:n}),l=0;l<e.length;l+=1){var o=ht(r=e[l])?r(a):r;for(var i in o)a[i]="className"===i?gt(a[i],o[i]):"style"===i?L(L({},a[i]),o[i]):o[i];}return t.className&&(a.className=gt(a.className,t.className)),a}(r,t,d),h=p.as||s,m={};for(var g in p)void 0===p[g]||"$"===g[0]||"as"===g||"theme"===g&&p.theme===d||("forwardedAs"===g?m.as=p.forwardedAs:f&&!f(g,h)||(m[g]=p[g]));var y,v,b,w=(y=a,v=p,b=Yt(),y.generateAndInjectStyles(v,b.styleSheet,b.stylis)),k=gt(o,i);return w&&(k+=" "+w),p.className&&(k+=" "+p.className),m[Xe(h)&&!Ue.has(h)?"class":"className"]=k,n&&(m.ref=n),(0, z.createElement)(h,m)}(w,e,t)}b.displayName=d;var w=z.forwardRef(b);return w.attrs=h,w.componentStyle=v,w.displayName=d,w.shouldForwardProp=m,w.foldedComponentIds=a?gt(l.foldedComponentIds,l.styledComponentId):"",w.styledComponentId=p,w.target=a?l.target:e,Object.defineProperty(w,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(e){this._foldedDefaultProps=a?function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,a=t;r<a.length;r++)bt(e,a[r],!0);return e}({},l.defaultProps,e):e;}}),wt(w,function(){return ".".concat(w.styledComponentId)}),o&&pt(w,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),w}function cn(e,t){for(var n=[e[0]],r=0,a=t.length;r<a;r+=1)n.push(t[r],e[r+1]);return n}var fn=function(e){return Object.assign(e,{isCss:!0})};function dn(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(ht(e)||vt(e))return fn(nn(cn(Fe,T([e],t,!0))));var r=e;return 0===t.length&&1===r.length&&"string"==typeof r[0]?nn(r):fn(nn(cn(r,t)))}function pn(e,t,n){if(void 0===n&&(n=Be),!t)throw kt(1,t);var r=function(r){for(var a=[],l=1;l<arguments.length;l++)a[l-1]=arguments[l];return e(t,n,dn.apply(void 0,T([r],a,!1)))};return r.attrs=function(r){return pn(e,t,L(L({},n),{attrs:Array.prototype.concat(n.attrs,r).filter(Boolean)}))},r.withConfig=function(r){return pn(e,t,L(L({},n),r))},r}var hn=function(e){return pn(un,e)},mn=hn;Ue.forEach(function(e){mn[e]=hn(e);});var gn,yn,vn=Object.defineProperty,bn={exports:{}},wn={},kn=(yn||(yn=1,bn.exports=function(){if(gn)return wn;gn=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(t,n,r){var a=null;if(void 0!==r&&(a=""+r),void 0!==n.key&&(a=""+n.key),"key"in n)for(var l in r={},n)"key"!==l&&(r[l]=n[l]);else r=n;return n=r.ref,{$$typeof:e,type:t,key:a,ref:void 0!==n?n:null,props:r}}return wn.Fragment=t,wn.jsx=n,wn.jsxs=n,wn}()),bn.exports),Cn=class extends Error{constructor(e,t){var n;super(e),n=void 0,"code"in this?vn(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:n}):this.code=n,this.code=t,this.name="ErrorWithCode";}};async function xn(e,t={headers:{},method:"GET"}){const n=new AbortController,r=t.timeout??1e4,a=setTimeout(()=>n.abort(),r),l=await fetch(e,{headers:{Accept:"application/json",...t.headers},signal:n.signal,...t});if(clearTimeout(a),!l.ok)throw new Cn(`API error: ${l.status}`,l.status);const o=l.headers.get("content-type")??"",i=l.headers.get("content-length")??"0";return o.includes("application/json")&&"0"!==i?{data:await l.json(),status:l.status}:{status:l.status}}async function Sn(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map(e=>e.toString(16).padStart(2,"0")).join("").slice(0,10)}var En="https://streamboost.quanteec.com/api",_n={};function An(e=0){const[t,n]=(0, z.useState)([]);return {addValue:(0, z.useCallback)(t=>{n(n=>{const r=n.slice();return r.push(t),e>0&&r.length>e&&r.shift(),r});},[e]),average:(0, z.useMemo)(()=>t.length?t.reduce((e,t)=>e+t,0):0,[t]),values:t}}var Pn=["core","lite","plus","pro","elite","turbo"],jn={core:{dots:1,icon:function({color:e="#2f90b0",height:t=53,width:n=53,...r}){return kn.jsxs("svg",{fill:"none",height:t,viewBox:"0 0 53 53",width:n,xmlns:"http://www.w3.org/2000/svg",...r,children:[kn.jsx("circle",{cx:"26.3099",cy:"25.9842",fill:e,opacity:"0.2",r:"20.5081"}),kn.jsx("circle",{cx:"26.2992",cy:"25.9826",fill:e,r:"8.78919"})]})},label:"G-1"},elite:{dots:5,icon:function({color:e="#2f90b0",height:t=54,width:n=53,...r}){return kn.jsxs("svg",{fill:"none",height:t,viewBox:"0 0 29 29",width:n,xmlns:"http://www.w3.org/2000/svg",...r,children:[kn.jsx("circle",{cx:"13.9299",cy:"14.3088",fill:e,opacity:"0.2",r:"10.8889"}),kn.jsx("circle",{cx:"10.418",cy:"18.2246",fill:e,r:"2.30987",transform:"rotate(-45 10.418 18.2246)"}),kn.jsx("circle",{cx:"17.8511",cy:"18.2246",fill:e,r:"2.30987",transform:"rotate(-45 17.8511 18.2246)"}),kn.jsx("circle",{cx:"14.1662",cy:"14.5391",fill:e,r:"1.95677",transform:"rotate(-45 14.1662 14.5391)"}),kn.jsx("circle",{cx:"10.418",cy:"10.791",fill:e,r:"2.30987",transform:"rotate(-45 10.418 10.791)"}),kn.jsx("circle",{cx:"17.8511",cy:"10.791",fill:e,r:"2.30987",transform:"rotate(-45 17.8511 10.791)"})]})},label:"G-5"},inactive:{dots:0,icon:function({color:e="#2f90b0",height:t=53,width:n=53,...r}){return kn.jsxs("svg",{fill:"none",height:t,viewBox:"0 0 53 53",width:n,xmlns:"http://www.w3.org/2000/svg",...r,children:[kn.jsx("circle",{cx:"24.9049",cy:"25.0355",fill:e,opacity:"0.2",r:"19.8656"}),kn.jsx("path",{d:"M19.2197 19.3657L30.576 30.722M30.576 19.3657L19.2197 30.722",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"4"})]})},label:"Inactive"},lite:{dots:2,icon:function({color:e="#2f90b0",height:t=30,width:n=30,...r}){return kn.jsxs("svg",{fill:"none",height:t,viewBox:"0 0 26 26",width:n,xmlns:"http://www.w3.org/2000/svg",...r,children:[kn.jsx("circle",{cx:"13",cy:"13",fill:e,opacity:"0.2",r:"9.7625"}),kn.jsx("circle",{cx:"10.41",cy:"15.59",fill:e,r:"2.322"}),kn.jsx("circle",{cx:"15.59",cy:"10.41",fill:e,r:"2.322"})]})},label:"G-2"},plus:{dots:3,icon:function({color:e="#2f90b0",height:t=53,width:n=53,...r}){return kn.jsxs("svg",{fill:"none",height:t,viewBox:"0 0 53 53",width:n,xmlns:"http://www.w3.org/2000/svg",...r,children:[kn.jsx("circle",{cx:"26.0599",cy:"25.9837",fill:e,opacity:"0.2",r:"20.5081"}),kn.jsx("circle",{cx:"19.0212",cy:"30.374",fill:e,r:"4.68942"}),kn.jsx("circle",{cx:"26.0498",cy:"18.6513",fill:e,r:"4.68942"}),kn.jsx("circle",{cx:"33.0988",cy:"30.374",fill:e,r:"4.68942"})]})},label:"G-3"},pro:{dots:4,icon:function({color:e="#2f90b0",height:t=54,width:n=53,...r}){return kn.jsxs("svg",{fill:"none",height:t,viewBox:"0 0 53 54",width:n,xmlns:"http://www.w3.org/2000/svg",...r,children:[kn.jsx("circle",{cx:"26.0167",cy:"26.3314",fill:e,opacity:"0.2",r:"20.5081"}),kn.jsx("circle",{cx:"20.0367",cy:"32.4912",fill:e,r:"4.3504",transform:"rotate(-45 20.0367 32.4912)"}),kn.jsx("circle",{cx:"32.4185",cy:"32.4912",fill:e,r:"4.3504",transform:"rotate(-45 32.4185 32.4912)"}),kn.jsx("circle",{cx:"20.0367",cy:"20.1885",fill:e,r:"4.3504",transform:"rotate(-45 20.0367 20.1885)"}),kn.jsx("circle",{cx:"32.4185",cy:"20.1885",fill:e,r:"4.3504",transform:"rotate(-45 32.4185 20.1885)"})]})},label:"G-4"},turbo:{dots:6,icon:function({color:e="#2f90b0",height:t=53,width:n=53,...r}){return kn.jsxs("svg",{fill:"none",height:t,viewBox:"0 0 53 53",width:n,xmlns:"http://www.w3.org/2000/svg",...r,children:[kn.jsx("circle",{cx:"26.0599",cy:"26.347",fill:e,opacity:"0.2",r:"20.5081"}),kn.jsx("circle",{cx:"26.0391",cy:"36.0525",fill:e,r:"2.86696",stroke:e,strokeWidth:"0.878919"}),kn.jsx("circle",{cx:"26.0391",cy:"16.6502",fill:e,r:"2.86696",stroke:e,strokeWidth:"0.878919"}),kn.jsx("circle",{cx:"34.4557",cy:"31.1945",fill:e,r:"2.86696",stroke:e,strokeWidth:"0.878919",transform:"rotate(-60 34.4557 31.1945)"}),kn.jsx("circle",{cx:"17.6324",cy:"21.4962",fill:e,r:"2.86696",stroke:e,strokeWidth:"0.878919",transform:"rotate(-60 17.6324 21.4962)"}),kn.jsx("circle",{cx:"34.44",cy:"21.4887",fill:e,r:"2.86696",stroke:e,strokeWidth:"0.878919",transform:"rotate(-120 34.44 21.4887)"}),kn.jsx("circle",{cx:"17.6385",cy:"31.2025",fill:e,r:"2.86696",stroke:e,strokeWidth:"0.878919",transform:"rotate(-120 17.6385 31.2025)"})]})},label:"G-6"}},Nn={};function zn(e){if(Nn[e])return Nn[e];const t=document.createElement("div");t.style.color=e,document.body.appendChild(t);const n=getComputedStyle(t).color;document.body.removeChild(t);const r=n.match(/rgba?\((?<r>\d+), (?<g>\d+), (?<b>\d+)(?:, (?<a>[\d.]+))?\)/u);if(!r||!r.groups)return {a:0,b:0,g:0,r:0};const a={a:r.groups.a?parseFloat(r.groups.a):1,b:parseInt(r.groups.b,10),g:parseInt(r.groups.g,10),r:parseInt(r.groups.r,10)};return Nn[e]=a,a}function Ln(e){const[t,n,r]=[e.r,e.g,e.b].map(t=>(t=t/255*e.a)<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4));return .2126*t+.7152*n+.0722*r>.5?"black":"white"}var Tn=new Event("streamboost-close",{bubbles:!0}),In=new Event("streamboost-open",{bubbles:!0});function On({color:e="#2F90B0",height:t=42,width:n=36,...r}){return kn.jsxs("svg",{fill:"none",height:t,viewBox:"0 0 36 42",width:n,xmlns:"http://www.w3.org/2000/svg",...r,children:[kn.jsx("path",{d:"M16.0752 1.67676C17.4829 0.863978 19.2174 0.863977 20.6252 1.67676L33.7066 9.22931C35.1144 10.0421 35.9816 11.5442 35.9816 13.1698V28.2748C35.9816 29.9004 35.1144 31.4025 33.7066 32.2153L20.6252 39.7678C19.2174 40.5806 17.4829 40.5806 16.0752 39.7678L2.99377 32.2153C1.58598 31.4025 0.71875 29.9004 0.71875 28.2748V13.1698C0.71875 11.5442 1.58598 10.0421 2.99377 9.22931L16.0752 1.67676Z",fill:e,opacity:"0.2"}),kn.jsx("path",{clipRule:"evenodd",d:"M21.4927 10.4923C21.4946 10.4476 21.4955 10.4027 21.4955 10.3575C21.4955 8.60782 20.0771 7.18945 18.3275 7.18945C16.5779 7.18945 15.1595 8.60782 15.1595 10.3575C15.1595 10.4047 15.1605 10.4516 15.1626 10.4983L10.5592 13.0629C10.4789 13.006 10.3952 12.9523 10.3083 12.9021C8.79304 12.0273 6.85551 12.5464 5.98069 14.0617C5.10586 15.5769 5.62502 17.5144 7.14026 18.3893C7.325 18.4959 7.51601 18.5819 7.7106 18.6478L7.71053 23.2187C7.51425 23.2849 7.32159 23.3714 7.13532 23.4789C5.62008 24.3537 5.10092 26.2913 5.97574 27.8065C6.85057 29.3217 8.7881 29.8409 10.3033 28.9661C10.5053 28.8495 10.6896 28.714 10.8552 28.5631L15.203 30.9853C15.1744 31.1565 15.1595 31.3322 15.1595 31.5115C15.1595 33.2612 16.5779 34.6795 18.3275 34.6795C20.0771 34.6795 21.4955 33.2612 21.4955 31.5115C21.4955 31.3342 21.481 31.1603 21.453 30.9909L25.8079 28.5647C25.9733 28.7152 26.1572 28.8504 26.3588 28.9668C27.874 29.8416 29.8116 29.3224 30.6864 27.8072C31.5612 26.292 31.0421 24.3544 29.5268 23.4796C29.3451 23.3747 29.1573 23.2898 28.966 23.2243L28.9661 18.6467C29.1593 18.5809 29.3489 18.4954 29.5323 18.3895C31.0476 17.5147 31.5667 15.5772 30.6919 14.0619C29.8171 12.5467 27.8795 12.0275 26.3643 12.9024C26.2764 12.9531 26.1918 13.0075 26.1107 13.0651L21.4927 10.4923ZM11.8382 26.779L16.1696 29.1921C16.4949 28.8893 16.884 28.6541 17.3145 28.5089V23.9369C16.8997 23.7971 16.5234 23.5736 16.2055 23.2867L11.8473 25.715C11.9049 26.0707 11.9005 26.4305 11.8382 26.779ZM10.8918 23.9156L15.2114 21.5088C15.1773 21.3225 15.1595 21.1305 15.1595 20.9343C15.1595 20.8318 15.1644 20.7304 15.1739 20.6303L10.6894 18.1317C10.4046 18.3566 10.0854 18.5288 9.74754 18.6439L9.74747 23.2259C10.1682 23.37 10.5598 23.6027 10.8918 23.9156ZM26.9291 18.6456C26.5054 18.5018 26.1109 18.2684 25.7768 17.9538L21.4449 20.3674C21.4782 20.5513 21.4955 20.7408 21.4955 20.9343C21.4955 21.0341 21.4909 21.1328 21.4819 21.2303L25.9792 23.7361C26.2662 23.5096 26.5883 23.3367 26.9291 23.2217L26.9291 18.6456ZM24.8206 16.1548C24.7426 15.675 24.7776 15.1877 24.9153 14.7308L20.7436 12.4067C20.3775 12.8378 19.8982 13.1697 19.3515 13.3564V17.9354C19.7644 18.0764 20.1389 18.3002 20.4552 18.5871L24.8206 16.1548ZM11.8841 15.8826L16.416 18.4077C16.6852 18.2038 16.9879 18.0419 17.3145 17.9317V13.3601C16.765 13.1748 16.283 12.8429 15.915 12.4109L11.7564 14.7276C11.8688 15.0993 11.9132 15.4911 11.8841 15.8826ZM24.8242 26.781C24.7773 26.5197 24.7631 26.252 24.7831 25.9844L20.2454 23.4561C19.9776 23.66 19.6764 23.8223 19.3515 23.9332V28.5126C19.7794 28.6587 20.1662 28.8938 20.4896 29.1959L24.8242 26.781Z",fill:e,fillRule:"evenodd"})]})}var $n={},Dn={},Mn=["Y","Z","E","P","T","G","M","k","","m","","n","p","f","a","z","y"];function Rn(e,t="",n=1){let r=Mn.indexOf(t);for(-1===r&&(r=8);e>=1e3&&r>0;)e/=1e3,r--;for(;e>0&&e<1&&r<Mn.length-1;)e*=1e3,r++;return {unit:Mn[r],value:new Intl.NumberFormat("en-US",{maximumFractionDigits:n}).format(e)}}function Fn({height:e=21,style:t,width:n=21}){return kn.jsx("svg",{fill:"none",height:e,style:t,viewBox:"0 0 21 21",width:n,children:kn.jsx("path",{d:"M18.4317 3.9332C18.4227 3.77908 18.3574 3.63363 18.2482 3.52446C18.1391 3.41529 17.9936 3.35001 17.8395 3.34101C11.8443 2.989 7.04223 4.79393 4.99476 8.18013C4.28504 9.33846 3.93531 10.6815 3.98992 12.0388C4.02556 12.9068 4.20217 13.7632 4.51281 14.5745C4.53107 14.6245 4.56166 14.669 4.60174 14.7039C4.64182 14.7388 4.69009 14.763 4.74205 14.7743C4.79401 14.7855 4.84797 14.7834 4.8989 14.7682C4.94983 14.7529 4.99608 14.7251 5.03334 14.6872L11.727 7.89112C11.7855 7.83259 11.855 7.78616 11.9315 7.75448C12.008 7.7228 12.0899 7.7065 12.1727 7.7065C12.2555 7.7065 12.3375 7.7228 12.4139 7.75448C12.4904 7.78616 12.5599 7.83259 12.6184 7.89112C12.677 7.94965 12.7234 8.01914 12.7551 8.09562C12.7868 8.1721 12.8031 8.25406 12.8031 8.33684C12.8031 8.41962 12.7868 8.50159 12.7551 8.57806C12.7234 8.65454 12.677 8.72403 12.6184 8.78256L5.30345 16.2078L4.186 17.3252C4.06979 17.4384 4.00041 17.5911 3.99166 17.7531C3.9829 17.915 4.03541 18.0743 4.13876 18.1994C4.19535 18.2649 4.26485 18.3181 4.34291 18.3555C4.42097 18.393 4.50592 18.414 4.59245 18.4172C4.67899 18.4203 4.76525 18.4057 4.84585 18.374C4.92645 18.3424 4.99966 18.2944 5.0609 18.2332L6.3831 16.911C7.49661 17.4497 8.62035 17.7434 9.73465 17.7828C9.82232 17.7859 9.90973 17.7875 9.99688 17.7875C11.2658 17.7907 12.5107 17.4412 13.5926 16.7779C16.9788 14.7305 18.7845 9.92914 18.4317 3.9332Z",fill:"#7BC234"})})}var Bn=mn.div.withConfig({displayName:"styles__TooltipArrow",componentId:"sc-ucoa5y-0"})(["background-color:",";"," top:","px;height:12px;position:absolute;transform:rotate(45deg);width:12px;"],({$color:e})=>e,({$position:e})=>"left"===e?"right: -6px;":"left: -6px;",14),Un=mn.div.withConfig({displayName:"styles__TooltipBox",componentId:"sc-ucoa5y-1"})(["",";background:",";border-radius:8px;box-shadow:0 8px 10px rgba(0,0,0,0.25);color:",";display:inline-block;font-size:21.5px;font-weight:700;font-family:'Inter',sans-serif;height:","px;line-height:","px;margin-left:10px;padding-left:10px;padding-right:10px;transform:translateY(-50%) ",";white-space:nowrap;"],({$show:e})=>e?"\n        transition: opacity 0.1s ease;\n        opacity: 1;\n        visibility: visible;\n      ":"\n        transition: all 0.1s ease 0.2s;\n        opacity: 0;\n        visibility: hidden;\n      ",({$color:e,$position:t})=>`linear-gradient(\n      to ${t},\n      rgba(255, 255, 255, 0),\n      rgba(255, 255, 255, 0.15)\n    ),\n     ${e}`,({$textColor:e})=>e,40,40,({$position:e})=>"left"===e?"translateX(-100%)":""),Hn=mn.div.withConfig({displayName:"styles__TooltipContainer",componentId:"sc-ucoa5y-2"})(["position:relative;height:0;width:0;z-index:10001;"]);function Vn({children:e,color:t,disabled:n=!1,position:r="left",text:a}){const[l,o]=(0, z.useState)(!1),i=(0, z.useRef)(null),s=(0, z.useMemo)(()=>Ln(zn(t)),[t]);return kn.jsxs(kn.Fragment,{children:[!n&&"left"===r&&kn.jsx(Hn,{children:kn.jsxs(Un,{$color:t,$position:r,$show:l,$textColor:s,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),onMouseOver:()=>o(!0),children:[kn.jsx(Bn,{$color:t,$position:r}),a]})}),kn.jsx("div",{onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),ref:i,children:e}),!n&&"right"===r&&kn.jsx(Hn,{children:kn.jsxs(Un,{$color:t,$position:r,$show:l,$textColor:s,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:[kn.jsx(Bn,{$color:t,$position:r}),a]})})]})}var qn=mn.div.withConfig({displayName:"styles__Card",componentId:"sc-163btb0-0"})(["background-color:rgba(255,255,255,0.05);border:2px solid rgba(255,255,255,0.2);border-radius:33.57px;padding:28.7px;color:white;display:flex;width:182px;flex:auto;height:120px;justify-content:space-around;align-items:center;"]),Wn=mn.div.withConfig({displayName:"styles__DashboardWrapper",componentId:"sc-163btb0-1"})(["padding-top:1px;padding-bottom:1px;display:flex;flex-wrap:wrap;gap:11px;justify-content:center;height:400px;align-content:baseline;overflow-x:hidden;overflow-y:scroll;overscroll-behavior:contain;scrollbar-width:none;width:100%;"," mask-repeat:no-repeat;mask-size:100% 100%;"],({$fadeBottom:e,$fadeTop:t})=>{const n="15px";return e&&t?`mask-image: linear-gradient(to bottom, transparent, black ${n}, black calc(100% - ${n}), transparent);`:e?`mask-image: linear-gradient(to bottom, black calc(100% - ${n}), transparent);`:t?`mask-image: linear-gradient(to bottom, transparent, black ${n});`:void 0}),Qn=mn.div.withConfig({displayName:"styles__Dot",componentId:"sc-163btb0-2"})(["width:16.14px;height:16.14px;border-radius:50%;background-color:",";transition:background-color 0.3s ease;"],({$active:e,$color:t})=>e?t:"rgba(255, 255, 255, 0.1)"),Gn=mn.div.withConfig({displayName:"styles__DotColumn",componentId:"sc-163btb0-3"})(["display:flex;flex-direction:column-reverse;gap:4px;justify-content:center;"]),Yn=mn.div.withConfig({displayName:"styles__ImageContainer",componentId:"sc-163btb0-4"})(["display:flex;align-items:center;margin-right:4.8px;"]),Zn=mn.div.withConfig({displayName:"styles__InfoContainer",componentId:"sc-163btb0-5"})(["display:flex;flex-direction:column;margin-bottom:28px;"]),Kn=mn.div.withConfig({displayName:"styles__Label",componentId:"sc-163btb0-6"})(["display:flex;align-items:center;font-size:21.5px;font-weight:500;font-family:'Inter',sans-serif;text-align:left;"]),Xn=mn.div.withConfig({displayName:"styles__LeftContainer",componentId:"sc-163btb0-7"})(["width:100%;height:100%;display:flex;flex-direction:column;justify-content:space-between;"]),Jn=mn.div.withConfig({displayName:"styles__LeftContainerSpeed",componentId:"sc-163btb0-8"})(["display:flex;flex-direction:column;justify-content:space-between;height:100%;"]),er=mn.div.withConfig({displayName:"styles__LiteSwitchContainer",componentId:"sc-163btb0-9"})(["display:flex;align-items:center;gap:3.94px;"]),tr=mn.div.withConfig({displayName:"styles__PlusIcon",componentId:"sc-163btb0-10"})(["position:absolute;top:-5px;right:0;left:0;text-align:center;font-size:35px;font-weight:700;color:white;z-index:1;"]),nr=mn.div.withConfig({displayName:"styles__ProgressBar",componentId:"sc-163btb0-11"})(["height:120px;width:31.7px;border-radius:20px;background-color:#252525;overflow:hidden;display:flex;flex:none;align-items:flex-end;margin-left:28.7px;position:relative;"]),rr=mn.div.withConfig({displayName:"styles__ProgressFill",componentId:"sc-163btb0-12"})(["width:100%;height:",";background-color:",";transition:height 0.3s ease-in-out;"],({$fillPercent:e})=>`${e}%`,({$fillColor:e})=>e),ar=mn.div.withConfig({displayName:"styles__RadioIcon",componentId:"sc-163btb0-13"})(["display:flex;margin-right:2px;"]),lr=mn.span.withConfig({displayName:"styles__Slash",componentId:"sc-163btb0-14"})(["color:",";"],({$color:e})=>e),or=mn.p.withConfig({displayName:"styles__StepCounter",componentId:"sc-163btb0-15"})(["font-size:37.3px;font-weight:700;font-family:'Inter',sans-serif;text-align:left;color:white;margin:0;font-family:'Inter',sans-serif;"]),ir=mn.p.withConfig({displayName:"styles__Subtitle",componentId:"sc-163btb0-16"})(["font-size:19.18px;font-weight:500;font-family:'Inter',sans-serif;text-align:left;opacity:50%;margin:0;"]),sr=mn.div.withConfig({displayName:"styles__SwitchDot",componentId:"sc-163btb0-17"})(["width:15.88px;height:15.88px;border-radius:50%;background:white;box-shadow:0 0 32px 0.5px black;top:2px;left:2px;transition:0.3s ease;transform:",";"],({$active:e})=>e?"translateX(21px)":"translateX(3px)"),ur=mn.div.withConfig({displayName:"styles__SwitchWrapper",componentId:"sc-163btb0-18"})(["width:40.84px;height:22.69px;border-radius:999px;padding:2px;display:flex;align-items:center;cursor:",";background-color:",";"],({$enabled:e})=>e?"pointer":"not-allowed",({$active:e,$color:t,$enabled:n})=>e&&n?t:"#555"),cr=mn.div.withConfig({displayName:"styles__TopLeftContainer",componentId:"sc-163btb0-19"})(["display:flex;flex-direction:column;"]),fr=mn.div.withConfig({displayName:"styles__Value",componentId:"sc-163btb0-20"})(["font-size:37.3px;font-weight:700;font-family:'Inter',sans-serif;text-align:left;"]),dr=({co2Saved:e,color:t,savedPercent:n=0})=>{const r=Rn(e||0);return kn.jsxs(qn,{children:[kn.jsxs(Xn,{children:[kn.jsxs(Zn,{children:[kn.jsx(fr,{children:typeof e>"u"?"-":r.value}),kn.jsx(ir,{children:r.unit+"g saved"})]}),kn.jsxs(Kn,{children:[kn.jsx(Yn,{children:kn.jsx(Fn,{height:22,width:22})}),"CO2"]})]}),kn.jsx(Vn,{color:t,text:`${n}% saved`,children:kn.jsx(nr,{children:kn.jsx(rr,{$fillColor:"#7BC234",$fillPercent:n})})})]})};function pr({height:e=16,style:t,width:n=24}){return kn.jsx("svg",{fill:"none",height:e,style:t,viewBox:"0 0 24 16",width:n,children:kn.jsx("path",{d:"M14.9171 14.3725C14.9889 14.4827 15.0297 14.6102 15.0351 14.7417C15.0404 14.8731 15.0102 15.0036 14.9475 15.1193C14.8849 15.2349 14.7921 15.3315 14.6791 15.3989C14.5661 15.4662 14.437 15.5017 14.3054 15.5018H0.835972C0.704414 15.5017 0.575303 15.4662 0.46228 15.3989C0.349257 15.3315 0.256519 15.2349 0.193863 15.1193C0.131207 15.0036 0.100961 14.8731 0.106319 14.7417C0.111678 14.6102 0.152442 14.4827 0.224305 14.3725C1.25237 12.79 2.76454 11.5824 4.53519 10.9298C3.55633 10.2781 2.81318 9.32875 2.41562 8.22207C2.01806 7.11538 1.9872 5.91013 2.32761 4.78455C2.66801 3.65896 3.36161 2.67281 4.30583 1.97191C5.25005 1.27101 6.39476 0.892578 7.5707 0.892578C8.74663 0.892578 9.89134 1.27101 10.8356 1.97191C11.7798 2.67281 12.4734 3.65896 12.8138 4.78455C13.1542 5.91013 13.1233 7.11538 12.7258 8.22207C12.3282 9.32875 11.5851 10.2781 10.6062 10.9298C12.3769 11.5824 13.889 12.79 14.9171 14.3725ZM22.9427 14.3588C21.9144 12.783 20.4056 11.5806 18.64 10.9298C19.7956 10.1514 20.6111 8.96186 20.9206 7.60336C21.2301 6.24486 21.0102 4.81949 20.3058 3.61738C19.6014 2.41527 18.4653 1.52677 17.1289 1.13274C15.7925 0.738707 14.3561 0.86876 13.1122 1.49643C13.0646 1.52098 13.0231 1.5557 12.9904 1.59812C12.9577 1.64053 12.9348 1.68961 12.9232 1.74187C12.9116 1.79413 12.9117 1.84831 12.9234 1.90055C12.935 1.95279 12.9581 2.00183 12.9908 2.04419C13.9157 3.19796 14.447 4.6176 14.5066 6.09517C14.5662 7.57273 14.1512 9.03056 13.3222 10.2551C13.2686 10.3352 13.2488 10.4331 13.2671 10.5277C13.2854 10.6222 13.3403 10.7057 13.4199 10.76C14.5007 11.5143 15.4259 12.4699 16.145 13.5746C16.435 14.0187 16.5534 14.5531 16.4782 15.0782C16.4697 15.1304 16.4727 15.1838 16.487 15.2348C16.5012 15.2858 16.5263 15.333 16.5606 15.3733C16.5949 15.4136 16.6376 15.4459 16.6856 15.4681C16.7336 15.4903 16.7859 15.5018 16.8388 15.5018H22.3438C22.5046 15.5018 22.661 15.4488 22.7886 15.3509C22.9162 15.253 23.0079 15.1157 23.0495 14.9604C23.0749 14.8582 23.0785 14.7519 23.0601 14.6482C23.0417 14.5446 23.0017 14.4459 22.9427 14.3588Z",fill:"#BD60CB"})})}var hr=({connected:e})=>kn.jsx(qn,{children:kn.jsxs(Xn,{children:[kn.jsxs(Zn,{children:[kn.jsx(fr,{children:e??"-"}),kn.jsx(ir,{children:"Connected"})]}),kn.jsxs(Kn,{children:[kn.jsx(Yn,{children:kn.jsx(pr,{height:18,width:27})}),"Contributors"]})]})});function mr({height:e=23,style:t,width:n=17}){return kn.jsx("svg",{fill:"none",height:e,style:t,viewBox:"0 0 17 23",width:n,children:kn.jsx("path",{d:"M16.536 10.9069L6.28665 21.8884C6.17803 22.0043 6.03466 22.0817 5.87818 22.109C5.72169 22.1363 5.56057 22.1119 5.41914 22.0396C5.27771 21.9673 5.16363 21.8509 5.09413 21.7081C5.02463 21.5653 5.00347 21.4037 5.03385 21.2478L6.37541 14.5372L1.10158 12.5569C0.98832 12.5145 0.887316 12.4448 0.807594 12.3538C0.727872 12.2629 0.671916 12.1537 0.644725 12.0358C0.617533 11.918 0.619953 11.7953 0.651768 11.6786C0.683583 11.5619 0.743803 11.455 0.827047 11.3672L11.0764 0.385815C11.185 0.269902 11.3284 0.192461 11.4848 0.165177C11.6413 0.137894 11.8025 0.162248 11.9439 0.234566C12.0853 0.306883 12.1994 0.42324 12.2689 0.566077C12.3384 0.708914 12.3596 0.870481 12.3292 1.0264L10.984 7.74429L16.2578 9.72186C16.3702 9.76451 16.4704 9.8342 16.5495 9.92476C16.6286 10.0153 16.6842 10.124 16.7113 10.2411C16.7385 10.3583 16.7363 10.4803 16.7051 10.5964C16.6739 10.7125 16.6145 10.8192 16.5323 10.9069H16.536Z",fill:"#E7A62E"})})}var gr=({energySaved:e})=>kn.jsxs(qn,{children:[kn.jsxs(Xn,{children:[kn.jsxs(Zn,{children:[kn.jsx(fr,{children:typeof e>"u"?"-":`${Math.floor(e)}%`}),kn.jsx(ir,{children:"Saved"})]}),kn.jsxs(Kn,{children:[kn.jsx(Yn,{children:kn.jsx(mr,{height:22,width:22})}),"Energy"]})]}),kn.jsx(nr,{children:kn.jsx(rr,{$fillColor:"#F5A524",$fillPercent:e??0})})]});function yr({height:e=21,style:t,width:n=21}){return kn.jsx("svg",{fill:"none",height:e,style:t,viewBox:"0 0 21 21",width:n,children:kn.jsx("path",{d:"M14.0415 19.0491C14.0415 19.2162 13.9751 19.3764 13.857 19.4946C13.7388 19.6127 13.5786 19.6791 13.4115 19.6791H7.11159C6.94451 19.6791 6.78427 19.6127 6.66612 19.4946C6.54798 19.3764 6.4816 19.2162 6.4816 19.0491C6.4816 18.882 6.54798 18.7218 6.66612 18.6036C6.78427 18.4855 6.94451 18.4191 7.11159 18.4191H13.4115C13.5786 18.4191 13.7388 18.4855 13.857 18.6036C13.9751 18.7218 14.0415 18.882 14.0415 19.0491ZM17.1914 8.96927C17.1942 10.0195 16.9569 11.0565 16.4978 12.001C16.0387 12.9456 15.3699 13.7728 14.5423 14.4195C14.3876 14.5381 14.262 14.6905 14.1752 14.8651C14.0884 15.0396 14.0427 15.2317 14.0415 15.4267V15.8992C14.0415 16.2333 13.9087 16.5538 13.6725 16.7901C13.4362 17.0264 13.1157 17.1591 12.7815 17.1591H7.74158C7.40741 17.1591 7.08693 17.0264 6.85064 16.7901C6.61435 16.5538 6.4816 16.2333 6.4816 15.8992V15.4267C6.48147 15.234 6.43718 15.044 6.35213 14.8712C6.26708 14.6984 6.14354 14.5473 5.991 14.4297C5.16555 13.7868 4.49717 12.9646 4.03643 12.0253C3.5757 11.0859 3.33469 10.0541 3.33165 9.00785C3.31117 5.25468 6.34458 2.12914 10.0946 2.03936C11.0186 2.0171 11.9377 2.17989 12.7979 2.51817C13.658 2.85645 14.4418 3.36337 15.1031 4.0091C15.7643 4.65483 16.2898 5.42633 16.6484 6.27817C17.0071 7.13001 17.1917 8.045 17.1914 8.96927ZM13.2272 9.15354C13.1687 9.09496 13.0992 9.0485 13.0228 9.01679C12.9463 8.98509 12.8643 8.96877 12.7815 8.96877C12.6987 8.96877 12.6167 8.98509 12.5403 9.01679C12.4638 9.0485 12.3943 9.09496 12.3358 9.15354L10.2615 11.2286L8.1873 9.15354C8.06909 9.03533 7.90876 8.96891 7.74158 8.96891C7.57441 8.96891 7.41408 9.03533 7.29586 9.15354C7.17765 9.27175 7.11124 9.43208 7.11124 9.59926C7.11124 9.76643 7.17765 9.92676 7.29586 10.045L9.63156 12.3799V15.2692C9.63156 15.4363 9.69793 15.5965 9.81608 15.7146C9.93422 15.8328 10.0945 15.8992 10.2615 15.8992C10.4286 15.8992 10.5889 15.8328 10.707 15.7146C10.8252 15.5965 10.8915 15.4363 10.8915 15.2692V12.3799L13.2272 10.045C13.2858 9.98647 13.3323 9.91699 13.364 9.84051C13.3957 9.76403 13.412 9.68205 13.412 9.59926C13.412 9.51647 13.3957 9.43449 13.364 9.35801C13.3323 9.28153 13.2858 9.21205 13.2272 9.15354Z",fill:"#E85723"})})}var vr=({color:e,kWhSaved:t,savedPercent:n=0})=>{const r=Rn(t||0,"k");return kn.jsxs(qn,{children:[kn.jsxs(Xn,{children:[kn.jsxs(Zn,{children:[kn.jsx(fr,{children:typeof t>"u"?"-":r.value}),kn.jsx(ir,{children:r.unit+"Wh saved"})]}),kn.jsxs(Kn,{children:[kn.jsx(Yn,{children:kn.jsx(yr,{height:22,width:22})}),"Power"]})]}),kn.jsx(Vn,{color:e,text:`${n}% saved`,children:kn.jsx(nr,{children:kn.jsx(rr,{$fillColor:"#E85723",$fillPercent:n})})})]})};function br({height:e=21,style:t,width:n=21}){return kn.jsxs("svg",{fill:"none",height:e,style:t,viewBox:"0 0 21 21",width:n,children:[kn.jsx("g",{clipPath:"url(#clip0_2266_32397)",children:kn.jsx("path",{d:"M18.465 5.11389H16.5752V3.85404C16.5752 3.68698 16.5089 3.52675 16.3907 3.40862C16.2726 3.29049 16.1124 3.22412 15.9453 3.22412H4.60669C4.43962 3.22412 4.2794 3.29049 4.16126 3.40862C4.04313 3.52675 3.97676 3.68698 3.97676 3.85404V5.11389H2.08699C1.75286 5.11389 1.43242 5.24662 1.19615 5.48289C0.959882 5.71916 0.827148 6.0396 0.827148 6.37374V7.63358C0.827148 8.46891 1.15898 9.27003 1.74965 9.8607C2.04212 10.1532 2.38933 10.3852 2.77146 10.5434C3.15359 10.7017 3.56315 10.7832 3.97676 10.7832H4.26417C4.63523 11.9591 5.34273 13.0005 6.29921 13.7787C7.2557 14.5569 8.41926 15.0378 9.64607 15.162V17.0824H7.7563C7.58924 17.0824 7.42901 17.1488 7.31088 17.2669C7.19275 17.3851 7.12638 17.5453 7.12638 17.7124C7.12638 17.8794 7.19275 18.0396 7.31088 18.1578C7.42901 18.2759 7.58924 18.3423 7.7563 18.3423H12.7957C12.9628 18.3423 13.123 18.2759 13.2411 18.1578C13.3592 18.0396 13.4256 17.8794 13.4256 17.7124C13.4256 17.5453 13.3592 17.3851 13.2411 17.2669C13.123 17.1488 12.9628 17.0824 12.7957 17.0824H10.9059V15.1596C13.4209 14.9053 15.5075 13.1407 16.2666 10.7832H16.5752C17.4106 10.7832 18.2117 10.4514 18.8023 9.8607C19.393 9.27003 19.7248 8.46891 19.7248 7.63358V6.37374C19.7248 6.0396 19.5921 5.71916 19.3558 5.48289C19.1196 5.24662 18.7991 5.11389 18.465 5.11389ZM3.97676 9.52335C3.47557 9.52335 2.9949 9.32425 2.6405 8.96985C2.2861 8.61545 2.08699 8.13478 2.08699 7.63358V6.37374H3.97676V8.89343C3.97676 9.1034 3.987 9.31338 4.00747 9.52335H3.97676ZM18.465 7.63358C18.465 8.13478 18.2659 8.61545 17.9115 8.96985C17.5571 9.32425 17.0764 9.52335 16.5752 9.52335H16.5359C16.5617 9.29064 16.5749 9.0567 16.5752 8.82256V6.37374H18.465V7.63358Z",fill:"#C5955F"})}),kn.jsx("defs",{children:kn.jsx("clipPath",{id:"clip0_2266_32397",children:kn.jsx("rect",{fill:"white",height:"20.1575",transform:"translate(0.191406 0.0654297)",width:"20.1575"})})})]})}var wr=({color:e,rankingNumber:t,rankingPercent:n})=>{const r=Math.floor((100-(n??0)+10)/10);return kn.jsxs(qn,{children:[kn.jsxs(Xn,{children:[kn.jsxs(Zn,{children:[kn.jsx(fr,{children:t??"-"}),kn.jsx(ir,{children:1===t?"Leader":"Pursuer"})]}),kn.jsxs(Kn,{children:[kn.jsx(Yn,{children:kn.jsx(br,{height:22,width:22})}),"Ranking"]})]}),kn.jsx(Vn,{color:e,disabled:!n,text:`In the top ${r}0%`,children:kn.jsx(nr,{children:kn.jsx(rr,{$fillColor:"#C5955F",$fillPercent:n??0})})})]})};function kr({height:e=17,style:t,width:n=17}){return kn.jsx("svg",{fill:"none",height:e,style:t,viewBox:"0 0 17 17",width:n,children:kn.jsx("path",{d:"M7.89821 3.81385C7.89821 4.5361 7.68404 5.24213 7.28278 5.84265C6.88152 6.44318 6.3112 6.91123 5.64393 7.18762C4.97666 7.46401 4.24242 7.53633 3.53405 7.39543C2.82568 7.25452 2.175 6.90673 1.6643 6.39602C1.15359 5.88532 0.805799 5.23464 0.664895 4.52627C0.523992 3.8179 0.596309 3.08366 0.8727 2.41639C1.14909 1.74912 1.61714 1.1788 2.21767 0.77754C2.8182 0.376282 3.52422 0.162111 4.24647 0.162111C5.21497 0.162111 6.14381 0.546847 6.82864 1.23168C7.51347 1.91652 7.89821 2.84535 7.89821 3.81385ZM13.0106 7.46559C13.7329 7.46559 14.4389 7.25142 15.0394 6.85016C15.64 6.4489 16.108 5.87858 16.3844 5.21131C16.6608 4.54404 16.7331 3.8098 16.5922 3.10143C16.4513 2.39306 16.1035 1.74239 15.5928 1.23168C15.0821 0.720976 14.4314 0.373181 13.7231 0.232278C13.0147 0.091375 12.2805 0.163692 11.6132 0.440083C10.9459 0.716475 10.3756 1.18453 9.97434 1.78505C9.57308 2.38558 9.35891 3.09161 9.35891 3.81385C9.35891 4.78235 9.74364 5.71119 10.4285 6.39602C11.1133 7.08086 12.0421 7.46559 13.0106 7.46559ZM4.24647 8.92629C3.52422 8.92629 2.8182 9.14046 2.21767 9.54172C1.61714 9.94298 1.14909 10.5133 0.8727 11.1806C0.596309 11.8478 0.523992 12.5821 0.664895 13.2905C0.805799 13.9988 1.15359 14.6495 1.6643 15.1602C2.175 15.6709 2.82568 16.0187 3.53405 16.1596C4.24242 16.3005 4.97666 16.2282 5.64393 15.9518C6.3112 15.6754 6.88152 15.2074 7.28278 14.6068C7.68404 14.0063 7.89821 13.3003 7.89821 12.578C7.89821 11.6095 7.51347 10.6807 6.82864 9.99586C6.14381 9.31103 5.21497 8.92629 4.24647 8.92629ZM13.0106 8.92629C12.2884 8.92629 11.5824 9.14046 10.9818 9.54172C10.3813 9.94298 9.91327 10.5133 9.63688 11.1806C9.36049 11.8478 9.28817 12.5821 9.42907 13.2905C9.56998 13.9988 9.91777 14.6495 10.4285 15.1602C10.9392 15.6709 11.5899 16.0187 12.2982 16.1596C13.0066 16.3005 13.7408 16.2282 14.4081 15.9518C15.0754 15.6754 15.6457 15.2074 16.047 14.6068C16.4482 14.0063 16.6624 13.3003 16.6624 12.578C16.6624 11.6095 16.2777 10.6807 15.5928 9.99586C14.908 9.31103 13.9791 8.92629 13.0106 8.92629Z",fill:"#88C544"})})}var Cr=({color:e,sharedData:t,sharedPercent:n=0,superStream:r})=>{const a=Rn(t||0,"M");return kn.jsxs(qn,{children:[kn.jsxs(Xn,{children:[kn.jsxs(Zn,{children:[kn.jsx(fr,{children:typeof t>"u"?"-":a.value}),kn.jsx(ir,{children:a.unit+"B shared"})]}),kn.jsxs(Kn,{children:[kn.jsx(Yn,{children:kn.jsx(kr,{height:18,width:18})}),"Data"]})]}),kn.jsx(Vn,{color:e,text:`${n}% saved`,children:kn.jsxs(nr,{children:[r&&kn.jsx(tr,{children:"+"}),kn.jsx(rr,{$fillColor:"#88C544",$fillPercent:n??0})]})})]})};function xr({color:e="white",height:t="32",width:n="32"}){return kn.jsxs("svg",{fill:"none",height:t,viewBox:"0 0 17 17",width:n,children:[kn.jsx("g",{clipPath:"url(#clip0_1_353)",children:kn.jsx("path",{d:"M11.2207 8.75749C11.2207 9.2448 11.0762 9.72116 10.8055 10.1263C10.5348 10.5315 10.15 10.8473 9.69976 11.0338C9.24955 11.2203 8.75415 11.2691 8.27621 11.174C7.79827 11.0789 7.35925 10.8443 7.01468 10.4997C6.6701 10.1551 6.43544 9.71611 6.34037 9.23817C6.2453 8.76023 6.2941 8.26483 6.48058 7.81462C6.66706 7.36441 6.98286 6.97961 7.38804 6.70888C7.79322 6.43815 8.26958 6.29364 8.75688 6.29364C9.41033 6.29364 10.037 6.55323 10.4991 7.01529C10.9611 7.47735 11.2207 8.10404 11.2207 8.75749ZM13.6846 8.75749C13.6861 7.5452 13.2392 6.37518 12.4299 5.47257C12.387 5.42317 12.3348 5.38279 12.2762 5.35378C12.2177 5.32476 12.1539 5.30769 12.0887 5.30356C12.0234 5.29943 11.958 5.30832 11.8962 5.32972C11.8345 5.35111 11.7776 5.38459 11.7289 5.42819C11.6802 5.47179 11.6406 5.52464 11.6125 5.58367C11.5845 5.6427 11.5684 5.70673 11.5653 5.77203C11.5622 5.83733 11.5721 5.90259 11.5945 5.96401C11.6169 6.02543 11.6513 6.08179 11.6956 6.1298C12.342 6.85254 12.6994 7.78817 12.6994 8.7578C12.6994 9.72744 12.342 10.6631 11.6956 11.3858C11.6109 11.4835 11.568 11.6106 11.5762 11.7397C11.5844 11.8688 11.643 11.9895 11.7393 12.0757C11.8357 12.162 11.9621 12.2069 12.0913 12.2008C12.2205 12.1947 12.3421 12.138 12.4299 12.043C13.2391 11.1401 13.6859 9.96995 13.6846 8.75749ZM5.81812 6.1298C5.86249 6.08179 5.89687 6.02543 5.91924 5.96401C5.94162 5.90259 5.95155 5.83733 5.94845 5.77203C5.94536 5.70673 5.92931 5.6427 5.90123 5.58367C5.87315 5.52464 5.8336 5.47179 5.78489 5.42819C5.73619 5.38459 5.67929 5.35111 5.61752 5.32972C5.55575 5.30832 5.49034 5.29943 5.4251 5.30356C5.35986 5.30769 5.29609 5.32476 5.23751 5.35378C5.17894 5.38279 5.12672 5.42317 5.0839 5.47257C4.27501 6.37566 3.82773 7.54542 3.82773 8.7578C3.82773 9.97018 4.27501 11.1399 5.0839 12.043C5.17168 12.138 5.29328 12.1947 5.42247 12.2008C5.55166 12.2069 5.67808 12.162 5.77444 12.0757C5.87081 11.9895 5.9294 11.8688 5.93757 11.7397C5.94574 11.6106 5.90284 11.4835 5.81812 11.3858C5.17109 10.6634 4.81332 9.72763 4.81332 8.7578C4.81332 7.78798 5.17109 6.85224 5.81812 6.1298ZM15.5676 5.88341C15.2069 5.02694 14.6874 4.24652 14.0363 3.58341C13.9914 3.53543 13.9374 3.49691 13.8774 3.47011C13.8174 3.44331 13.7527 3.42878 13.687 3.42736C13.6214 3.42594 13.5561 3.43767 13.495 3.46186C13.4339 3.48605 13.3783 3.5222 13.3314 3.5682C13.2845 3.6142 13.2472 3.66911 13.2219 3.72971C13.1965 3.79031 13.1835 3.85537 13.1836 3.92106C13.1838 3.98675 13.1971 4.05176 13.2227 4.11224C13.2483 4.17273 13.2858 4.22749 13.3329 4.27329C14.5073 5.46988 15.1653 7.07959 15.1653 8.75626C15.1653 10.4329 14.5073 12.0426 13.3329 13.2392C13.2874 13.2854 13.2515 13.3401 13.2272 13.4002C13.2028 13.4603 13.1906 13.5245 13.1911 13.5893C13.1916 13.6541 13.2049 13.7182 13.2302 13.7779C13.2554 13.8376 13.2922 13.8917 13.3384 13.9371C13.3846 13.9826 13.4393 14.0185 13.4994 14.0428C13.5594 14.0671 13.6237 14.0794 13.6885 14.0789C13.7533 14.0784 13.8174 14.0651 13.877 14.0398C13.9367 14.0145 13.9908 13.9778 14.0363 13.9316C15.0565 12.8898 15.7461 11.5698 16.0185 10.1373C16.2909 8.7049 16.1341 7.2239 15.5676 5.88033V5.88341ZM2.85411 11.2509C2.36174 10.087 2.22499 8.80334 2.46111 7.56181C2.69722 6.32028 3.29563 5.17644 4.1809 4.27452C4.27254 4.18124 4.32338 4.05537 4.32223 3.92461C4.32107 3.79385 4.26802 3.6689 4.17474 3.57725C4.08146 3.4856 3.95559 3.43477 3.82483 3.43592C3.69406 3.43708 3.56911 3.49013 3.47747 3.58341C2.12123 4.96411 1.36133 6.82211 1.36133 8.75749C1.36133 10.6929 2.12123 12.5509 3.47747 13.9316C3.52234 13.9796 3.57636 14.0181 3.63634 14.0449C3.69632 14.0717 3.76105 14.0862 3.82673 14.0876C3.8924 14.089 3.9577 14.0773 4.01878 14.0531C4.07986 14.0289 4.13549 13.9928 4.18239 13.9468C4.22929 13.9008 4.26652 13.8459 4.29189 13.7853C4.31726 13.7247 4.33026 13.6596 4.33012 13.5939C4.32998 13.5282 4.31671 13.4632 4.29108 13.4027C4.26546 13.3423 4.22799 13.2875 4.1809 13.2417C3.6171 12.6677 3.16693 11.9922 2.85411 11.2509Z",fill:e})}),kn.jsx("defs",{children:kn.jsx("clipPath",{id:"clip0_1_353",children:kn.jsx("rect",{fill:e,height:"16.0145",transform:"translate(0.798828 0.750366)",width:"16.0145"})})})]})}var Sr=({color:e,generationEnabled:t,switchIsOn:n,tierLevel:r,toggleSwitch:a})=>{const l=jn[r],o=l.icon,i=Pn.length,s=Pn.indexOf(r)+1;return kn.jsxs(qn,{style:{justifyContent:"space-between"},children:[kn.jsxs(Jn,{children:[kn.jsxs(cr,{children:[kn.jsxs(or,{children:[s,kn.jsx(lr,{$color:e,children:"/"}),i]}),kn.jsxs(er,{children:[kn.jsx(ar,{children:kn.jsx(xr,{color:n&&t?"white":"rgba(255, 255, 255, 0.4)"})}),kn.jsx(ur,{$active:n,$color:e,$enabled:t,onClick:a,children:kn.jsx(sr,{$active:n})})]})]}),kn.jsxs(Kn,{children:[kn.jsx(Yn,{children:kn.jsx(o,{color:e,height:30,width:30})}),"Speed"]})]}),kn.jsx(Gn,{children:Array.from({length:6}).map((t,n)=>kn.jsx(Qn,{$active:n<l.dots,$color:e},n))})]})};function Er({height:e=21,style:t,width:n=21}){return kn.jsxs("svg",{fill:"none",height:e,style:t,viewBox:"0 0 21 21",width:n,children:[kn.jsx("g",{clipPath:"url(#clip0_2266_32407)",children:kn.jsx("path",{d:"M14.5289 3.82492C13.5562 2.70151 12.4614 1.68992 11.2648 0.808833C11.1588 0.734629 11.0326 0.694824 10.9033 0.694824C10.774 0.694824 10.6478 0.734629 10.5419 0.808833C9.34743 1.69028 8.25477 2.70187 7.28402 3.82492C5.11921 6.31102 3.97656 8.93178 3.97656 11.4045C3.97656 13.2424 4.70668 15.0051 6.00628 16.3047C7.30589 17.6043 9.06854 18.3344 10.9065 18.3344C12.7444 18.3344 14.507 17.6043 15.8066 16.3047C17.1063 15.0051 17.8364 13.2424 17.8364 11.4045C17.8364 8.93178 16.6937 6.31102 14.5289 3.82492ZM15.3046 12.14C15.1412 13.0525 14.7022 13.893 14.0467 14.5484C13.3911 15.2038 12.5505 15.6426 11.638 15.8058C11.6044 15.8112 11.5705 15.8141 11.5365 15.8144C11.3784 15.8144 11.2262 15.755 11.1099 15.6479C10.9937 15.5409 10.9219 15.3941 10.9088 15.2366C10.8957 15.0791 10.9423 14.9225 11.0393 14.7977C11.1363 14.673 11.2767 14.5892 11.4325 14.5631C12.7374 14.3434 13.8446 13.2362 14.0659 11.929C14.0939 11.7642 14.1862 11.6173 14.3225 11.5205C14.4588 11.4238 14.6279 11.3852 14.7927 11.4132C14.9575 11.4411 15.1044 11.5334 15.2012 11.6698C15.2979 11.8061 15.3365 11.9752 15.3085 12.14H15.3046Z",fill:"#0CACC8"})}),kn.jsx("defs",{children:kn.jsx("clipPath",{id:"clip0_2266_32407",children:kn.jsx("rect",{fill:"white",height:"20.1597",transform:"translate(0.830078 0.0629883)",width:"20.1597"})})})]})}var _r=({color:e,savedPercent:t=0,waterSaved:n})=>{const r=Rn(n||0,"m");return kn.jsxs(qn,{children:[kn.jsxs(Xn,{children:[kn.jsxs(Zn,{children:[kn.jsx(fr,{children:typeof n>"u"?"-":r.value}),kn.jsx(ir,{children:r.unit+"l saved"})]}),kn.jsxs(Kn,{children:[kn.jsx(Yn,{children:kn.jsx(Er,{height:22,width:22})}),"Water"]})]})," ",kn.jsx(Vn,{color:e,text:`${t}% saved`,children:kn.jsx(nr,{children:kn.jsx(rr,{$fillColor:"#0CACC8",$fillPercent:t})})})]})},Ar=({cards:e,color:t,generationEnabled:n,superStream:r,switchIsOn:a,tierLevel:l,toggleSwitch:o,user:i,videoID:s})=>{const{co2Saved:u,connected:c,energySaved:f,kWhSaved:d,sharedData:p,sharedPercent:h,waterSaved:m}=function(e,t){const n=(0, z.useCallback)(()=>{t&&e&&async function(e,t){const n=await xn(`${En}/videos/${e}?quanteecKey=${t}`);if(typeof n.data>"u")throw new Cn(`API error: not data returned by getVideo (status: ${n.status})`,n.status);return n.data}(e,t).then(e=>{e&&($n.connected=e.connected,$n.co2Saved=e.co2Saved,$n.energySaved=e.energySaved,$n.kWhSaved=e.kWhSaved,$n.sharedData=e.sharedData,$n.waterSaved=e.waterSaved,$n.sharedPercent=e.sharedPercent);}).catch(()=>{});},[t,e]);return (0, z.useEffect)(()=>{n();const e=setInterval(()=>{n();},1e4);return ()=>clearInterval(e)},[n]),{...$n}}(s,i.quanteecKey),{rankingNumber:g,rankingPercent:y}=function(e,t){const n=(0, z.useCallback)(()=>{(async function(e){const t=await Sn(e.collections),n=await xn(`${En}/users/${e.userID}/ranking?c=${t}`);if(typeof n.data>"u")throw new Cn(`API error: not data returned by getUserRanking (status: ${n.status})`,n.status);return n.data})(e).then(e=>{e&&(Dn.rankingNumber=e.rankingNumber,Dn.rankingPercent=e.rankingPercent);}).catch(()=>{});},[e]);return (0, z.useEffect)(()=>{if(t){n();const e=setInterval(()=>{n();},1e4);return ()=>clearInterval(e)}},[t,n]),{...Dn}}(i,e.includes("Ranking")),[v,b]=(0, z.useState)(!1),[w,k]=(0, z.useState)(!0);return kn.jsx(Wn,{$fadeBottom:w,$fadeTop:v,onScroll:({currentTarget:{clientHeight:e,scrollHeight:t,scrollTop:n}})=>{b(0!==n),k(Math.ceil(n+e)<Math.floor(t));},children:e.map((e,i)=>{switch(e){case"CO2":return kn.jsx(dr,{co2Saved:u,color:t,savedPercent:f},e+i);case"Energy":return kn.jsx(gr,{energySaved:f},e+i);case"Peers":return kn.jsx(hr,{connected:c},e+i);case"Power":return kn.jsx(vr,{color:t,kWhSaved:d,savedPercent:f},e+i);case"Ranking":return kn.jsx(wr,{color:t,rankingNumber:g,rankingPercent:y},e+i);case"Shared":return kn.jsx(Cr,{color:t,sharedData:p,sharedPercent:h,superStream:r},e+i);case"Speed":return kn.jsx(Sr,{color:t,generationEnabled:n,switchIsOn:a,tierLevel:l,toggleSwitch:o},e+i);case"Water":return kn.jsx(_r,{color:t,savedPercent:f,waterSaved:m},e+i);default:return}})})};function Pr({color:e="#2F90B0",height:t="32",width:n="32"}){return kn.jsxs("svg",{fill:"none",height:t,style:{paddingBottom:"4px"},viewBox:"0 0 34 34",width:n,children:[kn.jsx("rect",{fill:"url(#paint0_radial_2266_32162)",height:"33.1941",transform:"translate(0.774414 0.663574)",width:"33.1941"}),kn.jsx("path",{d:"M11.2019 23.4236L17.3744 18.4856L23.5468 23.4236",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.88693"}),kn.jsx("path",{d:"M11.2019 16.0312L17.3744 11.0933L23.5468 16.0312",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.88693"}),kn.jsx("defs",{children:kn.jsxs("radialGradient",{cx:"0",cy:"0",gradientTransform:"translate(16.597 16.597) rotate(90) scale(16.597)",gradientUnits:"userSpaceOnUse",id:"paint0_radial_2266_32162",r:"1",children:[kn.jsx("stop",{"stop-color":e}),kn.jsx("stop",{offset:"1","stop-color":e,"stop-opacity":"0"})]})})]})}var jr=mn.div.withConfig({displayName:"styles__StatusSliderContainer",componentId:"sc-z17e5-0"})(["display:flex;flex-direction:column;font-family:'Inter',sans-serif;width:100%;max-width:100%;"]),Nr=mn.div.withConfig({displayName:"styles__TopContainer",componentId:"sc-z17e5-1"})(["background-color:rgba(255,255,255,0.05);border:2px solid rgba(255,255,255,0.2);display:flex;flex-direction:column;justify-content:space-between;border-radius:33.53px;padding:24.38px 28px;margin-bottom:18.72px;"]),zr=mn.div.withConfig({displayName:"styles__MidContainer",componentId:"sc-z17e5-2"})(["display:flex;justify-content:space-between;align-items:center;margin-top:30px;"]),Lr=mn.div.withConfig({displayName:"styles__QoinsContainer",componentId:"sc-z17e5-4"})(["align-items:center;display:flex;justify-content:space-between;margin-bottom:24.38px;"]),Tr=mn.div.withConfig({displayName:"styles__GraphicsContainer",componentId:"sc-z17e5-5"})(["display:flex;width:100%;justify-content:space-between;"]),Ir=mn.div.withConfig({displayName:"styles__QoinsNumContainer",componentId:"sc-z17e5-6"})(["font-size:27.17px;font-weight:700;"]),Or=mn.div.withConfig({displayName:"styles__QoinsNumTopContainer",componentId:"sc-z17e5-7"})(["display:flex;align-items:center;font-size:22px;"]),$r=mn.button.withConfig({displayName:"styles__ClaimButton",componentId:"sc-z17e5-8"})(["all:unset;position:relative;user-select:none;padding:23px 17px;width:174.78px;font-size:21.32px;font-weight:700;text-align:center;border-radius:14.21px;"," color:white;cursor:",";transition:all 0.3s ease;background-color:",";"," ",""],({$disabled:e})=>e&&"\n    border-color: rgba(255, 255, 255, 0.2);\n    border-style: solid;\n    border-width: 1.7px;\n  ",({$disabled:e})=>e?"default":"pointer",({$color:e,$disabled:t})=>t?"#444":e,({$disabled:e,$shadowColor:t})=>e?"":`box-shadow: 0 2px 8px ${t};`,({$contrast:e,$disabled:t})=>"black"!==e||t?"":"text-shadow: 0 0 35px black;"),Dr=mn.div.withConfig({displayName:"styles__ClaimButtonImage",componentId:"sc-z17e5-9"})(["position:absolute;top:0;left:0;width:100%;height:100%;",""],({$disabled:e,$image:t})=>!e&&`\n      background-image: url(${t});\n      background-repeat: no-repeat;\n      mask-image: linear-gradient(to right, rgba(255, 255, 255, 0.7), rgba(255,255,255,0.1), rgba(255,255,255,0));\n      animation: slide 1s linear infinite;\n        @keyframes slide {\n          0% {\n            background-position:  0 center;\n          }\n          100% {\n            background-position:  -60px center;\n          }\n        }\n      `),Mr=mn.div.withConfig({displayName:"styles__QoinsNum",componentId:"sc-z17e5-10"})(["font-size:36.5px;font-weight:700;margin-right:13.71px;"]),Rr=mn.div.withConfig({displayName:"styles__DotColumn",componentId:"sc-z17e5-11"})(["display:flex;flex-direction:row;gap:4px;margin-left:4px;"]),Fr=mn.div.withConfig({displayName:"styles__Dot",componentId:"sc-z17e5-12"})(["width:13.03px;height:13.03px;border-radius:50%;background-color:",";transition:background-color 0.3s ease;"],({$active:e,$color:t})=>e?t:"rgba(255, 255, 255, 0.1)"),Br=mn.div.withConfig({displayName:"styles__LiteTitle",componentId:"sc-z17e5-13"})(["display:flex;align-items:center;gap:2.5px;font-size:21.56px;font-weight:500;font-family:'Inter',sans-serif;"]),Ur=mn.div.withConfig({displayName:"styles__LeftGraphicsContainer",componentId:"sc-z17e5-14"})(["display:flex;flex-direction:column;gap:10px;color:rgba(255,255,255,0.5);"]),Hr=mn.div.withConfig({displayName:"styles__RightGraphicsContainer",componentId:"sc-z17e5-15"})(["display:flex;flex-direction:column;justify-content:center;gap:10px;"]),Vr=mn.div.withConfig({displayName:"styles__ProgressTextContainer",componentId:"sc-z17e5-16"})(["font-size:21.56px;font-weight:500;display:flex;justify-content:space-between;color:rgba(255,255,255,0.5);font-family:'Inter',sans-serif;"]),qr=mn.span.withConfig({displayName:"styles__PercentageText",componentId:"sc-z17e5-17"})(["color:rgba(255,255,255,0.5);font-size:21.56px;font-weight:500;font-family:'Inter',sans-serif;margin-left:20px;"]),Wr=mn.div.withConfig({displayName:"styles__ProgressBarBackground",componentId:"sc-z17e5-18"})(["margin-top:2px;width:245px;height:13px;background-color:rgba(255,255,255,0.1);border-radius:25px;overflow:hidden;"]),Qr=mn.div.withConfig({displayName:"styles__ProgressBarFill",componentId:"sc-z17e5-19"})(["height:100%;background-color:",";border-radius:4px 0 0 4px;transition:width 0.3s ease;"],({$color:e})=>e),Gr=mn.div.withConfig({displayName:"styles__SwitchContainer",componentId:"sc-z17e5-20"})(["display:flex;align-items:center;gap:16px;"]),Yr=mn.div.withConfig({displayName:"styles__SwitchWrapper",componentId:"sc-z17e5-21"})(["width:64.23px;height:35.68px;border-radius:999px;background-color:",";padding:2px;display:flex;align-items:center;cursor:",";"],({$active:e,$color:t,$enabled:n})=>e&&n?t:"#555",({$enabled:e})=>e?"pointer":"not-allowed"),Zr=mn.div.withConfig({displayName:"styles__SwitchDot",componentId:"sc-z17e5-22"})(["width:25px;height:25px;border-radius:50%;background:white;box-shadow:0 0 50px 0.5px black;top:2px;left:2px;transition:0.3s ease;transform:",";"],({$active:e})=>e?"translateX(32px)":"translateX(7px)"),Kr=mn.div.withConfig({displayName:"styles__TextContainer",componentId:"sc-z17e5-23"})(["font-size:21.42px;font-weight:600;"]),Xr=mn.div.withConfig({displayName:"styles__OnOffText",componentId:"sc-z17e5-24"})(["color:",";font-size:21.42px;font-weight:600;"],({$enabled:e})=>e?"white":"grey"),Jr=mn.div.withConfig({displayName:"styles__LeftMidContainer",componentId:"sc-z17e5-25"})(["display:flex;align-items:center;gap:5.28px;"]),ea=({claimEnabled:e,claimQoins:t,color:n,generationEnabled:r,progressBar:a,qoinsNumber:l,showDots:o,superStream:i,switchIsOn:s,tierLevel:u,toggleSwitch:c})=>{const f=jn[u],d=f.icon,p=e&&100===a,{contrast:h,shadowColor:m}=(0, z.useMemo)(()=>{const e=zn(n);return {contrast:Ln(e),shadowColor:`rgba(${e.r},${e.g},${e.b},${.4*e.a})`}},[n]);return kn.jsx(jr,{children:kn.jsxs(Nr,{children:[kn.jsxs(Lr,{children:[kn.jsxs(Ir,{children:[kn.jsxs(Or,{children:[kn.jsx(Mr,{children:l}),i&&kn.jsx(Vn,{color:n,position:"right",text:"Super Stream",children:kn.jsx(Pr,{color:n,height:35,width:35})})]}),"Qoins Earned"]}),kn.jsxs($r,{$color:n,$contrast:h,$disabled:!p,$shadowColor:m,onClick:()=>{p&&t();},children:[kn.jsx(Dr,{$disabled:!p,$image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAA8CAYAAADc3IdaAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAAYdEVYdFNvZnR3YXJlAFBhaW50Lk5FVCA1LjEuOWxu2j4AAAC2ZVhJZklJKgAIAAAABQAaAQUAAQAAAEoAAAAbAQUAAQAAAFIAAAAoAQMAAQAAAAIAAAAxAQIAEAAAAFoAAABphwQAAQAAAGoAAAAAAAAA8nYBAOgDAADydgEA6AMAAFBhaW50Lk5FVCA1LjEuOQADAACQBwAEAAAAMDIzMAGgAwABAAAAAQAAAAWgBAABAAAAlAAAAAAAAAACAAEAAgAEAAAAUjk4AAIABwAEAAAAMDEwMAAAAAArIfcnPEIHlAAAAnBJREFUeF7t3DFuk0EUReE7rAAJJC8gZQp2kIZ1p4yUEiRCg1gCK0jxaGxhTYf8Zu6f3POVb4rn42IkuxgJAAAAAAAAAAAAAAAAAAAAAIAjGfPAraok6STpTtLTfH6jV0kPY4zn+cCF3lb0mq3u/TBPnK5iHxfEStJPSb/moQu97eg12tR7HFV1qqoftca3qvo073SitxW9Zu++93wjq6q2xJ73zB9jG3rpbRLba3X5wnfFuoPpXYJek7TerFh6V6DXKKp3d6w7mN529BpF9UbF0rsCvUYRvZelu2Nd6KW3Cb0OV8FbYt3oXYJek5jetJuZXnqb0Otw+QA7Y53B9C5Br0la7/ZYN3rb0WuU1rst9ijobUWvWUxv2s1Mbzt6jSJ6L4t3x7qC6aW3Cb0OV8HLY+fdDvQuQa9JWu/2m9mN3nb0GqX1ZsXS241es7fQ2/3i6J2k+3nY4Lukr5L+SNIYh3nZmd4e9B7D4Xu7L6ylxhg3xb419L5v9P6/7gvrt6SXedjgi6THw/xZ9w+9Peg9hrTePb+D551O9Lai1yytVwqMprcVvWZpvVJgNL2t6DVL65UCo+ltRa9ZWq8UGE1vK3rN0nqlwGh6W9FrltYrBUbT24pes7ReKTCa3lb0mqX1SoHR9Lai1yytVwqMprcVvWZpvVJgNL2t6DVL65UCo+ltRa9ZWq8UGE1vK3rN0nqlwGh6W9FrltYrBUbT24pes7ReKTCa3lb0mqX1SoHR9Lai12x1723vlS5SVafz+9JP89mNXiU9jDGe5wMnetvQewCLezNU1ceq+jzPAQAAAAAAAAAAAAAAAAAAAAAH8xfaPkCstNkM7QAAAABJRU5ErkJggg=="}),"Claim Qoins"]})]}),kn.jsxs(Tr,{children:[kn.jsxs(Ur,{children:[kn.jsxs(Br,{children:[kn.jsx(d,{color:n,height:30,width:30}),kn.jsx(Vn,{color:n,position:"right",text:"Based on your contribution",children:"Speed"})]}),o&&kn.jsx(Rr,{children:[...Array(6)].map((e,t)=>kn.jsx(Fr,{$active:t<f.dots,$color:n},t))})]}),kn.jsxs(Hr,{children:[kn.jsxs(Vr,{children:["Next Qoin gen",kn.jsx(qr,{children:`${Math.floor(a)}%`})]}),kn.jsx(Wr,{children:kn.jsx(Qr,{$color:n,style:{width:`${a}%`}})})]})]}),kn.jsxs(zr,{children:[kn.jsxs(Jr,{children:[kn.jsx(xr,{}),kn.jsx(Kr,{children:"Boost Mode"})]}),kn.jsxs(Gr,{children:[kn.jsx(Xr,{$enabled:r,children:s?"ON":"OFF"}),kn.jsx(Yr,{$active:s,$color:n,$enabled:r,onClick:c,children:kn.jsx(Zr,{$active:s})})]})]})]})})},ta=mn.div.withConfig({displayName:"styles__BorderContainer",componentId:"sc-1ufqoez-0"})(["background:linear-gradient( to bottom,"," 0%,"," 5%,transparent 100% );border-radius:50px;display:",";padding:2px;height:fit-content;position:",";z-index:10000;",""],({$color:e})=>e,({$color:e})=>e,({$visible:e})=>e?"inline-block":"none",({$backdropMode:e,$position:t})=>t.center&&"fullscreen"===e?"fixed":"absolute",({$position:e,$scale:t})=>{let n="";if(e.center)n+=`\n        transform: translate(-50%, -50%) scale(${t});\n        transform-origin: center center;\n        top: 50%;\n        left: 50%;\n      `;else {n+=`\n        transform: scale(${t});\n        transform-origin: ${Object.keys(e).join(" ")};\n      `;const r=e;"string"==typeof r.left&&(n+=`left: ${r.left};\n`),"string"==typeof r.right&&(n+=`right: ${r.right};\n`),"string"==typeof r.bottom&&(n+=`bottom: ${r.bottom};\n`),"string"==typeof r.top&&(n+=`top: ${r.top};\n`);}return n}),na=mn.div.withConfig({displayName:"styles__BottomContainer",componentId:"sc-1ufqoez-1"})(["align-items:center;display:flex;"]),ra=mn.button.withConfig({displayName:"styles__CloseButton",componentId:"sc-1ufqoez-2"})(["align-items:center;background-color:rgba(255,255,255,0.1);border:none;border-radius:50%;cursor:pointer;display:flex;height:47px;justify-content:center;position:relative;width:47px;&::before,&::after{background-color:white;border:white;border-radius:25px;content:'';height:3.3px;left:50%;position:absolute;top:50%;transform-origin:center;width:25px;}&::before{transform:translate(-50%,-50%) rotate(45deg);}&::after{transform:translate(-50%,-50%) rotate(-45deg);}"]),aa=mn.div.withConfig({displayName:"styles__Header",componentId:"sc-1ufqoez-3"})(["align-items:center;display:flex;font-family:'Inter',sans-serif;font-size:40px;font-weight:700;justify-content:space-between;margin-bottom:23.52px;"]),la=mn.button.withConfig({displayName:"styles__LearnMoreButton",componentId:"sc-1ufqoez-4"})(["all:unset;background-color:white;border-radius:35.58px;color:black;cursor:pointer;display:flex;font-family:'Inter',sans-serif;font-size:26.35px;font-weight:600;justify-content:center;padding:15px 21px;text-align:center;user-select:none;width:208px;"]),oa=mn.div.withConfig({displayName:"styles__LeftHeader",componentId:"sc-1ufqoez-5"})(["align-items:center;display:flex;gap:8.65px;"]),ia=mn.div.withConfig({displayName:"styles__PanelContent",componentId:"sc-1ufqoez-6"})(["background-color:black;border-radius:50px;color:white;gap:16px;height:",";padding:69.5px 68.5px;position:relative;width:500px;z-index:1;",""],({$sponsorImage:e})=>e?"675px":"565px",({$color:e})=>e&&dn(["&::before{background:linear-gradient( to bottom,rgba(",",",",",",","),rgba(",",",",",",","),transparent 50% );border-radius:50px;content:'';height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%;z-index:-1;}"],e.r,e.g,e.b,.4*e.a,e.r,e.g,e.b,.2*e.a)),sa=mn.div.withConfig({displayName:"styles__PanelBackdrop",componentId:"sc-1ufqoez-7"})(["background:rgba(0,0,0,0.5);"," display:",";inset:0;position:",";z-index:999;"],({$backdropBlur:e})=>e?"backdrop-filter: blur(2px);":"",({$visible:e})=>e?"flex":"none",({$backdropMode:e})=>"fullscreen"===e?"fixed":"absolute"),ua=mn.div.withConfig({displayName:"styles__SlideContainer",componentId:"sc-1ufqoez-8"})(["display:flex;justify-content:space-between;width:100%;"]),ca=mn.img.withConfig({displayName:"styles__SponsorImage",componentId:"sc-1ufqoez-9"})(["aspect-ratio:4/1;margin-top:10px;margin-bottom:30px;display:flex;width:100%;border-radius:33.53px;"]),fa=mn.div.withConfig({displayName:"styles__Tabs",componentId:"sc-1ufqoez-10"})(["display:flex;justify-content:space-around;margin-bottom:18.63px;gap:11px;"]),da=mn.button.withConfig({displayName:"styles__Tab",componentId:"sc-1ufqoez-11"})(["all:unset;background:transparent;border-bottom:2px solid ",";color:white;cursor:pointer;flex:1;font-family:'Inter',sans-serif;font-size:28.74px;font-weight:600;padding:20px 0;text-align:center;user-select:none;"],({$active:e,$color:t})=>e?t:"transparent"),pa=mn.div.withConfig({displayName:"styles__TextContainerBottom",componentId:"sc-1ufqoez-12"})(["font-family:'Inter',sans-serif;font-size:26.11px;font-weight:400;text-align:left;"]),ha=({backdropBlur:e=!0,backdropMode:t="fullscreen",close:n,color:r="#2F90B0",dashboardCards:a=["Peers","Shared","Energy","Speed"],defaultIsStreamboostOn:l=!1,defaultSection:o="status",isOpen:i,position:s={center:!0},quanteecPlugin:u,setClaimAvailable:c,sponsor:f,superStream:d=!1,userID:p})=>{var h,m,g,y;const[v,b]=(0, z.useState)(o),[w,k]=(0, z.useState)(l),{claimEnabled:C,collections:x,dataSent:S,generationEnabled:E,quanteecKey:_,videoID:A}=function(e){const[t,n]=(0, z.useState)(""),[r,a]=(0, z.useState)(0),[l,o]=(0, z.useState)(""),[i,s]=(0, z.useState)(""),[u,c]=(0, z.useState)(e),f=(0, z.useRef)(e=>{console.warn(e);}),d=(0, z.useCallback)(e=>{f.current(e),f.current=()=>null;},[]);(0, z.useEffect)(()=>{if(!u){const e=setInterval(()=>{typeof quanteecPlayers>"u"||0===quanteecPlayers.length?d("Streamboost: No quanteec plugin detected."):1===quanteecPlayers.length?c(quanteecPlayers[0].player):(d("Streamboost: Multiple quanteec plugins detected"),c(quanteecPlayers[quanteecPlayers.length-1].player));},1e3);return ()=>clearInterval(e)}},[u,d]),(0, z.useEffect)(()=>{if(u){const e=u.factory.getInstance("GeneralSettings");n(e.collection||""),o(e.quanteecKey||""),s(e.analyticsVideoID||e.videoID||"");const t=setInterval(()=>{a(u.getPeerConnected());},1e4);return ()=>clearInterval(t)}},[u]);const[,p]=(0, z.useState)(0),[,h]=(0, z.useState)(0),m=An(10),g=An(10);return (0, z.useEffect)(()=>{const e=setInterval(()=>{u?(p(e=>{const t=u.getDataCDN()+u.getDataPeer();return m.addValue(t-e),t}),h(e=>{const t=u.getDataSent();return g.addValue(t-e),t})):(m.addValue(0),g.addValue(0));},1e3);return ()=>clearInterval(e)},[m,g,u]),{claimEnabled:!!u,collections:t,dataSent:g.average/1e6,generationEnabled:m.average>0||g.average>0||r>0,quanteecKey:l,videoID:i}}(u),P=(0, z.useMemo)(()=>({collections:x,quanteecKey:_,userID:p}),[x,_,p]),{claimQoins:j,progressBar:N,qoinsNumber:L,tierLevel:T}=function({claimEnabled:e,dataSent:t,generationEnabled:n,streamBoost:r,user:a}){const l=(0, z.useMemo)(()=>{if(!e||!n)return 0;let a;return a=t<5?2:t<10?4:t<15?6:t<20?8:t<25?10:12,r&&(a*=2,a>12&&(a=12)),a},[e,t,n,r]),o=(0, z.useMemo)(()=>{const e=Math.floor(l/2)-1;return e<0||e>5?"inactive":Pn[e]??"inactive"},[l]),[i,s]=(0, z.useState)(0);(0, z.useEffect)(()=>{if(n){const e=setInterval(()=>{s(t=>t>=100?(clearInterval(e),100):t+l/27);},1e3);return ()=>clearInterval(e)}},[n,!i,l]);const[u,c]=(0, z.useState)(0);return (0, z.useEffect)(()=>{(async function(e){const t=await Sn(e.collections),n=await xn(`${En}/users/${e.userID}?c=${t}`);if(typeof n.data>"u")throw new Cn(`API error: not data returned by getUser (status: ${n.status})`,n.status);return n.data})(a).then(e=>{e&&c(e.qoins??0);}).catch(e=>{404===e.code&&async function(e){await xn(`${En}/users/${e.userID}`,{method:"PUT",timeout:2e3});}(a).catch(()=>{});});},[a]),{claimQoins:(0, z.useCallback)(()=>{(async function(e,t=1,n="add"){const r=await Sn(e.collections),a=await xn(`${En}/users/${e.userID}?operation=${n}&c=${r}`,{body:JSON.stringify({qoins:t}),method:"PUT",timeout:2e3});if(typeof a.data>"u")throw new Cn(`API error: not data returned by updateUserQoins (status: ${a.status})`,a.status);return a.data})(a,1).then(e=>{c(e.qoins??0),s(0);}).catch(()=>{});},[a]),progressBar:i,qoinsNumber:u,tierLevel:o}}({claimEnabled:C,dataSent:S,generationEnabled:E,streamBoost:w,user:P}),I=C&&100===N;(0, z.useEffect)(()=>{c&&c(I);},[I,c]);const{trackAction:O}=(M={quanteecKey:_,userID:p,videoID:A},_n={..._n,...M},{trackAction:(0, z.useCallback)((e,t)=>{!async function(e,t){await xn(`${En}/tracking`,{body:JSON.stringify({action:e,timestamp:Date.now(),...t}),method:"POST"});}(e,{..._n,...t});},[])}),[$,D]=(0, z.useState)(!1);var M;(0, z.useEffect)(()=>{!$&&_&&(O("INITIALIZED"),D(!0));},[$,_,O]),(0, z.useEffect)(()=>{$&&(i?(dispatchEvent(In),O("OPEN_PANEL",{claimAvailable:I})):(dispatchEvent(Tn),O("CLOSE_PANEL",{claimAvailable:I})));},[I,i,O]);const R=(0, z.useCallback)(()=>{O("CLAIM_QOINS"),j();},[j,O]),F=(0, z.useCallback)(()=>{E&&k(e=>(O(e?"BOOST_OFF":"BOOST_ON"),!e));},[E,O]);(0, z.useEffect)(()=>{null!=f&&f.image&&i&&O("AD_PRINT",{sponsorID:f.id});},[i,null==f?void 0:f.id,null==f?void 0:f.image,O]);const B=(0, z.useRef)(null),U=(0, z.useRef)(null),[H,V]=(0, z.useState)(.5);(0, z.useEffect)(()=>{var e,t,n,r;if(null!=(e=null==B?void 0:B.current)&&e.offsetWidth&&null!=(t=null==B?void 0:B.current)&&t.offsetHeight&&null!=(n=null==U?void 0:U.current)&&n.scrollWidth&&null!=(r=null==U?void 0:U.current)&&r.scrollHeight){const e=B.current.offsetWidth-40,t=B.current.offsetHeight-40,n=U.current.scrollWidth,r=U.current.scrollHeight;V(Math.min(e/n,t/r,.5));}},[null==(h=null==B?void 0:B.current)?void 0:h.offsetWidth,null==(m=null==B?void 0:B.current)?void 0:m.offsetHeight,null==(g=null==U?void 0:U.current)?void 0:g.scrollWidth,null==(y=null==U?void 0:U.current)?void 0:y.scrollHeight]);const q=(0, z.useMemo)(()=>{if("#2F90B0"!==r)return zn(r)},[r]);return kn.jsxs(kn.Fragment,{children:[kn.jsx(sa,{$backdropBlur:e,$backdropMode:t,$visible:i,onClick:n,ref:B}),kn.jsx(ta,{$backdropMode:t,$color:r,$position:s,$scale:H,$visible:i,onClick:e=>e.stopPropagation(),ref:U,children:kn.jsxs(ia,{$color:q,$sponsorImage:!(null==f||!f.image),children:[kn.jsxs(aa,{children:[kn.jsxs(oa,{children:[kn.jsx(On,{color:r}),"StreamBoost"]}),kn.jsx(ra,{onClick:n})]}),kn.jsxs(fa,{children:[kn.jsx(da,{$active:"status"===v,$color:r,onClick:()=>b("status"),children:"Status"}),kn.jsx(da,{$active:"dashboard"===v,$color:r,onClick:()=>b("dashboard"),children:"Dashboard"})]}),kn.jsxs(ua,{children:["status"===v&&kn.jsx(ea,{claimEnabled:C,claimQoins:R,color:r,generationEnabled:E,progressBar:N,qoinsNumber:L,showDots:!0,superStream:d,switchIsOn:w,tierLevel:T,toggleSwitch:F}),"dashboard"===v&&kn.jsx(Ar,{cards:a,color:r,generationEnabled:E,superStream:d,switchIsOn:w,tierLevel:T,toggleSwitch:F,user:P,videoID:A})]}),(null==f?void 0:f.image)&&kn.jsx("a",{href:f.url,onClick:()=>O("AD_CLICK",{sponsorID:f.id}),target:"_blank",children:kn.jsx(ca,{src:f.image})}),"status"===v&&kn.jsxs(na,{children:[kn.jsx(pa,{children:"Start being part of something new"}),kn.jsx(la,{onClick:()=>{O("LEARN_MORE"),window.open("https://streamboost.quanteec.com/");},children:"Learn More"})]})]})})]})};mn.button.withConfig({displayName:"styles__Button",componentId:"sc-lyotni-0"})(["align-content:center;background:transparent;border:none;cursor:pointer;display:grid ",";height:fit-content;justify-content:center;padding:0;position:relative;",""],({$isOpen:e})=>e?"!important":"",({$isOpen:e,$panelAnchor:t})=>e&&"center"!==t?"z-index: 10000;":"");var ma=g({"node_modules/scheduler/cjs/scheduler.production.js":e=>{function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,l=e[r];if(!(0<a(l,t)))break e;e[r]=t,e[n]=l,n=r;}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,l=e.length,o=l>>>1;r<o;){var i=2*(r+1)-1,s=e[i],u=i+1,c=e[u];if(0>a(s,n))u<l&&0>a(c,s)?(e[r]=c,e[u]=n,r=u):(e[r]=s,e[i]=n,r=i);else {if(!(u<l&&0>a(c,n)))break e;e[r]=c,e[u]=n,r=u;}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(e.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var l=performance;e.unstable_now=function(){return l.now()};}else {var o=Date,i=o.now();e.unstable_now=function(){return o.now()-i};}var s=[],u=[],c=1,f=null,d=3,p=!1,h=!1,m=!1,g=!1,y="function"==typeof setTimeout?setTimeout:null,v="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function w(e){for(var a=n(u);null!==a;){if(null===a.callback)r(u);else {if(!(a.startTime<=e))break;r(u),a.sortIndex=a.expirationTime,t(s,a);}a=n(u);}}function k(e){if(m=!1,w(e),!h)if(null!==n(s))h=!0,x||(x=!0,C());else {var t=n(u);null!==t&&z(k,t.startTime-e);}}var C,x=!1,S=-1,E=5,_=-1;function A(){return !(!g&&e.unstable_now()-_<E)}function P(){if(g=!1,x){var t=e.unstable_now();_=t;var a=!0;try{e:{h=!1,m&&(m=!1,v(S),S=-1),p=!0;var l=d;try{t:{for(w(t),f=n(s);null!==f&&!(f.expirationTime>t&&A());){var o=f.callback;if("function"==typeof o){f.callback=null,d=f.priorityLevel;var i=o(f.expirationTime<=t);if(t=e.unstable_now(),"function"==typeof i){f.callback=i,w(t),a=!0;break t}f===n(s)&&r(s),w(t);}else r(s);f=n(s);}if(null!==f)a=!0;else {var c=n(u);null!==c&&z(k,c.startTime-t),a=!1;}}break e}finally{f=null,d=l,p=!1;}a=void 0;}}finally{a?C():x=!1;}}}if("function"==typeof b)C=function(){b(P);};else if("undefined"!=typeof MessageChannel){var j=new MessageChannel,N=j.port2;j.port1.onmessage=P,C=function(){N.postMessage(null);};}else C=function(){y(P,0);};function z(t,n){S=y(function(){t(e.unstable_now());},n);}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null;},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5;},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d;}var n=d;d=t;try{return e()}finally{d=n;}},e.unstable_requestPaint=function(){g=!0;},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3;}var n=d;d=e;try{return t()}finally{d=n;}},e.unstable_scheduleCallback=function(r,a,l){var o=e.unstable_now();switch(l="object"==typeof l&&null!==l&&"number"==typeof(l=l.delay)&&0<l?o+l:o,r){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3;}return r={id:c++,callback:a,priorityLevel:r,startTime:l,expirationTime:i=l+i,sortIndex:-1},l>o?(r.sortIndex=l,t(u,r),null===n(s)&&r===n(u)&&(m?(v(S),S=-1):m=!0,z(k,l-o))):(r.sortIndex=i,t(s,r),h||p||(h=!0,x||(x=!0,C()))),r},e.unstable_shouldYield=A,e.unstable_wrapCallback=function(e){var t=d;return function(){var n=d;d=t;try{return e.apply(this,arguments)}finally{d=n;}}};}}),ga=g({"node_modules/scheduler/index.js":(e,t)=>{t.exports=ma();}}),ya=g({"node_modules/react-dom/cjs/react-dom.production.js":e=>{var t=N();function n(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);}return "Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var a={d:{f:r,r:function(){throw Error(n(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},l=Symbol.for("react.portal"),o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function i(e,t){return "font"===e?"":"string"==typeof t?"use-credentials"===t?t:"":void 0}e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,e.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(n(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return {$$typeof:l,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,r)},e.flushSync=function(e){var t=o.T,n=a.p;try{if(o.T=null,a.p=2,e)return e()}finally{o.T=t,a.p=n,a.d.f();}},e.preconnect=function(e,t){"string"==typeof e&&(t=t?"string"==typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:null,a.d.C(e,t));},e.prefetchDNS=function(e){"string"==typeof e&&a.d.D(e);},e.preinit=function(e,t){if("string"==typeof e&&t&&"string"==typeof t.as){var n=t.as,r=i(n,t.crossOrigin),l="string"==typeof t.integrity?t.integrity:void 0,o="string"==typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?a.d.S(e,"string"==typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:l,fetchPriority:o}):"script"===n&&a.d.X(e,{crossOrigin:r,integrity:l,fetchPriority:o,nonce:"string"==typeof t.nonce?t.nonce:void 0});}},e.preinitModule=function(e,t){if("string"==typeof e)if("object"==typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=i(t.as,t.crossOrigin);a.d.M(e,{crossOrigin:n,integrity:"string"==typeof t.integrity?t.integrity:void 0,nonce:"string"==typeof t.nonce?t.nonce:void 0});}}else t??a.d.M(e);},e.preload=function(e,t){if("string"==typeof e&&"object"==typeof t&&null!==t&&"string"==typeof t.as){var n=t.as,r=i(n,t.crossOrigin);a.d.L(e,n,{crossOrigin:r,integrity:"string"==typeof t.integrity?t.integrity:void 0,nonce:"string"==typeof t.nonce?t.nonce:void 0,type:"string"==typeof t.type?t.type:void 0,fetchPriority:"string"==typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"==typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"==typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"==typeof t.imageSizes?t.imageSizes:void 0,media:"string"==typeof t.media?t.media:void 0});}},e.preloadModule=function(e,t){if("string"==typeof e)if(t){var n=i(t.as,t.crossOrigin);a.d.m(e,{as:"string"==typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"==typeof t.integrity?t.integrity:void 0});}else a.d.m(e);},e.requestFormReset=function(e){a.d.r(e);},e.unstable_batchedUpdates=function(e,t){return e(t)},e.useFormState=function(e,t,n){return o.H.useFormState(e,t,n)},e.useFormStatus=function(){return o.H.useHostTransitionStatus()},e.version="19.2.0";}}),va=g({"node_modules/react-dom/index.js":(e,t)=>{!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e);}catch(e){console.error(e);}}(),t.exports=ya();}}),ba=g({"node_modules/react-dom/cjs/react-dom-client.production.js":e=>{P();var t=ga(),n=N(),r=va();function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);}return "Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else {e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return;}while(e)}return 3===t.tag?n:null}function o(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function i(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function s(e){if(l(e)!==e)throw Error(a(188))}function c(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=c(e)))return t;e=e.sibling;}return null}var f=Object.assign,d=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),h=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),g=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),v=Symbol.for("react.consumer"),b=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),x=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),_=Symbol.for("react.memo_cache_sentinel"),A=Symbol.iterator;function j(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=A&&e[A]||e["@@iterator"])?e:null}var z=Symbol.for("react.client.reference");function L(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===z?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case m:return "Fragment";case y:return "Profiler";case g:return "StrictMode";case k:return "Suspense";case C:return "SuspenseList";case E:return "Activity"}if("object"==typeof e)switch(e.$$typeof){case h:return "Portal";case b:return e.displayName||"Context";case v:return (e._context.displayName||"Context")+".Consumer";case w:var t=e.render;return (e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case x:return null!==(t=e.displayName||null)?t:L(e.type)||"Memo";case S:t=e._payload,e=e._init;try{return L(e(t))}catch(e){}}return null}var T=Array.isArray,I=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,O=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$={pending:!1,data:null,method:null,action:null},D=[],M=-1;function R(e){return {current:e}}function F(e){0>M||(e.current=D[M],D[M]=null,M--);}function B(e,t){M++,D[M]=e.current,e.current=t;}var U,H,V=R(null),q=R(null),W=R(null),Q=R(null);function G(e,t){switch(B(W,t),B(q,e),B(V,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?wf(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=kf(t=wf(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0;}}F(V),B(V,e);}function Y(){F(V),F(q),F(W);}function Z(e){null!==e.memoizedState&&B(Q,e);var t=V.current,n=kf(t,e.type);t!==n&&(B(q,e),B(V,n));}function K(e){q.current===e&&(F(V),F(q)),Q.current===e&&(F(Q),pd._currentValue=$);}function X(e){if(void 0===U)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);U=t&&t[1]||"",H=-1<e.stack.indexOf("\n    at")?" (<anonymous>)":-1<e.stack.indexOf("@")?"@unknown:0:0":"";}return "\n"+U+e+H}var J=!1;function ee(e,t){if(!e||J)return "";J=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[]);}catch(e){var r=e;}Reflect.construct(e,[],n);}else {try{n.call();}catch(e){r=e;}e.call(n.prototype);}}else {try{throw Error()}catch(e){r=e;}(n=e())&&"function"==typeof n.catch&&n.catch(function(){});}}catch(e){if(e&&r&&"string"==typeof e.stack)return [e.stack,r.stack]}return [null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var l=r.DetermineComponentFrameRoot(),o=l[0],i=l[1];if(o&&i){var s=o.split("\n"),u=i.split("\n");for(a=r=0;r<s.length&&!s[r].includes("DetermineComponentFrameRoot");)r++;for(;a<u.length&&!u[a].includes("DetermineComponentFrameRoot");)a++;if(r===s.length||a===u.length)for(r=s.length-1,a=u.length-1;1<=r&&0<=a&&s[r]!==u[a];)a--;for(;1<=r&&0<=a;r--,a--)if(s[r]!==u[a]){if(1!==r||1!==a)do{if(r--,0>--a||s[r]!==u[a]){var c="\n"+s[r].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=r&&0<=a);break}}}finally{J=!1,Error.prepareStackTrace=n;}return (n=e?e.displayName||e.name:"")?X(n):""}function te(e,t){switch(e.tag){case 26:case 27:case 5:return X(e.type);case 16:return X("Lazy");case 13:return e.child!==t&&null!==t?X("Suspense Fallback"):X("Suspense");case 19:return X("SuspenseList");case 0:case 15:return ee(e.type,!1);case 11:return ee(e.type.render,!1);case 1:return ee(e.type,!0);case 31:return X("Activity");default:return ""}}function ne(e){try{var t="",n=null;do{t+=te(e,n),n=e,e=e.return;}while(e);return t}catch(e){return "\nError generating stack: "+e.message+"\n"+e.stack}}var re=Object.prototype.hasOwnProperty,ae=t.unstable_scheduleCallback,le=t.unstable_cancelCallback,oe=t.unstable_shouldYield,ie=t.unstable_requestPaint,se=t.unstable_now,ue=t.unstable_getCurrentPriorityLevel,ce=t.unstable_ImmediatePriority,fe=t.unstable_UserBlockingPriority,de=t.unstable_NormalPriority,pe=t.unstable_LowPriority,he=t.unstable_IdlePriority,me=t.log,ge=t.unstable_setDisableYieldValue,ye=null,ve=null;function be(e){if("function"==typeof me&&ge(e),ve&&"function"==typeof ve.setStrictMode)try{ve.setStrictMode(ye,e);}catch(e){}}var we=Math.clz32?Math.clz32:function(e){return 0==(e>>>=0)?32:31-(ke(e)/Ce|0)|0},ke=Math.log,Ce=Math.LN2,xe=256,Se=262144,Ee=4194304;function _e(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ae(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var a=0,l=e.suspendedLanes,o=e.pingedLanes;e=e.warmLanes;var i=134217727&r;return 0!==i?0!==(r=i&~l)?a=_e(r):0!==(o&=i)?a=_e(o):n||0!==(n=i&~e)&&(a=_e(n)):0!==(i=r&~l)?a=_e(i):0!==o?a=_e(o):n||0!==(n=r&~e)&&(a=_e(n)),0===a?0:0!==t&&t!==a&&0===(t&l)&&((l=a&-a)>=(n=t&-t)||32===l&&4194048&n)?t:a}function Pe(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function je(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return -1}}function Ne(){var e=Ee;return !(62914560&(Ee<<=1))&&(Ee=4194304),e}function ze(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Le(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0);}function Te(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-we(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|261930&n;}function Ie(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-we(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a;}}function Oe(e,t){var n=t&-t;return 0!==((n=42&n?1:$e(n))&(e.suspendedLanes|t))?0:n}function $e(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0;}return e}function De(e){return 2<(e&=-e)?8<e?134217727&e?32:268435456:8:2}function Me(){var e=O.p;return 0!==e?e:void 0===(e=window.event)?32:Ad(e.type)}function Re(e,t){var n=O.p;try{return O.p=e,t()}finally{O.p=n;}}var Fe=Math.random().toString(36).slice(2),Be="__reactFiber$"+Fe,Ue="__reactProps$"+Fe,He="__reactContainer$"+Fe,Ve="__reactEvents$"+Fe,qe="__reactListeners$"+Fe,We="__reactHandles$"+Fe,Qe="__reactResources$"+Fe,Ge="__reactMarker$"+Fe;function Ye(e){delete e[Be],delete e[Ue],delete e[Ve],delete e[qe],delete e[We];}function Ze(e){var t=e[Be];if(t)return t;for(var n=e.parentNode;n;){if(t=n[He]||n[Be]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Rf(e);null!==e;){if(n=e[Be])return n;e=Rf(e);}return t}n=(e=n).parentNode;}return null}function Ke(e){if(e=e[Be]||e[He]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function Xe(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(a(33))}function Je(e){var t=e[Qe];return t||(t=e[Qe]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function et(e){e[Ge]=!0;}var tt=new Set,nt={};function rt(e,t){at(e,t),at(e+"Capture",t);}function at(e,t){for(nt[e]=t,e=0;e<t.length;e++)tt.add(t[e]);}var lt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ot={},it={};function st(e,t,n){if(a=t,re.call(it,a)||!re.call(ot,a)&&(lt.test(a)?it[a]=!0:(ot[a]=!0,0)))if(null===n)e.removeAttribute(t);else {switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n);}var a;}function ut(e,t,n){if(null===n)e.removeAttribute(t);else {switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n);}}function ct(e,t,n,r){if(null===r)e.removeAttribute(n);else {switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r);}}function ft(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return ""}}function dt(e){var t=e.type;return (e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function pt(e){if(!e._valueTracker){var t=dt(e)?"checked":"value";e._valueTracker=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&void 0!==r&&"function"==typeof r.get&&"function"==typeof r.set){var a=r.get,l=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){n=""+e,l.call(this,e);}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e;},stopTracking:function(){e._valueTracker=null,delete e[t];}}}}(e,t,""+e[t]);}}function ht(e){if(!e)return !1;var t=e._valueTracker;if(!t)return !0;var n=t.getValue(),r="";return e&&(r=dt(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function mt(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var gt=/[\n"\\]/g;function yt(e){return e.replace(gt,function(e){return "\\"+e.charCodeAt(0).toString(16)+" "})}function vt(e,t,n,r,a,l,o,i){e.name="",null!=o&&"function"!=typeof o&&"symbol"!=typeof o&&"boolean"!=typeof o?e.type=o:e.removeAttribute("type"),null!=t?"number"===o?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ft(t)):e.value!==""+ft(t)&&(e.value=""+ft(t)):"submit"!==o&&"reset"!==o||e.removeAttribute("value"),null!=t?wt(e,o,ft(t)):null!=n?wt(e,o,ft(n)):null!=r&&e.removeAttribute("value"),null==a&&null!=l&&(e.defaultChecked=!!l),null!=a&&(e.checked=a&&"function"!=typeof a&&"symbol"!=typeof a),null!=i&&"function"!=typeof i&&"symbol"!=typeof i&&"boolean"!=typeof i?e.name=""+ft(i):e.removeAttribute("name");}function bt(e,t,n,r,a,l,o,i){if(null!=l&&"function"!=typeof l&&"symbol"!=typeof l&&"boolean"!=typeof l&&(e.type=l),null!=t||null!=n){if(("submit"===l||"reset"===l)&&null==t)return void pt(e);n=null!=n?""+ft(n):"",t=null!=t?""+ft(t):n,i||t===e.value||(e.value=t),e.defaultValue=t;}r="function"!=typeof(r=null!=r?r:a)&&"symbol"!=typeof r&&!!r,e.checked=i?e.checked:!!r,e.defaultChecked=!!r,null!=o&&"function"!=typeof o&&"symbol"!=typeof o&&"boolean"!=typeof o&&(e.name=o),pt(e);}function wt(e,t,n){"number"===t&&mt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n);}function kt(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0);}else {for(n=""+ft(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a]);}null!==t&&(t.selected=!0);}}function Ct(e,t,n){null==t||((t=""+ft(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ft(n):"":e.defaultValue!==t&&(e.defaultValue=t);}function xt(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(a(92));if(T(r)){if(1<r.length)throw Error(a(93));r=r[0];}n=r;}n??="",t=n;}n=ft(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r),pt(e);}function St(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t;}var Et=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function _t(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"==typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!=typeof n||0===n||Et.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px";}function At(e,t,n){if(null!=t&&"object"!=typeof t)throw Error(a(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var l in t)r=t[l],t.hasOwnProperty(l)&&n[l]!==r&&_t(e,l,r);}else for(var o in t)t.hasOwnProperty(o)&&_t(e,o,t[o]);}function Pt(e){if(-1===e.indexOf("-"))return !1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return !1;default:return !0}}var jt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Nt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function zt(e){return Nt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Lt(){}var Tt=null;function It(e){return (e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ot=null,$t=null;function Dt(e){var t=Ke(e);if(t&&(e=t.stateNode)){var n=e[Ue]||null;e:switch(e=t.stateNode,t.type){case"input":if(vt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+yt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var l=r[Ue]||null;if(!l)throw Error(a(90));vt(r,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name);}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&ht(r);}break e;case"textarea":Ct(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&kt(e,!!n.multiple,t,!1);}}}var Mt=!1;function Rt(e,t,n){if(Mt)return e(t,n);Mt=!0;try{return e(t)}finally{if(Mt=!1,(null!==Ot||null!==$t)&&(tc(),Ot&&(t=Ot,e=$t,$t=Ot=null,Dt(t),e)))for(t=0;t<e.length;t++)Dt(e[t]);}}function Ft(e,t){var n=e.stateNode;if(null===n)return null;var r=n[Ue]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1;}if(e)return null;if(n&&"function"!=typeof n)throw Error(a(231,t,typeof n));return n}var Bt=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),Ut=!1;if(Bt)try{var Ht={};Object.defineProperty(Ht,"passive",{get:function(){Ut=!0;}}),window.addEventListener("test",Ht,Ht),window.removeEventListener("test",Ht,Ht);}catch(e){Ut=!1;}var Vt=null,qt=null,Wt=null;function Qt(){if(Wt)return Wt;var e,t,n=qt,r=n.length,a="value"in Vt?Vt.value:Vt.textContent,l=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[l-t];t++);return Wt=a.slice(e,1<t?1-t:void 0)}function Gt(e){var t=e.keyCode;return "charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Yt(){return !0}function Zt(){return !1}function Kt(e){function t(t,n,r,a,l){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=l,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?Yt:Zt,this.isPropagationStopped=Zt,this}return f(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Yt);},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Yt);},persist:function(){},isPersistent:Yt}),t}var Xt,Jt,en,tn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nn=Kt(tn),rn=f({},tn,{view:0,detail:0}),an=Kt(rn),ln=f({},rn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return "movementX"in e?e.movementX:(e!==en&&(en&&"mousemove"===e.type?(Xt=e.screenX-en.screenX,Jt=e.screenY-en.screenY):Jt=Xt=0,en=e),Xt)},movementY:function(e){return "movementY"in e?e.movementY:Jt}}),on=Kt(ln),sn=Kt(f({},ln,{dataTransfer:0})),un=Kt(f({},rn,{relatedTarget:0})),cn=Kt(f({},tn,{animationName:0,elapsedTime:0,pseudoElement:0})),fn=Kt(f({},tn,{clipboardData:function(e){return "clipboardData"in e?e.clipboardData:window.clipboardData}})),dn=Kt(f({},tn,{data:0})),pn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=mn[e])&&!!t[e]}function yn(){return gn}var vn=Kt(f({},rn,{key:function(e){if(e.key){var t=pn[e.key]||e.key;if("Unidentified"!==t)return t}return "keypress"===e.type?13===(e=Gt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?hn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yn,charCode:function(e){return "keypress"===e.type?Gt(e):0},keyCode:function(e){return "keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return "keypress"===e.type?Gt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),bn=Kt(f({},ln,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),wn=Kt(f({},rn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yn})),kn=Kt(f({},tn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Cn=Kt(f({},ln,{deltaX:function(e){return "deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return "deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),xn=Kt(f({},tn,{newState:0,oldState:0})),Sn=[9,13,27,32],En=Bt&&"CompositionEvent"in window,_n=null;Bt&&"documentMode"in document&&(_n=document.documentMode);var An=Bt&&"TextEvent"in window&&!_n,Pn=Bt&&(!En||_n&&8<_n&&11>=_n),jn=String.fromCharCode(32),Nn=!1;function zn(e,t){switch(e){case"keyup":return -1!==Sn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return !0;default:return !1}}function Ln(e){return "object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Tn=!1,In={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function On(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return "input"===t?!!In[e.type]:"textarea"===t}function $n(e,t,n,r){Ot?$t?$t.push(r):$t=[r]:Ot=r,0<(t=lf(t,"onChange")).length&&(n=new nn("onChange","change",null,n,r),e.push({event:n,listeners:t}));}var Dn=null,Mn=null;function Rn(e){Kc(e,0);}function Fn(e){if(ht(Xe(e)))return e}function Bn(e,t){if("change"===e)return t}var Un=!1;if(Bt){var Hn;if(Bt){var Vn="oninput"in document;if(!Vn){var qn=document.createElement("div");qn.setAttribute("oninput","return;"),Vn="function"==typeof qn.oninput;}Hn=Vn;}else Hn=!1;Un=Hn&&(!document.documentMode||9<document.documentMode);}function Wn(){Dn&&(Dn.detachEvent("onpropertychange",Qn),Mn=Dn=null);}function Qn(e){if("value"===e.propertyName&&Fn(Mn)){var t=[];$n(t,Mn,e,It(e)),Rt(Rn,t);}}function Gn(e,t,n){"focusin"===e?(Wn(),Mn=n,(Dn=t).attachEvent("onpropertychange",Qn)):"focusout"===e&&Wn();}function Yn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Fn(Mn)}function Zn(e,t){if("click"===e)return Fn(t)}function Kn(e,t){if("input"===e||"change"===e)return Fn(t)}var Xn="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function Jn(e,t){if(Xn(e,t))return !0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return !1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return !1;for(r=0;r<n.length;r++){var a=n[r];if(!re.call(t,a)||!Xn(e[a],t[a]))return !1}return !0}function er(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function tr(e,t){var n,r=er(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return {node:r,offset:t-e};e=n;}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode;}r=void 0;}r=er(r);}}function nr(e,t){return !(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?nr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function rr(e){for(var t=mt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href;}catch(e){n=!1;}if(!n)break;t=mt((e=t.contentWindow).document);}return t}function ar(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var lr=Bt&&"documentMode"in document&&11>=document.documentMode,or=null,ir=null,sr=null,ur=!1;function cr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ur||null==or||or!==mt(r)||(r="selectionStart"in(r=or)&&ar(r)?{start:r.selectionStart,end:r.selectionEnd}:{anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},sr&&Jn(sr,r)||(sr=r,0<(r=lf(ir,"onSelect")).length&&(t=new nn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=or)));}function fr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var dr={animationend:fr("Animation","AnimationEnd"),animationiteration:fr("Animation","AnimationIteration"),animationstart:fr("Animation","AnimationStart"),transitionrun:fr("Transition","TransitionRun"),transitionstart:fr("Transition","TransitionStart"),transitioncancel:fr("Transition","TransitionCancel"),transitionend:fr("Transition","TransitionEnd")},pr={},hr={};function mr(e){if(pr[e])return pr[e];if(!dr[e])return e;var t,n=dr[e];for(t in n)if(n.hasOwnProperty(t)&&t in hr)return pr[e]=n[t];return e}Bt&&(hr=document.createElement("div").style,"AnimationEvent"in window||(delete dr.animationend.animation,delete dr.animationiteration.animation,delete dr.animationstart.animation),"TransitionEvent"in window||delete dr.transitionend.transition);var gr=mr("animationend"),yr=mr("animationiteration"),vr=mr("animationstart"),br=mr("transitionrun"),wr=mr("transitionstart"),kr=mr("transitioncancel"),Cr=mr("transitionend"),xr=new Map,Sr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Er(e,t){xr.set(e,t),rt(t,[e]);}Sr.push("scrollEnd");var _r="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof u&&"function"==typeof u.emit)return void u.emit("uncaughtException",e);console.error(e);},Ar=[],Pr=0,jr=0;function Nr(){for(var e=Pr,t=jr=Pr=0;t<e;){var n=Ar[t];Ar[t++]=null;var r=Ar[t];Ar[t++]=null;var a=Ar[t];Ar[t++]=null;var l=Ar[t];if(Ar[t++]=null,null!==r&&null!==a){var o=r.pending;null===o?a.next=a:(a.next=o.next,o.next=a),r.pending=a;}0!==l&&Ir(n,a,l);}}function zr(e,t,n,r){Ar[Pr++]=e,Ar[Pr++]=t,Ar[Pr++]=n,Ar[Pr++]=r,jr|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r);}function Lr(e,t,n,r){return zr(e,t,n,r),Or(e)}function Tr(e,t){return zr(e,null,null,t),Or(e)}function Ir(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var a=!1,l=e.return;null!==l;)l.childLanes|=n,null!==(r=l.alternate)&&(r.childLanes|=n),22===l.tag&&(null===(e=l.stateNode)||1&e._visibility||(a=!0)),e=l,l=l.return;return 3===e.tag?(l=e.stateNode,a&&null!==t&&(a=31-we(n),null===(r=(e=l.hiddenUpdates)[a])?e[a]=[t]:r.push(t),t.lane=536870912|n),l):null}function Or(e){if(50<Wu)throw Wu=0,Qu=null,Error(a(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var $r={};function Dr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null;}function Mr(e,t,n,r){return new Dr(e,t,n,r)}function Rr(e){return !(!(e=e.prototype)||!e.isReactComponent)}function Fr(e,t){var n=e.alternate;return null===n?((n=Mr(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Br(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ur(e,t,n,r,l,o){var i=0;if(r=e,"function"==typeof e)Rr(e)&&(i=1);else if("string"==typeof e)i=function(e,t,n){if(1===n||null!=t.itemProp)return !1;switch(e){case"meta":case"title":return !0;case"style":if("string"!=typeof t.precedence||"string"!=typeof t.href||""===t.href)break;return !0;case"link":if("string"!=typeof t.rel||"string"!=typeof t.href||""===t.href||t.onLoad||t.onError)break;return "stylesheet"!==t.rel||(e=t.disabled,"string"==typeof t.precedence&&null==e);case"script":if(t.async&&"function"!=typeof t.async&&"symbol"!=typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"==typeof t.src)return !0}return !1}(e,n,V.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case E:return (e=Mr(31,n,t,l)).elementType=E,e.lanes=o,e;case m:return Hr(n.children,l,o,t);case g:i=8,l|=24;break;case y:return (e=Mr(12,n,t,2|l)).elementType=y,e.lanes=o,e;case k:return (e=Mr(13,n,t,l)).elementType=k,e.lanes=o,e;case C:return (e=Mr(19,n,t,l)).elementType=C,e.lanes=o,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case b:i=10;break e;case v:i=9;break e;case w:i=11;break e;case x:i=14;break e;case S:i=16,r=null;break e}i=29,n=Error(a(130,null===e?"null":typeof e,"")),r=null;}return (t=Mr(i,n,t,l)).elementType=e,t.type=r,t.lanes=o,t}function Hr(e,t,n,r){return (e=Mr(7,e,r,t)).lanes=n,e}function Vr(e,t,n){return (e=Mr(6,e,null,t)).lanes=n,e}function qr(e){var t=Mr(18,null,null,0);return t.stateNode=e,t}function Wr(e,t,n){return (t=Mr(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Qr=new WeakMap;function Gr(e,t){if("object"==typeof e&&null!==e){var n=Qr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:ne(t)},Qr.set(e,t),t)}return {value:e,source:t,stack:ne(t)}}var Yr=[],Zr=0,Kr=null,Xr=0,Jr=[],ea=0,ta=null,na=1,ra="";function aa(e,t){Yr[Zr++]=Xr,Yr[Zr++]=Kr,Kr=e,Xr=t;}function la(e,t,n){Jr[ea++]=na,Jr[ea++]=ra,Jr[ea++]=ta,ta=e;var r=na;e=ra;var a=32-we(r)-1;r&=~(1<<a),n+=1;var l=32-we(t)+a;if(30<l){var o=a-a%5;l=(r&(1<<o)-1).toString(32),r>>=o,a-=o,na=1<<32-we(t)+a|n<<a|r,ra=l+e;}else na=1<<l|n<<a|r,ra=e;}function oa(e){null!==e.return&&(aa(e,1),la(e,1,0));}function ia(e){for(;e===Kr;)Kr=Yr[--Zr],Yr[Zr]=null,Xr=Yr[--Zr],Yr[Zr]=null;for(;e===ta;)ta=Jr[--ea],Jr[ea]=null,ra=Jr[--ea],Jr[ea]=null,na=Jr[--ea],Jr[ea]=null;}function sa(e,t){Jr[ea++]=na,Jr[ea++]=ra,Jr[ea++]=ta,na=t.id,ra=t.overflow,ta=e;}var ua=null,ca=null,fa=!1,da=null,pa=!1,ha=Error(a(519));function ma(e){throw xa(Gr(Error(a(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),ha}function ya(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Be]=e,t[Ue]=r,n){case"dialog":Xc("cancel",t),Xc("close",t);break;case"iframe":case"object":case"embed":Xc("load",t);break;case"video":case"audio":for(n=0;n<Yc.length;n++)Xc(Yc[n],t);break;case"source":Xc("error",t);break;case"img":case"image":case"link":Xc("error",t),Xc("load",t);break;case"details":Xc("toggle",t);break;case"input":Xc("invalid",t),bt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":Xc("invalid",t);break;case"textarea":Xc("invalid",t),xt(t,r.value,r.defaultValue,r.children);}"string"!=typeof(n=r.children)&&"number"!=typeof n&&"bigint"!=typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||df(t.textContent,n)?(null!=r.popover&&(Xc("beforetoggle",t),Xc("toggle",t)),null!=r.onScroll&&Xc("scroll",t),null!=r.onScrollEnd&&Xc("scrollend",t),null!=r.onClick&&(t.onclick=Lt),t=!0):t=!1,t||ma(e,!0);}function ba(e){for(ua=e.return;ua;)switch(ua.tag){case 5:case 31:case 13:return void(pa=!1);case 27:case 3:return void(pa=!0);default:ua=ua.return;}}function wa(e){if(e!==ua)return !1;if(!fa)return ba(e),fa=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||Cf(e.type,e.memoizedProps)),t=!t),t&&ca&&ma(e),ba(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));ca=Mf(e);}else if(31===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));ca=Mf(e);}else 27===n?(n=ca,jf(e.type)?(e=Df,Df=null,ca=e):ca=n):ca=ua?$f(e.stateNode.nextSibling):null;return !0}function ka(){ca=ua=null,fa=!1;}function Ca(){var e=da;return null!==e&&(null===Lu?Lu=e:Lu.push.apply(Lu,e),da=null),e}function xa(e){null===da?da=[e]:da.push(e);}var Sa=R(null),Ea=null,_a=null;function Aa(e,t,n){B(Sa,t._currentValue),t._currentValue=n;}function Pa(e){e._currentValue=Sa.current,F(Sa);}function ja(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return;}}function Na(e,t,n,r){var l=e.child;for(null!==l&&(l.return=e);null!==l;){var o=l.dependencies;if(null!==o){var i=l.child;o=o.firstContext;e:for(;null!==o;){var s=o;o=l;for(var u=0;u<t.length;u++)if(s.context===t[u]){o.lanes|=n,null!==(s=o.alternate)&&(s.lanes|=n),ja(o.return,n,e),r||(i=null);break e}o=s.next;}}else if(18===l.tag){if(null===(i=l.return))throw Error(a(341));i.lanes|=n,null!==(o=i.alternate)&&(o.lanes|=n),ja(i,n,e),i=null;}else i=l.child;if(null!==i)i.return=l;else for(i=l;null!==i;){if(i===e){i=null;break}if(null!==(l=i.sibling)){l.return=i.return,i=l;break}i=i.return;}l=i;}}function za(e,t,n,r){e=null;for(var l=t,o=!1;null!==l;){if(!o)if(524288&l.flags)o=!0;else if(262144&l.flags)break;if(10===l.tag){var i=l.alternate;if(null===i)throw Error(a(387));if(null!==(i=i.memoizedProps)){var s=l.type;Xn(l.pendingProps.value,i.value)||(null!==e?e.push(s):e=[s]);}}else if(l===Q.current){if(null===(i=l.alternate))throw Error(a(387));i.memoizedState.memoizedState!==l.memoizedState.memoizedState&&(null!==e?e.push(pd):e=[pd]);}l=l.return;}null!==e&&Na(t,e,n,r),t.flags|=262144;}function La(e){for(e=e.firstContext;null!==e;){if(!Xn(e.context._currentValue,e.memoizedValue))return !0;e=e.next;}return !1}function Ta(e){Ea=e,_a=null,null!==(e=e.dependencies)&&(e.firstContext=null);}function Ia(e){return $a(Ea,e)}function Oa(e,t){return null===Ea&&Ta(e),$a(e,t)}function $a(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===_a){if(null===e)throw Error(a(308));_a=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288;}else _a=_a.next=t;return n}var Da="undefined"!=typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n);}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()});};},Ma=t.unstable_scheduleCallback,Ra=t.unstable_NormalPriority,Fa={$$typeof:b,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ba(){return {controller:new Da,data:new Map,refCount:0}}function Ua(e){e.refCount--,0===e.refCount&&Ma(Ra,function(){e.controller.abort();});}var Ha=null,Va=0,qa=0,Wa=null;function Qa(){if(0===--Va&&null!==Ha){null!==Wa&&(Wa.status="fulfilled");var e=Ha;Ha=null,qa=0,Wa=null;for(var t=0;t<e.length;t++)(0, e[t])();}}var Ga=I.S;I.S=function(e,t){Ou=se(),"object"==typeof t&&null!==t&&"function"==typeof t.then&&function(e,t){if(null===Ha){var n=Ha=[];Va=0,qa=Vc(),Wa={status:"pending",value:void 0,then:function(e){n.push(e);}};}Va++,t.then(Qa,Qa);}(0,t),null!==Ga&&Ga(e,t);};var Ya=R(null);function Za(){var e=Ya.current;return null!==e?e:gu.pooledCache}function Ka(e,t){B(Ya,null===t?Ya.current:t.pool);}function Xa(){var e=Za();return null===e?null:{parent:Fa._currentValue,pool:e}}var Ja=Error(a(460)),el=Error(a(474)),tl=Error(a(542)),nl={then:function(){}};function rl(e){return "fulfilled"===(e=e.status)||"rejected"===e}function al(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Lt,Lt),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw sl(e=t.reason),e;default:if("string"==typeof t.status)t.then(Lt,Lt);else {if(null!==(e=gu)&&100<e.shellSuspendCounter)throw Error(a(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e;}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e;}});}switch(t.status){case"fulfilled":return t.value;case"rejected":throw sl(e=t.reason),e}throw ol=t,Ja}}function ll(e){try{return (0,e._init)(e._payload)}catch(e){if(null!==e&&"object"==typeof e&&"function"==typeof e.then)throw ol=e,Ja;throw e}}var ol=null;function il(){if(null===ol)throw Error(a(459));var e=ol;return ol=null,e}function sl(e){if(e===Ja||e===tl)throw Error(a(483))}var ul=null,cl=0;function fl(e){var t=cl;return cl+=1,null===ul&&(ul=[]),al(ul,e,t)}function dl(e,t){t=t.props.ref,e.ref=void 0!==t?t:null;}function pl(e,t){if(t.$$typeof===d)throw Error(a(525));throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function hl(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n);}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function l(e,t){return (e=Fr(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function i(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function s(e,t,n,r){return null===t||6!==t.tag?((t=Vr(n,e.mode,r)).return=e,t):((t=l(t,n)).return=e,t)}function u(e,t,n,r){var a=n.type;return a===m?f(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===S&&ll(a)===t.type)?(dl(t=l(t,n.props),n),t.return=e,t):(dl(t=Ur(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Wr(n,e.mode,r)).return=e,t):((t=l(t,n.children||[])).return=e,t)}function f(e,t,n,r,a){return null===t||7!==t.tag?((t=Hr(n,e.mode,r,a)).return=e,t):((t=l(t,n)).return=e,t)}function d(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t||"bigint"==typeof t)return (t=Vr(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case p:return dl(n=Ur(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case h:return (t=Wr(t,e.mode,n)).return=e,t;case S:return d(e,t=ll(t),n)}if(T(t)||j(t))return (t=Hr(t,e.mode,n,null)).return=e,t;if("function"==typeof t.then)return d(e,fl(t),n);if(t.$$typeof===b)return d(e,Oa(e,t),n);pl(e,t);}return null}function g(e,t,n,r){var a=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n||"bigint"==typeof n)return null!==a?null:s(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case p:return n.key===a?u(e,t,n,r):null;case h:return n.key===a?c(e,t,n,r):null;case S:return g(e,t,n=ll(n),r)}if(T(n)||j(n))return null!==a?null:f(e,t,n,r,null);if("function"==typeof n.then)return g(e,t,fl(n),r);if(n.$$typeof===b)return g(e,t,Oa(e,n),r);pl(e,n);}return null}function y(e,t,n,r,a){if("string"==typeof r&&""!==r||"number"==typeof r||"bigint"==typeof r)return s(t,e=e.get(n)||null,""+r,a);if("object"==typeof r&&null!==r){switch(r.$$typeof){case p:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case h:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case S:return y(e,t,n,r=ll(r),a)}if(T(r)||j(r))return f(t,e=e.get(n)||null,r,a,null);if("function"==typeof r.then)return y(e,t,n,fl(r),a);if(r.$$typeof===b)return y(e,t,n,Oa(t,r),a);pl(t,r);}return null}function v(s,u,c,f){if("object"==typeof c&&null!==c&&c.type===m&&null===c.key&&(c=c.props.children),"object"==typeof c&&null!==c){switch(c.$$typeof){case p:e:{for(var w=c.key;null!==u;){if(u.key===w){if((w=c.type)===m){if(7===u.tag){n(s,u.sibling),(f=l(u,c.props.children)).return=s,s=f;break e}}else if(u.elementType===w||"object"==typeof w&&null!==w&&w.$$typeof===S&&ll(w)===u.type){n(s,u.sibling),dl(f=l(u,c.props),c),f.return=s,s=f;break e}n(s,u);break}t(s,u),u=u.sibling;}c.type===m?((f=Hr(c.props.children,s.mode,f,c.key)).return=s,s=f):(dl(f=Ur(c.type,c.key,c.props,null,s.mode,f),c),f.return=s,s=f);}return i(s);case h:e:{for(w=c.key;null!==u;){if(u.key===w){if(4===u.tag&&u.stateNode.containerInfo===c.containerInfo&&u.stateNode.implementation===c.implementation){n(s,u.sibling),(f=l(u,c.children||[])).return=s,s=f;break e}n(s,u);break}t(s,u),u=u.sibling;}(f=Wr(c,s.mode,f)).return=s,s=f;}return i(s);case S:return v(s,u,c=ll(c),f)}if(T(c))return function(a,l,i,s){for(var u=null,c=null,f=l,p=l=0,h=null;null!==f&&p<i.length;p++){f.index>p?(h=f,f=null):h=f.sibling;var m=g(a,f,i[p],s);if(null===m){null===f&&(f=h);break}e&&f&&null===m.alternate&&t(a,f),l=o(m,l,p),null===c?u=m:c.sibling=m,c=m,f=h;}if(p===i.length)return n(a,f),fa&&aa(a,p),u;if(null===f){for(;p<i.length;p++)null!==(f=d(a,i[p],s))&&(l=o(f,l,p),null===c?u=f:c.sibling=f,c=f);return fa&&aa(a,p),u}for(f=r(f);p<i.length;p++)null!==(h=y(f,a,p,i[p],s))&&(e&&null!==h.alternate&&f.delete(null===h.key?p:h.key),l=o(h,l,p),null===c?u=h:c.sibling=h,c=h);return e&&f.forEach(function(e){return t(a,e)}),fa&&aa(a,p),u}(s,u,c,f);if(j(c)){if("function"!=typeof(w=j(c)))throw Error(a(150));return function(l,i,s,u){if(null==s)throw Error(a(151));for(var c=null,f=null,p=i,h=i=0,m=null,v=s.next();null!==p&&!v.done;h++,v=s.next()){p.index>h?(m=p,p=null):m=p.sibling;var b=g(l,p,v.value,u);if(null===b){null===p&&(p=m);break}e&&p&&null===b.alternate&&t(l,p),i=o(b,i,h),null===f?c=b:f.sibling=b,f=b,p=m;}if(v.done)return n(l,p),fa&&aa(l,h),c;if(null===p){for(;!v.done;h++,v=s.next())null!==(v=d(l,v.value,u))&&(i=o(v,i,h),null===f?c=v:f.sibling=v,f=v);return fa&&aa(l,h),c}for(p=r(p);!v.done;h++,v=s.next())null!==(v=y(p,l,h,v.value,u))&&(e&&null!==v.alternate&&p.delete(null===v.key?h:v.key),i=o(v,i,h),null===f?c=v:f.sibling=v,f=v);return e&&p.forEach(function(e){return t(l,e)}),fa&&aa(l,h),c}(s,u,c=w.call(c),f)}if("function"==typeof c.then)return v(s,u,fl(c),f);if(c.$$typeof===b)return v(s,u,Oa(s,c),f);pl(s,c);}return "string"==typeof c&&""!==c||"number"==typeof c||"bigint"==typeof c?(c=""+c,null!==u&&6===u.tag?(n(s,u.sibling),(f=l(u,c)).return=s,s=f):(n(s,u),(f=Vr(c,s.mode,f)).return=s,s=f),i(s)):n(s,u)}return function(e,t,n,r){try{cl=0;var a=v(e,t,n,r);return ul=null,a}catch(t){if(t===Ja||t===tl)throw t;var l=Mr(29,t,null,e.mode);return l.lanes=r,l.return=e,l}}}var ml=hl(!0),gl=hl(!1),yl=!1;function vl(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null};}function bl(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null});}function wl(e){return {lane:e,tag:0,payload:null,callback:null,next:null}}function kl(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,2&mu){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,t=Or(e),Ir(e,null,n),t}return zr(e,r,t,n),Or(e)}function Cl(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ie(e,n);}}function xl(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,l=null;if(null!==(n=n.firstBaseUpdate)){do{var o={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===l?a=l=o:l=l.next=o,n=n.next;}while(null!==n);null===l?a=l=t:l=l.next=t;}else a=l=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:l,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t;}var Sl=!1;function El(){if(Sl&&null!==Wa)throw Wa}function _l(e,t,n,r){Sl=!1;var a=e.updateQueue;yl=!1;var l=a.firstBaseUpdate,o=a.lastBaseUpdate,i=a.shared.pending;if(null!==i){a.shared.pending=null;var s=i,u=s.next;s.next=null,null===o?l=u:o.next=u,o=s;var c=e.alternate;null!==c&&(i=(c=c.updateQueue).lastBaseUpdate)!==o&&(null===i?c.firstBaseUpdate=u:i.next=u,c.lastBaseUpdate=s);}if(null!==l){var d=a.baseState;for(o=0,c=u=s=null,i=l;;){var p=-536870913&i.lane,h=p!==i.lane;if(h?(vu&p)===p:(r&p)===p){0!==p&&p===qa&&(Sl=!0),null!==c&&(c=c.next={lane:0,tag:i.tag,payload:i.payload,callback:null,next:null});e:{var m=e,g=i;p=t;var y=n;switch(g.tag){case 1:if("function"==typeof(m=g.payload)){d=m.call(y,d,p);break e}d=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null==(p="function"==typeof(m=g.payload)?m.call(y,d,p):m))break e;d=f({},d,p);break e;case 2:yl=!0;}}null!==(p=i.callback)&&(e.flags|=64,h&&(e.flags|=8192),null===(h=a.callbacks)?a.callbacks=[p]:h.push(p));}else h={lane:p,tag:i.tag,payload:i.payload,callback:i.callback,next:null},null===c?(u=c=h,s=d):c=c.next=h,o|=p;if(null===(i=i.next)){if(null===(i=a.shared.pending))break;i=(h=i).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null;}}null===c&&(s=d),a.baseState=s,a.firstBaseUpdate=u,a.lastBaseUpdate=c,null===l&&(a.shared.lanes=0),_u|=o,e.lanes=o,e.memoizedState=d;}}function Al(e,t){if("function"!=typeof e)throw Error(a(191,e));e.call(t);}function Pl(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)Al(n[e],t);}var jl=R(null),Nl=R(0);function zl(e,t){B(Nl,e=Su),B(jl,t),Su=e|t.baseLanes;}function Ll(){B(Nl,Su),B(jl,jl.current);}function Tl(){Su=Nl.current,F(jl),F(Nl);}var Il=R(null),Ol=null;function $l(e){var t=e.alternate;B(Bl,1&Bl.current),B(Il,e),null===Ol&&(null===t||null!==jl.current||null!==t.memoizedState)&&(Ol=e);}function Dl(e){B(Bl,Bl.current),B(Il,e),null===Ol&&(Ol=e);}function Ml(e){22===e.tag?(B(Bl,Bl.current),B(Il,e),null===Ol&&(Ol=e)):Rl();}function Rl(){B(Bl,Bl.current),B(Il,Il.current);}function Fl(e){F(Il),Ol===e&&(Ol=null),F(Bl);}var Bl=R(0);function Ul(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||If(n)||Of(n)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(128&t.flags)return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return;}t.sibling.return=t.return,t=t.sibling;}return null}var Hl=0,Vl=null,ql=null,Wl=null,Ql=!1,Gl=!1,Yl=!1,Zl=0,Kl=0,Xl=null,Jl=0;function eo(){throw Error(a(321))}function to(e,t){if(null===t)return !1;for(var n=0;n<t.length&&n<e.length;n++)if(!Xn(e[n],t[n]))return !1;return !0}function no(e,t,n,r,a,l){return Hl=l,Vl=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,I.H=null===e||null===e.memoizedState?vi:bi,Yl=!1,l=n(r,a),Yl=!1,Gl&&(l=ao(t,n,r,a)),ro(e),l}function ro(e){I.H=yi;var t=null!==ql&&null!==ql.next;if(Hl=0,Wl=ql=Vl=null,Ql=!1,Kl=0,Xl=null,t)throw Error(a(300));null===e||Oi||null!==(e=e.dependencies)&&La(e)&&(Oi=!0);}function ao(e,t,n,r){Vl=e;var l=0;do{if(Gl&&(Xl=null),Kl=0,Gl=!1,25<=l)throw Error(a(301));if(l+=1,Wl=ql=null,null!=e.updateQueue){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,null!=o.memoCache&&(o.memoCache.index=0);}I.H=wi,o=t(n,r);}while(Gl);return o}function lo(){var e=I.H,t=e.useState()[0];return t="function"==typeof t.then?fo(t):t,e=e.useState()[0],(null!==ql?ql.memoizedState:null)!==e&&(Vl.flags|=1024),t}function oo(){var e=0!==Zl;return Zl=0,e}function io(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n;}function so(e){if(Ql){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next;}Ql=!1;}Hl=0,Wl=ql=Vl=null,Gl=!1,Kl=Zl=0,Xl=null;}function uo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Wl?Vl.memoizedState=Wl=e:Wl=Wl.next=e,Wl}function co(){if(null===ql){var e=Vl.alternate;e=null!==e?e.memoizedState:null;}else e=ql.next;var t=null===Wl?Vl.memoizedState:Wl.next;if(null!==t)Wl=t,ql=e;else {if(null===e){if(null===Vl.alternate)throw Error(a(467));throw Error(a(310))}e={memoizedState:(ql=e).memoizedState,baseState:ql.baseState,baseQueue:ql.baseQueue,queue:ql.queue,next:null},null===Wl?Vl.memoizedState=Wl=e:Wl=Wl.next=e;}return Wl}function fo(e){var t=Kl;return Kl+=1,null===Xl&&(Xl=[]),e=al(Xl,e,t),t=Vl,null===(null===Wl?t.memoizedState:Wl.next)&&(t=t.alternate,I.H=null===t||null===t.memoizedState?vi:bi),e}function po(e){if(null!==e&&"object"==typeof e){if("function"==typeof e.then)return fo(e);if(e.$$typeof===b)return Ia(e)}throw Error(a(438,String(e)))}function ho(e){var t=null,n=Vl.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=Vl.alternate;null!==r&&null!==(r=r.updateQueue)&&null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0});}if(t??={data:[],index:0},null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},Vl.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=_;return t.index++,n}function mo(e,t){return "function"==typeof t?t(e):t}function go(e){return yo(co(),ql,e)}function yo(e,t,n){var r=e.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=n;var l=e.baseQueue,o=r.pending;if(null!==o){if(null!==l){var i=l.next;l.next=o.next,o.next=i;}t.baseQueue=l=o,r.pending=null;}if(o=e.baseState,null===l)e.memoizedState=o;else {var s=i=null,u=null,c=t=l.next,f=!1;do{var d=-536870913&c.lane;if(d!==c.lane?(vu&d)===d:(Hl&d)===d){var p=c.revertLane;if(0===p)null!==u&&(u=u.next={lane:0,revertLane:0,gesture:null,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),d===qa&&(f=!0);else {if((Hl&p)===p){c=c.next,p===qa&&(f=!0);continue}d={lane:0,revertLane:c.revertLane,gesture:null,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},null===u?(s=u=d,i=o):u=u.next=d,Vl.lanes|=p,_u|=p;}d=c.action,Yl&&n(o,d),o=c.hasEagerState?c.eagerState:n(o,d);}else p={lane:d,revertLane:c.revertLane,gesture:c.gesture,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},null===u?(s=u=p,i=o):u=u.next=p,Vl.lanes|=d,_u|=d;c=c.next;}while(null!==c&&c!==t);if(null===u?i=o:u.next=s,!Xn(o,e.memoizedState)&&(Oi=!0,f&&null!==(n=Wa)))throw n;e.memoizedState=o,e.baseState=i,e.baseQueue=u,r.lastRenderedState=o;}return null===l&&(r.lanes=0),[e.memoizedState,r.dispatch]}function vo(e){var t=co(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,l=n.pending,o=t.memoizedState;if(null!==l){n.pending=null;var i=l=l.next;do{o=e(o,i.action),i=i.next;}while(i!==l);Xn(o,t.memoizedState)||(Oi=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o;}return [o,r]}function bo(e,t,n){var r=Vl,l=co(),o=fa;if(o){if(void 0===n)throw Error(a(407));n=n();}else n=t();var i=!Xn((ql||l).memoizedState,n);if(i&&(l.memoizedState=n,Oi=!0),l=l.queue,Vo(Co.bind(null,r,l,e),[e]),l.getSnapshot!==t||i||null!==Wl&&1&Wl.memoizedState.tag){if(r.flags|=2048,Ro(9,{destroy:void 0},ko.bind(null,r,l,n,t),null),null===gu)throw Error(a(349));o||127&Hl||wo(r,t,n);}return n}function wo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Vl.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Vl.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e);}function ko(e,t,n,r){t.value=n,t.getSnapshot=r,xo(t)&&So(e);}function Co(e,t,n){return n(function(){xo(t)&&So(e);})}function xo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return !Xn(e,n)}catch(e){return !0}}function So(e){var t=Tr(e,2);null!==t&&Zu(t,0,2);}function Eo(e){var t=uo();if("function"==typeof e){var n=e;if(e=n(),Yl){be(!0);try{n();}finally{be(!1);}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mo,lastRenderedState:e},t}function _o(e,t,n,r){return e.baseState=n,yo(e,ql,"function"==typeof r?r:mo)}function Ao(e,t,n,r,l){if(hi(e))throw Error(a(485));if(null!==(e=t.action)){var o={payload:l,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){o.listeners.push(e);}};null!==I.T?n(!0):o.isTransition=!1,r(o),null===(n=t.pending)?(o.next=t.pending=o,Po(t,o)):(o.next=n.next,t.pending=n.next=o);}}function Po(e,t){var n=t.action,r=t.payload,a=e.state;if(t.isTransition){var l=I.T,o={};I.T=o;try{var i=n(a,r),s=I.S;null!==s&&s(o,i),jo(e,t,i);}catch(n){zo(e,t,n);}finally{null!==l&&null!==o.types&&(l.types=o.types),I.T=l;}}else try{jo(e,t,l=n(a,r));}catch(n){zo(e,t,n);}}function jo(e,t,n){null!==n&&"object"==typeof n&&"function"==typeof n.then?n.then(function(n){No(e,t,n);},function(n){return zo(e,t,n)}):No(e,t,n);}function No(e,t,n){t.status="fulfilled",t.value=n,Lo(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,Po(e,n)));}function zo(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,Lo(t),t=t.next;}while(t!==r)}e.action=null;}function Lo(e){e=e.listeners;for(var t=0;t<e.length;t++)(0, e[t])();}function To(e,t){return t}function Io(e,t){if(fa){var n=gu.formState;if(null!==n){e:{var r=Vl;if(fa){if(ca){t:{for(var a=ca,l=pa;8!==a.nodeType;){if(!l){a=null;break t}if(null===(a=$f(a.nextSibling))){a=null;break t}}a="F!"===(l=a.data)||"F"===l?a:null;}if(a){ca=$f(a.nextSibling),r="F!"===a.data;break e}}ma(r);}r=!1;}r&&(t=n[0]);}}return (n=uo()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:To,lastRenderedState:t},n.queue=r,n=fi.bind(null,Vl,r),r.dispatch=n,r=Eo(!1),l=pi.bind(null,Vl,!1,r.queue),a={state:t,dispatch:null,action:e,pending:null},(r=uo()).queue=a,n=Ao.bind(null,Vl,a,l,n),a.dispatch=n,r.memoizedState=e,[t,n,!1]}function Oo(e){return $o(co(),ql,e)}function $o(e,t,n){if(t=yo(e,t,To)[0],e=go(mo)[0],"object"==typeof t&&null!==t&&"function"==typeof t.then)try{var r=fo(t);}catch(e){if(e===Ja)throw tl;throw e}else r=t;var a=(t=co()).queue,l=a.dispatch;return n!==t.memoizedState&&(Vl.flags|=2048,Ro(9,{destroy:void 0},Do.bind(null,a,n),null)),[r,l,e]}function Do(e,t){e.action=t;}function Mo(e){var t=co(),n=ql;if(null!==n)return $o(t,n,e);co(),t=t.memoizedState;var r=(n=co()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function Ro(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=Vl.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Vl.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Fo(){return co().memoizedState}function Bo(e,t,n,r){var a=uo();Vl.flags|=e,a.memoizedState=Ro(1|t,{destroy:void 0},n,void 0===r?null:r);}function Uo(e,t,n,r){var a=co();r=void 0===r?null:r;var l=a.memoizedState.inst;null!==ql&&null!==r&&to(r,ql.memoizedState.deps)?a.memoizedState=Ro(t,l,n,r):(Vl.flags|=e,a.memoizedState=Ro(1|t,l,n,r));}function Ho(e,t){Bo(8390656,8,e,t);}function Vo(e,t){Uo(2048,8,e,t);}function qo(e){var t=co().memoizedState;return function(e){Vl.flags|=4;var t=Vl.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},Vl.updateQueue=t,t.events=[e];else {var n=t.events;null===n?t.events=[e]:n.push(e);}}({ref:t,nextImpl:e}),function(){if(2&mu)throw Error(a(440));return t.impl.apply(void 0,arguments)}}function Wo(e,t){return Uo(4,2,e,t)}function Qo(e,t){return Uo(4,4,e,t)}function Go(e,t){if("function"==typeof t){e=e();var n=t(e);return function(){"function"==typeof n?n():t(null);}}if(null!=t)return e=e(),t.current=e,function(){t.current=null;}}function Yo(e,t,n){n=null!=n?n.concat([e]):null,Uo(4,4,Go.bind(null,t,e),n);}function Zo(){}function Ko(e,t){var n=co();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&to(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Xo(e,t){var n=co();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&to(t,r[1]))return r[0];if(r=e(),Yl){be(!0);try{e();}finally{be(!1);}}return n.memoizedState=[r,t],r}function Jo(e,t,n){return void 0===n||1073741824&Hl&&!(261930&vu)?e.memoizedState=t:(e.memoizedState=n,e=Yu(),Vl.lanes|=e,_u|=e,n)}function ei(e,t,n,r){return Xn(n,t)?n:null!==jl.current?(e=Jo(e,n,r),Xn(e,t)||(Oi=!0),e):42&Hl&&(!(1073741824&Hl)||261930&vu)?(e=Yu(),Vl.lanes|=e,_u|=e,t):(Oi=!0,e.memoizedState=n)}function ti(e,t,n,r,a){var l=O.p;O.p=0!==l&&8>l?l:8;var o,i,s,u=I.T,c={};I.T=c,pi(e,!1,t,n);try{var f=a(),d=I.S;null!==d&&d(c,f),null!==f&&"object"==typeof f&&"function"==typeof f.then?di(e,t,(o=r,i=[],s={status:"pending",value:null,reason:null,then:function(e){i.push(e);}},f.then(function(){s.status="fulfilled",s.value=o;for(var e=0;e<i.length;e++)(0,i[e])(o);},function(e){for(s.status="rejected",s.reason=e,e=0;e<i.length;e++)(0,i[e])(void 0);}),s),Gu()):di(e,t,r,Gu());}catch(n){di(e,t,{then:function(){},status:"rejected",reason:n},Gu());}finally{O.p=l,null!==u&&null!==c.types&&(u.types=c.types),I.T=u;}}function ni(){}function ri(e,t,n,r){if(5!==e.tag)throw Error(a(476));var l=ai(e).queue;ti(e,l,t,$,null===n?ni:function(){return li(e),n(r)});}function ai(e){var t=e.memoizedState;if(null!==t)return t;var n={};return (t={memoizedState:$,baseState:$,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mo,lastRenderedState:$},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mo,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function li(e){var t=ai(e);null===t.next&&(t=e.alternate.memoizedState),di(e,t.next.queue,{},Gu());}function oi(){return Ia(pd)}function ii(){return co().memoizedState}function si(){return co().memoizedState}function ui(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Gu(),r=kl(t,e=wl(n),n);return null!==r&&(Zu(r,0,n),Cl(r,t,n)),t={cache:Ba()},void(e.payload=t)}t=t.return;}}function ci(e,t,n){var r=Gu();n={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},hi(e)?mi(t,n):null!==(n=Lr(e,t,n,r))&&(Zu(n,0,r),gi(n,t,r));}function fi(e,t,n){di(e,t,n,Gu());}function di(e,t,n,r){var a={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(hi(e))mi(t,a);else {var l=e.alternate;if(0===e.lanes&&(null===l||0===l.lanes)&&null!==(l=t.lastRenderedReducer))try{var o=t.lastRenderedState,i=l(o,n);if(a.hasEagerState=!0,a.eagerState=i,Xn(i,o))return zr(e,t,a,0),null===gu&&Nr(),!1}catch(e){}if(null!==(n=Lr(e,t,a,r)))return Zu(n,0,r),gi(n,t,r),!0}return !1}function pi(e,t,n,r){if(r={lane:2,revertLane:Vc(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},hi(e)){if(t)throw Error(a(479))}else null!==(t=Lr(e,n,r,2))&&Zu(t,0,2);}function hi(e){var t=e.alternate;return e===Vl||null!==t&&t===Vl}function mi(e,t){Gl=Ql=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t;}function gi(e,t,n){if(4194048&n){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ie(e,n);}}var yi={readContext:Ia,use:po,useCallback:eo,useContext:eo,useEffect:eo,useImperativeHandle:eo,useLayoutEffect:eo,useInsertionEffect:eo,useMemo:eo,useReducer:eo,useRef:eo,useState:eo,useDebugValue:eo,useDeferredValue:eo,useTransition:eo,useSyncExternalStore:eo,useId:eo,useHostTransitionStatus:eo,useFormState:eo,useActionState:eo,useOptimistic:eo,useMemoCache:eo,useCacheRefresh:eo};yi.useEffectEvent=eo;var vi={readContext:Ia,use:po,useCallback:function(e,t){return uo().memoizedState=[e,void 0===t?null:t],e},useContext:Ia,useEffect:Ho,useImperativeHandle:function(e,t,n){n=null!=n?n.concat([e]):null,Bo(4194308,4,Go.bind(null,t,e),n);},useLayoutEffect:function(e,t){return Bo(4194308,4,e,t)},useInsertionEffect:function(e,t){Bo(4,2,e,t);},useMemo:function(e,t){var n=uo();t=void 0===t?null:t;var r=e();if(Yl){be(!0);try{e();}finally{be(!1);}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=uo();if(void 0!==n){var a=n(t);if(Yl){be(!0);try{n(t);}finally{be(!1);}}}else a=t;return r.memoizedState=r.baseState=a,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},r.queue=e,e=e.dispatch=ci.bind(null,Vl,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},uo().memoizedState=e},useState:function(e){var t=(e=Eo(e)).queue,n=fi.bind(null,Vl,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Zo,useDeferredValue:function(e,t){return Jo(uo(),e,t)},useTransition:function(){var e=Eo(!1);return e=ti.bind(null,Vl,e.queue,!0,!1),uo().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=Vl,l=uo();if(fa){if(void 0===n)throw Error(a(407));n=n();}else {if(n=t(),null===gu)throw Error(a(349));127&vu||wo(r,t,n);}l.memoizedState=n;var o={value:n,getSnapshot:t};return l.queue=o,Ho(Co.bind(null,r,o,e),[e]),r.flags|=2048,Ro(9,{destroy:void 0},ko.bind(null,r,o,n,t),null),n},useId:function(){var e=uo(),t=gu.identifierPrefix;if(fa){var n=ra;t="_"+t+"R_"+(n=(na&~(1<<32-we(na)-1)).toString(32)+n),0<(n=Zl++)&&(t+="H"+n.toString(32)),t+="_";}else t="_"+t+"r_"+(n=Jl++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:oi,useFormState:Io,useActionState:Io,useOptimistic:function(e){var t=uo();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=pi.bind(null,Vl,!0,n),n.dispatch=t,[e,t]},useMemoCache:ho,useCacheRefresh:function(){return uo().memoizedState=ui.bind(null,Vl)},useEffectEvent:function(e){var t=uo(),n={impl:e};return t.memoizedState=n,function(){if(2&mu)throw Error(a(440));return n.impl.apply(void 0,arguments)}}},bi={readContext:Ia,use:po,useCallback:Ko,useContext:Ia,useEffect:Vo,useImperativeHandle:Yo,useInsertionEffect:Wo,useLayoutEffect:Qo,useMemo:Xo,useReducer:go,useRef:Fo,useState:function(){return go(mo)},useDebugValue:Zo,useDeferredValue:function(e,t){return ei(co(),ql.memoizedState,e,t)},useTransition:function(){var e=go(mo)[0],t=co().memoizedState;return ["boolean"==typeof e?e:fo(e),t]},useSyncExternalStore:bo,useId:ii,useHostTransitionStatus:oi,useFormState:Oo,useActionState:Oo,useOptimistic:function(e,t){return _o(co(),0,e,t)},useMemoCache:ho,useCacheRefresh:si};bi.useEffectEvent=qo;var wi={readContext:Ia,use:po,useCallback:Ko,useContext:Ia,useEffect:Vo,useImperativeHandle:Yo,useInsertionEffect:Wo,useLayoutEffect:Qo,useMemo:Xo,useReducer:vo,useRef:Fo,useState:function(){return vo(mo)},useDebugValue:Zo,useDeferredValue:function(e,t){var n=co();return null===ql?Jo(n,e,t):ei(n,ql.memoizedState,e,t)},useTransition:function(){var e=vo(mo)[0],t=co().memoizedState;return ["boolean"==typeof e?e:fo(e),t]},useSyncExternalStore:bo,useId:ii,useHostTransitionStatus:oi,useFormState:Mo,useActionState:Mo,useOptimistic:function(e,t){var n=co();return null!==ql?_o(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:ho,useCacheRefresh:si};function ki(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:f({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n);}wi.useEffectEvent=qo;var Ci={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Gu(),a=wl(r);a.payload=t,null!=n&&(a.callback=n),null!==(t=kl(e,a,r))&&(Zu(t,0,r),Cl(t,e,r));},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Gu(),a=wl(r);a.tag=1,a.payload=t,null!=n&&(a.callback=n),null!==(t=kl(e,a,r))&&(Zu(t,0,r),Cl(t,e,r));},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Gu(),r=wl(n);r.tag=2,null!=t&&(r.callback=t),null!==(t=kl(e,r,n))&&(Zu(t,0,n),Cl(t,e,n));}};function xi(e,t,n,r,a,l,o){return "function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,l,o):!(t.prototype&&t.prototype.isPureReactComponent&&Jn(n,r)&&Jn(a,l))}function Si(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ci.enqueueReplaceState(t,t.state,null);}function Ei(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var a in n===t&&(n=f({},n)),e)void 0===n[a]&&(n[a]=e[a]);return n}function _i(e){_r(e);}function Ai(e){console.error(e);}function Pi(e){_r(e);}function ji(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack});}catch(e){setTimeout(function(){throw e});}}function Ni(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null});}catch(e){setTimeout(function(){throw e});}}function zi(e,t,n){return (n=wl(n)).tag=3,n.payload={element:null},n.callback=function(){ji(e,t);},n}function Li(e){return (e=wl(e)).tag=3,e}function Ti(e,t,n,r){var a=n.type.getDerivedStateFromError;if("function"==typeof a){var l=r.value;e.payload=function(){return a(l)},e.callback=function(){Ni(t,n,r);};}var o=n.stateNode;null!==o&&"function"==typeof o.componentDidCatch&&(e.callback=function(){Ni(t,n,r),"function"!=typeof a&&(null===Mu?Mu=new Set([this]):Mu.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""});});}var Ii=Error(a(461)),Oi=!1;function $i(e,t,n,r){t.child=null===e?gl(t,null,n,r):ml(t,e.child,n,r);}function Di(e,t,n,r,a){n=n.render;var l=t.ref;if("ref"in r){var o={};for(var i in r)"ref"!==i&&(o[i]=r[i]);}else o=r;return Ta(t),r=no(e,t,n,o,l,a),i=oo(),null===e||Oi?(fa&&i&&oa(t),t.flags|=1,$i(e,t,r,a),t.child):(io(e,t,a),os(e,t,a))}function Mi(e,t,n,r,a){if(null===e){var l=n.type;return "function"!=typeof l||Rr(l)||void 0!==l.defaultProps||null!==n.compare?((e=Ur(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=l,Ri(e,t,l,r,a))}if(l=e.child,!is(e,a)){var o=l.memoizedProps;if((n=null!==(n=n.compare)?n:Jn)(o,r)&&e.ref===t.ref)return os(e,t,a)}return t.flags|=1,(e=Fr(l,r)).ref=t.ref,e.return=t,t.child=e}function Ri(e,t,n,r,a){if(null!==e){var l=e.memoizedProps;if(Jn(l,r)&&e.ref===t.ref){if(Oi=!1,t.pendingProps=r=l,!is(e,a))return t.lanes=e.lanes,os(e,t,a);131072&e.flags&&(Oi=!0);}}return Wi(e,t,n,r,a)}function Fi(e,t,n,r){var a=r.children,l=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===r.mode){if(128&t.flags){if(l=null!==l?l.baseLanes|n:n,null!==e){for(r=t.child=e.child,a=0;null!==r;)a=a|r.lanes|r.childLanes,r=r.sibling;r=a&~l;}else r=0,t.child=null;return Ui(e,t,l,n,r)}if(!(536870912&n))return r=t.lanes=536870912,Ui(e,t,null!==l?l.baseLanes|n:n,n,r);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Ka(0,null!==l?l.cachePool:null),null!==l?zl(t,l):Ll(),Ml(t);}else null!==l?(Ka(0,l.cachePool),zl(t,l),Rl(),t.memoizedState=null):(null!==e&&Ka(0,null),Ll(),Rl());return $i(e,t,a,n),t.child}function Bi(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Ui(e,t,n,r,a){var l=Za();return l=null===l?null:{parent:Fa._currentValue,pool:l},t.memoizedState={baseLanes:n,cachePool:l},null!==e&&Ka(0,null),Ll(),Ml(t),null!==e&&za(e,t,r,!0),t.childLanes=a,null}function Hi(e,t){return (t=ts({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function Vi(e,t,n){return ml(t,e.child,null,n),(e=Hi(t,t.pendingProps)).flags|=2,Fl(t),t.memoizedState=null,e}function qi(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else {if("function"!=typeof n&&"object"!=typeof n)throw Error(a(284));null!==e&&e.ref===n||(t.flags|=4194816);}}function Wi(e,t,n,r,a){return Ta(t),n=no(e,t,n,r,void 0,a),r=oo(),null===e||Oi?(fa&&r&&oa(t),t.flags|=1,$i(e,t,n,a),t.child):(io(e,t,a),os(e,t,a))}function Qi(e,t,n,r,a,l){return Ta(t),t.updateQueue=null,n=ao(t,r,n,a),ro(e),r=oo(),null===e||Oi?(fa&&r&&oa(t),t.flags|=1,$i(e,t,n,l),t.child):(io(e,t,l),os(e,t,l))}function Gi(e,t,n,r,a){if(Ta(t),null===t.stateNode){var l=$r,o=n.contextType;"object"==typeof o&&null!==o&&(l=Ia(o)),l=new n(r,l),t.memoizedState=null!==l.state&&void 0!==l.state?l.state:null,l.updater=Ci,t.stateNode=l,l._reactInternals=t,(l=t.stateNode).props=r,l.state=t.memoizedState,l.refs={},vl(t),o=n.contextType,l.context="object"==typeof o&&null!==o?Ia(o):$r,l.state=t.memoizedState,"function"==typeof(o=n.getDerivedStateFromProps)&&(ki(t,n,o,r),l.state=t.memoizedState),"function"==typeof n.getDerivedStateFromProps||"function"==typeof l.getSnapshotBeforeUpdate||"function"!=typeof l.UNSAFE_componentWillMount&&"function"!=typeof l.componentWillMount||(o=l.state,"function"==typeof l.componentWillMount&&l.componentWillMount(),"function"==typeof l.UNSAFE_componentWillMount&&l.UNSAFE_componentWillMount(),o!==l.state&&Ci.enqueueReplaceState(l,l.state,null),_l(t,r,l,a),El(),l.state=t.memoizedState),"function"==typeof l.componentDidMount&&(t.flags|=4194308),r=!0;}else if(null===e){l=t.stateNode;var i=t.memoizedProps,s=Ei(n,i);l.props=s;var u=l.context,c=n.contextType;o=$r,"object"==typeof c&&null!==c&&(o=Ia(c));var f=n.getDerivedStateFromProps;c="function"==typeof f||"function"==typeof l.getSnapshotBeforeUpdate,i=t.pendingProps!==i,c||"function"!=typeof l.UNSAFE_componentWillReceiveProps&&"function"!=typeof l.componentWillReceiveProps||(i||u!==o)&&Si(t,l,r,o),yl=!1;var d=t.memoizedState;l.state=d,_l(t,r,l,a),El(),u=t.memoizedState,i||d!==u||yl?("function"==typeof f&&(ki(t,n,f,r),u=t.memoizedState),(s=yl||xi(t,n,s,r,d,u,o))?(c||"function"!=typeof l.UNSAFE_componentWillMount&&"function"!=typeof l.componentWillMount||("function"==typeof l.componentWillMount&&l.componentWillMount(),"function"==typeof l.UNSAFE_componentWillMount&&l.UNSAFE_componentWillMount()),"function"==typeof l.componentDidMount&&(t.flags|=4194308)):("function"==typeof l.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),l.props=r,l.state=u,l.context=o,r=s):("function"==typeof l.componentDidMount&&(t.flags|=4194308),r=!1);}else {l=t.stateNode,bl(e,t),c=Ei(n,o=t.memoizedProps),l.props=c,f=t.pendingProps,d=l.context,u=n.contextType,s=$r,"object"==typeof u&&null!==u&&(s=Ia(u)),(u="function"==typeof(i=n.getDerivedStateFromProps)||"function"==typeof l.getSnapshotBeforeUpdate)||"function"!=typeof l.UNSAFE_componentWillReceiveProps&&"function"!=typeof l.componentWillReceiveProps||(o!==f||d!==s)&&Si(t,l,r,s),yl=!1,d=t.memoizedState,l.state=d,_l(t,r,l,a),El();var p=t.memoizedState;o!==f||d!==p||yl||null!==e&&null!==e.dependencies&&La(e.dependencies)?("function"==typeof i&&(ki(t,n,i,r),p=t.memoizedState),(c=yl||xi(t,n,c,r,d,p,s)||null!==e&&null!==e.dependencies&&La(e.dependencies))?(u||"function"!=typeof l.UNSAFE_componentWillUpdate&&"function"!=typeof l.componentWillUpdate||("function"==typeof l.componentWillUpdate&&l.componentWillUpdate(r,p,s),"function"==typeof l.UNSAFE_componentWillUpdate&&l.UNSAFE_componentWillUpdate(r,p,s)),"function"==typeof l.componentDidUpdate&&(t.flags|=4),"function"==typeof l.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof l.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof l.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),l.props=r,l.state=p,l.context=s,r=c):("function"!=typeof l.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof l.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1);}return l=r,qi(e,t),r=!!(128&t.flags),l||r?(l=t.stateNode,n=r&&"function"!=typeof n.getDerivedStateFromError?null:l.render(),t.flags|=1,null!==e&&r?(t.child=ml(t,e.child,null,a),t.child=ml(t,null,n,a)):$i(e,t,n,a),t.memoizedState=l.state,e=t.child):e=os(e,t,a),e}function Yi(e,t,n,r){return ka(),t.flags|=256,$i(e,t,n,r),t.child}var Zi={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ki(e){return {baseLanes:e,cachePool:Xa()}}function Xi(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=ju),e}function Ji(e,t,n){var r,l=t.pendingProps,o=!1,i=!!(128&t.flags);if((r=i)||(r=(null===e||null!==e.memoizedState)&&!!(2&Bl.current)),r&&(o=!0,t.flags&=-129),r=!!(32&t.flags),t.flags&=-33,null===e){if(fa){if(o?$l(t):Rl(),(e=ca)?null!==(e=null!==(e=Tf(e,pa))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ta?{id:na,overflow:ra}:null,retryLane:536870912,hydrationErrors:null},(n=qr(e)).return=t,t.child=n,ua=t,ca=null):e=null,null===e)throw ma(t);return Of(e)?t.lanes=32:t.lanes=536870912,null}var s=l.children;return l=l.fallback,o?(Rl(),s=ts({mode:"hidden",children:s},o=t.mode),l=Hr(l,o,n,null),s.return=t,l.return=t,s.sibling=l,t.child=s,(l=t.child).memoizedState=Ki(n),l.childLanes=Xi(e,r,n),t.memoizedState=Zi,Bi(null,l)):($l(t),es(t,s))}var u=e.memoizedState;if(null!==u&&null!==(s=u.dehydrated)){if(i)256&t.flags?($l(t),t.flags&=-257,t=ns(e,t,n)):null!==t.memoizedState?(Rl(),t.child=e.child,t.flags|=128,t=null):(Rl(),s=l.fallback,o=t.mode,l=ts({mode:"visible",children:l.children},o),(s=Hr(s,o,n,null)).flags|=2,l.return=t,s.return=t,l.sibling=s,t.child=l,ml(t,e.child,null,n),(l=t.child).memoizedState=Ki(n),l.childLanes=Xi(e,r,n),t.memoizedState=Zi,t=Bi(null,l));else if($l(t),Of(s)){if(r=s.nextSibling&&s.nextSibling.dataset)var c=r.dgst;r=c,(l=Error(a(419))).stack="",l.digest=r,xa({value:l,source:null,stack:null}),t=ns(e,t,n);}else if(Oi||za(e,t,n,!1),r=0!==(n&e.childLanes),Oi||r){if(null!==(r=gu)&&0!==(l=Oe(r,n))&&l!==u.retryLane)throw u.retryLane=l,Tr(e,l),Zu(r,0,l),Ii;If(s)||sc(),t=ns(e,t,n);}else If(s)?(t.flags|=192,t.child=e.child,t=null):(e=u.treeContext,ca=$f(s.nextSibling),ua=t,fa=!0,da=null,pa=!1,null!==e&&sa(t,e),(t=es(t,l.children)).flags|=4096);return t}return o?(Rl(),s=l.fallback,o=t.mode,c=(u=e.child).sibling,(l=Fr(u,{mode:"hidden",children:l.children})).subtreeFlags=65011712&u.subtreeFlags,null!==c?s=Fr(c,s):(s=Hr(s,o,n,null)).flags|=2,s.return=t,l.return=t,l.sibling=s,t.child=l,Bi(null,l),l=t.child,null===(s=e.child.memoizedState)?s=Ki(n):(null!==(o=s.cachePool)?(u=Fa._currentValue,o=o.parent!==u?{parent:u,pool:u}:o):o=Xa(),s={baseLanes:s.baseLanes|n,cachePool:o}),l.memoizedState=s,l.childLanes=Xi(e,r,n),t.memoizedState=Zi,Bi(e.child,l)):($l(t),e=(n=e.child).sibling,(n=Fr(n,{mode:"visible",children:l.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function es(e,t){return (t=ts({mode:"visible",children:t},e.mode)).return=e,e.child=t}function ts(e,t){return (e=Mr(22,e,null,t)).lanes=0,e}function ns(e,t,n){return ml(t,e.child,null,n),(e=es(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function rs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ja(e.return,t,n);}function as(e,t,n,r,a,l){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a,treeForkCount:l}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=a,o.treeForkCount=l);}function ls(e,t,n){var r=t.pendingProps,a=r.revealOrder,l=r.tail;r=r.children;var o=Bl.current,i=!!(2&o);if(i?(o=1&o|2,t.flags|=128):o&=1,B(Bl,o),$i(e,t,r,n),r=fa?Xr:0,!i&&null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&rs(e,n,t);else if(19===e.tag)rs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return;}e.sibling.return=e.return,e=e.sibling;}switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===Ul(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),as(t,!1,a,n,l,r);break;case"backwards":case"unstable_legacy-backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===Ul(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e;}as(t,!0,n,null,l,r);break;case"together":as(t,!1,null,null,void 0,r);break;default:t.memoizedState=null;}return t.child}function os(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),_u|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(za(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Fr(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Fr(e,e.pendingProps)).return=t;n.sibling=null;}return t.child}function is(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!La(e))}function ss(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Oi=!0;else {if(!(is(e,n)||128&t.flags))return Oi=!1,function(e,t,n){switch(t.tag){case 3:G(t,t.stateNode.containerInfo),Aa(0,Fa,e.memoizedState.cache),ka();break;case 27:case 5:Z(t);break;case 4:G(t,t.stateNode.containerInfo);break;case 10:Aa(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Dl(t),null;break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?($l(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Ji(e,t,n):($l(t),null!==(e=os(e,t,n))?e.sibling:null);$l(t);break;case 19:var a=!!(128&e.flags);if((r=0!==(n&t.childLanes))||(za(e,t,n,!1),r=0!==(n&t.childLanes)),a){if(r)return ls(e,t,n);t.flags|=128;}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),B(Bl,Bl.current),r)break;return null;case 22:return t.lanes=0,Fi(e,t,n,t.pendingProps);case 24:Aa(0,Fa,e.memoizedState.cache);}return os(e,t,n)}(e,t,n);Oi=!!(131072&e.flags);}else Oi=!1,fa&&1048576&t.flags&&la(t,Xr,t.index);switch(t.lanes=0,t.tag){case 16:e:{var r=t.pendingProps;if(e=ll(t.elementType),t.type=e,"function"!=typeof e){if(null!=e){var l=e.$$typeof;if(l===w){t.tag=11,t=Di(null,t,e,r,n);break e}if(l===x){t.tag=14,t=Mi(null,t,e,r,n);break e}}throw t=L(e)||e,Error(a(306,t,""))}Rr(e)?(r=Ei(e,r),t.tag=1,t=Gi(null,t,e,r,n)):(t.tag=0,t=Wi(null,t,e,r,n));}return t;case 0:return Wi(e,t,t.type,t.pendingProps,n);case 1:return Gi(e,t,r=t.type,l=Ei(r,t.pendingProps),n);case 3:e:{if(G(t,t.stateNode.containerInfo),null===e)throw Error(a(387));r=t.pendingProps;var o=t.memoizedState;l=o.element,bl(e,t),_l(t,r,null,n);var i=t.memoizedState;if(r=i.cache,Aa(0,Fa,r),r!==o.cache&&Na(t,[Fa],n,!0),El(),r=i.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:i.cache},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Yi(e,t,r,n);break e}if(r!==l){xa(l=Gr(Error(a(424)),t)),t=Yi(e,t,r,n);break e}for(e=9===(e=t.stateNode.containerInfo).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,ca=$f(e.firstChild),ua=t,fa=!0,da=null,pa=!0,n=gl(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling;}else {if(ka(),r===l){t=os(e,t,n);break e}$i(e,t,r,n);}t=t.child;}return t;case 26:return qi(e,t),null===e?(n=Gf(t.type,null,t.pendingProps,null))?t.memoizedState=n:fa||(n=t.type,e=t.pendingProps,(r=bf(W.current).createElement(n))[Be]=t,r[Ue]=e,mf(r,n,e),et(r),t.stateNode=r):t.memoizedState=Gf(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Z(t),null===e&&fa&&(r=t.stateNode=Ff(t.type,t.pendingProps,W.current),ua=t,pa=!0,l=ca,jf(t.type)?(Df=l,ca=$f(r.firstChild)):ca=l),$i(e,t,t.pendingProps.children,n),qi(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&fa&&((l=r=ca)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var a=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[Ge])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(l=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(l!==a.rel||e.getAttribute("href")!==(null==a.href||""===a.href?null:a.href)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin)||e.getAttribute("title")!==(null==a.title?null:a.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((l=e.getAttribute("src"))!==(null==a.src?null:a.src)||e.getAttribute("type")!==(null==a.type?null:a.type)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin))&&l&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else {if("input"!==t||"hidden"!==e.type)return e;var l=null==a.name?null:""+a.name;if("hidden"===a.type&&e.getAttribute("name")===l)return e}if(null===(e=$f(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,pa))?(t.stateNode=r,ua=t,ca=$f(r.firstChild),pa=!1,l=!0):l=!1),l||ma(t)),Z(t),l=t.type,o=t.pendingProps,i=null!==e?e.memoizedProps:null,r=o.children,Cf(l,o)?r=null:null!==i&&Cf(l,i)&&(t.flags|=32),null!==t.memoizedState&&(l=no(e,t,lo,null,null,n),pd._currentValue=l),qi(e,t),$i(e,t,r,n),t.child;case 6:return null===e&&fa&&((e=n=ca)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=$f(e.nextSibling)))return null}return e}(n,t.pendingProps,pa))?(t.stateNode=n,ua=t,ca=null,e=!0):e=!1),e||ma(t)),null;case 13:return Ji(e,t,n);case 4:return G(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=ml(t,null,r,n):$i(e,t,r,n),t.child;case 11:return Di(e,t,t.type,t.pendingProps,n);case 7:return $i(e,t,t.pendingProps,n),t.child;case 8:case 12:return $i(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,Aa(0,t.type,r.value),$i(e,t,r.children,n),t.child;case 9:return l=t.type._context,r=t.pendingProps.children,Ta(t),r=r(l=Ia(l)),t.flags|=1,$i(e,t,r,n),t.child;case 14:return Mi(e,t,t.type,t.pendingProps,n);case 15:return Ri(e,t,t.type,t.pendingProps,n);case 19:return ls(e,t,n);case 31:return function(e,t,n){var r=t.pendingProps,l=!!(128&t.flags);if(t.flags&=-129,null===e){if(fa){if("hidden"===r.mode)return e=Hi(t,r),t.lanes=536870912,Bi(null,e);if(Dl(t),(e=ca)?null!==(e=null!==(e=Tf(e,pa))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ta?{id:na,overflow:ra}:null,retryLane:536870912,hydrationErrors:null},(n=qr(e)).return=t,t.child=n,ua=t,ca=null):e=null,null===e)throw ma(t);return t.lanes=536870912,null}return Hi(t,r)}var o=e.memoizedState;if(null!==o){var i=o.dehydrated;if(Dl(t),l)if(256&t.flags)t.flags&=-257,t=Vi(e,t,n);else {if(null===t.memoizedState)throw Error(a(558));t.child=e.child,t.flags|=128,t=null;}else if(Oi||za(e,t,n,!1),l=0!==(n&e.childLanes),Oi||l){if(null!==(r=gu)&&0!==(i=Oe(r,n))&&i!==o.retryLane)throw o.retryLane=i,Tr(e,i),Zu(r,0,i),Ii;sc(),t=Vi(e,t,n);}else e=o.treeContext,ca=$f(i.nextSibling),ua=t,fa=!0,da=null,pa=!1,null!==e&&sa(t,e),(t=Hi(t,r)).flags|=4096;return t}return (e=Fr(e.child,{mode:r.mode,children:r.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,n);case 22:return Fi(e,t,n,t.pendingProps);case 24:return Ta(t),r=Ia(Fa),null===e?(null===(l=Za())&&(l=gu,o=Ba(),l.pooledCache=o,o.refCount++,null!==o&&(l.pooledCacheLanes|=n),l=o),t.memoizedState={parent:r,cache:l},vl(t),Aa(0,Fa,l)):(0!==(e.lanes&n)&&(bl(e,t),_l(t,null,null,n),El()),l=e.memoizedState,o=t.memoizedState,l.parent!==r?(l={parent:r,cache:r},t.memoizedState=l,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=l),Aa(0,Fa,r)):(r=o.cache,Aa(0,Fa,r),r!==l.cache&&Na(t,[Fa],n,!0))),$i(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(a(156,t.tag))}function us(e){e.flags|=4;}function cs(e,t,n,r,a){if((t=!!(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&a)===a)if(e.stateNode.complete)e.flags|=8192;else {if(!lc())throw ol=nl,el;e.flags|=8192;}}else e.flags&=-16777217;}function fs(e,t){if("stylesheet"!==t.type||4&t.state.loading)e.flags&=-16777217;else if(e.flags|=16777216,!id(t)){if(!lc())throw ol=nl,el;e.flags|=8192;}}function ds(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Ne():536870912,e.lanes|=t,Nu|=t);}function ps(e,t){if(!fa)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null;}}function hs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=65011712&a.subtreeFlags,r|=65011712&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function ms(e,t,n){var r=t.pendingProps;switch(ia(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return hs(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Pa(Fa),Y(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(wa(t)?us(t):null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,Ca())),hs(t),null;case 26:var l=t.type,o=t.memoizedState;return null===e?(us(t),null!==o?(hs(t),fs(t,o)):(hs(t),cs(t,l,0,0,n))):o?o!==e.memoizedState?(us(t),hs(t),fs(t,o)):(hs(t),t.flags&=-16777217):((e=e.memoizedProps)!==r&&us(t),hs(t),cs(t,l,0,0,n)),null;case 27:if(K(t),n=W.current,l=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&us(t);else {if(!r){if(null===t.stateNode)throw Error(a(166));return hs(t),null}e=V.current,wa(t)?ya(t):(e=Ff(l,r,n),t.stateNode=e,us(t));}return hs(t),null;case 5:if(K(t),l=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&us(t);else {if(!r){if(null===t.stateNode)throw Error(a(166));return hs(t),null}if(o=V.current,wa(t))ya(t);else {var i=bf(W.current);switch(o){case 1:o=i.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:o=i.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":o=i.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":o=i.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":(o=i.createElement("div")).innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o="string"==typeof r.is?i.createElement("select",{is:r.is}):i.createElement("select"),r.multiple?o.multiple=!0:r.size&&(o.size=r.size);break;default:o="string"==typeof r.is?i.createElement(l,{is:r.is}):i.createElement(l);}}o[Be]=t,o[Ue]=r;e:for(i=t.child;null!==i;){if(5===i.tag||6===i.tag)o.appendChild(i.stateNode);else if(4!==i.tag&&27!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break e;for(;null===i.sibling;){if(null===i.return||i.return===t)break e;i=i.return;}i.sibling.return=i.return,i=i.sibling;}t.stateNode=o;e:switch(mf(o,l,r),l){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1;}r&&us(t);}}return hs(t),cs(t,t.type,null===e||e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&us(t);else {if("string"!=typeof r&&null===t.stateNode)throw Error(a(166));if(e=W.current,wa(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(l=ua))switch(l.tag){case 27:case 5:r=l.memoizedProps;}e[Be]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||df(e.nodeValue,n)))||ma(t,!0);}else (e=bf(e).createTextNode(r))[Be]=t,t.stateNode=e;}return hs(t),null;case 31:if(n=t.memoizedState,null===e||null!==e.memoizedState){if(r=wa(t),null!==n){if(null===e){if(!r)throw Error(a(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(a(557));e[Be]=t;}else ka(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hs(t),e=!1;}else n=Ca(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return 256&t.flags?(Fl(t),t):(Fl(t),null);if(128&t.flags)throw Error(a(558))}return hs(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(l=wa(t),null!==r&&null!==r.dehydrated){if(null===e){if(!l)throw Error(a(318));if(!(l=null!==(l=t.memoizedState)?l.dehydrated:null))throw Error(a(317));l[Be]=t;}else ka(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hs(t),l=!1;}else l=Ca(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=l),l=!0;if(!l)return 256&t.flags?(Fl(t),t):(Fl(t),null)}return Fl(t),128&t.flags?(t.lanes=n,t):(n=null!==r,e=null!==e&&null!==e.memoizedState,n&&(l=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(l=r.alternate.memoizedState.cachePool.pool),o=null,null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(o=r.memoizedState.cachePool.pool),o!==l&&(r.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),ds(t,t.updateQueue),hs(t),null);case 4:return Y(),null===e&&tf(t.stateNode.containerInfo),hs(t),null;case 10:return Pa(t.type),hs(t),null;case 19:if(F(Bl),null===(r=t.memoizedState))return hs(t),null;if(l=!!(128&t.flags),null===(o=r.rendering))if(l)ps(r,!1);else {if(0!==Eu||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(o=Ul(e))){for(t.flags|=128,ps(r,!1),e=o.updateQueue,t.updateQueue=e,ds(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Br(n,e),n=n.sibling;return B(Bl,1&Bl.current|2),fa&&aa(t,r.treeForkCount),t.child}e=e.sibling;}null!==r.tail&&se()>$u&&(t.flags|=128,l=!0,ps(r,!1),t.lanes=4194304);}else {if(!l)if(null!==(e=Ul(o))){if(t.flags|=128,l=!0,e=e.updateQueue,t.updateQueue=e,ds(t,e),ps(r,!0),null===r.tail&&"hidden"===r.tailMode&&!o.alternate&&!fa)return hs(t),null}else 2*se()-r.renderingStartTime>$u&&536870912!==n&&(t.flags|=128,l=!0,ps(r,!1),t.lanes=4194304);r.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=r.last)?e.sibling=o:t.child=o,r.last=o);}return null!==r.tail?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=se(),e.sibling=null,n=Bl.current,B(Bl,l?1&n|2:1&n),fa&&aa(t,r.treeForkCount),e):(hs(t),null);case 22:case 23:return Fl(t),Tl(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?!!(536870912&n)&&!(128&t.flags)&&(hs(t),6&t.subtreeFlags&&(t.flags|=8192)):hs(t),null!==(n=t.updateQueue)&&ds(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&F(Ya),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Pa(Fa),hs(t),null;case 25:case 30:return null}throw Error(a(156,t.tag))}function gs(e,t){switch(ia(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Pa(Fa),Y(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return K(t),null;case 31:if(null!==t.memoizedState){if(Fl(t),null===t.alternate)throw Error(a(340));ka();}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(Fl(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));ka();}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return F(Bl),null;case 4:return Y(),null;case 10:return Pa(t.type),null;case 22:case 23:return Fl(t),Tl(),null!==e&&F(Ya),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Pa(Fa),null;default:return null}}function ys(e,t){switch(ia(t),t.tag){case 3:Pa(Fa),Y();break;case 26:case 27:case 5:K(t);break;case 4:Y();break;case 31:null!==t.memoizedState&&Fl(t);break;case 13:Fl(t);break;case 19:F(Bl);break;case 10:Pa(t.type);break;case 22:case 23:Fl(t),Tl(),null!==e&&F(Ya);break;case 24:Pa(Fa);}}function vs(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var a=r.next;n=a;do{if((n.tag&e)===e){r=void 0;var l=n.create,o=n.inst;r=l(),o.destroy=r;}n=n.next;}while(n!==a)}}catch(e){Ec(t,t.return,e);}}function bs(e,t,n){try{var r=t.updateQueue,a=null!==r?r.lastEffect:null;if(null!==a){var l=a.next;r=l;do{if((r.tag&e)===e){var o=r.inst,i=o.destroy;if(void 0!==i){o.destroy=void 0,a=t;var s=n,u=i;try{u();}catch(e){Ec(a,s,e);}}}r=r.next;}while(r!==l)}}catch(e){Ec(t,t.return,e);}}function ws(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{Pl(t,n);}catch(t){Ec(e,e.return,t);}}}function ks(e,t,n){n.props=Ei(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount();}catch(n){Ec(e,t,n);}}function Cs(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode;}"function"==typeof n?e.refCleanup=n(r):n.current=r;}}catch(n){Ec(e,t,n);}}function xs(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"==typeof r)try{r();}catch(n){Ec(e,t,n);}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null);}else if("function"==typeof n)try{n(null);}catch(n){Ec(e,t,n);}else n.current=null;}function Ss(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet);}}catch(t){Ec(e,e.return,t);}}function Es(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var l=null,o=null,i=null,s=null,u=null,c=null,f=null;for(h in n){var d=n[h];if(n.hasOwnProperty(h)&&null!=d)switch(h){case"checked":case"value":break;case"defaultValue":u=d;default:r.hasOwnProperty(h)||pf(e,t,h,null,r,d);}}for(var p in r){var h=r[p];if(d=n[p],r.hasOwnProperty(p)&&(null!=h||null!=d))switch(p){case"type":o=h;break;case"name":l=h;break;case"checked":c=h;break;case"defaultChecked":f=h;break;case"value":i=h;break;case"defaultValue":s=h;break;case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(a(137,t));break;default:h!==d&&pf(e,t,p,h,r,d);}}return void vt(e,i,s,u,c,f,o,l);case"select":for(o in h=i=s=p=null,n)if(u=n[o],n.hasOwnProperty(o)&&null!=u)switch(o){case"value":break;case"multiple":h=u;default:r.hasOwnProperty(o)||pf(e,t,o,null,r,u);}for(l in r)if(o=r[l],u=n[l],r.hasOwnProperty(l)&&(null!=o||null!=u))switch(l){case"value":p=o;break;case"defaultValue":s=o;break;case"multiple":i=o;default:o!==u&&pf(e,t,l,o,r,u);}return t=s,n=i,r=h,void(null!=p?kt(e,!!n,p,!1):!!r!=!!n&&(null!=t?kt(e,!!n,t,!0):kt(e,!!n,n?[]:"",!1)));case"textarea":for(s in h=p=null,n)if(l=n[s],n.hasOwnProperty(s)&&null!=l&&!r.hasOwnProperty(s))switch(s){case"value":case"children":break;default:pf(e,t,s,null,r,l);}for(i in r)if(l=r[i],o=n[i],r.hasOwnProperty(i)&&(null!=l||null!=o))switch(i){case"value":p=l;break;case"defaultValue":h=l;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(a(91));break;default:l!==o&&pf(e,t,i,l,r,o);}return void Ct(e,p,h);case"option":for(var m in n)p=n[m],n.hasOwnProperty(m)&&null!=p&&!r.hasOwnProperty(m)&&("selected"===m?e.selected=!1:pf(e,t,m,null,r,p));for(u in r)p=r[u],h=n[u],!r.hasOwnProperty(u)||p===h||null==p&&null==h||("selected"===u?e.selected=p&&"function"!=typeof p&&"symbol"!=typeof p:pf(e,t,u,p,r,h));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)p=n[g],n.hasOwnProperty(g)&&null!=p&&!r.hasOwnProperty(g)&&pf(e,t,g,null,r,p);for(c in r)if(p=r[c],h=n[c],r.hasOwnProperty(c)&&p!==h&&(null!=p||null!=h))switch(c){case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(a(137,t));break;default:pf(e,t,c,p,r,h);}return;default:if(Pt(t)){for(var y in n)p=n[y],n.hasOwnProperty(y)&&void 0!==p&&!r.hasOwnProperty(y)&&hf(e,t,y,void 0,r,p);for(f in r)p=r[f],h=n[f],!r.hasOwnProperty(f)||p===h||void 0===p&&void 0===h||hf(e,t,f,p,r,h);return}}for(var v in n)p=n[v],n.hasOwnProperty(v)&&null!=p&&!r.hasOwnProperty(v)&&pf(e,t,v,null,r,p);for(d in r)p=r[d],h=n[d],!r.hasOwnProperty(d)||p===h||null==p&&null==h||pf(e,t,d,p,r,h);}(r,e.type,n,t),r[Ue]=t;}catch(t){Ec(e,e.return,t);}}function _s(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&jf(e.type)||4===e.tag}function As(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||_s(e.return))return null;e=e.return;}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&jf(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child;}if(!(2&e.flags))return e.stateNode}}function Ps(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Lt));else if(4!==r&&(27===r&&jf(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(Ps(e,t,n),e=e.sibling;null!==e;)Ps(e,t,n),e=e.sibling;}function js(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&jf(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(js(e,t,n),e=e.sibling;null!==e;)js(e,t,n),e=e.sibling;}function Ns(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,a=t.attributes;a.length;)t.removeAttributeNode(a[0]);mf(t,r,n),t[Be]=e,t[Ue]=n;}catch(t){Ec(e,e.return,t);}}var zs=!1,Ls=!1,Ts=!1,Is="function"==typeof WeakSet?WeakSet:Set,Os=null;function $s(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:Zs(e,n),4&r&&vs(5,n);break;case 1:if(Zs(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount();}catch(e){Ec(n,n.return,e);}else {var a=Ei(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate);}catch(e){Ec(n,n.return,e);}}64&r&&ws(n),512&r&&Cs(n,n.return);break;case 3:if(Zs(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode;}try{Pl(e,t);}catch(e){Ec(n,n.return,e);}}break;case 27:null===t&&4&r&&Ns(n);case 26:case 5:Zs(e,n),null===t&&4&r&&Ss(n),512&r&&Cs(n,n.return);break;case 12:Zs(e,n);break;case 31:Zs(e,n),4&r&&Us(e,n);break;case 13:Zs(e,n),4&r&&Hs(e,n),64&r&&null!==(e=n.memoizedState)&&null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==n.readyState)t();else {var r=function(){t(),n.removeEventListener("DOMContentLoaded",r);};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r;}}(e,n=jc.bind(null,n));break;case 22:if(!(r=null!==n.memoizedState||zs)){t=null!==t&&null!==t.memoizedState||Ls,a=zs;var l=Ls;zs=r,(Ls=t)&&!l?Xs(e,n,!!(8772&n.subtreeFlags)):Zs(e,n),zs=a,Ls=l;}break;case 30:break;default:Zs(e,n);}}function Ds(e){var t=e.alternate;null!==t&&(e.alternate=null,Ds(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&Ye(t),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null;}var Ms=null,Rs=!1;function Fs(e,t,n){for(n=n.child;null!==n;)Bs(e,t,n),n=n.sibling;}function Bs(e,t,n){if(ve&&"function"==typeof ve.onCommitFiberUnmount)try{ve.onCommitFiberUnmount(ye,n);}catch(e){}switch(n.tag){case 26:Ls||xs(n,t),Fs(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Ls||xs(n,t);var r=Ms,a=Rs;jf(n.type)&&(Ms=n.stateNode,Rs=!1),Fs(e,t,n),Bf(n.stateNode),Ms=r,Rs=a;break;case 5:Ls||xs(n,t);case 6:if(r=Ms,a=Rs,Ms=null,Fs(e,t,n),Rs=a,null!==(Ms=r))if(Rs)try{(9===Ms.nodeType?Ms.body:"HTML"===Ms.nodeName?Ms.ownerDocument.body:Ms).removeChild(n.stateNode);}catch(e){Ec(n,t,e);}else try{Ms.removeChild(n.stateNode);}catch(e){Ec(n,t,e);}break;case 18:null!==Ms&&(Rs?(Nf(9===(e=Ms).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),qd(e)):Nf(Ms,n.stateNode));break;case 4:r=Ms,a=Rs,Ms=n.stateNode.containerInfo,Rs=!0,Fs(e,t,n),Ms=r,Rs=a;break;case 0:case 11:case 14:case 15:bs(2,n,t),Ls||bs(4,n,t),Fs(e,t,n);break;case 1:Ls||(xs(n,t),"function"==typeof(r=n.stateNode).componentWillUnmount&&ks(n,t,r)),Fs(e,t,n);break;case 21:Fs(e,t,n);break;case 22:Ls=(r=Ls)||null!==n.memoizedState,Fs(e,t,n),Ls=r;break;default:Fs(e,t,n);}}function Us(e,t){if(null===t.memoizedState&&null!==(e=t.alternate)&&null!==(e=e.memoizedState)){e=e.dehydrated;try{qd(e);}catch(e){Ec(t,t.return,e);}}}function Hs(e,t){if(null===t.memoizedState&&null!==(e=t.alternate)&&null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))try{qd(e);}catch(e){Ec(t,t.return,e);}}function Vs(e,t){var n=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Is),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Is),t;default:throw Error(a(435,e.tag))}}(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var r=Nc.bind(null,e,t);t.then(r,r);}});}function qs(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var l=n[r],o=e,i=t,s=i;e:for(;null!==s;){switch(s.tag){case 27:if(jf(s.type)){Ms=s.stateNode,Rs=!1;break e}break;case 5:Ms=s.stateNode,Rs=!1;break e;case 3:case 4:Ms=s.stateNode.containerInfo,Rs=!0;break e}s=s.return;}if(null===Ms)throw Error(a(160));Bs(o,i,l),Ms=null,Rs=!1,null!==(o=l.alternate)&&(o.return=null),l.return=null;}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Qs(t,e),t=t.sibling;}var Ws=null;function Qs(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:qs(t,e),Gs(e),4&r&&(bs(3,e,e.return),vs(3,e),bs(5,e,e.return));break;case 1:qs(t,e),Gs(e),512&r&&(Ls||null===n||xs(n,n.return)),64&r&&zs&&null!==(e=e.updateQueue)&&null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r));break;case 26:var l=Ws;if(qs(t,e),Gs(e),512&r&&(Ls||null===n||xs(n,n.return)),4&r){var o=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,l=l.ownerDocument||l;t:switch(r){case"title":(!(o=l.getElementsByTagName("title")[0])||o[Ge]||o[Be]||"http://www.w3.org/2000/svg"===o.namespaceURI||o.hasAttribute("itemprop"))&&(o=l.createElement(r),l.head.insertBefore(o,l.querySelector("head > title"))),mf(o,r,n),o[Be]=e,et(o),r=o;break e;case"link":var i=ld("link","href",l).get(r+(n.href||""));if(i)for(var s=0;s<i.length;s++)if((o=i[s]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&o.getAttribute("rel")===(null==n.rel?null:n.rel)&&o.getAttribute("title")===(null==n.title?null:n.title)&&o.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){i.splice(s,1);break t}mf(o=l.createElement(r),r,n),l.head.appendChild(o);break;case"meta":if(i=ld("meta","content",l).get(r+(n.content||"")))for(s=0;s<i.length;s++)if((o=i[s]).getAttribute("content")===(null==n.content?null:""+n.content)&&o.getAttribute("name")===(null==n.name?null:n.name)&&o.getAttribute("property")===(null==n.property?null:n.property)&&o.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&o.getAttribute("charset")===(null==n.charSet?null:n.charSet)){i.splice(s,1);break t}mf(o=l.createElement(r),r,n),l.head.appendChild(o);break;default:throw Error(a(468,r))}o[Be]=e,et(o),r=o;}e.stateNode=r;}else od(l,e.type,e.stateNode);else e.stateNode=ed(l,r,e.memoizedProps);else o!==r?(null===o?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):o.count--,null===r?od(l,e.type,e.stateNode):ed(l,r,e.memoizedProps)):null===r&&null!==e.stateNode&&Es(e,e.memoizedProps,n.memoizedProps);}break;case 27:qs(t,e),Gs(e),512&r&&(Ls||null===n||xs(n,n.return)),null!==n&&4&r&&Es(e,e.memoizedProps,n.memoizedProps);break;case 5:if(qs(t,e),Gs(e),512&r&&(Ls||null===n||xs(n,n.return)),32&e.flags){l=e.stateNode;try{St(l,"");}catch(t){Ec(e,e.return,t);}}4&r&&null!=e.stateNode&&Es(e,l=e.memoizedProps,null!==n?n.memoizedProps:l),1024&r&&(Ts=!0);break;case 6:if(qs(t,e),Gs(e),4&r){if(null===e.stateNode)throw Error(a(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r;}catch(t){Ec(e,e.return,t);}}break;case 3:if(ad=null,l=Ws,Ws=Vf(t.containerInfo),qs(t,e),Ws=l,Gs(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{qd(t.containerInfo);}catch(t){Ec(e,e.return,t);}Ts&&(Ts=!1,Ys(e));break;case 4:r=Ws,Ws=Vf(e.stateNode.containerInfo),qs(t,e),Gs(e),Ws=r;break;case 12:default:qs(t,e),Gs(e);break;case 31:case 19:qs(t,e),Gs(e),4&r&&null!==(r=e.updateQueue)&&(e.updateQueue=null,Vs(e,r));break;case 13:qs(t,e),Gs(e),8192&e.child.flags&&null!==e.memoizedState!=(null!==n&&null!==n.memoizedState)&&(Iu=se()),4&r&&null!==(r=e.updateQueue)&&(e.updateQueue=null,Vs(e,r));break;case 22:l=null!==e.memoizedState;var u=null!==n&&null!==n.memoizedState,c=zs,f=Ls;if(zs=c||l,Ls=f||u,qs(t,e),Ls=f,zs=c,Gs(e),8192&r)e:for(t=e.stateNode,t._visibility=l?-2&t._visibility:1|t._visibility,l&&(null===n||u||zs||Ls||Ks(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){u=n=t;try{if(o=u.stateNode,l)"function"==typeof(i=o.style).setProperty?i.setProperty("display","none","important"):i.display="none";else {s=u.stateNode;var d=u.memoizedProps.style,p=null!=d&&d.hasOwnProperty("display")?d.display:null;s.style.display=null==p||"boolean"==typeof p?"":(""+p).trim();}}catch(e){Ec(u,u.return,e);}}}else if(6===t.tag){if(null===n){u=t;try{u.stateNode.nodeValue=l?"":u.memoizedProps;}catch(e){Ec(u,u.return,e);}}}else if(18===t.tag){if(null===n){u=t;try{var h=u.stateNode;l?zf(h,!0):zf(u.stateNode,!1);}catch(e){Ec(u,u.return,e);}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return;}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling;}4&r&&null!==(r=e.updateQueue)&&null!==(n=r.retryQueue)&&(r.retryQueue=null,Vs(e,n));case 30:case 21:}}function Gs(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(_s(r)){n=r;break}r=r.return;}if(null==n)throw Error(a(160));switch(n.tag){case 27:var l=n.stateNode;js(e,As(e),l);break;case 5:var o=n.stateNode;32&n.flags&&(St(o,""),n.flags&=-33),js(e,As(e),o);break;case 3:case 4:var i=n.stateNode.containerInfo;Ps(e,As(e),i);break;default:throw Error(a(161))}}catch(t){Ec(e,e.return,t);}e.flags&=-3;}4096&t&&(e.flags&=-4097);}function Ys(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Ys(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling;}}function Zs(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)$s(e,t.alternate,t),t=t.sibling;}function Ks(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:bs(4,t,t.return),Ks(t);break;case 1:xs(t,t.return);var n=t.stateNode;"function"==typeof n.componentWillUnmount&&ks(t,t.return,n),Ks(t);break;case 27:Bf(t.stateNode);case 26:case 5:xs(t,t.return),Ks(t);break;case 22:null===t.memoizedState&&Ks(t);break;default:Ks(t);}e=e.sibling;}}function Xs(e,t,n){for(n=n&&!!(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,a=e,l=t,o=l.flags;switch(l.tag){case 0:case 11:case 15:Xs(a,l,n),vs(4,l);break;case 1:if(Xs(a,l,n),"function"==typeof(a=(r=l).stateNode).componentDidMount)try{a.componentDidMount();}catch(e){Ec(r,r.return,e);}if(null!==(a=(r=l).updateQueue)){var i=r.stateNode;try{var s=a.shared.hiddenCallbacks;if(null!==s)for(a.shared.hiddenCallbacks=null,a=0;a<s.length;a++)Al(s[a],i);}catch(e){Ec(r,r.return,e);}}n&&64&o&&ws(l),Cs(l,l.return);break;case 27:Ns(l);case 26:case 5:Xs(a,l,n),n&&null===r&&4&o&&Ss(l),Cs(l,l.return);break;case 12:Xs(a,l,n);break;case 31:Xs(a,l,n),n&&4&o&&Us(a,l);break;case 13:Xs(a,l,n),n&&4&o&&Hs(a,l);break;case 22:null===l.memoizedState&&Xs(a,l,n),Cs(l,l.return);break;case 30:break;default:Xs(a,l,n);}t=t.sibling;}}function Js(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Ua(n));}function eu(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ua(e));}function tu(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)nu(e,t,n,r),t=t.sibling;}function nu(e,t,n,r){var a=t.flags;switch(t.tag){case 0:case 11:case 15:tu(e,t,n,r),2048&a&&vs(9,t);break;case 1:case 31:case 13:default:tu(e,t,n,r);break;case 3:tu(e,t,n,r),2048&a&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ua(e)));break;case 12:if(2048&a){tu(e,t,n,r),e=t.stateNode;try{var l=t.memoizedProps,o=l.id,i=l.onPostCommit;"function"==typeof i&&i(o,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0);}catch(e){Ec(t,t.return,e);}}else tu(e,t,n,r);break;case 23:break;case 22:l=t.stateNode,o=t.alternate,null!==t.memoizedState?2&l._visibility?tu(e,t,n,r):au(e,t):2&l._visibility?tu(e,t,n,r):(l._visibility|=2,ru(e,t,n,r,!!(10256&t.subtreeFlags)||!1)),2048&a&&Js(o,t);break;case 24:tu(e,t,n,r),2048&a&&eu(t.alternate,t);}}function ru(e,t,n,r,a){for(a=a&&(!!(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var l=e,o=t,i=n,s=r,u=o.flags;switch(o.tag){case 0:case 11:case 15:ru(l,o,i,s,a),vs(8,o);break;case 23:break;case 22:var c=o.stateNode;null!==o.memoizedState?2&c._visibility?ru(l,o,i,s,a):au(l,o):(c._visibility|=2,ru(l,o,i,s,a)),a&&2048&u&&Js(o.alternate,o);break;case 24:ru(l,o,i,s,a),a&&2048&u&&eu(o.alternate,o);break;default:ru(l,o,i,s,a);}t=t.sibling;}}function au(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,a=r.flags;switch(r.tag){case 22:au(n,r),2048&a&&Js(r.alternate,r);break;case 24:au(n,r),2048&a&&eu(r.alternate,r);break;default:au(n,r);}t=t.sibling;}}var lu=8192;function ou(e,t,n){if(e.subtreeFlags&lu)for(e=e.child;null!==e;)iu(e,t,n),e=e.sibling;}function iu(e,t,n){switch(e.tag){case 26:ou(e,t,n),e.flags&lu&&null!==e.memoizedState&&function(e,t,n,r){if(!("stylesheet"!==n.type||"string"==typeof r.media&&!1===matchMedia(r.media).matches||4&n.state.loading)){if(null===n.instance){var a=Yf(r.href),l=t.querySelector(Zf(a));if(l)return null!==(t=l._p)&&"object"==typeof t&&"function"==typeof t.then&&(e.count++,e=ud.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=l,void et(l);l=t.ownerDocument||t,r=Kf(r),(a=Uf.get(a))&&nd(r,a),et(l=l.createElement("link"));var o=l;o._p=new Promise(function(e,t){o.onload=e,o.onerror=t;}),mf(l,"link",r),n.instance=l;}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&!(3&n.state.loading)&&(e.count++,n=ud.bind(e),t.addEventListener("load",n),t.addEventListener("error",n));}}(n,Ws,e.memoizedState,e.memoizedProps);break;case 5:default:ou(e,t,n);break;case 3:case 4:var r=Ws;Ws=Vf(e.stateNode.containerInfo),ou(e,t,n),Ws=r;break;case 22:null===e.memoizedState&&(null!==(r=e.alternate)&&null!==r.memoizedState?(r=lu,lu=16777216,ou(e,t,n),lu=r):ou(e,t,n));}}function su(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t;}while(null!==e)}}function uu(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Os=r,du(r,e);}su(e);}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)cu(e),e=e.sibling;}function cu(e){switch(e.tag){case 0:case 11:case 15:uu(e),2048&e.flags&&bs(9,e,e.return);break;case 3:case 12:default:uu(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,fu(e)):uu(e);}}function fu(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Os=r,du(r,e);}su(e);}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:bs(8,t,t.return),fu(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,fu(t));break;default:fu(t);}e=e.sibling;}}function du(e,t){for(;null!==Os;){var n=Os;switch(n.tag){case 0:case 11:case 15:bs(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++;}break;case 24:Ua(n.memoizedState.cache);}if(null!==(r=n.child))r.return=n,Os=r;else e:for(n=e;null!==Os;){var a=(r=Os).sibling,l=r.return;if(Ds(r),r===n){Os=null;break e}if(null!==a){a.return=l,Os=a;break e}Os=l;}}}var pu={getCacheForType:function(e){var t=Ia(Fa),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Ia(Fa).controller.signal}},hu="function"==typeof WeakMap?WeakMap:Map,mu=0,gu=null,yu=null,vu=0,bu=0,wu=null,ku=!1,Cu=!1,xu=!1,Su=0,Eu=0,_u=0,Au=0,Pu=0,ju=0,Nu=0,zu=null,Lu=null,Tu=!1,Iu=0,Ou=0,$u=1/0,Du=null,Mu=null,Ru=0,Fu=null,Bu=null,Uu=0,Hu=0,Vu=null,qu=null,Wu=0,Qu=null;function Gu(){return 2&mu&&0!==vu?vu&-vu:null!==I.T?Vc():Me()}function Yu(){if(0===ju)if(536870912&vu&&!fa)ju=536870912;else {var e=Se;!(3932160&(Se<<=1))&&(Se=262144),ju=e;}return null!==(e=Il.current)&&(e.flags|=32),ju}function Zu(e,t,n){(e!==gu||2!==bu&&9!==bu)&&null===e.cancelPendingCommit||(rc(e,0),ec(e,vu,ju,!1)),Le(e,n),2&mu&&e===gu||(e===gu&&(!(2&mu)&&(Au|=n),4===Eu&&ec(e,vu,ju,!1)),Dc(e));}function Ku(e,t,n){if(6&mu)throw Error(a(327));for(var r=!n&&!(127&t)&&0===(t&e.expiredLanes)||Pe(e,t),l=r?function(e,t){var n=mu;mu|=2;var r=oc(),l=ic();gu!==e||vu!==t?(Du=null,$u=se()+500,rc(e,t)):Cu=Pe(e,t);e:for(;;)try{if(0!==bu&&null!==yu){t=yu;var o=wu;t:switch(bu){case 1:bu=0,wu=null,hc(e,t,o,1);break;case 2:case 9:if(rl(o)){bu=0,wu=null,pc(t);break}t=function(){2!==bu&&9!==bu||gu!==e||(bu=7),Dc(e);},o.then(t,t);break e;case 3:bu=7;break e;case 4:bu=5;break e;case 7:rl(o)?(bu=0,wu=null,pc(t)):(bu=0,wu=null,hc(e,t,o,7));break;case 5:var i=null;switch(yu.tag){case 26:i=yu.memoizedState;case 5:case 27:var s=yu;if(i?id(i):s.stateNode.complete){bu=0,wu=null;var u=s.sibling;if(null!==u)yu=u;else {var c=s.return;null!==c?(yu=c,mc(c)):yu=null;}break t}}bu=0,wu=null,hc(e,t,o,5);break;case 6:bu=0,wu=null,hc(e,t,o,6);break;case 8:nc(),Eu=6;break e;default:throw Error(a(462))}}fc();break}catch(t){ac(e,t);}return _a=Ea=null,I.H=r,I.A=l,mu=n,null!==yu?0:(gu=null,vu=0,Nr(),Eu)}(e,t):uc(e,t,!0),o=r;;){if(0===l){Cu&&!r&&ec(e,t,0,!1);break}if(n=e.current.alternate,!o||Ju(n)){if(2===l){if(o=t,e.errorRecoveryDisabledLanes&o)var i=0;else i=0!=(i=-536870913&e.pendingLanes)?i:536870912&i?536870912:0;if(0!==i){t=i;e:{var s=e;l=zu;var u=s.current.memoizedState.isDehydrated;if(u&&(rc(s,i).flags|=256),2!==(i=uc(s,i,!1))){if(xu&&!u){s.errorRecoveryDisabledLanes|=o,Au|=o,l=4;break e}o=Lu,Lu=l,null!==o&&(null===Lu?Lu=o:Lu.push.apply(Lu,o));}l=i;}if(o=!1,2!==l)continue}}if(1===l){rc(e,0),ec(e,t,0,!0);break}e:{switch(r=e,o=l){case 0:case 1:throw Error(a(345));case 4:if((4194048&t)!==t)break;case 6:ec(r,t,ju,!ku);break e;case 2:Lu=null;break;case 3:case 5:break;default:throw Error(a(329))}if((62914560&t)===t&&10<(l=Iu+300-se())){if(ec(r,t,ju,!ku),0!==Ae(r,0,!0))break e;Uu=t,r.timeoutHandle=Sf(Xu.bind(null,r,n,Lu,Du,Tu,t,ju,Au,Nu,ku,o,"Throttled",-0,0),l);}else Xu(r,n,Lu,Du,Tu,t,ju,Au,Nu,ku,o,null,-0,0);}break}l=uc(e,t,!1),o=!1;}Dc(e);}function Xu(e,t,n,r,a,l,o,i,s,u,c,f,d,p){if(e.timeoutHandle=-1,8192&(f=t.subtreeFlags)||!(16785408&~f)){iu(t,l,f={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Lt});var h=(62914560&l)===l?Iu-se():(4194048&l)===l?Ou-se():0;if(null!==(h=function(e,t){return e.stylesheets&&0===e.count&&fd(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var r=setTimeout(function(){if(e.stylesheets&&fd(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t();}},6e4+t);0<e.imgBytes&&0===sd&&(sd=62500*function(){if("function"==typeof performance.getEntriesByType){for(var e=0,t=0,n=performance.getEntriesByType("resource"),r=0;r<n.length;r++){var a=n[r],l=a.transferSize,o=a.initiatorType,i=a.duration;if(l&&i&&gf(o)){for(o=0,i=a.responseEnd,r+=1;r<n.length;r++){var s=n[r],u=s.startTime;if(u>i)break;var c=s.transferSize,f=s.initiatorType;c&&gf(f)&&(o+=c*((s=s.responseEnd)<i?1:(i-u)/(s-u)));}if(--r,t+=8*(l+o)/(a.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"==typeof(e=navigator.connection.downlink)?e:5}());var a=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&fd(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t();}},(e.imgBytes>sd?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(a);}}:null}(f,h)))return Uu=l,e.cancelPendingCommit=h(yc.bind(null,e,t,l,n,r,a,o,i,s,c,f,null,d,p)),void ec(e,l,o,!u)}yc(e,t,l,n,r,a,o,i,s);}function Ju(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&null!==(n=t.updateQueue)&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],l=a.getSnapshot;a=a.value;try{if(!Xn(l(),a))return !1}catch(e){return !1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else {if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return !0;t=t.return;}t.sibling.return=t.return,t=t.sibling;}}return !0}function ec(e,t,n,r){t&=~Pu,t&=~Au,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var a=t;0<a;){var l=31-we(a),o=1<<l;r[l]=-1,a&=~o;}0!==n&&Te(e,n,t);}function tc(){return !!(6&mu)||(Mc(0,!1),!1)}function nc(){if(null!==yu){if(0===bu)var e=yu.return;else _a=Ea=null,so(e=yu),ul=null,cl=0,e=yu;for(;null!==e;)ys(e.alternate,e),e=e.return;yu=null;}}function rc(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,Ef(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Uu=0,nc(),gu=e,yu=n=Fr(e.current,null),vu=t,bu=0,wu=null,ku=!1,Cu=Pe(e,t),xu=!1,Nu=ju=Pu=Au=_u=Eu=0,Lu=zu=null,Tu=!1,8&t&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var a=31-we(r),l=1<<a;t|=e[a],r&=~l;}return Su=t,Nr(),n}function ac(e,t){Vl=null,I.H=yi,t===Ja||t===tl?(t=il(),bu=3):t===el?(t=il(),bu=4):bu=t===Ii?8:null!==t&&"object"==typeof t&&"function"==typeof t.then?6:1,wu=t,null===yu&&(Eu=1,ji(e,Gr(t,e.current)));}function lc(){var e=Il.current;return null===e||((4194048&vu)===vu?null===Ol:!!((62914560&vu)===vu||536870912&vu)&&e===Ol)}function oc(){var e=I.H;return I.H=yi,null===e?yi:e}function ic(){var e=I.A;return I.A=pu,e}function sc(){Eu=4,ku||(4194048&vu)!==vu&&null!==Il.current||(Cu=!0),!(134217727&_u)&&!(134217727&Au)||null===gu||ec(gu,vu,ju,!1);}function uc(e,t,n){var r=mu;mu|=2;var a=oc(),l=ic();gu===e&&vu===t||(Du=null,rc(e,t)),t=!1;var o=Eu;e:for(;;)try{if(0!==bu&&null!==yu){var i=yu,s=wu;switch(bu){case 8:nc(),o=6;break e;case 3:case 2:case 9:case 6:null===Il.current&&(t=!0);var u=bu;if(bu=0,wu=null,hc(e,i,s,u),n&&Cu){o=0;break e}break;default:u=bu,bu=0,wu=null,hc(e,i,s,u);}}cc(),o=Eu;break}catch(t){ac(e,t);}return t&&e.shellSuspendCounter++,_a=Ea=null,mu=r,I.H=a,I.A=l,null===yu&&(gu=null,vu=0,Nr()),o}function cc(){for(;null!==yu;)dc(yu);}function fc(){for(;null!==yu&&!oe();)dc(yu);}function dc(e){var t=ss(e.alternate,e,Su);e.memoizedProps=e.pendingProps,null===t?mc(e):yu=t;}function pc(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Qi(n,t,t.pendingProps,t.type,void 0,vu);break;case 11:t=Qi(n,t,t.pendingProps,t.type.render,t.ref,vu);break;case 5:so(t);default:ys(n,t),t=ss(n,t=yu=Br(t,Su),Su);}e.memoizedProps=e.pendingProps,null===t?mc(e):yu=t;}function hc(e,t,n,r){_a=Ea=null,so(t),ul=null,cl=0;var l=t.return;try{if(function(e,t,n,r,l){if(n.flags|=32768,null!==r&&"object"==typeof r&&"function"==typeof r.then){if(null!==(t=n.alternate)&&za(t,n,l,!0),null!==(n=Il.current)){switch(n.tag){case 31:case 13:return null===Ol?sc():null===n.alternate&&0===Eu&&(Eu=3),n.flags&=-257,n.flags|=65536,n.lanes=l,r===nl?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),_c(e,r,l)),!1;case 22:return n.flags|=65536,r===nl?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),_c(e,r,l)),!1}throw Error(a(435,n.tag))}return _c(e,r,l),sc(),!1}if(fa)return null!==(t=Il.current)?(!(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=l,r!==ha&&xa(Gr(e=Error(a(422),{cause:r}),n))):(r!==ha&&xa(Gr(t=Error(a(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,l&=-l,e.lanes|=l,r=Gr(r,n),xl(e,l=zi(e.stateNode,r,l)),4!==Eu&&(Eu=2)),!1;var o=Error(a(520),{cause:r});if(o=Gr(o,n),null===zu?zu=[o]:zu.push(o),4!==Eu&&(Eu=2),null===t)return !0;r=Gr(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=l&-l,n.lanes|=e,xl(n,e=zi(n.stateNode,r,e)),!1;case 1:if(t=n.type,o=n.stateNode,!(128&n.flags||"function"!=typeof t.getDerivedStateFromError&&(null===o||"function"!=typeof o.componentDidCatch||null!==Mu&&Mu.has(o))))return n.flags|=65536,l&=-l,n.lanes|=l,Ti(l=Li(l),e,n,r),xl(n,l),!1}n=n.return;}while(null!==n);return !1}(e,l,t,n,vu))return Eu=1,ji(e,Gr(n,e.current)),void(yu=null)}catch(t){if(null!==l)throw yu=l,t;return Eu=1,ji(e,Gr(n,e.current)),void(yu=null)}32768&t.flags?(fa||1===r?e=!0:Cu||536870912&vu?e=!1:(ku=e=!0,(2===r||9===r||3===r||6===r)&&null!==(r=Il.current)&&13===r.tag&&(r.flags|=16384)),gc(t,e)):mc(t);}function mc(e){var t=e;do{if(32768&t.flags)return void gc(t,ku);e=t.return;var n=ms(t.alternate,t,Su);if(null!==n)return void(yu=n);if(null!==(t=t.sibling))return void(yu=t);yu=t=e;}while(null!==t);0===Eu&&(Eu=5);}function gc(e,t){do{var n=gs(e.alternate,e);if(null!==n)return n.flags&=32767,void(yu=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(yu=e);yu=e=n;}while(null!==e);Eu=6,yu=null;}function yc(e,t,n,r,l,o,i,s,u){e.cancelPendingCommit=null;do{Cc();}while(0!==Ru);if(6&mu)throw Error(a(327));if(null!==t){if(t===e.current)throw Error(a(177));if(o=t.lanes|t.childLanes,function(e,t,n,r,a,l){var o=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var i=e.entanglements,s=e.expirationTimes,u=e.hiddenUpdates;for(n=o&~n;0<n;){var c=31-we(n),f=1<<c;i[c]=0,s[c]=-1;var d=u[c];if(null!==d)for(u[c]=null,c=0;c<d.length;c++){var p=d[c];null!==p&&(p.lane&=-536870913);}n&=~f;}0!==r&&Te(e,r,0),0!==l&&0===a&&0!==e.tag&&(e.suspendedLanes|=l&~(o&~t));}(e,n,o|=jr,i,s,u),e===gu&&(yu=gu=null,vu=0),Bu=t,Fu=e,Uu=n,Hu=o,Vu=l,qu=r,10256&t.subtreeFlags||10256&t.flags?(e.callbackNode=null,e.callbackPriority=0,ae(de,function(){return xc(),null})):(e.callbackNode=null,e.callbackPriority=0),r=!!(13878&t.flags),13878&t.subtreeFlags||r){r=I.T,I.T=null,l=O.p,O.p=2,i=mu,mu|=4;try{!function(e,t){if(e=e.containerInfo,yf=wd,ar(e=rr(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var l=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType;}catch(e){n=null;break e}var i=0,s=-1,u=-1,c=0,f=0,d=e,p=null;t:for(;;){for(var h;d!==n||0!==l&&3!==d.nodeType||(s=i+l),d!==o||0!==r&&3!==d.nodeType||(u=i+r),3===d.nodeType&&(i+=d.nodeValue.length),null!==(h=d.firstChild);)p=d,d=h;for(;;){if(d===e)break t;if(p===n&&++c===l&&(s=i),p===o&&++f===r&&(u=i),null!==(h=d.nextSibling))break;p=(d=p).parentNode;}d=h;}n=-1===s||-1===u?null:{start:s,end:u};}else n=null;}n=n||{start:0,end:0};}else n=null;for(vf={focusedElem:e,selectionRange:n},wd=!1,Os=t;null!==Os;)if(e=(t=Os).child,1028&t.subtreeFlags&&null!==e)e.return=t,Os=e;else for(;null!==Os;){switch(o=(t=Os).alternate,e=t.flags,t.tag){case 0:if(4&e&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(n=0;n<e.length;n++)(l=e[n]).ref.impl=l.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(1024&e&&null!==o){e=void 0,n=t,l=o.memoizedProps,o=o.memoizedState,r=n.stateNode;try{var m=Ei(n.type,l);e=r.getSnapshotBeforeUpdate(m,o),r.__reactInternalSnapshotBeforeUpdate=e;}catch(e){Ec(n,n.return,e);}}break;case 3:if(1024&e)if(9===(n=(e=t.stateNode.containerInfo).nodeType))Lf(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Lf(e);break;default:e.textContent="";}break;default:if(1024&e)throw Error(a(163))}if(null!==(e=t.sibling)){e.return=t.return,Os=e;break}Os=t.return;}}(e,t);}finally{mu=i,O.p=l,I.T=r;}}Ru=1,vc(),bc(),wc();}}function vc(){if(1===Ru){Ru=0;var e=Fu,t=Bu,n=!!(13878&t.flags);if(13878&t.subtreeFlags||n){n=I.T,I.T=null;var r=O.p;O.p=2;var a=mu;mu|=4;try{Qs(t,e);var l=vf,o=rr(e.containerInfo),i=l.focusedElem,s=l.selectionRange;if(o!==i&&i&&i.ownerDocument&&nr(i.ownerDocument.documentElement,i)){if(null!==s&&ar(i)){var u=s.start,c=s.end;if(void 0===c&&(c=u),"selectionStart"in i)i.selectionStart=u,i.selectionEnd=Math.min(c,i.value.length);else {var f=i.ownerDocument||document,d=f&&f.defaultView||window;if(d.getSelection){var p=d.getSelection(),h=i.textContent.length,m=Math.min(s.start,h),g=void 0===s.end?m:Math.min(s.end,h);!p.extend&&m>g&&(o=g,g=m,m=o);var y=tr(i,m),v=tr(i,g);if(y&&v&&(1!==p.rangeCount||p.anchorNode!==y.node||p.anchorOffset!==y.offset||p.focusNode!==v.node||p.focusOffset!==v.offset)){var b=f.createRange();b.setStart(y.node,y.offset),p.removeAllRanges(),m>g?(p.addRange(b),p.extend(v.node,v.offset)):(b.setEnd(v.node,v.offset),p.addRange(b));}}}}for(f=[],p=i;p=p.parentNode;)1===p.nodeType&&f.push({element:p,left:p.scrollLeft,top:p.scrollTop});for("function"==typeof i.focus&&i.focus(),i=0;i<f.length;i++){var w=f[i];w.element.scrollLeft=w.left,w.element.scrollTop=w.top;}}wd=!!yf,vf=yf=null;}finally{mu=a,O.p=r,I.T=n;}}e.current=t,Ru=2;}}function bc(){if(2===Ru){Ru=0;var e=Fu,t=Bu,n=!!(8772&t.flags);if(8772&t.subtreeFlags||n){n=I.T,I.T=null;var r=O.p;O.p=2;var a=mu;mu|=4;try{$s(e,t.alternate,t);}finally{mu=a,O.p=r,I.T=n;}}Ru=3;}}function wc(){if(4===Ru||3===Ru){Ru=0,ie();var e=Fu,t=Bu,n=Uu,r=qu;10256&t.subtreeFlags||10256&t.flags?Ru=5:(Ru=0,Bu=Fu=null,kc(e,e.pendingLanes));var a=e.pendingLanes;if(0===a&&(Mu=null),De(n),t=t.stateNode,ve&&"function"==typeof ve.onCommitFiberRoot)try{ve.onCommitFiberRoot(ye,t,void 0,!(128&~t.current.flags));}catch(e){}if(null!==r){t=I.T,a=O.p,O.p=2,I.T=null;try{for(var l=e.onRecoverableError,o=0;o<r.length;o++){var i=r[o];l(i.value,{componentStack:i.stack});}}finally{I.T=t,O.p=a;}}3&Uu&&Cc(),Dc(e),a=e.pendingLanes,261930&n&&42&a?e===Qu?Wu++:(Wu=0,Qu=e):Wu=0,Mc(0,!1);}}function kc(e,t){0===(e.pooledCacheLanes&=t)&&null!=(t=e.pooledCache)&&(e.pooledCache=null,Ua(t));}function Cc(){return vc(),bc(),wc(),xc()}function xc(){if(5!==Ru)return !1;var e=Fu,t=Hu;Hu=0;var n=De(Uu),r=I.T,l=O.p;try{O.p=32>n?32:n,I.T=null,n=Vu,Vu=null;var o=Fu,i=Uu;if(Ru=0,Bu=Fu=null,Uu=0,6&mu)throw Error(a(331));var s=mu;if(mu|=4,cu(o.current),nu(o,o.current,i,n),mu=s,Mc(0,!1),ve&&"function"==typeof ve.onPostCommitFiberRoot)try{ve.onPostCommitFiberRoot(ye,o);}catch(e){}return !0}finally{O.p=l,I.T=r,kc(e,t);}}function Sc(e,t,n){t=Gr(n,t),null!==(e=kl(e,t=zi(e.stateNode,t,2),2))&&(Le(e,2),Dc(e));}function Ec(e,t,n){if(3===e.tag)Sc(e,e,n);else for(;null!==t;){if(3===t.tag){Sc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Mu||!Mu.has(r))){e=Gr(n,e),null!==(r=kl(t,n=Li(2),2))&&(Ti(n,r,t,e),Le(r,2),Dc(r));break}}t=t.return;}}function _c(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hu;var a=new Set;r.set(t,a);}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(xu=!0,a.add(n),e=Ac.bind(null,e,t,n),t.then(e,e));}function Ac(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,gu===e&&(vu&n)===n&&(4===Eu||3===Eu&&(62914560&vu)===vu&&300>se()-Iu?!(2&mu)&&rc(e,0):Pu|=n,Nu===vu&&(Nu=0)),Dc(e);}function Pc(e,t){0===t&&(t=Ne()),null!==(e=Tr(e,t))&&(Le(e,t),Dc(e));}function jc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Pc(e,n);}function Nc(e,t){var n=0;switch(e.tag){case 31:case 13:var r=e.stateNode,l=e.memoizedState;null!==l&&(n=l.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(a(314))}null!==r&&r.delete(t),Pc(e,n);}var zc=null,Lc=null,Tc=!1,Ic=!1,Oc=!1,$c=0;function Dc(e){e!==Lc&&null===e.next&&(null===Lc?zc=Lc=e:Lc=Lc.next=e),Ic=!0,Tc||(Tc=!0,Af(function(){6&mu?ae(ce,Rc):Fc();}));}function Mc(e,t){if(!Oc&&Ic){Oc=!0;do{for(var n=!1,r=zc;null!==r;){if(!t)if(0!==e){var a=r.pendingLanes;if(0===a)var l=0;else {var o=r.suspendedLanes,i=r.pingedLanes;l=(1<<31-we(42|e)+1)-1,l=201326741&(l&=a&~(o&~i))?201326741&l|1:l?2|l:0;}0!==l&&(n=!0,Hc(r,l));}else l=vu,!(3&(l=Ae(r,r===gu?l:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||Pe(r,l)||(n=!0,Hc(r,l));r=r.next;}}while(n);Oc=!1;}}function Rc(){Fc();}function Fc(){Ic=Tc=!1;var e,t=0;0!==$c&&((e=window.event)&&"popstate"===e.type?e!==xf&&(xf=e,1):(xf=null,0))&&(t=$c);for(var n=se(),r=null,a=zc;null!==a;){var l=a.next,o=Bc(a,n);0===o?(a.next=null,null===r?zc=l:r.next=l,null===l&&(Lc=r)):(r=a,(0!==t||3&o)&&(Ic=!0)),a=l;}0!==Ru&&5!==Ru||Mc(t,!1),0!==$c&&($c=0);}function Bc(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,l=-62914561&e.pendingLanes;0<l;){var o=31-we(l),i=1<<o,s=a[o];-1===s?0!==(i&n)&&0===(i&r)||(a[o]=je(i,t)):s<=t&&(e.expiredLanes|=i),l&=~i;}if(n=vu,n=Ae(e,e===(t=gu)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===bu||9===bu)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&le(r),e.callbackNode=null,e.callbackPriority=0;if(!(3&n)||Pe(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&le(r),De(n)){case 2:case 8:n=fe;break;case 32:default:n=de;break;case 268435456:n=he;}return r=Uc.bind(null,e),n=ae(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&le(r),e.callbackPriority=2,e.callbackNode=null,2}function Uc(e,t){if(0!==Ru&&5!==Ru)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(Cc()&&e.callbackNode!==n)return null;var r=vu;return 0===(r=Ae(e,e===gu?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Ku(e,r,t),Bc(e,se()),null!=e.callbackNode&&e.callbackNode===n?Uc.bind(null,e):null)}function Hc(e,t){if(Cc())return null;Ku(e,t,!0);}function Vc(){if(0===$c){var e=qa;0===e&&(e=xe,!(261888&(xe<<=1))&&(xe=256)),$c=e;}return $c}function qc(e){return null==e||"symbol"==typeof e||"boolean"==typeof e?null:"function"==typeof e?e:zt(""+e)}function Wc(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Qc=0;Qc<Sr.length;Qc++){var Gc=Sr[Qc];Er(Gc.toLowerCase(),"on"+(Gc[0].toUpperCase()+Gc.slice(1)));}Er(gr,"onAnimationEnd"),Er(yr,"onAnimationIteration"),Er(vr,"onAnimationStart"),Er("dblclick","onDoubleClick"),Er("focusin","onFocus"),Er("focusout","onBlur"),Er(br,"onTransitionRun"),Er(wr,"onTransitionStart"),Er(kr,"onTransitionCancel"),Er(Cr,"onTransitionEnd"),at("onMouseEnter",["mouseout","mouseover"]),at("onMouseLeave",["mouseout","mouseover"]),at("onPointerEnter",["pointerout","pointerover"]),at("onPointerLeave",["pointerout","pointerover"]),rt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),rt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),rt("onBeforeInput",["compositionend","keypress","textInput","paste"]),rt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zc=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Yc));function Kc(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var l=void 0;if(t)for(var o=r.length-1;0<=o;o--){var i=r[o],s=i.instance,u=i.currentTarget;if(i=i.listener,s!==l&&a.isPropagationStopped())break e;l=i,a.currentTarget=u;try{l(a);}catch(e){_r(e);}a.currentTarget=null,l=s;}else for(o=0;o<r.length;o++){if(s=(i=r[o]).instance,u=i.currentTarget,i=i.listener,s!==l&&a.isPropagationStopped())break e;l=i,a.currentTarget=u;try{l(a);}catch(e){_r(e);}a.currentTarget=null,l=s;}}}}function Xc(e,t){var n=t[Ve];void 0===n&&(n=t[Ve]=new Set);var r=e+"__bubble";n.has(r)||(nf(t,e,2,!1),n.add(r));}function Jc(e,t,n){var r=0;t&&(r|=4),nf(n,e,r,t);}var ef="_reactListening"+Math.random().toString(36).slice(2);function tf(e){if(!e[ef]){e[ef]=!0,tt.forEach(function(t){"selectionchange"!==t&&(Zc.has(t)||Jc(t,!1,e),Jc(t,!0,e));});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[ef]||(t[ef]=!0,Jc("selectionchange",!1,t));}}function nf(e,t,n,r){switch(Ad(t)){case 2:var a=kd;break;case 8:a=Cd;break;default:a=xd;}n=a.bind(null,t,n,e),a=void 0,!Ut||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1);}function rf(e,t,n,r,a){var o=r;if(!(1&t||2&t||null===r))e:for(;;){if(null===r)return;var i=r.tag;if(3===i||4===i){var s=r.stateNode.containerInfo;if(s===a)break;if(4===i)for(i=r.return;null!==i;){var u=i.tag;if((3===u||4===u)&&i.stateNode.containerInfo===a)return;i=i.return;}for(;null!==s;){if(null===(i=Ze(s)))return;if(5===(u=i.tag)||6===u||26===u||27===u){r=o=i;continue e}s=s.parentNode;}}r=r.return;}Rt(function(){var r=o,a=It(n),i=[];e:{var s=xr.get(e);if(void 0!==s){var u=nn,c=e;switch(e){case"keypress":if(0===Gt(n))break e;case"keydown":case"keyup":u=vn;break;case"focusin":c="focus",u=un;break;case"focusout":c="blur",u=un;break;case"beforeblur":case"afterblur":u=un;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=on;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=sn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=wn;break;case gr:case yr:case vr:u=cn;break;case Cr:u=kn;break;case"scroll":case"scrollend":u=an;break;case"wheel":u=Cn;break;case"copy":case"cut":case"paste":u=fn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=bn;break;case"toggle":case"beforetoggle":u=xn;}var f=!!(4&t),d=!f&&("scroll"===e||"scrollend"===e),p=f?null!==s?s+"Capture":null:s;f=[];for(var h,m=r;null!==m;){var g=m;if(h=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===h||null===p||null!=(g=Ft(m,p))&&f.push(af(m,g,h)),d)break;m=m.return;}0<f.length&&(s=new u(s,c,null,n,a),i.push({event:s,listeners:f}));}}if(!(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===Tt||!(c=n.relatedTarget||n.fromElement)||!Ze(c)&&!c[He])&&(u||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(c=(c=n.relatedTarget||n.toElement)?Ze(c):null)&&(d=l(c),f=c.tag,c!==d||5!==f&&27!==f&&6!==f)&&(c=null)):(u=null,c=r),u!==c)){if(f=on,g="onMouseLeave",p="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(f=bn,g="onPointerLeave",p="onPointerEnter",m="pointer"),d=null==u?s:Xe(u),h=null==c?s:Xe(c),(s=new f(g,m+"leave",u,n,a)).target=d,s.relatedTarget=h,g=null,Ze(a)===r&&((f=new f(p,m+"enter",c,n,a)).target=h,f.relatedTarget=d,g=f),d=g,u&&c)e:{for(f=of,m=c,h=0,g=p=u;g;g=f(g))h++;g=0;for(var y=m;y;y=f(y))g++;for(;0<h-g;)p=f(p),h--;for(;0<g-h;)m=f(m),g--;for(;h--;){if(p===m||null!==m&&p===m.alternate){f=p;break e}p=f(p),m=f(m);}f=null;}else f=null;null!==u&&sf(i,s,u,f,!1),null!==c&&null!==d&&sf(i,d,c,f,!0);}if("select"===(u=(s=r?Xe(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var v=Bn;else if(On(s))if(Un)v=Kn;else {v=Yn;var b=Gn;}else !(u=s.nodeName)||"input"!==u.toLowerCase()||"checkbox"!==s.type&&"radio"!==s.type?r&&Pt(r.elementType)&&(v=Bn):v=Zn;switch(v&&(v=v(e,r))?$n(i,v,n,a):(b&&b(e,s,r),"focusout"===e&&r&&"number"===s.type&&null!=r.memoizedProps.value&&wt(s,"number",s.value)),b=r?Xe(r):window,e){case"focusin":(On(b)||"true"===b.contentEditable)&&(or=b,ir=r,sr=null);break;case"focusout":sr=ir=or=null;break;case"mousedown":ur=!0;break;case"contextmenu":case"mouseup":case"dragend":ur=!1,cr(i,n,a);break;case"selectionchange":if(lr)break;case"keydown":case"keyup":cr(i,n,a);}var w;if(En)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0;}else Tn?zn(e,n)&&(k="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(k="onCompositionStart");k&&(Pn&&"ko"!==n.locale&&(Tn||"onCompositionStart"!==k?"onCompositionEnd"===k&&Tn&&(w=Qt()):(qt="value"in(Vt=a)?Vt.value:Vt.textContent,Tn=!0)),0<(b=lf(r,k)).length&&(k=new dn(k,e,null,n,a),i.push({event:k,listeners:b}),(w||null!==(w=Ln(n)))&&(k.data=w))),(w=An?function(e,t){switch(e){case"compositionend":return Ln(t);case"keypress":return 32!==t.which?null:(Nn=!0,jn);case"textInput":return (e=t.data)===jn&&Nn?null:e;default:return null}}(e,n):function(e,t){if(Tn)return "compositionend"===e||!En&&zn(e,t)?(e=Qt(),Wt=qt=Vt=null,Tn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Pn&&"ko"!==t.locale?null:t.data}}(e,n))&&0<(k=lf(r,"onBeforeInput")).length&&(b=new dn("onBeforeInput","beforeinput",null,n,a),i.push({event:b,listeners:k}),b.data=w),function(e,t,n,r,a){if("submit"===t&&n&&n.stateNode===a){var l=qc((a[Ue]||null).action),o=r.submitter;o&&null!==(t=(t=o[Ue]||null)?qc(t.formAction):o.getAttribute("formAction"))&&(l=t,o=null);var i=new nn("action","action",null,r,a);e.push({event:i,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==$c){var e=o?Wc(a,o):new FormData(a);ri(n,{pending:!0,data:e,method:a.method,action:l},null,e);}}else "function"==typeof l&&(i.preventDefault(),e=o?Wc(a,o):new FormData(a),ri(n,{pending:!0,data:e,method:a.method,action:l},l,e));},currentTarget:a}]});}}(i,e,r,n,a);}Kc(i,t);});}function af(e,t,n){return {instance:e,listener:t,currentTarget:n}}function lf(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,l=a.stateNode;if(5!==(a=a.tag)&&26!==a&&27!==a||null===l||(null!=(a=Ft(e,n))&&r.unshift(af(e,a,l)),null!=(a=Ft(e,t))&&r.push(af(e,a,l))),3===e.tag)return r;e=e.return;}return []}function of(e){if(null===e)return null;do{e=e.return;}while(e&&5!==e.tag&&27!==e.tag);return e||null}function sf(e,t,n,r,a){for(var l=t._reactName,o=[];null!==n&&n!==r;){var i=n,s=i.alternate,u=i.stateNode;if(i=i.tag,null!==s&&s===r)break;5!==i&&26!==i&&27!==i||null===u||(s=u,a?null!=(u=Ft(n,l))&&o.unshift(af(n,u,s)):a||null!=(u=Ft(n,l))&&o.push(af(n,u,s))),n=n.return;}0!==o.length&&e.push({event:t,listeners:o});}var uf=/\r\n?/g,cf=/\u0000|\uFFFD/g;function ff(e){return ("string"==typeof e?e:""+e).replace(uf,"\n").replace(cf,"")}function df(e,t){return t=ff(t),ff(e)===t}function pf(e,t,n,r,l,o){switch(n){case"children":"string"==typeof r?"body"===t||"textarea"===t&&""===r||St(e,r):("number"==typeof r||"bigint"==typeof r)&&"body"!==t&&St(e,""+r);break;case"className":ut(e,"class",r);break;case"tabIndex":ut(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":ut(e,n,r);break;case"style":At(e,r,o);break;case"data":if("object"!==t){ut(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"==typeof r||"symbol"==typeof r||"boolean"==typeof r){e.removeAttribute(n);break}r=zt(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"==typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"==typeof o&&("formAction"===n?("input"!==t&&pf(e,t,"name",l.name,l,null),pf(e,t,"formEncType",l.formEncType,l,null),pf(e,t,"formMethod",l.formMethod,l,null),pf(e,t,"formTarget",l.formTarget,l,null)):(pf(e,t,"encType",l.encType,l,null),pf(e,t,"method",l.method,l,null),pf(e,t,"target",l.target,l,null))),null==r||"symbol"==typeof r||"boolean"==typeof r){e.removeAttribute(n);break}r=zt(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=Lt);break;case"onScroll":null!=r&&Xc("scroll",e);break;case"onScrollEnd":null!=r&&Xc("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!=typeof r||!("__html"in r))throw Error(a(61));if(null!=(n=r.__html)){if(null!=l.children)throw Error(a(60));e.innerHTML=n;}}break;case"multiple":e.multiple=r&&"function"!=typeof r&&"symbol"!=typeof r;break;case"muted":e.muted=r&&"function"!=typeof r&&"symbol"!=typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"==typeof r||"boolean"==typeof r||"symbol"==typeof r){e.removeAttribute("xlink:href");break}n=zt(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!=typeof r&&"symbol"!=typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!=typeof r&&"symbol"!=typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!=typeof r&&"symbol"!=typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!=typeof r&&"symbol"!=typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"==typeof r||"symbol"==typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Xc("beforetoggle",e),Xc("toggle",e),st(e,"popover",r);break;case"xlinkActuate":ct(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":ct(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":ct(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":ct(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":ct(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":ct(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":ct(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":ct(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":ct(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":st(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&st(e,n=jt.get(n)||n,r);}}function hf(e,t,n,r,l,o){switch(n){case"style":At(e,r,o);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!=typeof r||!("__html"in r))throw Error(a(61));if(null!=(n=r.__html)){if(null!=l.children)throw Error(a(60));e.innerHTML=n;}}break;case"children":"string"==typeof r?St(e,r):("number"==typeof r||"bigint"==typeof r)&&St(e,""+r);break;case"onScroll":null!=r&&Xc("scroll",e);break;case"onScrollEnd":null!=r&&Xc("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Lt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:nt.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(l=n.endsWith("Capture"),t=n.slice(2,l?n.length-7:void 0),"function"==typeof(o=null!=(o=e[Ue]||null)?o[n]:null)&&e.removeEventListener(t,o,l),"function"!=typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):st(e,n,r):("function"!=typeof o&&null!==o&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,l)));}}function mf(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Xc("error",e),Xc("load",e);var r,l=!1,o=!1;for(r in n)if(n.hasOwnProperty(r)){var i=n[r];if(null!=i)switch(r){case"src":l=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:pf(e,t,r,i,n,null);}}return o&&pf(e,t,"srcSet",n.srcSet,n,null),void(l&&pf(e,t,"src",n.src,n,null));case"input":Xc("invalid",e);var s=r=i=o=null,u=null,c=null;for(l in n)if(n.hasOwnProperty(l)){var f=n[l];if(null!=f)switch(l){case"name":o=f;break;case"type":i=f;break;case"checked":u=f;break;case"defaultChecked":c=f;break;case"value":r=f;break;case"defaultValue":s=f;break;case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(a(137,t));break;default:pf(e,t,l,f,n,null);}}return void bt(e,r,s,u,c,i,o,!1);case"select":for(o in Xc("invalid",e),l=i=r=null,n)if(n.hasOwnProperty(o)&&null!=(s=n[o]))switch(o){case"value":r=s;break;case"defaultValue":i=s;break;case"multiple":l=s;default:pf(e,t,o,s,n,null);}return t=r,n=i,e.multiple=!!l,void(null!=t?kt(e,!!l,t,!1):null!=n&&kt(e,!!l,n,!0));case"textarea":for(i in Xc("invalid",e),r=o=l=null,n)if(n.hasOwnProperty(i)&&null!=(s=n[i]))switch(i){case"value":l=s;break;case"defaultValue":o=s;break;case"children":r=s;break;case"dangerouslySetInnerHTML":if(null!=s)throw Error(a(91));break;default:pf(e,t,i,s,n,null);}return void xt(e,l,o,r);case"option":for(u in n)n.hasOwnProperty(u)&&null!=(l=n[u])&&("selected"===u?e.selected=l&&"function"!=typeof l&&"symbol"!=typeof l:pf(e,t,u,l,n,null));return;case"dialog":Xc("beforetoggle",e),Xc("toggle",e),Xc("cancel",e),Xc("close",e);break;case"iframe":case"object":Xc("load",e);break;case"video":case"audio":for(l=0;l<Yc.length;l++)Xc(Yc[l],e);break;case"image":Xc("error",e),Xc("load",e);break;case"details":Xc("toggle",e);break;case"embed":case"source":case"link":Xc("error",e),Xc("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(c in n)if(n.hasOwnProperty(c)&&null!=(l=n[c]))switch(c){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:pf(e,t,c,l,n,null);}return;default:if(Pt(t)){for(f in n)n.hasOwnProperty(f)&&void 0!==(l=n[f])&&hf(e,t,f,l,n,void 0);return}}for(s in n)n.hasOwnProperty(s)&&null!=(l=n[s])&&pf(e,t,s,l,n,null);}function gf(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return !0;default:return !1}}var yf=null,vf=null;function bf(e){return 9===e.nodeType?e:e.ownerDocument}function wf(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function kf(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function Cf(e,t){return "textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"bigint"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var xf=null,Sf="function"==typeof setTimeout?setTimeout:void 0,Ef="function"==typeof clearTimeout?clearTimeout:void 0,_f="function"==typeof Promise?Promise:void 0,Af="function"==typeof queueMicrotask?queueMicrotask:void 0!==_f?function(e){return _f.resolve(null).then(e).catch(Pf)}:Sf;function Pf(e){setTimeout(function(){throw e});}function jf(e){return "head"===e}function Nf(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)||"/&"===n){if(0===r)return e.removeChild(a),void qd(t);r--;}else if("$"===n||"$?"===n||"$~"===n||"$!"===n||"&"===n)r++;else if("html"===n)Bf(e.ownerDocument.documentElement);else if("head"===n){Bf(n=e.ownerDocument.head);for(var l=n.firstChild;l;){var o=l.nextSibling,i=l.nodeName;l[Ge]||"SCRIPT"===i||"STYLE"===i||"LINK"===i&&"stylesheet"===l.rel.toLowerCase()||n.removeChild(l),l=o;}}else "body"===n&&Bf(e.ownerDocument.body);n=a;}while(n);qd(t);}function zf(e,t){var n=e;e=0;do{var r=n.nextSibling;if(1===n.nodeType?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",""===n.getAttribute("style")&&n.removeAttribute("style")):3===n.nodeType&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===e)break;e--;}else "$"!==n&&"$?"!==n&&"$~"!==n&&"$!"!==n||e++;n=r;}while(n)}function Lf(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Lf(n),Ye(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n);}}function Tf(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=$f(e.nextSibling)))return null}return e}function If(e){return "$?"===e.data||"$~"===e.data}function Of(e){return "$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function $f(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Df=null;function Mf(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n||"/&"===n){if(0===t)return $f(e.nextSibling);t--;}else "$"!==n&&"$!"!==n&&"$?"!==n&&"$~"!==n&&"&"!==n||t++;}e=e.nextSibling;}return null}function Rf(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n||"$~"===n||"&"===n){if(0===t)return e;t--;}else "/$"!==n&&"/&"!==n||t++;}e=e.previousSibling;}return null}function Ff(e,t,n){switch(t=bf(n),e){case"html":if(!(e=t.documentElement))throw Error(a(452));return e;case"head":if(!(e=t.head))throw Error(a(453));return e;case"body":if(!(e=t.body))throw Error(a(454));return e;default:throw Error(a(451))}}function Bf(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ye(e);}var Uf=new Map,Hf=new Set;function Vf(e){return "function"==typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var qf=O.d;O.d={f:function(){var e=qf.f(),t=tc();return e||t},r:function(e){var t=Ke(e);null!==t&&5===t.tag&&"form"===t.type?li(t):qf.r(e);},D:function(e){qf.D(e),Qf("dns-prefetch",e,null);},C:function(e,t){qf.C(e,t),Qf("preconnect",e,t);},L:function(e,t,n){qf.L(e,t,n);var r=Wf;if(r&&e&&t){var a='link[rel="preload"][as="'+yt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(a+='[imagesrcset="'+yt(n.imageSrcSet)+'"]',"string"==typeof n.imageSizes&&(a+='[imagesizes="'+yt(n.imageSizes)+'"]')):a+='[href="'+yt(e)+'"]';var l=a;switch(t){case"style":l=Yf(e);break;case"script":l=Xf(e);}Uf.has(l)||(e=f({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Uf.set(l,e),null!==r.querySelector(a)||"style"===t&&r.querySelector(Zf(l))||"script"===t&&r.querySelector(Jf(l))||(mf(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)));}},m:function(e,t){qf.m(e,t);var n=Wf;if(n&&e){var r=t&&"string"==typeof t.as?t.as:"script",a='link[rel="modulepreload"][as="'+yt(r)+'"][href="'+yt(e)+'"]',l=a;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":l=Xf(e);}if(!Uf.has(l)&&(e=f({rel:"modulepreload",href:e},t),Uf.set(l,e),null===n.querySelector(a))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Jf(l)))return}mf(r=n.createElement("link"),"link",e),et(r),n.head.appendChild(r);}}},X:function(e,t){qf.X(e,t);var n=Wf;if(n&&e){var r=Je(n).hoistableScripts,a=Xf(e),l=r.get(a);l||((l=n.querySelector(Jf(a)))||(e=f({src:e,async:!0},t),(t=Uf.get(a))&&rd(e,t),et(l=n.createElement("script")),mf(l,"link",e),n.head.appendChild(l)),l={type:"script",instance:l,count:1,state:null},r.set(a,l));}},S:function(e,t,n){qf.S(e,t,n);var r=Wf;if(r&&e){var a=Je(r).hoistableStyles,l=Yf(e);t=t||"default";var o=a.get(l);if(!o){var i={loading:0,preload:null};if(o=r.querySelector(Zf(l)))i.loading=5;else {e=f({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Uf.get(l))&&nd(e,n);var s=o=r.createElement("link");et(s),mf(s,"link",e),s._p=new Promise(function(e,t){s.onload=e,s.onerror=t;}),s.addEventListener("load",function(){i.loading|=1;}),s.addEventListener("error",function(){i.loading|=2;}),i.loading|=4,td(o,t,r);}o={type:"stylesheet",instance:o,count:1,state:i},a.set(l,o);}}},M:function(e,t){qf.M(e,t);var n=Wf;if(n&&e){var r=Je(n).hoistableScripts,a=Xf(e),l=r.get(a);l||((l=n.querySelector(Jf(a)))||(e=f({src:e,async:!0,type:"module"},t),(t=Uf.get(a))&&rd(e,t),et(l=n.createElement("script")),mf(l,"link",e),n.head.appendChild(l)),l={type:"script",instance:l,count:1,state:null},r.set(a,l));}}};var Wf="undefined"==typeof document?null:document;function Qf(e,t,n){var r=Wf;if(r&&"string"==typeof t&&t){var a=yt(t);a='link[rel="'+e+'"][href="'+a+'"]',"string"==typeof n&&(a+='[crossorigin="'+n+'"]'),Hf.has(a)||(Hf.add(a),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(a)&&(mf(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)));}}function Gf(e,t,n,r){var l,o,i,s,u=(u=W.current)?Vf(u):null;if(!u)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return "string"==typeof n.precedence&&"string"==typeof n.href?(t=Yf(n.href),(r=(n=Je(u).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"==typeof n.href&&"string"==typeof n.precedence){e=Yf(n.href);var c=Je(u).hoistableStyles,f=c.get(e);if(f||(u=u.ownerDocument||u,f={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},c.set(e,f),(c=u.querySelector(Zf(e)))&&!c._p&&(f.instance=c,f.state.loading=5),Uf.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Uf.set(e,n),c||(l=u,o=e,i=n,s=f.state,l.querySelector('link[rel="preload"][as="style"]['+o+"]")?s.loading=1:(o=l.createElement("link"),s.preload=o,o.addEventListener("load",function(){return s.loading|=1}),o.addEventListener("error",function(){return s.loading|=2}),mf(o,"link",i),et(o),l.head.appendChild(o))))),t&&null===r)throw Error(a(528,""));return f}if(t&&null!==r)throw Error(a(529,""));return null;case"script":return t=n.async,"string"==typeof(n=n.src)&&t&&"function"!=typeof t&&"symbol"!=typeof t?(t=Xf(n),(r=(n=Je(u).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function Yf(e){return 'href="'+yt(e)+'"'}function Zf(e){return 'link[rel="stylesheet"]['+e+"]"}function Kf(e){return f({},e,{"data-precedence":e.precedence,precedence:null})}function Xf(e){return '[src="'+yt(e)+'"]'}function Jf(e){return "script[async]"+e}function ed(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+yt(n.href)+'"]');if(r)return t.instance=r,et(r),r;var l=f({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return et(r=(e.ownerDocument||e).createElement("style")),mf(r,"style",l),td(r,n.precedence,e),t.instance=r;case"stylesheet":l=Yf(n.href);var o=e.querySelector(Zf(l));if(o)return t.state.loading|=4,t.instance=o,et(o),o;r=Kf(n),(l=Uf.get(l))&&nd(r,l),et(o=(e.ownerDocument||e).createElement("link"));var i=o;return i._p=new Promise(function(e,t){i.onload=e,i.onerror=t;}),mf(o,"link",r),t.state.loading|=4,td(o,n.precedence,e),t.instance=o;case"script":return o=Xf(n.src),(l=e.querySelector(Jf(o)))?(t.instance=l,et(l),l):(r=n,(l=Uf.get(o))&&rd(r=f({},n),l),et(l=(e=e.ownerDocument||e).createElement("script")),mf(l,"link",r),e.head.appendChild(l),t.instance=l);case"void":return null;default:throw Error(a(443,t.type))}else "stylesheet"===t.type&&!(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,td(r,n.precedence,e));return t.instance}function td(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=r.length?r[r.length-1]:null,l=a,o=0;o<r.length;o++){var i=r[o];if(i.dataset.precedence===t)l=i;else if(l!==a)break}l?l.parentNode.insertBefore(e,l.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild);}function nd(e,t){e.crossOrigin??=t.crossOrigin,e.referrerPolicy??=t.referrerPolicy,e.title??=t.title;}function rd(e,t){e.crossOrigin??=t.crossOrigin,e.referrerPolicy??=t.referrerPolicy,e.integrity??=t.integrity;}var ad=null;function ld(e,t,n){if(null===ad){var r=new Map,a=ad=new Map;a.set(n,r);}else (r=(a=ad).get(n))||(r=new Map,a.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),a=0;a<n.length;a++){var l=n[a];if(!(l[Ge]||l[Be]||"link"===e&&"stylesheet"===l.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==l.namespaceURI){var o=l.getAttribute(t)||"";o=e+o;var i=r.get(o);i?i.push(l):r.set(o,[l]);}}return r}function od(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null);}function id(e){return !!("stylesheet"!==e.type||3&e.state.loading)}var sd=0;function ud(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)fd(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e();}}var cd=null;function fd(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,cd=new Map,t.forEach(dd,e),cd=null,ud.call(e));}function dd(e,t){if(!(4&t.state.loading)){var n=cd.get(e);if(n)var r=n.get(null);else {n=new Map,cd.set(e,n);for(var a=e.querySelectorAll("link[data-precedence],style[data-precedence]"),l=0;l<a.length;l++){var o=a[l];"LINK"!==o.nodeName&&"not all"===o.getAttribute("media")||(n.set(o.dataset.precedence,o),r=o);}r&&n.set(null,r);}o=(a=t.instance).getAttribute("data-precedence"),(l=n.get(o)||r)===r&&n.set(null,a),n.set(o,a),this.count++,r=ud.bind(this),a.addEventListener("load",r),a.addEventListener("error",r),l?l.parentNode.insertBefore(a,l.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(a,e.firstChild),t.state.loading|=4;}}var pd={$$typeof:b,Provider:null,Consumer:null,_currentValue:$,_currentValue2:$,_threadCount:0};function hd(e,t,n,r,a,l,o,i,s){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ze(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ze(0),this.hiddenUpdates=ze(null),this.identifierPrefix=r,this.onUncaughtError=a,this.onCaughtError=l,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=s,this.incompleteTransitions=new Map;}function md(e,t,n,r,a,l){a=function(e){return e?e=$r:$r}(a),null===r.context?r.context=a:r.pendingContext=a,(r=wl(t)).payload={element:n},null!==(l=void 0===l?null:l)&&(r.callback=l),null!==(n=kl(e,r,t))&&(Zu(n,0,t),Cl(n,e,t));}function gd(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t;}}function yd(e,t){gd(e,t),(e=e.alternate)&&gd(e,t);}function vd(e){if(13===e.tag||31===e.tag){var t=Tr(e,67108864);null!==t&&Zu(t,0,67108864),yd(e,67108864);}}function bd(e){if(13===e.tag||31===e.tag){var t=Gu(),n=Tr(e,t=$e(t));null!==n&&Zu(n,0,t),yd(e,t);}}var wd=!0;function kd(e,t,n,r){var a=I.T;I.T=null;var l=O.p;try{O.p=2,xd(e,t,n,r);}finally{O.p=l,I.T=a;}}function Cd(e,t,n,r){var a=I.T;I.T=null;var l=O.p;try{O.p=8,xd(e,t,n,r);}finally{O.p=l,I.T=a;}}function xd(e,t,n,r){if(wd){var a=Sd(r);if(null===a)rf(e,t,r,Ed,n),$d(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return jd=Dd(jd,e,t,n,r,a),!0;case"dragenter":return Nd=Dd(Nd,e,t,n,r,a),!0;case"mouseover":return zd=Dd(zd,e,t,n,r,a),!0;case"pointerover":var l=a.pointerId;return Ld.set(l,Dd(Ld.get(l)||null,e,t,n,r,a)),!0;case"gotpointercapture":return l=a.pointerId,Td.set(l,Dd(Td.get(l)||null,e,t,n,r,a)),!0}return !1}(a,e,t,n,r))r.stopPropagation();else if($d(e,r),4&t&&-1<Od.indexOf(e)){for(;null!==a;){var l=Ke(a);if(null!==l)switch(l.tag){case 3:if((l=l.stateNode).current.memoizedState.isDehydrated){var o=_e(l.pendingLanes);if(0!==o){var i=l;for(i.pendingLanes|=2,i.entangledLanes|=2;o;){var s=1<<31-we(o);i.entanglements[1]|=s,o&=~s;}Dc(l),!(6&mu)&&($u=se()+500,Mc(0,!1));}}break;case 31:case 13:null!==(i=Tr(l,2))&&Zu(i,0,2),tc(),yd(l,2);}if(null===(l=Sd(r))&&rf(e,t,r,Ed,n),l===a)break;a=l;}null!==a&&r.stopPropagation();}else rf(e,t,r,null,n);}}function Sd(e){return _d(e=It(e))}var Ed=null;function _d(e){if(Ed=null,null!==(e=Ze(e))){var t=l(e);if(null===t)e=null;else {var n=t.tag;if(13===n){if(null!==(e=o(t)))return e;e=null;}else if(31===n){if(null!==(e=i(t)))return e;e=null;}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null;}else t!==e&&(e=null);}}return Ed=e,null}function Ad(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ue()){case ce:return 2;case fe:return 8;case de:case pe:return 32;case he:return 268435456;default:return 32}default:return 32}}var Pd=!1,jd=null,Nd=null,zd=null,Ld=new Map,Td=new Map,Id=[],Od="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function $d(e,t){switch(e){case"focusin":case"focusout":jd=null;break;case"dragenter":case"dragleave":Nd=null;break;case"mouseover":case"mouseout":zd=null;break;case"pointerover":case"pointerout":Ld.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Td.delete(t.pointerId);}}function Dd(e,t,n,r,a,l){return null===e||e.nativeEvent!==l?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:l,targetContainers:[a]},null!==t&&null!==(t=Ke(t))&&vd(t),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Md(e){var t=Ze(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=o(n)))return e.blockedOn=t,void Re(e.priority,function(){bd(n);})}else if(31===t){if(null!==(t=i(n)))return e.blockedOn=t,void Re(e.priority,function(){bd(n);})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null;}function Rd(e){if(null!==e.blockedOn)return !1;for(var t=e.targetContainers;0<t.length;){var n=Sd(e.nativeEvent);if(null!==n)return null!==(t=Ke(n))&&vd(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Tt=r,n.target.dispatchEvent(r),Tt=null,t.shift();}return !0}function Fd(e,t,n){Rd(e)&&n.delete(t);}function Bd(){Pd=!1,null!==jd&&Rd(jd)&&(jd=null),null!==Nd&&Rd(Nd)&&(Nd=null),null!==zd&&Rd(zd)&&(zd=null),Ld.forEach(Fd),Td.forEach(Fd);}function Ud(e,n){e.blockedOn===n&&(e.blockedOn=null,Pd||(Pd=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Bd)));}var Hd=null;function Vd(e){Hd!==e&&(Hd=e,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Hd===e&&(Hd=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],a=e[t+2];if("function"!=typeof r){if(null===_d(r||n))continue;break}var l=Ke(n);null!==l&&(e.splice(t,3),t-=3,ri(l,{pending:!0,data:a,method:n.method,action:r},r,a));}}));}function qd(e){function t(t){return Ud(t,e)}null!==jd&&Ud(jd,e),null!==Nd&&Ud(Nd,e),null!==zd&&Ud(zd,e),Ld.forEach(t),Td.forEach(t);for(var n=0;n<Id.length;n++){var r=Id[n];r.blockedOn===e&&(r.blockedOn=null);}for(;0<Id.length&&null===(n=Id[0]).blockedOn;)Md(n),null===n.blockedOn&&Id.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var a=n[r],l=n[r+1],o=a[Ue]||null;if("function"==typeof l)o||Vd(n);else if(o){var i=null;if(l&&l.hasAttribute("formAction")){if(a=l,o=l[Ue]||null)i=o.formAction;else if(null!==_d(a))continue}else i=o.action;"function"==typeof i?n[r+1]=i:(n.splice(r,3),r-=3),Vd(n);}}}function Wd(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return a=e})},focusReset:"manual",scroll:"manual"});}function t(){null!==a&&(a(),a=null),r||setTimeout(n,20);}function n(){if(!r&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"});}}if("object"==typeof navigation){var r=!1,a=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){r=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==a&&(a(),a=null);}}}function Qd(e){this._internalRoot=e;}Qd.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));md(t.current,Gu(),e,t,null,null);},Qd.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;md(e.current,2,null,e,null,null),tc(),t[He]=null;}};var Yd=n.version;if("19.2.0"!==Yd)throw Error(a(527,Yd,"19.2.0"));O.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(null===o)break;var i=o.alternate;if(null===i){if(null!==(r=o.return)){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return s(o),e;if(i===r)return s(o),t;i=i.sibling;}throw Error(a(188))}if(n.return!==r.return)n=o,r=i;else {for(var u=!1,c=o.child;c;){if(c===n){u=!0,n=o,r=i;break}if(c===r){u=!0,r=o,n=i;break}c=c.sibling;}if(!u){for(c=i.child;c;){if(c===n){u=!0,n=i,r=o;break}if(c===r){u=!0,r=i,n=o;break}c=c.sibling;}if(!u)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(t),null===(e=null!==e?c(e):null)?null:e.stateNode};var Zd={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:I,reconcilerVersion:"19.2.0"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Kd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kd.isDisabled&&Kd.supportsFiber)try{ye=Kd.inject(Zd),ve=Kd;}catch(e){}}e.createRoot=function(e,t){if(!(n=e)||1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType)throw Error(a(299));var n,r=!1,l="",o=_i,i=Ai,s=Pi;return null!=t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(l=t.identifierPrefix),void 0!==t.onUncaughtError&&(o=t.onUncaughtError),void 0!==t.onCaughtError&&(i=t.onCaughtError),void 0!==t.onRecoverableError&&(s=t.onRecoverableError)),t=function(e,t,n,r,a,l,o,i,s,u,c,f){return e=new hd(e,t,n,o,s,u,c,f,null),t=1,!0===l&&(t|=24),l=Mr(3,null,null,t),e.current=l,l.stateNode=e,(t=Ba()).refCount++,e.pooledCache=t,t.refCount++,l.memoizedState={element:null,isDehydrated:n,cache:t},vl(l),e}(e,1,!1,0,0,r,l,0,o,i,s,Wd),e[He]=t.current,tf(e),new Qd(t)};}}),wa=y(g({"node_modules/react-dom/client.js":(e,t)=>{!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e);}catch(e){console.error(e);}}(),t.exports=ba();}})()),ka=globalThis||self,Ca=Object.defineProperty,xa=(e,t,n)=>((e,t,n)=>t in e?Ca(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);function Sa(e){return e.replace(/([a-z0-9])([A-Z])/g,(e,t,n)=>`${t}-${n.toLowerCase()}`)}function Ea(e){return e.replace(/[-:]([a-z])/g,(e,t)=>`${t.toUpperCase()}`)}var _a={string:{stringify:e=>e,parse:e=>e},number:{stringify:e=>`${e}`,parse:e=>parseFloat(e)},boolean:{stringify:e=>e?"true":"false",parse:e=>/^[ty1-9]/i.test(e)},function:{stringify:e=>e.name,parse:(e,t,n)=>{const r=typeof window<"u"&&e in window?window[e]:typeof ka<"u"&&e in ka?ka[e]:void 0;return "function"==typeof r?r.bind(n):void 0}},method:{stringify:e=>e.name,parse:(e,t,n)=>{const r=(()=>{const e=Ea(t);if(typeof n<"u"&&e in n.container)return n.container[e]})();return "function"==typeof r?r.bind(n):void 0}},json:{stringify:e=>JSON.stringify(e),parse:e=>JSON.parse(e)}},Aa=Symbol.for("r2wc.render"),Pa=Symbol.for("r2wc.connected"),ja=Symbol.for("r2wc.context"),Na=Symbol.for("r2wc.props");function za(e,t,n){const r=(0, wa.createRoot)(e),a=z.createElement(t,n);return r.render(a),{root:r,ReactComponent:t}}function La({root:e,ReactComponent:t},n){const r=z.createElement(t,n);e.render(r);}function Ta({root:e}){e.unmount();}var Ia=g({"node_modules/react/cjs/react-jsx-runtime.production.js":e=>{var t=Symbol.for("react.transitional.element");e.jsx=function(e,n,r){var a=null;if(void 0!==r&&(a=""+r),void 0!==n.key&&(a=""+n.key),"key"in n)for(var l in r={},n)"key"!==l&&(r[l]=n[l]);else r=n;return n=r.ref,{$$typeof:t,type:e,key:a,ref:void 0!==n?n:null,props:r}};}}),Oa=y(g({"node_modules/react/jsx-runtime.js":(e,t)=>{t.exports=Ia();}})()),$a="streamboost-panel-closing-itself";customElements.define("streamboost-panel",function(e,t={}){return function(e,t,n){var r,a,l;t.props||(t.props=e.propTypes?Object.keys(e.propTypes):[]),t.events||(t.events=[]);const o=Array.isArray(t.props)?t.props.slice():Object.keys(t.props),i=Array.isArray(t.events)?t.events.slice():Object.keys(t.events),s={},u={},c={},f={};for(const e of o){s[e]=Array.isArray(t.props)?"string":t.props[e];const n=Sa(e);c[e]=n,f[n]=e;}for(const e of i)u[e]=Array.isArray(t.events)?{}:t.events[e];class d extends HTMLElement{constructor(){super(),xa(this,l,!0),xa(this,a),xa(this,r,{}),xa(this,"container"),t.shadow?this.container=this.attachShadow({mode:t.shadow}):this.container=this,this[Na].container=this.container;for(const e of o){const t=c[e],n=this.getAttribute(t),r=s[e],a=r?_a[r]:null;if("method"===r){const r=Ea(t);Object.defineProperty(this[Na].container,r,{enumerable:!0,configurable:!0,get(){return this[Na][r]},set(e){this[Na][r]=e,this[Aa]();}}),this[Na][e]=a.parse(n,t,this);}null!=a&&a.parse&&n&&(this[Na][e]=a.parse(n,t,this));}for(const e of i)this[Na][e]=t=>{const n=e.replace(/^on/,"").toLowerCase();this.dispatchEvent(new CustomEvent(n,{detail:t,...u[e]}));};}static get observedAttributes(){return Object.keys(f)}connectedCallback(){this[Pa]=!0,this[Aa]();}disconnectedCallback(){this[Pa]=!1,this[ja]&&n.unmount(this[ja]),delete this[ja];}attributeChangedCallback(e,t,n){const r=f[e],a=s[r],l=a?_a[a]:null;r in s&&null!=l&&l.parse&&n&&(this[Na][r]=l.parse(n,e,this),this[Aa]());}[(l=Pa,a=ja,r=Na,Aa)](){this[Pa]&&(this[ja]?n.update(this[ja],this[Na]):this[ja]=n.mount(this.container,e,this[Na]));}}for(const e of o){const t=c[e],n=s[e];Object.defineProperty(d.prototype,e,{enumerable:!0,configurable:!0,get(){return this[Na][e]},set(r){this[Na][e]=r;const a=n?_a[n]:null;if(null!=a&&a.stringify){const e=a.stringify(r,t,this);this.getAttribute(t)!==e&&this.setAttribute(t,e);}else this[Aa]();}});}return d}(e,t,{mount:za,update:La,unmount:Ta})}(e=>{const t=(0, z.useMemo)(()=>{if(e.dashboardCards){const t=[];for(let n of e.dashboardCards.split(/ *, */))switch(n){case"Shared":case"Speed":case"Water":case"Ranking":case"Energy":case"Peers":case"Power":case"CO2":t.push(n);break;default:console.warn("Streamboost: invalid dashboard card value:",n);}if(t)return t}},[e.dashboardCards]),n=(0, z.useMemo)(()=>e.sponsorImage&&!e.sponsorID?(console.warn("Streamboost: sponsor id is missing"),null):{id:e.sponsorID,image:e.sponsorImage,url:e.sponsorURL},[e.sponsorID,e.sponsorImage,e.sponsorURL]);return (0, z.useEffect)(()=>{const t=()=>{const t=document.getElementById(e.id);t&&t.setAttribute("is-open","false");};return addEventListener($a,t),()=>removeEventListener($a,t)},[e.id]),(0, Oa.jsx)(ha,{backdropBlur:e.backdropBlur,backdropMode:e.backdropMode,close:()=>dispatchEvent(new Event($a)),color:e.color,dashboardCards:t,defaultIsStreamboostOn:e.defaultIsStreamboostOn,defaultSection:e.defaultSection,isOpen:e.isOpen,sponsor:n,superStream:e.superStream,userID:e.userID})},{props:{backdropBlur:"boolean",backdropMode:"string",color:"string",dashboardCards:"string",defaultIsStreamboostOn:"boolean",defaultSection:"string",id:"string",isOpen:"boolean",sponsorID:"string",sponsorImage:"string",sponsorURL:"string",superStream:"boolean",userID:"string"}}));
!function(e,t){e.bs=e.bs||{},e.bs.player=e.bs.player||{},e.bs.player.plugin=e.bs.player.plugin||{},e.bs.player.plugin.system73=e.bs.player.plugin.system73||{},Math.__name__="Math";var r=require("haxe.Reflect");class s{constructor(e){s._hx_skip_constructor||this._hx_constructor(e);}_hx_constructor(e){null==e&&(e=5),this.pluginName="";let t=i.getClass(this);this.pluginName=t.__name__.split(".").pop(),this.initPriority=e;let s=this.pluginName,a=exports.configuration;this.pluginConfig=null!=a&&Object.prototype.hasOwnProperty.call(a,s)?r.field(a,s):Object.create(null);}create(){}destroy(){}activate(){}postActivate(){}deactivate(){}eventFilter(e){return !0}registerPlugin(e){}getPluginVersion(){return "v2.15.38"}getPluginName(){return this.pluginName}get_player(){return this.player}set_player(e){return this.player=e}get_variables(){return this.variables}set_variables(e){return this.variables=e}get_eventHub(){return this.eventHub}set_eventHub(e){return this.eventHub=e}get_parentDisplay(){return this.parentDisplay}set_parentDisplay(e){return this.parentDisplay=e}get_display(){return this.display}isCriticalForPlayback(){return !0}}s.__name__="bs.player.core.plugin.PluginBase",Object.assign(s.prototype,{__class__:s});class a extends s{constructor(e){s._hx_skip_constructor=!0,super(),s._hx_skip_constructor=!1,this._hx_constructor(e);}_hx_constructor(e){this.wrapper=null,super._hx_constructor(e);}destroy(){super.destroy(),this.destroyWrapper();}destroyWrapper(){if(null!=this.wrapper){try{this.wrapper.destroy();}catch(e){let t=n.caught(e);console.warn(t);}this.wrapper=null;}}canBeUsed(){return null!=BigInt}hasValidConfig(){return null!=this.resolveKey(this.get_variables())}hasDashWrapper(){return null!=window.S73DashjsWrapper}hasHlsWrapper(){return null!=window.S73HlsjsWrapper}wrapDash(){if(this.destroyWrapper(),this.hasDashWrapper())try{this.wrapper=new window.S73DashjsWrapper(this.resolveKey(this.get_variables()),{dashjs:exports.dashjs});}catch(e){let t=n.caught(e);console.warn(t);}}wrapDashPlayer(e){if(this.hasDashWrapper())try{this.wrapper.wrapPlayer(e);}catch(e){let t=n.caught(e);console.warn(t);}}wrapHls(){if(this.hasHlsWrapper())try{this.wrapper=new window.S73HlsjsWrapper(this.resolveKey(this.get_variables()),{Hls:exports.Hls});}catch(e){let t=n.caught(e);console.warn(t);}}wrapHlsConfig(e){if(this.hasHlsWrapper())try{this.wrapper.wrapPlayerConfig(e);}catch(e){let t=n.caught(e);console.warn(t);}}wrapHlsPlayer(e){if(this.hasHlsWrapper())try{this.wrapper.wrapPlayer(e);}catch(e){let t=n.caught(e);console.warn(t);}}resolveKey(e){return e.system73}}e.bs.player.plugin.system73.System73Plugin=a,a.__name__="bs.player.plugin.system73.System73Plugin",Object.assign(a.prototype,{__class__:a});class n extends Error{constructor(e,t,r){super(e),this.message=e,this.__previousException=t,this.__nativeException=null!=r?r:this;}static caught(e){return e instanceof n?e:e instanceof Error?new n(e.message,null,e):new l(e,null,e)}}n.__name__="haxe.Exception",Object.assign(n.prototype,{__class__:n});class l extends n{constructor(e,t,r){super(String(e),t,r),this.value=e;}}l.__name__="haxe.ValueException",Object.assign(l.prototype,{__class__:l});class i{static getClass(e){if(null==e)return null;if(e instanceof Array)return Array;{let t=e.__class__;if(null!=t)return t;let r=i.__nativeClassName(e);return null!=r?i.__resolveNativeClass(r):null}}static __nativeClassName(e){let t=i.__toStr.call(e).slice(8,-1);return "Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t}static __resolveNativeClass(e){return t[e]}}i.__name__="js.Boot",Object.defineProperty(String.prototype,"__class__",{value:String,enumerable:!1,writable:!0}),String.__name__="String",Array.__name__="Array",i.__toStr={}.toString,s._hx_skip_constructor=!1,a.__plugfaces__="ISystem73Plugin,IPlugin";}(exports,window);(function () {
	[`dashjs`, `hlsjs`].forEach(name => {
		const script = document.createElement("script");
		script.src = `https://cdn.s73cloud.com/4/s73-sdk-${name}.js`;
		script.onerror = error => console.error(`[system73.remote].load.${name}.error`, error);
		try {
			document.head.appendChild(script);
		} catch (error) {
			console.error(`[system73.remote].append.${name}.error`, error);
		}
	});
})();const e={default:{season:"Season",episode:"Episode",language:"Language",subtitles:"Subtitles",channels:"Channels",live_tv:"Live TV",error:"Error",warning:"Warning",details:"Details",cannot_decode_media:"Player is not able to decode provided media. Video can be broken or your browser doesn't support such video format.",connection_error:"Connection to server lost. Please check your internet connection and click 'Try again' button.",connection_error_permanent:"There is no connection with server. Link to stream is broken or something is blocking communication between your browser and server.",try_again:"Try again",embed_code:"Embed code",embed_code_copy:"copy to clipboard",embed_code_info:"press Ctrl+C to copy",advertisement_bar_title:"Advertising",video_quality:"Video quality",advertisement_title_on_progressbar:"The program starts right after the ad-break:",advertisement_skip_label:"Skip ad",subtitles_disable:"Off",sign_language:"Sign language"},en:{season:"Season",episode:"Episode",language:"Language",subtitles:"Subtitles",channels:"Channels",live_tv:"Live TV",error:"Error",warning:"Warning",details:"Details",cannot_decode_media:"Player is not able to decode provided media. Video can be broken or your browser doesn't support such video format.",connection_error:"Connection to server lost. Please check your internet connection and click 'Try again' button.",connection_error_permanent:"There is no connection with server. Link to stream is broken or something is blocking communication between your browser and server.",try_again:"Try again",embed_code:"Embed code",embed_code_copy:"copy to clipboard",embed_code_info:"press Ctrl+C to copy",advertisement_bar_title:"Advertising",video_quality:"Video quality",advertisement_title_on_progressbar:"The program starts right after the ad-break:",advertisement_skip_label:"Skip ad",subtitles_disable:"Off",sign_language:"Sign language"},no:{season:"Sesong",episode:"Episode",language:"Sprk",subtitles:"Undertekst",channels:"Kanaler",live_tv:"Direkte-TV",error:"Error",warning:"Advarsel",details:"Details",cannot_decode_media:"Player is not able to decode provided media. Video can be broken or your browser doesn't support such video format.",connection_error:"Connection to server lost. Please check your internet connection and click 'Try again' button.",connection_error_permanent:"There is no connection with server. Link to stream is broken or something is blocking communication between your browser and server.",try_again:"Try again",embed_code:"Embed code",embed_code_copy:"copy to clipboard",embed_code_info:"press Ctrl+C to copy",advertisement_bar_title:"Reklame",video_quality:"Video kvalitet",advertisement_title_on_progressbar:"Programmet starter rett etter annonse-pausen:",advertisement_skip_label:"Hoppe over annonsend",subtitles_disable:"Av",sign_language:"Tegnsprk"},da:{season:"Sson",episode:"Episode",language:"Sprog",subtitles:"Undertekster",channels:"Kanaler",live_tv:"Kanaler",error:"Error",warning:"Advarsel",details:"Details",cannot_decode_media:"Player is not able to decode provided media. Video can be broken or your browser doesn't support such video format.",connection_error:"Connection to server lost. Please check your internet connection and click 'Try again' button.",connection_error_permanent:"There is no connection with server. Link to stream is broken or something is blocking communication between your browser and server.",try_again:"Try again",embed_code:"Embed code",embed_code_copy:"copy to clipboard",embed_code_info:"press Ctrl+C to copy",advertisement_bar_title:"Reklame",video_quality:"Videokvalitet",advertisement_title_on_progressbar:"Programmet starter lige efter annoncepausen:",advertisement_skip_label:"Spring annoncen over",subtitles_disable:"Slukket",sign_language:"Tegnsprog"},fi:{season:"Kausi",episode:"Jakso",language:"Kieli",subtitles:"Tekstitykset",channels:"Kanavat",live_tv:"Live-TV",error:"Error",warning:"Varoitus",details:"Details",cannot_decode_media:"Player is not able to decode provided media. Video can be broken or your browser doesn't support such video format.",connection_error:"Connection to server lost. Please check your internet connection and click 'Try again' button.",connection_error_permanent:"There is no connection with server. Link to stream is broken or something is blocking communication between your browser and server.",try_again:"Try again",embed_code:"Embed code",embed_code_copy:"copy to clipboard",embed_code_info:"press Ctrl+C to copy",advertisement_bar_title:"Mainonta",video_quality:"Videon laatu",advertisement_title_on_progressbar:"Ohjelma kynnistyy heti mainoskatkon jlkeen:",advertisement_skip_label:"Ohita mainos",subtitles_disable:"Pois",sign_language:"Viittomakieli"},sv:{season:"Ssong",episode:"Avsnitt",language:"Sprk",subtitles:"Textning",channels:"Kanaler",live_tv:"Kanaler",error:"Error",warning:"Varning",details:"Details",cannot_decode_media:"Player is not able to decode provided media. Video can be broken or your browser doesn't support such video format.",connection_error:"Connection to server lost. Please check your internet connection and click 'Try again' button.",connection_error_permanent:"There is no connection with server. Link to stream is broken or something is blocking communication between your browser and server.",try_again:"Try again",embed_code:"Embed code",embed_code_copy:"copy to clipboard",embed_code_info:"press Ctrl+C to copy",advertisement_bar_title:"Reklam",video_quality:"Videokvalitt",advertisement_title_on_progressbar:"Programmet startar direkt efter annons pausen:",advertisement_skip_label:"Hoppa ver annonsen",subtitles_disable:"Av",sign_language:"Teckensprk"},pl:{season:"Sezon",episode:"Epizod",language:"Jzyk",subtitles:"Napisy",channels:"Programy",live_tv:"Na ywo",error:"Bd",warning:"Uwaga",details:"Szczegy",cannot_load_media:"Odtwarzacz nie mg zdekodowa dostarczonego wideo. Wideo moe by uszkodzone lub twoja przegldarka nie wspiera dostarczonego formatu wideo.",connection_error:"Utracono poczenie z serwerem. Sprawd poczenie internetowe i kliknik przycisk 'Pocz'.",connection_error_permanent:"Brak poczenia z serwerem. Link do strumienia jest uszkodzony lub co blokuje komunikacj midzy przegldark a serwerem.",try_again:"Pocz",embed_code:"Embed code",embed_code_copy:"kopiuj do schowka",embed_code_info:"nacinij Ctrl+C, aby skopiowa",advertisement_bar_title:"Reklama",video_quality:"Jako",advertisement_title_on_progressbar:"Program rozpocznie si zaraz po reklamach:",advertisement_skip_label:"Pomi reklam",subtitles_disable:"Wycz napisy",sign_language:"Jzyk migowy"},es:{season:"Temporada",episode:"Episodio",language:"Idioma",subtitles:"Subttulos",channels:"Canales",live_tv:"TV en directo",error:"Error",warning:"Advertencia",details:"Detalles",cannot_decode_media:"El reproductor no puede decodificar el medio proporcionado. El video puede estar daado o tu navegador no admite este formato de video.",connection_error:"Conexin con el servidor perdida. Verifica tu conexin a Internet y haz clic en el botn 'Intentar de nuevo'.",connection_error_permanent:"No hay conexin con el servidor. El enlace de transmisin est roto o algo est bloqueando la comunicacin entre tu navegador y el servidor.",try_again:"Intentar de nuevo",embed_code:"Cdigo para insertar",embed_code_copy:"copiar al portapapeles",embed_code_info:"pulsa Ctrl+C para copiar",advertisement_bar_title:"Publicidad",video_quality:"Calidad de video",advertisement_title_on_progressbar:"El programa comienza justo despus del anuncio:",advertisement_skip_label:"Omitir anuncio",subtitles_disable:"Desactivar",sign_language:"Lenguaje por seas"},pt:{season:"Temporada",episode:"Episdio",language:"Idioma",subtitles:"Legendas",channels:"Canais",live_tv:"TV em direto",error:"Erro",warning:"Aviso",details:"Detalhes",cannot_decode_media:"O reprodutor no consegue descodificar a mdia fornecida. O vdeo pode estar corrompido ou o seu navegador no suporta esse formato de vdeo.",connection_error:"Conexo com o servidor perdida. Verifique sua conexo com a internet e clique no boto 'Tentar novamente'.",connection_error_permanent:"No h conexo com o servidor. O link de transmisso est quebrado ou algo est bloqueando a comunicao entre o seu navegador e o servidor.",try_again:"Tentar novamente",embed_code:"Cdigo de incorporao",embed_code_copy:"copiar para a rea de transferncia",embed_code_info:"pressione Ctrl+C para copiar",advertisement_bar_title:"Publicidade",video_quality:"Qualidade do vdeo",advertisement_title_on_progressbar:"O programa comea logo aps o intervalo comercial:",advertisement_skip_label:"Pular anncio",subtitles_disable:"Desativar",sign_language:"Lngua gestual"}};var mp4="data:video/mp4;base64,AAAAHGZ0eXBNNFYgAAACAGlzb21pc28yYXZjMQAAAAhmcmVlAAAGF21kYXTeBAAAbGliZmFhYyAxLjI4AABCAJMgBDIARwAAArEGBf//rdxF6b3m2Ui3lizYINkj7u94MjY0IC0gY29yZSAxNDIgcjIgOTU2YzhkOCAtIEguMjY0L01QRUctNCBBVkMgY29kZWMgLSBDb3B5bGVmdCAyMDAzLTIwMTQgLSBodHRwOi8vd3d3LnZpZGVvbGFuLm9yZy94MjY0Lmh0bWwgLSBvcHRpb25zOiBjYWJhYz0wIHJlZj0zIGRlYmxvY2s9MTowOjAgYW5hbHlzZT0weDE6MHgxMTEgbWU9aGV4IHN1Ym1lPTcgcHN5PTEgcHN5X3JkPTEuMDA6MC4wMCBtaXhlZF9yZWY9MSBtZV9yYW5nZT0xNiBjaHJvbWFfbWU9MSB0cmVsbGlzPTEgOHg4ZGN0PTAgY3FtPTAgZGVhZHpvbmU9MjEsMTEgZmFzdF9wc2tpcD0xIGNocm9tYV9xcF9vZmZzZXQ9LTIgdGhyZWFkcz02IGxvb2thaGVhZF90aHJlYWRzPTEgc2xpY2VkX3RocmVhZHM9MCBucj0wIGRlY2ltYXRlPTEgaW50ZXJsYWNlZD0wIGJsdXJheV9jb21wYXQ9MCBjb25zdHJhaW5lZF9pbnRyYT0wIGJmcmFtZXM9MCB3ZWlnaHRwPTAga2V5aW50PTI1MCBrZXlpbnRfbWluPTI1IHNjZW5lY3V0PTQwIGludHJhX3JlZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAuNjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCB2YnZfbWF4cmF0ZT03NjggdmJ2X2J1ZnNpemU9MzAwMCBjcmZfbWF4PTAuMCBuYWxfaHJkPW5vbmUgZmlsbGVyPTAgaXBfcmF0aW89MS40MCBhcT0xOjEuMDAAgAAAAFZliIQL8mKAAKvMnJycnJycnJycnXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXiEASZACGQAjgCEASZACGQAjgAAAAAdBmjgX4GSAIQBJkAIZACOAAAAAB0GaVAX4GSAhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGagC/AySEASZACGQAjgAAAAAZBmqAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZrAL8DJIQBJkAIZACOAAAAABkGa4C/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmwAvwMkhAEmQAhkAI4AAAAAGQZsgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGbQC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm2AvwMkhAEmQAhkAI4AAAAAGQZuAL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGboC/AySEASZACGQAjgAAAAAZBm8AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZvgL8DJIQBJkAIZACOAAAAABkGaAC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmiAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpAL8DJIQBJkAIZACOAAAAABkGaYC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmoAvwMkhAEmQAhkAI4AAAAAGQZqgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGawC/AySEASZACGQAjgAAAAAZBmuAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZsAL8DJIQBJkAIZACOAAAAABkGbIC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm0AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZtgL8DJIQBJkAIZACOAAAAABkGbgCvAySEASZACGQAjgCEASZACGQAjgAAAAAZBm6AnwMkhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AAAAhubW9vdgAAAGxtdmhkAAAAAAAAAAAAAAAAAAAD6AAABDcAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAzB0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAABAAAAAAAAA+kAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAALAAAACQAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAPpAAAAAAABAAAAAAKobWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAB1MAAAdU5VxAAAAAAALWhkbHIAAAAAAAAAAHZpZGUAAAAAAAAAAAAAAABWaWRlb0hhbmRsZXIAAAACU21pbmYAAAAUdm1oZAAAAAEAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAhNzdGJsAAAAr3N0c2QAAAAAAAAAAQAAAJ9hdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAALAAkABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAALWF2Y0MBQsAN/+EAFWdCwA3ZAsTsBEAAAPpAADqYA8UKkgEABWjLg8sgAAAAHHV1aWRraEDyXyRPxbo5pRvPAyPzAAAAAAAAABhzdHRzAAAAAAAAAAEAAAAeAAAD6QAAABRzdHNzAAAAAAAAAAEAAAABAAAAHHN0c2MAAAAAAAAAAQAAAAEAAAABAAAAAQAAAIxzdHN6AAAAAAAAAAAAAAAeAAADDwAAAAsAAAALAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAAiHN0Y28AAAAAAAAAHgAAAEYAAANnAAADewAAA5gAAAO0AAADxwAAA+MAAAP2AAAEEgAABCUAAARBAAAEXQAABHAAAASMAAAEnwAABLsAAATOAAAE6gAABQYAAAUZAAAFNQAABUgAAAVkAAAFdwAABZMAAAWmAAAFwgAABd4AAAXxAAAGDQAABGh0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAACAAAAAAAABDcAAAAAAAAAAAAAAAEBAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAQkAAADcAABAAAAAAPgbWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAC7gAAAykBVxAAAAAAALWhkbHIAAAAAAAAAAHNvdW4AAAAAAAAAAAAAAABTb3VuZEhhbmRsZXIAAAADi21pbmYAAAAQc21oZAAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAADT3N0YmwAAABnc3RzZAAAAAAAAAABAAAAV21wNGEAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAAC7gAAAAAAAM2VzZHMAAAAAA4CAgCIAAgAEgICAFEAVBbjYAAu4AAAADcoFgICAAhGQBoCAgAECAAAAIHN0dHMAAAAAAAAAAgAAADIAAAQAAAAAAQAAAkAAAAFUc3RzYwAAAAAAAAAbAAAAAQAAAAEAAAABAAAAAgAAAAIAAAABAAAAAwAAAAEAAAABAAAABAAAAAIAAAABAAAABgAAAAEAAAABAAAABwAAAAIAAAABAAAACAAAAAEAAAABAAAACQAAAAIAAAABAAAACgAAAAEAAAABAAAACwAAAAIAAAABAAAADQAAAAEAAAABAAAADgAAAAIAAAABAAAADwAAAAEAAAABAAAAEAAAAAIAAAABAAAAEQAAAAEAAAABAAAAEgAAAAIAAAABAAAAFAAAAAEAAAABAAAAFQAAAAIAAAABAAAAFgAAAAEAAAABAAAAFwAAAAIAAAABAAAAGAAAAAEAAAABAAAAGQAAAAIAAAABAAAAGgAAAAEAAAABAAAAGwAAAAIAAAABAAAAHQAAAAEAAAABAAAAHgAAAAIAAAABAAAAHwAAAAQAAAABAAAA4HN0c3oAAAAAAAAAAAAAADMAAAAaAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAACMc3RjbwAAAAAAAAAfAAAALAAAA1UAAANyAAADhgAAA6IAAAO+AAAD0QAAA+0AAAQAAAAEHAAABC8AAARLAAAEZwAABHoAAASWAAAEqQAABMUAAATYAAAE9AAABRAAAAUjAAAFPwAABVIAAAVuAAAFgQAABZ0AAAWwAAAFzAAABegAAAX7AAAGFwAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTUuMzMuMTAw";
exports.dashjs=bradmax.dashjs;delete bradmax.dashjs;exports.i18n=e;exports.mp4=mp4;

exports.configuration={"Chromecast":{},"KeyboardSupport":{},"BradmaxAnalytics":{},"Video":{},"JavascriptApi":{},"VideoHlsJs":{},"PictureInPicture":{},"AirPlay":{},"VideoDashJs":{},"AdvertisementDataProvider":{},"HtmlSkin":{"name":"techno","color":"rgb(255, 255, 255)","layout":"https://bradm.ax/player/VERSION/theme/techno/layout.html","styles":["https://bradm.ax/player/VERSION/theme/techno/style.css"],"font":{"id":"inter_google_font","name":"Inter","src":"https://fonts.googleapis.com/css2?family=Inter&display=swap","fetch":true,"size":"14px","family":["Inter","sans-serif"]},"icon":{"font":{"id":"material_symbols_sharp","name":"Material Symbols Sharp","src":"https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&display=block&text=%EE%81%95%EE%A0%AA%EE%81%88%EE%A2%AA%EE%8C%87%EE%85%8D%EE%81%84%EE%A2%94%EE%97%90%EE%97%91%EE%A6%BD%EE%81%A3%EE%80%B4%EE%80%B7%EE%81%82%EE%A2%B8%EE%9A%B8%EE%81%8E%EE%81%8D%EE%81%90%EE%81%8F%EE%97%8D%EE%97%8B%EE%97%8C%EE%8C%96%EE%8C%93%EE%8E%9E%EE%A7%BE%EE%87%81%EE%A3%BF%EE%A4%80%EE%A2%B6%EF%98%A2%EE%83%81","fetch":true,"family":["Material Symbols Sharp"],"size":"24px","variation":{"FILL":0,"wght":400,"GRAD":0,"opsz":48},"code":{"airplay":"e055","alert":"e82a","subtitles":"e048","pip":"e8aa","chromecast":"e307","copy":"e14d","play-next":"e044","language":"e894","maximize":"e5d0","minimize":"e5d1","menu":"e9bd","audio":"e063","pause":"e034","play":"e037","replay":"e042","quality":"e8b8","volume":"e04e","volume-1":"e04d","volume-2":"e050","volume-x":"e04f","close":"e5cd","left":"e5cb","right":"e5cc","up":"e316","down":"e313","center":"e39e","vr":"e9fe","gyroscope":"e1c1","zoom-plus":"e8ff","zoom-minus":"e900","zoom-reset":"e8b6","playback-rate":"f622","video-tracks":"e0c1"}}},"prefix":"bmp","css":{"adPlaying":"ad-playing","adGoogleImaPlaying":"g-ima-playing","adsUiDisabled":"ad-ui-disabled"}},"BradmaxDataProvider":{},"FreeWheel":{}};exports.variables={"skin":{"font":{"src":"https://fonts.googleapis.com/icon?family=Inter&display=swap"}},"qualityLabelType":"bitrate","bradmaxAnalytics":{"clientToken":"-vTvWdm~j3GxNvYd8~8NnGSjjewEGdx~cN_GPj"}};exports.bs.player.composer.Embeder.main();})();